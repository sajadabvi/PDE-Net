--name=burgers-2-upwind-sparse0-noise0.001-id0 --kernel_size=5 --viscosity=0.05 --blocks=0-6,9 --dataname=burgers --constraint=2 --device=cuda:0 --stablize=0 --sparsity=0 --momentsparsity=0.001 --data_start_time=1 --dt=1e-2 --max_dt=1/1600 --hidden_layers=5 --start_noise=0.001 --end_noise=0.001 --scheme=upwind
0
--name=burgers-2-upwind-sparse0-noise0.001-id1 --kernel_size=5 --viscosity=0.05 --blocks=0-6,9 --dataname=burgers --constraint=2 --device=cuda:1 --stablize=0 --sparsity=0 --momentsparsity=0.001 --data_start_time=1 --dt=1e-2 --max_dt=1/1600 --hidden_layers=5 --start_noise=0.001 --end_noise=0.001 --scheme=upwind
1
--name=burgers-2-upwind-sparse0-noise0.001-id2 --kernel_size=5 --viscosity=0.05 --blocks=0-6,9 --dataname=burgers --constraint=2 --device=cuda:2 --stablize=0 --sparsity=0 --momentsparsity=0.001 --data_start_time=1 --dt=1e-2 --max_dt=1/1600 --hidden_layers=5 --start_noise=0.001 --end_noise=0.001 --scheme=upwind
2
--name=burgers-2-upwind-sparse0-noise0.001-id3 --kernel_size=5 --viscosity=0.05 --blocks=0-6,9 --dataname=burgers --constraint=2 --device=cuda:3 --stablize=0 --sparsity=0 --momentsparsity=0.001 --data_start_time=1 --dt=1e-2 --max_dt=1/1600 --hidden_layers=5 --start_noise=0.001 --end_noise=0.001 --scheme=upwind
3
wait
{'--name': 'burgers-2-upwind-sparse0-noise0.001-id3', '--dtype': 'double', '--device': 'cuda:3', '--constraint': '2', '--dt': 0.01, '--cell_num': 1, '--eps': 6.283185307179586, '--blocks': [0, 1, 2, 3, 4, 5, 6, 9], '--kernel_size': 5, '--max_order': 2, '--dx': 0.19634954084936207, '--hidden_layers': 5, '--scheme': 'upwind', '--dataname': 'burgers', '--viscosity': 0.05, '--zoom': 4, '--max_dt': 0.000625, '--batch_size': 28, '--data_timescheme': 'rk2', '--channel_names': 'u,v', '--freq': 4, '--data_start_time': 1.0, '--start_noise': 0.001, '--end_noise': 0.001, '--stablize': 0.0, '--sparsity': 0.0, '--momentsparsity': 0.001, '--npseed': -1, '--torchseed': -1, '--maxiter': 2000, '--recordfile': 'None', '--recordcycle': 200, '--savecycle': -1, '--start_from': -1}
Traceback (most recent call last):
  File "train.py", line 58, in <module>
    globalnames, callback, model, data_model, sampling, addnoise = setenv.setenv(options)
  File "/data/users2/sajad/code/PDE-Net/setenv.py", line 68, in setenv
    globalnames, callback, model = _set_model(options)
  File "/data/users2/sajad/code/PDE-Net/setenv.py", line 45, in _set_model
    model.to(globalnames['device'])
  File "/home/users/mabavisani/anaconda3/envs/PDE-Net-2/lib/python3.7/site-packages/torch/nn/modules/module.py", line 386, in to
    return self._apply(convert)
  File "/home/users/mabavisani/anaconda3/envs/PDE-Net-2/lib/python3.7/site-packages/torch/nn/modules/module.py", line 193, in _apply
    module._apply(fn)
  File "/home/users/mabavisani/anaconda3/envs/PDE-Net-2/lib/python3.7/site-packages/torch/nn/modules/module.py", line 193, in _apply
    module._apply(fn)
  File "/home/users/mabavisani/anaconda3/envs/PDE-Net-2/lib/python3.7/site-packages/torch/nn/modules/module.py", line 205, in _apply
    self._buffers[key] = fn(buf)
  File "/home/users/mabavisani/anaconda3/envs/PDE-Net-2/lib/python3.7/site-packages/torch/nn/modules/module.py", line 384, in convert
    return t.to(device, dtype if t.is_floating_point() else None, non_blocking)
RuntimeError: CUDA error: invalid device ordinal
{'--name': 'burgers-2-upwind-sparse0-noise0.001-id0', '--dtype': 'double', '--device': 'cuda:0', '--constraint': '2', '--dt': 0.01, '--cell_num': 1, '--eps': 6.283185307179586, '--blocks': [0, 1, 2, 3, 4, 5, 6, 9], '--kernel_size': 5, '--max_order': 2, '--dx': 0.19634954084936207, '--hidden_layers': 5, '--scheme': 'upwind', '--dataname': 'burgers', '--viscosity': 0.05, '--zoom': 4, '--max_dt': 0.000625, '--batch_size': 28, '--data_timescheme': 'rk2', '--channel_names': 'u,v', '--freq': 4, '--data_start_time': 1.0, '--start_noise': 0.001, '--end_noise': 0.001, '--stablize': 0.0, '--sparsity': 0.0, '--momentsparsity': 0.001, '--npseed': -1, '--torchseed': -1, '--maxiter': 2000, '--recordfile': 'None', '--recordcycle': 200, '--savecycle': -1, '--start_from': -1}
block:  0
name:  burgers-2-upwind-sparse0-noise0.001-id0
device:  cuda:0
generate a random number to check random seed:  0.8634241185307027
current stage is: warmup
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.9266, device='cuda:0', dtype=torch.float64)
u_obs variance
tensor([ 0.2542,  2.2031,  1.8976, 20.5907, 10.5225, 16.5237,  0.2597,  2.0804,
         2.2772, 18.2798, 10.9685, 21.2800], device='cuda:0',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
iter:     0    time: 13.55
Func: 5.50e+00  |g|: 2.24e+00
stableloss: 2.90e-03   dataloss: 5.50e+00   sparseloss: 2.54e+01 momentloss: 7.27e+00
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 0.044781
         Iterations: 183
         Function evaluations: 242
         Gradient evaluations: 236
convolution moment and kernels
[[1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
[[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 1. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
[[ 0.    1.    0.   -0.33 -0.25]
 [ 0.    0.    0.    0.    0.  ]
 [ 0.    0.    0.    0.    0.  ]
 [ 0.    0.    0.    0.    0.  ]
 [ 0.    0.    0.    0.    0.  ]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]
 [ 2.78e-17  3.33e-16 -1.50e+00  2.00e+00 -5.00e-01]
 [ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]]
[[ 0.    0.    0.    0.    0.  ]
 [ 1.    0.    0.    0.    0.  ]
 [ 0.    0.    0.    0.    0.  ]
 [-0.33  0.    0.    0.    0.  ]
 [-0.25  0.    0.    0.    0.  ]]
[[ 0.00e+00  0.00e+00  2.78e-17  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  3.33e-16  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00 -1.50e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  2.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00 -5.00e-01  0.00e+00  0.00e+00]]
[[0.   0.   1.   0.   0.08]
 [0.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.  ]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]
 [-2.22e-16  1.00e+00 -2.00e+00  1.00e+00 -1.53e-16]
 [ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]]
[[0. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
[[ 6.94e-03 -5.56e-02  9.25e-18  5.56e-02 -6.94e-03]
 [-5.56e-02  4.44e-01 -7.40e-17 -4.44e-01  5.56e-02]
 [ 9.25e-18 -7.40e-17  1.23e-32  7.40e-17 -9.25e-18]
 [ 5.56e-02 -4.44e-01  7.40e-17  4.44e-01 -5.56e-02]
 [-6.94e-03  5.56e-02 -9.25e-18 -5.56e-02  6.94e-03]]
[[0.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.  ]
 [1.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.  ]
 [0.08 0.   0.   0.   0.  ]]
[[ 0.00e+00  0.00e+00 -2.22e-16  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  1.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00 -2.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  1.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00 -1.53e-16  0.00e+00  0.00e+00]]
SymNet parameters
[[-4.99e-02 -1.37e+00 -8.92e-01  7.47e-01 -1.64e-01 -1.44e-01 -1.10e+00  6.27e-02
  -2.90e-01  5.72e-02 -9.48e-02  5.87e-02]
 [-6.36e-01 -5.24e-01 -1.52e-01 -1.38e-01 -1.40e-03  4.48e-02 -2.66e-01  1.03e-02
   6.57e-02  4.58e-03 -7.57e-04 -1.19e-02]]
SymNet parameters
[0.09 0.01]
SymNet parameters
[[ 0.11  0.17  0.04  0.12 -0.02 -0.02 -0.59  0.01 -0.04  0.01 -0.01  0.01 -0.  ]
 [ 0.28 -0.55 -0.43  0.08  0.15 -0.12 -0.35 -0.11 -0.11 -0.08  0.08  0.01  0.02]]
SymNet parameters
[0.05 0.19]
SymNet parameters
[[ 0.19 -0.03  0.18  0.33 -0.36 -0.5  -0.14 -0.33  0.1  -0.02 -0.11 -0.13  0.68 -0.15]
 [ 0.35 -0.05 -0.03  0.64  0.07 -0.36  0.03  0.24 -0.04 -0.16 -0.04  0.06 -0.02  0.24]]
SymNet parameters
[-0.21 -0.05]
SymNet parameters
[[-4.34e-01 -8.40e-01 -3.98e-01 -2.00e-01  3.52e-02  4.17e-02  1.14e+00 -1.71e-02
   7.73e-02 -1.02e-02  1.95e-02 -1.85e-02  7.49e-03 -3.50e-02 -7.12e-05]
 [-1.66e+00 -1.95e-01  9.96e-01 -2.26e-01  1.60e-01 -2.49e-02 -4.92e-01 -9.21e-02
   3.41e-02 -7.27e-02  9.01e-02 -1.55e-02  1.26e-02  5.94e-03 -9.74e-04]]
SymNet parameters
[-0.41 -0.32]
SymNet parameters
[[ 7.05e-01 -4.82e-01 -2.34e-01 -8.86e-02  1.38e-02  2.10e-02 -1.18e+00 -3.67e-03
   3.29e-02 -3.66e-03  6.34e-03 -6.85e-03  4.99e-03 -1.27e-02  1.38e-03 -4.69e-03]
 [-6.89e-01  7.39e-01 -7.93e-01 -1.81e-01  2.64e-02  3.93e-02  4.33e-02 -1.04e-02
   6.90e-02 -6.95e-03  1.64e-02 -1.82e-02  4.72e-05  4.21e-03 -1.98e-03 -1.88e-03]]
SymNet parameters
[-0.01  0.09]
SymNet parameters
[[ 2.34e-01  4.58e-02 -9.22e-02  8.00e-02 -1.70e-02  3.11e-02 -1.59e-01  1.08e-02
  -1.02e-02  7.46e-03 -1.19e-02  5.06e-03 -2.10e-01 -4.40e-01  2.61e-05 -2.42e-01
  -4.04e-01]]
SymNet parameters
[0.04]
SymNet parameters
[[ 0.52 -0.04  0.03 -0.    0.   -0.02 -0.13  0.54  1.13 -0.06  0.06  0.06]
 [-0.41  0.01 -0.01 -0.    0.    0.   -0.81 -0.06  0.1   0.   -0.01 -0.  ]]
SymNet parameters
[-0.21  0.1 ]
SymNet parameters
[[ 0.23 -0.03  0.03 -0.01  0.01 -0.03  0.32 -1.03 -0.08 -0.08  0.08  0.07  0.03]
 [ 0.93  0.07 -0.05 -0.02  0.03 -0.   -0.21  0.06  0.11  0.01 -0.06 -0.01  0.1 ]]
SymNet parameters
[ 0.18 -0.21]
SymNet parameters
[[-0.15  0.08 -0.04 -0.04  0.06 -0.04 -0.45  0.9  -0.89 -0.08 -0.01  0.07  0.21 -0.01]
 [ 1.02 -0.04  0.05  0.01 -0.02 -0.01 -0.84 -0.23 -0.3  -0.02  0.05  0.03 -0.06 -0.01]]
SymNet parameters
[-0.05  0.11]
SymNet parameters
[[ 1.53e-01 -4.49e-02  1.90e-01 -2.62e-01 -3.91e-02 -2.76e-01 -3.51e-02 -1.64e-01
  -3.63e-01  1.55e-01  1.58e-01  2.94e-01 -3.80e-01  7.52e-02 -1.97e-02]
 [-1.66e-01  1.48e-01  1.31e-01  6.66e-01  1.40e-01  8.08e-01 -1.44e-01  3.29e-01
   2.88e-01  2.17e-01  1.80e-04  1.15e-02 -8.26e-02 -2.91e-02 -1.91e-01]]
SymNet parameters
[ 0.18 -0.1 ]
SymNet parameters
[[-2.61e-01  2.73e-01 -1.48e-01 -6.41e-02  8.04e-02 -1.67e-03 -3.77e-01 -3.22e-02
   7.90e-01  6.77e-02 -2.24e-01 -7.27e-02  3.38e-01 -2.72e-02 -7.83e-03  6.86e-04]
 [ 3.10e-01  3.60e-03 -2.70e-02  1.22e-02 -2.13e-02  3.17e-02 -6.76e-01  2.85e-01
   4.09e-02  7.15e-02 -5.04e-02 -6.32e-02 -5.70e-02 -9.17e-03  9.27e-03  3.45e-04]]
SymNet parameters
[0.08 0.15]
SymNet parameters
[[-1.57e-01 -1.27e-02  9.43e-03  2.64e-03 -5.05e-03 -3.04e-03 -2.71e-02 -1.36e-01
  -1.27e-01  2.67e-02  1.89e-02  4.12e-02  5.85e-01  5.02e-01 -2.50e-01  1.54e-05
   2.42e-01]]
SymNet parameters
[0.03]
finally, finish this stage
iter:   183    time: 17.06
Func: 4.48e-02  |g|: 2.68e-02
stableloss: 1.19e-02   dataloss: 4.48e-02   sparseloss: 5.94e+01 momentloss: 7.27e+00
current expression:
[u10*v00, u00*u01, u20, u02, v00, u00**2*v00, u01, u10, u00*u01**2, u01*u10*v00, u00*v00, u00**2*u01, u00*u01*u10, u00**2*u02, u00, v00*v10, u00*v10, u02*v00, u01**2, v10]
[-0.88 -0.88  0.04  0.03 -0.01  0.01 -0.01 -0.01  0.01  0.01  0.    0.    0.   -0.
  0.   -0.   -0.    0.   -0.    0.  ]
[v00*v10, u00*v01, v02, v20, v00, u00*v01*v10, v00*v10**2, 1, u11, u10*v01, v00*v20, v00**2, v10*v20, u00*v10, u00*u01, u10*v00*v10, u00, v01, u00*u20, u00**2*v10]
[-0.88 -0.88  0.04  0.03 -0.01  0.01  0.01  0.01 -0.   -0.   -0.   -0.    0.    0.
  0.    0.   -0.   -0.   -0.    0.  ]
block:  1
name:  burgers-2-upwind-sparse0-noise0.001-id0
device:  cuda:0
generate a random number to check random seed:  -1.4914458473383874
current stage is: block-1
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.9070, device='cuda:0', dtype=torch.float64)
u_obs variance
tensor([ 0.2449,  2.0300,  1.8371, 18.6653,  9.2673, 15.7378,  0.2567,  1.9564,
         2.1156, 17.0327,  9.6572, 19.7068], device='cuda:0',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
iter:     0    time: 1595.29
Func: 4.99e-02  |g|: 5.68e-01
stableloss: 1.35e-02   dataloss: 4.26e-02   sparseloss: 5.94e+01 momentloss: 7.27e+00
iter:   200    time: 10.50
Func: 2.13e-02  |g|: 4.48e-02
stableloss: 1.15e-02   dataloss: 1.47e-02   sparseloss: 6.11e+01 momentloss: 6.58e+00
iter:   400    time: 10.53
Func: 1.97e-02  |g|: 1.40e-02
stableloss: 1.02e-02   dataloss: 1.31e-02   sparseloss: 7.03e+01 momentloss: 6.53e+00
iter:   600    time: 10.50
Func: 1.93e-02  |g|: 1.36e-02
stableloss: 1.02e-02   dataloss: 1.28e-02   sparseloss: 7.48e+01 momentloss: 6.53e+00
iter:   800    time: 10.51
Func: 1.91e-02  |g|: 1.77e-02
stableloss: 1.04e-02   dataloss: 1.26e-02   sparseloss: 8.14e+01 momentloss: 6.52e+00
iter:  1000    time: 10.59
Func: 1.89e-02  |g|: 3.24e-02
stableloss: 1.03e-02   dataloss: 1.24e-02   sparseloss: 9.07e+01 momentloss: 6.51e+00
iter:  1200    time: 10.48
Func: 1.87e-02  |g|: 1.75e-02
stableloss: 1.03e-02   dataloss: 1.22e-02   sparseloss: 9.31e+01 momentloss: 6.52e+00
iter:  1400    time: 10.47
Func: 1.85e-02  |g|: 6.14e-03
stableloss: 1.02e-02   dataloss: 1.20e-02   sparseloss: 9.25e+01 momentloss: 6.52e+00
iter:  1600    time: 10.53
Func: 1.85e-02  |g|: 8.05e-03
stableloss: 1.01e-02   dataloss: 1.19e-02   sparseloss: 9.54e+01 momentloss: 6.51e+00
iter:  1800    time: 10.46
Func: 1.84e-02  |g|: 1.35e-02
stableloss: 1.01e-02   dataloss: 1.19e-02   sparseloss: 1.00e+02 momentloss: 6.51e+00
Warning: Maximum number of iterations has been exceeded.
         Current function value: 0.018371
         Iterations: 2000
         Function evaluations: 2004
         Gradient evaluations: 2004
convolution moment and kernels
[[ 1.00e+00  0.00e+00  2.24e-05  1.79e-03 -2.78e-02]
 [ 0.00e+00 -5.32e-05 -1.32e-03  1.07e-03 -2.64e-03]
 [ 6.99e-05  2.15e-03  3.68e-03  7.78e-04 -1.32e-03]
 [ 5.88e-02  8.22e-04 -4.25e-03 -9.54e-04  4.53e-03]
 [-5.87e-02  2.87e-03 -3.86e-03 -1.07e-02  3.89e-03]]
[[ 0.01 -0.02 -0.07  0.   -0.  ]
 [-0.03  0.11  0.19  0.02  0.01]
 [ 0.03 -0.11  0.72  0.03 -0.03]
 [-0.05  0.18 -0.02  0.07 -0.  ]
 [ 0.01 -0.05  0.03 -0.02  0.  ]]
[[ 0.00e+00  1.00e+00  0.00e+00 -9.74e-02 -6.84e-02]
 [ 0.00e+00  0.00e+00 -2.65e-03  1.13e-03  1.01e-03]
 [ 0.00e+00  4.33e-03 -1.91e-04  9.73e-03 -6.61e-03]
 [ 3.41e-03  2.29e-03  9.02e-04 -3.19e-03 -2.96e-03]
 [ 1.32e-02 -3.01e-02 -3.41e-03 -1.25e-02 -1.38e-03]]
[[ 0.    0.    0.03 -0.02 -0.  ]
 [-0.03  0.02 -0.13  0.08  0.01]
 [ 0.11 -0.52 -0.23  0.95 -0.22]
 [-0.02 -0.   -0.08  0.03  0.02]
 [ 0.    0.01  0.01  0.   -0.01]]
[[ 0.00e+00  0.00e+00  0.00e+00  9.43e-03  6.06e-03]
 [ 1.00e+00  0.00e+00  1.96e-02 -1.91e-03 -6.25e-03]
 [ 0.00e+00 -2.24e-03  2.45e-03 -2.66e-03  1.12e-04]
 [-8.93e-02  5.85e-04  6.98e-03 -9.25e-04 -1.75e-02]
 [-5.86e-02  1.39e-03 -9.10e-03 -8.69e-04 -2.68e-03]]
[[ 6.78e-03 -3.84e-02  1.31e-01 -3.60e-02  6.22e-03]
 [-6.13e-03  6.05e-02 -6.21e-01  4.93e-02 -4.53e-03]
 [-9.48e-03 -3.83e-02 -2.61e-01 -4.15e-02 -9.33e-04]
 [ 1.99e-02 -3.02e-02  1.02e+00 -4.15e-02  2.10e-02]
 [-9.69e-03  3.16e-02 -2.34e-01  3.60e-02 -1.09e-02]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00 -3.85e-03]
 [ 0.00e+00  0.00e+00  0.00e+00 -1.24e-03  4.47e-04]
 [ 0.00e+00  0.00e+00  2.92e-03 -1.24e-03 -1.30e-03]
 [ 0.00e+00 -9.05e-04 -7.18e-04  1.14e-03  2.33e-05]
 [ 1.89e-03 -3.10e-03 -2.26e-03  1.67e-03 -1.78e-03]]
[[-2.23e-03  6.57e-03 -2.61e-03  8.47e-04 -6.92e-04]
 [ 8.22e-03 -1.81e-02 -7.48e-03  9.91e-03 -6.23e-05]
 [-1.01e-01  1.38e+00 -2.50e+00  1.33e+00 -8.47e-02]
 [ 1.08e-02 -2.36e-02 -7.78e-03  1.48e-02 -1.75e-03]
 [-2.98e-03  7.77e-03 -1.12e-03 -1.86e-03  6.59e-05]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00 -6.57e-04]
 [ 0.00e+00  1.00e+00  0.00e+00 -6.51e-04 -2.58e-03]
 [ 0.00e+00  0.00e+00  1.25e-03 -6.63e-04 -1.80e-03]
 [ 0.00e+00 -1.00e-03 -1.77e-03  1.60e-03  3.42e-03]
 [ 3.26e-03 -8.55e-04 -3.01e-03  1.43e-03  4.47e-03]]
[[ 0.01 -0.07  0.03  0.04 -0.  ]
 [-0.07  0.51 -0.13 -0.36  0.04]
 [ 0.03 -0.14  0.26 -0.16  0.04]
 [ 0.03 -0.33 -0.2   0.58 -0.09]
 [-0.    0.03  0.05 -0.09  0.02]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  1.55e-03]
 [ 0.00e+00  0.00e+00  0.00e+00 -6.44e-04 -9.23e-04]
 [ 1.00e+00  0.00e+00  1.59e-03  4.54e-04  8.28e-04]
 [ 0.00e+00 -9.50e-04 -7.04e-04  9.14e-04  1.02e-03]
 [-2.40e-03 -7.01e-04  1.19e-03 -1.82e-03 -7.29e-03]]
[[-0.01  0.03 -0.14  0.04 -0.01]
 [ 0.03 -0.12  1.54 -0.14  0.04]
 [-0.04  0.17 -2.79  0.19 -0.05]
 [ 0.03 -0.11  1.52 -0.12  0.03]
 [-0.01  0.03 -0.13  0.03 -0.01]]
SymNet parameters
[[ 0.64 -2.22 -0.93  0.69  0.07  0.09 -1.02 -0.24 -0.67  0.03  0.04  0.09]
 [-0.14  0.08 -0.11 -0.07 -0.02 -0.   -1.14  0.    0.08 -0.   -0.   -0.01]]
SymNet parameters
[ 1.2  -0.51]
SymNet parameters
[[-0.25  0.14 -0.16 -0.09 -0.02 -0.01 -1.67  0.02  0.09 -0.   -0.01 -0.01  0.  ]
 [ 0.54 -1.6  -0.7   0.5   0.09  0.08 -0.78 -0.19 -0.46  0.02  0.03  0.06 -0.  ]]
SymNet parameters
[-0.75  0.63]
SymNet parameters
[[-0.27  2.13 -1.53 -0.57 -0.09 -0.05 -1.93  0.18  0.16 -0.03 -0.05 -0.09 -1.71  1.78]
 [ 0.87  1.43  0.19  0.55  0.24  0.42 -0.81 -0.8   0.48  0.07 -0.    0.09 -1.28  1.12]]
SymNet parameters
[-0.18 -0.04]
SymNet parameters
[[-1.74e+00 -4.31e-02 -3.10e-02 -1.53e-02 -6.18e-03 -6.62e-03  1.25e+00  2.10e-02
   1.55e-03 -1.73e-03 -7.42e-04 -2.78e-03  6.51e-02 -6.15e-02  4.25e-04]
 [-2.64e+00 -1.24e+00  9.15e-01  3.04e-01  5.42e-02  3.98e-02 -8.58e-01 -1.01e-01
  -2.74e-01  1.16e-02  1.51e-02  3.92e-02  1.48e-01 -1.38e-01  1.89e-03]]
SymNet parameters
[-0.09 -0.11]
SymNet parameters
[[ 1.09e+00  2.72e-01 -2.94e-01 -1.92e-01 -3.75e-02 -2.40e-02 -5.98e-01  5.73e-02
   1.87e-01 -7.71e-03 -1.02e-02 -2.47e-02  8.80e-03 -8.05e-03  1.24e-04 -2.93e-03]
 [-2.46e+00  3.32e-01  1.07e-01 -1.05e-01 -2.38e-02 -1.46e-02 -1.48e-01  3.81e-02
   1.10e-01 -5.89e-03 -6.50e-03 -1.34e-02  8.32e-02 -7.94e-02  4.86e-04 -3.82e-03]]
SymNet parameters
[-0.33 -0.23]
SymNet parameters
[[ 0.5   0.36  0.15 -0.05 -0.02  0.03 -0.01  0.04  0.08 -0.   -0.01 -0.01  0.04 -0.38
   0.01 -0.47 -0.79]]
SymNet parameters
[-0.07]
SymNet parameters
[[ 2.34e-01 -3.88e-01 -2.31e-01  5.18e-03 -1.35e-02  5.68e-03 -7.71e-01  4.18e-01
   6.73e-01  2.30e-02 -6.05e-02  2.16e-01]
 [ 1.59e-01  8.58e-03 -1.22e-03 -1.15e-03 -5.02e-04 -3.96e-04 -1.25e+00 -1.17e-01
  -1.15e-02  1.70e-03 -1.26e-03  4.20e-04]]
SymNet parameters
[-0.3   0.12]
SymNet parameters
[[ 4.52e-02  5.59e-02 -1.29e-01 -6.03e-04 -3.03e-03 -2.08e-03  1.18e-01 -2.08e+00
  -5.10e-01  7.18e-04 -3.74e-02  1.01e-01  6.56e-02]
 [ 1.07e+00  1.88e-02  3.60e-02 -4.18e-04  3.47e-04 -4.24e-04  1.04e-01 -5.50e-02
  -2.50e-02 -1.32e-03  7.64e-03 -2.47e-02  9.17e-03]]
SymNet parameters
[1.19 0.47]
SymNet parameters
[[ 2.74e-01 -6.18e-02 -4.97e-01  2.42e-03 -1.47e-02 -4.22e-03 -9.92e-01  1.01e+00
  -1.16e+00  2.23e-02 -1.23e-01  4.09e-01  7.14e-03 -1.98e-02]
 [ 6.50e-01  3.55e-02  8.00e-03  1.33e-04  2.81e-03 -8.96e-04 -1.22e+00  9.22e-02
   5.71e-02  3.26e-04  1.69e-03 -8.44e-03 -1.61e-02  1.16e-03]]
SymNet parameters
[-0.37  0.53]
SymNet parameters
[[ 2.82e-01 -2.85e-01 -4.45e-01  1.09e-02 -1.55e-02  5.10e-03 -6.43e-01 -2.97e+00
  -2.09e-01  1.46e-02  2.05e-01  3.84e-01  1.11e-01  2.92e-02 -2.13e-02]
 [-3.55e+00  7.49e-02  2.44e-01 -5.63e-03  2.35e-03  5.39e-03 -1.79e-01  1.12e-01
  -1.11e-01 -8.63e-03 -3.21e-03  7.06e-02 -3.93e-02 -9.32e-03  1.17e-02]]
SymNet parameters
[ 0.15 -0.13]
SymNet parameters
[[ 2.50e-01  1.23e+00 -1.16e-01 -9.77e-03  2.77e-02 -2.69e-02  8.32e-01  4.64e-01
   2.00e+00 -3.91e-02 -9.45e-03 -3.63e-03  6.11e-03  2.59e-01  9.62e-04  5.85e-02]
 [ 1.75e-02  4.43e-03 -1.80e-02 -3.16e-04 -1.35e-03  2.39e-04 -1.10e+00 -2.18e-02
  -6.58e-02 -1.24e-03 -3.19e-03  1.18e-02 -1.08e-02 -1.43e-02  1.19e-02  1.14e-03]]
SymNet parameters
[0.17 0.21]
SymNet parameters
[[-5.02e-01 -3.66e-02 -3.38e-02  9.71e-04 -1.22e-03  7.99e-05 -1.59e-01  4.48e-01
  -1.30e-01  5.44e-02 -7.80e-03  7.69e-02  4.08e-01  3.59e-01 -2.22e-01 -3.20e-03
   1.42e-01]]
SymNet parameters
[-0.24]
finally, finish this stage
iter:  2000    time: 10.53
Func: 1.84e-02  |g|: 2.12e-02
stableloss: 1.02e-02   dataloss: 1.19e-02   sparseloss: 9.71e+01 momentloss: 6.51e+00
current expression:
[u00*u01, u10*v00, u20, u02, u00*u01**2, u00, u10, u01*u10*v00, u00*u11*v00, u00**2*u01, 1, u00**3, u00**2*u10, v01, u10*v00*v10, u01, u01*u10, u00*u01*v00, u00*u10*v01, u00*u01*u10*v00]
[-0.98 -0.98  0.05  0.05  0.02  0.02  0.01  0.01  0.01 -0.01  0.01 -0.01 -0.01  0.01
  0.    0.   -0.   -0.    0.    0.  ]
[v00*v10, u00*v01, v02, v20, v00, v00*v10**2, u00*v00*v11, u00*u01*v01, u10*v00*v01, u00*v01*v10, u01, u10*v01, v10**2, u10, u00**2*v00, u00*v00, v00**3, u00*v00*v10, v00**2*v20, u00**2*v01]
[-0.98 -0.97  0.05  0.05  0.01  0.01  0.01  0.01  0.01  0.01  0.01 -0.01 -0.    0.
 -0.    0.   -0.   -0.    0.   -0.  ]
block:  2
name:  burgers-2-upwind-sparse0-noise0.001-id0
device:  cuda:0
generate a random number to check random seed:  -3.794844068240575
current stage is: block-2
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.7808, device='cuda:0', dtype=torch.float64)
u_obs variance
tensor([ 0.2622,  1.7698,  1.8045, 22.8325, 11.3518, 22.3110,  0.2501,  1.5800,
         1.6156, 18.3763,  9.2172, 21.1003], device='cuda:0',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 0.075121
         Iterations: 0
         Function evaluations: 15
         Gradient evaluations: 3
convolution moment and kernels
[[ 1.00e+00  0.00e+00  2.28e-05  1.79e-03 -2.78e-02]
 [ 0.00e+00 -5.30e-05 -1.32e-03  1.07e-03 -2.64e-03]
 [ 6.90e-05  2.16e-03  3.68e-03  7.76e-04 -1.31e-03]
 [ 5.88e-02  8.22e-04 -4.25e-03 -9.55e-04  4.53e-03]
 [-5.87e-02  2.86e-03 -3.86e-03 -1.07e-02  3.88e-03]]
[[ 0.01 -0.02 -0.07  0.   -0.  ]
 [-0.03  0.11  0.19  0.02  0.01]
 [ 0.03 -0.11  0.72  0.03 -0.03]
 [-0.05  0.18 -0.02  0.07 -0.  ]
 [ 0.01 -0.05  0.03 -0.02  0.  ]]
[[ 0.00e+00  1.00e+00  0.00e+00 -9.74e-02 -6.84e-02]
 [ 0.00e+00  0.00e+00 -2.65e-03  1.13e-03  1.01e-03]
 [ 0.00e+00  4.32e-03 -1.93e-04  9.74e-03 -6.61e-03]
 [ 3.42e-03  2.29e-03  9.00e-04 -3.19e-03 -2.96e-03]
 [ 1.32e-02 -3.01e-02 -3.41e-03 -1.25e-02 -1.38e-03]]
[[ 0.    0.    0.03 -0.02 -0.  ]
 [-0.03  0.02 -0.13  0.08  0.01]
 [ 0.11 -0.52 -0.23  0.95 -0.22]
 [-0.02 -0.   -0.08  0.03  0.02]
 [ 0.    0.01  0.01  0.   -0.01]]
[[ 0.00e+00  0.00e+00  0.00e+00  9.43e-03  6.07e-03]
 [ 1.00e+00  0.00e+00  1.96e-02 -1.91e-03 -6.25e-03]
 [ 0.00e+00 -2.24e-03  2.45e-03 -2.67e-03  1.09e-04]
 [-8.93e-02  5.86e-04  6.98e-03 -9.26e-04 -1.75e-02]
 [-5.86e-02  1.38e-03 -9.10e-03 -8.61e-04 -2.67e-03]]
[[ 6.77e-03 -3.83e-02  1.31e-01 -3.60e-02  6.22e-03]
 [-6.11e-03  6.04e-02 -6.21e-01  4.94e-02 -4.55e-03]
 [-9.50e-03 -3.83e-02 -2.61e-01 -4.17e-02 -8.79e-04]
 [ 1.99e-02 -3.02e-02  1.02e+00 -4.14e-02  2.09e-02]
 [-9.69e-03  3.16e-02 -2.34e-01  3.60e-02 -1.09e-02]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00 -3.85e-03]
 [ 0.00e+00  0.00e+00  0.00e+00 -1.24e-03  4.46e-04]
 [ 0.00e+00  0.00e+00  2.92e-03 -1.24e-03 -1.30e-03]
 [ 0.00e+00 -9.05e-04 -7.18e-04  1.14e-03  2.36e-05]
 [ 1.89e-03 -3.10e-03 -2.26e-03  1.67e-03 -1.78e-03]]
[[-2.24e-03  6.58e-03 -2.61e-03  8.47e-04 -6.92e-04]
 [ 8.23e-03 -1.82e-02 -7.47e-03  9.92e-03 -6.54e-05]
 [-1.01e-01  1.38e+00 -2.50e+00  1.33e+00 -8.47e-02]
 [ 1.08e-02 -2.36e-02 -7.78e-03  1.48e-02 -1.76e-03]
 [-2.98e-03  7.78e-03 -1.12e-03 -1.86e-03  6.67e-05]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00 -6.58e-04]
 [ 0.00e+00  1.00e+00  0.00e+00 -6.51e-04 -2.58e-03]
 [ 0.00e+00  0.00e+00  1.25e-03 -6.63e-04 -1.80e-03]
 [ 0.00e+00 -1.00e-03 -1.77e-03  1.60e-03  3.42e-03]
 [ 3.26e-03 -8.54e-04 -3.01e-03  1.43e-03  4.47e-03]]
[[ 0.01 -0.07  0.03  0.04 -0.  ]
 [-0.07  0.51 -0.13 -0.36  0.04]
 [ 0.03 -0.14  0.26 -0.16  0.04]
 [ 0.03 -0.33 -0.2   0.58 -0.09]
 [-0.    0.03  0.05 -0.09  0.02]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  1.55e-03]
 [ 0.00e+00  0.00e+00  0.00e+00 -6.44e-04 -9.23e-04]
 [ 1.00e+00  0.00e+00  1.59e-03  4.53e-04  8.28e-04]
 [ 0.00e+00 -9.50e-04 -7.05e-04  9.14e-04  1.02e-03]
 [-2.40e-03 -7.03e-04  1.19e-03 -1.82e-03 -7.30e-03]]
[[-0.01  0.03 -0.14  0.04 -0.01]
 [ 0.03 -0.12  1.54 -0.14  0.04]
 [-0.04  0.17 -2.79  0.19 -0.05]
 [ 0.03 -0.11  1.52 -0.12  0.03]
 [-0.01  0.03 -0.13  0.03 -0.01]]
SymNet parameters
[[ 0.64 -2.22 -0.93  0.69  0.07  0.09 -1.02 -0.24 -0.67  0.03  0.04  0.09]
 [-0.14  0.08 -0.11 -0.07 -0.02 -0.   -1.14  0.    0.08 -0.   -0.   -0.01]]
SymNet parameters
[ 1.2  -0.51]
SymNet parameters
[[-0.25  0.14 -0.16 -0.09 -0.02 -0.01 -1.67  0.02  0.09 -0.   -0.01 -0.01  0.  ]
 [ 0.54 -1.6  -0.7   0.5   0.09  0.08 -0.78 -0.19 -0.46  0.02  0.03  0.06 -0.  ]]
SymNet parameters
[-0.75  0.63]
SymNet parameters
[[-0.27  2.13 -1.53 -0.57 -0.09 -0.05 -1.93  0.18  0.16 -0.03 -0.05 -0.09 -1.71  1.78]
 [ 0.87  1.43  0.19  0.55  0.24  0.42 -0.81 -0.8   0.48  0.07 -0.    0.09 -1.28  1.12]]
SymNet parameters
[-0.18 -0.04]
SymNet parameters
[[-1.74e+00 -4.31e-02 -3.10e-02 -1.53e-02 -6.20e-03 -6.56e-03  1.25e+00  2.09e-02
   1.57e-03 -1.73e-03 -7.31e-04 -2.76e-03  6.52e-02 -6.14e-02  3.68e-04]
 [-2.64e+00 -1.24e+00  9.15e-01  3.04e-01  5.42e-02  3.98e-02 -8.58e-01 -1.01e-01
  -2.74e-01  1.16e-02  1.51e-02  3.92e-02  1.48e-01 -1.38e-01  1.57e-03]]
SymNet parameters
[-0.09 -0.11]
SymNet parameters
[[ 1.09e+00  2.72e-01 -2.94e-01 -1.92e-01 -3.75e-02 -2.39e-02 -5.98e-01  5.73e-02
   1.87e-01 -7.69e-03 -1.02e-02 -2.47e-02  8.69e-03 -8.17e-03 -5.82e-04 -2.89e-03]
 [-2.46e+00  3.32e-01  1.07e-01 -1.05e-01 -2.38e-02 -1.47e-02 -1.48e-01  3.81e-02
   1.10e-01 -5.90e-03 -6.51e-03 -1.34e-02  8.31e-02 -7.95e-02  5.41e-04 -3.80e-03]]
SymNet parameters
[-0.33 -0.23]
SymNet parameters
[[ 0.5   0.36  0.15 -0.05 -0.02  0.03 -0.01  0.04  0.08 -0.   -0.01 -0.01  0.04 -0.38
   0.01 -0.47 -0.79]]
SymNet parameters
[-0.07]
SymNet parameters
[[ 2.34e-01 -3.88e-01 -2.31e-01  5.18e-03 -1.35e-02  5.68e-03 -7.71e-01  4.18e-01
   6.73e-01  2.30e-02 -6.05e-02  2.16e-01]
 [ 1.59e-01  8.58e-03 -1.22e-03 -1.14e-03 -4.98e-04 -3.84e-04 -1.25e+00 -1.17e-01
  -1.15e-02  1.69e-03 -1.25e-03  3.95e-04]]
SymNet parameters
[-0.3   0.12]
SymNet parameters
[[ 4.52e-02  5.59e-02 -1.29e-01 -5.96e-04 -3.03e-03 -2.07e-03  1.18e-01 -2.08e+00
  -5.10e-01  7.22e-04 -3.74e-02  1.01e-01  6.56e-02]
 [ 1.07e+00  1.88e-02  3.60e-02 -4.27e-04  3.49e-04 -4.34e-04  1.04e-01 -5.50e-02
  -2.50e-02 -1.33e-03  7.64e-03 -2.48e-02  9.17e-03]]
SymNet parameters
[1.19 0.47]
SymNet parameters
[[ 2.74e-01 -6.18e-02 -4.97e-01  2.42e-03 -1.47e-02 -4.23e-03 -9.92e-01  1.01e+00
  -1.16e+00  2.23e-02 -1.23e-01  4.09e-01  7.16e-03 -1.98e-02]
 [ 6.50e-01  3.55e-02  8.00e-03  1.31e-04  2.81e-03 -8.97e-04 -1.22e+00  9.22e-02
   5.71e-02  3.26e-04  1.69e-03 -8.41e-03 -1.61e-02  1.15e-03]]
SymNet parameters
[-0.37  0.53]
SymNet parameters
[[ 2.82e-01 -2.85e-01 -4.45e-01  1.09e-02 -1.55e-02  5.10e-03 -6.43e-01 -2.97e+00
  -2.09e-01  1.46e-02  2.05e-01  3.84e-01  1.11e-01  2.92e-02 -2.13e-02]
 [-3.55e+00  7.49e-02  2.44e-01 -5.63e-03  2.35e-03  5.39e-03 -1.79e-01  1.12e-01
  -1.11e-01 -8.63e-03 -3.21e-03  7.06e-02 -3.93e-02 -9.32e-03  1.17e-02]]
SymNet parameters
[ 0.15 -0.13]
SymNet parameters
[[ 2.50e-01  1.23e+00 -1.16e-01 -9.78e-03  2.77e-02 -2.69e-02  8.32e-01  4.64e-01
   2.00e+00 -3.91e-02 -9.45e-03 -3.63e-03  6.11e-03  2.59e-01  9.63e-04  5.85e-02]
 [ 1.75e-02  4.43e-03 -1.80e-02 -3.12e-04 -1.35e-03  2.43e-04 -1.10e+00 -2.18e-02
  -6.58e-02 -1.24e-03 -3.18e-03  1.18e-02 -1.08e-02 -1.43e-02  1.19e-02  1.16e-03]]
SymNet parameters
[0.17 0.21]
SymNet parameters
[[-5.02e-01 -3.66e-02 -3.38e-02  9.70e-04 -1.22e-03  8.15e-05 -1.59e-01  4.48e-01
  -1.30e-01  5.44e-02 -7.80e-03  7.69e-02  4.08e-01  3.59e-01 -2.22e-01 -3.25e-03
   1.42e-01]]
SymNet parameters
[-0.24]
finally, finish this stage
iter:     0    time: 1450.90
Func: 7.51e-02  |g|: 7.64e+00
stableloss: 1.33e-02   dataloss: 6.21e-02   sparseloss: 9.71e+01 momentloss: 6.51e+00
current expression:
[u00*u01, u10*v00, u20, u02, u00*u01**2, u00, u10, u01*u10*v00, u00*u11*v00, u00**2*u01, 1, u00**3, u00**2*u10, v01, u10*v00*v10, u01, u01*u10, u00*u01*v00, u00*u10*v01, u00*u01*u10*v00]
[-0.98 -0.98  0.05  0.05  0.02  0.02  0.01  0.01  0.01 -0.01  0.01 -0.01 -0.01  0.01
  0.    0.   -0.   -0.    0.    0.  ]
[v00*v10, u00*v01, v02, v20, v00, v00*v10**2, u00*v00*v11, u00*u01*v01, u10*v00*v01, u00*v01*v10, u01, u10*v01, v10**2, u10, u00**2*v00, u00*v00, v00**3, u00*v00*v10, v00**2*v20, u00**2*v01]
[-0.98 -0.97  0.05  0.05  0.01  0.01  0.01  0.01  0.01  0.01  0.01 -0.01 -0.    0.
 -0.    0.   -0.   -0.    0.   -0.  ]
block:  3
name:  burgers-2-upwind-sparse0-noise0.001-id0
device:  cuda:0
generate a random number to check random seed:  -0.6660946937919461
current stage is: block-3
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.5023, device='cuda:0', dtype=torch.float64)
u_obs variance
tensor([ 0.2566,  1.6419,  1.5803, 20.6731,  9.6464, 18.6126,  0.2323,  1.3862,
         1.5449, 16.0696,  8.5841, 21.6386], device='cuda:0',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 0.170944
         Iterations: 0
         Function evaluations: 15
         Gradient evaluations: 3
convolution moment and kernels
[[ 1.00e+00  0.00e+00  2.14e-05  1.79e-03 -2.78e-02]
 [ 0.00e+00 -5.38e-05 -1.32e-03  1.07e-03 -2.64e-03]
 [ 7.11e-05  2.15e-03  3.68e-03  7.78e-04 -1.32e-03]
 [ 5.88e-02  8.23e-04 -4.25e-03 -9.54e-04  4.53e-03]
 [-5.87e-02  2.87e-03 -3.86e-03 -1.07e-02  3.89e-03]]
[[ 0.01 -0.02 -0.07  0.   -0.  ]
 [-0.03  0.11  0.19  0.02  0.01]
 [ 0.03 -0.11  0.72  0.03 -0.03]
 [-0.05  0.18 -0.02  0.07 -0.  ]
 [ 0.01 -0.05  0.03 -0.02  0.  ]]
[[ 0.00e+00  1.00e+00  0.00e+00 -9.74e-02 -6.84e-02]
 [ 0.00e+00  0.00e+00 -2.65e-03  1.13e-03  1.01e-03]
 [ 0.00e+00  4.32e-03 -1.94e-04  9.73e-03 -6.61e-03]
 [ 3.41e-03  2.29e-03  9.02e-04 -3.19e-03 -2.96e-03]
 [ 1.32e-02 -3.01e-02 -3.41e-03 -1.25e-02 -1.38e-03]]
[[ 0.    0.    0.03 -0.02 -0.  ]
 [-0.03  0.02 -0.13  0.08  0.01]
 [ 0.11 -0.52 -0.23  0.95 -0.22]
 [-0.02 -0.   -0.08  0.03  0.02]
 [ 0.    0.01  0.01  0.   -0.01]]
[[ 0.00e+00  0.00e+00  0.00e+00  9.43e-03  6.06e-03]
 [ 1.00e+00  0.00e+00  1.96e-02 -1.91e-03 -6.25e-03]
 [ 0.00e+00 -2.24e-03  2.45e-03 -2.66e-03  1.09e-04]
 [-8.93e-02  5.84e-04  6.98e-03 -9.24e-04 -1.76e-02]
 [-5.86e-02  1.39e-03 -9.10e-03 -8.69e-04 -2.67e-03]]
[[ 6.78e-03 -3.84e-02  1.31e-01 -3.60e-02  6.22e-03]
 [-6.15e-03  6.06e-02 -6.21e-01  4.94e-02 -4.54e-03]
 [-9.45e-03 -3.85e-02 -2.61e-01 -4.16e-02 -9.07e-04]
 [ 1.98e-02 -3.01e-02  1.02e+00 -4.15e-02  2.09e-02]
 [-9.68e-03  3.16e-02 -2.34e-01  3.60e-02 -1.09e-02]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00 -3.84e-03]
 [ 0.00e+00  0.00e+00  0.00e+00 -1.24e-03  4.47e-04]
 [ 0.00e+00  0.00e+00  2.92e-03 -1.24e-03 -1.30e-03]
 [ 0.00e+00 -9.05e-04 -7.18e-04  1.14e-03  2.31e-05]
 [ 1.89e-03 -3.10e-03 -2.26e-03  1.67e-03 -1.77e-03]]
[[-2.23e-03  6.57e-03 -2.60e-03  8.39e-04 -6.90e-04]
 [ 8.21e-03 -1.81e-02 -7.53e-03  9.95e-03 -7.19e-05]
 [-1.01e-01  1.38e+00 -2.50e+00  1.32e+00 -8.47e-02]
 [ 1.08e-02 -2.35e-02 -7.82e-03  1.48e-02 -1.76e-03]
 [-2.97e-03  7.77e-03 -1.11e-03 -1.86e-03  6.77e-05]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00 -6.57e-04]
 [ 0.00e+00  1.00e+00  0.00e+00 -6.51e-04 -2.58e-03]
 [ 0.00e+00  0.00e+00  1.25e-03 -6.63e-04 -1.80e-03]
 [ 0.00e+00 -1.00e-03 -1.77e-03  1.60e-03  3.42e-03]
 [ 3.26e-03 -8.54e-04 -3.01e-03  1.43e-03  4.47e-03]]
[[ 0.01 -0.07  0.03  0.04 -0.  ]
 [-0.07  0.51 -0.13 -0.36  0.04]
 [ 0.03 -0.14  0.26 -0.16  0.04]
 [ 0.03 -0.33 -0.2   0.58 -0.09]
 [-0.    0.03  0.05 -0.09  0.02]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  1.55e-03]
 [ 0.00e+00  0.00e+00  0.00e+00 -6.44e-04 -9.23e-04]
 [ 1.00e+00  0.00e+00  1.59e-03  4.53e-04  8.28e-04]
 [ 0.00e+00 -9.50e-04 -7.04e-04  9.14e-04  1.02e-03]
 [-2.40e-03 -7.02e-04  1.19e-03 -1.82e-03 -7.29e-03]]
[[-0.01  0.03 -0.14  0.04 -0.01]
 [ 0.03 -0.12  1.54 -0.14  0.04]
 [-0.04  0.17 -2.79  0.19 -0.05]
 [ 0.03 -0.11  1.52 -0.12  0.03]
 [-0.01  0.03 -0.13  0.03 -0.01]]
SymNet parameters
[[ 0.64 -2.22 -0.93  0.69  0.07  0.09 -1.02 -0.24 -0.67  0.03  0.04  0.09]
 [-0.14  0.08 -0.11 -0.07 -0.02 -0.   -1.14  0.    0.08 -0.   -0.   -0.01]]
SymNet parameters
[ 1.2  -0.51]
SymNet parameters
[[-0.25  0.14 -0.16 -0.09 -0.02 -0.01 -1.67  0.02  0.09 -0.   -0.01 -0.01  0.  ]
 [ 0.54 -1.6  -0.7   0.5   0.09  0.08 -0.78 -0.19 -0.46  0.02  0.03  0.06 -0.  ]]
SymNet parameters
[-0.75  0.63]
SymNet parameters
[[-0.27  2.13 -1.53 -0.57 -0.09 -0.05 -1.93  0.18  0.16 -0.03 -0.05 -0.09 -1.71  1.78]
 [ 0.87  1.43  0.19  0.55  0.24  0.42 -0.81 -0.8   0.48  0.07 -0.    0.09 -1.28  1.12]]
SymNet parameters
[-0.18 -0.04]
SymNet parameters
[[-1.74e+00 -4.31e-02 -3.10e-02 -1.52e-02 -6.18e-03 -6.57e-03  1.25e+00  2.09e-02
   1.55e-03 -1.74e-03 -7.45e-04 -2.77e-03  6.51e-02 -6.15e-02  2.47e-04]
 [-2.64e+00 -1.24e+00  9.15e-01  3.04e-01  5.42e-02  3.98e-02 -8.58e-01 -1.01e-01
  -2.74e-01  1.16e-02  1.51e-02  3.92e-02  1.48e-01 -1.38e-01  1.53e-03]]
SymNet parameters
[-0.09 -0.11]
SymNet parameters
[[ 1.09e+00  2.72e-01 -2.94e-01 -1.92e-01 -3.75e-02 -2.40e-02 -5.98e-01  5.73e-02
   1.87e-01 -7.71e-03 -1.02e-02 -2.47e-02  8.79e-03 -8.04e-03 -7.86e-04 -2.88e-03]
 [-2.46e+00  3.32e-01  1.07e-01 -1.05e-01 -2.38e-02 -1.47e-02 -1.48e-01  3.81e-02
   1.10e-01 -5.88e-03 -6.49e-03 -1.34e-02  8.33e-02 -7.94e-02  5.94e-04 -3.97e-03]]
SymNet parameters
[-0.33 -0.23]
SymNet parameters
[[ 0.5   0.36  0.15 -0.05 -0.02  0.03 -0.01  0.04  0.08 -0.   -0.01 -0.01  0.04 -0.38
   0.01 -0.47 -0.79]]
SymNet parameters
[-0.07]
SymNet parameters
[[ 2.34e-01 -3.88e-01 -2.31e-01  5.17e-03 -1.35e-02  5.67e-03 -7.71e-01  4.18e-01
   6.73e-01  2.30e-02 -6.05e-02  2.16e-01]
 [ 1.59e-01  8.59e-03 -1.22e-03 -1.14e-03 -4.92e-04 -3.94e-04 -1.25e+00 -1.17e-01
  -1.15e-02  1.69e-03 -1.25e-03  3.92e-04]]
SymNet parameters
[-0.3   0.12]
SymNet parameters
[[ 4.52e-02  5.59e-02 -1.29e-01 -6.02e-04 -3.03e-03 -2.08e-03  1.18e-01 -2.08e+00
  -5.10e-01  7.26e-04 -3.74e-02  1.02e-01  6.56e-02]
 [ 1.07e+00  1.88e-02  3.60e-02 -4.32e-04  3.43e-04 -4.40e-04  1.04e-01 -5.50e-02
  -2.50e-02 -1.32e-03  7.64e-03 -2.47e-02  9.19e-03]]
SymNet parameters
[1.19 0.47]
SymNet parameters
[[ 2.74e-01 -6.18e-02 -4.97e-01  2.42e-03 -1.47e-02 -4.22e-03 -9.92e-01  1.01e+00
  -1.16e+00  2.23e-02 -1.23e-01  4.09e-01  7.15e-03 -1.98e-02]
 [ 6.50e-01  3.55e-02  8.00e-03  1.34e-04  2.80e-03 -8.90e-04 -1.22e+00  9.22e-02
   5.71e-02  3.26e-04  1.69e-03 -8.45e-03 -1.62e-02  1.14e-03]]
SymNet parameters
[-0.37  0.53]
SymNet parameters
[[ 2.82e-01 -2.85e-01 -4.45e-01  1.09e-02 -1.55e-02  5.10e-03 -6.43e-01 -2.97e+00
  -2.09e-01  1.46e-02  2.05e-01  3.84e-01  1.11e-01  2.92e-02 -2.13e-02]
 [-3.55e+00  7.49e-02  2.44e-01 -5.63e-03  2.35e-03  5.39e-03 -1.79e-01  1.12e-01
  -1.11e-01 -8.63e-03 -3.21e-03  7.06e-02 -3.93e-02 -9.31e-03  1.17e-02]]
SymNet parameters
[ 0.15 -0.13]
SymNet parameters
[[ 2.50e-01  1.23e+00 -1.16e-01 -9.78e-03  2.77e-02 -2.69e-02  8.32e-01  4.64e-01
   2.00e+00 -3.91e-02 -9.45e-03 -3.63e-03  6.11e-03  2.59e-01  9.63e-04  5.85e-02]
 [ 1.75e-02  4.43e-03 -1.80e-02 -3.12e-04 -1.35e-03  2.44e-04 -1.10e+00 -2.18e-02
  -6.58e-02 -1.24e-03 -3.19e-03  1.18e-02 -1.08e-02 -1.43e-02  1.19e-02  1.19e-03]]
SymNet parameters
[0.17 0.21]
SymNet parameters
[[-5.02e-01 -3.66e-02 -3.38e-02  9.70e-04 -1.23e-03  7.80e-05 -1.59e-01  4.48e-01
  -1.30e-01  5.44e-02 -7.80e-03  7.70e-02  4.08e-01  3.59e-01 -2.22e-01 -3.31e-03
   1.42e-01]]
SymNet parameters
[-0.24]
finally, finish this stage
iter:     0    time: 86.62
Func: 1.71e-01  |g|: 1.58e+01
stableloss: 1.78e-02   dataloss: 1.51e-01   sparseloss: 9.71e+01 momentloss: 6.51e+00
current expression:
[u00*u01, u10*v00, u20, u02, u00*u01**2, u00, u10, u01*u10*v00, u00*u11*v00, u00**2*u01, 1, u00**3, u00**2*u10, v01, u10*v00*v10, u01, u01*u10, u00*u01*v00, u00*u10*v01, u00*u01*u10*v00]
[-0.98 -0.98  0.05  0.05  0.02  0.02  0.01  0.01  0.01 -0.01  0.01 -0.01 -0.01  0.01
  0.    0.   -0.   -0.    0.    0.  ]
[v00*v10, u00*v01, v02, v20, v00, v00*v10**2, u00*v00*v11, u00*u01*v01, u10*v00*v01, u00*v01*v10, u01, u10*v01, v10**2, u10, u00**2*v00, u00*v00, v00**3, u00*v00*v10, v00**2*v20, u00**2*v01]
[-0.98 -0.97  0.05  0.05  0.01  0.01  0.01  0.01  0.01  0.01  0.01 -0.01 -0.    0.
 -0.    0.   -0.   -0.    0.   -0.  ]
block:  4
name:  burgers-2-upwind-sparse0-noise0.001-id0
device:  cuda:0
generate a random number to check random seed:  -0.6218598307152013
current stage is: block-4
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.9234, device='cuda:0', dtype=torch.float64)
u_obs variance
tensor([ 0.2322,  1.6070,  1.5164, 21.9400,  9.4588, 18.1546,  0.2423,  1.5694,
         1.5987, 18.8031, 10.0064, 21.1546], device='cuda:0',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 0.404671
         Iterations: 0
         Function evaluations: 15
         Gradient evaluations: 3
convolution moment and kernels
[[ 1.00e+00  0.00e+00  2.25e-05  1.79e-03 -2.78e-02]
 [ 0.00e+00 -5.32e-05 -1.32e-03  1.07e-03 -2.64e-03]
 [ 6.99e-05  2.15e-03  3.68e-03  7.78e-04 -1.32e-03]
 [ 5.88e-02  8.22e-04 -4.25e-03 -9.54e-04  4.53e-03]
 [-5.87e-02  2.87e-03 -3.86e-03 -1.07e-02  3.89e-03]]
[[ 0.01 -0.02 -0.07  0.   -0.  ]
 [-0.03  0.11  0.19  0.02  0.01]
 [ 0.03 -0.11  0.72  0.03 -0.03]
 [-0.05  0.18 -0.02  0.07 -0.  ]
 [ 0.01 -0.05  0.03 -0.02  0.  ]]
[[ 0.00e+00  1.00e+00  0.00e+00 -9.74e-02 -6.84e-02]
 [ 0.00e+00  0.00e+00 -2.65e-03  1.13e-03  1.01e-03]
 [ 0.00e+00  4.33e-03 -1.92e-04  9.73e-03 -6.61e-03]
 [ 3.41e-03  2.29e-03  9.02e-04 -3.19e-03 -2.96e-03]
 [ 1.32e-02 -3.01e-02 -3.41e-03 -1.25e-02 -1.38e-03]]
[[ 0.    0.    0.03 -0.02 -0.  ]
 [-0.03  0.02 -0.13  0.08  0.01]
 [ 0.11 -0.52 -0.23  0.95 -0.22]
 [-0.02 -0.   -0.08  0.03  0.02]
 [ 0.    0.01  0.01  0.   -0.01]]
[[ 0.00e+00  0.00e+00  0.00e+00  9.43e-03  6.06e-03]
 [ 1.00e+00  0.00e+00  1.96e-02 -1.91e-03 -6.25e-03]
 [ 0.00e+00 -2.24e-03  2.45e-03 -2.66e-03  1.12e-04]
 [-8.93e-02  5.85e-04  6.98e-03 -9.25e-04 -1.75e-02]
 [-5.86e-02  1.39e-03 -9.10e-03 -8.69e-04 -2.68e-03]]
[[ 6.78e-03 -3.84e-02  1.31e-01 -3.60e-02  6.22e-03]
 [-6.13e-03  6.05e-02 -6.21e-01  4.93e-02 -4.53e-03]
 [-9.48e-03 -3.83e-02 -2.61e-01 -4.15e-02 -9.35e-04]
 [ 1.99e-02 -3.02e-02  1.02e+00 -4.15e-02  2.10e-02]
 [-9.69e-03  3.16e-02 -2.34e-01  3.60e-02 -1.09e-02]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00 -3.85e-03]
 [ 0.00e+00  0.00e+00  0.00e+00 -1.24e-03  4.47e-04]
 [ 0.00e+00  0.00e+00  2.92e-03 -1.24e-03 -1.30e-03]
 [ 0.00e+00 -9.05e-04 -7.18e-04  1.14e-03  2.33e-05]
 [ 1.89e-03 -3.10e-03 -2.26e-03  1.67e-03 -1.78e-03]]
[[-2.23e-03  6.57e-03 -2.61e-03  8.46e-04 -6.92e-04]
 [ 8.22e-03 -1.81e-02 -7.49e-03  9.91e-03 -6.30e-05]
 [-1.01e-01  1.38e+00 -2.50e+00  1.33e+00 -8.47e-02]
 [ 1.08e-02 -2.36e-02 -7.78e-03  1.48e-02 -1.75e-03]
 [-2.98e-03  7.77e-03 -1.12e-03 -1.86e-03  6.61e-05]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00 -6.57e-04]
 [ 0.00e+00  1.00e+00  0.00e+00 -6.51e-04 -2.58e-03]
 [ 0.00e+00  0.00e+00  1.25e-03 -6.63e-04 -1.80e-03]
 [ 0.00e+00 -1.00e-03 -1.77e-03  1.60e-03  3.42e-03]
 [ 3.26e-03 -8.55e-04 -3.01e-03  1.43e-03  4.47e-03]]
[[ 0.01 -0.07  0.03  0.04 -0.  ]
 [-0.07  0.51 -0.13 -0.36  0.04]
 [ 0.03 -0.14  0.26 -0.16  0.04]
 [ 0.03 -0.33 -0.2   0.58 -0.09]
 [-0.    0.03  0.05 -0.09  0.02]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  1.55e-03]
 [ 0.00e+00  0.00e+00  0.00e+00 -6.44e-04 -9.23e-04]
 [ 1.00e+00  0.00e+00  1.59e-03  4.54e-04  8.28e-04]
 [ 0.00e+00 -9.50e-04 -7.04e-04  9.14e-04  1.02e-03]
 [-2.40e-03 -7.01e-04  1.19e-03 -1.82e-03 -7.29e-03]]
[[-0.01  0.03 -0.14  0.04 -0.01]
 [ 0.03 -0.12  1.54 -0.14  0.04]
 [-0.04  0.17 -2.79  0.19 -0.05]
 [ 0.03 -0.11  1.52 -0.12  0.03]
 [-0.01  0.03 -0.13  0.03 -0.01]]
SymNet parameters
[[ 0.64 -2.22 -0.93  0.69  0.07  0.09 -1.02 -0.24 -0.67  0.03  0.04  0.09]
 [-0.14  0.08 -0.11 -0.07 -0.02 -0.   -1.14  0.    0.08 -0.   -0.   -0.01]]
SymNet parameters
[ 1.2  -0.51]
SymNet parameters
[[-0.25  0.14 -0.16 -0.09 -0.02 -0.01 -1.67  0.02  0.09 -0.   -0.01 -0.01  0.  ]
 [ 0.54 -1.6  -0.7   0.5   0.09  0.08 -0.78 -0.19 -0.46  0.02  0.03  0.06 -0.  ]]
SymNet parameters
[-0.75  0.63]
SymNet parameters
[[-0.27  2.13 -1.53 -0.57 -0.09 -0.05 -1.93  0.18  0.16 -0.03 -0.05 -0.09 -1.71  1.78]
 [ 0.87  1.43  0.19  0.55  0.24  0.42 -0.81 -0.8   0.48  0.07 -0.    0.09 -1.28  1.12]]
SymNet parameters
[-0.18 -0.04]
SymNet parameters
[[-1.74e+00 -4.31e-02 -3.10e-02 -1.53e-02 -6.18e-03 -6.62e-03  1.25e+00  2.10e-02
   1.55e-03 -1.73e-03 -7.41e-04 -2.78e-03  6.51e-02 -6.14e-02  5.04e-04]
 [-2.64e+00 -1.24e+00  9.15e-01  3.04e-01  5.42e-02  3.98e-02 -8.58e-01 -1.01e-01
  -2.74e-01  1.16e-02  1.51e-02  3.92e-02  1.48e-01 -1.38e-01  1.87e-03]]
SymNet parameters
[-0.09 -0.11]
SymNet parameters
[[ 1.09e+00  2.72e-01 -2.94e-01 -1.92e-01 -3.75e-02 -2.40e-02 -5.98e-01  5.73e-02
   1.87e-01 -7.71e-03 -1.02e-02 -2.47e-02  8.81e-03 -8.04e-03  3.45e-05 -2.93e-03]
 [-2.46e+00  3.32e-01  1.07e-01 -1.05e-01 -2.38e-02 -1.46e-02 -1.48e-01  3.81e-02
   1.10e-01 -5.89e-03 -6.50e-03 -1.34e-02  8.32e-02 -7.94e-02  3.90e-04 -3.82e-03]]
SymNet parameters
[-0.33 -0.23]
SymNet parameters
[[ 0.5   0.36  0.15 -0.05 -0.02  0.03 -0.01  0.04  0.08 -0.   -0.01 -0.01  0.04 -0.38
   0.01 -0.47 -0.79]]
SymNet parameters
[-0.07]
SymNet parameters
[[ 2.34e-01 -3.88e-01 -2.31e-01  5.18e-03 -1.35e-02  5.68e-03 -7.71e-01  4.18e-01
   6.73e-01  2.30e-02 -6.05e-02  2.16e-01]
 [ 1.59e-01  8.58e-03 -1.22e-03 -1.15e-03 -5.02e-04 -3.96e-04 -1.25e+00 -1.17e-01
  -1.15e-02  1.70e-03 -1.25e-03  4.19e-04]]
SymNet parameters
[-0.3   0.12]
SymNet parameters
[[ 4.52e-02  5.59e-02 -1.29e-01 -6.02e-04 -3.03e-03 -2.08e-03  1.18e-01 -2.08e+00
  -5.10e-01  7.19e-04 -3.74e-02  1.01e-01  6.56e-02]
 [ 1.07e+00  1.88e-02  3.60e-02 -4.18e-04  3.48e-04 -4.24e-04  1.04e-01 -5.50e-02
  -2.50e-02 -1.32e-03  7.64e-03 -2.47e-02  9.17e-03]]
SymNet parameters
[1.19 0.47]
SymNet parameters
[[ 2.74e-01 -6.18e-02 -4.97e-01  2.42e-03 -1.47e-02 -4.22e-03 -9.92e-01  1.01e+00
  -1.16e+00  2.23e-02 -1.23e-01  4.09e-01  7.15e-03 -1.98e-02]
 [ 6.50e-01  3.55e-02  8.00e-03  1.33e-04  2.81e-03 -8.96e-04 -1.22e+00  9.22e-02
   5.71e-02  3.26e-04  1.69e-03 -8.44e-03 -1.61e-02  1.16e-03]]
SymNet parameters
[-0.37  0.53]
SymNet parameters
[[ 2.82e-01 -2.85e-01 -4.45e-01  1.09e-02 -1.55e-02  5.10e-03 -6.43e-01 -2.97e+00
  -2.09e-01  1.46e-02  2.05e-01  3.84e-01  1.11e-01  2.92e-02 -2.13e-02]
 [-3.55e+00  7.49e-02  2.44e-01 -5.63e-03  2.35e-03  5.39e-03 -1.79e-01  1.12e-01
  -1.11e-01 -8.63e-03 -3.21e-03  7.06e-02 -3.93e-02 -9.32e-03  1.17e-02]]
SymNet parameters
[ 0.15 -0.13]
SymNet parameters
[[ 2.50e-01  1.23e+00 -1.16e-01 -9.77e-03  2.77e-02 -2.69e-02  8.32e-01  4.64e-01
   2.00e+00 -3.91e-02 -9.45e-03 -3.63e-03  6.11e-03  2.59e-01  9.61e-04  5.85e-02]
 [ 1.75e-02  4.43e-03 -1.80e-02 -3.16e-04 -1.35e-03  2.39e-04 -1.10e+00 -2.18e-02
  -6.58e-02 -1.24e-03 -3.19e-03  1.18e-02 -1.08e-02 -1.43e-02  1.19e-02  1.14e-03]]
SymNet parameters
[0.17 0.21]
SymNet parameters
[[-5.02e-01 -3.66e-02 -3.38e-02  9.71e-04 -1.22e-03  8.04e-05 -1.59e-01  4.48e-01
  -1.30e-01  5.44e-02 -7.80e-03  7.69e-02  4.08e-01  3.59e-01 -2.22e-01 -3.20e-03
   1.42e-01]]
SymNet parameters
[-0.24]
finally, finish this stage
iter:     0    time: 88.58
Func: 4.05e-01  |g|: 1.38e+02
stableloss: 3.35e-02   dataloss: 3.79e-01   sparseloss: 9.71e+01 momentloss: 6.51e+00
current expression:
[u00*u01, u10*v00, u20, u02, u00*u01**2, u00, u10, u01*u10*v00, u00*u11*v00, u00**2*u01, 1, u00**3, u00**2*u10, v01, u10*v00*v10, u01, u01*u10, u00*u01*v00, u00*u10*v01, u00*u01*u10*v00]
[-0.98 -0.98  0.05  0.05  0.02  0.02  0.01  0.01  0.01 -0.01  0.01 -0.01 -0.01  0.01
  0.    0.   -0.   -0.    0.    0.  ]
[v00*v10, u00*v01, v02, v20, v00, v00*v10**2, u00*v00*v11, u00*u01*v01, u10*v00*v01, u00*v01*v10, u01, u10*v01, v10**2, u10, u00**2*v00, u00*v00, v00**3, u00*v00*v10, v00**2*v20, u00**2*v01]
[-0.98 -0.97  0.05  0.05  0.01  0.01  0.01  0.01  0.01  0.01  0.01 -0.01 -0.    0.
 -0.    0.   -0.   -0.    0.   -0.  ]
block:  5
name:  burgers-2-upwind-sparse0-noise0.001-id0
device:  cuda:0
generate a random number to check random seed:  -2.4134721914330397
current stage is: block-5
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.8669, device='cuda:0', dtype=torch.float64)
u_obs variance
tensor([ 0.2473,  1.6075,  1.4922, 20.5900,  9.1376, 17.6651,  0.2457,  1.5480,
         1.5608, 18.0607,  9.0067, 21.5025], device='cuda:0',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
iter:     0    time: 86.53
Func: 5.05e-01  |g|: 4.11e+01
stableloss: 4.68e-02   dataloss: 4.72e-01   sparseloss: 9.71e+01 momentloss: 6.51e+00
iter:   200    time: 27.59
Func: 3.78e-01  |g|: 1.36e+00
stableloss: 4.47e-02   dataloss: 3.37e-01   sparseloss: 9.65e+01 momentloss: 8.17e+00
iter:   400    time: 27.32
Func: 3.69e-01  |g|: 3.09e-01
stableloss: 4.35e-02   dataloss: 3.28e-01   sparseloss: 9.99e+01 momentloss: 8.17e+00
iter:   600    time: 27.21
Func: 3.66e-01  |g|: 7.48e-01
stableloss: 4.31e-02   dataloss: 3.24e-01   sparseloss: 1.11e+02 momentloss: 8.37e+00
iter:   800    time: 27.62
Func: 3.61e-01  |g|: 1.48e+00
stableloss: 4.22e-02   dataloss: 3.20e-01   sparseloss: 1.18e+02 momentloss: 8.20e+00
iter:  1000    time: 27.39
Func: 3.55e-01  |g|: 2.32e+00
stableloss: 4.27e-02   dataloss: 3.14e-01   sparseloss: 1.04e+02 momentloss: 8.13e+00
iter:  1200    time: 27.30
Func: 3.51e-01  |g|: 1.11e+00
stableloss: 4.32e-02   dataloss: 3.10e-01   sparseloss: 1.01e+02 momentloss: 8.23e+00
iter:  1400    time: 27.27
Func: 3.49e-01  |g|: 1.27e+00
stableloss: 4.35e-02   dataloss: 3.08e-01   sparseloss: 1.07e+02 momentloss: 8.28e+00
iter:  1600    time: 27.37
Func: 3.49e-01  |g|: 1.72e-01
stableloss: 4.36e-02   dataloss: 3.07e-01   sparseloss: 1.10e+02 momentloss: 8.28e+00
iter:  1800    time: 27.50
Func: 3.49e-01  |g|: 1.15e-01
stableloss: 4.36e-02   dataloss: 3.07e-01   sparseloss: 1.11e+02 momentloss: 8.27e+00
Warning: Maximum number of iterations has been exceeded.
         Current function value: 0.348510
         Iterations: 2000
         Function evaluations: 2016
         Gradient evaluations: 2006
convolution moment and kernels
[[ 1.00e+00  0.00e+00  1.34e-03  2.75e-03 -7.29e-02]
 [ 0.00e+00  9.40e-04 -4.38e-04 -7.61e-03 -3.68e-02]
 [-6.57e-04 -9.85e-04  2.80e-02 -5.87e-03 -6.56e-03]
 [-1.31e-01 -8.09e-04  8.10e-04  5.61e-03 -1.36e-03]
 [-7.68e-02  2.92e-02  6.58e-03  2.89e-02  1.32e-03]]
[[-0.01  0.01 -0.02  0.    0.01]
 [ 0.05 -0.05  0.2   0.01 -0.04]
 [-0.13  0.23  0.32  0.08  0.03]
 [ 0.02  0.11  0.19  0.22 -0.1 ]
 [-0.01  0.   -0.13 -0.02  0.02]]
[[ 0.00e+00  1.00e+00  0.00e+00 -8.68e-02 -6.75e-02]
 [ 0.00e+00  0.00e+00  2.45e-03  1.09e-02  8.74e-03]
 [ 0.00e+00  2.96e-02  1.82e-02  3.62e-02 -1.05e-02]
 [ 2.21e-02 -9.43e-03 -5.95e-03 -3.65e-03  1.66e-03]
 [ 4.75e-03 -1.17e-02  1.30e-02 -1.24e-03 -3.27e-04]]
[[-8.01e-04  2.25e-02 -4.02e-02  1.29e-02 -7.43e-04]
 [-2.86e-02  1.15e-02 -1.01e-02  2.96e-02  8.05e-04]
 [ 1.18e-01 -5.39e-01 -3.11e-01  9.71e-01 -2.10e-01]
 [-3.09e-02  7.61e-03 -4.22e-02  7.17e-03  1.72e-02]
 [ 1.88e-03  1.40e-02 -9.78e-04  2.81e-03 -1.96e-03]]
[[ 0.00e+00  0.00e+00  0.00e+00  1.85e-02  1.44e-02]
 [ 1.00e+00  0.00e+00  1.58e-02 -5.70e-03 -2.75e-02]
 [ 0.00e+00  8.63e-04  8.40e-03 -8.28e-03  6.00e-03]
 [-9.78e-02 -2.92e-03  5.15e-03 -1.04e-02 -2.53e-02]
 [-5.54e-02  1.05e-02  4.60e-03  2.06e-03  2.92e-03]]
[[ 9.80e-03 -4.80e-02  1.47e-01 -4.71e-02  1.53e-02]
 [-2.90e-04  2.91e-02 -5.75e-01  2.23e-02 -1.89e-02]
 [-4.39e-03 -4.78e-02 -2.48e-01 -6.94e-02  3.70e-02]
 [ 6.62e-03 -2.85e-03  1.01e+00 -2.83e-02  2.84e-04]
 [-6.63e-03  3.06e-02 -2.48e-01  4.66e-02 -1.01e-02]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00  4.10e-03]
 [ 0.00e+00  0.00e+00  0.00e+00 -5.33e-03  1.49e-01]
 [ 0.00e+00  0.00e+00 -1.30e-03  3.70e-02  7.18e-03]
 [ 0.00e+00  4.87e-03  5.96e-02  5.14e-04 -3.16e-01]
 [ 7.43e-04 -2.89e-03  3.40e-03 -4.28e-03 -1.89e-02]]
[[ 0.16 -0.64  0.97 -0.63  0.15]
 [-0.37  1.44 -2.1   1.32 -0.3 ]
 [-0.16  1.77 -3.32  1.98 -0.27]
 [ 0.48 -2.05  3.19 -2.16  0.54]
 [-0.19  0.8  -1.22  0.81 -0.2 ]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  3.33e-03]
 [ 0.00e+00  1.00e+00  0.00e+00 -7.46e-03  1.46e-01]
 [ 0.00e+00  0.00e+00  9.39e-04 -1.16e-03  2.08e-03]
 [ 0.00e+00 -4.44e-03 -9.33e-03  1.41e-02 -3.94e-02]
 [-9.90e-04  6.40e-02 -4.44e-04 -5.11e-03 -4.61e-02]]
[[ 0.   -0.05 -0.1   0.18 -0.03]
 [-0.05  0.44  0.32 -0.87  0.15]
 [-0.23  0.82 -1.66  1.39 -0.32]
 [ 0.36 -1.56  1.92 -1.    0.29]
 [-0.08  0.32 -0.46  0.29 -0.07]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  8.03e-03]
 [ 0.00e+00  0.00e+00  0.00e+00 -7.78e-03 -1.66e-01]
 [ 1.00e+00  0.00e+00  5.36e-03  6.31e-03 -5.27e-04]
 [ 0.00e+00  2.37e-03  1.42e-03  7.67e-04  3.38e-01]
 [-8.34e-03 -2.43e-02 -5.81e-02  1.72e-03  6.58e-03]]
[[-0.17  0.64 -1.    0.61 -0.17]
 [ 0.41 -1.42  3.29 -1.31  0.4 ]
 [ 0.07 -0.59 -1.35 -0.77  0.09]
 [-0.49  2.15 -2.08  2.29 -0.51]
 [ 0.19 -0.82  1.19 -0.85  0.2 ]]
SymNet parameters
[[-2.38e-01 -1.01e-01 -2.71e+00  1.90e-01 -1.38e-01  1.55e-01 -1.63e+00 -1.68e-01
  -2.59e-01  3.69e-03  8.91e-03  1.90e-02]
 [ 3.02e-02  1.72e-02  1.34e-02  1.89e-03 -4.43e-03  9.86e-03 -7.30e-01 -1.55e-02
   1.17e-02  6.25e-04 -1.35e-04  1.21e-03]]
SymNet parameters
[ 0.23 -0.17]
SymNet parameters
[[-3.80e-02  2.59e-02  2.65e-02  1.23e-02 -2.47e-03  6.10e-03 -9.26e-01  2.25e-02
   3.28e-02  9.10e-04  2.04e-03  1.21e-03  1.83e-03]
 [-5.31e-01 -1.19e-01 -2.31e+00  1.41e-01  1.42e-02  1.52e-01 -9.55e-01 -1.88e-01
  -2.05e-01 -1.95e-04 -1.88e-03  1.73e-02 -2.15e-02]]
SymNet parameters
[-0.29  0.47]
SymNet parameters
[[-3.24e-01  2.49e+00 -5.44e+00 -3.98e-01  2.57e-01 -1.97e-01 -5.73e+00  3.86e-01
   1.20e+00  2.18e-02  2.58e-02  1.38e-02  2.81e-01 -1.50e-01]
 [-9.72e+00  2.14e+00  1.18e+00  7.78e-02 -1.05e-01  4.74e-01  3.32e+00 -2.11e-01
   1.15e+00  1.38e-02 -5.41e-03  2.91e-02  1.89e-01 -1.13e-01]]
SymNet parameters
[ 0.98 -0.51]
SymNet parameters
[[-4.77e-01 -4.10e-01 -1.21e-01 -8.31e-02  3.83e-02 -5.62e-02  9.11e-01  7.74e-02
   1.74e-01 -2.81e-03 -3.36e-03 -6.58e-03  7.69e-02 -7.25e-02 -2.40e-04]
 [-1.53e+00  1.71e-02  2.20e-02  3.11e-03 -4.03e-03  1.01e-02 -4.51e-01 -7.54e-03
   1.68e-02 -2.39e-03 -1.45e-03  1.45e-03  1.15e-03 -9.16e-03  1.51e-05]]
SymNet parameters
[-0.14  0.55]
SymNet parameters
[[ 1.01e+00  3.85e-02 -2.28e-02  1.87e-03 -2.48e-03  1.11e-02 -3.88e-01 -7.69e-03
   3.44e-02  3.73e-04  4.58e-04  1.89e-03  6.95e-03 -9.97e-03  1.46e-04 -2.65e-02]
 [-4.94e-01  5.14e-01  6.09e-02 -7.26e-02  3.19e-02 -4.20e-02  7.13e-01  6.02e-02
   1.67e-01 -3.78e-03 -4.27e-03 -6.42e-03 -2.52e-02  1.45e-03 -5.01e-04 -1.02e-02]]
SymNet parameters
[-0.21 -0.34]
SymNet parameters
[[-2.09e-01 -2.50e-01  1.73e-01  1.57e-02  1.72e-02  1.66e-02  3.58e-01  3.81e-02
   4.15e-02 -3.05e-04 -1.01e-03 -3.86e-03 -2.86e-01 -1.44e-01  3.30e-03 -6.56e-01
  -9.75e-01]]
SymNet parameters
[-0.01]
SymNet parameters
[[-1.07e-01 -9.57e-02  5.72e-02  4.92e-03  5.44e-04 -5.24e-03  4.68e-01 -6.11e-01
   8.97e-02  2.38e-02 -3.32e-02  8.64e-02]
 [ 5.14e-02 -2.55e-01 -8.72e-02 -1.24e-02 -1.66e-02  7.43e-03 -2.98e+00 -4.61e-01
  -2.34e-01 -7.47e-02 -3.36e-02 -1.03e-01]]
SymNet parameters
[ 0.94 -1.08]
SymNet parameters
[[-1.61e-01  1.20e-01 -4.68e-01 -1.86e-02 -3.27e-02  1.06e-02  2.87e-01 -1.20e+00
   1.89e-01 -1.82e-01 -1.38e-01 -4.56e-01 -1.01e-02]
 [ 1.67e+00  2.94e-02  1.27e-01  3.19e-03  7.64e-03  3.36e-03  3.20e-01  1.04e-01
   5.42e-02  1.07e-02 -5.61e-04 -1.76e-02  3.78e-03]]
SymNet parameters
[1.37 1.21]
SymNet parameters
[[ 1.09e+00  1.23e-01  2.53e-01 -3.25e-02  6.92e-03  1.77e-02  7.08e-01  2.79e-01
  -1.50e+00  1.03e-01 -7.65e-02  2.20e-01  2.07e-01  9.25e-03]
 [-6.51e-02 -1.72e-03 -4.99e-02 -4.60e-03 -4.30e-03  2.16e-03 -1.77e+00 -7.48e-02
  -6.28e-02 -3.62e-03 -4.05e-03 -1.25e-02 -2.29e-03  1.04e-02]]
SymNet parameters
[-0.6  -0.74]
SymNet parameters
[[-3.68e-02  3.87e-03  1.95e-02 -9.51e-03 -4.51e-03  8.28e-03  2.66e+00 -3.27e+00
  -1.20e-01  3.51e-02  2.31e-03  7.29e-02  1.68e-01  2.06e-02  7.68e-03]
 [-3.86e+00 -4.26e-02  2.76e-02  1.27e-03 -1.47e-03  4.38e-03  6.61e-02 -2.54e-02
   6.52e-02 -5.75e-03 -6.59e-03 -5.36e-03  3.07e-03  2.48e-02 -6.53e-03]]
SymNet parameters
[ 1.38 -0.89]
SymNet parameters
[[ 3.30e+00  1.66e-01  1.82e-01 -3.61e-02  4.94e-03  1.66e-02  3.77e-01  6.20e-01
   2.08e+00  8.99e-02 -4.56e-02  1.68e-01  1.98e-01  6.61e-02 -1.60e-04  3.18e-02]
 [ 2.63e-02 -5.07e-03  2.66e-02  5.57e-03  3.88e-03 -3.08e-03 -1.93e+00 -3.77e-02
   5.19e-02  1.26e-03  6.92e-03  4.42e-03 -8.49e-03 -1.16e-02  1.74e-02 -5.09e-04]]
SymNet parameters
[ 0.16 -0.14]
SymNet parameters
[[-0.45 -0.01  0.    0.01  0.   -0.    0.14  0.22  0.23  0.05  0.01  0.05  0.03  0.02
  -0.14 -0.07  0.15]]
SymNet parameters
[-0.01]
finally, finish this stage
iter:  2000    time: 27.43
Func: 3.49e-01  |g|: 2.91e-01
stableloss: 4.37e-02   dataloss: 3.07e-01   sparseloss: 1.12e+02 momentloss: 8.30e+00
current expression:
[u00*u01, u10*v00, u02, u20, u00*u01**2, u00*u11*v00, u01*u10*v00, u01*u10, u10*v00*v10, u00*u10*v01, u00, u10*v10, u01, u00*u01*v00, u00*u10*v00, u00**3, u00**2*u10, u10, u00*v00, u20*v00**2]
[-0.98 -0.98  0.05  0.05  0.01  0.01  0.01  0.01  0.01  0.01  0.01  0.01  0.01 -0.
 -0.   -0.    0.    0.    0.    0.  ]
[v00*v10, u00*v01, v02, v20, v00*v10**2, u00*v00*v10, u00*v00*v11, u00*u01*v01, u00*v01*v10, u10*v01, v10**2, u10*v00*v01, u00*v00, 1, u00*v10, u00, v00*v01, v10, u00**2, v00**2*v20]
[-0.99 -0.98  0.05  0.05  0.01 -0.01  0.01  0.01  0.01  0.01  0.01  0.01  0.01 -0.01
 -0.    0.    0.    0.    0.    0.  ]
block:  6
name:  burgers-2-upwind-sparse0-noise0.001-id0
device:  cuda:0
generate a random number to check random seed:  0.8188095212990908
current stage is: block-6
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.9626, device='cuda:0', dtype=torch.float64)
u_obs variance
tensor([ 0.2473,  1.6764,  1.5508, 24.5034,  9.4511, 19.5337,  0.2294,  1.5212,
         1.5715, 19.8338, 10.0797, 22.0234], device='cuda:0',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 0.697843
         Iterations: 0
         Function evaluations: 15
         Gradient evaluations: 3
convolution moment and kernels
[[ 1.00e+00  0.00e+00  1.34e-03  2.74e-03 -7.29e-02]
 [ 0.00e+00  9.40e-04 -4.39e-04 -7.61e-03 -3.68e-02]
 [-6.57e-04 -9.85e-04  2.80e-02 -5.87e-03 -6.56e-03]
 [-1.31e-01 -8.09e-04  8.10e-04  5.61e-03 -1.36e-03]
 [-7.68e-02  2.92e-02  6.58e-03  2.89e-02  1.32e-03]]
[[-0.01  0.01 -0.02  0.    0.01]
 [ 0.05 -0.05  0.2   0.01 -0.04]
 [-0.13  0.23  0.32  0.08  0.03]
 [ 0.02  0.11  0.19  0.22 -0.1 ]
 [-0.01  0.   -0.13 -0.02  0.02]]
[[ 0.00e+00  1.00e+00  0.00e+00 -8.68e-02 -6.75e-02]
 [ 0.00e+00  0.00e+00  2.45e-03  1.09e-02  8.74e-03]
 [ 0.00e+00  2.96e-02  1.82e-02  3.62e-02 -1.05e-02]
 [ 2.21e-02 -9.43e-03 -5.95e-03 -3.65e-03  1.66e-03]
 [ 4.75e-03 -1.17e-02  1.30e-02 -1.24e-03 -3.27e-04]]
[[-8.01e-04  2.25e-02 -4.02e-02  1.29e-02 -7.43e-04]
 [-2.86e-02  1.15e-02 -1.01e-02  2.96e-02  8.03e-04]
 [ 1.18e-01 -5.39e-01 -3.11e-01  9.71e-01 -2.10e-01]
 [-3.09e-02  7.61e-03 -4.22e-02  7.17e-03  1.72e-02]
 [ 1.88e-03  1.40e-02 -9.78e-04  2.81e-03 -1.96e-03]]
[[ 0.00e+00  0.00e+00  0.00e+00  1.85e-02  1.44e-02]
 [ 1.00e+00  0.00e+00  1.58e-02 -5.70e-03 -2.75e-02]
 [ 0.00e+00  8.63e-04  8.40e-03 -8.28e-03  6.00e-03]
 [-9.78e-02 -2.92e-03  5.15e-03 -1.04e-02 -2.53e-02]
 [-5.54e-02  1.05e-02  4.59e-03  2.06e-03  2.92e-03]]
[[ 9.80e-03 -4.80e-02  1.47e-01 -4.71e-02  1.53e-02]
 [-2.92e-04  2.91e-02 -5.75e-01  2.23e-02 -1.89e-02]
 [-4.38e-03 -4.78e-02 -2.48e-01 -6.95e-02  3.70e-02]
 [ 6.61e-03 -2.84e-03  1.01e+00 -2.83e-02  2.80e-04]
 [-6.63e-03  3.06e-02 -2.48e-01  4.66e-02 -1.01e-02]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00  4.10e-03]
 [ 0.00e+00  0.00e+00  0.00e+00 -5.33e-03  1.49e-01]
 [ 0.00e+00  0.00e+00 -1.30e-03  3.70e-02  7.18e-03]
 [ 0.00e+00  4.87e-03  5.96e-02  5.15e-04 -3.16e-01]
 [ 7.43e-04 -2.89e-03  3.40e-03 -4.28e-03 -1.89e-02]]
[[ 0.16 -0.64  0.97 -0.63  0.15]
 [-0.37  1.44 -2.1   1.32 -0.3 ]
 [-0.16  1.77 -3.32  1.98 -0.27]
 [ 0.48 -2.05  3.19 -2.16  0.54]
 [-0.19  0.8  -1.22  0.81 -0.2 ]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  3.33e-03]
 [ 0.00e+00  1.00e+00  0.00e+00 -7.46e-03  1.46e-01]
 [ 0.00e+00  0.00e+00  9.39e-04 -1.16e-03  2.08e-03]
 [ 0.00e+00 -4.44e-03 -9.33e-03  1.41e-02 -3.94e-02]
 [-9.90e-04  6.40e-02 -4.45e-04 -5.11e-03 -4.61e-02]]
[[ 0.   -0.05 -0.1   0.18 -0.03]
 [-0.05  0.44  0.32 -0.87  0.15]
 [-0.23  0.82 -1.66  1.39 -0.32]
 [ 0.36 -1.56  1.92 -1.    0.29]
 [-0.08  0.32 -0.46  0.29 -0.07]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  8.03e-03]
 [ 0.00e+00  0.00e+00  0.00e+00 -7.78e-03 -1.66e-01]
 [ 1.00e+00  0.00e+00  5.36e-03  6.31e-03 -5.27e-04]
 [ 0.00e+00  2.37e-03  1.42e-03  7.67e-04  3.38e-01]
 [-8.34e-03 -2.43e-02 -5.81e-02  1.72e-03  6.58e-03]]
[[-0.17  0.64 -1.    0.61 -0.17]
 [ 0.41 -1.42  3.29 -1.31  0.4 ]
 [ 0.07 -0.59 -1.35 -0.77  0.09]
 [-0.49  2.15 -2.08  2.29 -0.51]
 [ 0.19 -0.82  1.19 -0.85  0.2 ]]
SymNet parameters
[[-2.38e-01 -1.01e-01 -2.71e+00  1.90e-01 -1.38e-01  1.55e-01 -1.63e+00 -1.68e-01
  -2.59e-01  3.69e-03  8.91e-03  1.90e-02]
 [ 3.02e-02  1.72e-02  1.34e-02  1.89e-03 -4.43e-03  9.86e-03 -7.30e-01 -1.55e-02
   1.17e-02  6.28e-04 -1.34e-04  1.21e-03]]
SymNet parameters
[ 0.23 -0.17]
SymNet parameters
[[-3.80e-02  2.59e-02  2.65e-02  1.23e-02 -2.47e-03  6.10e-03 -9.26e-01  2.25e-02
   3.28e-02  9.11e-04  2.04e-03  1.21e-03  1.83e-03]
 [-5.31e-01 -1.19e-01 -2.31e+00  1.41e-01  1.42e-02  1.52e-01 -9.55e-01 -1.88e-01
  -2.05e-01 -1.94e-04 -1.88e-03  1.73e-02 -2.15e-02]]
SymNet parameters
[-0.29  0.47]
SymNet parameters
[[-3.24e-01  2.49e+00 -5.44e+00 -3.98e-01  2.57e-01 -1.97e-01 -5.73e+00  3.86e-01
   1.20e+00  2.18e-02  2.58e-02  1.38e-02  2.81e-01 -1.50e-01]
 [-9.72e+00  2.14e+00  1.18e+00  7.78e-02 -1.05e-01  4.74e-01  3.32e+00 -2.11e-01
   1.15e+00  1.38e-02 -5.41e-03  2.91e-02  1.89e-01 -1.13e-01]]
SymNet parameters
[ 0.98 -0.51]
SymNet parameters
[[-4.77e-01 -4.10e-01 -1.21e-01 -8.31e-02  3.83e-02 -5.62e-02  9.11e-01  7.74e-02
   1.74e-01 -2.81e-03 -3.36e-03 -6.58e-03  7.69e-02 -7.24e-02 -4.83e-04]
 [-1.53e+00  1.71e-02  2.20e-02  3.10e-03 -4.03e-03  1.01e-02 -4.51e-01 -7.55e-03
   1.68e-02 -2.40e-03 -1.45e-03  1.45e-03  1.15e-03 -9.15e-03  1.45e-05]]
SymNet parameters
[-0.14  0.55]
SymNet parameters
[[ 1.01e+00  3.85e-02 -2.28e-02  1.87e-03 -2.48e-03  1.11e-02 -3.88e-01 -7.69e-03
   3.44e-02  3.74e-04  4.59e-04  1.89e-03  6.95e-03 -9.97e-03 -1.66e-04 -2.65e-02]
 [-4.94e-01  5.14e-01  6.09e-02 -7.26e-02  3.19e-02 -4.20e-02  7.13e-01  6.02e-02
   1.67e-01 -3.78e-03 -4.27e-03 -6.42e-03 -2.52e-02  1.44e-03 -2.11e-04 -1.02e-02]]
SymNet parameters
[-0.21 -0.34]
SymNet parameters
[[-2.09e-01 -2.50e-01  1.73e-01  1.57e-02  1.72e-02  1.66e-02  3.58e-01  3.81e-02
   4.15e-02 -3.04e-04 -1.01e-03 -3.86e-03 -2.86e-01 -1.44e-01  3.27e-03 -6.56e-01
  -9.75e-01]]
SymNet parameters
[-0.01]
SymNet parameters
[[-1.07e-01 -9.57e-02  5.72e-02  4.92e-03  5.44e-04 -5.24e-03  4.68e-01 -6.11e-01
   8.97e-02  2.38e-02 -3.32e-02  8.64e-02]
 [ 5.14e-02 -2.55e-01 -8.72e-02 -1.24e-02 -1.66e-02  7.43e-03 -2.98e+00 -4.61e-01
  -2.34e-01 -7.47e-02 -3.36e-02 -1.03e-01]]
SymNet parameters
[ 0.94 -1.08]
SymNet parameters
[[-1.61e-01  1.20e-01 -4.68e-01 -1.86e-02 -3.27e-02  1.06e-02  2.87e-01 -1.20e+00
   1.89e-01 -1.82e-01 -1.38e-01 -4.56e-01 -1.01e-02]
 [ 1.67e+00  2.94e-02  1.27e-01  3.19e-03  7.64e-03  3.36e-03  3.20e-01  1.04e-01
   5.42e-02  1.07e-02 -5.60e-04 -1.76e-02  3.78e-03]]
SymNet parameters
[1.37 1.21]
SymNet parameters
[[ 1.09e+00  1.23e-01  2.53e-01 -3.25e-02  6.92e-03  1.77e-02  7.08e-01  2.79e-01
  -1.50e+00  1.03e-01 -7.65e-02  2.20e-01  2.07e-01  9.26e-03]
 [-6.51e-02 -1.72e-03 -4.99e-02 -4.60e-03 -4.30e-03  2.16e-03 -1.77e+00 -7.48e-02
  -6.28e-02 -3.62e-03 -4.05e-03 -1.25e-02 -2.29e-03  1.04e-02]]
SymNet parameters
[-0.6  -0.74]
SymNet parameters
[[-3.68e-02  3.87e-03  1.95e-02 -9.51e-03 -4.51e-03  8.28e-03  2.66e+00 -3.27e+00
  -1.20e-01  3.51e-02  2.31e-03  7.29e-02  1.68e-01  2.06e-02  7.68e-03]
 [-3.86e+00 -4.26e-02  2.76e-02  1.27e-03 -1.47e-03  4.38e-03  6.61e-02 -2.54e-02
   6.52e-02 -5.75e-03 -6.59e-03 -5.36e-03  3.07e-03  2.48e-02 -6.53e-03]]
SymNet parameters
[ 1.38 -0.89]
SymNet parameters
[[ 3.30e+00  1.66e-01  1.82e-01 -3.61e-02  4.94e-03  1.66e-02  3.77e-01  6.20e-01
   2.08e+00  8.99e-02 -4.56e-02  1.68e-01  1.98e-01  6.61e-02 -1.66e-04  3.18e-02]
 [ 2.63e-02 -5.07e-03  2.66e-02  5.56e-03  3.88e-03 -3.09e-03 -1.93e+00 -3.77e-02
   5.19e-02  1.26e-03  6.92e-03  4.43e-03 -8.50e-03 -1.16e-02  1.74e-02 -5.04e-04]]
SymNet parameters
[ 0.16 -0.14]
SymNet parameters
[[-0.45 -0.01  0.    0.01  0.   -0.    0.14  0.22  0.23  0.05  0.01  0.05  0.03  0.02
  -0.14 -0.07  0.15]]
SymNet parameters
[-0.01]
finally, finish this stage
iter:     0    time: 578.14
Func: 6.98e-01  |g|: 2.67e+02
stableloss: 5.12e-02   dataloss: 6.48e-01   sparseloss: 1.12e+02 momentloss: 8.30e+00
current expression:
[u00*u01, u10*v00, u02, u20, u00*u01**2, u00*u11*v00, u01*u10*v00, u01*u10, u10*v00*v10, u00*u10*v01, u00, u10*v10, u01, u00*u01*v00, u00*u10*v00, u00**3, u00**2*u10, u10, u00*v00, u20*v00**2]
[-0.98 -0.98  0.05  0.05  0.01  0.01  0.01  0.01  0.01  0.01  0.01  0.01  0.01 -0.
 -0.   -0.    0.    0.    0.    0.  ]
[v00*v10, u00*v01, v02, v20, v00*v10**2, u00*v00*v10, u00*v00*v11, u00*u01*v01, u00*v01*v10, u10*v01, v10**2, u10*v00*v01, u00*v00, 1, u00*v10, u00, v00*v01, v10, u00**2, v00**2*v20]
[-0.99 -0.98  0.05  0.05  0.01 -0.01  0.01  0.01  0.01  0.01  0.01  0.01  0.01 -0.01
 -0.    0.    0.    0.    0.    0.  ]
block:  9
name:  burgers-2-upwind-sparse0-noise0.001-id0
device:  cuda:0
generate a random number to check random seed:  -1.6502904278113977
current stage is: block-9
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.6466, device='cuda:0', dtype=torch.float64)
u_obs variance
tensor([ 0.2636,  1.8348,  1.6365, 29.1259, 11.4233, 22.3474,  0.2389,  1.5997,
         1.6397, 22.1598, 11.0667, 24.7162], device='cuda:0',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 1.778523
         Iterations: 0
         Function evaluations: 15
         Gradient evaluations: 3
convolution moment and kernels
[[ 1.00e+00  0.00e+00  1.34e-03  2.75e-03 -7.29e-02]
 [ 0.00e+00  9.40e-04 -4.37e-04 -7.61e-03 -3.68e-02]
 [-6.58e-04 -9.85e-04  2.80e-02 -5.87e-03 -6.56e-03]
 [-1.31e-01 -8.09e-04  8.09e-04  5.61e-03 -1.36e-03]
 [-7.68e-02  2.92e-02  6.58e-03  2.89e-02  1.32e-03]]
[[-0.01  0.01 -0.02  0.    0.01]
 [ 0.05 -0.05  0.2   0.01 -0.04]
 [-0.13  0.23  0.32  0.08  0.03]
 [ 0.02  0.11  0.19  0.22 -0.1 ]
 [-0.01  0.   -0.13 -0.02  0.02]]
[[ 0.00e+00  1.00e+00  0.00e+00 -8.68e-02 -6.75e-02]
 [ 0.00e+00  0.00e+00  2.45e-03  1.09e-02  8.74e-03]
 [ 0.00e+00  2.96e-02  1.82e-02  3.61e-02 -1.05e-02]
 [ 2.21e-02 -9.43e-03 -5.95e-03 -3.65e-03  1.66e-03]
 [ 4.74e-03 -1.17e-02  1.30e-02 -1.24e-03 -3.33e-04]]
[[-8.09e-04  2.25e-02 -4.02e-02  1.29e-02 -7.49e-04]
 [-2.86e-02  1.14e-02 -9.92e-03  2.95e-02  8.28e-04]
 [ 1.18e-01 -5.39e-01 -3.12e-01  9.71e-01 -2.10e-01]
 [-3.09e-02  7.48e-03 -4.20e-02  7.06e-03  1.72e-02]
 [ 1.87e-03  1.41e-02 -1.02e-03  2.84e-03 -1.96e-03]]
[[ 0.00e+00  0.00e+00  0.00e+00  1.85e-02  1.44e-02]
 [ 1.00e+00  0.00e+00  1.58e-02 -5.70e-03 -2.75e-02]
 [ 0.00e+00  8.61e-04  8.40e-03 -8.28e-03  6.01e-03]
 [-9.78e-02 -2.92e-03  5.15e-03 -1.04e-02 -2.53e-02]
 [-5.54e-02  1.05e-02  4.60e-03  2.06e-03  2.91e-03]]
[[ 9.80e-03 -4.80e-02  1.47e-01 -4.71e-02  1.53e-02]
 [-2.81e-04  2.91e-02 -5.75e-01  2.23e-02 -1.88e-02]
 [-4.39e-03 -4.78e-02 -2.48e-01 -6.94e-02  3.70e-02]
 [ 6.62e-03 -2.87e-03  1.01e+00 -2.83e-02  2.94e-04]
 [-6.63e-03  3.06e-02 -2.48e-01  4.66e-02 -1.01e-02]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00  4.10e-03]
 [ 0.00e+00  0.00e+00  0.00e+00 -5.33e-03  1.49e-01]
 [ 0.00e+00  0.00e+00 -1.30e-03  3.70e-02  7.19e-03]
 [ 0.00e+00  4.87e-03  5.96e-02  5.14e-04 -3.16e-01]
 [ 7.42e-04 -2.89e-03  3.40e-03 -4.28e-03 -1.89e-02]]
[[ 0.16 -0.64  0.97 -0.63  0.15]
 [-0.37  1.44 -2.1   1.32 -0.3 ]
 [-0.16  1.77 -3.32  1.98 -0.27]
 [ 0.48 -2.05  3.19 -2.16  0.54]
 [-0.19  0.8  -1.22  0.81 -0.2 ]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  3.33e-03]
 [ 0.00e+00  1.00e+00  0.00e+00 -7.46e-03  1.46e-01]
 [ 0.00e+00  0.00e+00  9.39e-04 -1.16e-03  2.08e-03]
 [ 0.00e+00 -4.44e-03 -9.33e-03  1.41e-02 -3.94e-02]
 [-9.90e-04  6.40e-02 -4.45e-04 -5.11e-03 -4.61e-02]]
[[ 0.   -0.05 -0.1   0.18 -0.03]
 [-0.05  0.44  0.32 -0.87  0.15]
 [-0.23  0.82 -1.66  1.39 -0.32]
 [ 0.36 -1.56  1.92 -1.    0.29]
 [-0.08  0.32 -0.46  0.29 -0.07]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  8.03e-03]
 [ 0.00e+00  0.00e+00  0.00e+00 -7.78e-03 -1.66e-01]
 [ 1.00e+00  0.00e+00  5.36e-03  6.31e-03 -5.27e-04]
 [ 0.00e+00  2.37e-03  1.42e-03  7.67e-04  3.38e-01]
 [-8.34e-03 -2.43e-02 -5.81e-02  1.71e-03  6.58e-03]]
[[-0.17  0.64 -1.    0.61 -0.17]
 [ 0.41 -1.42  3.29 -1.31  0.4 ]
 [ 0.07 -0.59 -1.35 -0.77  0.09]
 [-0.49  2.15 -2.08  2.29 -0.51]
 [ 0.19 -0.82  1.19 -0.85  0.2 ]]
SymNet parameters
[[-2.38e-01 -1.01e-01 -2.71e+00  1.90e-01 -1.38e-01  1.55e-01 -1.63e+00 -1.68e-01
  -2.59e-01  3.69e-03  8.91e-03  1.90e-02]
 [ 3.02e-02  1.72e-02  1.34e-02  1.91e-03 -4.42e-03  9.86e-03 -7.30e-01 -1.55e-02
   1.17e-02  6.42e-04 -1.40e-04  1.22e-03]]
SymNet parameters
[ 0.23 -0.17]
SymNet parameters
[[-3.80e-02  2.59e-02  2.65e-02  1.23e-02 -2.47e-03  6.10e-03 -9.26e-01  2.25e-02
   3.28e-02  9.16e-04  2.04e-03  1.22e-03  1.83e-03]
 [-5.31e-01 -1.19e-01 -2.31e+00  1.41e-01  1.42e-02  1.52e-01 -9.55e-01 -1.88e-01
  -2.05e-01 -1.94e-04 -1.88e-03  1.73e-02 -2.15e-02]]
SymNet parameters
[-0.29  0.47]
SymNet parameters
[[-3.24e-01  2.49e+00 -5.44e+00 -3.98e-01  2.57e-01 -1.97e-01 -5.73e+00  3.86e-01
   1.20e+00  2.18e-02  2.58e-02  1.38e-02  2.81e-01 -1.50e-01]
 [-9.72e+00  2.14e+00  1.18e+00  7.78e-02 -1.05e-01  4.74e-01  3.32e+00 -2.11e-01
   1.15e+00  1.38e-02 -5.41e-03  2.91e-02  1.89e-01 -1.13e-01]]
SymNet parameters
[ 0.98 -0.51]
SymNet parameters
[[-4.77e-01 -4.10e-01 -1.21e-01 -8.31e-02  3.83e-02 -5.62e-02  9.11e-01  7.74e-02
   1.74e-01 -2.80e-03 -3.36e-03 -6.58e-03  7.69e-02 -7.24e-02 -5.05e-04]
 [-1.53e+00  1.71e-02  2.20e-02  3.11e-03 -4.03e-03  1.01e-02 -4.51e-01 -7.54e-03
   1.68e-02 -2.39e-03 -1.44e-03  1.45e-03  1.14e-03 -9.16e-03  1.63e-04]]
SymNet parameters
[-0.14  0.55]
SymNet parameters
[[ 1.01e+00  3.85e-02 -2.28e-02  1.85e-03 -2.48e-03  1.11e-02 -3.88e-01 -7.69e-03
   3.44e-02  3.69e-04  4.65e-04  1.88e-03  6.93e-03 -9.99e-03  4.41e-04 -2.65e-02]
 [-4.94e-01  5.14e-01  6.09e-02 -7.26e-02  3.19e-02 -4.20e-02  7.13e-01  6.02e-02
   1.67e-01 -3.78e-03 -4.27e-03 -6.42e-03 -2.52e-02  1.45e-03 -2.73e-04 -1.02e-02]]
SymNet parameters
[-0.21 -0.34]
SymNet parameters
[[-2.09e-01 -2.50e-01  1.73e-01  1.57e-02  1.72e-02  1.66e-02  3.58e-01  3.81e-02
   4.15e-02 -3.11e-04 -1.01e-03 -3.86e-03 -2.86e-01 -1.44e-01  3.25e-03 -6.56e-01
  -9.75e-01]]
SymNet parameters
[-0.01]
SymNet parameters
[[-1.07e-01 -9.57e-02  5.72e-02  4.93e-03  5.43e-04 -5.24e-03  4.68e-01 -6.11e-01
   8.97e-02  2.38e-02 -3.32e-02  8.64e-02]
 [ 5.14e-02 -2.55e-01 -8.72e-02 -1.24e-02 -1.66e-02  7.43e-03 -2.98e+00 -4.61e-01
  -2.34e-01 -7.47e-02 -3.36e-02 -1.03e-01]]
SymNet parameters
[ 0.94 -1.08]
SymNet parameters
[[-1.61e-01  1.20e-01 -4.68e-01 -1.86e-02 -3.27e-02  1.06e-02  2.87e-01 -1.20e+00
   1.89e-01 -1.82e-01 -1.38e-01 -4.56e-01 -1.01e-02]
 [ 1.67e+00  2.94e-02  1.27e-01  3.19e-03  7.64e-03  3.37e-03  3.20e-01  1.04e-01
   5.42e-02  1.07e-02 -5.61e-04 -1.76e-02  3.78e-03]]
SymNet parameters
[1.37 1.21]
SymNet parameters
[[ 1.09e+00  1.23e-01  2.53e-01 -3.25e-02  6.92e-03  1.77e-02  7.08e-01  2.79e-01
  -1.50e+00  1.03e-01 -7.65e-02  2.20e-01  2.07e-01  9.26e-03]
 [-6.51e-02 -1.72e-03 -4.99e-02 -4.60e-03 -4.30e-03  2.16e-03 -1.77e+00 -7.48e-02
  -6.28e-02 -3.61e-03 -4.05e-03 -1.25e-02 -2.29e-03  1.04e-02]]
SymNet parameters
[-0.6  -0.74]
SymNet parameters
[[-3.68e-02  3.87e-03  1.95e-02 -9.51e-03 -4.51e-03  8.28e-03  2.66e+00 -3.27e+00
  -1.20e-01  3.51e-02  2.31e-03  7.29e-02  1.68e-01  2.06e-02  7.68e-03]
 [-3.86e+00 -4.26e-02  2.76e-02  1.28e-03 -1.47e-03  4.38e-03  6.61e-02 -2.54e-02
   6.52e-02 -5.75e-03 -6.59e-03 -5.36e-03  3.07e-03  2.48e-02 -6.53e-03]]
SymNet parameters
[ 1.38 -0.89]
SymNet parameters
[[ 3.30e+00  1.66e-01  1.82e-01 -3.61e-02  4.94e-03  1.66e-02  3.77e-01  6.20e-01
   2.08e+00  8.99e-02 -4.56e-02  1.68e-01  1.98e-01  6.61e-02 -1.62e-04  3.18e-02]
 [ 2.63e-02 -5.07e-03  2.66e-02  5.56e-03  3.88e-03 -3.09e-03 -1.93e+00 -3.77e-02
   5.20e-02  1.26e-03  6.91e-03  4.42e-03 -8.50e-03 -1.16e-02  1.74e-02 -5.22e-04]]
SymNet parameters
[ 0.16 -0.14]
SymNet parameters
[[-0.45 -0.01  0.    0.01  0.   -0.    0.14  0.22  0.23  0.05  0.01  0.05  0.03  0.02
  -0.14 -0.07  0.15]]
SymNet parameters
[-0.01]
finally, finish this stage
iter:     0    time: 59.99
Func: 1.78e+00  |g|: 2.48e+02
stableloss: 5.70e-02   dataloss: 1.70e+00   sparseloss: 1.12e+02 momentloss: 8.30e+00
current expression:
[u00*u01, u10*v00, u02, u20, u00*u01**2, u00*u11*v00, u01*u10*v00, u01*u10, u10*v00*v10, u00*u10*v01, u00, u10*v10, u01, u00*u01*v00, u00*u10*v00, u00**3, u00**2*u10, u10, u00*v00, u20*v00**2]
[-0.98 -0.98  0.05  0.05  0.01  0.01  0.01  0.01  0.01  0.01  0.01  0.01  0.01 -0.
 -0.   -0.    0.    0.    0.    0.  ]
[v00*v10, u00*v01, v02, v20, v00*v10**2, u00*v00*v10, u00*v00*v11, u00*u01*v01, u00*v01*v10, u10*v01, v10**2, u10*v00*v01, u00*v00, 1, u00*v10, u00, v00*v01, v10, u00**2, v00**2*v20]
[-0.99 -0.98  0.05  0.05  0.01 -0.01  0.01  0.01  0.01  0.01  0.01  0.01  0.01 -0.01
 -0.    0.    0.    0.    0.    0.  ]
u_obs.abs().max()
tensor(3.6896, device='cuda:0', dtype=torch.float64)
model(u_obs[0],T=50*dt).abs().max()
tensor(nan, device='cuda:0', dtype=torch.float64)
model(u_obs[0],T=100*dt).abs().max()
tensor(nan, device='cuda:0', dtype=torch.float64)
{'--name': 'burgers-2-upwind-sparse0-noise0.001-id1', '--dtype': 'double', '--device': 'cuda:1', '--constraint': '2', '--dt': 0.01, '--cell_num': 1, '--eps': 6.283185307179586, '--blocks': [0, 1, 2, 3, 4, 5, 6, 9], '--kernel_size': 5, '--max_order': 2, '--dx': 0.19634954084936207, '--hidden_layers': 5, '--scheme': 'upwind', '--dataname': 'burgers', '--viscosity': 0.05, '--zoom': 4, '--max_dt': 0.000625, '--batch_size': 28, '--data_timescheme': 'rk2', '--channel_names': 'u,v', '--freq': 4, '--data_start_time': 1.0, '--start_noise': 0.001, '--end_noise': 0.001, '--stablize': 0.0, '--sparsity': 0.0, '--momentsparsity': 0.001, '--npseed': -1, '--torchseed': -1, '--maxiter': 2000, '--recordfile': 'None', '--recordcycle': 200, '--savecycle': -1, '--start_from': -1}
block:  0
name:  burgers-2-upwind-sparse0-noise0.001-id1
device:  cuda:1
generate a random number to check random seed:  1.1123008354078343
current stage is: warmup
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.8315, device='cuda:1', dtype=torch.float64)
u_obs variance
tensor([ 0.2598,  2.2448,  2.1582, 21.2142, 10.2133, 18.9921,  0.2520,  1.8997,
         2.1718, 16.3988, 10.5327, 20.2749], device='cuda:1',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
iter:     0    time: 13.85
Func: 6.00e+00  |g|: 3.86e+00
stableloss: 2.38e-03   dataloss: 6.00e+00   sparseloss: 2.66e+01 momentloss: 7.27e+00
iter:   200    time: 15.42
Func: 4.17e-02  |g|: 1.64e-02
stableloss: 1.22e-02   dataloss: 4.17e-02   sparseloss: 4.86e+01 momentloss: 7.27e+00
iter:   400    time: 11.37
Func: 3.86e-02  |g|: 1.57e-02
stableloss: 1.20e-02   dataloss: 3.86e-02   sparseloss: 6.33e+01 momentloss: 7.27e+00
iter:   600    time: 12.62
Func: 3.79e-02  |g|: 9.16e-03
stableloss: 1.20e-02   dataloss: 3.79e-02   sparseloss: 6.81e+01 momentloss: 7.27e+00
iter:   800    time: 10.91
Func: 3.77e-02  |g|: 5.16e-03
stableloss: 1.20e-02   dataloss: 3.77e-02   sparseloss: 6.62e+01 momentloss: 7.27e+00
iter:  1000    time: 9.20
Func: 3.76e-02  |g|: 3.49e-03
stableloss: 1.19e-02   dataloss: 3.76e-02   sparseloss: 6.61e+01 momentloss: 7.27e+00
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 0.037600
         Iterations: 1037
         Function evaluations: 1099
         Gradient evaluations: 1092
convolution moment and kernels
[[1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
[[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 1. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
[[ 0.    1.    0.   -0.33 -0.25]
 [ 0.    0.    0.    0.    0.  ]
 [ 0.    0.    0.    0.    0.  ]
 [ 0.    0.    0.    0.    0.  ]
 [ 0.    0.    0.    0.    0.  ]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]
 [ 2.78e-17  3.33e-16 -1.50e+00  2.00e+00 -5.00e-01]
 [ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]]
[[ 0.    0.    0.    0.    0.  ]
 [ 1.    0.    0.    0.    0.  ]
 [ 0.    0.    0.    0.    0.  ]
 [-0.33  0.    0.    0.    0.  ]
 [-0.25  0.    0.    0.    0.  ]]
[[ 0.00e+00  0.00e+00  2.78e-17  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  3.33e-16  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00 -1.50e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  2.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00 -5.00e-01  0.00e+00  0.00e+00]]
[[0.   0.   1.   0.   0.08]
 [0.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.  ]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]
 [-2.22e-16  1.00e+00 -2.00e+00  1.00e+00 -1.53e-16]
 [ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]]
[[0. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
[[ 6.94e-03 -5.56e-02  9.25e-18  5.56e-02 -6.94e-03]
 [-5.56e-02  4.44e-01 -7.40e-17 -4.44e-01  5.56e-02]
 [ 9.25e-18 -7.40e-17  1.23e-32  7.40e-17 -9.25e-18]
 [ 5.56e-02 -4.44e-01  7.40e-17  4.44e-01 -5.56e-02]
 [-6.94e-03  5.56e-02 -9.25e-18 -5.56e-02  6.94e-03]]
[[0.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.  ]
 [1.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.  ]
 [0.08 0.   0.   0.   0.  ]]
[[ 0.00e+00  0.00e+00 -2.22e-16  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  1.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00 -2.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  1.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00 -1.53e-16  0.00e+00  0.00e+00]]
SymNet parameters
[[ 4.80e-01 -5.18e-02  5.23e-02  3.21e-02 -1.31e-02  9.11e-03  2.85e-02 -3.68e-04
  -1.43e-03  5.38e-04  1.86e-03 -4.07e-03]
 [-3.02e-02 -1.04e-01 -3.52e-01 -1.67e-01 -5.67e-03 -7.57e-02 -5.11e-01  1.23e-02
  -2.68e-02 -6.69e-03 -2.10e-02 -1.53e-02]]
SymNet parameters
[-0.01 -0.07]
SymNet parameters
[[-1.06e-01 -1.47e-01  5.09e-03 -4.80e-02  2.54e-03 -9.20e-03  1.19e+00  3.39e-04
   1.71e-02  3.60e-03 -1.73e-03  7.14e-03 -1.52e-02]
 [-8.50e-01 -4.40e-02  4.58e-01  4.25e-02 -1.82e-02  1.23e-02 -9.09e-02 -1.16e-02
  -2.87e-03  2.44e-03  3.04e-03  1.73e-03  9.00e-02]]
SymNet parameters
[-0.  -0.5]
SymNet parameters
[[-6.83e-01 -1.80e-01  2.28e-01 -3.84e-02  1.71e-02 -1.26e-02 -4.02e-01  6.10e-03
  -3.07e-04 -2.68e-03 -2.16e-03  1.12e-03  5.75e-02  2.28e-02]
 [ 5.83e-01 -1.21e+00  2.21e-01  2.00e-01  6.05e-02  2.49e-02  1.85e+00  4.91e-02
  -4.84e-02 -2.17e-02  3.65e-03 -4.19e-02  3.26e-03 -1.56e-01]]
SymNet parameters
[ 0.78 -0.24]
SymNet parameters
[[-1.65  0.14 -0.25 -0.29  0.09 -0.18 -1.45  0.11 -0.06 -0.   -0.01 -0.12 -0.13 -0.48
   0.14]
 [ 1.62  0.35 -0.32  0.11 -0.11  0.07 -0.3   0.04  0.17  0.02  0.07 -0.02  0.09 -0.52
   0.33]]
SymNet parameters
[0.1  0.05]
SymNet parameters
[[-1.66e-01 -6.94e-01  1.67e-01  4.62e-02  4.41e-03  2.15e-02 -1.65e+00 -1.34e-02
   6.21e-04  1.85e-03  4.86e-03  6.94e-03 -7.77e-03 -7.75e-02  2.90e-02  2.04e-03]
 [-1.62e+00  1.86e-01 -4.27e-01 -3.93e-04 -2.47e-02  1.98e-03 -4.26e-01 -1.69e-02
  -3.52e-03  3.84e-03 -1.05e-04  1.34e-03 -1.51e-01  5.78e-02 -3.76e-03  1.66e-02]]
SymNet parameters
[-0.09 -0.02]
SymNet parameters
[[ 0.39 -0.18  0.04  0.11  0.01  0.05 -0.04  0.01 -0.02 -0.01 -0.   -0.01  0.88 -0.92
  -0.28 -0.03 -0.46]]
SymNet parameters
[-0.06]
SymNet parameters
[[-1.19e+00 -8.15e-03  1.83e-03  1.61e-03 -9.70e-05 -1.33e-03 -2.74e-02 -1.44e-02
  -1.49e-01 -2.01e-03  1.49e-03 -1.76e-02]
 [-4.80e-01  2.53e-02  4.53e-02 -2.29e-02 -2.10e-03 -2.52e-02 -6.38e-01  1.15e+00
   1.20e-01 -8.16e-02 -9.57e-02 -8.25e-02]]
SymNet parameters
[-0.86  0.06]
SymNet parameters
[[ 0.46  0.03 -0.02  0.01  0.01  0.01  0.77 -0.11 -0.15  0.05  0.01  0.06 -0.04]
 [ 1.35 -0.1  -0.    0.    0.03  0.   -0.65  0.34  0.67  0.08 -0.01  0.15 -0.05]]
SymNet parameters
[-0.2  -0.14]
SymNet parameters
[[-0.96 -0.02  0.03 -0.01  0.02 -0.02  0.94  0.27 -0.29  0.03 -0.12  0.13 -0.08 -0.05]
 [-0.7  -0.03  0.08 -0.03  0.01 -0.03 -1.12  0.13  0.23 -0.09 -0.11 -0.16  0.01  0.02]]
SymNet parameters
[-0.16 -0.25]
SymNet parameters
[[ 0.57  0.21  0.01 -0.05  0.01 -0.07  1.01  0.37 -1.13 -0.09 -0.36  0.25 -0.09 -0.18
  -0.04]
 [ 0.92 -0.09  0.07 -0.05  0.03 -0.04 -0.28  0.44  0.86 -0.07 -0.19 -0.17 -0.03  0.02
   0.03]]
SymNet parameters
[-0.24  0.01]
SymNet parameters
[[ 4.39e-01  2.06e-02 -3.28e-03  2.56e-03  5.87e-03  8.43e-03 -1.57e+00  2.13e-01
  -2.39e-02  4.20e-02  8.19e-03  8.42e-03 -6.61e-02  2.91e-02  3.22e-02 -1.63e-03]
 [-4.56e-01 -9.40e-02  2.74e-02 -7.68e-03 -2.99e-03 -1.06e-02 -9.91e-01  7.72e-02
  -8.52e-01 -6.18e-02  1.00e-03 -6.54e-02  5.18e-02  2.52e-03  4.85e-02 -1.02e-02]]
SymNet parameters
[-0.39  0.41]
SymNet parameters
[[-0.19  0.05  0.02 -0.01 -0.01 -0.01 -0.45  0.73  0.16 -0.01 -0.05 -0.03  0.75 -0.57
  -0.29  0.06 -0.38]]
SymNet parameters
[0.02]
finally, finish this stage
iter:  1037    time: 3.70
Func: 3.76e-02  |g|: 2.95e-03
stableloss: 1.18e-02   dataloss: 3.76e-02   sparseloss: 6.61e+01 momentloss: 7.27e+00
current expression:
[u00*u01, u10*v00, u00, u02, u20, u00**3, v00, u00**2, u01*u10*v00, v00**2, u01, v00**3, u00**2*u02, u00*v00**2, u00*v00, u10, u01*v00, u00*u11*v00, u00*u10*v00, u00*u01**2]
[-0.89 -0.89  0.06  0.04  0.04 -0.03  0.01 -0.01  0.01 -0.01  0.01 -0.01 -0.01  0.01
 -0.01 -0.01 -0.01  0.01  0.01  0.01]
[v00*v10, u00*v01, v00, v20, v02, v00**3, u00*v00, u00**2, v00**2*v20, u00**2*v00, v00**2, v01, u00*v00*v11, v00*v10**2, u00*v00*v01, u00**2*v00**2, u00*v00**2, u00**2*v01, v00**2*v01, 1]
[-0.89 -0.88  0.08  0.04  0.04 -0.04 -0.02 -0.01 -0.01  0.01 -0.01  0.01  0.01  0.01
 -0.01  0.01  0.01 -0.01 -0.01  0.01]
block:  1
name:  burgers-2-upwind-sparse0-noise0.001-id1
device:  cuda:1
generate a random number to check random seed:  -0.8677077674282402
current stage is: block-1
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.8733, device='cuda:1', dtype=torch.float64)
u_obs variance
tensor([ 0.2513,  2.0471,  1.9751, 18.7937,  9.9749, 16.9944,  0.2578,  2.0508,
         2.0813, 17.8158, 10.5013, 19.0978], device='cuda:1',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
iter:     0    time: 1418.01
Func: 5.83e-02  |g|: 8.76e-01
stableloss: 9.96e-03   dataloss: 5.10e-02   sparseloss: 6.61e+01 momentloss: 7.27e+00
iter:   200    time: 10.29
Func: 2.27e-02  |g|: 1.47e-02
stableloss: 6.09e-03   dataloss: 1.61e-02   sparseloss: 6.83e+01 momentloss: 6.63e+00
iter:   400    time: 10.32
Func: 2.21e-02  |g|: 8.95e-03
stableloss: 6.11e-03   dataloss: 1.55e-02   sparseloss: 7.15e+01 momentloss: 6.61e+00
iter:   600    time: 10.30
Func: 2.18e-02  |g|: 6.55e-03
stableloss: 6.17e-03   dataloss: 1.53e-02   sparseloss: 7.12e+01 momentloss: 6.57e+00
iter:   800    time: 10.19
Func: 2.17e-02  |g|: 5.37e-03
stableloss: 6.15e-03   dataloss: 1.51e-02   sparseloss: 7.01e+01 momentloss: 6.55e+00
iter:  1000    time: 10.26
Func: 2.16e-02  |g|: 3.34e-03
stableloss: 6.15e-03   dataloss: 1.51e-02   sparseloss: 7.27e+01 momentloss: 6.54e+00
iter:  1200    time: 10.22
Func: 2.16e-02  |g|: 4.49e-03
stableloss: 6.13e-03   dataloss: 1.50e-02   sparseloss: 7.28e+01 momentloss: 6.53e+00
iter:  1400    time: 10.22
Func: 2.15e-02  |g|: 7.01e-03
stableloss: 6.05e-03   dataloss: 1.50e-02   sparseloss: 7.22e+01 momentloss: 6.51e+00
iter:  1600    time: 10.22
Func: 2.15e-02  |g|: 2.73e-03
stableloss: 6.00e-03   dataloss: 1.50e-02   sparseloss: 7.12e+01 momentloss: 6.50e+00
iter:  1800    time: 10.22
Func: 2.15e-02  |g|: 2.92e-03
stableloss: 5.95e-03   dataloss: 1.49e-02   sparseloss: 7.40e+01 momentloss: 6.52e+00
Warning: Maximum number of iterations has been exceeded.
         Current function value: 0.021448
         Iterations: 2000
         Function evaluations: 2004
         Gradient evaluations: 2004
convolution moment and kernels
[[ 1.00e+00  0.00e+00  4.54e-04 -1.44e-03 -3.10e-02]
 [ 0.00e+00  7.91e-05  1.90e-03  6.11e-04  6.72e-03]
 [ 7.03e-05 -2.15e-03 -5.28e-04  4.58e-03  2.34e-03]
 [ 1.29e-03  2.83e-03  1.58e-03 -2.31e-03 -1.37e-02]
 [-4.19e-02  9.88e-03  1.66e-04 -1.33e-02  7.99e-03]]
[[ 0.02 -0.08  0.05 -0.04  0.01]
 [-0.08  0.27 -0.11  0.1  -0.02]
 [ 0.06 -0.18  0.81  0.1  -0.04]
 [-0.05  0.13  0.11 -0.05  0.02]
 [ 0.01 -0.02 -0.04  0.02 -0.01]]
[[ 0.00e+00  1.00e+00  0.00e+00 -1.08e-01 -6.23e-02]
 [ 0.00e+00  0.00e+00  2.36e-03  8.00e-04  8.47e-04]
 [ 0.00e+00  3.18e-02  2.37e-04  7.13e-03 -4.36e-03]
 [ 2.02e-03 -3.73e-03 -1.66e-03  3.35e-03 -4.00e-03]
 [ 9.59e-03  3.23e-03 -4.77e-04 -9.97e-03 -5.82e-04]]
[[ 8.10e-03 -2.05e-02  1.84e-02  7.10e-03 -4.48e-03]
 [-3.19e-02  6.59e-02 -8.21e-02 -4.22e-03  1.60e-02]
 [ 1.17e-01 -5.97e-01 -2.63e-01  1.03e+00 -2.26e-01]
 [-1.99e-02  2.74e-02 -4.75e-02 -2.15e-02  2.11e-02]
 [ 2.21e-03 -9.68e-04  6.59e-04  1.52e-02 -6.53e-03]]
[[ 0.00e+00  0.00e+00  0.00e+00  5.83e-03  9.22e-03]
 [ 1.00e+00  0.00e+00  1.37e-02 -3.04e-03 -1.34e-02]
 [ 0.00e+00  7.36e-03 -1.38e-03 -5.55e-03 -5.99e-03]
 [-1.05e-01  1.57e-04  9.57e-03  2.93e-03 -8.15e-03]
 [-6.55e-02  1.25e-02 -5.31e-03 -6.01e-03 -4.62e-03]]
[[ 0.   -0.02  0.09  0.01 -0.01]
 [-0.    0.03 -0.49 -0.07  0.02]
 [ 0.01 -0.08 -0.34  0.03 -0.01]
 [-0.    0.02  1.04 -0.05  0.02]
 [-0.    0.01 -0.24  0.04 -0.01]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00  5.15e-05]
 [ 0.00e+00  0.00e+00  0.00e+00  1.73e-03  7.54e-04]
 [ 0.00e+00  0.00e+00  1.93e-03 -1.60e-03  1.77e-03]
 [ 0.00e+00  1.49e-03  7.18e-04 -2.95e-03 -2.04e-03]
 [ 3.22e-02 -6.53e-03 -1.35e-03  5.84e-03 -7.11e-03]]
[[-1.04e-02  3.46e-02 -1.91e-04  9.75e-03 -1.61e-03]
 [ 4.46e-02 -1.49e-01  1.91e-02 -5.34e-02  1.04e-02]
 [-1.52e-01  1.57e+00 -2.56e+00  1.44e+00 -1.06e-01]
 [ 4.55e-02 -1.62e-01  5.32e-02 -8.59e-02  2.00e-02]
 [-1.09e-02  4.00e-02 -1.50e-02  2.36e-02 -5.58e-03]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  4.53e-04]
 [ 0.00e+00  1.00e+00  0.00e+00 -2.12e-03 -3.41e-03]
 [ 0.00e+00  0.00e+00 -2.23e-03  5.29e-04  4.63e-03]
 [ 0.00e+00 -2.30e-03 -1.51e-03  3.97e-03  3.34e-03]
 [-2.92e-03  3.87e-04  3.93e-03 -3.00e-04 -1.16e-02]]
[[-5.98e-03  3.01e-03 -9.85e-02  1.21e-01 -2.26e-02]
 [ 2.01e-04  1.95e-01  4.10e-01 -7.13e-01  1.19e-01]
 [-8.12e-02  3.56e-01 -5.73e-01  3.66e-01 -8.47e-02]
 [ 1.06e-01 -6.59e-01  3.36e-01  2.38e-01 -9.10e-03]
 [-1.82e-02  1.02e-01 -7.13e-02 -1.34e-02 -2.36e-03]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  5.41e-03]
 [ 0.00e+00  0.00e+00  0.00e+00  2.26e-03  4.55e-04]
 [ 1.00e+00  0.00e+00  2.73e-03 -6.75e-04 -2.23e-03]
 [ 0.00e+00  2.50e-03  1.59e-03 -4.19e-03 -2.63e-03]
 [-1.70e-03 -3.35e-03 -1.74e-03  3.76e-03  5.41e-04]]
[[-1.12e-03 -2.84e-03 -6.56e-02 -2.12e-02  5.74e-03]
 [ 3.05e-03  1.63e-02  1.26e+00  8.08e-02 -2.12e-02]
 [ 1.89e-03 -4.24e-02 -2.38e+00 -1.18e-01  2.95e-02]
 [ 3.06e-03  3.40e-03  1.30e+00  3.84e-02 -8.98e-03]
 [-1.46e-03  3.85e-03 -8.58e-02 -2.00e-03  4.13e-04]]
SymNet parameters
[[ 1.51e-01 -1.06e-02 -3.53e-03  4.62e-03 -8.73e-05  4.76e-04  2.89e-02  3.37e-03
   1.13e-02  1.24e-04  8.81e-04 -6.75e-04]
 [ 7.49e-01 -1.16e+00  3.51e-03 -3.69e-01 -5.29e-02  4.33e-02 -2.44e-01  2.04e-02
   6.49e-02  1.56e-02 -4.72e-02 -1.56e-02]]
SymNet parameters
[-0.41 -0.03]
SymNet parameters
[[-5.99e-02 -1.44e-03  7.86e-05  1.42e-03  9.20e-04 -7.23e-04  1.13e+00 -4.27e-02
   1.20e-02 -1.09e-03 -2.24e-04  1.12e-04 -6.21e-02]
 [ 5.03e-02  1.65e-02  4.26e-01 -5.53e-03 -1.66e-02  2.79e-03 -7.18e-03 -3.24e-03
  -3.46e-03 -1.21e-04 -1.58e-03 -1.20e-03  3.16e-02]]
SymNet parameters
[ 0.22 -1.06]
SymNet parameters
[[ 1.06e-01 -1.61e-02  7.27e-01 -2.62e-02  1.62e-02 -1.22e-03 -1.31e-02  2.96e-03
   6.05e-04  2.95e-03 -2.09e-03 -6.43e-05  5.96e-02  1.03e-02]
 [-1.87e-01  7.59e-02 -1.23e-02  1.96e-02  2.02e-03  3.18e-04  2.55e+00  7.17e-02
  -1.17e-02 -1.34e-04  3.68e-03  3.19e-03 -7.20e-02 -2.49e-02]]
SymNet parameters
[ 0.74 -0.38]
SymNet parameters
[[-3.66e+00 -3.51e-01 -6.21e-02 -2.00e-01 -1.51e-02  2.70e-02 -4.55e-01  2.91e-02
   8.22e-02 -1.61e-02 -1.99e-02  1.66e-02 -7.54e-01 -7.87e-01  2.34e-02]
 [ 3.15e+00  5.91e-01 -3.87e-01 -3.63e-02 -1.85e-02  6.15e-02  1.37e+00  1.37e-01
   7.83e-01  1.60e-02  1.92e-03 -3.79e-02  1.35e+00  7.15e-01 -2.30e-01]]
SymNet parameters
[0.16 0.01]
SymNet parameters
[[-7.84e-01 -1.54e+00  7.15e-02  8.25e-02  1.65e-02 -2.17e-02 -1.10e+00 -1.40e-02
  -1.81e-01 -9.08e-03  9.04e-03  1.42e-02 -2.43e-01 -7.93e-01  1.86e-01  1.91e-03]
 [-1.29e+00  4.70e-03 -3.86e-03 -3.69e-03 -1.96e-05  1.13e-03  8.97e-02  5.13e-04
   5.14e-03 -9.29e-04  7.93e-04  9.48e-04 -1.33e-01 -2.15e-02  6.11e-03 -1.85e-03]]
SymNet parameters
[ 0.07 -0.67]
SymNet parameters
[[ 0.54 -0.05 -0.02 -0.14 -0.03  0.08 -0.29  0.07  0.08  0.01 -0.02 -0.01  1.26 -0.67
  -0.35 -0.03 -0.45]]
SymNet parameters
[-0.32]
SymNet parameters
[[-9.33e-01 -5.37e-04  6.11e-03  2.07e-04  1.39e-03 -2.42e-03  4.02e-01 -5.30e-02
  -3.64e-02 -6.54e-03 -7.39e-03  4.40e-02]
 [ 1.27e-02 -3.43e-02  3.13e-02 -5.50e-03  4.17e-03 -9.74e-03  1.74e-01  1.21e+00
  -2.91e-01  9.10e-03 -1.12e-01  9.50e-02]]
SymNet parameters
[-0.71 -0.04]
SymNet parameters
[[ 2.38e-01 -4.49e-03  1.14e-02  7.75e-04  1.84e-03 -4.82e-03  7.21e-01 -5.42e-02
  -1.83e-02 -1.53e-02  2.29e-03  7.20e-02  3.95e-03]
 [-6.71e-01 -1.69e-02  6.27e-02  7.82e-03  1.63e-02 -4.22e-02  1.74e-01  5.72e-01
   2.12e+00 -1.31e-01 -6.46e-03  6.21e-01 -1.06e-01]]
SymNet parameters
[ 0.3  -0.63]
SymNet parameters
[[-1.46  0.01  0.06  0.    0.01 -0.02  0.85  0.32 -0.22 -0.05 -0.01  0.31  0.2   0.06]
 [-0.11  0.46 -0.24 -0.03  0.02  0.01 -0.64 -1.8   0.62  0.3  -0.87 -0.03 -0.03  0.13]]
SymNet parameters
[-0.34 -0.5 ]
SymNet parameters
[[ 2.04 -0.02  0.11  0.01  0.01 -0.03  0.13 -0.11  0.05 -0.09  0.04  0.42  0.13  0.09
  -0.  ]
 [-0.5  -0.44  0.32 -0.03  0.02 -0.06 -0.44 -1.11  1.72 -0.02 -0.46  0.52 -0.08  0.01
  -0.03]]
SymNet parameters
[-0.26 -0.06]
SymNet parameters
[[-0.33  0.05  0.05  0.02  0.02 -0.06  0.07 -0.53 -0.55 -0.21  0.05  0.93 -0.13  0.02
   0.01 -0.01]
 [-0.43 -0.05  0.03 -0.   -0.    0.   -1.23  0.07 -0.36  0.02 -0.02 -0.07  0.02  0.02
  -0.   -0.  ]]
SymNet parameters
[-0.33  0.37]
SymNet parameters
[[-1.84e-01 -1.81e-02  2.40e-02  6.96e-05  4.82e-03 -1.25e-02 -4.35e-02  5.92e-01
   1.99e-01  2.32e-02 -4.04e-02  2.32e-01  5.90e-01 -5.11e-01 -2.20e-02  4.06e-02
  -1.80e-01]]
SymNet parameters
[-0.14]
finally, finish this stage
iter:  2000    time: 10.35
Func: 2.14e-02  |g|: 1.35e-03
stableloss: 5.91e-03   dataloss: 1.49e-02   sparseloss: 7.78e+01 momentloss: 6.53e+00
current expression:
[u00*u01, u10*v00, u20, u02, u00*u01**2, u00*u10*v01, u00*u11*v00, u00, u01*u10*v00, u01, u10*v00*v10, u00*v00, u00**2*u01, u00*u01*v00, u00**2, u00**3, u00**2*v00, u01*v00**2, v00, u01**2]
[-0.98 -0.97  0.05  0.05  0.02  0.01  0.01  0.01  0.01 -0.01  0.01 -0.01  0.    0.
 -0.   -0.   -0.    0.   -0.   -0.  ]
[v00*v10, u00*v01, v02, v20, v00*v10**2, u00*v01*v10, u00, u00*v00*v11, v00, u00*u01*v01, u01*v00*v01, v11, v00**2*v10, u00*u10*v01, v10, u00*v00*v01, u00*v10, u00**2*v01, u00*v00**2, u00*v00]
[-0.98 -0.97  0.05  0.05  0.01  0.01 -0.01  0.01  0.01  0.01 -0.    0.    0.   -0.
 -0.    0.    0.    0.    0.    0.  ]
block:  2
name:  burgers-2-upwind-sparse0-noise0.001-id1
device:  cuda:1
generate a random number to check random seed:  -2.30240730071429
current stage is: block-2
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.6895, device='cuda:1', dtype=torch.float64)
u_obs variance
tensor([ 0.2636,  1.8856,  1.7424, 24.0459, 10.9178, 19.9636,  0.2567,  1.6251,
         1.8230, 18.4214,  9.9650, 23.8435], device='cuda:1',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
iter:     0    time: 1014.58
Func: 6.70e-02  |g|: 2.74e+00
stableloss: 1.16e-02   dataloss: 5.39e-02   sparseloss: 7.78e+01 momentloss: 6.53e+00
iter:   200    time: 14.47
Func: 5.56e-02  |g|: 8.59e-02
stableloss: 1.14e-02   dataloss: 4.23e-02   sparseloss: 7.72e+01 momentloss: 6.65e+00
iter:   400    time: 14.28
Func: 5.46e-02  |g|: 4.01e-02
stableloss: 1.14e-02   dataloss: 4.13e-02   sparseloss: 8.36e+01 momentloss: 6.65e+00
iter:   600    time: 14.32
Func: 5.42e-02  |g|: 6.64e-02
stableloss: 1.13e-02   dataloss: 4.09e-02   sparseloss: 9.07e+01 momentloss: 6.64e+00
iter:   800    time: 14.36
Func: 5.40e-02  |g|: 4.09e-02
stableloss: 1.14e-02   dataloss: 4.08e-02   sparseloss: 9.62e+01 momentloss: 6.63e+00
iter:  1000    time: 14.40
Func: 5.36e-02  |g|: 5.09e-02
stableloss: 1.15e-02   dataloss: 4.03e-02   sparseloss: 1.02e+02 momentloss: 6.63e+00
iter:  1200    time: 14.36
Func: 5.34e-02  |g|: 2.33e-02
stableloss: 1.14e-02   dataloss: 4.01e-02   sparseloss: 1.02e+02 momentloss: 6.64e+00
iter:  1400    time: 14.35
Func: 5.33e-02  |g|: 3.59e-02
stableloss: 1.13e-02   dataloss: 4.00e-02   sparseloss: 1.03e+02 momentloss: 6.66e+00
iter:  1600    time: 14.43
Func: 5.32e-02  |g|: 3.71e-02
stableloss: 1.13e-02   dataloss: 3.99e-02   sparseloss: 1.10e+02 momentloss: 6.67e+00
iter:  1800    time: 14.47
Func: 5.31e-02  |g|: 3.73e-02
stableloss: 1.14e-02   dataloss: 3.98e-02   sparseloss: 1.14e+02 momentloss: 6.67e+00
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 0.053100
         Iterations: 1983
         Function evaluations: 2036
         Gradient evaluations: 2030
convolution moment and kernels
[[ 1.00e+00  0.00e+00  1.52e-04  2.52e-02 -7.87e-02]
 [ 0.00e+00 -1.31e-05 -4.97e-04  5.17e-04  7.26e-03]
 [ 4.53e-04  1.04e-04  5.66e-03 -7.37e-03 -1.12e-03]
 [-4.63e-03 -7.52e-04  6.61e-03  1.44e-04 -1.95e-02]
 [-5.33e-02  1.08e-02  1.11e-03  8.19e-04  1.42e-03]]
[[ 0.01 -0.06  0.03 -0.05  0.01]
 [-0.03  0.16 -0.01  0.12 -0.04]
 [-0.09  0.27  0.29  0.25 -0.05]
 [ 0.02 -0.06  0.33 -0.09  0.01]
 [-0.01  0.04 -0.12  0.05 -0.01]]
[[ 0.00e+00  1.00e+00  0.00e+00 -1.06e-01 -7.03e-02]
 [ 0.00e+00  0.00e+00  2.38e-03  1.32e-03  4.19e-04]
 [ 0.00e+00  2.40e-02 -3.26e-03  2.86e-02 -1.62e-02]
 [-3.44e-03  4.18e-03  3.98e-03  3.87e-03  3.81e-03]
 [-3.75e-03 -5.55e-03  1.49e-03 -4.00e-03 -2.91e-03]]
[[-1.28e-04  1.19e-02 -2.26e-02  1.55e-02 -6.73e-03]
 [-2.95e-02  3.34e-02 -7.13e-03 -3.17e-03  1.80e-02]
 [ 1.28e-01 -5.94e-01 -3.49e-01  1.02e+00 -2.25e-01]
 [-3.39e-02  5.48e-02 -3.07e-02  1.91e-02  9.01e-03]
 [ 1.84e-03  2.58e-03 -1.25e-02  4.42e-03 -1.81e-03]]
[[ 0.00e+00  0.00e+00  0.00e+00  5.37e-03  5.00e-03]
 [ 1.00e+00  0.00e+00  9.18e-03  4.17e-04 -2.55e-02]
 [ 0.00e+00  1.38e-02 -2.96e-03 -6.38e-03 -2.02e-03]
 [-8.51e-02 -2.00e-03  2.18e-02 -3.78e-03 -1.11e-02]
 [-5.89e-02  2.66e-02 -1.32e-02  1.41e-03 -6.10e-03]]
[[-3.21e-04 -3.45e-02  1.10e-01 -6.96e-03 -8.56e-04]
 [ 2.38e-02  1.72e-02 -5.12e-01 -6.62e-02  2.06e-02]
 [-2.51e-02 -4.27e-02 -3.33e-01  6.42e-02 -1.61e-02]
 [ 1.10e-02  2.79e-02  1.00e+00 -6.64e-02  1.52e-02]
 [-7.10e-03  1.74e-02 -2.34e-01  5.00e-02 -1.11e-02]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00  1.93e-03]
 [ 0.00e+00  0.00e+00  0.00e+00 -2.27e-03 -2.73e-04]
 [ 0.00e+00  0.00e+00  4.93e-03 -1.38e-03 -3.79e-03]
 [ 0.00e+00  1.01e-07  2.81e-03  1.19e-03  5.15e-04]
 [ 1.06e-02 -4.97e-03 -2.98e-03  4.49e-03 -2.40e-04]]
[[-2.13e-03  1.56e-03  2.14e-02 -1.27e-02  2.52e-03]
 [ 5.04e-03  1.16e-02 -1.16e-01  7.24e-02 -1.54e-02]
 [-8.85e-02  1.30e+00 -2.30e+00  1.20e+00 -5.32e-02]
 [ 6.81e-03  4.30e-03 -1.10e-01  7.58e-02 -1.90e-02]
 [-2.59e-03  4.64e-03  1.77e-02 -1.28e-02  3.63e-03]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  3.24e-03]
 [ 0.00e+00  1.00e+00  0.00e+00 -2.35e-03  5.20e-03]
 [ 0.00e+00  0.00e+00  1.63e-03  1.36e-03 -3.39e-03]
 [ 0.00e+00 -2.14e-03 -5.93e-04  3.84e-03 -2.58e-03]
 [-9.22e-04 -4.32e-03 -2.47e-03  2.46e-03  6.58e-03]]
[[ 0.02 -0.09  0.06  0.02  0.  ]
 [-0.09  0.59 -0.25 -0.27  0.02]
 [ 0.04 -0.2   0.35 -0.26  0.06]
 [ 0.04 -0.35 -0.18  0.59 -0.09]
 [-0.    0.04  0.04 -0.09  0.02]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  4.21e-02]
 [ 0.00e+00  0.00e+00  0.00e+00 -1.46e-03 -6.29e-04]
 [ 1.00e+00  0.00e+00  5.17e-03  8.97e-04 -3.83e-03]
 [ 0.00e+00 -2.28e-04  3.37e-03  5.11e-04  1.37e-03]
 [ 8.17e-03 -1.95e-03 -5.27e-03 -2.54e-04  1.63e-03]]
[[ 2.03e-03 -1.42e-02 -4.94e-02 -1.52e-02  1.63e-03]
 [-1.37e-02  7.98e-02  1.16e+00  8.25e-02 -1.12e-02]
 [ 6.61e-02 -3.01e-01 -1.97e+00 -3.10e-01  6.43e-02]
 [-1.52e-02  8.19e-02  1.16e+00  9.12e-02 -1.58e-02]
 [ 2.83e-03 -1.47e-02 -4.90e-02 -1.75e-02  3.22e-03]]
SymNet parameters
[[ 1.84e-01 -5.58e-05 -1.11e-02  5.55e-03 -9.69e-04 -1.27e-04  1.54e-02  2.65e-03
   1.28e-02 -7.12e-05  1.34e-04 -2.61e-04]
 [-6.99e-01 -1.44e+00 -1.64e-01 -4.16e-01  1.02e-01  2.85e-02  2.78e-01 -1.55e-01
  -2.65e-01  2.60e-02 -1.07e-02  1.74e-02]]
SymNet parameters
[-0.32 -0.43]
SymNet parameters
[[ 2.08e-02  3.39e-02 -1.92e-03 -2.41e-02  4.07e-03  2.27e-03  1.22e+00 -9.77e-02
  -2.71e-02 -3.09e-05  2.11e-03  2.52e-03 -1.94e-02]
 [-2.07e-02 -7.69e-03  6.87e-02  1.06e-03 -5.90e-03 -4.45e-04  4.66e-03  1.09e-03
  -3.75e-03 -5.58e-04  5.48e-05 -4.44e-04  6.87e-03]]
SymNet parameters
[ 0.02 -1.34]
SymNet parameters
[[-5.44e-01 -2.88e-01  1.04e+00 -5.34e-02  1.88e-02 -1.97e-04 -2.82e-01  7.47e-03
  -8.29e-02  2.37e-03 -1.40e-03  2.33e-03  7.82e-02 -2.50e-01]
 [-8.44e-02  7.57e-02  4.39e-02 -9.90e-03 -1.03e-03 -2.58e-03  2.52e+00  3.94e-02
  -9.96e-02 -3.22e-03 -2.20e-03 -3.09e-03 -1.96e-02 -1.70e-01]]
SymNet parameters
[ 0.45 -0.38]
SymNet parameters
[[-4.57e+00 -9.12e-01  6.87e-01 -1.30e-01  2.95e-02  1.00e-02 -1.64e-01  1.90e-02
  -2.16e-01  4.64e-03 -2.77e-03  4.14e-03 -2.38e-01 -5.03e-01 -2.18e-02]
 [ 4.76e+00 -1.83e-01 -3.14e-01  2.96e-01 -2.96e-02  8.16e-03 -1.18e+00  1.17e-01
   9.41e-01  1.55e-03  3.64e-03 -5.46e-03  5.46e-01  2.21e-01 -5.65e-02]]
SymNet parameters
[ 0.04 -0.02]
SymNet parameters
[[-1.35e+00 -7.27e-01  3.54e-01  7.19e-02 -2.64e-02 -1.28e-02 -2.42e+00  2.19e-01
  -1.61e-01 -8.37e-03 -2.85e-03 -8.04e-03 -6.59e-02 -1.64e+00  3.82e-02 -8.08e-04]
 [-1.74e+00  8.60e-02  3.46e-02 -3.27e-03 -3.52e-03 -1.70e-03  3.98e-02 -2.09e-02
  -5.02e-02 -6.82e-04  1.24e-03  1.66e-04 -2.46e-01  1.26e-01  1.59e-02  1.66e-03]]
SymNet parameters
[ 0.07 -0.72]
SymNet parameters
[[ 0.25 -0.68 -0.42 -0.24  0.08  0.07  0.01 -0.06 -0.07  0.02 -0.01  0.01  2.29 -0.31
  -0.36 -0.08 -0.63]]
SymNet parameters
[-0.43]
SymNet parameters
[[-6.20e-01 -1.03e-03  3.74e-02  6.64e-04  7.04e-04  9.14e-04  1.53e-02  1.03e-03
   8.35e-03  6.80e-05  1.08e-03 -3.06e-04]
 [ 1.42e-02  4.93e-03 -1.88e-03 -2.89e-03 -3.54e-03 -5.41e-04 -4.15e-02  8.74e-01
  -1.12e-02  1.01e-03 -5.39e-02  6.16e-03]]
SymNet parameters
[-1.16  1.3 ]
SymNet parameters
[[-3.15e-02 -1.90e-02  7.63e-04 -1.90e-03  9.88e-04  4.00e-05  7.72e-01  7.29e-02
   4.45e-02  3.18e-03 -2.85e-03  2.69e-02  7.16e-02]
 [-1.74e+00  1.12e-01  9.24e-02 -5.46e-02  6.33e-02  5.21e-03  3.65e-01  6.26e-01
   3.39e+00  1.17e-01 -6.30e-03  9.56e-01  6.55e-01]]
SymNet parameters
[ 0.66 -0.42]
SymNet parameters
[[-2.80e+00  5.29e-02 -3.37e-02 -2.30e-02  1.23e-02  3.24e-03  2.99e-01  1.50e+00
   8.07e-01  6.71e-02 -5.48e-02  3.21e-01  1.14e+00  1.36e-01]
 [-2.85e-01  7.31e-02 -2.56e-02 -1.38e-01  3.71e-02  7.47e-03  1.63e+00 -5.43e+00
   3.74e+00  3.13e-01 -3.79e-01  1.43e+00  5.18e+00  5.90e-01]]
SymNet parameters
[-0.16 -0.29]
SymNet parameters
[[-1.74e-01  6.00e-02 -7.06e-03 -5.10e-02  2.49e-02  6.59e-03  5.56e-01  2.84e+00
   1.66e+00  1.26e-01 -9.91e-02  6.10e-01  2.17e+00  2.65e-01 -3.87e-05]
 [-3.44e+00 -2.13e-01 -4.32e-02 -3.02e-02  2.12e-03 -5.38e-04  6.11e-01 -1.55e+00
   1.63e+00  7.86e-02 -1.07e-01  3.52e-01  1.45e+00  1.81e-01 -3.51e-04]]
SymNet parameters
[ 0.45 -0.62]
SymNet parameters
[[-8.72e-01  1.14e-01  3.20e-02 -4.44e-02  4.45e-02  3.35e-03  2.24e-01  1.10e+00
  -3.99e-01  9.00e-02 -5.15e-02  7.42e-01  1.21e+00  4.14e-03  1.22e-02 -2.23e-02]
 [ 8.53e-02 -1.26e-02 -1.32e-03  5.84e-03 -4.69e-03 -4.03e-04 -1.65e+00 -1.68e-01
  -2.26e-01 -1.10e-02  6.72e-03 -7.47e-02 -1.52e-01  9.72e-03  4.70e-04 -1.14e-03]]
SymNet parameters
[0.67 0.48]
SymNet parameters
[[-1.22e-01  1.53e-02  8.90e-03 -1.73e-02  1.67e-02  6.37e-04  1.22e-01  6.96e-01
   7.07e-01  8.66e-02 -2.42e-02  3.35e-01  5.84e-01 -3.41e-01 -2.31e-02  4.28e-02
  -2.07e-01]]
SymNet parameters
[0.46]
finally, finish this stage
iter:  1983    time: 16.24
Func: 5.31e-02  |g|: 1.14e-02
stableloss: 1.13e-02   dataloss: 3.98e-02   sparseloss: 1.20e+02 momentloss: 6.66e+00
current expression:
[u00*u01, u10*v00, u20, u02, u00, u00*u01**2, u00*u11*v00, u10*v00*v10, u00*u10*v01, u01*u10*v00, u00*u01*v00, u00**3, u00*v01, u00*u10, u00**2*v01, u00**2*v00, u20*v00, u00**2*v10, u10*v00**2, u01]
[-0.98 -0.98  0.05  0.05  0.02  0.01  0.01  0.01  0.01  0.01  0.01 -0.    0.    0.
 -0.   -0.    0.   -0.    0.    0.  ]
[v00*v10, u00*v01, v02, v20, v00*v10**2, u00*u01*v01, u00*v00*v11, u10*v00*v01, u00*v01*v10, v00**2*v10, u00*v00*v10, u01*v00*v10, v10, v01, v00*v20, v00**2*v10**2, 1, u00**2*v00*v01, v01*v10, v00**2*v01]
[-0.98 -0.97  0.05  0.05  0.02  0.01  0.01  0.01  0.01  0.01 -0.01 -0.   -0.    0.
  0.   -0.   -0.    0.   -0.    0.  ]
block:  3
name:  burgers-2-upwind-sparse0-noise0.001-id1
device:  cuda:1
generate a random number to check random seed:  1.6113332515112737
current stage is: block-3
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.8796, device='cuda:1', dtype=torch.float64)
u_obs variance
tensor([ 0.2490,  1.7228,  1.6458, 22.1014, 10.4555, 19.1495,  0.2506,  1.6219,
         1.5816, 18.2159,  9.1534, 20.4981], device='cuda:1',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 0.173484
         Iterations: 0
         Function evaluations: 15
         Gradient evaluations: 3
convolution moment and kernels
[[ 1.00e+00  0.00e+00  1.51e-04  2.52e-02 -7.87e-02]
 [ 0.00e+00 -1.54e-05 -4.94e-04  5.13e-04  7.26e-03]
 [ 4.49e-04  1.08e-04  5.66e-03 -7.37e-03 -1.12e-03]
 [-4.63e-03 -7.54e-04  6.61e-03  1.41e-04 -1.95e-02]
 [-5.33e-02  1.08e-02  1.11e-03  8.23e-04  1.42e-03]]
[[ 0.01 -0.06  0.03 -0.05  0.01]
 [-0.03  0.16 -0.01  0.12 -0.04]
 [-0.09  0.27  0.29  0.25 -0.05]
 [ 0.02 -0.06  0.33 -0.09  0.01]
 [-0.01  0.04 -0.12  0.05 -0.01]]
[[ 0.00e+00  1.00e+00  0.00e+00 -1.06e-01 -7.03e-02]
 [ 0.00e+00  0.00e+00  2.39e-03  1.32e-03  4.16e-04]
 [ 0.00e+00  2.40e-02 -3.27e-03  2.86e-02 -1.62e-02]
 [-3.44e-03  4.18e-03  3.98e-03  3.87e-03  3.82e-03]
 [-3.76e-03 -5.55e-03  1.50e-03 -4.00e-03 -2.91e-03]]
[[-1.35e-04  1.19e-02 -2.26e-02  1.55e-02 -6.74e-03]
 [-2.95e-02  3.32e-02 -6.90e-03 -3.26e-03  1.80e-02]
 [ 1.28e-01 -5.94e-01 -3.49e-01  1.02e+00 -2.25e-01]
 [-3.38e-02  5.47e-02 -3.06e-02  1.91e-02  9.01e-03]
 [ 1.84e-03  2.59e-03 -1.25e-02  4.43e-03 -1.81e-03]]
[[ 0.00e+00  0.00e+00  0.00e+00  5.37e-03  4.99e-03]
 [ 1.00e+00  0.00e+00  9.19e-03  4.16e-04 -2.55e-02]
 [ 0.00e+00  1.38e-02 -2.97e-03 -6.38e-03 -2.02e-03]
 [-8.51e-02 -2.00e-03  2.18e-02 -3.78e-03 -1.11e-02]
 [-5.89e-02  2.66e-02 -1.32e-02  1.41e-03 -6.10e-03]]
[[-3.24e-04 -3.44e-02  1.10e-01 -6.93e-03 -8.63e-04]
 [ 2.39e-02  1.71e-02 -5.12e-01 -6.63e-02  2.06e-02]
 [-2.51e-02 -4.25e-02 -3.34e-01  6.43e-02 -1.61e-02]
 [ 1.10e-02  2.78e-02  1.00e+00 -6.64e-02  1.52e-02]
 [-7.10e-03  1.75e-02 -2.34e-01  5.00e-02 -1.12e-02]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00  1.93e-03]
 [ 0.00e+00  0.00e+00  0.00e+00 -2.28e-03 -2.71e-04]
 [ 0.00e+00  0.00e+00  4.93e-03 -1.38e-03 -3.79e-03]
 [ 0.00e+00  5.52e-06  2.81e-03  1.19e-03  5.13e-04]
 [ 1.06e-02 -4.98e-03 -2.98e-03  4.49e-03 -2.39e-04]]
[[-2.13e-03  1.56e-03  2.14e-02 -1.27e-02  2.52e-03]
 [ 5.03e-03  1.16e-02 -1.16e-01  7.24e-02 -1.54e-02]
 [-8.85e-02  1.30e+00 -2.30e+00  1.20e+00 -5.31e-02]
 [ 6.82e-03  4.30e-03 -1.10e-01  7.59e-02 -1.90e-02]
 [-2.59e-03  4.64e-03  1.77e-02 -1.28e-02  3.63e-03]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  3.24e-03]
 [ 0.00e+00  1.00e+00  0.00e+00 -2.35e-03  5.20e-03]
 [ 0.00e+00  0.00e+00  1.63e-03  1.36e-03 -3.39e-03]
 [ 0.00e+00 -2.14e-03 -5.95e-04  3.84e-03 -2.59e-03]
 [-9.22e-04 -4.32e-03 -2.46e-03  2.45e-03  6.58e-03]]
[[ 0.02 -0.09  0.06  0.02  0.  ]
 [-0.09  0.59 -0.25 -0.27  0.02]
 [ 0.04 -0.2   0.35 -0.26  0.06]
 [ 0.04 -0.35 -0.18  0.59 -0.09]
 [-0.    0.04  0.04 -0.09  0.01]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  4.21e-02]
 [ 0.00e+00  0.00e+00  0.00e+00 -1.46e-03 -6.33e-04]
 [ 1.00e+00  0.00e+00  5.17e-03  8.95e-04 -3.83e-03]
 [ 0.00e+00 -2.30e-04  3.36e-03  5.10e-04  1.37e-03]
 [ 8.17e-03 -1.95e-03 -5.27e-03 -2.49e-04  1.63e-03]]
[[ 2.02e-03 -1.41e-02 -4.95e-02 -1.52e-02  1.63e-03]
 [-1.36e-02  7.97e-02  1.16e+00  8.24e-02 -1.12e-02]
 [ 6.61e-02 -3.01e-01 -1.97e+00 -3.09e-01  6.43e-02]
 [-1.51e-02  8.18e-02  1.16e+00  9.11e-02 -1.58e-02]
 [ 2.82e-03 -1.47e-02 -4.90e-02 -1.75e-02  3.22e-03]]
SymNet parameters
[[ 1.84e-01 -2.12e-05 -1.11e-02  5.38e-03 -9.89e-04 -2.52e-04  1.54e-02  2.64e-03
   1.28e-02 -1.06e-04  1.26e-04 -2.36e-04]
 [-6.99e-01 -1.44e+00 -1.64e-01 -4.16e-01  1.02e-01  2.85e-02  2.78e-01 -1.55e-01
  -2.65e-01  2.60e-02 -1.06e-02  1.74e-02]]
SymNet parameters
[-0.32 -0.43]
SymNet parameters
[[ 2.08e-02  3.39e-02 -1.92e-03 -2.40e-02  4.06e-03  2.37e-03  1.22e+00 -9.77e-02
  -2.71e-02 -2.92e-05  2.13e-03  2.51e-03 -1.95e-02]
 [-2.07e-02 -7.65e-03  6.87e-02  1.02e-03 -5.87e-03 -4.14e-04  4.66e-03  1.09e-03
  -3.76e-03 -5.23e-04  2.54e-05 -4.07e-04  6.89e-03]]
SymNet parameters
[ 0.02 -1.34]
SymNet parameters
[[-5.43e-01 -2.88e-01  1.04e+00 -5.33e-02  1.88e-02 -1.30e-04 -2.82e-01  7.45e-03
  -8.29e-02  2.37e-03 -1.42e-03  2.33e-03  7.83e-02 -2.50e-01]
 [-8.43e-02  7.58e-02  4.39e-02 -9.88e-03 -1.03e-03 -2.58e-03  2.52e+00  3.94e-02
  -9.95e-02 -3.22e-03 -2.19e-03 -3.09e-03 -1.96e-02 -1.70e-01]]
SymNet parameters
[ 0.45 -0.38]
SymNet parameters
[[-4.57e+00 -9.12e-01  6.86e-01 -1.30e-01  2.95e-02  1.00e-02 -1.63e-01  1.90e-02
  -2.16e-01  4.63e-03 -2.77e-03  4.14e-03 -2.38e-01 -5.03e-01 -2.18e-02]
 [ 4.76e+00 -1.83e-01 -3.14e-01  2.96e-01 -2.96e-02  8.16e-03 -1.18e+00  1.17e-01
   9.41e-01  1.55e-03  3.65e-03 -5.47e-03  5.46e-01  2.22e-01 -5.65e-02]]
SymNet parameters
[ 0.04 -0.02]
SymNet parameters
[[-1.35e+00 -7.27e-01  3.54e-01  7.19e-02 -2.63e-02 -1.28e-02 -2.42e+00  2.19e-01
  -1.61e-01 -8.37e-03 -2.83e-03 -8.04e-03 -6.59e-02 -1.64e+00  3.82e-02 -7.54e-04]
 [-1.74e+00  8.59e-02  3.46e-02 -3.29e-03 -3.52e-03 -1.68e-03  3.99e-02 -2.09e-02
  -5.02e-02 -6.74e-04  1.25e-03  1.67e-04 -2.46e-01  1.26e-01  1.59e-02  1.53e-03]]
SymNet parameters
[ 0.07 -0.72]
SymNet parameters
[[ 0.25 -0.68 -0.42 -0.24  0.08  0.07  0.01 -0.06 -0.07  0.02 -0.01  0.01  2.29 -0.31
  -0.36 -0.08 -0.63]]
SymNet parameters
[-0.43]
SymNet parameters
[[-6.20e-01 -1.03e-03  3.74e-02  6.63e-04  7.04e-04  9.12e-04  1.53e-02  1.03e-03
   8.36e-03  7.33e-05  1.08e-03 -3.02e-04]
 [ 1.42e-02  4.93e-03 -1.88e-03 -2.89e-03 -3.54e-03 -5.41e-04 -4.15e-02  8.74e-01
  -1.12e-02  1.01e-03 -5.40e-02  6.16e-03]]
SymNet parameters
[-1.16  1.3 ]
SymNet parameters
[[-3.16e-02 -1.90e-02  7.57e-04 -1.91e-03  1.00e-03  3.03e-05  7.72e-01  7.29e-02
   4.45e-02  3.20e-03 -2.87e-03  2.69e-02  7.16e-02]
 [-1.74e+00  1.12e-01  9.24e-02 -5.47e-02  6.33e-02  5.25e-03  3.65e-01  6.26e-01
   3.39e+00  1.17e-01 -6.34e-03  9.56e-01  6.54e-01]]
SymNet parameters
[ 0.66 -0.42]
SymNet parameters
[[-2.80e+00  5.29e-02 -3.37e-02 -2.31e-02  1.22e-02  3.27e-03  2.99e-01  1.50e+00
   8.07e-01  6.71e-02 -5.48e-02  3.21e-01  1.14e+00  1.36e-01]
 [-2.84e-01  7.32e-02 -2.56e-02 -1.38e-01  3.69e-02  7.59e-03  1.63e+00 -5.43e+00
   3.74e+00  3.13e-01 -3.79e-01  1.43e+00  5.18e+00  5.90e-01]]
SymNet parameters
[-0.16 -0.29]
SymNet parameters
[[-1.74e-01  5.99e-02 -7.06e-03 -5.10e-02  2.49e-02  6.64e-03  5.56e-01  2.84e+00
   1.66e+00  1.26e-01 -9.91e-02  6.09e-01  2.17e+00  2.65e-01  1.15e-04]
 [-3.44e+00 -2.13e-01 -4.32e-02 -3.02e-02  2.08e-03 -5.16e-04  6.11e-01 -1.55e+00
   1.63e+00  7.86e-02 -1.07e-01  3.52e-01  1.45e+00  1.81e-01 -1.90e-04]]
SymNet parameters
[ 0.45 -0.62]
SymNet parameters
[[-8.72e-01  1.14e-01  3.20e-02 -4.44e-02  4.44e-02  3.38e-03  2.24e-01  1.10e+00
  -3.99e-01  9.00e-02 -5.15e-02  7.42e-01  1.21e+00  4.12e-03  1.20e-02 -2.24e-02]
 [ 8.54e-02 -1.26e-02 -1.32e-03  5.84e-03 -4.68e-03 -4.12e-04 -1.65e+00 -1.68e-01
  -2.26e-01 -1.10e-02  6.72e-03 -7.47e-02 -1.52e-01  9.73e-03  1.87e-04 -1.28e-03]]
SymNet parameters
[0.67 0.48]
SymNet parameters
[[-1.22e-01  1.53e-02  8.89e-03 -1.74e-02  1.66e-02  6.46e-04  1.22e-01  6.96e-01
   7.07e-01  8.66e-02 -2.43e-02  3.35e-01  5.84e-01 -3.41e-01 -2.33e-02  4.28e-02
  -2.07e-01]]
SymNet parameters
[0.46]
finally, finish this stage
iter:     0    time: 1063.11
Func: 1.73e-01  |g|: 1.79e+01
stableloss: 3.54e-02   dataloss: 1.53e-01   sparseloss: 1.20e+02 momentloss: 6.66e+00
current expression:
[u00*u01, u10*v00, u20, u02, u00, u00*u01**2, u00*u11*v00, u10*v00*v10, u00*u10*v01, u01*u10*v00, u00*u01*v00, u00**3, u00*v01, u00*u10, u00**2*v01, u00**2*v00, u20*v00, u00**2*v10, u10*v00**2, u01]
[-0.98 -0.98  0.05  0.05  0.02  0.01  0.01  0.01  0.01  0.01  0.01 -0.    0.    0.
 -0.   -0.    0.   -0.    0.    0.  ]
[v00*v10, u00*v01, v02, v20, v00*v10**2, u00*u01*v01, u00*v00*v11, u10*v00*v01, u00*v01*v10, v00**2*v10, u00*v00*v10, u01*v00*v10, v10, v01, v00*v20, v00**2*v10**2, 1, u00**2*v00*v01, v01*v10, v00**2*v01]
[-0.98 -0.97  0.05  0.05  0.02  0.01  0.01  0.01  0.01  0.01 -0.01 -0.   -0.    0.
  0.   -0.   -0.    0.   -0.    0.  ]
block:  4
name:  burgers-2-upwind-sparse0-noise0.001-id1
device:  cuda:1
generate a random number to check random seed:  -0.1305450260203233
current stage is: block-4
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.8548, device='cuda:1', dtype=torch.float64)
u_obs variance
tensor([ 0.2549,  1.6867,  1.6023, 21.2749,  9.8314, 18.6194,  0.2242,  1.4954,
         1.6000, 17.1528, 10.1487, 20.7266], device='cuda:1',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 0.313982
         Iterations: 0
         Function evaluations: 15
         Gradient evaluations: 3
convolution moment and kernels
[[ 1.00e+00  0.00e+00  1.51e-04  2.52e-02 -7.87e-02]
 [ 0.00e+00 -1.57e-05 -4.95e-04  5.13e-04  7.26e-03]
 [ 4.49e-04  1.09e-04  5.66e-03 -7.37e-03 -1.12e-03]
 [-4.63e-03 -7.54e-04  6.61e-03  1.41e-04 -1.95e-02]
 [-5.33e-02  1.08e-02  1.11e-03  8.25e-04  1.42e-03]]
[[ 0.01 -0.06  0.03 -0.05  0.01]
 [-0.03  0.16 -0.01  0.12 -0.04]
 [-0.09  0.27  0.29  0.25 -0.05]
 [ 0.02 -0.06  0.33 -0.09  0.01]
 [-0.01  0.04 -0.12  0.05 -0.01]]
[[ 0.00e+00  1.00e+00  0.00e+00 -1.06e-01 -7.03e-02]
 [ 0.00e+00  0.00e+00  2.38e-03  1.32e-03  4.18e-04]
 [ 0.00e+00  2.40e-02 -3.27e-03  2.86e-02 -1.62e-02]
 [-3.44e-03  4.18e-03  3.98e-03  3.87e-03  3.82e-03]
 [-3.75e-03 -5.55e-03  1.49e-03 -4.00e-03 -2.91e-03]]
[[-1.34e-04  1.19e-02 -2.26e-02  1.55e-02 -6.73e-03]
 [-2.95e-02  3.32e-02 -7.00e-03 -3.20e-03  1.80e-02]
 [ 1.28e-01 -5.94e-01 -3.49e-01  1.02e+00 -2.25e-01]
 [-3.38e-02  5.48e-02 -3.06e-02  1.91e-02  9.00e-03]
 [ 1.84e-03  2.59e-03 -1.25e-02  4.42e-03 -1.81e-03]]
[[ 0.00e+00  0.00e+00  0.00e+00  5.37e-03  4.99e-03]
 [ 1.00e+00  0.00e+00  9.19e-03  4.18e-04 -2.55e-02]
 [ 0.00e+00  1.38e-02 -2.97e-03 -6.38e-03 -2.02e-03]
 [-8.51e-02 -2.00e-03  2.18e-02 -3.78e-03 -1.11e-02]
 [-5.89e-02  2.66e-02 -1.32e-02  1.41e-03 -6.10e-03]]
[[-3.22e-04 -3.44e-02  1.10e-01 -6.96e-03 -8.57e-04]
 [ 2.38e-02  1.72e-02 -5.12e-01 -6.62e-02  2.06e-02]
 [-2.51e-02 -4.26e-02 -3.33e-01  6.42e-02 -1.61e-02]
 [ 1.10e-02  2.78e-02  1.00e+00 -6.64e-02  1.52e-02]
 [-7.10e-03  1.75e-02 -2.34e-01  5.00e-02 -1.11e-02]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00  1.93e-03]
 [ 0.00e+00  0.00e+00  0.00e+00 -2.28e-03 -2.71e-04]
 [ 0.00e+00  0.00e+00  4.94e-03 -1.38e-03 -3.79e-03]
 [ 0.00e+00  5.44e-06  2.81e-03  1.19e-03  5.12e-04]
 [ 1.06e-02 -4.98e-03 -2.98e-03  4.49e-03 -2.39e-04]]
[[-2.13e-03  1.56e-03  2.14e-02 -1.27e-02  2.53e-03]
 [ 5.03e-03  1.17e-02 -1.16e-01  7.24e-02 -1.54e-02]
 [-8.85e-02  1.30e+00 -2.30e+00  1.20e+00 -5.31e-02]
 [ 6.81e-03  4.31e-03 -1.10e-01  7.59e-02 -1.90e-02]
 [-2.59e-03  4.64e-03  1.77e-02 -1.28e-02  3.63e-03]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  3.24e-03]
 [ 0.00e+00  1.00e+00  0.00e+00 -2.35e-03  5.20e-03]
 [ 0.00e+00  0.00e+00  1.63e-03  1.36e-03 -3.39e-03]
 [ 0.00e+00 -2.14e-03 -5.95e-04  3.84e-03 -2.59e-03]
 [-9.21e-04 -4.32e-03 -2.46e-03  2.46e-03  6.58e-03]]
[[ 0.02 -0.09  0.06  0.02  0.  ]
 [-0.09  0.59 -0.25 -0.27  0.02]
 [ 0.04 -0.2   0.35 -0.26  0.06]
 [ 0.04 -0.35 -0.18  0.59 -0.09]
 [-0.    0.04  0.04 -0.09  0.01]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  4.21e-02]
 [ 0.00e+00  0.00e+00  0.00e+00 -1.46e-03 -6.33e-04]
 [ 1.00e+00  0.00e+00  5.17e-03  8.95e-04 -3.83e-03]
 [ 0.00e+00 -2.30e-04  3.36e-03  5.10e-04  1.37e-03]
 [ 8.17e-03 -1.95e-03 -5.27e-03 -2.49e-04  1.63e-03]]
[[ 2.02e-03 -1.42e-02 -4.95e-02 -1.52e-02  1.63e-03]
 [-1.36e-02  7.97e-02  1.16e+00  8.25e-02 -1.12e-02]
 [ 6.61e-02 -3.01e-01 -1.97e+00 -3.09e-01  6.43e-02]
 [-1.51e-02  8.18e-02  1.16e+00  9.11e-02 -1.58e-02]
 [ 2.82e-03 -1.47e-02 -4.90e-02 -1.75e-02  3.22e-03]]
SymNet parameters
[[ 1.84e-01 -4.88e-05 -1.11e-02  5.55e-03 -1.00e-03 -1.47e-04  1.54e-02  2.65e-03
   1.27e-02 -1.02e-04  1.36e-04 -2.80e-04]
 [-6.99e-01 -1.44e+00 -1.64e-01 -4.16e-01  1.02e-01  2.85e-02  2.78e-01 -1.55e-01
  -2.65e-01  2.60e-02 -1.07e-02  1.74e-02]]
SymNet parameters
[-0.32 -0.43]
SymNet parameters
[[ 2.08e-02  3.39e-02 -1.93e-03 -2.41e-02  4.07e-03  2.28e-03  1.22e+00 -9.77e-02
  -2.71e-02 -1.98e-05  2.11e-03  2.54e-03 -1.95e-02]
 [-2.07e-02 -7.67e-03  6.87e-02  1.06e-03 -5.89e-03 -4.48e-04  4.65e-03  1.09e-03
  -3.75e-03 -5.41e-04  4.89e-05 -4.37e-04  6.88e-03]]
SymNet parameters
[ 0.02 -1.34]
SymNet parameters
[[-5.43e-01 -2.88e-01  1.04e+00 -5.33e-02  1.88e-02 -1.75e-04 -2.82e-01  7.46e-03
  -8.29e-02  2.35e-03 -1.41e-03  2.32e-03  7.83e-02 -2.50e-01]
 [-8.43e-02  7.58e-02  4.39e-02 -9.88e-03 -1.03e-03 -2.58e-03  2.52e+00  3.94e-02
  -9.95e-02 -3.22e-03 -2.19e-03 -3.09e-03 -1.96e-02 -1.70e-01]]
SymNet parameters
[ 0.45 -0.38]
SymNet parameters
[[-4.57e+00 -9.12e-01  6.86e-01 -1.30e-01  2.95e-02  1.00e-02 -1.63e-01  1.90e-02
  -2.16e-01  4.63e-03 -2.77e-03  4.14e-03 -2.38e-01 -5.03e-01 -2.18e-02]
 [ 4.76e+00 -1.83e-01 -3.14e-01  2.96e-01 -2.96e-02  8.16e-03 -1.18e+00  1.17e-01
   9.41e-01  1.55e-03  3.65e-03 -5.47e-03  5.46e-01  2.22e-01 -5.65e-02]]
SymNet parameters
[ 0.04 -0.02]
SymNet parameters
[[-1.35e+00 -7.27e-01  3.54e-01  7.19e-02 -2.63e-02 -1.28e-02 -2.42e+00  2.19e-01
  -1.61e-01 -8.36e-03 -2.84e-03 -8.03e-03 -6.59e-02 -1.64e+00  3.82e-02 -9.05e-04]
 [-1.74e+00  8.59e-02  3.46e-02 -3.29e-03 -3.52e-03 -1.69e-03  3.99e-02 -2.09e-02
  -5.02e-02 -6.84e-04  1.25e-03  1.67e-04 -2.46e-01  1.26e-01  1.59e-02  1.41e-03]]
SymNet parameters
[ 0.07 -0.72]
SymNet parameters
[[ 0.25 -0.68 -0.42 -0.24  0.08  0.07  0.01 -0.06 -0.07  0.02 -0.01  0.01  2.29 -0.31
  -0.36 -0.08 -0.63]]
SymNet parameters
[-0.43]
SymNet parameters
[[-6.20e-01 -1.03e-03  3.74e-02  6.62e-04  7.05e-04  9.11e-04  1.53e-02  1.03e-03
   8.35e-03  7.22e-05  1.08e-03 -3.04e-04]
 [ 1.42e-02  4.93e-03 -1.88e-03 -2.89e-03 -3.54e-03 -5.41e-04 -4.15e-02  8.74e-01
  -1.12e-02  1.02e-03 -5.40e-02  6.16e-03]]
SymNet parameters
[-1.16  1.3 ]
SymNet parameters
[[-3.16e-02 -1.90e-02  7.54e-04 -1.91e-03  9.96e-04  3.67e-05  7.72e-01  7.29e-02
   4.45e-02  3.18e-03 -2.85e-03  2.69e-02  7.16e-02]
 [-1.74e+00  1.12e-01  9.24e-02 -5.47e-02  6.33e-02  5.25e-03  3.65e-01  6.26e-01
   3.39e+00  1.17e-01 -6.34e-03  9.56e-01  6.54e-01]]
SymNet parameters
[ 0.66 -0.42]
SymNet parameters
[[-2.80e+00  5.29e-02 -3.37e-02 -2.31e-02  1.22e-02  3.27e-03  2.99e-01  1.50e+00
   8.07e-01  6.71e-02 -5.48e-02  3.21e-01  1.14e+00  1.36e-01]
 [-2.84e-01  7.32e-02 -2.56e-02 -1.38e-01  3.69e-02  7.59e-03  1.63e+00 -5.43e+00
   3.74e+00  3.13e-01 -3.79e-01  1.43e+00  5.18e+00  5.90e-01]]
SymNet parameters
[-0.16 -0.29]
SymNet parameters
[[-1.74e-01  5.99e-02 -7.06e-03 -5.10e-02  2.49e-02  6.64e-03  5.56e-01  2.84e+00
   1.66e+00  1.26e-01 -9.91e-02  6.09e-01  2.17e+00  2.65e-01 -3.77e-04]
 [-3.44e+00 -2.13e-01 -4.32e-02 -3.02e-02  2.08e-03 -5.17e-04  6.11e-01 -1.55e+00
   1.63e+00  7.86e-02 -1.07e-01  3.52e-01  1.45e+00  1.81e-01 -5.21e-04]]
SymNet parameters
[ 0.45 -0.62]
SymNet parameters
[[-8.72e-01  1.14e-01  3.20e-02 -4.44e-02  4.44e-02  3.38e-03  2.24e-01  1.10e+00
  -3.99e-01  9.00e-02 -5.15e-02  7.42e-01  1.21e+00  4.13e-03  1.21e-02 -2.24e-02]
 [ 8.54e-02 -1.26e-02 -1.32e-03  5.84e-03 -4.68e-03 -4.10e-04 -1.65e+00 -1.68e-01
  -2.26e-01 -1.10e-02  6.72e-03 -7.47e-02 -1.52e-01  9.72e-03  6.53e-04 -1.10e-03]]
SymNet parameters
[0.67 0.48]
SymNet parameters
[[-1.22e-01  1.52e-02  8.89e-03 -1.74e-02  1.66e-02  6.46e-04  1.22e-01  6.96e-01
   7.07e-01  8.66e-02 -2.43e-02  3.35e-01  5.84e-01 -3.41e-01 -2.28e-02  4.30e-02
  -2.07e-01]]
SymNet parameters
[0.46]
finally, finish this stage
iter:     0    time: 64.97
Func: 3.14e-01  |g|: 5.87e+01
stableloss: 4.10e-02   dataloss: 2.87e-01   sparseloss: 1.20e+02 momentloss: 6.66e+00
current expression:
[u00*u01, u10*v00, u20, u02, u00, u00*u01**2, u00*u11*v00, u10*v00*v10, u00*u10*v01, u01*u10*v00, u00*u01*v00, u00**3, u00*v01, u00*u10, u00**2*v01, u00**2*v00, u20*v00, u00**2*v10, u10*v00**2, u01]
[-0.98 -0.98  0.05  0.05  0.02  0.01  0.01  0.01  0.01  0.01  0.01 -0.    0.    0.
 -0.   -0.    0.   -0.    0.    0.  ]
[v00*v10, u00*v01, v02, v20, v00*v10**2, u00*u01*v01, u00*v00*v11, u10*v00*v01, u00*v01*v10, v00**2*v10, u00*v00*v10, u01*v00*v10, v10, v01, v00*v20, v00**2*v10**2, 1, u00**2*v00*v01, v01*v10, v00**2*v01]
[-0.98 -0.97  0.05  0.05  0.02  0.01  0.01  0.01  0.01  0.01 -0.01 -0.   -0.    0.
  0.   -0.   -0.    0.   -0.    0.  ]
block:  5
name:  burgers-2-upwind-sparse0-noise0.001-id1
device:  cuda:1
generate a random number to check random seed:  1.2687885664749432
current stage is: block-5
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.9944, device='cuda:1', dtype=torch.float64)
u_obs variance
tensor([ 0.2779,  1.8379,  1.8044, 22.8598, 11.2646, 20.3268,  0.2497,  1.5763,
         1.7853, 18.0454, 10.4318, 22.8566], device='cuda:1',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
iter:     0    time: 63.63
Func: 5.76e-01  |g|: 1.23e+02
stableloss: 5.55e-02   dataloss: 5.43e-01   sparseloss: 1.20e+02 momentloss: 6.66e+00
iter:   200    time: 28.30
Func: 3.13e-01  |g|: 3.87e+00
stableloss: 5.30e-02   dataloss: 2.75e-01   sparseloss: 1.17e+02 momentloss: 7.69e+00
iter:   400    time: 34.00
Func: 3.04e-01  |g|: 1.94e+00
stableloss: 5.22e-02   dataloss: 2.67e-01   sparseloss: 1.12e+02 momentloss: 7.41e+00
iter:   600    time: 37.35
Func: 2.99e-01  |g|: 5.26e-01
stableloss: 5.23e-02   dataloss: 2.63e-01   sparseloss: 1.15e+02 momentloss: 7.26e+00
iter:   800    time: 34.85
Func: 2.97e-01  |g|: 4.25e-01
stableloss: 5.33e-02   dataloss: 2.60e-01   sparseloss: 1.22e+02 momentloss: 7.37e+00
iter:  1000    time: 27.02
Func: 2.96e-01  |g|: 2.15e-01
stableloss: 5.34e-02   dataloss: 2.59e-01   sparseloss: 1.23e+02 momentloss: 7.42e+00
iter:  1200    time: 27.14
Func: 2.96e-01  |g|: 1.78e-01
stableloss: 5.33e-02   dataloss: 2.59e-01   sparseloss: 1.26e+02 momentloss: 7.45e+00
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 0.296152
         Iterations: 1245
         Function evaluations: 1321
         Gradient evaluations: 1302
convolution moment and kernels
[[ 1.00e+00  0.00e+00  4.03e-04 -1.16e-02 -9.81e-02]
 [ 0.00e+00  8.81e-04 -2.53e-02  3.39e-03 -5.65e-02]
 [ 9.41e-04  2.87e-03  3.88e-02  6.03e-03  1.29e-03]
 [ 4.31e-02 -1.84e-03  2.36e-02 -2.18e-02 -3.40e-03]
 [-8.56e-02 -4.46e-04 -3.15e-03  1.48e-02  5.85e-03]]
[[-0.01 -0.01 -0.04 -0.06  0.02]
 [ 0.04  0.01  0.2   0.17 -0.03]
 [-0.09  0.18  0.38  0.04 -0.02]
 [-0.04  0.22 -0.09  0.29 -0.07]
 [ 0.01 -0.02 -0.03 -0.03  0.01]]
[[ 0.    1.    0.   -0.07 -0.05]
 [ 0.    0.    0.   -0.    0.  ]
 [ 0.    0.03  0.03  0.05 -0.  ]
 [ 0.01 -0.    0.01 -0.01  0.02]
 [ 0.   -0.01  0.02 -0.01  0.  ]]
[[-0.01  0.05 -0.08  0.04 -0.01]
 [-0.03 -0.05  0.13 -0.09  0.04]
 [ 0.15 -0.61 -0.27  0.95 -0.2 ]
 [-0.07  0.08 -0.07  0.03  0.01]
 [ 0.02 -0.02  0.02 -0.02  0.01]]
[[ 0.00e+00  0.00e+00  0.00e+00  8.30e-03  6.56e-03]
 [ 1.00e+00  0.00e+00  2.44e-02  4.97e-04 -5.58e-03]
 [ 0.00e+00  1.80e-02 -3.87e-02  3.95e-02 -6.08e-03]
 [-7.24e-02  1.14e-03  1.71e-02  7.12e-03 -1.25e-02]
 [-9.66e-02  1.12e-02 -6.44e-02  2.40e-02 -1.98e-02]]
[[-1.57e-02 -2.51e-02  1.11e-01 -4.71e-02 -8.28e-05]
 [ 6.17e-02  2.84e-03 -4.95e-01  4.92e-02  2.86e-02]
 [-9.79e-02  4.11e-02 -4.39e-01 -3.56e-02 -4.83e-02]
 [ 8.61e-02 -8.17e-02  1.09e+00 -1.12e-02  3.98e-02]
 [-3.18e-02  4.49e-02 -2.30e-01  1.03e-02 -9.32e-03]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00 -5.33e-02]
 [ 0.00e+00  0.00e+00  0.00e+00  1.42e-03  1.50e-02]
 [ 0.00e+00  0.00e+00  7.60e-03  7.55e-03 -3.49e-03]
 [ 0.00e+00 -7.50e-04 -4.67e-04 -4.23e-03 -7.98e-02]
 [ 9.61e-02  3.48e-03  3.76e-03 -3.94e-03  5.71e-03]]
[[ 4.84e-02 -1.89e-01  3.71e-01 -1.79e-01  4.54e-02]
 [-1.28e-01  4.92e-01 -1.07e+00  4.32e-01 -1.05e-01]
 [-7.10e-02  1.32e+00 -1.99e+00  1.44e+00 -1.17e-01]
 [ 4.61e-02 -2.15e-01  6.43e-04 -2.95e-01  7.93e-02]
 [-3.17e-02  1.36e-01 -1.22e-01  1.53e-01 -3.91e-02]]
[[ 0.    0.    0.    0.   -0.01]
 [ 0.    1.    0.   -0.01 -0.02]
 [ 0.    0.   -0.   -0.    0.  ]
 [ 0.   -0.   -0.    0.06  0.05]
 [ 0.    0.    0.   -0.01 -0.01]]
[[-0.01  0.06 -0.23  0.25 -0.06]
 [ 0.    0.11  0.66 -1.    0.21]
 [-0.05  0.25 -0.46  0.38 -0.1 ]
 [ 0.05 -0.39 -0.12  0.54 -0.09]
 [ 0.    0.    0.11 -0.15  0.04]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  4.65e-02]
 [ 0.00e+00  0.00e+00  0.00e+00  3.02e-04 -3.32e-03]
 [ 1.00e+00  0.00e+00  6.33e-03  6.84e-03 -3.79e-03]
 [ 0.00e+00 -4.21e-04 -7.87e-03 -2.93e-03  1.99e-02]
 [ 2.77e-03  2.73e-03  2.02e-02 -3.91e-03 -9.29e-03]]
[[-1.94e-02  1.03e-01 -2.55e-01  1.13e-01 -2.29e-02]
 [ 4.92e-02 -2.95e-01  1.85e+00 -3.53e-01  7.27e-02]
 [ 1.31e-02  8.83e-02 -2.75e+00  1.91e-01 -3.02e-02]
 [ 5.11e-04 -9.10e-02  1.54e+00 -1.61e-01  3.01e-02]
 [ 3.15e-03  8.27e-03 -1.12e-01  2.36e-02 -3.23e-03]]
SymNet parameters
[[ 1.11e-01 -2.79e-03 -3.36e-03  1.64e-03 -6.14e-05 -3.18e-06  1.92e-02 -5.34e-04
   4.00e-03  1.09e-04  1.56e-04 -2.18e-06]
 [ 1.32e+00 -1.98e+00 -3.56e-01 -4.40e-01 -1.51e-02 -4.35e-02 -2.87e-01  1.46e-01
   4.87e-04 -5.37e-03 -3.05e-02  1.32e-02]]
SymNet parameters
[-0.5  -0.13]
SymNet parameters
[[-6.75e-03  1.34e-02  7.80e-03  7.97e-03  6.21e-04  2.68e-03  1.66e+00 -6.15e-02
   1.12e-02 -1.60e-03  6.32e-04 -2.79e-03 -2.61e-02]
 [ 2.52e-02 -2.10e-02  1.93e-01 -5.52e-03 -7.00e-03 -4.77e-04 -4.73e-03  1.97e-03
  -6.57e-03 -1.79e-04 -4.15e-04 -2.64e-05  2.25e-02]]
SymNet parameters
[-0.7  -1.07]
SymNet parameters
[[ 1.99e-01 -2.07e-01  9.23e-01 -4.96e-02  1.43e-02 -4.75e-03 -9.16e-03  1.75e-02
  -3.27e-02 -9.88e-04 -3.11e-03  1.84e-03  1.00e-01  2.00e-02]
 [-6.79e-02  7.35e-02  3.15e-02  4.09e-02  1.75e-04  2.43e-03  2.88e+00  3.14e-02
   1.57e-02 -2.35e-03  4.13e-03 -4.15e-03 -4.51e-02  1.08e-03]]
SymNet parameters
[0.87 0.37]
SymNet parameters
[[-2.98e+00 -2.42e+00 -7.72e-01  8.21e-02  2.70e-02  3.69e-02 -4.04e+00  1.56e-01
  -1.29e-01  9.59e-03  1.24e-02 -2.10e-02 -3.00e-01 -3.55e+00  1.71e-01]
 [ 4.71e+00 -7.44e-01  1.54e-01  5.71e-02 -1.64e-02 -2.89e-04 -2.99e-01 -4.19e-02
   6.01e-01  4.51e-03  3.07e-03  3.17e-03  6.72e-01 -4.21e-01 -1.06e-02]]
SymNet parameters
[1.31 0.76]
SymNet parameters
[[-1.11e+00 -1.44e+00 -2.38e-01  1.41e-01  1.59e-02  1.83e-02 -2.75e+00  5.35e-02
  -9.32e-02  4.50e-03  1.10e-02 -5.57e-03 -7.09e-02 -1.78e+00  1.52e-01  3.08e-04]
 [-1.21e+00  1.19e-01 -1.98e-02  8.75e-03  1.58e-03  2.18e-03  6.12e-02 -1.85e-03
  -4.73e-02 -2.65e-05  5.26e-04 -6.48e-04 -1.25e-01  7.22e-02  4.37e-03 -2.44e-04]]
SymNet parameters
[ 0.77 -0.92]
SymNet parameters
[[ 1.86e+00 -1.13e+00 -2.56e-01 -4.22e-01 -1.59e-02  6.45e-04  3.70e-02  1.79e-01
   2.46e-02 -5.83e-03 -3.27e-02  1.69e-02  1.85e+00 -1.06e-01 -3.23e-01 -3.28e-02
  -5.56e-01]]
SymNet parameters
[0.3]
SymNet parameters
[[-2.70e-01  8.44e-04  1.85e-02  8.60e-05 -1.42e-04  3.34e-04  8.04e-03  3.98e-04
  -1.43e-05  5.13e-04  1.93e-04 -2.11e-04]
 [ 1.39e-02 -7.70e-03  8.97e-04 -6.24e-05  5.04e-04 -8.56e-05 -3.43e-02  3.91e-01
  -4.91e-03 -2.48e-03 -2.83e-02  7.08e-04]]
SymNet parameters
[-1.04  1.2 ]
SymNet parameters
[[-1.73e-03 -5.01e-02 -3.89e-03  8.04e-04  4.73e-04  2.46e-04  8.10e-01  2.87e-02
  -6.52e-03  7.48e-03 -1.08e-03  1.76e-03  5.15e-02]
 [-1.21e+00 -1.07e-01  7.35e-02 -4.73e-04  2.32e-03  4.89e-03 -1.70e+00 -1.19e+00
   2.03e+00 -7.17e-02  8.49e-02  8.05e-03 -2.71e+00]]
SymNet parameters
[ 1.19 -2.3 ]
SymNet parameters
[[-5.77e+00  4.86e-03 -8.82e-02  8.51e-03  1.31e-04  6.72e-03  1.85e-01  1.13e-01
   8.82e-03  3.19e-02 -6.37e-03  2.10e-03  1.51e-01  7.84e-03]
 [ 7.08e-01 -9.99e-02 -2.65e-01  1.98e-01  2.79e-02 -8.75e-02  6.21e+00 -4.60e+00
  -7.43e-01  4.90e+00 -3.49e-02  5.95e-01 -2.70e-01  1.01e+00]]
SymNet parameters
[-0.63 -0.78]
SymNet parameters
[[ 1.61e-01 -6.46e-02 -5.83e-02  4.12e-02  5.75e-03 -1.79e-02  1.07e+00  1.59e+00
  -1.14e-01  1.01e+00  1.75e-02  1.24e-01  2.50e-02  2.16e-01  4.02e-04]
 [-7.42e+00  4.44e-02 -9.54e-02  1.13e-02 -2.04e-03  6.22e-03 -4.74e-02 -1.09e-01
   5.38e-02  3.25e-02  3.32e-03  4.05e-03 -1.64e-01  1.81e-02 -1.05e-05]]
SymNet parameters
[-0.75  0.8 ]
SymNet parameters
[[ 6.85e-03  8.82e-02 -8.05e-03  4.93e-04  2.28e-03 -8.03e-04 -1.56e+00  3.89e-01
  -1.44e+00 -1.28e-02 -3.14e-02  1.25e-02  1.20e+00  1.64e-02  5.31e-03 -2.02e-02]
 [ 8.87e-02 -9.18e-02 -7.82e-03  7.42e-04  8.33e-04  7.09e-04 -1.17e+00  6.37e-02
  -6.26e-02  1.52e-02 -4.11e-03  3.48e-03  1.53e-01  1.77e-02  2.78e-04 -1.16e-03]]
SymNet parameters
[ 0.91 -0.63]
SymNet parameters
[[-2.90e-01 -6.67e-02  6.28e-03 -4.03e-03 -2.83e-05  3.23e-03 -1.52e-02 -4.64e-02
   1.07e+00 -7.63e-02  2.10e-03  3.98e-02 -7.89e-03 -3.58e-01 -1.31e-02  5.08e-02
  -2.55e-01]]
SymNet parameters
[0.55]
finally, finish this stage
iter:  1245    time: 12.50
Func: 2.96e-01  |g|: 1.92e-01
stableloss: 5.33e-02   dataloss: 2.59e-01   sparseloss: 1.27e+02 momentloss: 7.44e+00
current expression:
[u00*u01, u10*v00, u20, u02, u00, u00*u01**2, u01*u10*v00, u10*v00*v10, u00*u11*v00, u00*u10*v01, u01*u10, u00**3, 1, u00**2, u01*v00**2, u10*v10, u00**2*u02, u00*v00**2, u10, v00**2]
[-0.99 -0.99  0.05  0.05  0.01  0.01  0.01  0.01  0.01  0.01 -0.   -0.   -0.    0.
  0.   -0.    0.   -0.    0.    0.  ]
[u00*v01, v00*v10, v20, v02, v00, v00*v10**2, u00*u01*v01, u00*v01*v10, u00*v00*v11, u10*v00*v01, v00**3, 1, v00**2, u00**2*v02, v01, u00*v00, v10**2, u10*v01, u01, u00*v00**2*v01]
[-0.99 -0.99  0.05  0.05  0.01  0.01  0.01  0.01  0.01  0.01 -0.01 -0.01  0.    0.
  0.    0.   -0.   -0.    0.    0.  ]
block:  6
name:  burgers-2-upwind-sparse0-noise0.001-id1
device:  cuda:1
generate a random number to check random seed:  4.319667494207161
current stage is: block-6
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.8337, device='cuda:1', dtype=torch.float64)
u_obs variance
tensor([ 0.2472,  1.5189,  1.6144, 20.7739, 10.0929, 19.0386,  0.2666,  1.7504,
         1.8112, 21.8204, 11.8767, 24.3917], device='cuda:1',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 0.735125
         Iterations: 0
         Function evaluations: 15
         Gradient evaluations: 3
convolution moment and kernels
[[ 1.00e+00  0.00e+00  4.03e-04 -1.16e-02 -9.81e-02]
 [ 0.00e+00  8.77e-04 -2.53e-02  3.39e-03 -5.65e-02]
 [ 9.38e-04  2.87e-03  3.88e-02  6.03e-03  1.29e-03]
 [ 4.31e-02 -1.84e-03  2.36e-02 -2.18e-02 -3.41e-03]
 [-8.56e-02 -4.50e-04 -3.15e-03  1.48e-02  5.85e-03]]
[[-0.01 -0.01 -0.04 -0.06  0.02]
 [ 0.04  0.01  0.2   0.17 -0.03]
 [-0.09  0.18  0.38  0.04 -0.02]
 [-0.04  0.22 -0.09  0.29 -0.07]
 [ 0.01 -0.02 -0.03 -0.03  0.01]]
[[ 0.    1.    0.   -0.07 -0.05]
 [ 0.    0.    0.   -0.    0.  ]
 [ 0.    0.03  0.03  0.05 -0.  ]
 [ 0.01 -0.    0.01 -0.01  0.02]
 [ 0.   -0.01  0.02 -0.01  0.  ]]
[[-0.01  0.05 -0.08  0.04 -0.01]
 [-0.03 -0.05  0.13 -0.08  0.04]
 [ 0.15 -0.61 -0.27  0.95 -0.2 ]
 [-0.07  0.08 -0.07  0.03  0.01]
 [ 0.02 -0.02  0.02 -0.02  0.01]]
[[ 0.00e+00  0.00e+00  0.00e+00  8.31e-03  6.57e-03]
 [ 1.00e+00  0.00e+00  2.44e-02  4.98e-04 -5.57e-03]
 [ 0.00e+00  1.80e-02 -3.87e-02  3.95e-02 -6.08e-03]
 [-7.24e-02  1.14e-03  1.71e-02  7.12e-03 -1.25e-02]
 [-9.66e-02  1.12e-02 -6.44e-02  2.40e-02 -1.98e-02]]
[[-1.57e-02 -2.51e-02  1.11e-01 -4.72e-02 -6.06e-05]
 [ 6.17e-02  3.09e-03 -4.96e-01  4.95e-02  2.86e-02]
 [-9.78e-02  4.08e-02 -4.38e-01 -3.61e-02 -4.81e-02]
 [ 8.60e-02 -8.16e-02  1.09e+00 -1.10e-02  3.97e-02]
 [-3.18e-02  4.49e-02 -2.30e-01  1.02e-02 -9.31e-03]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00 -5.33e-02]
 [ 0.00e+00  0.00e+00  0.00e+00  1.42e-03  1.50e-02]
 [ 0.00e+00  0.00e+00  7.60e-03  7.55e-03 -3.50e-03]
 [ 0.00e+00 -7.49e-04 -4.65e-04 -4.23e-03 -7.98e-02]
 [ 9.61e-02  3.47e-03  3.76e-03 -3.94e-03  5.71e-03]]
[[ 4.84e-02 -1.89e-01  3.71e-01 -1.79e-01  4.54e-02]
 [-1.28e-01  4.92e-01 -1.07e+00  4.32e-01 -1.05e-01]
 [-7.09e-02  1.32e+00 -1.99e+00  1.44e+00 -1.17e-01]
 [ 4.61e-02 -2.15e-01  6.27e-04 -2.95e-01  7.93e-02]
 [-3.17e-02  1.36e-01 -1.22e-01  1.53e-01 -3.91e-02]]
[[ 0.    0.    0.    0.   -0.01]
 [ 0.    1.    0.   -0.01 -0.02]
 [ 0.    0.   -0.   -0.    0.  ]
 [ 0.   -0.   -0.    0.06  0.05]
 [ 0.    0.    0.   -0.01 -0.01]]
[[-0.01  0.06 -0.23  0.25 -0.06]
 [ 0.    0.11  0.66 -1.    0.21]
 [-0.05  0.25 -0.46  0.38 -0.1 ]
 [ 0.05 -0.39 -0.12  0.54 -0.09]
 [ 0.    0.    0.11 -0.15  0.04]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  4.65e-02]
 [ 0.00e+00  0.00e+00  0.00e+00  3.02e-04 -3.31e-03]
 [ 1.00e+00  0.00e+00  6.33e-03  6.84e-03 -3.79e-03]
 [ 0.00e+00 -4.22e-04 -7.86e-03 -2.93e-03  1.99e-02]
 [ 2.78e-03  2.73e-03  2.02e-02 -3.91e-03 -9.29e-03]]
[[-1.94e-02  1.03e-01 -2.55e-01  1.13e-01 -2.29e-02]
 [ 4.92e-02 -2.95e-01  1.85e+00 -3.53e-01  7.27e-02]
 [ 1.31e-02  8.83e-02 -2.75e+00  1.91e-01 -3.02e-02]
 [ 5.13e-04 -9.10e-02  1.54e+00 -1.61e-01  3.01e-02]
 [ 3.15e-03  8.26e-03 -1.12e-01  2.36e-02 -3.23e-03]]
SymNet parameters
[[ 1.11e-01 -2.86e-03 -3.32e-03  1.80e-03 -9.99e-05 -2.87e-05  1.92e-02 -4.92e-04
   3.98e-03  7.37e-05  1.24e-04 -3.61e-05]
 [ 1.32e+00 -1.98e+00 -3.56e-01 -4.40e-01 -1.51e-02 -4.35e-02 -2.87e-01  1.46e-01
   4.77e-04 -5.36e-03 -3.05e-02  1.32e-02]]
SymNet parameters
[-0.5  -0.13]
SymNet parameters
[[-6.75e-03  1.34e-02  7.80e-03  7.97e-03  6.17e-04  2.67e-03  1.66e+00 -6.15e-02
   1.12e-02 -1.61e-03  6.22e-04 -2.78e-03 -2.61e-02]
 [ 2.52e-02 -2.10e-02  1.93e-01 -5.53e-03 -7.00e-03 -5.29e-04 -4.73e-03  1.97e-03
  -6.58e-03 -1.99e-04 -4.23e-04 -4.60e-05  2.24e-02]]
SymNet parameters
[-0.7  -1.07]
SymNet parameters
[[ 1.99e-01 -2.07e-01  9.23e-01 -4.96e-02  1.43e-02 -4.78e-03 -9.15e-03  1.75e-02
  -3.27e-02 -9.84e-04 -3.11e-03  1.84e-03  1.00e-01  2.00e-02]
 [-6.79e-02  7.35e-02  3.15e-02  4.09e-02  1.74e-04  2.43e-03  2.88e+00  3.14e-02
   1.57e-02 -2.35e-03  4.12e-03 -4.15e-03 -4.51e-02  1.08e-03]]
SymNet parameters
[0.87 0.37]
SymNet parameters
[[-2.98e+00 -2.42e+00 -7.72e-01  8.20e-02  2.70e-02  3.69e-02 -4.04e+00  1.57e-01
  -1.29e-01  9.59e-03  1.24e-02 -2.10e-02 -3.00e-01 -3.55e+00  1.71e-01]
 [ 4.71e+00 -7.44e-01  1.54e-01  5.71e-02 -1.64e-02 -2.91e-04 -2.99e-01 -4.20e-02
   6.01e-01  4.51e-03  3.07e-03  3.17e-03  6.72e-01 -4.21e-01 -1.06e-02]]
SymNet parameters
[1.31 0.76]
SymNet parameters
[[-1.11e+00 -1.44e+00 -2.38e-01  1.41e-01  1.59e-02  1.83e-02 -2.75e+00  5.35e-02
  -9.32e-02  4.50e-03  1.10e-02 -5.57e-03 -7.09e-02 -1.78e+00  1.52e-01  2.54e-04]
 [-1.21e+00  1.19e-01 -1.98e-02  8.74e-03  1.59e-03  2.17e-03  6.12e-02 -1.85e-03
  -4.73e-02 -2.52e-06  5.27e-04 -6.30e-04 -1.25e-01  7.22e-02  4.33e-03 -5.40e-04]]
SymNet parameters
[ 0.77 -0.92]
SymNet parameters
[[ 1.86e+00 -1.13e+00 -2.56e-01 -4.22e-01 -1.59e-02  6.42e-04  3.70e-02  1.79e-01
   2.46e-02 -5.83e-03 -3.27e-02  1.69e-02  1.85e+00 -1.06e-01 -3.23e-01 -3.26e-02
  -5.56e-01]]
SymNet parameters
[0.3]
SymNet parameters
[[-2.70e-01  8.45e-04  1.85e-02  1.08e-04 -1.36e-04  3.47e-04  8.06e-03  4.11e-04
  -1.47e-05  4.49e-04  1.86e-04 -2.21e-04]
 [ 1.39e-02 -7.70e-03  8.95e-04 -6.89e-05  4.99e-04 -8.90e-05 -3.43e-02  3.91e-01
  -4.90e-03 -2.43e-03 -2.83e-02  7.13e-04]]
SymNet parameters
[-1.04  1.2 ]
SymNet parameters
[[-1.72e-03 -5.01e-02 -3.89e-03  8.02e-04  4.78e-04  2.58e-04  8.10e-01  2.87e-02
  -6.51e-03  7.47e-03 -1.08e-03  1.76e-03  5.15e-02]
 [-1.21e+00 -1.07e-01  7.35e-02 -4.75e-04  2.32e-03  4.88e-03 -1.70e+00 -1.19e+00
   2.03e+00 -7.17e-02  8.49e-02  8.05e-03 -2.71e+00]]
SymNet parameters
[ 1.19 -2.3 ]
SymNet parameters
[[-5.76e+00  4.85e-03 -8.82e-02  8.52e-03  1.30e-04  6.72e-03  1.85e-01  1.13e-01
   8.84e-03  3.19e-02 -6.37e-03  2.10e-03  1.51e-01  7.84e-03]
 [ 7.08e-01 -9.99e-02 -2.65e-01  1.98e-01  2.79e-02 -8.75e-02  6.21e+00 -4.60e+00
  -7.43e-01  4.90e+00 -3.49e-02  5.95e-01 -2.69e-01  1.01e+00]]
SymNet parameters
[-0.63 -0.78]
SymNet parameters
[[ 1.61e-01 -6.46e-02 -5.83e-02  4.12e-02  5.76e-03 -1.79e-02  1.07e+00  1.59e+00
  -1.14e-01  1.01e+00  1.75e-02  1.24e-01  2.52e-02  2.16e-01  3.01e-04]
 [-7.42e+00  4.44e-02 -9.54e-02  1.13e-02 -2.04e-03  6.22e-03 -4.74e-02 -1.09e-01
   5.38e-02  3.25e-02  3.32e-03  4.06e-03 -1.64e-01  1.81e-02  1.27e-05]]
SymNet parameters
[-0.75  0.8 ]
SymNet parameters
[[ 6.78e-03  8.82e-02 -8.04e-03  4.97e-04  2.28e-03 -8.00e-04 -1.56e+00  3.89e-01
  -1.44e+00 -1.28e-02 -3.14e-02  1.25e-02  1.20e+00  1.64e-02  5.24e-03 -2.02e-02]
 [ 8.87e-02 -9.18e-02 -7.82e-03  7.47e-04  8.35e-04  7.02e-04 -1.17e+00  6.36e-02
  -6.26e-02  1.52e-02 -4.10e-03  3.49e-03  1.53e-01  1.76e-02  3.68e-04 -1.15e-03]]
SymNet parameters
[ 0.91 -0.63]
SymNet parameters
[[-2.90e-01 -6.67e-02  6.28e-03 -4.02e-03 -3.11e-05  3.24e-03 -1.52e-02 -4.64e-02
   1.07e+00 -7.63e-02  2.09e-03  3.98e-02 -7.90e-03 -3.58e-01 -1.30e-02  5.08e-02
  -2.55e-01]]
SymNet parameters
[0.55]
finally, finish this stage
iter:     0    time: 360.35
Func: 7.35e-01  |g|: 3.93e+01
stableloss: 5.68e-02   dataloss: 6.90e-01   sparseloss: 1.27e+02 momentloss: 7.44e+00
current expression:
[u00*u01, u10*v00, u20, u02, u00, u00*u01**2, u01*u10*v00, u10*v00*v10, u00*u11*v00, u00*u10*v01, u01*u10, u00**3, 1, u00**2, u01*v00**2, u10*v10, u00**2*u02, u00*v00**2, u10, v00**2]
[-0.99 -0.99  0.05  0.05  0.01  0.01  0.01  0.01  0.01  0.01 -0.   -0.   -0.    0.
  0.   -0.    0.   -0.    0.    0.  ]
[u00*v01, v00*v10, v20, v02, v00, v00*v10**2, u00*u01*v01, u00*v01*v10, u00*v00*v11, u10*v00*v01, v00**3, 1, v00**2, u00**2*v02, v01, u00*v00, v10**2, u10*v01, u01, u00*v00**2*v01]
[-0.99 -0.99  0.05  0.05  0.01  0.01  0.01  0.01  0.01  0.01 -0.01 -0.01  0.    0.
  0.    0.   -0.   -0.    0.    0.  ]
block:  9
name:  burgers-2-upwind-sparse0-noise0.001-id1
device:  cuda:1
generate a random number to check random seed:  -1.4580446151365443
current stage is: block-9
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.8869, device='cuda:1', dtype=torch.float64)
u_obs variance
tensor([ 0.2354,  1.6147,  1.5859, 22.9245, 10.7011, 18.6802,  0.2545,  1.7086,
         1.7746, 20.7506, 11.5166, 24.5215], device='cuda:1',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 1.459409
         Iterations: 0
         Function evaluations: 15
         Gradient evaluations: 3
convolution moment and kernels
[[ 1.00e+00  0.00e+00  4.04e-04 -1.16e-02 -9.81e-02]
 [ 0.00e+00  8.77e-04 -2.53e-02  3.39e-03 -5.65e-02]
 [ 9.37e-04  2.87e-03  3.88e-02  6.03e-03  1.29e-03]
 [ 4.31e-02 -1.84e-03  2.36e-02 -2.18e-02 -3.40e-03]
 [-8.56e-02 -4.45e-04 -3.15e-03  1.48e-02  5.85e-03]]
[[-0.01 -0.01 -0.04 -0.06  0.02]
 [ 0.04  0.01  0.2   0.17 -0.03]
 [-0.09  0.18  0.38  0.04 -0.02]
 [-0.04  0.22 -0.09  0.29 -0.07]
 [ 0.01 -0.02 -0.03 -0.03  0.01]]
[[ 0.    1.    0.   -0.07 -0.05]
 [ 0.    0.    0.   -0.    0.  ]
 [ 0.    0.03  0.03  0.05 -0.  ]
 [ 0.01 -0.    0.01 -0.01  0.02]
 [ 0.   -0.01  0.02 -0.01  0.  ]]
[[-0.01  0.05 -0.08  0.04 -0.01]
 [-0.03 -0.05  0.13 -0.09  0.04]
 [ 0.15 -0.61 -0.27  0.95 -0.2 ]
 [-0.07  0.08 -0.07  0.03  0.01]
 [ 0.02 -0.02  0.02 -0.02  0.01]]
[[ 0.00e+00  0.00e+00  0.00e+00  8.30e-03  6.56e-03]
 [ 1.00e+00  0.00e+00  2.44e-02  4.97e-04 -5.58e-03]
 [ 0.00e+00  1.80e-02 -3.87e-02  3.95e-02 -6.08e-03]
 [-7.24e-02  1.14e-03  1.71e-02  7.12e-03 -1.25e-02]
 [-9.66e-02  1.13e-02 -6.44e-02  2.40e-02 -1.98e-02]]
[[-1.57e-02 -2.51e-02  1.11e-01 -4.71e-02 -8.01e-05]
 [ 6.17e-02  2.89e-03 -4.95e-01  4.92e-02  2.86e-02]
 [-9.79e-02  4.11e-02 -4.39e-01 -3.56e-02 -4.83e-02]
 [ 8.61e-02 -8.17e-02  1.09e+00 -1.12e-02  3.98e-02]
 [-3.18e-02  4.49e-02 -2.30e-01  1.03e-02 -9.32e-03]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00 -5.33e-02]
 [ 0.00e+00  0.00e+00  0.00e+00  1.42e-03  1.50e-02]
 [ 0.00e+00  0.00e+00  7.60e-03  7.55e-03 -3.49e-03]
 [ 0.00e+00 -7.49e-04 -4.67e-04 -4.23e-03 -7.98e-02]
 [ 9.61e-02  3.48e-03  3.76e-03 -3.94e-03  5.71e-03]]
[[ 4.84e-02 -1.89e-01  3.71e-01 -1.79e-01  4.54e-02]
 [-1.28e-01  4.92e-01 -1.07e+00  4.32e-01 -1.05e-01]
 [-7.09e-02  1.32e+00 -1.99e+00  1.44e+00 -1.17e-01]
 [ 4.61e-02 -2.15e-01  6.53e-04 -2.95e-01  7.93e-02]
 [-3.17e-02  1.36e-01 -1.22e-01  1.53e-01 -3.91e-02]]
[[ 0.    0.    0.    0.   -0.01]
 [ 0.    1.    0.   -0.01 -0.02]
 [ 0.    0.   -0.   -0.    0.  ]
 [ 0.   -0.   -0.    0.06  0.05]
 [ 0.    0.    0.   -0.01 -0.01]]
[[-0.01  0.06 -0.23  0.25 -0.06]
 [ 0.    0.11  0.66 -1.    0.21]
 [-0.05  0.25 -0.46  0.38 -0.1 ]
 [ 0.05 -0.39 -0.12  0.54 -0.09]
 [ 0.    0.    0.11 -0.15  0.04]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  4.65e-02]
 [ 0.00e+00  0.00e+00  0.00e+00  3.03e-04 -3.32e-03]
 [ 1.00e+00  0.00e+00  6.33e-03  6.84e-03 -3.79e-03]
 [ 0.00e+00 -4.22e-04 -7.86e-03 -2.93e-03  1.99e-02]
 [ 2.77e-03  2.73e-03  2.02e-02 -3.91e-03 -9.29e-03]]
[[-1.94e-02  1.03e-01 -2.55e-01  1.13e-01 -2.29e-02]
 [ 4.92e-02 -2.95e-01  1.85e+00 -3.53e-01  7.27e-02]
 [ 1.31e-02  8.83e-02 -2.75e+00  1.91e-01 -3.02e-02]
 [ 5.10e-04 -9.10e-02  1.54e+00 -1.61e-01  3.01e-02]
 [ 3.16e-03  8.26e-03 -1.12e-01  2.36e-02 -3.23e-03]]
SymNet parameters
[[ 1.11e-01 -2.81e-03 -3.34e-03  1.68e-03 -9.58e-05 -1.83e-05  1.92e-02 -5.27e-04
   4.00e-03  8.25e-05  1.61e-04 -1.40e-05]
 [ 1.32e+00 -1.98e+00 -3.56e-01 -4.40e-01 -1.51e-02 -4.35e-02 -2.87e-01  1.46e-01
   4.76e-04 -5.36e-03 -3.05e-02  1.32e-02]]
SymNet parameters
[-0.5  -0.13]
SymNet parameters
[[-6.75e-03  1.34e-02  7.80e-03  7.96e-03  6.19e-04  2.68e-03  1.66e+00 -6.15e-02
   1.12e-02 -1.60e-03  6.31e-04 -2.79e-03 -2.61e-02]
 [ 2.52e-02 -2.10e-02  1.93e-01 -5.53e-03 -7.00e-03 -4.87e-04 -4.73e-03  1.97e-03
  -6.58e-03 -1.80e-04 -4.14e-04 -3.73e-05  2.25e-02]]
SymNet parameters
[-0.7  -1.07]
SymNet parameters
[[ 1.99e-01 -2.07e-01  9.23e-01 -4.96e-02  1.43e-02 -4.76e-03 -9.15e-03  1.75e-02
  -3.27e-02 -9.92e-04 -3.11e-03  1.83e-03  1.00e-01  2.00e-02]
 [-6.79e-02  7.35e-02  3.15e-02  4.09e-02  1.76e-04  2.43e-03  2.88e+00  3.14e-02
   1.57e-02 -2.35e-03  4.12e-03 -4.15e-03 -4.51e-02  1.08e-03]]
SymNet parameters
[0.87 0.37]
SymNet parameters
[[-2.98e+00 -2.42e+00 -7.72e-01  8.20e-02  2.70e-02  3.69e-02 -4.04e+00  1.57e-01
  -1.29e-01  9.59e-03  1.24e-02 -2.10e-02 -3.00e-01 -3.55e+00  1.71e-01]
 [ 4.71e+00 -7.44e-01  1.54e-01  5.71e-02 -1.64e-02 -2.89e-04 -2.99e-01 -4.20e-02
   6.01e-01  4.51e-03  3.07e-03  3.17e-03  6.72e-01 -4.21e-01 -1.06e-02]]
SymNet parameters
[1.31 0.76]
SymNet parameters
[[-1.11e+00 -1.44e+00 -2.38e-01  1.41e-01  1.59e-02  1.83e-02 -2.75e+00  5.35e-02
  -9.32e-02  4.51e-03  1.10e-02 -5.57e-03 -7.09e-02 -1.78e+00  1.52e-01  2.71e-04]
 [-1.21e+00  1.19e-01 -1.98e-02  8.76e-03  1.58e-03  2.18e-03  6.12e-02 -1.85e-03
  -4.73e-02 -2.18e-05  5.28e-04 -6.53e-04 -1.25e-01  7.22e-02  4.38e-03 -4.51e-04]]
SymNet parameters
[ 0.77 -0.92]
SymNet parameters
[[ 1.86e+00 -1.13e+00 -2.56e-01 -4.22e-01 -1.59e-02  6.43e-04  3.70e-02  1.79e-01
   2.46e-02 -5.83e-03 -3.27e-02  1.69e-02  1.85e+00 -1.06e-01 -3.23e-01 -3.27e-02
  -5.56e-01]]
SymNet parameters
[0.3]
SymNet parameters
[[-2.70e-01  8.43e-04  1.85e-02  1.01e-04 -1.36e-04  3.46e-04  8.04e-03  4.00e-04
  -1.67e-05  5.10e-04  1.86e-04 -2.29e-04]
 [ 1.39e-02 -7.70e-03  8.97e-04 -6.88e-05  5.00e-04 -8.94e-05 -3.43e-02  3.91e-01
  -4.90e-03 -2.48e-03 -2.83e-02  7.16e-04]]
SymNet parameters
[-1.04  1.2 ]
SymNet parameters
[[-1.72e-03 -5.01e-02 -3.89e-03  8.07e-04  4.73e-04  2.48e-04  8.10e-01  2.87e-02
  -6.52e-03  7.49e-03 -1.08e-03  1.75e-03  5.15e-02]
 [-1.21e+00 -1.07e-01  7.35e-02 -4.73e-04  2.32e-03  4.88e-03 -1.70e+00 -1.19e+00
   2.03e+00 -7.17e-02  8.49e-02  8.05e-03 -2.71e+00]]
SymNet parameters
[ 1.19 -2.3 ]
SymNet parameters
[[-5.76e+00  4.85e-03 -8.82e-02  8.52e-03  1.31e-04  6.72e-03  1.85e-01  1.13e-01
   8.84e-03  3.19e-02 -6.37e-03  2.10e-03  1.51e-01  7.84e-03]
 [ 7.08e-01 -9.99e-02 -2.65e-01  1.98e-01  2.79e-02 -8.75e-02  6.21e+00 -4.60e+00
  -7.43e-01  4.90e+00 -3.49e-02  5.95e-01 -2.69e-01  1.01e+00]]
SymNet parameters
[-0.63 -0.78]
SymNet parameters
[[ 1.61e-01 -6.46e-02 -5.83e-02  4.12e-02  5.76e-03 -1.79e-02  1.07e+00  1.59e+00
  -1.14e-01  1.01e+00  1.75e-02  1.24e-01  2.52e-02  2.16e-01  2.32e-04]
 [-7.42e+00  4.44e-02 -9.54e-02  1.13e-02 -2.04e-03  6.22e-03 -4.74e-02 -1.09e-01
   5.38e-02  3.25e-02  3.32e-03  4.06e-03 -1.64e-01  1.81e-02  5.71e-06]]
SymNet parameters
[-0.75  0.8 ]
SymNet parameters
[[ 6.78e-03  8.82e-02 -8.04e-03  4.96e-04  2.28e-03 -8.01e-04 -1.56e+00  3.89e-01
  -1.44e+00 -1.28e-02 -3.14e-02  1.25e-02  1.20e+00  1.64e-02  5.33e-03 -2.02e-02]
 [ 8.87e-02 -9.18e-02 -7.82e-03  7.45e-04  8.35e-04  7.10e-04 -1.17e+00  6.36e-02
  -6.26e-02  1.53e-02 -4.11e-03  3.49e-03  1.53e-01  1.77e-02  5.66e-04 -1.08e-03]]
SymNet parameters
[ 0.91 -0.63]
SymNet parameters
[[-2.90e-01 -6.67e-02  6.28e-03 -4.03e-03 -2.79e-05  3.23e-03 -1.52e-02 -4.64e-02
   1.07e+00 -7.63e-02  2.10e-03  3.98e-02 -7.90e-03 -3.58e-01 -1.34e-02  5.08e-02
  -2.55e-01]]
SymNet parameters
[0.55]
finally, finish this stage
iter:     0    time: 30.48
Func: 1.46e+00  |g|: 2.71e+02
stableloss: 7.64e-02   dataloss: 1.39e+00   sparseloss: 1.27e+02 momentloss: 7.44e+00
current expression:
[u00*u01, u10*v00, u20, u02, u00, u00*u01**2, u01*u10*v00, u10*v00*v10, u00*u11*v00, u00*u10*v01, u01*u10, u00**3, 1, u00**2, u01*v00**2, u10*v10, u00**2*u02, u00*v00**2, u10, v00**2]
[-0.99 -0.99  0.05  0.05  0.01  0.01  0.01  0.01  0.01  0.01 -0.   -0.   -0.    0.
  0.   -0.    0.   -0.    0.    0.  ]
[u00*v01, v00*v10, v20, v02, v00, v00*v10**2, u00*u01*v01, u00*v01*v10, u00*v00*v11, u10*v00*v01, v00**3, 1, v00**2, u00**2*v02, v01, u00*v00, v10**2, u10*v01, u01, u00*v00**2*v01]
[-0.99 -0.99  0.05  0.05  0.01  0.01  0.01  0.01  0.01  0.01 -0.01 -0.01  0.    0.
  0.    0.   -0.   -0.    0.    0.  ]
u_obs.abs().max()
tensor(3.9303, device='cuda:1', dtype=torch.float64)
model(u_obs[0],T=50*dt).abs().max()
tensor(3.1215, device='cuda:1', dtype=torch.float64)
model(u_obs[0],T=100*dt).abs().max()
tensor(nan, device='cuda:1', dtype=torch.float64)
