--name=burgers-2-upwind-sparse0-noise0.001-id0 --kernel_size=5 --viscosity=0.05 --blocks=0-6,9 --dataname=burgers --constraint=2 --device=cuda:0 --stablize=0 --sparsity=0 --momentsparsity=0.001 --data_start_time=1 --dt=1e-2 --max_dt=1/1600 --hidden_layers=5 --start_noise=0.001 --end_noise=0.001 --scheme=upwind
0
--name=burgers-2-upwind-sparse0-noise0.001-id1 --kernel_size=5 --viscosity=0.05 --blocks=0-6,9 --dataname=burgers --constraint=2 --device=cuda:1 --stablize=0 --sparsity=0 --momentsparsity=0.001 --data_start_time=1 --dt=1e-2 --max_dt=1/1600 --hidden_layers=5 --start_noise=0.001 --end_noise=0.001 --scheme=upwind
1
--name=burgers-2-upwind-sparse0-noise0.001-id2 --kernel_size=5 --viscosity=0.05 --blocks=0-6,9 --dataname=burgers --constraint=2 --device=cuda:2 --stablize=0 --sparsity=0 --momentsparsity=0.001 --data_start_time=1 --dt=1e-2 --max_dt=1/1600 --hidden_layers=5 --start_noise=0.001 --end_noise=0.001 --scheme=upwind
2
--name=burgers-2-upwind-sparse0-noise0.001-id3 --kernel_size=5 --viscosity=0.05 --blocks=0-6,9 --dataname=burgers --constraint=2 --device=cuda:3 --stablize=0 --sparsity=0 --momentsparsity=0.001 --data_start_time=1 --dt=1e-2 --max_dt=1/1600 --hidden_layers=5 --start_noise=0.001 --end_noise=0.001 --scheme=upwind
3
wait
{'--name': 'burgers-2-upwind-sparse0-noise0.001-id3', '--dtype': 'double', '--device': 'cuda:3', '--constraint': '2', '--dt': 0.01, '--cell_num': 1, '--eps': 6.283185307179586, '--blocks': [0, 1, 2, 3, 4, 5, 6, 9], '--kernel_size': 5, '--max_order': 2, '--dx': 0.19634954084936207, '--hidden_layers': 5, '--scheme': 'upwind', '--dataname': 'burgers', '--viscosity': 0.05, '--zoom': 4, '--max_dt': 0.000625, '--batch_size': 28, '--data_timescheme': 'rk2', '--channel_names': 'u,v', '--freq': 4, '--data_start_time': 1.0, '--start_noise': 0.001, '--end_noise': 0.001, '--stablize': 0.0, '--sparsity': 0.0, '--momentsparsity': 0.001, '--npseed': -1, '--torchseed': -1, '--maxiter': 2000, '--recordfile': 'None', '--recordcycle': 200, '--savecycle': -1, '--start_from': -1}
Traceback (most recent call last):
  File "train.py", line 58, in <module>
    globalnames, callback, model, data_model, sampling, addnoise = setenv.setenv(options)
  File "/data/users2/sajad/code/PDE-Net/setenv.py", line 68, in setenv
    globalnames, callback, model = _set_model(options)
  File "/data/users2/sajad/code/PDE-Net/setenv.py", line 45, in _set_model
    model.to(globalnames['device'])
  File "/home/users/mabavisani/anaconda3/envs/PDE-Net-2/lib/python3.7/site-packages/torch/nn/modules/module.py", line 386, in to
    return self._apply(convert)
  File "/home/users/mabavisani/anaconda3/envs/PDE-Net-2/lib/python3.7/site-packages/torch/nn/modules/module.py", line 193, in _apply
    module._apply(fn)
  File "/home/users/mabavisani/anaconda3/envs/PDE-Net-2/lib/python3.7/site-packages/torch/nn/modules/module.py", line 193, in _apply
    module._apply(fn)
  File "/home/users/mabavisani/anaconda3/envs/PDE-Net-2/lib/python3.7/site-packages/torch/nn/modules/module.py", line 205, in _apply
    self._buffers[key] = fn(buf)
  File "/home/users/mabavisani/anaconda3/envs/PDE-Net-2/lib/python3.7/site-packages/torch/nn/modules/module.py", line 384, in convert
    return t.to(device, dtype if t.is_floating_point() else None, non_blocking)
RuntimeError: CUDA error: invalid device ordinal
{'--name': 'burgers-2-upwind-sparse0-noise0.001-id0', '--dtype': 'double', '--device': 'cuda:0', '--constraint': '2', '--dt': 0.01, '--cell_num': 1, '--eps': 6.283185307179586, '--blocks': [0, 1, 2, 3, 4, 5, 6, 9], '--kernel_size': 5, '--max_order': 2, '--dx': 0.19634954084936207, '--hidden_layers': 5, '--scheme': 'upwind', '--dataname': 'burgers', '--viscosity': 0.05, '--zoom': 4, '--max_dt': 0.000625, '--batch_size': 28, '--data_timescheme': 'rk2', '--channel_names': 'u,v', '--freq': 4, '--data_start_time': 1.0, '--start_noise': 0.001, '--end_noise': 0.001, '--stablize': 0.0, '--sparsity': 0.0, '--momentsparsity': 0.001, '--npseed': -1, '--torchseed': -1, '--maxiter': 2000, '--recordfile': 'None', '--recordcycle': 200, '--savecycle': -1, '--start_from': -1}
block:  0
name:  burgers-2-upwind-sparse0-noise0.001-id0
device:  cuda:0
generate a random number to check random seed:  0.8634241185307027
current stage is: warmup
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.9266, device='cuda:0', dtype=torch.float64)
u_obs variance
tensor([ 0.2542,  2.2031,  1.8976, 20.5907, 10.5225, 16.5237,  0.2597,  2.0804,
         2.2772, 18.2798, 10.9685, 21.2800], device='cuda:0',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
iter:     0    time: 13.55
Func: 5.50e+00  |g|: 2.24e+00
stableloss: 2.90e-03   dataloss: 5.50e+00   sparseloss: 2.54e+01 momentloss: 7.27e+00
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 0.044781
         Iterations: 183
         Function evaluations: 242
         Gradient evaluations: 236
convolution moment and kernels
[[1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
[[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 1. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
[[ 0.    1.    0.   -0.33 -0.25]
 [ 0.    0.    0.    0.    0.  ]
 [ 0.    0.    0.    0.    0.  ]
 [ 0.    0.    0.    0.    0.  ]
 [ 0.    0.    0.    0.    0.  ]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]
 [ 2.78e-17  3.33e-16 -1.50e+00  2.00e+00 -5.00e-01]
 [ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]]
[[ 0.    0.    0.    0.    0.  ]
 [ 1.    0.    0.    0.    0.  ]
 [ 0.    0.    0.    0.    0.  ]
 [-0.33  0.    0.    0.    0.  ]
 [-0.25  0.    0.    0.    0.  ]]
[[ 0.00e+00  0.00e+00  2.78e-17  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  3.33e-16  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00 -1.50e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  2.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00 -5.00e-01  0.00e+00  0.00e+00]]
[[0.   0.   1.   0.   0.08]
 [0.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.  ]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]
 [-2.22e-16  1.00e+00 -2.00e+00  1.00e+00 -1.53e-16]
 [ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]]
[[0. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
[[ 6.94e-03 -5.56e-02  9.25e-18  5.56e-02 -6.94e-03]
 [-5.56e-02  4.44e-01 -7.40e-17 -4.44e-01  5.56e-02]
 [ 9.25e-18 -7.40e-17  1.23e-32  7.40e-17 -9.25e-18]
 [ 5.56e-02 -4.44e-01  7.40e-17  4.44e-01 -5.56e-02]
 [-6.94e-03  5.56e-02 -9.25e-18 -5.56e-02  6.94e-03]]
[[0.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.  ]
 [1.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.  ]
 [0.08 0.   0.   0.   0.  ]]
[[ 0.00e+00  0.00e+00 -2.22e-16  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  1.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00 -2.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  1.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00 -1.53e-16  0.00e+00  0.00e+00]]
SymNet parameters
[[-4.99e-02 -1.37e+00 -8.92e-01  7.47e-01 -1.64e-01 -1.44e-01 -1.10e+00  6.27e-02
  -2.90e-01  5.72e-02 -9.48e-02  5.87e-02]
 [-6.36e-01 -5.24e-01 -1.52e-01 -1.38e-01 -1.40e-03  4.48e-02 -2.66e-01  1.03e-02
   6.57e-02  4.58e-03 -7.57e-04 -1.19e-02]]
SymNet parameters
[0.09 0.01]
SymNet parameters
[[ 0.11  0.17  0.04  0.12 -0.02 -0.02 -0.59  0.01 -0.04  0.01 -0.01  0.01 -0.  ]
 [ 0.28 -0.55 -0.43  0.08  0.15 -0.12 -0.35 -0.11 -0.11 -0.08  0.08  0.01  0.02]]
SymNet parameters
[0.05 0.19]
SymNet parameters
[[ 0.19 -0.03  0.18  0.33 -0.36 -0.5  -0.14 -0.33  0.1  -0.02 -0.11 -0.13  0.68 -0.15]
 [ 0.35 -0.05 -0.03  0.64  0.07 -0.36  0.03  0.24 -0.04 -0.16 -0.04  0.06 -0.02  0.24]]
SymNet parameters
[-0.21 -0.05]
SymNet parameters
[[-4.34e-01 -8.40e-01 -3.98e-01 -2.00e-01  3.52e-02  4.17e-02  1.14e+00 -1.71e-02
   7.73e-02 -1.02e-02  1.95e-02 -1.85e-02  7.49e-03 -3.50e-02 -7.12e-05]
 [-1.66e+00 -1.95e-01  9.96e-01 -2.26e-01  1.60e-01 -2.49e-02 -4.92e-01 -9.21e-02
   3.41e-02 -7.27e-02  9.01e-02 -1.55e-02  1.26e-02  5.94e-03 -9.74e-04]]
SymNet parameters
[-0.41 -0.32]
SymNet parameters
[[ 7.05e-01 -4.82e-01 -2.34e-01 -8.86e-02  1.38e-02  2.10e-02 -1.18e+00 -3.67e-03
   3.29e-02 -3.66e-03  6.34e-03 -6.85e-03  4.99e-03 -1.27e-02  1.38e-03 -4.69e-03]
 [-6.89e-01  7.39e-01 -7.93e-01 -1.81e-01  2.64e-02  3.93e-02  4.33e-02 -1.04e-02
   6.90e-02 -6.95e-03  1.64e-02 -1.82e-02  4.72e-05  4.21e-03 -1.98e-03 -1.88e-03]]
SymNet parameters
[-0.01  0.09]
SymNet parameters
[[ 2.34e-01  4.58e-02 -9.22e-02  8.00e-02 -1.70e-02  3.11e-02 -1.59e-01  1.08e-02
  -1.02e-02  7.46e-03 -1.19e-02  5.06e-03 -2.10e-01 -4.40e-01  2.61e-05 -2.42e-01
  -4.04e-01]]
SymNet parameters
[0.04]
SymNet parameters
[[ 0.52 -0.04  0.03 -0.    0.   -0.02 -0.13  0.54  1.13 -0.06  0.06  0.06]
 [-0.41  0.01 -0.01 -0.    0.    0.   -0.81 -0.06  0.1   0.   -0.01 -0.  ]]
SymNet parameters
[-0.21  0.1 ]
SymNet parameters
[[ 0.23 -0.03  0.03 -0.01  0.01 -0.03  0.32 -1.03 -0.08 -0.08  0.08  0.07  0.03]
 [ 0.93  0.07 -0.05 -0.02  0.03 -0.   -0.21  0.06  0.11  0.01 -0.06 -0.01  0.1 ]]
SymNet parameters
[ 0.18 -0.21]
SymNet parameters
[[-0.15  0.08 -0.04 -0.04  0.06 -0.04 -0.45  0.9  -0.89 -0.08 -0.01  0.07  0.21 -0.01]
 [ 1.02 -0.04  0.05  0.01 -0.02 -0.01 -0.84 -0.23 -0.3  -0.02  0.05  0.03 -0.06 -0.01]]
SymNet parameters
[-0.05  0.11]
SymNet parameters
[[ 1.53e-01 -4.49e-02  1.90e-01 -2.62e-01 -3.91e-02 -2.76e-01 -3.51e-02 -1.64e-01
  -3.63e-01  1.55e-01  1.58e-01  2.94e-01 -3.80e-01  7.52e-02 -1.97e-02]
 [-1.66e-01  1.48e-01  1.31e-01  6.66e-01  1.40e-01  8.08e-01 -1.44e-01  3.29e-01
   2.88e-01  2.17e-01  1.80e-04  1.15e-02 -8.26e-02 -2.91e-02 -1.91e-01]]
SymNet parameters
[ 0.18 -0.1 ]
SymNet parameters
[[-2.61e-01  2.73e-01 -1.48e-01 -6.41e-02  8.04e-02 -1.67e-03 -3.77e-01 -3.22e-02
   7.90e-01  6.77e-02 -2.24e-01 -7.27e-02  3.38e-01 -2.72e-02 -7.83e-03  6.86e-04]
 [ 3.10e-01  3.60e-03 -2.70e-02  1.22e-02 -2.13e-02  3.17e-02 -6.76e-01  2.85e-01
   4.09e-02  7.15e-02 -5.04e-02 -6.32e-02 -5.70e-02 -9.17e-03  9.27e-03  3.45e-04]]
SymNet parameters
[0.08 0.15]
SymNet parameters
[[-1.57e-01 -1.27e-02  9.43e-03  2.64e-03 -5.05e-03 -3.04e-03 -2.71e-02 -1.36e-01
  -1.27e-01  2.67e-02  1.89e-02  4.12e-02  5.85e-01  5.02e-01 -2.50e-01  1.54e-05
   2.42e-01]]
SymNet parameters
[0.03]
finally, finish this stage
iter:   183    time: 17.06
Func: 4.48e-02  |g|: 2.68e-02
stableloss: 1.19e-02   dataloss: 4.48e-02   sparseloss: 5.94e+01 momentloss: 7.27e+00
current expression:
[u10*v00, u00*u01, u20, u02, v00, u00**2*v00, u01, u10, u00*u01**2, u01*u10*v00, u00*v00, u00**2*u01, u00*u01*u10, u00**2*u02, u00, v00*v10, u00*v10, u02*v00, u01**2, v10]
[-0.88 -0.88  0.04  0.03 -0.01  0.01 -0.01 -0.01  0.01  0.01  0.    0.    0.   -0.
  0.   -0.   -0.    0.   -0.    0.  ]
[v00*v10, u00*v01, v02, v20, v00, u00*v01*v10, v00*v10**2, 1, u11, u10*v01, v00*v20, v00**2, v10*v20, u00*v10, u00*u01, u10*v00*v10, u00, v01, u00*u20, u00**2*v10]
[-0.88 -0.88  0.04  0.03 -0.01  0.01  0.01  0.01 -0.   -0.   -0.   -0.    0.    0.
  0.    0.   -0.   -0.   -0.    0.  ]
block:  1
name:  burgers-2-upwind-sparse0-noise0.001-id0
device:  cuda:0
generate a random number to check random seed:  -1.4914458473383874
current stage is: block-1
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.9070, device='cuda:0', dtype=torch.float64)
u_obs variance
tensor([ 0.2449,  2.0300,  1.8371, 18.6653,  9.2673, 15.7378,  0.2567,  1.9564,
         2.1156, 17.0327,  9.6572, 19.7068], device='cuda:0',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
iter:     0    time: 1595.29
Func: 4.99e-02  |g|: 5.68e-01
stableloss: 1.35e-02   dataloss: 4.26e-02   sparseloss: 5.94e+01 momentloss: 7.27e+00
iter:   200    time: 10.50
Func: 2.13e-02  |g|: 4.48e-02
stableloss: 1.15e-02   dataloss: 1.47e-02   sparseloss: 6.11e+01 momentloss: 6.58e+00
iter:   400    time: 10.53
Func: 1.97e-02  |g|: 1.40e-02
stableloss: 1.02e-02   dataloss: 1.31e-02   sparseloss: 7.03e+01 momentloss: 6.53e+00
iter:   600    time: 10.50
Func: 1.93e-02  |g|: 1.36e-02
stableloss: 1.02e-02   dataloss: 1.28e-02   sparseloss: 7.48e+01 momentloss: 6.53e+00
iter:   800    time: 10.51
Func: 1.91e-02  |g|: 1.77e-02
stableloss: 1.04e-02   dataloss: 1.26e-02   sparseloss: 8.14e+01 momentloss: 6.52e+00
iter:  1000    time: 10.59
Func: 1.89e-02  |g|: 3.24e-02
stableloss: 1.03e-02   dataloss: 1.24e-02   sparseloss: 9.07e+01 momentloss: 6.51e+00
iter:  1200    time: 10.48
Func: 1.87e-02  |g|: 1.75e-02
stableloss: 1.03e-02   dataloss: 1.22e-02   sparseloss: 9.31e+01 momentloss: 6.52e+00
iter:  1400    time: 10.47
Func: 1.85e-02  |g|: 6.14e-03
stableloss: 1.02e-02   dataloss: 1.20e-02   sparseloss: 9.25e+01 momentloss: 6.52e+00
iter:  1600    time: 10.53
Func: 1.85e-02  |g|: 8.05e-03
stableloss: 1.01e-02   dataloss: 1.19e-02   sparseloss: 9.54e+01 momentloss: 6.51e+00
iter:  1800    time: 10.46
Func: 1.84e-02  |g|: 1.35e-02
stableloss: 1.01e-02   dataloss: 1.19e-02   sparseloss: 1.00e+02 momentloss: 6.51e+00
Warning: Maximum number of iterations has been exceeded.
         Current function value: 0.018371
         Iterations: 2000
         Function evaluations: 2004
         Gradient evaluations: 2004
convolution moment and kernels
[[ 1.00e+00  0.00e+00  2.24e-05  1.79e-03 -2.78e-02]
 [ 0.00e+00 -5.32e-05 -1.32e-03  1.07e-03 -2.64e-03]
 [ 6.99e-05  2.15e-03  3.68e-03  7.78e-04 -1.32e-03]
 [ 5.88e-02  8.22e-04 -4.25e-03 -9.54e-04  4.53e-03]
 [-5.87e-02  2.87e-03 -3.86e-03 -1.07e-02  3.89e-03]]
[[ 0.01 -0.02 -0.07  0.   -0.  ]
 [-0.03  0.11  0.19  0.02  0.01]
 [ 0.03 -0.11  0.72  0.03 -0.03]
 [-0.05  0.18 -0.02  0.07 -0.  ]
 [ 0.01 -0.05  0.03 -0.02  0.  ]]
[[ 0.00e+00  1.00e+00  0.00e+00 -9.74e-02 -6.84e-02]
 [ 0.00e+00  0.00e+00 -2.65e-03  1.13e-03  1.01e-03]
 [ 0.00e+00  4.33e-03 -1.91e-04  9.73e-03 -6.61e-03]
 [ 3.41e-03  2.29e-03  9.02e-04 -3.19e-03 -2.96e-03]
 [ 1.32e-02 -3.01e-02 -3.41e-03 -1.25e-02 -1.38e-03]]
[[ 0.    0.    0.03 -0.02 -0.  ]
 [-0.03  0.02 -0.13  0.08  0.01]
 [ 0.11 -0.52 -0.23  0.95 -0.22]
 [-0.02 -0.   -0.08  0.03  0.02]
 [ 0.    0.01  0.01  0.   -0.01]]
[[ 0.00e+00  0.00e+00  0.00e+00  9.43e-03  6.06e-03]
 [ 1.00e+00  0.00e+00  1.96e-02 -1.91e-03 -6.25e-03]
 [ 0.00e+00 -2.24e-03  2.45e-03 -2.66e-03  1.12e-04]
 [-8.93e-02  5.85e-04  6.98e-03 -9.25e-04 -1.75e-02]
 [-5.86e-02  1.39e-03 -9.10e-03 -8.69e-04 -2.68e-03]]
[[ 6.78e-03 -3.84e-02  1.31e-01 -3.60e-02  6.22e-03]
 [-6.13e-03  6.05e-02 -6.21e-01  4.93e-02 -4.53e-03]
 [-9.48e-03 -3.83e-02 -2.61e-01 -4.15e-02 -9.33e-04]
 [ 1.99e-02 -3.02e-02  1.02e+00 -4.15e-02  2.10e-02]
 [-9.69e-03  3.16e-02 -2.34e-01  3.60e-02 -1.09e-02]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00 -3.85e-03]
 [ 0.00e+00  0.00e+00  0.00e+00 -1.24e-03  4.47e-04]
 [ 0.00e+00  0.00e+00  2.92e-03 -1.24e-03 -1.30e-03]
 [ 0.00e+00 -9.05e-04 -7.18e-04  1.14e-03  2.33e-05]
 [ 1.89e-03 -3.10e-03 -2.26e-03  1.67e-03 -1.78e-03]]
[[-2.23e-03  6.57e-03 -2.61e-03  8.47e-04 -6.92e-04]
 [ 8.22e-03 -1.81e-02 -7.48e-03  9.91e-03 -6.23e-05]
 [-1.01e-01  1.38e+00 -2.50e+00  1.33e+00 -8.47e-02]
 [ 1.08e-02 -2.36e-02 -7.78e-03  1.48e-02 -1.75e-03]
 [-2.98e-03  7.77e-03 -1.12e-03 -1.86e-03  6.59e-05]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00 -6.57e-04]
 [ 0.00e+00  1.00e+00  0.00e+00 -6.51e-04 -2.58e-03]
 [ 0.00e+00  0.00e+00  1.25e-03 -6.63e-04 -1.80e-03]
 [ 0.00e+00 -1.00e-03 -1.77e-03  1.60e-03  3.42e-03]
 [ 3.26e-03 -8.55e-04 -3.01e-03  1.43e-03  4.47e-03]]
[[ 0.01 -0.07  0.03  0.04 -0.  ]
 [-0.07  0.51 -0.13 -0.36  0.04]
 [ 0.03 -0.14  0.26 -0.16  0.04]
 [ 0.03 -0.33 -0.2   0.58 -0.09]
 [-0.    0.03  0.05 -0.09  0.02]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  1.55e-03]
 [ 0.00e+00  0.00e+00  0.00e+00 -6.44e-04 -9.23e-04]
 [ 1.00e+00  0.00e+00  1.59e-03  4.54e-04  8.28e-04]
 [ 0.00e+00 -9.50e-04 -7.04e-04  9.14e-04  1.02e-03]
 [-2.40e-03 -7.01e-04  1.19e-03 -1.82e-03 -7.29e-03]]
[[-0.01  0.03 -0.14  0.04 -0.01]
 [ 0.03 -0.12  1.54 -0.14  0.04]
 [-0.04  0.17 -2.79  0.19 -0.05]
 [ 0.03 -0.11  1.52 -0.12  0.03]
 [-0.01  0.03 -0.13  0.03 -0.01]]
SymNet parameters
[[ 0.64 -2.22 -0.93  0.69  0.07  0.09 -1.02 -0.24 -0.67  0.03  0.04  0.09]
 [-0.14  0.08 -0.11 -0.07 -0.02 -0.   -1.14  0.    0.08 -0.   -0.   -0.01]]
SymNet parameters
[ 1.2  -0.51]
SymNet parameters
[[-0.25  0.14 -0.16 -0.09 -0.02 -0.01 -1.67  0.02  0.09 -0.   -0.01 -0.01  0.  ]
 [ 0.54 -1.6  -0.7   0.5   0.09  0.08 -0.78 -0.19 -0.46  0.02  0.03  0.06 -0.  ]]
SymNet parameters
[-0.75  0.63]
SymNet parameters
[[-0.27  2.13 -1.53 -0.57 -0.09 -0.05 -1.93  0.18  0.16 -0.03 -0.05 -0.09 -1.71  1.78]
 [ 0.87  1.43  0.19  0.55  0.24  0.42 -0.81 -0.8   0.48  0.07 -0.    0.09 -1.28  1.12]]
SymNet parameters
[-0.18 -0.04]
SymNet parameters
[[-1.74e+00 -4.31e-02 -3.10e-02 -1.53e-02 -6.18e-03 -6.62e-03  1.25e+00  2.10e-02
   1.55e-03 -1.73e-03 -7.42e-04 -2.78e-03  6.51e-02 -6.15e-02  4.25e-04]
 [-2.64e+00 -1.24e+00  9.15e-01  3.04e-01  5.42e-02  3.98e-02 -8.58e-01 -1.01e-01
  -2.74e-01  1.16e-02  1.51e-02  3.92e-02  1.48e-01 -1.38e-01  1.89e-03]]
SymNet parameters
[-0.09 -0.11]
SymNet parameters
[[ 1.09e+00  2.72e-01 -2.94e-01 -1.92e-01 -3.75e-02 -2.40e-02 -5.98e-01  5.73e-02
   1.87e-01 -7.71e-03 -1.02e-02 -2.47e-02  8.80e-03 -8.05e-03  1.24e-04 -2.93e-03]
 [-2.46e+00  3.32e-01  1.07e-01 -1.05e-01 -2.38e-02 -1.46e-02 -1.48e-01  3.81e-02
   1.10e-01 -5.89e-03 -6.50e-03 -1.34e-02  8.32e-02 -7.94e-02  4.86e-04 -3.82e-03]]
SymNet parameters
[-0.33 -0.23]
SymNet parameters
[[ 0.5   0.36  0.15 -0.05 -0.02  0.03 -0.01  0.04  0.08 -0.   -0.01 -0.01  0.04 -0.38
   0.01 -0.47 -0.79]]
SymNet parameters
[-0.07]
SymNet parameters
[[ 2.34e-01 -3.88e-01 -2.31e-01  5.18e-03 -1.35e-02  5.68e-03 -7.71e-01  4.18e-01
   6.73e-01  2.30e-02 -6.05e-02  2.16e-01]
 [ 1.59e-01  8.58e-03 -1.22e-03 -1.15e-03 -5.02e-04 -3.96e-04 -1.25e+00 -1.17e-01
  -1.15e-02  1.70e-03 -1.26e-03  4.20e-04]]
SymNet parameters
[-0.3   0.12]
SymNet parameters
[[ 4.52e-02  5.59e-02 -1.29e-01 -6.03e-04 -3.03e-03 -2.08e-03  1.18e-01 -2.08e+00
  -5.10e-01  7.18e-04 -3.74e-02  1.01e-01  6.56e-02]
 [ 1.07e+00  1.88e-02  3.60e-02 -4.18e-04  3.47e-04 -4.24e-04  1.04e-01 -5.50e-02
  -2.50e-02 -1.32e-03  7.64e-03 -2.47e-02  9.17e-03]]
SymNet parameters
[1.19 0.47]
SymNet parameters
[[ 2.74e-01 -6.18e-02 -4.97e-01  2.42e-03 -1.47e-02 -4.22e-03 -9.92e-01  1.01e+00
  -1.16e+00  2.23e-02 -1.23e-01  4.09e-01  7.14e-03 -1.98e-02]
 [ 6.50e-01  3.55e-02  8.00e-03  1.33e-04  2.81e-03 -8.96e-04 -1.22e+00  9.22e-02
   5.71e-02  3.26e-04  1.69e-03 -8.44e-03 -1.61e-02  1.16e-03]]
SymNet parameters
[-0.37  0.53]
SymNet parameters
[[ 2.82e-01 -2.85e-01 -4.45e-01  1.09e-02 -1.55e-02  5.10e-03 -6.43e-01 -2.97e+00
  -2.09e-01  1.46e-02  2.05e-01  3.84e-01  1.11e-01  2.92e-02 -2.13e-02]
 [-3.55e+00  7.49e-02  2.44e-01 -5.63e-03  2.35e-03  5.39e-03 -1.79e-01  1.12e-01
  -1.11e-01 -8.63e-03 -3.21e-03  7.06e-02 -3.93e-02 -9.32e-03  1.17e-02]]
SymNet parameters
[ 0.15 -0.13]
SymNet parameters
[[ 2.50e-01  1.23e+00 -1.16e-01 -9.77e-03  2.77e-02 -2.69e-02  8.32e-01  4.64e-01
   2.00e+00 -3.91e-02 -9.45e-03 -3.63e-03  6.11e-03  2.59e-01  9.62e-04  5.85e-02]
 [ 1.75e-02  4.43e-03 -1.80e-02 -3.16e-04 -1.35e-03  2.39e-04 -1.10e+00 -2.18e-02
  -6.58e-02 -1.24e-03 -3.19e-03  1.18e-02 -1.08e-02 -1.43e-02  1.19e-02  1.14e-03]]
SymNet parameters
[0.17 0.21]
SymNet parameters
[[-5.02e-01 -3.66e-02 -3.38e-02  9.71e-04 -1.22e-03  7.99e-05 -1.59e-01  4.48e-01
  -1.30e-01  5.44e-02 -7.80e-03  7.69e-02  4.08e-01  3.59e-01 -2.22e-01 -3.20e-03
   1.42e-01]]
SymNet parameters
[-0.24]
finally, finish this stage
iter:  2000    time: 10.53
Func: 1.84e-02  |g|: 2.12e-02
stableloss: 1.02e-02   dataloss: 1.19e-02   sparseloss: 9.71e+01 momentloss: 6.51e+00
current expression:
[u00*u01, u10*v00, u20, u02, u00*u01**2, u00, u10, u01*u10*v00, u00*u11*v00, u00**2*u01, 1, u00**3, u00**2*u10, v01, u10*v00*v10, u01, u01*u10, u00*u01*v00, u00*u10*v01, u00*u01*u10*v00]
[-0.98 -0.98  0.05  0.05  0.02  0.02  0.01  0.01  0.01 -0.01  0.01 -0.01 -0.01  0.01
  0.    0.   -0.   -0.    0.    0.  ]
[v00*v10, u00*v01, v02, v20, v00, v00*v10**2, u00*v00*v11, u00*u01*v01, u10*v00*v01, u00*v01*v10, u01, u10*v01, v10**2, u10, u00**2*v00, u00*v00, v00**3, u00*v00*v10, v00**2*v20, u00**2*v01]
[-0.98 -0.97  0.05  0.05  0.01  0.01  0.01  0.01  0.01  0.01  0.01 -0.01 -0.    0.
 -0.    0.   -0.   -0.    0.   -0.  ]
block:  2
name:  burgers-2-upwind-sparse0-noise0.001-id0
device:  cuda:0
generate a random number to check random seed:  -3.794844068240575
current stage is: block-2
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.7808, device='cuda:0', dtype=torch.float64)
u_obs variance
tensor([ 0.2622,  1.7698,  1.8045, 22.8325, 11.3518, 22.3110,  0.2501,  1.5800,
         1.6156, 18.3763,  9.2172, 21.1003], device='cuda:0',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 0.075121
         Iterations: 0
         Function evaluations: 15
         Gradient evaluations: 3
convolution moment and kernels
[[ 1.00e+00  0.00e+00  2.28e-05  1.79e-03 -2.78e-02]
 [ 0.00e+00 -5.30e-05 -1.32e-03  1.07e-03 -2.64e-03]
 [ 6.90e-05  2.16e-03  3.68e-03  7.76e-04 -1.31e-03]
 [ 5.88e-02  8.22e-04 -4.25e-03 -9.55e-04  4.53e-03]
 [-5.87e-02  2.86e-03 -3.86e-03 -1.07e-02  3.88e-03]]
[[ 0.01 -0.02 -0.07  0.   -0.  ]
 [-0.03  0.11  0.19  0.02  0.01]
 [ 0.03 -0.11  0.72  0.03 -0.03]
 [-0.05  0.18 -0.02  0.07 -0.  ]
 [ 0.01 -0.05  0.03 -0.02  0.  ]]
[[ 0.00e+00  1.00e+00  0.00e+00 -9.74e-02 -6.84e-02]
 [ 0.00e+00  0.00e+00 -2.65e-03  1.13e-03  1.01e-03]
 [ 0.00e+00  4.32e-03 -1.93e-04  9.74e-03 -6.61e-03]
 [ 3.42e-03  2.29e-03  9.00e-04 -3.19e-03 -2.96e-03]
 [ 1.32e-02 -3.01e-02 -3.41e-03 -1.25e-02 -1.38e-03]]
[[ 0.    0.    0.03 -0.02 -0.  ]
 [-0.03  0.02 -0.13  0.08  0.01]
 [ 0.11 -0.52 -0.23  0.95 -0.22]
 [-0.02 -0.   -0.08  0.03  0.02]
 [ 0.    0.01  0.01  0.   -0.01]]
[[ 0.00e+00  0.00e+00  0.00e+00  9.43e-03  6.07e-03]
 [ 1.00e+00  0.00e+00  1.96e-02 -1.91e-03 -6.25e-03]
 [ 0.00e+00 -2.24e-03  2.45e-03 -2.67e-03  1.09e-04]
 [-8.93e-02  5.86e-04  6.98e-03 -9.26e-04 -1.75e-02]
 [-5.86e-02  1.38e-03 -9.10e-03 -8.61e-04 -2.67e-03]]
[[ 6.77e-03 -3.83e-02  1.31e-01 -3.60e-02  6.22e-03]
 [-6.11e-03  6.04e-02 -6.21e-01  4.94e-02 -4.55e-03]
 [-9.50e-03 -3.83e-02 -2.61e-01 -4.17e-02 -8.79e-04]
 [ 1.99e-02 -3.02e-02  1.02e+00 -4.14e-02  2.09e-02]
 [-9.69e-03  3.16e-02 -2.34e-01  3.60e-02 -1.09e-02]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00 -3.85e-03]
 [ 0.00e+00  0.00e+00  0.00e+00 -1.24e-03  4.46e-04]
 [ 0.00e+00  0.00e+00  2.92e-03 -1.24e-03 -1.30e-03]
 [ 0.00e+00 -9.05e-04 -7.18e-04  1.14e-03  2.36e-05]
 [ 1.89e-03 -3.10e-03 -2.26e-03  1.67e-03 -1.78e-03]]
[[-2.24e-03  6.58e-03 -2.61e-03  8.47e-04 -6.92e-04]
 [ 8.23e-03 -1.82e-02 -7.47e-03  9.92e-03 -6.54e-05]
 [-1.01e-01  1.38e+00 -2.50e+00  1.33e+00 -8.47e-02]
 [ 1.08e-02 -2.36e-02 -7.78e-03  1.48e-02 -1.76e-03]
 [-2.98e-03  7.78e-03 -1.12e-03 -1.86e-03  6.67e-05]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00 -6.58e-04]
 [ 0.00e+00  1.00e+00  0.00e+00 -6.51e-04 -2.58e-03]
 [ 0.00e+00  0.00e+00  1.25e-03 -6.63e-04 -1.80e-03]
 [ 0.00e+00 -1.00e-03 -1.77e-03  1.60e-03  3.42e-03]
 [ 3.26e-03 -8.54e-04 -3.01e-03  1.43e-03  4.47e-03]]
[[ 0.01 -0.07  0.03  0.04 -0.  ]
 [-0.07  0.51 -0.13 -0.36  0.04]
 [ 0.03 -0.14  0.26 -0.16  0.04]
 [ 0.03 -0.33 -0.2   0.58 -0.09]
 [-0.    0.03  0.05 -0.09  0.02]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  1.55e-03]
 [ 0.00e+00  0.00e+00  0.00e+00 -6.44e-04 -9.23e-04]
 [ 1.00e+00  0.00e+00  1.59e-03  4.53e-04  8.28e-04]
 [ 0.00e+00 -9.50e-04 -7.05e-04  9.14e-04  1.02e-03]
 [-2.40e-03 -7.03e-04  1.19e-03 -1.82e-03 -7.30e-03]]
[[-0.01  0.03 -0.14  0.04 -0.01]
 [ 0.03 -0.12  1.54 -0.14  0.04]
 [-0.04  0.17 -2.79  0.19 -0.05]
 [ 0.03 -0.11  1.52 -0.12  0.03]
 [-0.01  0.03 -0.13  0.03 -0.01]]
SymNet parameters
[[ 0.64 -2.22 -0.93  0.69  0.07  0.09 -1.02 -0.24 -0.67  0.03  0.04  0.09]
 [-0.14  0.08 -0.11 -0.07 -0.02 -0.   -1.14  0.    0.08 -0.   -0.   -0.01]]
SymNet parameters
[ 1.2  -0.51]
SymNet parameters
[[-0.25  0.14 -0.16 -0.09 -0.02 -0.01 -1.67  0.02  0.09 -0.   -0.01 -0.01  0.  ]
 [ 0.54 -1.6  -0.7   0.5   0.09  0.08 -0.78 -0.19 -0.46  0.02  0.03  0.06 -0.  ]]
SymNet parameters
[-0.75  0.63]
SymNet parameters
[[-0.27  2.13 -1.53 -0.57 -0.09 -0.05 -1.93  0.18  0.16 -0.03 -0.05 -0.09 -1.71  1.78]
 [ 0.87  1.43  0.19  0.55  0.24  0.42 -0.81 -0.8   0.48  0.07 -0.    0.09 -1.28  1.12]]
SymNet parameters
[-0.18 -0.04]
SymNet parameters
[[-1.74e+00 -4.31e-02 -3.10e-02 -1.53e-02 -6.20e-03 -6.56e-03  1.25e+00  2.09e-02
   1.57e-03 -1.73e-03 -7.31e-04 -2.76e-03  6.52e-02 -6.14e-02  3.68e-04]
 [-2.64e+00 -1.24e+00  9.15e-01  3.04e-01  5.42e-02  3.98e-02 -8.58e-01 -1.01e-01
  -2.74e-01  1.16e-02  1.51e-02  3.92e-02  1.48e-01 -1.38e-01  1.57e-03]]
SymNet parameters
[-0.09 -0.11]
SymNet parameters
[[ 1.09e+00  2.72e-01 -2.94e-01 -1.92e-01 -3.75e-02 -2.39e-02 -5.98e-01  5.73e-02
   1.87e-01 -7.69e-03 -1.02e-02 -2.47e-02  8.69e-03 -8.17e-03 -5.82e-04 -2.89e-03]
 [-2.46e+00  3.32e-01  1.07e-01 -1.05e-01 -2.38e-02 -1.47e-02 -1.48e-01  3.81e-02
   1.10e-01 -5.90e-03 -6.51e-03 -1.34e-02  8.31e-02 -7.95e-02  5.41e-04 -3.80e-03]]
SymNet parameters
[-0.33 -0.23]
SymNet parameters
[[ 0.5   0.36  0.15 -0.05 -0.02  0.03 -0.01  0.04  0.08 -0.   -0.01 -0.01  0.04 -0.38
   0.01 -0.47 -0.79]]
SymNet parameters
[-0.07]
SymNet parameters
[[ 2.34e-01 -3.88e-01 -2.31e-01  5.18e-03 -1.35e-02  5.68e-03 -7.71e-01  4.18e-01
   6.73e-01  2.30e-02 -6.05e-02  2.16e-01]
 [ 1.59e-01  8.58e-03 -1.22e-03 -1.14e-03 -4.98e-04 -3.84e-04 -1.25e+00 -1.17e-01
  -1.15e-02  1.69e-03 -1.25e-03  3.95e-04]]
SymNet parameters
[-0.3   0.12]
SymNet parameters
[[ 4.52e-02  5.59e-02 -1.29e-01 -5.96e-04 -3.03e-03 -2.07e-03  1.18e-01 -2.08e+00
  -5.10e-01  7.22e-04 -3.74e-02  1.01e-01  6.56e-02]
 [ 1.07e+00  1.88e-02  3.60e-02 -4.27e-04  3.49e-04 -4.34e-04  1.04e-01 -5.50e-02
  -2.50e-02 -1.33e-03  7.64e-03 -2.48e-02  9.17e-03]]
SymNet parameters
[1.19 0.47]
SymNet parameters
[[ 2.74e-01 -6.18e-02 -4.97e-01  2.42e-03 -1.47e-02 -4.23e-03 -9.92e-01  1.01e+00
  -1.16e+00  2.23e-02 -1.23e-01  4.09e-01  7.16e-03 -1.98e-02]
 [ 6.50e-01  3.55e-02  8.00e-03  1.31e-04  2.81e-03 -8.97e-04 -1.22e+00  9.22e-02
   5.71e-02  3.26e-04  1.69e-03 -8.41e-03 -1.61e-02  1.15e-03]]
SymNet parameters
[-0.37  0.53]
SymNet parameters
[[ 2.82e-01 -2.85e-01 -4.45e-01  1.09e-02 -1.55e-02  5.10e-03 -6.43e-01 -2.97e+00
  -2.09e-01  1.46e-02  2.05e-01  3.84e-01  1.11e-01  2.92e-02 -2.13e-02]
 [-3.55e+00  7.49e-02  2.44e-01 -5.63e-03  2.35e-03  5.39e-03 -1.79e-01  1.12e-01
  -1.11e-01 -8.63e-03 -3.21e-03  7.06e-02 -3.93e-02 -9.32e-03  1.17e-02]]
SymNet parameters
[ 0.15 -0.13]
SymNet parameters
[[ 2.50e-01  1.23e+00 -1.16e-01 -9.78e-03  2.77e-02 -2.69e-02  8.32e-01  4.64e-01
   2.00e+00 -3.91e-02 -9.45e-03 -3.63e-03  6.11e-03  2.59e-01  9.63e-04  5.85e-02]
 [ 1.75e-02  4.43e-03 -1.80e-02 -3.12e-04 -1.35e-03  2.43e-04 -1.10e+00 -2.18e-02
  -6.58e-02 -1.24e-03 -3.18e-03  1.18e-02 -1.08e-02 -1.43e-02  1.19e-02  1.16e-03]]
SymNet parameters
[0.17 0.21]
SymNet parameters
[[-5.02e-01 -3.66e-02 -3.38e-02  9.70e-04 -1.22e-03  8.15e-05 -1.59e-01  4.48e-01
  -1.30e-01  5.44e-02 -7.80e-03  7.69e-02  4.08e-01  3.59e-01 -2.22e-01 -3.25e-03
   1.42e-01]]
SymNet parameters
[-0.24]
finally, finish this stage
iter:     0    time: 1450.90
Func: 7.51e-02  |g|: 7.64e+00
stableloss: 1.33e-02   dataloss: 6.21e-02   sparseloss: 9.71e+01 momentloss: 6.51e+00
current expression:
[u00*u01, u10*v00, u20, u02, u00*u01**2, u00, u10, u01*u10*v00, u00*u11*v00, u00**2*u01, 1, u00**3, u00**2*u10, v01, u10*v00*v10, u01, u01*u10, u00*u01*v00, u00*u10*v01, u00*u01*u10*v00]
[-0.98 -0.98  0.05  0.05  0.02  0.02  0.01  0.01  0.01 -0.01  0.01 -0.01 -0.01  0.01
  0.    0.   -0.   -0.    0.    0.  ]
[v00*v10, u00*v01, v02, v20, v00, v00*v10**2, u00*v00*v11, u00*u01*v01, u10*v00*v01, u00*v01*v10, u01, u10*v01, v10**2, u10, u00**2*v00, u00*v00, v00**3, u00*v00*v10, v00**2*v20, u00**2*v01]
[-0.98 -0.97  0.05  0.05  0.01  0.01  0.01  0.01  0.01  0.01  0.01 -0.01 -0.    0.
 -0.    0.   -0.   -0.    0.   -0.  ]
block:  3
name:  burgers-2-upwind-sparse0-noise0.001-id0
device:  cuda:0
generate a random number to check random seed:  -0.6660946937919461
current stage is: block-3
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.5023, device='cuda:0', dtype=torch.float64)
u_obs variance
tensor([ 0.2566,  1.6419,  1.5803, 20.6731,  9.6464, 18.6126,  0.2323,  1.3862,
         1.5449, 16.0696,  8.5841, 21.6386], device='cuda:0',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 0.170944
         Iterations: 0
         Function evaluations: 15
         Gradient evaluations: 3
convolution moment and kernels
[[ 1.00e+00  0.00e+00  2.14e-05  1.79e-03 -2.78e-02]
 [ 0.00e+00 -5.38e-05 -1.32e-03  1.07e-03 -2.64e-03]
 [ 7.11e-05  2.15e-03  3.68e-03  7.78e-04 -1.32e-03]
 [ 5.88e-02  8.23e-04 -4.25e-03 -9.54e-04  4.53e-03]
 [-5.87e-02  2.87e-03 -3.86e-03 -1.07e-02  3.89e-03]]
[[ 0.01 -0.02 -0.07  0.   -0.  ]
 [-0.03  0.11  0.19  0.02  0.01]
 [ 0.03 -0.11  0.72  0.03 -0.03]
 [-0.05  0.18 -0.02  0.07 -0.  ]
 [ 0.01 -0.05  0.03 -0.02  0.  ]]
[[ 0.00e+00  1.00e+00  0.00e+00 -9.74e-02 -6.84e-02]
 [ 0.00e+00  0.00e+00 -2.65e-03  1.13e-03  1.01e-03]
 [ 0.00e+00  4.32e-03 -1.94e-04  9.73e-03 -6.61e-03]
 [ 3.41e-03  2.29e-03  9.02e-04 -3.19e-03 -2.96e-03]
 [ 1.32e-02 -3.01e-02 -3.41e-03 -1.25e-02 -1.38e-03]]
[[ 0.    0.    0.03 -0.02 -0.  ]
 [-0.03  0.02 -0.13  0.08  0.01]
 [ 0.11 -0.52 -0.23  0.95 -0.22]
 [-0.02 -0.   -0.08  0.03  0.02]
 [ 0.    0.01  0.01  0.   -0.01]]
[[ 0.00e+00  0.00e+00  0.00e+00  9.43e-03  6.06e-03]
 [ 1.00e+00  0.00e+00  1.96e-02 -1.91e-03 -6.25e-03]
 [ 0.00e+00 -2.24e-03  2.45e-03 -2.66e-03  1.09e-04]
 [-8.93e-02  5.84e-04  6.98e-03 -9.24e-04 -1.76e-02]
 [-5.86e-02  1.39e-03 -9.10e-03 -8.69e-04 -2.67e-03]]
[[ 6.78e-03 -3.84e-02  1.31e-01 -3.60e-02  6.22e-03]
 [-6.15e-03  6.06e-02 -6.21e-01  4.94e-02 -4.54e-03]
 [-9.45e-03 -3.85e-02 -2.61e-01 -4.16e-02 -9.07e-04]
 [ 1.98e-02 -3.01e-02  1.02e+00 -4.15e-02  2.09e-02]
 [-9.68e-03  3.16e-02 -2.34e-01  3.60e-02 -1.09e-02]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00 -3.84e-03]
 [ 0.00e+00  0.00e+00  0.00e+00 -1.24e-03  4.47e-04]
 [ 0.00e+00  0.00e+00  2.92e-03 -1.24e-03 -1.30e-03]
 [ 0.00e+00 -9.05e-04 -7.18e-04  1.14e-03  2.31e-05]
 [ 1.89e-03 -3.10e-03 -2.26e-03  1.67e-03 -1.77e-03]]
[[-2.23e-03  6.57e-03 -2.60e-03  8.39e-04 -6.90e-04]
 [ 8.21e-03 -1.81e-02 -7.53e-03  9.95e-03 -7.19e-05]
 [-1.01e-01  1.38e+00 -2.50e+00  1.32e+00 -8.47e-02]
 [ 1.08e-02 -2.35e-02 -7.82e-03  1.48e-02 -1.76e-03]
 [-2.97e-03  7.77e-03 -1.11e-03 -1.86e-03  6.77e-05]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00 -6.57e-04]
 [ 0.00e+00  1.00e+00  0.00e+00 -6.51e-04 -2.58e-03]
 [ 0.00e+00  0.00e+00  1.25e-03 -6.63e-04 -1.80e-03]
 [ 0.00e+00 -1.00e-03 -1.77e-03  1.60e-03  3.42e-03]
 [ 3.26e-03 -8.54e-04 -3.01e-03  1.43e-03  4.47e-03]]
[[ 0.01 -0.07  0.03  0.04 -0.  ]
 [-0.07  0.51 -0.13 -0.36  0.04]
 [ 0.03 -0.14  0.26 -0.16  0.04]
 [ 0.03 -0.33 -0.2   0.58 -0.09]
 [-0.    0.03  0.05 -0.09  0.02]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  1.55e-03]
 [ 0.00e+00  0.00e+00  0.00e+00 -6.44e-04 -9.23e-04]
 [ 1.00e+00  0.00e+00  1.59e-03  4.53e-04  8.28e-04]
 [ 0.00e+00 -9.50e-04 -7.04e-04  9.14e-04  1.02e-03]
 [-2.40e-03 -7.02e-04  1.19e-03 -1.82e-03 -7.29e-03]]
[[-0.01  0.03 -0.14  0.04 -0.01]
 [ 0.03 -0.12  1.54 -0.14  0.04]
 [-0.04  0.17 -2.79  0.19 -0.05]
 [ 0.03 -0.11  1.52 -0.12  0.03]
 [-0.01  0.03 -0.13  0.03 -0.01]]
SymNet parameters
[[ 0.64 -2.22 -0.93  0.69  0.07  0.09 -1.02 -0.24 -0.67  0.03  0.04  0.09]
 [-0.14  0.08 -0.11 -0.07 -0.02 -0.   -1.14  0.    0.08 -0.   -0.   -0.01]]
SymNet parameters
[ 1.2  -0.51]
SymNet parameters
[[-0.25  0.14 -0.16 -0.09 -0.02 -0.01 -1.67  0.02  0.09 -0.   -0.01 -0.01  0.  ]
 [ 0.54 -1.6  -0.7   0.5   0.09  0.08 -0.78 -0.19 -0.46  0.02  0.03  0.06 -0.  ]]
SymNet parameters
[-0.75  0.63]
SymNet parameters
[[-0.27  2.13 -1.53 -0.57 -0.09 -0.05 -1.93  0.18  0.16 -0.03 -0.05 -0.09 -1.71  1.78]
 [ 0.87  1.43  0.19  0.55  0.24  0.42 -0.81 -0.8   0.48  0.07 -0.    0.09 -1.28  1.12]]
SymNet parameters
[-0.18 -0.04]
SymNet parameters
[[-1.74e+00 -4.31e-02 -3.10e-02 -1.52e-02 -6.18e-03 -6.57e-03  1.25e+00  2.09e-02
   1.55e-03 -1.74e-03 -7.45e-04 -2.77e-03  6.51e-02 -6.15e-02  2.47e-04]
 [-2.64e+00 -1.24e+00  9.15e-01  3.04e-01  5.42e-02  3.98e-02 -8.58e-01 -1.01e-01
  -2.74e-01  1.16e-02  1.51e-02  3.92e-02  1.48e-01 -1.38e-01  1.53e-03]]
SymNet parameters
[-0.09 -0.11]
SymNet parameters
[[ 1.09e+00  2.72e-01 -2.94e-01 -1.92e-01 -3.75e-02 -2.40e-02 -5.98e-01  5.73e-02
   1.87e-01 -7.71e-03 -1.02e-02 -2.47e-02  8.79e-03 -8.04e-03 -7.86e-04 -2.88e-03]
 [-2.46e+00  3.32e-01  1.07e-01 -1.05e-01 -2.38e-02 -1.47e-02 -1.48e-01  3.81e-02
   1.10e-01 -5.88e-03 -6.49e-03 -1.34e-02  8.33e-02 -7.94e-02  5.94e-04 -3.97e-03]]
SymNet parameters
[-0.33 -0.23]
SymNet parameters
[[ 0.5   0.36  0.15 -0.05 -0.02  0.03 -0.01  0.04  0.08 -0.   -0.01 -0.01  0.04 -0.38
   0.01 -0.47 -0.79]]
SymNet parameters
[-0.07]
SymNet parameters
[[ 2.34e-01 -3.88e-01 -2.31e-01  5.17e-03 -1.35e-02  5.67e-03 -7.71e-01  4.18e-01
   6.73e-01  2.30e-02 -6.05e-02  2.16e-01]
 [ 1.59e-01  8.59e-03 -1.22e-03 -1.14e-03 -4.92e-04 -3.94e-04 -1.25e+00 -1.17e-01
  -1.15e-02  1.69e-03 -1.25e-03  3.92e-04]]
SymNet parameters
[-0.3   0.12]
SymNet parameters
[[ 4.52e-02  5.59e-02 -1.29e-01 -6.02e-04 -3.03e-03 -2.08e-03  1.18e-01 -2.08e+00
  -5.10e-01  7.26e-04 -3.74e-02  1.02e-01  6.56e-02]
 [ 1.07e+00  1.88e-02  3.60e-02 -4.32e-04  3.43e-04 -4.40e-04  1.04e-01 -5.50e-02
  -2.50e-02 -1.32e-03  7.64e-03 -2.47e-02  9.19e-03]]
SymNet parameters
[1.19 0.47]
SymNet parameters
[[ 2.74e-01 -6.18e-02 -4.97e-01  2.42e-03 -1.47e-02 -4.22e-03 -9.92e-01  1.01e+00
  -1.16e+00  2.23e-02 -1.23e-01  4.09e-01  7.15e-03 -1.98e-02]
 [ 6.50e-01  3.55e-02  8.00e-03  1.34e-04  2.80e-03 -8.90e-04 -1.22e+00  9.22e-02
   5.71e-02  3.26e-04  1.69e-03 -8.45e-03 -1.62e-02  1.14e-03]]
SymNet parameters
[-0.37  0.53]
SymNet parameters
[[ 2.82e-01 -2.85e-01 -4.45e-01  1.09e-02 -1.55e-02  5.10e-03 -6.43e-01 -2.97e+00
  -2.09e-01  1.46e-02  2.05e-01  3.84e-01  1.11e-01  2.92e-02 -2.13e-02]
 [-3.55e+00  7.49e-02  2.44e-01 -5.63e-03  2.35e-03  5.39e-03 -1.79e-01  1.12e-01
  -1.11e-01 -8.63e-03 -3.21e-03  7.06e-02 -3.93e-02 -9.31e-03  1.17e-02]]
SymNet parameters
[ 0.15 -0.13]
SymNet parameters
[[ 2.50e-01  1.23e+00 -1.16e-01 -9.78e-03  2.77e-02 -2.69e-02  8.32e-01  4.64e-01
   2.00e+00 -3.91e-02 -9.45e-03 -3.63e-03  6.11e-03  2.59e-01  9.63e-04  5.85e-02]
 [ 1.75e-02  4.43e-03 -1.80e-02 -3.12e-04 -1.35e-03  2.44e-04 -1.10e+00 -2.18e-02
  -6.58e-02 -1.24e-03 -3.19e-03  1.18e-02 -1.08e-02 -1.43e-02  1.19e-02  1.19e-03]]
SymNet parameters
[0.17 0.21]
SymNet parameters
[[-5.02e-01 -3.66e-02 -3.38e-02  9.70e-04 -1.23e-03  7.80e-05 -1.59e-01  4.48e-01
  -1.30e-01  5.44e-02 -7.80e-03  7.70e-02  4.08e-01  3.59e-01 -2.22e-01 -3.31e-03
   1.42e-01]]
SymNet parameters
[-0.24]
finally, finish this stage
iter:     0    time: 86.62
Func: 1.71e-01  |g|: 1.58e+01
stableloss: 1.78e-02   dataloss: 1.51e-01   sparseloss: 9.71e+01 momentloss: 6.51e+00
current expression:
[u00*u01, u10*v00, u20, u02, u00*u01**2, u00, u10, u01*u10*v00, u00*u11*v00, u00**2*u01, 1, u00**3, u00**2*u10, v01, u10*v00*v10, u01, u01*u10, u00*u01*v00, u00*u10*v01, u00*u01*u10*v00]
[-0.98 -0.98  0.05  0.05  0.02  0.02  0.01  0.01  0.01 -0.01  0.01 -0.01 -0.01  0.01
  0.    0.   -0.   -0.    0.    0.  ]
[v00*v10, u00*v01, v02, v20, v00, v00*v10**2, u00*v00*v11, u00*u01*v01, u10*v00*v01, u00*v01*v10, u01, u10*v01, v10**2, u10, u00**2*v00, u00*v00, v00**3, u00*v00*v10, v00**2*v20, u00**2*v01]
[-0.98 -0.97  0.05  0.05  0.01  0.01  0.01  0.01  0.01  0.01  0.01 -0.01 -0.    0.
 -0.    0.   -0.   -0.    0.   -0.  ]
block:  4
name:  burgers-2-upwind-sparse0-noise0.001-id0
device:  cuda:0
generate a random number to check random seed:  -0.6218598307152013
current stage is: block-4
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.9234, device='cuda:0', dtype=torch.float64)
u_obs variance
tensor([ 0.2322,  1.6070,  1.5164, 21.9400,  9.4588, 18.1546,  0.2423,  1.5694,
         1.5987, 18.8031, 10.0064, 21.1546], device='cuda:0',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 0.404671
         Iterations: 0
         Function evaluations: 15
         Gradient evaluations: 3
convolution moment and kernels
[[ 1.00e+00  0.00e+00  2.25e-05  1.79e-03 -2.78e-02]
 [ 0.00e+00 -5.32e-05 -1.32e-03  1.07e-03 -2.64e-03]
 [ 6.99e-05  2.15e-03  3.68e-03  7.78e-04 -1.32e-03]
 [ 5.88e-02  8.22e-04 -4.25e-03 -9.54e-04  4.53e-03]
 [-5.87e-02  2.87e-03 -3.86e-03 -1.07e-02  3.89e-03]]
[[ 0.01 -0.02 -0.07  0.   -0.  ]
 [-0.03  0.11  0.19  0.02  0.01]
 [ 0.03 -0.11  0.72  0.03 -0.03]
 [-0.05  0.18 -0.02  0.07 -0.  ]
 [ 0.01 -0.05  0.03 -0.02  0.  ]]
[[ 0.00e+00  1.00e+00  0.00e+00 -9.74e-02 -6.84e-02]
 [ 0.00e+00  0.00e+00 -2.65e-03  1.13e-03  1.01e-03]
 [ 0.00e+00  4.33e-03 -1.92e-04  9.73e-03 -6.61e-03]
 [ 3.41e-03  2.29e-03  9.02e-04 -3.19e-03 -2.96e-03]
 [ 1.32e-02 -3.01e-02 -3.41e-03 -1.25e-02 -1.38e-03]]
[[ 0.    0.    0.03 -0.02 -0.  ]
 [-0.03  0.02 -0.13  0.08  0.01]
 [ 0.11 -0.52 -0.23  0.95 -0.22]
 [-0.02 -0.   -0.08  0.03  0.02]
 [ 0.    0.01  0.01  0.   -0.01]]
[[ 0.00e+00  0.00e+00  0.00e+00  9.43e-03  6.06e-03]
 [ 1.00e+00  0.00e+00  1.96e-02 -1.91e-03 -6.25e-03]
 [ 0.00e+00 -2.24e-03  2.45e-03 -2.66e-03  1.12e-04]
 [-8.93e-02  5.85e-04  6.98e-03 -9.25e-04 -1.75e-02]
 [-5.86e-02  1.39e-03 -9.10e-03 -8.69e-04 -2.68e-03]]
[[ 6.78e-03 -3.84e-02  1.31e-01 -3.60e-02  6.22e-03]
 [-6.13e-03  6.05e-02 -6.21e-01  4.93e-02 -4.53e-03]
 [-9.48e-03 -3.83e-02 -2.61e-01 -4.15e-02 -9.35e-04]
 [ 1.99e-02 -3.02e-02  1.02e+00 -4.15e-02  2.10e-02]
 [-9.69e-03  3.16e-02 -2.34e-01  3.60e-02 -1.09e-02]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00 -3.85e-03]
 [ 0.00e+00  0.00e+00  0.00e+00 -1.24e-03  4.47e-04]
 [ 0.00e+00  0.00e+00  2.92e-03 -1.24e-03 -1.30e-03]
 [ 0.00e+00 -9.05e-04 -7.18e-04  1.14e-03  2.33e-05]
 [ 1.89e-03 -3.10e-03 -2.26e-03  1.67e-03 -1.78e-03]]
[[-2.23e-03  6.57e-03 -2.61e-03  8.46e-04 -6.92e-04]
 [ 8.22e-03 -1.81e-02 -7.49e-03  9.91e-03 -6.30e-05]
 [-1.01e-01  1.38e+00 -2.50e+00  1.33e+00 -8.47e-02]
 [ 1.08e-02 -2.36e-02 -7.78e-03  1.48e-02 -1.75e-03]
 [-2.98e-03  7.77e-03 -1.12e-03 -1.86e-03  6.61e-05]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00 -6.57e-04]
 [ 0.00e+00  1.00e+00  0.00e+00 -6.51e-04 -2.58e-03]
 [ 0.00e+00  0.00e+00  1.25e-03 -6.63e-04 -1.80e-03]
 [ 0.00e+00 -1.00e-03 -1.77e-03  1.60e-03  3.42e-03]
 [ 3.26e-03 -8.55e-04 -3.01e-03  1.43e-03  4.47e-03]]
[[ 0.01 -0.07  0.03  0.04 -0.  ]
 [-0.07  0.51 -0.13 -0.36  0.04]
 [ 0.03 -0.14  0.26 -0.16  0.04]
 [ 0.03 -0.33 -0.2   0.58 -0.09]
 [-0.    0.03  0.05 -0.09  0.02]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  1.55e-03]
 [ 0.00e+00  0.00e+00  0.00e+00 -6.44e-04 -9.23e-04]
 [ 1.00e+00  0.00e+00  1.59e-03  4.54e-04  8.28e-04]
 [ 0.00e+00 -9.50e-04 -7.04e-04  9.14e-04  1.02e-03]
 [-2.40e-03 -7.01e-04  1.19e-03 -1.82e-03 -7.29e-03]]
[[-0.01  0.03 -0.14  0.04 -0.01]
 [ 0.03 -0.12  1.54 -0.14  0.04]
 [-0.04  0.17 -2.79  0.19 -0.05]
 [ 0.03 -0.11  1.52 -0.12  0.03]
 [-0.01  0.03 -0.13  0.03 -0.01]]
SymNet parameters
[[ 0.64 -2.22 -0.93  0.69  0.07  0.09 -1.02 -0.24 -0.67  0.03  0.04  0.09]
 [-0.14  0.08 -0.11 -0.07 -0.02 -0.   -1.14  0.    0.08 -0.   -0.   -0.01]]
SymNet parameters
[ 1.2  -0.51]
SymNet parameters
[[-0.25  0.14 -0.16 -0.09 -0.02 -0.01 -1.67  0.02  0.09 -0.   -0.01 -0.01  0.  ]
 [ 0.54 -1.6  -0.7   0.5   0.09  0.08 -0.78 -0.19 -0.46  0.02  0.03  0.06 -0.  ]]
SymNet parameters
[-0.75  0.63]
SymNet parameters
[[-0.27  2.13 -1.53 -0.57 -0.09 -0.05 -1.93  0.18  0.16 -0.03 -0.05 -0.09 -1.71  1.78]
 [ 0.87  1.43  0.19  0.55  0.24  0.42 -0.81 -0.8   0.48  0.07 -0.    0.09 -1.28  1.12]]
SymNet parameters
[-0.18 -0.04]
SymNet parameters
[[-1.74e+00 -4.31e-02 -3.10e-02 -1.53e-02 -6.18e-03 -6.62e-03  1.25e+00  2.10e-02
   1.55e-03 -1.73e-03 -7.41e-04 -2.78e-03  6.51e-02 -6.14e-02  5.04e-04]
 [-2.64e+00 -1.24e+00  9.15e-01  3.04e-01  5.42e-02  3.98e-02 -8.58e-01 -1.01e-01
  -2.74e-01  1.16e-02  1.51e-02  3.92e-02  1.48e-01 -1.38e-01  1.87e-03]]
SymNet parameters
[-0.09 -0.11]
SymNet parameters
[[ 1.09e+00  2.72e-01 -2.94e-01 -1.92e-01 -3.75e-02 -2.40e-02 -5.98e-01  5.73e-02
   1.87e-01 -7.71e-03 -1.02e-02 -2.47e-02  8.81e-03 -8.04e-03  3.45e-05 -2.93e-03]
 [-2.46e+00  3.32e-01  1.07e-01 -1.05e-01 -2.38e-02 -1.46e-02 -1.48e-01  3.81e-02
   1.10e-01 -5.89e-03 -6.50e-03 -1.34e-02  8.32e-02 -7.94e-02  3.90e-04 -3.82e-03]]
SymNet parameters
[-0.33 -0.23]
SymNet parameters
[[ 0.5   0.36  0.15 -0.05 -0.02  0.03 -0.01  0.04  0.08 -0.   -0.01 -0.01  0.04 -0.38
   0.01 -0.47 -0.79]]
SymNet parameters
[-0.07]
SymNet parameters
[[ 2.34e-01 -3.88e-01 -2.31e-01  5.18e-03 -1.35e-02  5.68e-03 -7.71e-01  4.18e-01
   6.73e-01  2.30e-02 -6.05e-02  2.16e-01]
 [ 1.59e-01  8.58e-03 -1.22e-03 -1.15e-03 -5.02e-04 -3.96e-04 -1.25e+00 -1.17e-01
  -1.15e-02  1.70e-03 -1.25e-03  4.19e-04]]
SymNet parameters
[-0.3   0.12]
SymNet parameters
[[ 4.52e-02  5.59e-02 -1.29e-01 -6.02e-04 -3.03e-03 -2.08e-03  1.18e-01 -2.08e+00
  -5.10e-01  7.19e-04 -3.74e-02  1.01e-01  6.56e-02]
 [ 1.07e+00  1.88e-02  3.60e-02 -4.18e-04  3.48e-04 -4.24e-04  1.04e-01 -5.50e-02
  -2.50e-02 -1.32e-03  7.64e-03 -2.47e-02  9.17e-03]]
SymNet parameters
[1.19 0.47]
SymNet parameters
[[ 2.74e-01 -6.18e-02 -4.97e-01  2.42e-03 -1.47e-02 -4.22e-03 -9.92e-01  1.01e+00
  -1.16e+00  2.23e-02 -1.23e-01  4.09e-01  7.15e-03 -1.98e-02]
 [ 6.50e-01  3.55e-02  8.00e-03  1.33e-04  2.81e-03 -8.96e-04 -1.22e+00  9.22e-02
   5.71e-02  3.26e-04  1.69e-03 -8.44e-03 -1.61e-02  1.16e-03]]
SymNet parameters
[-0.37  0.53]
SymNet parameters
[[ 2.82e-01 -2.85e-01 -4.45e-01  1.09e-02 -1.55e-02  5.10e-03 -6.43e-01 -2.97e+00
  -2.09e-01  1.46e-02  2.05e-01  3.84e-01  1.11e-01  2.92e-02 -2.13e-02]
 [-3.55e+00  7.49e-02  2.44e-01 -5.63e-03  2.35e-03  5.39e-03 -1.79e-01  1.12e-01
  -1.11e-01 -8.63e-03 -3.21e-03  7.06e-02 -3.93e-02 -9.32e-03  1.17e-02]]
SymNet parameters
[ 0.15 -0.13]
SymNet parameters
[[ 2.50e-01  1.23e+00 -1.16e-01 -9.77e-03  2.77e-02 -2.69e-02  8.32e-01  4.64e-01
   2.00e+00 -3.91e-02 -9.45e-03 -3.63e-03  6.11e-03  2.59e-01  9.61e-04  5.85e-02]
 [ 1.75e-02  4.43e-03 -1.80e-02 -3.16e-04 -1.35e-03  2.39e-04 -1.10e+00 -2.18e-02
  -6.58e-02 -1.24e-03 -3.19e-03  1.18e-02 -1.08e-02 -1.43e-02  1.19e-02  1.14e-03]]
SymNet parameters
[0.17 0.21]
SymNet parameters
[[-5.02e-01 -3.66e-02 -3.38e-02  9.71e-04 -1.22e-03  8.04e-05 -1.59e-01  4.48e-01
  -1.30e-01  5.44e-02 -7.80e-03  7.69e-02  4.08e-01  3.59e-01 -2.22e-01 -3.20e-03
   1.42e-01]]
SymNet parameters
[-0.24]
finally, finish this stage
iter:     0    time: 88.58
Func: 4.05e-01  |g|: 1.38e+02
stableloss: 3.35e-02   dataloss: 3.79e-01   sparseloss: 9.71e+01 momentloss: 6.51e+00
current expression:
[u00*u01, u10*v00, u20, u02, u00*u01**2, u00, u10, u01*u10*v00, u00*u11*v00, u00**2*u01, 1, u00**3, u00**2*u10, v01, u10*v00*v10, u01, u01*u10, u00*u01*v00, u00*u10*v01, u00*u01*u10*v00]
[-0.98 -0.98  0.05  0.05  0.02  0.02  0.01  0.01  0.01 -0.01  0.01 -0.01 -0.01  0.01
  0.    0.   -0.   -0.    0.    0.  ]
[v00*v10, u00*v01, v02, v20, v00, v00*v10**2, u00*v00*v11, u00*u01*v01, u10*v00*v01, u00*v01*v10, u01, u10*v01, v10**2, u10, u00**2*v00, u00*v00, v00**3, u00*v00*v10, v00**2*v20, u00**2*v01]
[-0.98 -0.97  0.05  0.05  0.01  0.01  0.01  0.01  0.01  0.01  0.01 -0.01 -0.    0.
 -0.    0.   -0.   -0.    0.   -0.  ]
block:  5
name:  burgers-2-upwind-sparse0-noise0.001-id0
device:  cuda:0
generate a random number to check random seed:  -2.4134721914330397
current stage is: block-5
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.8669, device='cuda:0', dtype=torch.float64)
u_obs variance
tensor([ 0.2473,  1.6075,  1.4922, 20.5900,  9.1376, 17.6651,  0.2457,  1.5480,
         1.5608, 18.0607,  9.0067, 21.5025], device='cuda:0',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
iter:     0    time: 86.53
Func: 5.05e-01  |g|: 4.11e+01
stableloss: 4.68e-02   dataloss: 4.72e-01   sparseloss: 9.71e+01 momentloss: 6.51e+00
iter:   200    time: 27.59
Func: 3.78e-01  |g|: 1.36e+00
stableloss: 4.47e-02   dataloss: 3.37e-01   sparseloss: 9.65e+01 momentloss: 8.17e+00
iter:   400    time: 27.32
Func: 3.69e-01  |g|: 3.09e-01
stableloss: 4.35e-02   dataloss: 3.28e-01   sparseloss: 9.99e+01 momentloss: 8.17e+00
iter:   600    time: 27.21
Func: 3.66e-01  |g|: 7.48e-01
stableloss: 4.31e-02   dataloss: 3.24e-01   sparseloss: 1.11e+02 momentloss: 8.37e+00
iter:   800    time: 27.62
Func: 3.61e-01  |g|: 1.48e+00
stableloss: 4.22e-02   dataloss: 3.20e-01   sparseloss: 1.18e+02 momentloss: 8.20e+00
iter:  1000    time: 27.39
Func: 3.55e-01  |g|: 2.32e+00
stableloss: 4.27e-02   dataloss: 3.14e-01   sparseloss: 1.04e+02 momentloss: 8.13e+00
iter:  1200    time: 27.30
Func: 3.51e-01  |g|: 1.11e+00
stableloss: 4.32e-02   dataloss: 3.10e-01   sparseloss: 1.01e+02 momentloss: 8.23e+00
iter:  1400    time: 27.27
Func: 3.49e-01  |g|: 1.27e+00
stableloss: 4.35e-02   dataloss: 3.08e-01   sparseloss: 1.07e+02 momentloss: 8.28e+00
iter:  1600    time: 27.37
Func: 3.49e-01  |g|: 1.72e-01
stableloss: 4.36e-02   dataloss: 3.07e-01   sparseloss: 1.10e+02 momentloss: 8.28e+00
iter:  1800    time: 27.50
Func: 3.49e-01  |g|: 1.15e-01
stableloss: 4.36e-02   dataloss: 3.07e-01   sparseloss: 1.11e+02 momentloss: 8.27e+00
Warning: Maximum number of iterations has been exceeded.
         Current function value: 0.348510
         Iterations: 2000
         Function evaluations: 2016
         Gradient evaluations: 2006
convolution moment and kernels
[[ 1.00e+00  0.00e+00  1.34e-03  2.75e-03 -7.29e-02]
 [ 0.00e+00  9.40e-04 -4.38e-04 -7.61e-03 -3.68e-02]
 [-6.57e-04 -9.85e-04  2.80e-02 -5.87e-03 -6.56e-03]
 [-1.31e-01 -8.09e-04  8.10e-04  5.61e-03 -1.36e-03]
 [-7.68e-02  2.92e-02  6.58e-03  2.89e-02  1.32e-03]]
[[-0.01  0.01 -0.02  0.    0.01]
 [ 0.05 -0.05  0.2   0.01 -0.04]
 [-0.13  0.23  0.32  0.08  0.03]
 [ 0.02  0.11  0.19  0.22 -0.1 ]
 [-0.01  0.   -0.13 -0.02  0.02]]
[[ 0.00e+00  1.00e+00  0.00e+00 -8.68e-02 -6.75e-02]
 [ 0.00e+00  0.00e+00  2.45e-03  1.09e-02  8.74e-03]
 [ 0.00e+00  2.96e-02  1.82e-02  3.62e-02 -1.05e-02]
 [ 2.21e-02 -9.43e-03 -5.95e-03 -3.65e-03  1.66e-03]
 [ 4.75e-03 -1.17e-02  1.30e-02 -1.24e-03 -3.27e-04]]
[[-8.01e-04  2.25e-02 -4.02e-02  1.29e-02 -7.43e-04]
 [-2.86e-02  1.15e-02 -1.01e-02  2.96e-02  8.05e-04]
 [ 1.18e-01 -5.39e-01 -3.11e-01  9.71e-01 -2.10e-01]
 [-3.09e-02  7.61e-03 -4.22e-02  7.17e-03  1.72e-02]
 [ 1.88e-03  1.40e-02 -9.78e-04  2.81e-03 -1.96e-03]]
[[ 0.00e+00  0.00e+00  0.00e+00  1.85e-02  1.44e-02]
 [ 1.00e+00  0.00e+00  1.58e-02 -5.70e-03 -2.75e-02]
 [ 0.00e+00  8.63e-04  8.40e-03 -8.28e-03  6.00e-03]
 [-9.78e-02 -2.92e-03  5.15e-03 -1.04e-02 -2.53e-02]
 [-5.54e-02  1.05e-02  4.60e-03  2.06e-03  2.92e-03]]
[[ 9.80e-03 -4.80e-02  1.47e-01 -4.71e-02  1.53e-02]
 [-2.90e-04  2.91e-02 -5.75e-01  2.23e-02 -1.89e-02]
 [-4.39e-03 -4.78e-02 -2.48e-01 -6.94e-02  3.70e-02]
 [ 6.62e-03 -2.85e-03  1.01e+00 -2.83e-02  2.84e-04]
 [-6.63e-03  3.06e-02 -2.48e-01  4.66e-02 -1.01e-02]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00  4.10e-03]
 [ 0.00e+00  0.00e+00  0.00e+00 -5.33e-03  1.49e-01]
 [ 0.00e+00  0.00e+00 -1.30e-03  3.70e-02  7.18e-03]
 [ 0.00e+00  4.87e-03  5.96e-02  5.14e-04 -3.16e-01]
 [ 7.43e-04 -2.89e-03  3.40e-03 -4.28e-03 -1.89e-02]]
[[ 0.16 -0.64  0.97 -0.63  0.15]
 [-0.37  1.44 -2.1   1.32 -0.3 ]
 [-0.16  1.77 -3.32  1.98 -0.27]
 [ 0.48 -2.05  3.19 -2.16  0.54]
 [-0.19  0.8  -1.22  0.81 -0.2 ]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  3.33e-03]
 [ 0.00e+00  1.00e+00  0.00e+00 -7.46e-03  1.46e-01]
 [ 0.00e+00  0.00e+00  9.39e-04 -1.16e-03  2.08e-03]
 [ 0.00e+00 -4.44e-03 -9.33e-03  1.41e-02 -3.94e-02]
 [-9.90e-04  6.40e-02 -4.44e-04 -5.11e-03 -4.61e-02]]
[[ 0.   -0.05 -0.1   0.18 -0.03]
 [-0.05  0.44  0.32 -0.87  0.15]
 [-0.23  0.82 -1.66  1.39 -0.32]
 [ 0.36 -1.56  1.92 -1.    0.29]
 [-0.08  0.32 -0.46  0.29 -0.07]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  8.03e-03]
 [ 0.00e+00  0.00e+00  0.00e+00 -7.78e-03 -1.66e-01]
 [ 1.00e+00  0.00e+00  5.36e-03  6.31e-03 -5.27e-04]
 [ 0.00e+00  2.37e-03  1.42e-03  7.67e-04  3.38e-01]
 [-8.34e-03 -2.43e-02 -5.81e-02  1.72e-03  6.58e-03]]
[[-0.17  0.64 -1.    0.61 -0.17]
 [ 0.41 -1.42  3.29 -1.31  0.4 ]
 [ 0.07 -0.59 -1.35 -0.77  0.09]
 [-0.49  2.15 -2.08  2.29 -0.51]
 [ 0.19 -0.82  1.19 -0.85  0.2 ]]
SymNet parameters
[[-2.38e-01 -1.01e-01 -2.71e+00  1.90e-01 -1.38e-01  1.55e-01 -1.63e+00 -1.68e-01
  -2.59e-01  3.69e-03  8.91e-03  1.90e-02]
 [ 3.02e-02  1.72e-02  1.34e-02  1.89e-03 -4.43e-03  9.86e-03 -7.30e-01 -1.55e-02
   1.17e-02  6.25e-04 -1.35e-04  1.21e-03]]
SymNet parameters
[ 0.23 -0.17]
SymNet parameters
[[-3.80e-02  2.59e-02  2.65e-02  1.23e-02 -2.47e-03  6.10e-03 -9.26e-01  2.25e-02
   3.28e-02  9.10e-04  2.04e-03  1.21e-03  1.83e-03]
 [-5.31e-01 -1.19e-01 -2.31e+00  1.41e-01  1.42e-02  1.52e-01 -9.55e-01 -1.88e-01
  -2.05e-01 -1.95e-04 -1.88e-03  1.73e-02 -2.15e-02]]
SymNet parameters
[-0.29  0.47]
SymNet parameters
[[-3.24e-01  2.49e+00 -5.44e+00 -3.98e-01  2.57e-01 -1.97e-01 -5.73e+00  3.86e-01
   1.20e+00  2.18e-02  2.58e-02  1.38e-02  2.81e-01 -1.50e-01]
 [-9.72e+00  2.14e+00  1.18e+00  7.78e-02 -1.05e-01  4.74e-01  3.32e+00 -2.11e-01
   1.15e+00  1.38e-02 -5.41e-03  2.91e-02  1.89e-01 -1.13e-01]]
SymNet parameters
[ 0.98 -0.51]
SymNet parameters
[[-4.77e-01 -4.10e-01 -1.21e-01 -8.31e-02  3.83e-02 -5.62e-02  9.11e-01  7.74e-02
   1.74e-01 -2.81e-03 -3.36e-03 -6.58e-03  7.69e-02 -7.25e-02 -2.40e-04]
 [-1.53e+00  1.71e-02  2.20e-02  3.11e-03 -4.03e-03  1.01e-02 -4.51e-01 -7.54e-03
   1.68e-02 -2.39e-03 -1.45e-03  1.45e-03  1.15e-03 -9.16e-03  1.51e-05]]
SymNet parameters
[-0.14  0.55]
SymNet parameters
[[ 1.01e+00  3.85e-02 -2.28e-02  1.87e-03 -2.48e-03  1.11e-02 -3.88e-01 -7.69e-03
   3.44e-02  3.73e-04  4.58e-04  1.89e-03  6.95e-03 -9.97e-03  1.46e-04 -2.65e-02]
 [-4.94e-01  5.14e-01  6.09e-02 -7.26e-02  3.19e-02 -4.20e-02  7.13e-01  6.02e-02
   1.67e-01 -3.78e-03 -4.27e-03 -6.42e-03 -2.52e-02  1.45e-03 -5.01e-04 -1.02e-02]]
SymNet parameters
[-0.21 -0.34]
SymNet parameters
[[-2.09e-01 -2.50e-01  1.73e-01  1.57e-02  1.72e-02  1.66e-02  3.58e-01  3.81e-02
   4.15e-02 -3.05e-04 -1.01e-03 -3.86e-03 -2.86e-01 -1.44e-01  3.30e-03 -6.56e-01
  -9.75e-01]]
SymNet parameters
[-0.01]
SymNet parameters
[[-1.07e-01 -9.57e-02  5.72e-02  4.92e-03  5.44e-04 -5.24e-03  4.68e-01 -6.11e-01
   8.97e-02  2.38e-02 -3.32e-02  8.64e-02]
 [ 5.14e-02 -2.55e-01 -8.72e-02 -1.24e-02 -1.66e-02  7.43e-03 -2.98e+00 -4.61e-01
  -2.34e-01 -7.47e-02 -3.36e-02 -1.03e-01]]
SymNet parameters
[ 0.94 -1.08]
SymNet parameters
[[-1.61e-01  1.20e-01 -4.68e-01 -1.86e-02 -3.27e-02  1.06e-02  2.87e-01 -1.20e+00
   1.89e-01 -1.82e-01 -1.38e-01 -4.56e-01 -1.01e-02]
 [ 1.67e+00  2.94e-02  1.27e-01  3.19e-03  7.64e-03  3.36e-03  3.20e-01  1.04e-01
   5.42e-02  1.07e-02 -5.61e-04 -1.76e-02  3.78e-03]]
SymNet parameters
[1.37 1.21]
SymNet parameters
[[ 1.09e+00  1.23e-01  2.53e-01 -3.25e-02  6.92e-03  1.77e-02  7.08e-01  2.79e-01
  -1.50e+00  1.03e-01 -7.65e-02  2.20e-01  2.07e-01  9.25e-03]
 [-6.51e-02 -1.72e-03 -4.99e-02 -4.60e-03 -4.30e-03  2.16e-03 -1.77e+00 -7.48e-02
  -6.28e-02 -3.62e-03 -4.05e-03 -1.25e-02 -2.29e-03  1.04e-02]]
SymNet parameters
[-0.6  -0.74]
SymNet parameters
[[-3.68e-02  3.87e-03  1.95e-02 -9.51e-03 -4.51e-03  8.28e-03  2.66e+00 -3.27e+00
  -1.20e-01  3.51e-02  2.31e-03  7.29e-02  1.68e-01  2.06e-02  7.68e-03]
 [-3.86e+00 -4.26e-02  2.76e-02  1.27e-03 -1.47e-03  4.38e-03  6.61e-02 -2.54e-02
   6.52e-02 -5.75e-03 -6.59e-03 -5.36e-03  3.07e-03  2.48e-02 -6.53e-03]]
SymNet parameters
[ 1.38 -0.89]
SymNet parameters
[[ 3.30e+00  1.66e-01  1.82e-01 -3.61e-02  4.94e-03  1.66e-02  3.77e-01  6.20e-01
   2.08e+00  8.99e-02 -4.56e-02  1.68e-01  1.98e-01  6.61e-02 -1.60e-04  3.18e-02]
 [ 2.63e-02 -5.07e-03  2.66e-02  5.57e-03  3.88e-03 -3.08e-03 -1.93e+00 -3.77e-02
   5.19e-02  1.26e-03  6.92e-03  4.42e-03 -8.49e-03 -1.16e-02  1.74e-02 -5.09e-04]]
SymNet parameters
[ 0.16 -0.14]
SymNet parameters
[[-0.45 -0.01  0.    0.01  0.   -0.    0.14  0.22  0.23  0.05  0.01  0.05  0.03  0.02
  -0.14 -0.07  0.15]]
SymNet parameters
[-0.01]
finally, finish this stage
iter:  2000    time: 27.43
Func: 3.49e-01  |g|: 2.91e-01
stableloss: 4.37e-02   dataloss: 3.07e-01   sparseloss: 1.12e+02 momentloss: 8.30e+00
current expression:
[u00*u01, u10*v00, u02, u20, u00*u01**2, u00*u11*v00, u01*u10*v00, u01*u10, u10*v00*v10, u00*u10*v01, u00, u10*v10, u01, u00*u01*v00, u00*u10*v00, u00**3, u00**2*u10, u10, u00*v00, u20*v00**2]
[-0.98 -0.98  0.05  0.05  0.01  0.01  0.01  0.01  0.01  0.01  0.01  0.01  0.01 -0.
 -0.   -0.    0.    0.    0.    0.  ]
[v00*v10, u00*v01, v02, v20, v00*v10**2, u00*v00*v10, u00*v00*v11, u00*u01*v01, u00*v01*v10, u10*v01, v10**2, u10*v00*v01, u00*v00, 1, u00*v10, u00, v00*v01, v10, u00**2, v00**2*v20]
[-0.99 -0.98  0.05  0.05  0.01 -0.01  0.01  0.01  0.01  0.01  0.01  0.01  0.01 -0.01
 -0.    0.    0.    0.    0.    0.  ]
block:  6
name:  burgers-2-upwind-sparse0-noise0.001-id0
device:  cuda:0
generate a random number to check random seed:  0.8188095212990908
current stage is: block-6
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.9626, device='cuda:0', dtype=torch.float64)
u_obs variance
tensor([ 0.2473,  1.6764,  1.5508, 24.5034,  9.4511, 19.5337,  0.2294,  1.5212,
         1.5715, 19.8338, 10.0797, 22.0234], device='cuda:0',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 0.697843
         Iterations: 0
         Function evaluations: 15
         Gradient evaluations: 3
convolution moment and kernels
[[ 1.00e+00  0.00e+00  1.34e-03  2.74e-03 -7.29e-02]
 [ 0.00e+00  9.40e-04 -4.39e-04 -7.61e-03 -3.68e-02]
 [-6.57e-04 -9.85e-04  2.80e-02 -5.87e-03 -6.56e-03]
 [-1.31e-01 -8.09e-04  8.10e-04  5.61e-03 -1.36e-03]
 [-7.68e-02  2.92e-02  6.58e-03  2.89e-02  1.32e-03]]
[[-0.01  0.01 -0.02  0.    0.01]
 [ 0.05 -0.05  0.2   0.01 -0.04]
 [-0.13  0.23  0.32  0.08  0.03]
 [ 0.02  0.11  0.19  0.22 -0.1 ]
 [-0.01  0.   -0.13 -0.02  0.02]]
[[ 0.00e+00  1.00e+00  0.00e+00 -8.68e-02 -6.75e-02]
 [ 0.00e+00  0.00e+00  2.45e-03  1.09e-02  8.74e-03]
 [ 0.00e+00  2.96e-02  1.82e-02  3.62e-02 -1.05e-02]
 [ 2.21e-02 -9.43e-03 -5.95e-03 -3.65e-03  1.66e-03]
 [ 4.75e-03 -1.17e-02  1.30e-02 -1.24e-03 -3.27e-04]]
[[-8.01e-04  2.25e-02 -4.02e-02  1.29e-02 -7.43e-04]
 [-2.86e-02  1.15e-02 -1.01e-02  2.96e-02  8.03e-04]
 [ 1.18e-01 -5.39e-01 -3.11e-01  9.71e-01 -2.10e-01]
 [-3.09e-02  7.61e-03 -4.22e-02  7.17e-03  1.72e-02]
 [ 1.88e-03  1.40e-02 -9.78e-04  2.81e-03 -1.96e-03]]
[[ 0.00e+00  0.00e+00  0.00e+00  1.85e-02  1.44e-02]
 [ 1.00e+00  0.00e+00  1.58e-02 -5.70e-03 -2.75e-02]
 [ 0.00e+00  8.63e-04  8.40e-03 -8.28e-03  6.00e-03]
 [-9.78e-02 -2.92e-03  5.15e-03 -1.04e-02 -2.53e-02]
 [-5.54e-02  1.05e-02  4.59e-03  2.06e-03  2.92e-03]]
[[ 9.80e-03 -4.80e-02  1.47e-01 -4.71e-02  1.53e-02]
 [-2.92e-04  2.91e-02 -5.75e-01  2.23e-02 -1.89e-02]
 [-4.38e-03 -4.78e-02 -2.48e-01 -6.95e-02  3.70e-02]
 [ 6.61e-03 -2.84e-03  1.01e+00 -2.83e-02  2.80e-04]
 [-6.63e-03  3.06e-02 -2.48e-01  4.66e-02 -1.01e-02]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00  4.10e-03]
 [ 0.00e+00  0.00e+00  0.00e+00 -5.33e-03  1.49e-01]
 [ 0.00e+00  0.00e+00 -1.30e-03  3.70e-02  7.18e-03]
 [ 0.00e+00  4.87e-03  5.96e-02  5.15e-04 -3.16e-01]
 [ 7.43e-04 -2.89e-03  3.40e-03 -4.28e-03 -1.89e-02]]
[[ 0.16 -0.64  0.97 -0.63  0.15]
 [-0.37  1.44 -2.1   1.32 -0.3 ]
 [-0.16  1.77 -3.32  1.98 -0.27]
 [ 0.48 -2.05  3.19 -2.16  0.54]
 [-0.19  0.8  -1.22  0.81 -0.2 ]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  3.33e-03]
 [ 0.00e+00  1.00e+00  0.00e+00 -7.46e-03  1.46e-01]
 [ 0.00e+00  0.00e+00  9.39e-04 -1.16e-03  2.08e-03]
 [ 0.00e+00 -4.44e-03 -9.33e-03  1.41e-02 -3.94e-02]
 [-9.90e-04  6.40e-02 -4.45e-04 -5.11e-03 -4.61e-02]]
[[ 0.   -0.05 -0.1   0.18 -0.03]
 [-0.05  0.44  0.32 -0.87  0.15]
 [-0.23  0.82 -1.66  1.39 -0.32]
 [ 0.36 -1.56  1.92 -1.    0.29]
 [-0.08  0.32 -0.46  0.29 -0.07]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  8.03e-03]
 [ 0.00e+00  0.00e+00  0.00e+00 -7.78e-03 -1.66e-01]
 [ 1.00e+00  0.00e+00  5.36e-03  6.31e-03 -5.27e-04]
 [ 0.00e+00  2.37e-03  1.42e-03  7.67e-04  3.38e-01]
 [-8.34e-03 -2.43e-02 -5.81e-02  1.72e-03  6.58e-03]]
[[-0.17  0.64 -1.    0.61 -0.17]
 [ 0.41 -1.42  3.29 -1.31  0.4 ]
 [ 0.07 -0.59 -1.35 -0.77  0.09]
 [-0.49  2.15 -2.08  2.29 -0.51]
 [ 0.19 -0.82  1.19 -0.85  0.2 ]]
SymNet parameters
[[-2.38e-01 -1.01e-01 -2.71e+00  1.90e-01 -1.38e-01  1.55e-01 -1.63e+00 -1.68e-01
  -2.59e-01  3.69e-03  8.91e-03  1.90e-02]
 [ 3.02e-02  1.72e-02  1.34e-02  1.89e-03 -4.43e-03  9.86e-03 -7.30e-01 -1.55e-02
   1.17e-02  6.28e-04 -1.34e-04  1.21e-03]]
SymNet parameters
[ 0.23 -0.17]
SymNet parameters
[[-3.80e-02  2.59e-02  2.65e-02  1.23e-02 -2.47e-03  6.10e-03 -9.26e-01  2.25e-02
   3.28e-02  9.11e-04  2.04e-03  1.21e-03  1.83e-03]
 [-5.31e-01 -1.19e-01 -2.31e+00  1.41e-01  1.42e-02  1.52e-01 -9.55e-01 -1.88e-01
  -2.05e-01 -1.94e-04 -1.88e-03  1.73e-02 -2.15e-02]]
SymNet parameters
[-0.29  0.47]
SymNet parameters
[[-3.24e-01  2.49e+00 -5.44e+00 -3.98e-01  2.57e-01 -1.97e-01 -5.73e+00  3.86e-01
   1.20e+00  2.18e-02  2.58e-02  1.38e-02  2.81e-01 -1.50e-01]
 [-9.72e+00  2.14e+00  1.18e+00  7.78e-02 -1.05e-01  4.74e-01  3.32e+00 -2.11e-01
   1.15e+00  1.38e-02 -5.41e-03  2.91e-02  1.89e-01 -1.13e-01]]
SymNet parameters
[ 0.98 -0.51]
SymNet parameters
[[-4.77e-01 -4.10e-01 -1.21e-01 -8.31e-02  3.83e-02 -5.62e-02  9.11e-01  7.74e-02
   1.74e-01 -2.81e-03 -3.36e-03 -6.58e-03  7.69e-02 -7.24e-02 -4.83e-04]
 [-1.53e+00  1.71e-02  2.20e-02  3.10e-03 -4.03e-03  1.01e-02 -4.51e-01 -7.55e-03
   1.68e-02 -2.40e-03 -1.45e-03  1.45e-03  1.15e-03 -9.15e-03  1.45e-05]]
SymNet parameters
[-0.14  0.55]
SymNet parameters
[[ 1.01e+00  3.85e-02 -2.28e-02  1.87e-03 -2.48e-03  1.11e-02 -3.88e-01 -7.69e-03
   3.44e-02  3.74e-04  4.59e-04  1.89e-03  6.95e-03 -9.97e-03 -1.66e-04 -2.65e-02]
 [-4.94e-01  5.14e-01  6.09e-02 -7.26e-02  3.19e-02 -4.20e-02  7.13e-01  6.02e-02
   1.67e-01 -3.78e-03 -4.27e-03 -6.42e-03 -2.52e-02  1.44e-03 -2.11e-04 -1.02e-02]]
SymNet parameters
[-0.21 -0.34]
SymNet parameters
[[-2.09e-01 -2.50e-01  1.73e-01  1.57e-02  1.72e-02  1.66e-02  3.58e-01  3.81e-02
   4.15e-02 -3.04e-04 -1.01e-03 -3.86e-03 -2.86e-01 -1.44e-01  3.27e-03 -6.56e-01
  -9.75e-01]]
SymNet parameters
[-0.01]
SymNet parameters
[[-1.07e-01 -9.57e-02  5.72e-02  4.92e-03  5.44e-04 -5.24e-03  4.68e-01 -6.11e-01
   8.97e-02  2.38e-02 -3.32e-02  8.64e-02]
 [ 5.14e-02 -2.55e-01 -8.72e-02 -1.24e-02 -1.66e-02  7.43e-03 -2.98e+00 -4.61e-01
  -2.34e-01 -7.47e-02 -3.36e-02 -1.03e-01]]
SymNet parameters
[ 0.94 -1.08]
SymNet parameters
[[-1.61e-01  1.20e-01 -4.68e-01 -1.86e-02 -3.27e-02  1.06e-02  2.87e-01 -1.20e+00
   1.89e-01 -1.82e-01 -1.38e-01 -4.56e-01 -1.01e-02]
 [ 1.67e+00  2.94e-02  1.27e-01  3.19e-03  7.64e-03  3.36e-03  3.20e-01  1.04e-01
   5.42e-02  1.07e-02 -5.60e-04 -1.76e-02  3.78e-03]]
SymNet parameters
[1.37 1.21]
SymNet parameters
[[ 1.09e+00  1.23e-01  2.53e-01 -3.25e-02  6.92e-03  1.77e-02  7.08e-01  2.79e-01
  -1.50e+00  1.03e-01 -7.65e-02  2.20e-01  2.07e-01  9.26e-03]
 [-6.51e-02 -1.72e-03 -4.99e-02 -4.60e-03 -4.30e-03  2.16e-03 -1.77e+00 -7.48e-02
  -6.28e-02 -3.62e-03 -4.05e-03 -1.25e-02 -2.29e-03  1.04e-02]]
SymNet parameters
[-0.6  -0.74]
SymNet parameters
[[-3.68e-02  3.87e-03  1.95e-02 -9.51e-03 -4.51e-03  8.28e-03  2.66e+00 -3.27e+00
  -1.20e-01  3.51e-02  2.31e-03  7.29e-02  1.68e-01  2.06e-02  7.68e-03]
 [-3.86e+00 -4.26e-02  2.76e-02  1.27e-03 -1.47e-03  4.38e-03  6.61e-02 -2.54e-02
   6.52e-02 -5.75e-03 -6.59e-03 -5.36e-03  3.07e-03  2.48e-02 -6.53e-03]]
SymNet parameters
[ 1.38 -0.89]
SymNet parameters
[[ 3.30e+00  1.66e-01  1.82e-01 -3.61e-02  4.94e-03  1.66e-02  3.77e-01  6.20e-01
   2.08e+00  8.99e-02 -4.56e-02  1.68e-01  1.98e-01  6.61e-02 -1.66e-04  3.18e-02]
 [ 2.63e-02 -5.07e-03  2.66e-02  5.56e-03  3.88e-03 -3.09e-03 -1.93e+00 -3.77e-02
   5.19e-02  1.26e-03  6.92e-03  4.43e-03 -8.50e-03 -1.16e-02  1.74e-02 -5.04e-04]]
SymNet parameters
[ 0.16 -0.14]
SymNet parameters
[[-0.45 -0.01  0.    0.01  0.   -0.    0.14  0.22  0.23  0.05  0.01  0.05  0.03  0.02
  -0.14 -0.07  0.15]]
SymNet parameters
[-0.01]
finally, finish this stage
iter:     0    time: 578.14
Func: 6.98e-01  |g|: 2.67e+02
stableloss: 5.12e-02   dataloss: 6.48e-01   sparseloss: 1.12e+02 momentloss: 8.30e+00
current expression:
[u00*u01, u10*v00, u02, u20, u00*u01**2, u00*u11*v00, u01*u10*v00, u01*u10, u10*v00*v10, u00*u10*v01, u00, u10*v10, u01, u00*u01*v00, u00*u10*v00, u00**3, u00**2*u10, u10, u00*v00, u20*v00**2]
[-0.98 -0.98  0.05  0.05  0.01  0.01  0.01  0.01  0.01  0.01  0.01  0.01  0.01 -0.
 -0.   -0.    0.    0.    0.    0.  ]
[v00*v10, u00*v01, v02, v20, v00*v10**2, u00*v00*v10, u00*v00*v11, u00*u01*v01, u00*v01*v10, u10*v01, v10**2, u10*v00*v01, u00*v00, 1, u00*v10, u00, v00*v01, v10, u00**2, v00**2*v20]
[-0.99 -0.98  0.05  0.05  0.01 -0.01  0.01  0.01  0.01  0.01  0.01  0.01  0.01 -0.01
 -0.    0.    0.    0.    0.    0.  ]
block:  9
name:  burgers-2-upwind-sparse0-noise0.001-id0
device:  cuda:0
generate a random number to check random seed:  -1.6502904278113977
current stage is: block-9
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.6466, device='cuda:0', dtype=torch.float64)
u_obs variance
tensor([ 0.2636,  1.8348,  1.6365, 29.1259, 11.4233, 22.3474,  0.2389,  1.5997,
         1.6397, 22.1598, 11.0667, 24.7162], device='cuda:0',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 1.778523
         Iterations: 0
         Function evaluations: 15
         Gradient evaluations: 3
convolution moment and kernels
[[ 1.00e+00  0.00e+00  1.34e-03  2.75e-03 -7.29e-02]
 [ 0.00e+00  9.40e-04 -4.37e-04 -7.61e-03 -3.68e-02]
 [-6.58e-04 -9.85e-04  2.80e-02 -5.87e-03 -6.56e-03]
 [-1.31e-01 -8.09e-04  8.09e-04  5.61e-03 -1.36e-03]
 [-7.68e-02  2.92e-02  6.58e-03  2.89e-02  1.32e-03]]
[[-0.01  0.01 -0.02  0.    0.01]
 [ 0.05 -0.05  0.2   0.01 -0.04]
 [-0.13  0.23  0.32  0.08  0.03]
 [ 0.02  0.11  0.19  0.22 -0.1 ]
 [-0.01  0.   -0.13 -0.02  0.02]]
[[ 0.00e+00  1.00e+00  0.00e+00 -8.68e-02 -6.75e-02]
 [ 0.00e+00  0.00e+00  2.45e-03  1.09e-02  8.74e-03]
 [ 0.00e+00  2.96e-02  1.82e-02  3.61e-02 -1.05e-02]
 [ 2.21e-02 -9.43e-03 -5.95e-03 -3.65e-03  1.66e-03]
 [ 4.74e-03 -1.17e-02  1.30e-02 -1.24e-03 -3.33e-04]]
[[-8.09e-04  2.25e-02 -4.02e-02  1.29e-02 -7.49e-04]
 [-2.86e-02  1.14e-02 -9.92e-03  2.95e-02  8.28e-04]
 [ 1.18e-01 -5.39e-01 -3.12e-01  9.71e-01 -2.10e-01]
 [-3.09e-02  7.48e-03 -4.20e-02  7.06e-03  1.72e-02]
 [ 1.87e-03  1.41e-02 -1.02e-03  2.84e-03 -1.96e-03]]
[[ 0.00e+00  0.00e+00  0.00e+00  1.85e-02  1.44e-02]
 [ 1.00e+00  0.00e+00  1.58e-02 -5.70e-03 -2.75e-02]
 [ 0.00e+00  8.61e-04  8.40e-03 -8.28e-03  6.01e-03]
 [-9.78e-02 -2.92e-03  5.15e-03 -1.04e-02 -2.53e-02]
 [-5.54e-02  1.05e-02  4.60e-03  2.06e-03  2.91e-03]]
[[ 9.80e-03 -4.80e-02  1.47e-01 -4.71e-02  1.53e-02]
 [-2.81e-04  2.91e-02 -5.75e-01  2.23e-02 -1.88e-02]
 [-4.39e-03 -4.78e-02 -2.48e-01 -6.94e-02  3.70e-02]
 [ 6.62e-03 -2.87e-03  1.01e+00 -2.83e-02  2.94e-04]
 [-6.63e-03  3.06e-02 -2.48e-01  4.66e-02 -1.01e-02]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00  4.10e-03]
 [ 0.00e+00  0.00e+00  0.00e+00 -5.33e-03  1.49e-01]
 [ 0.00e+00  0.00e+00 -1.30e-03  3.70e-02  7.19e-03]
 [ 0.00e+00  4.87e-03  5.96e-02  5.14e-04 -3.16e-01]
 [ 7.42e-04 -2.89e-03  3.40e-03 -4.28e-03 -1.89e-02]]
[[ 0.16 -0.64  0.97 -0.63  0.15]
 [-0.37  1.44 -2.1   1.32 -0.3 ]
 [-0.16  1.77 -3.32  1.98 -0.27]
 [ 0.48 -2.05  3.19 -2.16  0.54]
 [-0.19  0.8  -1.22  0.81 -0.2 ]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  3.33e-03]
 [ 0.00e+00  1.00e+00  0.00e+00 -7.46e-03  1.46e-01]
 [ 0.00e+00  0.00e+00  9.39e-04 -1.16e-03  2.08e-03]
 [ 0.00e+00 -4.44e-03 -9.33e-03  1.41e-02 -3.94e-02]
 [-9.90e-04  6.40e-02 -4.45e-04 -5.11e-03 -4.61e-02]]
[[ 0.   -0.05 -0.1   0.18 -0.03]
 [-0.05  0.44  0.32 -0.87  0.15]
 [-0.23  0.82 -1.66  1.39 -0.32]
 [ 0.36 -1.56  1.92 -1.    0.29]
 [-0.08  0.32 -0.46  0.29 -0.07]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  8.03e-03]
 [ 0.00e+00  0.00e+00  0.00e+00 -7.78e-03 -1.66e-01]
 [ 1.00e+00  0.00e+00  5.36e-03  6.31e-03 -5.27e-04]
 [ 0.00e+00  2.37e-03  1.42e-03  7.67e-04  3.38e-01]
 [-8.34e-03 -2.43e-02 -5.81e-02  1.71e-03  6.58e-03]]
[[-0.17  0.64 -1.    0.61 -0.17]
 [ 0.41 -1.42  3.29 -1.31  0.4 ]
 [ 0.07 -0.59 -1.35 -0.77  0.09]
 [-0.49  2.15 -2.08  2.29 -0.51]
 [ 0.19 -0.82  1.19 -0.85  0.2 ]]
SymNet parameters
[[-2.38e-01 -1.01e-01 -2.71e+00  1.90e-01 -1.38e-01  1.55e-01 -1.63e+00 -1.68e-01
  -2.59e-01  3.69e-03  8.91e-03  1.90e-02]
 [ 3.02e-02  1.72e-02  1.34e-02  1.91e-03 -4.42e-03  9.86e-03 -7.30e-01 -1.55e-02
   1.17e-02  6.42e-04 -1.40e-04  1.22e-03]]
SymNet parameters
[ 0.23 -0.17]
SymNet parameters
[[-3.80e-02  2.59e-02  2.65e-02  1.23e-02 -2.47e-03  6.10e-03 -9.26e-01  2.25e-02
   3.28e-02  9.16e-04  2.04e-03  1.22e-03  1.83e-03]
 [-5.31e-01 -1.19e-01 -2.31e+00  1.41e-01  1.42e-02  1.52e-01 -9.55e-01 -1.88e-01
  -2.05e-01 -1.94e-04 -1.88e-03  1.73e-02 -2.15e-02]]
SymNet parameters
[-0.29  0.47]
SymNet parameters
[[-3.24e-01  2.49e+00 -5.44e+00 -3.98e-01  2.57e-01 -1.97e-01 -5.73e+00  3.86e-01
   1.20e+00  2.18e-02  2.58e-02  1.38e-02  2.81e-01 -1.50e-01]
 [-9.72e+00  2.14e+00  1.18e+00  7.78e-02 -1.05e-01  4.74e-01  3.32e+00 -2.11e-01
   1.15e+00  1.38e-02 -5.41e-03  2.91e-02  1.89e-01 -1.13e-01]]
SymNet parameters
[ 0.98 -0.51]
SymNet parameters
[[-4.77e-01 -4.10e-01 -1.21e-01 -8.31e-02  3.83e-02 -5.62e-02  9.11e-01  7.74e-02
   1.74e-01 -2.80e-03 -3.36e-03 -6.58e-03  7.69e-02 -7.24e-02 -5.05e-04]
 [-1.53e+00  1.71e-02  2.20e-02  3.11e-03 -4.03e-03  1.01e-02 -4.51e-01 -7.54e-03
   1.68e-02 -2.39e-03 -1.44e-03  1.45e-03  1.14e-03 -9.16e-03  1.63e-04]]
SymNet parameters
[-0.14  0.55]
SymNet parameters
[[ 1.01e+00  3.85e-02 -2.28e-02  1.85e-03 -2.48e-03  1.11e-02 -3.88e-01 -7.69e-03
   3.44e-02  3.69e-04  4.65e-04  1.88e-03  6.93e-03 -9.99e-03  4.41e-04 -2.65e-02]
 [-4.94e-01  5.14e-01  6.09e-02 -7.26e-02  3.19e-02 -4.20e-02  7.13e-01  6.02e-02
   1.67e-01 -3.78e-03 -4.27e-03 -6.42e-03 -2.52e-02  1.45e-03 -2.73e-04 -1.02e-02]]
SymNet parameters
[-0.21 -0.34]
SymNet parameters
[[-2.09e-01 -2.50e-01  1.73e-01  1.57e-02  1.72e-02  1.66e-02  3.58e-01  3.81e-02
   4.15e-02 -3.11e-04 -1.01e-03 -3.86e-03 -2.86e-01 -1.44e-01  3.25e-03 -6.56e-01
  -9.75e-01]]
SymNet parameters
[-0.01]
SymNet parameters
[[-1.07e-01 -9.57e-02  5.72e-02  4.93e-03  5.43e-04 -5.24e-03  4.68e-01 -6.11e-01
   8.97e-02  2.38e-02 -3.32e-02  8.64e-02]
 [ 5.14e-02 -2.55e-01 -8.72e-02 -1.24e-02 -1.66e-02  7.43e-03 -2.98e+00 -4.61e-01
  -2.34e-01 -7.47e-02 -3.36e-02 -1.03e-01]]
SymNet parameters
[ 0.94 -1.08]
SymNet parameters
[[-1.61e-01  1.20e-01 -4.68e-01 -1.86e-02 -3.27e-02  1.06e-02  2.87e-01 -1.20e+00
   1.89e-01 -1.82e-01 -1.38e-01 -4.56e-01 -1.01e-02]
 [ 1.67e+00  2.94e-02  1.27e-01  3.19e-03  7.64e-03  3.37e-03  3.20e-01  1.04e-01
   5.42e-02  1.07e-02 -5.61e-04 -1.76e-02  3.78e-03]]
SymNet parameters
[1.37 1.21]
SymNet parameters
[[ 1.09e+00  1.23e-01  2.53e-01 -3.25e-02  6.92e-03  1.77e-02  7.08e-01  2.79e-01
  -1.50e+00  1.03e-01 -7.65e-02  2.20e-01  2.07e-01  9.26e-03]
 [-6.51e-02 -1.72e-03 -4.99e-02 -4.60e-03 -4.30e-03  2.16e-03 -1.77e+00 -7.48e-02
  -6.28e-02 -3.61e-03 -4.05e-03 -1.25e-02 -2.29e-03  1.04e-02]]
SymNet parameters
[-0.6  -0.74]
SymNet parameters
[[-3.68e-02  3.87e-03  1.95e-02 -9.51e-03 -4.51e-03  8.28e-03  2.66e+00 -3.27e+00
  -1.20e-01  3.51e-02  2.31e-03  7.29e-02  1.68e-01  2.06e-02  7.68e-03]
 [-3.86e+00 -4.26e-02  2.76e-02  1.28e-03 -1.47e-03  4.38e-03  6.61e-02 -2.54e-02
   6.52e-02 -5.75e-03 -6.59e-03 -5.36e-03  3.07e-03  2.48e-02 -6.53e-03]]
SymNet parameters
[ 1.38 -0.89]
SymNet parameters
[[ 3.30e+00  1.66e-01  1.82e-01 -3.61e-02  4.94e-03  1.66e-02  3.77e-01  6.20e-01
   2.08e+00  8.99e-02 -4.56e-02  1.68e-01  1.98e-01  6.61e-02 -1.62e-04  3.18e-02]
 [ 2.63e-02 -5.07e-03  2.66e-02  5.56e-03  3.88e-03 -3.09e-03 -1.93e+00 -3.77e-02
   5.20e-02  1.26e-03  6.91e-03  4.42e-03 -8.50e-03 -1.16e-02  1.74e-02 -5.22e-04]]
SymNet parameters
[ 0.16 -0.14]
SymNet parameters
[[-0.45 -0.01  0.    0.01  0.   -0.    0.14  0.22  0.23  0.05  0.01  0.05  0.03  0.02
  -0.14 -0.07  0.15]]
SymNet parameters
[-0.01]
finally, finish this stage
iter:     0    time: 59.99
Func: 1.78e+00  |g|: 2.48e+02
stableloss: 5.70e-02   dataloss: 1.70e+00   sparseloss: 1.12e+02 momentloss: 8.30e+00
current expression:
[u00*u01, u10*v00, u02, u20, u00*u01**2, u00*u11*v00, u01*u10*v00, u01*u10, u10*v00*v10, u00*u10*v01, u00, u10*v10, u01, u00*u01*v00, u00*u10*v00, u00**3, u00**2*u10, u10, u00*v00, u20*v00**2]
[-0.98 -0.98  0.05  0.05  0.01  0.01  0.01  0.01  0.01  0.01  0.01  0.01  0.01 -0.
 -0.   -0.    0.    0.    0.    0.  ]
[v00*v10, u00*v01, v02, v20, v00*v10**2, u00*v00*v10, u00*v00*v11, u00*u01*v01, u00*v01*v10, u10*v01, v10**2, u10*v00*v01, u00*v00, 1, u00*v10, u00, v00*v01, v10, u00**2, v00**2*v20]
[-0.99 -0.98  0.05  0.05  0.01 -0.01  0.01  0.01  0.01  0.01  0.01  0.01  0.01 -0.01
 -0.    0.    0.    0.    0.    0.  ]
u_obs.abs().max()
tensor(3.6896, device='cuda:0', dtype=torch.float64)
model(u_obs[0],T=50*dt).abs().max()
tensor(nan, device='cuda:0', dtype=torch.float64)
model(u_obs[0],T=100*dt).abs().max()
tensor(nan, device='cuda:0', dtype=torch.float64)
{'--name': 'burgers-2-upwind-sparse0-noise0.001-id1', '--dtype': 'double', '--device': 'cuda:1', '--constraint': '2', '--dt': 0.01, '--cell_num': 1, '--eps': 6.283185307179586, '--blocks': [0, 1, 2, 3, 4, 5, 6, 9], '--kernel_size': 5, '--max_order': 2, '--dx': 0.19634954084936207, '--hidden_layers': 5, '--scheme': 'upwind', '--dataname': 'burgers', '--viscosity': 0.05, '--zoom': 4, '--max_dt': 0.000625, '--batch_size': 28, '--data_timescheme': 'rk2', '--channel_names': 'u,v', '--freq': 4, '--data_start_time': 1.0, '--start_noise': 0.001, '--end_noise': 0.001, '--stablize': 0.0, '--sparsity': 0.0, '--momentsparsity': 0.001, '--npseed': -1, '--torchseed': -1, '--maxiter': 2000, '--recordfile': 'None', '--recordcycle': 200, '--savecycle': -1, '--start_from': -1}
block:  0
name:  burgers-2-upwind-sparse0-noise0.001-id1
device:  cuda:1
generate a random number to check random seed:  1.1123008354078343
current stage is: warmup
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.8315, device='cuda:1', dtype=torch.float64)
u_obs variance
tensor([ 0.2598,  2.2448,  2.1582, 21.2142, 10.2133, 18.9921,  0.2520,  1.8997,
         2.1718, 16.3988, 10.5327, 20.2749], device='cuda:1',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
iter:     0    time: 13.85
Func: 6.00e+00  |g|: 3.86e+00
stableloss: 2.38e-03   dataloss: 6.00e+00   sparseloss: 2.66e+01 momentloss: 7.27e+00
iter:   200    time: 15.42
Func: 4.17e-02  |g|: 1.64e-02
stableloss: 1.22e-02   dataloss: 4.17e-02   sparseloss: 4.86e+01 momentloss: 7.27e+00
iter:   400    time: 11.37
Func: 3.86e-02  |g|: 1.57e-02
stableloss: 1.20e-02   dataloss: 3.86e-02   sparseloss: 6.33e+01 momentloss: 7.27e+00
iter:   600    time: 12.62
Func: 3.79e-02  |g|: 9.16e-03
stableloss: 1.20e-02   dataloss: 3.79e-02   sparseloss: 6.81e+01 momentloss: 7.27e+00
iter:   800    time: 10.91
Func: 3.77e-02  |g|: 5.16e-03
stableloss: 1.20e-02   dataloss: 3.77e-02   sparseloss: 6.62e+01 momentloss: 7.27e+00
iter:  1000    time: 9.20
Func: 3.76e-02  |g|: 3.49e-03
stableloss: 1.19e-02   dataloss: 3.76e-02   sparseloss: 6.61e+01 momentloss: 7.27e+00
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 0.037600
         Iterations: 1037
         Function evaluations: 1099
         Gradient evaluations: 1092
convolution moment and kernels
[[1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
[[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 1. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
[[ 0.    1.    0.   -0.33 -0.25]
 [ 0.    0.    0.    0.    0.  ]
 [ 0.    0.    0.    0.    0.  ]
 [ 0.    0.    0.    0.    0.  ]
 [ 0.    0.    0.    0.    0.  ]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]
 [ 2.78e-17  3.33e-16 -1.50e+00  2.00e+00 -5.00e-01]
 [ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]]
[[ 0.    0.    0.    0.    0.  ]
 [ 1.    0.    0.    0.    0.  ]
 [ 0.    0.    0.    0.    0.  ]
 [-0.33  0.    0.    0.    0.  ]
 [-0.25  0.    0.    0.    0.  ]]
[[ 0.00e+00  0.00e+00  2.78e-17  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  3.33e-16  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00 -1.50e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  2.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00 -5.00e-01  0.00e+00  0.00e+00]]
[[0.   0.   1.   0.   0.08]
 [0.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.  ]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]
 [-2.22e-16  1.00e+00 -2.00e+00  1.00e+00 -1.53e-16]
 [ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]]
[[0. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
[[ 6.94e-03 -5.56e-02  9.25e-18  5.56e-02 -6.94e-03]
 [-5.56e-02  4.44e-01 -7.40e-17 -4.44e-01  5.56e-02]
 [ 9.25e-18 -7.40e-17  1.23e-32  7.40e-17 -9.25e-18]
 [ 5.56e-02 -4.44e-01  7.40e-17  4.44e-01 -5.56e-02]
 [-6.94e-03  5.56e-02 -9.25e-18 -5.56e-02  6.94e-03]]
[[0.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.  ]
 [1.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.  ]
 [0.08 0.   0.   0.   0.  ]]
[[ 0.00e+00  0.00e+00 -2.22e-16  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  1.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00 -2.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  1.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00 -1.53e-16  0.00e+00  0.00e+00]]
SymNet parameters
[[ 4.80e-01 -5.18e-02  5.23e-02  3.21e-02 -1.31e-02  9.11e-03  2.85e-02 -3.68e-04
  -1.43e-03  5.38e-04  1.86e-03 -4.07e-03]
 [-3.02e-02 -1.04e-01 -3.52e-01 -1.67e-01 -5.67e-03 -7.57e-02 -5.11e-01  1.23e-02
  -2.68e-02 -6.69e-03 -2.10e-02 -1.53e-02]]
SymNet parameters
[-0.01 -0.07]
SymNet parameters
[[-1.06e-01 -1.47e-01  5.09e-03 -4.80e-02  2.54e-03 -9.20e-03  1.19e+00  3.39e-04
   1.71e-02  3.60e-03 -1.73e-03  7.14e-03 -1.52e-02]
 [-8.50e-01 -4.40e-02  4.58e-01  4.25e-02 -1.82e-02  1.23e-02 -9.09e-02 -1.16e-02
  -2.87e-03  2.44e-03  3.04e-03  1.73e-03  9.00e-02]]
SymNet parameters
[-0.  -0.5]
SymNet parameters
[[-6.83e-01 -1.80e-01  2.28e-01 -3.84e-02  1.71e-02 -1.26e-02 -4.02e-01  6.10e-03
  -3.07e-04 -2.68e-03 -2.16e-03  1.12e-03  5.75e-02  2.28e-02]
 [ 5.83e-01 -1.21e+00  2.21e-01  2.00e-01  6.05e-02  2.49e-02  1.85e+00  4.91e-02
  -4.84e-02 -2.17e-02  3.65e-03 -4.19e-02  3.26e-03 -1.56e-01]]
SymNet parameters
[ 0.78 -0.24]
SymNet parameters
[[-1.65  0.14 -0.25 -0.29  0.09 -0.18 -1.45  0.11 -0.06 -0.   -0.01 -0.12 -0.13 -0.48
   0.14]
 [ 1.62  0.35 -0.32  0.11 -0.11  0.07 -0.3   0.04  0.17  0.02  0.07 -0.02  0.09 -0.52
   0.33]]
SymNet parameters
[0.1  0.05]
SymNet parameters
[[-1.66e-01 -6.94e-01  1.67e-01  4.62e-02  4.41e-03  2.15e-02 -1.65e+00 -1.34e-02
   6.21e-04  1.85e-03  4.86e-03  6.94e-03 -7.77e-03 -7.75e-02  2.90e-02  2.04e-03]
 [-1.62e+00  1.86e-01 -4.27e-01 -3.93e-04 -2.47e-02  1.98e-03 -4.26e-01 -1.69e-02
  -3.52e-03  3.84e-03 -1.05e-04  1.34e-03 -1.51e-01  5.78e-02 -3.76e-03  1.66e-02]]
SymNet parameters
[-0.09 -0.02]
SymNet parameters
[[ 0.39 -0.18  0.04  0.11  0.01  0.05 -0.04  0.01 -0.02 -0.01 -0.   -0.01  0.88 -0.92
  -0.28 -0.03 -0.46]]
SymNet parameters
[-0.06]
SymNet parameters
[[-1.19e+00 -8.15e-03  1.83e-03  1.61e-03 -9.70e-05 -1.33e-03 -2.74e-02 -1.44e-02
  -1.49e-01 -2.01e-03  1.49e-03 -1.76e-02]
 [-4.80e-01  2.53e-02  4.53e-02 -2.29e-02 -2.10e-03 -2.52e-02 -6.38e-01  1.15e+00
   1.20e-01 -8.16e-02 -9.57e-02 -8.25e-02]]
SymNet parameters
[-0.86  0.06]
SymNet parameters
[[ 0.46  0.03 -0.02  0.01  0.01  0.01  0.77 -0.11 -0.15  0.05  0.01  0.06 -0.04]
 [ 1.35 -0.1  -0.    0.    0.03  0.   -0.65  0.34  0.67  0.08 -0.01  0.15 -0.05]]
SymNet parameters
[-0.2  -0.14]
SymNet parameters
[[-0.96 -0.02  0.03 -0.01  0.02 -0.02  0.94  0.27 -0.29  0.03 -0.12  0.13 -0.08 -0.05]
 [-0.7  -0.03  0.08 -0.03  0.01 -0.03 -1.12  0.13  0.23 -0.09 -0.11 -0.16  0.01  0.02]]
SymNet parameters
[-0.16 -0.25]
SymNet parameters
[[ 0.57  0.21  0.01 -0.05  0.01 -0.07  1.01  0.37 -1.13 -0.09 -0.36  0.25 -0.09 -0.18
  -0.04]
 [ 0.92 -0.09  0.07 -0.05  0.03 -0.04 -0.28  0.44  0.86 -0.07 -0.19 -0.17 -0.03  0.02
   0.03]]
SymNet parameters
[-0.24  0.01]
SymNet parameters
[[ 4.39e-01  2.06e-02 -3.28e-03  2.56e-03  5.87e-03  8.43e-03 -1.57e+00  2.13e-01
  -2.39e-02  4.20e-02  8.19e-03  8.42e-03 -6.61e-02  2.91e-02  3.22e-02 -1.63e-03]
 [-4.56e-01 -9.40e-02  2.74e-02 -7.68e-03 -2.99e-03 -1.06e-02 -9.91e-01  7.72e-02
  -8.52e-01 -6.18e-02  1.00e-03 -6.54e-02  5.18e-02  2.52e-03  4.85e-02 -1.02e-02]]
SymNet parameters
[-0.39  0.41]
SymNet parameters
[[-0.19  0.05  0.02 -0.01 -0.01 -0.01 -0.45  0.73  0.16 -0.01 -0.05 -0.03  0.75 -0.57
  -0.29  0.06 -0.38]]
SymNet parameters
[0.02]
finally, finish this stage
iter:  1037    time: 3.70
Func: 3.76e-02  |g|: 2.95e-03
stableloss: 1.18e-02   dataloss: 3.76e-02   sparseloss: 6.61e+01 momentloss: 7.27e+00
current expression:
[u00*u01, u10*v00, u00, u02, u20, u00**3, v00, u00**2, u01*u10*v00, v00**2, u01, v00**3, u00**2*u02, u00*v00**2, u00*v00, u10, u01*v00, u00*u11*v00, u00*u10*v00, u00*u01**2]
[-0.89 -0.89  0.06  0.04  0.04 -0.03  0.01 -0.01  0.01 -0.01  0.01 -0.01 -0.01  0.01
 -0.01 -0.01 -0.01  0.01  0.01  0.01]
[v00*v10, u00*v01, v00, v20, v02, v00**3, u00*v00, u00**2, v00**2*v20, u00**2*v00, v00**2, v01, u00*v00*v11, v00*v10**2, u00*v00*v01, u00**2*v00**2, u00*v00**2, u00**2*v01, v00**2*v01, 1]
[-0.89 -0.88  0.08  0.04  0.04 -0.04 -0.02 -0.01 -0.01  0.01 -0.01  0.01  0.01  0.01
 -0.01  0.01  0.01 -0.01 -0.01  0.01]
block:  1
name:  burgers-2-upwind-sparse0-noise0.001-id1
device:  cuda:1
generate a random number to check random seed:  -0.8677077674282402
current stage is: block-1
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.8733, device='cuda:1', dtype=torch.float64)
u_obs variance
tensor([ 0.2513,  2.0471,  1.9751, 18.7937,  9.9749, 16.9944,  0.2578,  2.0508,
         2.0813, 17.8158, 10.5013, 19.0978], device='cuda:1',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
iter:     0    time: 1418.01
Func: 5.83e-02  |g|: 8.76e-01
stableloss: 9.96e-03   dataloss: 5.10e-02   sparseloss: 6.61e+01 momentloss: 7.27e+00
iter:   200    time: 10.29
Func: 2.27e-02  |g|: 1.47e-02
stableloss: 6.09e-03   dataloss: 1.61e-02   sparseloss: 6.83e+01 momentloss: 6.63e+00
iter:   400    time: 10.32
Func: 2.21e-02  |g|: 8.95e-03
stableloss: 6.11e-03   dataloss: 1.55e-02   sparseloss: 7.15e+01 momentloss: 6.61e+00
iter:   600    time: 10.30
Func: 2.18e-02  |g|: 6.55e-03
stableloss: 6.17e-03   dataloss: 1.53e-02   sparseloss: 7.12e+01 momentloss: 6.57e+00
iter:   800    time: 10.19
Func: 2.17e-02  |g|: 5.37e-03
stableloss: 6.15e-03   dataloss: 1.51e-02   sparseloss: 7.01e+01 momentloss: 6.55e+00
iter:  1000    time: 10.26
Func: 2.16e-02  |g|: 3.34e-03
stableloss: 6.15e-03   dataloss: 1.51e-02   sparseloss: 7.27e+01 momentloss: 6.54e+00
iter:  1200    time: 10.22
Func: 2.16e-02  |g|: 4.49e-03
stableloss: 6.13e-03   dataloss: 1.50e-02   sparseloss: 7.28e+01 momentloss: 6.53e+00
iter:  1400    time: 10.22
Func: 2.15e-02  |g|: 7.01e-03
stableloss: 6.05e-03   dataloss: 1.50e-02   sparseloss: 7.22e+01 momentloss: 6.51e+00
iter:  1600    time: 10.22
Func: 2.15e-02  |g|: 2.73e-03
stableloss: 6.00e-03   dataloss: 1.50e-02   sparseloss: 7.12e+01 momentloss: 6.50e+00
iter:  1800    time: 10.22
Func: 2.15e-02  |g|: 2.92e-03
stableloss: 5.95e-03   dataloss: 1.49e-02   sparseloss: 7.40e+01 momentloss: 6.52e+00
Warning: Maximum number of iterations has been exceeded.
         Current function value: 0.021448
         Iterations: 2000
         Function evaluations: 2004
         Gradient evaluations: 2004
convolution moment and kernels
[[ 1.00e+00  0.00e+00  4.54e-04 -1.44e-03 -3.10e-02]
 [ 0.00e+00  7.91e-05  1.90e-03  6.11e-04  6.72e-03]
 [ 7.03e-05 -2.15e-03 -5.28e-04  4.58e-03  2.34e-03]
 [ 1.29e-03  2.83e-03  1.58e-03 -2.31e-03 -1.37e-02]
 [-4.19e-02  9.88e-03  1.66e-04 -1.33e-02  7.99e-03]]
[[ 0.02 -0.08  0.05 -0.04  0.01]
 [-0.08  0.27 -0.11  0.1  -0.02]
 [ 0.06 -0.18  0.81  0.1  -0.04]
 [-0.05  0.13  0.11 -0.05  0.02]
 [ 0.01 -0.02 -0.04  0.02 -0.01]]
[[ 0.00e+00  1.00e+00  0.00e+00 -1.08e-01 -6.23e-02]
 [ 0.00e+00  0.00e+00  2.36e-03  8.00e-04  8.47e-04]
 [ 0.00e+00  3.18e-02  2.37e-04  7.13e-03 -4.36e-03]
 [ 2.02e-03 -3.73e-03 -1.66e-03  3.35e-03 -4.00e-03]
 [ 9.59e-03  3.23e-03 -4.77e-04 -9.97e-03 -5.82e-04]]
[[ 8.10e-03 -2.05e-02  1.84e-02  7.10e-03 -4.48e-03]
 [-3.19e-02  6.59e-02 -8.21e-02 -4.22e-03  1.60e-02]
 [ 1.17e-01 -5.97e-01 -2.63e-01  1.03e+00 -2.26e-01]
 [-1.99e-02  2.74e-02 -4.75e-02 -2.15e-02  2.11e-02]
 [ 2.21e-03 -9.68e-04  6.59e-04  1.52e-02 -6.53e-03]]
[[ 0.00e+00  0.00e+00  0.00e+00  5.83e-03  9.22e-03]
 [ 1.00e+00  0.00e+00  1.37e-02 -3.04e-03 -1.34e-02]
 [ 0.00e+00  7.36e-03 -1.38e-03 -5.55e-03 -5.99e-03]
 [-1.05e-01  1.57e-04  9.57e-03  2.93e-03 -8.15e-03]
 [-6.55e-02  1.25e-02 -5.31e-03 -6.01e-03 -4.62e-03]]
[[ 0.   -0.02  0.09  0.01 -0.01]
 [-0.    0.03 -0.49 -0.07  0.02]
 [ 0.01 -0.08 -0.34  0.03 -0.01]
 [-0.    0.02  1.04 -0.05  0.02]
 [-0.    0.01 -0.24  0.04 -0.01]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00  5.15e-05]
 [ 0.00e+00  0.00e+00  0.00e+00  1.73e-03  7.54e-04]
 [ 0.00e+00  0.00e+00  1.93e-03 -1.60e-03  1.77e-03]
 [ 0.00e+00  1.49e-03  7.18e-04 -2.95e-03 -2.04e-03]
 [ 3.22e-02 -6.53e-03 -1.35e-03  5.84e-03 -7.11e-03]]
[[-1.04e-02  3.46e-02 -1.91e-04  9.75e-03 -1.61e-03]
 [ 4.46e-02 -1.49e-01  1.91e-02 -5.34e-02  1.04e-02]
 [-1.52e-01  1.57e+00 -2.56e+00  1.44e+00 -1.06e-01]
 [ 4.55e-02 -1.62e-01  5.32e-02 -8.59e-02  2.00e-02]
 [-1.09e-02  4.00e-02 -1.50e-02  2.36e-02 -5.58e-03]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  4.53e-04]
 [ 0.00e+00  1.00e+00  0.00e+00 -2.12e-03 -3.41e-03]
 [ 0.00e+00  0.00e+00 -2.23e-03  5.29e-04  4.63e-03]
 [ 0.00e+00 -2.30e-03 -1.51e-03  3.97e-03  3.34e-03]
 [-2.92e-03  3.87e-04  3.93e-03 -3.00e-04 -1.16e-02]]
[[-5.98e-03  3.01e-03 -9.85e-02  1.21e-01 -2.26e-02]
 [ 2.01e-04  1.95e-01  4.10e-01 -7.13e-01  1.19e-01]
 [-8.12e-02  3.56e-01 -5.73e-01  3.66e-01 -8.47e-02]
 [ 1.06e-01 -6.59e-01  3.36e-01  2.38e-01 -9.10e-03]
 [-1.82e-02  1.02e-01 -7.13e-02 -1.34e-02 -2.36e-03]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  5.41e-03]
 [ 0.00e+00  0.00e+00  0.00e+00  2.26e-03  4.55e-04]
 [ 1.00e+00  0.00e+00  2.73e-03 -6.75e-04 -2.23e-03]
 [ 0.00e+00  2.50e-03  1.59e-03 -4.19e-03 -2.63e-03]
 [-1.70e-03 -3.35e-03 -1.74e-03  3.76e-03  5.41e-04]]
[[-1.12e-03 -2.84e-03 -6.56e-02 -2.12e-02  5.74e-03]
 [ 3.05e-03  1.63e-02  1.26e+00  8.08e-02 -2.12e-02]
 [ 1.89e-03 -4.24e-02 -2.38e+00 -1.18e-01  2.95e-02]
 [ 3.06e-03  3.40e-03  1.30e+00  3.84e-02 -8.98e-03]
 [-1.46e-03  3.85e-03 -8.58e-02 -2.00e-03  4.13e-04]]
SymNet parameters
[[ 1.51e-01 -1.06e-02 -3.53e-03  4.62e-03 -8.73e-05  4.76e-04  2.89e-02  3.37e-03
   1.13e-02  1.24e-04  8.81e-04 -6.75e-04]
 [ 7.49e-01 -1.16e+00  3.51e-03 -3.69e-01 -5.29e-02  4.33e-02 -2.44e-01  2.04e-02
   6.49e-02  1.56e-02 -4.72e-02 -1.56e-02]]
SymNet parameters
[-0.41 -0.03]
SymNet parameters
[[-5.99e-02 -1.44e-03  7.86e-05  1.42e-03  9.20e-04 -7.23e-04  1.13e+00 -4.27e-02
   1.20e-02 -1.09e-03 -2.24e-04  1.12e-04 -6.21e-02]
 [ 5.03e-02  1.65e-02  4.26e-01 -5.53e-03 -1.66e-02  2.79e-03 -7.18e-03 -3.24e-03
  -3.46e-03 -1.21e-04 -1.58e-03 -1.20e-03  3.16e-02]]
SymNet parameters
[ 0.22 -1.06]
SymNet parameters
[[ 1.06e-01 -1.61e-02  7.27e-01 -2.62e-02  1.62e-02 -1.22e-03 -1.31e-02  2.96e-03
   6.05e-04  2.95e-03 -2.09e-03 -6.43e-05  5.96e-02  1.03e-02]
 [-1.87e-01  7.59e-02 -1.23e-02  1.96e-02  2.02e-03  3.18e-04  2.55e+00  7.17e-02
  -1.17e-02 -1.34e-04  3.68e-03  3.19e-03 -7.20e-02 -2.49e-02]]
SymNet parameters
[ 0.74 -0.38]
SymNet parameters
[[-3.66e+00 -3.51e-01 -6.21e-02 -2.00e-01 -1.51e-02  2.70e-02 -4.55e-01  2.91e-02
   8.22e-02 -1.61e-02 -1.99e-02  1.66e-02 -7.54e-01 -7.87e-01  2.34e-02]
 [ 3.15e+00  5.91e-01 -3.87e-01 -3.63e-02 -1.85e-02  6.15e-02  1.37e+00  1.37e-01
   7.83e-01  1.60e-02  1.92e-03 -3.79e-02  1.35e+00  7.15e-01 -2.30e-01]]
SymNet parameters
[0.16 0.01]
SymNet parameters
[[-7.84e-01 -1.54e+00  7.15e-02  8.25e-02  1.65e-02 -2.17e-02 -1.10e+00 -1.40e-02
  -1.81e-01 -9.08e-03  9.04e-03  1.42e-02 -2.43e-01 -7.93e-01  1.86e-01  1.91e-03]
 [-1.29e+00  4.70e-03 -3.86e-03 -3.69e-03 -1.96e-05  1.13e-03  8.97e-02  5.13e-04
   5.14e-03 -9.29e-04  7.93e-04  9.48e-04 -1.33e-01 -2.15e-02  6.11e-03 -1.85e-03]]
SymNet parameters
[ 0.07 -0.67]
SymNet parameters
[[ 0.54 -0.05 -0.02 -0.14 -0.03  0.08 -0.29  0.07  0.08  0.01 -0.02 -0.01  1.26 -0.67
  -0.35 -0.03 -0.45]]
SymNet parameters
[-0.32]
SymNet parameters
[[-9.33e-01 -5.37e-04  6.11e-03  2.07e-04  1.39e-03 -2.42e-03  4.02e-01 -5.30e-02
  -3.64e-02 -6.54e-03 -7.39e-03  4.40e-02]
 [ 1.27e-02 -3.43e-02  3.13e-02 -5.50e-03  4.17e-03 -9.74e-03  1.74e-01  1.21e+00
  -2.91e-01  9.10e-03 -1.12e-01  9.50e-02]]
SymNet parameters
[-0.71 -0.04]
SymNet parameters
[[ 2.38e-01 -4.49e-03  1.14e-02  7.75e-04  1.84e-03 -4.82e-03  7.21e-01 -5.42e-02
  -1.83e-02 -1.53e-02  2.29e-03  7.20e-02  3.95e-03]
 [-6.71e-01 -1.69e-02  6.27e-02  7.82e-03  1.63e-02 -4.22e-02  1.74e-01  5.72e-01
   2.12e+00 -1.31e-01 -6.46e-03  6.21e-01 -1.06e-01]]
SymNet parameters
[ 0.3  -0.63]
SymNet parameters
[[-1.46  0.01  0.06  0.    0.01 -0.02  0.85  0.32 -0.22 -0.05 -0.01  0.31  0.2   0.06]
 [-0.11  0.46 -0.24 -0.03  0.02  0.01 -0.64 -1.8   0.62  0.3  -0.87 -0.03 -0.03  0.13]]
SymNet parameters
[-0.34 -0.5 ]
SymNet parameters
[[ 2.04 -0.02  0.11  0.01  0.01 -0.03  0.13 -0.11  0.05 -0.09  0.04  0.42  0.13  0.09
  -0.  ]
 [-0.5  -0.44  0.32 -0.03  0.02 -0.06 -0.44 -1.11  1.72 -0.02 -0.46  0.52 -0.08  0.01
  -0.03]]
SymNet parameters
[-0.26 -0.06]
SymNet parameters
[[-0.33  0.05  0.05  0.02  0.02 -0.06  0.07 -0.53 -0.55 -0.21  0.05  0.93 -0.13  0.02
   0.01 -0.01]
 [-0.43 -0.05  0.03 -0.   -0.    0.   -1.23  0.07 -0.36  0.02 -0.02 -0.07  0.02  0.02
  -0.   -0.  ]]
SymNet parameters
[-0.33  0.37]
SymNet parameters
[[-1.84e-01 -1.81e-02  2.40e-02  6.96e-05  4.82e-03 -1.25e-02 -4.35e-02  5.92e-01
   1.99e-01  2.32e-02 -4.04e-02  2.32e-01  5.90e-01 -5.11e-01 -2.20e-02  4.06e-02
  -1.80e-01]]
SymNet parameters
[-0.14]
finally, finish this stage
iter:  2000    time: 10.35
Func: 2.14e-02  |g|: 1.35e-03
stableloss: 5.91e-03   dataloss: 1.49e-02   sparseloss: 7.78e+01 momentloss: 6.53e+00
current expression:
[u00*u01, u10*v00, u20, u02, u00*u01**2, u00*u10*v01, u00*u11*v00, u00, u01*u10*v00, u01, u10*v00*v10, u00*v00, u00**2*u01, u00*u01*v00, u00**2, u00**3, u00**2*v00, u01*v00**2, v00, u01**2]
[-0.98 -0.97  0.05  0.05  0.02  0.01  0.01  0.01  0.01 -0.01  0.01 -0.01  0.    0.
 -0.   -0.   -0.    0.   -0.   -0.  ]
[v00*v10, u00*v01, v02, v20, v00*v10**2, u00*v01*v10, u00, u00*v00*v11, v00, u00*u01*v01, u01*v00*v01, v11, v00**2*v10, u00*u10*v01, v10, u00*v00*v01, u00*v10, u00**2*v01, u00*v00**2, u00*v00]
[-0.98 -0.97  0.05  0.05  0.01  0.01 -0.01  0.01  0.01  0.01 -0.    0.    0.   -0.
 -0.    0.    0.    0.    0.    0.  ]
block:  2
name:  burgers-2-upwind-sparse0-noise0.001-id1
device:  cuda:1
generate a random number to check random seed:  -2.30240730071429
current stage is: block-2
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.6895, device='cuda:1', dtype=torch.float64)
u_obs variance
tensor([ 0.2636,  1.8856,  1.7424, 24.0459, 10.9178, 19.9636,  0.2567,  1.6251,
         1.8230, 18.4214,  9.9650, 23.8435], device='cuda:1',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
iter:     0    time: 1014.58
Func: 6.70e-02  |g|: 2.74e+00
stableloss: 1.16e-02   dataloss: 5.39e-02   sparseloss: 7.78e+01 momentloss: 6.53e+00
iter:   200    time: 14.47
Func: 5.56e-02  |g|: 8.59e-02
stableloss: 1.14e-02   dataloss: 4.23e-02   sparseloss: 7.72e+01 momentloss: 6.65e+00
iter:   400    time: 14.28
Func: 5.46e-02  |g|: 4.01e-02
stableloss: 1.14e-02   dataloss: 4.13e-02   sparseloss: 8.36e+01 momentloss: 6.65e+00
iter:   600    time: 14.32
Func: 5.42e-02  |g|: 6.64e-02
stableloss: 1.13e-02   dataloss: 4.09e-02   sparseloss: 9.07e+01 momentloss: 6.64e+00
iter:   800    time: 14.36
Func: 5.40e-02  |g|: 4.09e-02
stableloss: 1.14e-02   dataloss: 4.08e-02   sparseloss: 9.62e+01 momentloss: 6.63e+00
iter:  1000    time: 14.40
Func: 5.36e-02  |g|: 5.09e-02
stableloss: 1.15e-02   dataloss: 4.03e-02   sparseloss: 1.02e+02 momentloss: 6.63e+00
iter:  1200    time: 14.36
Func: 5.34e-02  |g|: 2.33e-02
stableloss: 1.14e-02   dataloss: 4.01e-02   sparseloss: 1.02e+02 momentloss: 6.64e+00
iter:  1400    time: 14.35
Func: 5.33e-02  |g|: 3.59e-02
stableloss: 1.13e-02   dataloss: 4.00e-02   sparseloss: 1.03e+02 momentloss: 6.66e+00
iter:  1600    time: 14.43
Func: 5.32e-02  |g|: 3.71e-02
stableloss: 1.13e-02   dataloss: 3.99e-02   sparseloss: 1.10e+02 momentloss: 6.67e+00
iter:  1800    time: 14.47
Func: 5.31e-02  |g|: 3.73e-02
stableloss: 1.14e-02   dataloss: 3.98e-02   sparseloss: 1.14e+02 momentloss: 6.67e+00
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 0.053100
         Iterations: 1983
         Function evaluations: 2036
         Gradient evaluations: 2030
convolution moment and kernels
[[ 1.00e+00  0.00e+00  1.52e-04  2.52e-02 -7.87e-02]
 [ 0.00e+00 -1.31e-05 -4.97e-04  5.17e-04  7.26e-03]
 [ 4.53e-04  1.04e-04  5.66e-03 -7.37e-03 -1.12e-03]
 [-4.63e-03 -7.52e-04  6.61e-03  1.44e-04 -1.95e-02]
 [-5.33e-02  1.08e-02  1.11e-03  8.19e-04  1.42e-03]]
[[ 0.01 -0.06  0.03 -0.05  0.01]
 [-0.03  0.16 -0.01  0.12 -0.04]
 [-0.09  0.27  0.29  0.25 -0.05]
 [ 0.02 -0.06  0.33 -0.09  0.01]
 [-0.01  0.04 -0.12  0.05 -0.01]]
[[ 0.00e+00  1.00e+00  0.00e+00 -1.06e-01 -7.03e-02]
 [ 0.00e+00  0.00e+00  2.38e-03  1.32e-03  4.19e-04]
 [ 0.00e+00  2.40e-02 -3.26e-03  2.86e-02 -1.62e-02]
 [-3.44e-03  4.18e-03  3.98e-03  3.87e-03  3.81e-03]
 [-3.75e-03 -5.55e-03  1.49e-03 -4.00e-03 -2.91e-03]]
[[-1.28e-04  1.19e-02 -2.26e-02  1.55e-02 -6.73e-03]
 [-2.95e-02  3.34e-02 -7.13e-03 -3.17e-03  1.80e-02]
 [ 1.28e-01 -5.94e-01 -3.49e-01  1.02e+00 -2.25e-01]
 [-3.39e-02  5.48e-02 -3.07e-02  1.91e-02  9.01e-03]
 [ 1.84e-03  2.58e-03 -1.25e-02  4.42e-03 -1.81e-03]]
[[ 0.00e+00  0.00e+00  0.00e+00  5.37e-03  5.00e-03]
 [ 1.00e+00  0.00e+00  9.18e-03  4.17e-04 -2.55e-02]
 [ 0.00e+00  1.38e-02 -2.96e-03 -6.38e-03 -2.02e-03]
 [-8.51e-02 -2.00e-03  2.18e-02 -3.78e-03 -1.11e-02]
 [-5.89e-02  2.66e-02 -1.32e-02  1.41e-03 -6.10e-03]]
[[-3.21e-04 -3.45e-02  1.10e-01 -6.96e-03 -8.56e-04]
 [ 2.38e-02  1.72e-02 -5.12e-01 -6.62e-02  2.06e-02]
 [-2.51e-02 -4.27e-02 -3.33e-01  6.42e-02 -1.61e-02]
 [ 1.10e-02  2.79e-02  1.00e+00 -6.64e-02  1.52e-02]
 [-7.10e-03  1.74e-02 -2.34e-01  5.00e-02 -1.11e-02]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00  1.93e-03]
 [ 0.00e+00  0.00e+00  0.00e+00 -2.27e-03 -2.73e-04]
 [ 0.00e+00  0.00e+00  4.93e-03 -1.38e-03 -3.79e-03]
 [ 0.00e+00  1.01e-07  2.81e-03  1.19e-03  5.15e-04]
 [ 1.06e-02 -4.97e-03 -2.98e-03  4.49e-03 -2.40e-04]]
[[-2.13e-03  1.56e-03  2.14e-02 -1.27e-02  2.52e-03]
 [ 5.04e-03  1.16e-02 -1.16e-01  7.24e-02 -1.54e-02]
 [-8.85e-02  1.30e+00 -2.30e+00  1.20e+00 -5.32e-02]
 [ 6.81e-03  4.30e-03 -1.10e-01  7.58e-02 -1.90e-02]
 [-2.59e-03  4.64e-03  1.77e-02 -1.28e-02  3.63e-03]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  3.24e-03]
 [ 0.00e+00  1.00e+00  0.00e+00 -2.35e-03  5.20e-03]
 [ 0.00e+00  0.00e+00  1.63e-03  1.36e-03 -3.39e-03]
 [ 0.00e+00 -2.14e-03 -5.93e-04  3.84e-03 -2.58e-03]
 [-9.22e-04 -4.32e-03 -2.47e-03  2.46e-03  6.58e-03]]
[[ 0.02 -0.09  0.06  0.02  0.  ]
 [-0.09  0.59 -0.25 -0.27  0.02]
 [ 0.04 -0.2   0.35 -0.26  0.06]
 [ 0.04 -0.35 -0.18  0.59 -0.09]
 [-0.    0.04  0.04 -0.09  0.02]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  4.21e-02]
 [ 0.00e+00  0.00e+00  0.00e+00 -1.46e-03 -6.29e-04]
 [ 1.00e+00  0.00e+00  5.17e-03  8.97e-04 -3.83e-03]
 [ 0.00e+00 -2.28e-04  3.37e-03  5.11e-04  1.37e-03]
 [ 8.17e-03 -1.95e-03 -5.27e-03 -2.54e-04  1.63e-03]]
[[ 2.03e-03 -1.42e-02 -4.94e-02 -1.52e-02  1.63e-03]
 [-1.37e-02  7.98e-02  1.16e+00  8.25e-02 -1.12e-02]
 [ 6.61e-02 -3.01e-01 -1.97e+00 -3.10e-01  6.43e-02]
 [-1.52e-02  8.19e-02  1.16e+00  9.12e-02 -1.58e-02]
 [ 2.83e-03 -1.47e-02 -4.90e-02 -1.75e-02  3.22e-03]]
SymNet parameters
[[ 1.84e-01 -5.58e-05 -1.11e-02  5.55e-03 -9.69e-04 -1.27e-04  1.54e-02  2.65e-03
   1.28e-02 -7.12e-05  1.34e-04 -2.61e-04]
 [-6.99e-01 -1.44e+00 -1.64e-01 -4.16e-01  1.02e-01  2.85e-02  2.78e-01 -1.55e-01
  -2.65e-01  2.60e-02 -1.07e-02  1.74e-02]]
SymNet parameters
[-0.32 -0.43]
SymNet parameters
[[ 2.08e-02  3.39e-02 -1.92e-03 -2.41e-02  4.07e-03  2.27e-03  1.22e+00 -9.77e-02
  -2.71e-02 -3.09e-05  2.11e-03  2.52e-03 -1.94e-02]
 [-2.07e-02 -7.69e-03  6.87e-02  1.06e-03 -5.90e-03 -4.45e-04  4.66e-03  1.09e-03
  -3.75e-03 -5.58e-04  5.48e-05 -4.44e-04  6.87e-03]]
SymNet parameters
[ 0.02 -1.34]
SymNet parameters
[[-5.44e-01 -2.88e-01  1.04e+00 -5.34e-02  1.88e-02 -1.97e-04 -2.82e-01  7.47e-03
  -8.29e-02  2.37e-03 -1.40e-03  2.33e-03  7.82e-02 -2.50e-01]
 [-8.44e-02  7.57e-02  4.39e-02 -9.90e-03 -1.03e-03 -2.58e-03  2.52e+00  3.94e-02
  -9.96e-02 -3.22e-03 -2.20e-03 -3.09e-03 -1.96e-02 -1.70e-01]]
SymNet parameters
[ 0.45 -0.38]
SymNet parameters
[[-4.57e+00 -9.12e-01  6.87e-01 -1.30e-01  2.95e-02  1.00e-02 -1.64e-01  1.90e-02
  -2.16e-01  4.64e-03 -2.77e-03  4.14e-03 -2.38e-01 -5.03e-01 -2.18e-02]
 [ 4.76e+00 -1.83e-01 -3.14e-01  2.96e-01 -2.96e-02  8.16e-03 -1.18e+00  1.17e-01
   9.41e-01  1.55e-03  3.64e-03 -5.46e-03  5.46e-01  2.21e-01 -5.65e-02]]
SymNet parameters
[ 0.04 -0.02]
SymNet parameters
[[-1.35e+00 -7.27e-01  3.54e-01  7.19e-02 -2.64e-02 -1.28e-02 -2.42e+00  2.19e-01
  -1.61e-01 -8.37e-03 -2.85e-03 -8.04e-03 -6.59e-02 -1.64e+00  3.82e-02 -8.08e-04]
 [-1.74e+00  8.60e-02  3.46e-02 -3.27e-03 -3.52e-03 -1.70e-03  3.98e-02 -2.09e-02
  -5.02e-02 -6.82e-04  1.24e-03  1.66e-04 -2.46e-01  1.26e-01  1.59e-02  1.66e-03]]
SymNet parameters
[ 0.07 -0.72]
SymNet parameters
[[ 0.25 -0.68 -0.42 -0.24  0.08  0.07  0.01 -0.06 -0.07  0.02 -0.01  0.01  2.29 -0.31
  -0.36 -0.08 -0.63]]
SymNet parameters
[-0.43]
SymNet parameters
[[-6.20e-01 -1.03e-03  3.74e-02  6.64e-04  7.04e-04  9.14e-04  1.53e-02  1.03e-03
   8.35e-03  6.80e-05  1.08e-03 -3.06e-04]
 [ 1.42e-02  4.93e-03 -1.88e-03 -2.89e-03 -3.54e-03 -5.41e-04 -4.15e-02  8.74e-01
  -1.12e-02  1.01e-03 -5.39e-02  6.16e-03]]
SymNet parameters
[-1.16  1.3 ]
SymNet parameters
[[-3.15e-02 -1.90e-02  7.63e-04 -1.90e-03  9.88e-04  4.00e-05  7.72e-01  7.29e-02
   4.45e-02  3.18e-03 -2.85e-03  2.69e-02  7.16e-02]
 [-1.74e+00  1.12e-01  9.24e-02 -5.46e-02  6.33e-02  5.21e-03  3.65e-01  6.26e-01
   3.39e+00  1.17e-01 -6.30e-03  9.56e-01  6.55e-01]]
SymNet parameters
[ 0.66 -0.42]
SymNet parameters
[[-2.80e+00  5.29e-02 -3.37e-02 -2.30e-02  1.23e-02  3.24e-03  2.99e-01  1.50e+00
   8.07e-01  6.71e-02 -5.48e-02  3.21e-01  1.14e+00  1.36e-01]
 [-2.85e-01  7.31e-02 -2.56e-02 -1.38e-01  3.71e-02  7.47e-03  1.63e+00 -5.43e+00
   3.74e+00  3.13e-01 -3.79e-01  1.43e+00  5.18e+00  5.90e-01]]
SymNet parameters
[-0.16 -0.29]
SymNet parameters
[[-1.74e-01  6.00e-02 -7.06e-03 -5.10e-02  2.49e-02  6.59e-03  5.56e-01  2.84e+00
   1.66e+00  1.26e-01 -9.91e-02  6.10e-01  2.17e+00  2.65e-01 -3.87e-05]
 [-3.44e+00 -2.13e-01 -4.32e-02 -3.02e-02  2.12e-03 -5.38e-04  6.11e-01 -1.55e+00
   1.63e+00  7.86e-02 -1.07e-01  3.52e-01  1.45e+00  1.81e-01 -3.51e-04]]
SymNet parameters
[ 0.45 -0.62]
SymNet parameters
[[-8.72e-01  1.14e-01  3.20e-02 -4.44e-02  4.45e-02  3.35e-03  2.24e-01  1.10e+00
  -3.99e-01  9.00e-02 -5.15e-02  7.42e-01  1.21e+00  4.14e-03  1.22e-02 -2.23e-02]
 [ 8.53e-02 -1.26e-02 -1.32e-03  5.84e-03 -4.69e-03 -4.03e-04 -1.65e+00 -1.68e-01
  -2.26e-01 -1.10e-02  6.72e-03 -7.47e-02 -1.52e-01  9.72e-03  4.70e-04 -1.14e-03]]
SymNet parameters
[0.67 0.48]
SymNet parameters
[[-1.22e-01  1.53e-02  8.90e-03 -1.73e-02  1.67e-02  6.37e-04  1.22e-01  6.96e-01
   7.07e-01  8.66e-02 -2.42e-02  3.35e-01  5.84e-01 -3.41e-01 -2.31e-02  4.28e-02
  -2.07e-01]]
SymNet parameters
[0.46]
finally, finish this stage
iter:  1983    time: 16.24
Func: 5.31e-02  |g|: 1.14e-02
stableloss: 1.13e-02   dataloss: 3.98e-02   sparseloss: 1.20e+02 momentloss: 6.66e+00
current expression:
[u00*u01, u10*v00, u20, u02, u00, u00*u01**2, u00*u11*v00, u10*v00*v10, u00*u10*v01, u01*u10*v00, u00*u01*v00, u00**3, u00*v01, u00*u10, u00**2*v01, u00**2*v00, u20*v00, u00**2*v10, u10*v00**2, u01]
[-0.98 -0.98  0.05  0.05  0.02  0.01  0.01  0.01  0.01  0.01  0.01 -0.    0.    0.
 -0.   -0.    0.   -0.    0.    0.  ]
[v00*v10, u00*v01, v02, v20, v00*v10**2, u00*u01*v01, u00*v00*v11, u10*v00*v01, u00*v01*v10, v00**2*v10, u00*v00*v10, u01*v00*v10, v10, v01, v00*v20, v00**2*v10**2, 1, u00**2*v00*v01, v01*v10, v00**2*v01]
[-0.98 -0.97  0.05  0.05  0.02  0.01  0.01  0.01  0.01  0.01 -0.01 -0.   -0.    0.
  0.   -0.   -0.    0.   -0.    0.  ]
block:  3
name:  burgers-2-upwind-sparse0-noise0.001-id1
device:  cuda:1
generate a random number to check random seed:  1.6113332515112737
current stage is: block-3
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.8796, device='cuda:1', dtype=torch.float64)
u_obs variance
tensor([ 0.2490,  1.7228,  1.6458, 22.1014, 10.4555, 19.1495,  0.2506,  1.6219,
         1.5816, 18.2159,  9.1534, 20.4981], device='cuda:1',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 0.173484
         Iterations: 0
         Function evaluations: 15
         Gradient evaluations: 3
convolution moment and kernels
[[ 1.00e+00  0.00e+00  1.51e-04  2.52e-02 -7.87e-02]
 [ 0.00e+00 -1.54e-05 -4.94e-04  5.13e-04  7.26e-03]
 [ 4.49e-04  1.08e-04  5.66e-03 -7.37e-03 -1.12e-03]
 [-4.63e-03 -7.54e-04  6.61e-03  1.41e-04 -1.95e-02]
 [-5.33e-02  1.08e-02  1.11e-03  8.23e-04  1.42e-03]]
[[ 0.01 -0.06  0.03 -0.05  0.01]
 [-0.03  0.16 -0.01  0.12 -0.04]
 [-0.09  0.27  0.29  0.25 -0.05]
 [ 0.02 -0.06  0.33 -0.09  0.01]
 [-0.01  0.04 -0.12  0.05 -0.01]]
[[ 0.00e+00  1.00e+00  0.00e+00 -1.06e-01 -7.03e-02]
 [ 0.00e+00  0.00e+00  2.39e-03  1.32e-03  4.16e-04]
 [ 0.00e+00  2.40e-02 -3.27e-03  2.86e-02 -1.62e-02]
 [-3.44e-03  4.18e-03  3.98e-03  3.87e-03  3.82e-03]
 [-3.76e-03 -5.55e-03  1.50e-03 -4.00e-03 -2.91e-03]]
[[-1.35e-04  1.19e-02 -2.26e-02  1.55e-02 -6.74e-03]
 [-2.95e-02  3.32e-02 -6.90e-03 -3.26e-03  1.80e-02]
 [ 1.28e-01 -5.94e-01 -3.49e-01  1.02e+00 -2.25e-01]
 [-3.38e-02  5.47e-02 -3.06e-02  1.91e-02  9.01e-03]
 [ 1.84e-03  2.59e-03 -1.25e-02  4.43e-03 -1.81e-03]]
[[ 0.00e+00  0.00e+00  0.00e+00  5.37e-03  4.99e-03]
 [ 1.00e+00  0.00e+00  9.19e-03  4.16e-04 -2.55e-02]
 [ 0.00e+00  1.38e-02 -2.97e-03 -6.38e-03 -2.02e-03]
 [-8.51e-02 -2.00e-03  2.18e-02 -3.78e-03 -1.11e-02]
 [-5.89e-02  2.66e-02 -1.32e-02  1.41e-03 -6.10e-03]]
[[-3.24e-04 -3.44e-02  1.10e-01 -6.93e-03 -8.63e-04]
 [ 2.39e-02  1.71e-02 -5.12e-01 -6.63e-02  2.06e-02]
 [-2.51e-02 -4.25e-02 -3.34e-01  6.43e-02 -1.61e-02]
 [ 1.10e-02  2.78e-02  1.00e+00 -6.64e-02  1.52e-02]
 [-7.10e-03  1.75e-02 -2.34e-01  5.00e-02 -1.12e-02]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00  1.93e-03]
 [ 0.00e+00  0.00e+00  0.00e+00 -2.28e-03 -2.71e-04]
 [ 0.00e+00  0.00e+00  4.93e-03 -1.38e-03 -3.79e-03]
 [ 0.00e+00  5.52e-06  2.81e-03  1.19e-03  5.13e-04]
 [ 1.06e-02 -4.98e-03 -2.98e-03  4.49e-03 -2.39e-04]]
[[-2.13e-03  1.56e-03  2.14e-02 -1.27e-02  2.52e-03]
 [ 5.03e-03  1.16e-02 -1.16e-01  7.24e-02 -1.54e-02]
 [-8.85e-02  1.30e+00 -2.30e+00  1.20e+00 -5.31e-02]
 [ 6.82e-03  4.30e-03 -1.10e-01  7.59e-02 -1.90e-02]
 [-2.59e-03  4.64e-03  1.77e-02 -1.28e-02  3.63e-03]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  3.24e-03]
 [ 0.00e+00  1.00e+00  0.00e+00 -2.35e-03  5.20e-03]
 [ 0.00e+00  0.00e+00  1.63e-03  1.36e-03 -3.39e-03]
 [ 0.00e+00 -2.14e-03 -5.95e-04  3.84e-03 -2.59e-03]
 [-9.22e-04 -4.32e-03 -2.46e-03  2.45e-03  6.58e-03]]
[[ 0.02 -0.09  0.06  0.02  0.  ]
 [-0.09  0.59 -0.25 -0.27  0.02]
 [ 0.04 -0.2   0.35 -0.26  0.06]
 [ 0.04 -0.35 -0.18  0.59 -0.09]
 [-0.    0.04  0.04 -0.09  0.01]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  4.21e-02]
 [ 0.00e+00  0.00e+00  0.00e+00 -1.46e-03 -6.33e-04]
 [ 1.00e+00  0.00e+00  5.17e-03  8.95e-04 -3.83e-03]
 [ 0.00e+00 -2.30e-04  3.36e-03  5.10e-04  1.37e-03]
 [ 8.17e-03 -1.95e-03 -5.27e-03 -2.49e-04  1.63e-03]]
[[ 2.02e-03 -1.41e-02 -4.95e-02 -1.52e-02  1.63e-03]
 [-1.36e-02  7.97e-02  1.16e+00  8.24e-02 -1.12e-02]
 [ 6.61e-02 -3.01e-01 -1.97e+00 -3.09e-01  6.43e-02]
 [-1.51e-02  8.18e-02  1.16e+00  9.11e-02 -1.58e-02]
 [ 2.82e-03 -1.47e-02 -4.90e-02 -1.75e-02  3.22e-03]]
SymNet parameters
[[ 1.84e-01 -2.12e-05 -1.11e-02  5.38e-03 -9.89e-04 -2.52e-04  1.54e-02  2.64e-03
   1.28e-02 -1.06e-04  1.26e-04 -2.36e-04]
 [-6.99e-01 -1.44e+00 -1.64e-01 -4.16e-01  1.02e-01  2.85e-02  2.78e-01 -1.55e-01
  -2.65e-01  2.60e-02 -1.06e-02  1.74e-02]]
SymNet parameters
[-0.32 -0.43]
SymNet parameters
[[ 2.08e-02  3.39e-02 -1.92e-03 -2.40e-02  4.06e-03  2.37e-03  1.22e+00 -9.77e-02
  -2.71e-02 -2.92e-05  2.13e-03  2.51e-03 -1.95e-02]
 [-2.07e-02 -7.65e-03  6.87e-02  1.02e-03 -5.87e-03 -4.14e-04  4.66e-03  1.09e-03
  -3.76e-03 -5.23e-04  2.54e-05 -4.07e-04  6.89e-03]]
SymNet parameters
[ 0.02 -1.34]
SymNet parameters
[[-5.43e-01 -2.88e-01  1.04e+00 -5.33e-02  1.88e-02 -1.30e-04 -2.82e-01  7.45e-03
  -8.29e-02  2.37e-03 -1.42e-03  2.33e-03  7.83e-02 -2.50e-01]
 [-8.43e-02  7.58e-02  4.39e-02 -9.88e-03 -1.03e-03 -2.58e-03  2.52e+00  3.94e-02
  -9.95e-02 -3.22e-03 -2.19e-03 -3.09e-03 -1.96e-02 -1.70e-01]]
SymNet parameters
[ 0.45 -0.38]
SymNet parameters
[[-4.57e+00 -9.12e-01  6.86e-01 -1.30e-01  2.95e-02  1.00e-02 -1.63e-01  1.90e-02
  -2.16e-01  4.63e-03 -2.77e-03  4.14e-03 -2.38e-01 -5.03e-01 -2.18e-02]
 [ 4.76e+00 -1.83e-01 -3.14e-01  2.96e-01 -2.96e-02  8.16e-03 -1.18e+00  1.17e-01
   9.41e-01  1.55e-03  3.65e-03 -5.47e-03  5.46e-01  2.22e-01 -5.65e-02]]
SymNet parameters
[ 0.04 -0.02]
SymNet parameters
[[-1.35e+00 -7.27e-01  3.54e-01  7.19e-02 -2.63e-02 -1.28e-02 -2.42e+00  2.19e-01
  -1.61e-01 -8.37e-03 -2.83e-03 -8.04e-03 -6.59e-02 -1.64e+00  3.82e-02 -7.54e-04]
 [-1.74e+00  8.59e-02  3.46e-02 -3.29e-03 -3.52e-03 -1.68e-03  3.99e-02 -2.09e-02
  -5.02e-02 -6.74e-04  1.25e-03  1.67e-04 -2.46e-01  1.26e-01  1.59e-02  1.53e-03]]
SymNet parameters
[ 0.07 -0.72]
SymNet parameters
[[ 0.25 -0.68 -0.42 -0.24  0.08  0.07  0.01 -0.06 -0.07  0.02 -0.01  0.01  2.29 -0.31
  -0.36 -0.08 -0.63]]
SymNet parameters
[-0.43]
SymNet parameters
[[-6.20e-01 -1.03e-03  3.74e-02  6.63e-04  7.04e-04  9.12e-04  1.53e-02  1.03e-03
   8.36e-03  7.33e-05  1.08e-03 -3.02e-04]
 [ 1.42e-02  4.93e-03 -1.88e-03 -2.89e-03 -3.54e-03 -5.41e-04 -4.15e-02  8.74e-01
  -1.12e-02  1.01e-03 -5.40e-02  6.16e-03]]
SymNet parameters
[-1.16  1.3 ]
SymNet parameters
[[-3.16e-02 -1.90e-02  7.57e-04 -1.91e-03  1.00e-03  3.03e-05  7.72e-01  7.29e-02
   4.45e-02  3.20e-03 -2.87e-03  2.69e-02  7.16e-02]
 [-1.74e+00  1.12e-01  9.24e-02 -5.47e-02  6.33e-02  5.25e-03  3.65e-01  6.26e-01
   3.39e+00  1.17e-01 -6.34e-03  9.56e-01  6.54e-01]]
SymNet parameters
[ 0.66 -0.42]
SymNet parameters
[[-2.80e+00  5.29e-02 -3.37e-02 -2.31e-02  1.22e-02  3.27e-03  2.99e-01  1.50e+00
   8.07e-01  6.71e-02 -5.48e-02  3.21e-01  1.14e+00  1.36e-01]
 [-2.84e-01  7.32e-02 -2.56e-02 -1.38e-01  3.69e-02  7.59e-03  1.63e+00 -5.43e+00
   3.74e+00  3.13e-01 -3.79e-01  1.43e+00  5.18e+00  5.90e-01]]
SymNet parameters
[-0.16 -0.29]
SymNet parameters
[[-1.74e-01  5.99e-02 -7.06e-03 -5.10e-02  2.49e-02  6.64e-03  5.56e-01  2.84e+00
   1.66e+00  1.26e-01 -9.91e-02  6.09e-01  2.17e+00  2.65e-01  1.15e-04]
 [-3.44e+00 -2.13e-01 -4.32e-02 -3.02e-02  2.08e-03 -5.16e-04  6.11e-01 -1.55e+00
   1.63e+00  7.86e-02 -1.07e-01  3.52e-01  1.45e+00  1.81e-01 -1.90e-04]]
SymNet parameters
[ 0.45 -0.62]
SymNet parameters
[[-8.72e-01  1.14e-01  3.20e-02 -4.44e-02  4.44e-02  3.38e-03  2.24e-01  1.10e+00
  -3.99e-01  9.00e-02 -5.15e-02  7.42e-01  1.21e+00  4.12e-03  1.20e-02 -2.24e-02]
 [ 8.54e-02 -1.26e-02 -1.32e-03  5.84e-03 -4.68e-03 -4.12e-04 -1.65e+00 -1.68e-01
  -2.26e-01 -1.10e-02  6.72e-03 -7.47e-02 -1.52e-01  9.73e-03  1.87e-04 -1.28e-03]]
SymNet parameters
[0.67 0.48]
SymNet parameters
[[-1.22e-01  1.53e-02  8.89e-03 -1.74e-02  1.66e-02  6.46e-04  1.22e-01  6.96e-01
   7.07e-01  8.66e-02 -2.43e-02  3.35e-01  5.84e-01 -3.41e-01 -2.33e-02  4.28e-02
  -2.07e-01]]
SymNet parameters
[0.46]
finally, finish this stage
iter:     0    time: 1063.11
Func: 1.73e-01  |g|: 1.79e+01
stableloss: 3.54e-02   dataloss: 1.53e-01   sparseloss: 1.20e+02 momentloss: 6.66e+00
current expression:
[u00*u01, u10*v00, u20, u02, u00, u00*u01**2, u00*u11*v00, u10*v00*v10, u00*u10*v01, u01*u10*v00, u00*u01*v00, u00**3, u00*v01, u00*u10, u00**2*v01, u00**2*v00, u20*v00, u00**2*v10, u10*v00**2, u01]
[-0.98 -0.98  0.05  0.05  0.02  0.01  0.01  0.01  0.01  0.01  0.01 -0.    0.    0.
 -0.   -0.    0.   -0.    0.    0.  ]
[v00*v10, u00*v01, v02, v20, v00*v10**2, u00*u01*v01, u00*v00*v11, u10*v00*v01, u00*v01*v10, v00**2*v10, u00*v00*v10, u01*v00*v10, v10, v01, v00*v20, v00**2*v10**2, 1, u00**2*v00*v01, v01*v10, v00**2*v01]
[-0.98 -0.97  0.05  0.05  0.02  0.01  0.01  0.01  0.01  0.01 -0.01 -0.   -0.    0.
  0.   -0.   -0.    0.   -0.    0.  ]
block:  4
name:  burgers-2-upwind-sparse0-noise0.001-id1
device:  cuda:1
generate a random number to check random seed:  -0.1305450260203233
current stage is: block-4
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.8548, device='cuda:1', dtype=torch.float64)
u_obs variance
tensor([ 0.2549,  1.6867,  1.6023, 21.2749,  9.8314, 18.6194,  0.2242,  1.4954,
         1.6000, 17.1528, 10.1487, 20.7266], device='cuda:1',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 0.313982
         Iterations: 0
         Function evaluations: 15
         Gradient evaluations: 3
convolution moment and kernels
[[ 1.00e+00  0.00e+00  1.51e-04  2.52e-02 -7.87e-02]
 [ 0.00e+00 -1.57e-05 -4.95e-04  5.13e-04  7.26e-03]
 [ 4.49e-04  1.09e-04  5.66e-03 -7.37e-03 -1.12e-03]
 [-4.63e-03 -7.54e-04  6.61e-03  1.41e-04 -1.95e-02]
 [-5.33e-02  1.08e-02  1.11e-03  8.25e-04  1.42e-03]]
[[ 0.01 -0.06  0.03 -0.05  0.01]
 [-0.03  0.16 -0.01  0.12 -0.04]
 [-0.09  0.27  0.29  0.25 -0.05]
 [ 0.02 -0.06  0.33 -0.09  0.01]
 [-0.01  0.04 -0.12  0.05 -0.01]]
[[ 0.00e+00  1.00e+00  0.00e+00 -1.06e-01 -7.03e-02]
 [ 0.00e+00  0.00e+00  2.38e-03  1.32e-03  4.18e-04]
 [ 0.00e+00  2.40e-02 -3.27e-03  2.86e-02 -1.62e-02]
 [-3.44e-03  4.18e-03  3.98e-03  3.87e-03  3.82e-03]
 [-3.75e-03 -5.55e-03  1.49e-03 -4.00e-03 -2.91e-03]]
[[-1.34e-04  1.19e-02 -2.26e-02  1.55e-02 -6.73e-03]
 [-2.95e-02  3.32e-02 -7.00e-03 -3.20e-03  1.80e-02]
 [ 1.28e-01 -5.94e-01 -3.49e-01  1.02e+00 -2.25e-01]
 [-3.38e-02  5.48e-02 -3.06e-02  1.91e-02  9.00e-03]
 [ 1.84e-03  2.59e-03 -1.25e-02  4.42e-03 -1.81e-03]]
[[ 0.00e+00  0.00e+00  0.00e+00  5.37e-03  4.99e-03]
 [ 1.00e+00  0.00e+00  9.19e-03  4.18e-04 -2.55e-02]
 [ 0.00e+00  1.38e-02 -2.97e-03 -6.38e-03 -2.02e-03]
 [-8.51e-02 -2.00e-03  2.18e-02 -3.78e-03 -1.11e-02]
 [-5.89e-02  2.66e-02 -1.32e-02  1.41e-03 -6.10e-03]]
[[-3.22e-04 -3.44e-02  1.10e-01 -6.96e-03 -8.57e-04]
 [ 2.38e-02  1.72e-02 -5.12e-01 -6.62e-02  2.06e-02]
 [-2.51e-02 -4.26e-02 -3.33e-01  6.42e-02 -1.61e-02]
 [ 1.10e-02  2.78e-02  1.00e+00 -6.64e-02  1.52e-02]
 [-7.10e-03  1.75e-02 -2.34e-01  5.00e-02 -1.11e-02]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00  1.93e-03]
 [ 0.00e+00  0.00e+00  0.00e+00 -2.28e-03 -2.71e-04]
 [ 0.00e+00  0.00e+00  4.94e-03 -1.38e-03 -3.79e-03]
 [ 0.00e+00  5.44e-06  2.81e-03  1.19e-03  5.12e-04]
 [ 1.06e-02 -4.98e-03 -2.98e-03  4.49e-03 -2.39e-04]]
[[-2.13e-03  1.56e-03  2.14e-02 -1.27e-02  2.53e-03]
 [ 5.03e-03  1.17e-02 -1.16e-01  7.24e-02 -1.54e-02]
 [-8.85e-02  1.30e+00 -2.30e+00  1.20e+00 -5.31e-02]
 [ 6.81e-03  4.31e-03 -1.10e-01  7.59e-02 -1.90e-02]
 [-2.59e-03  4.64e-03  1.77e-02 -1.28e-02  3.63e-03]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  3.24e-03]
 [ 0.00e+00  1.00e+00  0.00e+00 -2.35e-03  5.20e-03]
 [ 0.00e+00  0.00e+00  1.63e-03  1.36e-03 -3.39e-03]
 [ 0.00e+00 -2.14e-03 -5.95e-04  3.84e-03 -2.59e-03]
 [-9.21e-04 -4.32e-03 -2.46e-03  2.46e-03  6.58e-03]]
[[ 0.02 -0.09  0.06  0.02  0.  ]
 [-0.09  0.59 -0.25 -0.27  0.02]
 [ 0.04 -0.2   0.35 -0.26  0.06]
 [ 0.04 -0.35 -0.18  0.59 -0.09]
 [-0.    0.04  0.04 -0.09  0.01]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  4.21e-02]
 [ 0.00e+00  0.00e+00  0.00e+00 -1.46e-03 -6.33e-04]
 [ 1.00e+00  0.00e+00  5.17e-03  8.95e-04 -3.83e-03]
 [ 0.00e+00 -2.30e-04  3.36e-03  5.10e-04  1.37e-03]
 [ 8.17e-03 -1.95e-03 -5.27e-03 -2.49e-04  1.63e-03]]
[[ 2.02e-03 -1.42e-02 -4.95e-02 -1.52e-02  1.63e-03]
 [-1.36e-02  7.97e-02  1.16e+00  8.25e-02 -1.12e-02]
 [ 6.61e-02 -3.01e-01 -1.97e+00 -3.09e-01  6.43e-02]
 [-1.51e-02  8.18e-02  1.16e+00  9.11e-02 -1.58e-02]
 [ 2.82e-03 -1.47e-02 -4.90e-02 -1.75e-02  3.22e-03]]
SymNet parameters
[[ 1.84e-01 -4.88e-05 -1.11e-02  5.55e-03 -1.00e-03 -1.47e-04  1.54e-02  2.65e-03
   1.27e-02 -1.02e-04  1.36e-04 -2.80e-04]
 [-6.99e-01 -1.44e+00 -1.64e-01 -4.16e-01  1.02e-01  2.85e-02  2.78e-01 -1.55e-01
  -2.65e-01  2.60e-02 -1.07e-02  1.74e-02]]
SymNet parameters
[-0.32 -0.43]
SymNet parameters
[[ 2.08e-02  3.39e-02 -1.93e-03 -2.41e-02  4.07e-03  2.28e-03  1.22e+00 -9.77e-02
  -2.71e-02 -1.98e-05  2.11e-03  2.54e-03 -1.95e-02]
 [-2.07e-02 -7.67e-03  6.87e-02  1.06e-03 -5.89e-03 -4.48e-04  4.65e-03  1.09e-03
  -3.75e-03 -5.41e-04  4.89e-05 -4.37e-04  6.88e-03]]
SymNet parameters
[ 0.02 -1.34]
SymNet parameters
[[-5.43e-01 -2.88e-01  1.04e+00 -5.33e-02  1.88e-02 -1.75e-04 -2.82e-01  7.46e-03
  -8.29e-02  2.35e-03 -1.41e-03  2.32e-03  7.83e-02 -2.50e-01]
 [-8.43e-02  7.58e-02  4.39e-02 -9.88e-03 -1.03e-03 -2.58e-03  2.52e+00  3.94e-02
  -9.95e-02 -3.22e-03 -2.19e-03 -3.09e-03 -1.96e-02 -1.70e-01]]
SymNet parameters
[ 0.45 -0.38]
SymNet parameters
[[-4.57e+00 -9.12e-01  6.86e-01 -1.30e-01  2.95e-02  1.00e-02 -1.63e-01  1.90e-02
  -2.16e-01  4.63e-03 -2.77e-03  4.14e-03 -2.38e-01 -5.03e-01 -2.18e-02]
 [ 4.76e+00 -1.83e-01 -3.14e-01  2.96e-01 -2.96e-02  8.16e-03 -1.18e+00  1.17e-01
   9.41e-01  1.55e-03  3.65e-03 -5.47e-03  5.46e-01  2.22e-01 -5.65e-02]]
SymNet parameters
[ 0.04 -0.02]
SymNet parameters
[[-1.35e+00 -7.27e-01  3.54e-01  7.19e-02 -2.63e-02 -1.28e-02 -2.42e+00  2.19e-01
  -1.61e-01 -8.36e-03 -2.84e-03 -8.03e-03 -6.59e-02 -1.64e+00  3.82e-02 -9.05e-04]
 [-1.74e+00  8.59e-02  3.46e-02 -3.29e-03 -3.52e-03 -1.69e-03  3.99e-02 -2.09e-02
  -5.02e-02 -6.84e-04  1.25e-03  1.67e-04 -2.46e-01  1.26e-01  1.59e-02  1.41e-03]]
SymNet parameters
[ 0.07 -0.72]
SymNet parameters
[[ 0.25 -0.68 -0.42 -0.24  0.08  0.07  0.01 -0.06 -0.07  0.02 -0.01  0.01  2.29 -0.31
  -0.36 -0.08 -0.63]]
SymNet parameters
[-0.43]
SymNet parameters
[[-6.20e-01 -1.03e-03  3.74e-02  6.62e-04  7.05e-04  9.11e-04  1.53e-02  1.03e-03
   8.35e-03  7.22e-05  1.08e-03 -3.04e-04]
 [ 1.42e-02  4.93e-03 -1.88e-03 -2.89e-03 -3.54e-03 -5.41e-04 -4.15e-02  8.74e-01
  -1.12e-02  1.02e-03 -5.40e-02  6.16e-03]]
SymNet parameters
[-1.16  1.3 ]
SymNet parameters
[[-3.16e-02 -1.90e-02  7.54e-04 -1.91e-03  9.96e-04  3.67e-05  7.72e-01  7.29e-02
   4.45e-02  3.18e-03 -2.85e-03  2.69e-02  7.16e-02]
 [-1.74e+00  1.12e-01  9.24e-02 -5.47e-02  6.33e-02  5.25e-03  3.65e-01  6.26e-01
   3.39e+00  1.17e-01 -6.34e-03  9.56e-01  6.54e-01]]
SymNet parameters
[ 0.66 -0.42]
SymNet parameters
[[-2.80e+00  5.29e-02 -3.37e-02 -2.31e-02  1.22e-02  3.27e-03  2.99e-01  1.50e+00
   8.07e-01  6.71e-02 -5.48e-02  3.21e-01  1.14e+00  1.36e-01]
 [-2.84e-01  7.32e-02 -2.56e-02 -1.38e-01  3.69e-02  7.59e-03  1.63e+00 -5.43e+00
   3.74e+00  3.13e-01 -3.79e-01  1.43e+00  5.18e+00  5.90e-01]]
SymNet parameters
[-0.16 -0.29]
SymNet parameters
[[-1.74e-01  5.99e-02 -7.06e-03 -5.10e-02  2.49e-02  6.64e-03  5.56e-01  2.84e+00
   1.66e+00  1.26e-01 -9.91e-02  6.09e-01  2.17e+00  2.65e-01 -3.77e-04]
 [-3.44e+00 -2.13e-01 -4.32e-02 -3.02e-02  2.08e-03 -5.17e-04  6.11e-01 -1.55e+00
   1.63e+00  7.86e-02 -1.07e-01  3.52e-01  1.45e+00  1.81e-01 -5.21e-04]]
SymNet parameters
[ 0.45 -0.62]
SymNet parameters
[[-8.72e-01  1.14e-01  3.20e-02 -4.44e-02  4.44e-02  3.38e-03  2.24e-01  1.10e+00
  -3.99e-01  9.00e-02 -5.15e-02  7.42e-01  1.21e+00  4.13e-03  1.21e-02 -2.24e-02]
 [ 8.54e-02 -1.26e-02 -1.32e-03  5.84e-03 -4.68e-03 -4.10e-04 -1.65e+00 -1.68e-01
  -2.26e-01 -1.10e-02  6.72e-03 -7.47e-02 -1.52e-01  9.72e-03  6.53e-04 -1.10e-03]]
SymNet parameters
[0.67 0.48]
SymNet parameters
[[-1.22e-01  1.52e-02  8.89e-03 -1.74e-02  1.66e-02  6.46e-04  1.22e-01  6.96e-01
   7.07e-01  8.66e-02 -2.43e-02  3.35e-01  5.84e-01 -3.41e-01 -2.28e-02  4.30e-02
  -2.07e-01]]
SymNet parameters
[0.46]
finally, finish this stage
iter:     0    time: 64.97
Func: 3.14e-01  |g|: 5.87e+01
stableloss: 4.10e-02   dataloss: 2.87e-01   sparseloss: 1.20e+02 momentloss: 6.66e+00
current expression:
[u00*u01, u10*v00, u20, u02, u00, u00*u01**2, u00*u11*v00, u10*v00*v10, u00*u10*v01, u01*u10*v00, u00*u01*v00, u00**3, u00*v01, u00*u10, u00**2*v01, u00**2*v00, u20*v00, u00**2*v10, u10*v00**2, u01]
[-0.98 -0.98  0.05  0.05  0.02  0.01  0.01  0.01  0.01  0.01  0.01 -0.    0.    0.
 -0.   -0.    0.   -0.    0.    0.  ]
[v00*v10, u00*v01, v02, v20, v00*v10**2, u00*u01*v01, u00*v00*v11, u10*v00*v01, u00*v01*v10, v00**2*v10, u00*v00*v10, u01*v00*v10, v10, v01, v00*v20, v00**2*v10**2, 1, u00**2*v00*v01, v01*v10, v00**2*v01]
[-0.98 -0.97  0.05  0.05  0.02  0.01  0.01  0.01  0.01  0.01 -0.01 -0.   -0.    0.
  0.   -0.   -0.    0.   -0.    0.  ]
block:  5
name:  burgers-2-upwind-sparse0-noise0.001-id1
device:  cuda:1
generate a random number to check random seed:  1.2687885664749432
current stage is: block-5
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.9944, device='cuda:1', dtype=torch.float64)
u_obs variance
tensor([ 0.2779,  1.8379,  1.8044, 22.8598, 11.2646, 20.3268,  0.2497,  1.5763,
         1.7853, 18.0454, 10.4318, 22.8566], device='cuda:1',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
iter:     0    time: 63.63
Func: 5.76e-01  |g|: 1.23e+02
stableloss: 5.55e-02   dataloss: 5.43e-01   sparseloss: 1.20e+02 momentloss: 6.66e+00
iter:   200    time: 28.30
Func: 3.13e-01  |g|: 3.87e+00
stableloss: 5.30e-02   dataloss: 2.75e-01   sparseloss: 1.17e+02 momentloss: 7.69e+00
iter:   400    time: 34.00
Func: 3.04e-01  |g|: 1.94e+00
stableloss: 5.22e-02   dataloss: 2.67e-01   sparseloss: 1.12e+02 momentloss: 7.41e+00
iter:   600    time: 37.35
Func: 2.99e-01  |g|: 5.26e-01
stableloss: 5.23e-02   dataloss: 2.63e-01   sparseloss: 1.15e+02 momentloss: 7.26e+00
iter:   800    time: 34.85
Func: 2.97e-01  |g|: 4.25e-01
stableloss: 5.33e-02   dataloss: 2.60e-01   sparseloss: 1.22e+02 momentloss: 7.37e+00
iter:  1000    time: 27.02
Func: 2.96e-01  |g|: 2.15e-01
stableloss: 5.34e-02   dataloss: 2.59e-01   sparseloss: 1.23e+02 momentloss: 7.42e+00
iter:  1200    time: 27.14
Func: 2.96e-01  |g|: 1.78e-01
stableloss: 5.33e-02   dataloss: 2.59e-01   sparseloss: 1.26e+02 momentloss: 7.45e+00
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 0.296152
         Iterations: 1245
         Function evaluations: 1321
         Gradient evaluations: 1302
convolution moment and kernels
[[ 1.00e+00  0.00e+00  4.03e-04 -1.16e-02 -9.81e-02]
 [ 0.00e+00  8.81e-04 -2.53e-02  3.39e-03 -5.65e-02]
 [ 9.41e-04  2.87e-03  3.88e-02  6.03e-03  1.29e-03]
 [ 4.31e-02 -1.84e-03  2.36e-02 -2.18e-02 -3.40e-03]
 [-8.56e-02 -4.46e-04 -3.15e-03  1.48e-02  5.85e-03]]
[[-0.01 -0.01 -0.04 -0.06  0.02]
 [ 0.04  0.01  0.2   0.17 -0.03]
 [-0.09  0.18  0.38  0.04 -0.02]
 [-0.04  0.22 -0.09  0.29 -0.07]
 [ 0.01 -0.02 -0.03 -0.03  0.01]]
[[ 0.    1.    0.   -0.07 -0.05]
 [ 0.    0.    0.   -0.    0.  ]
 [ 0.    0.03  0.03  0.05 -0.  ]
 [ 0.01 -0.    0.01 -0.01  0.02]
 [ 0.   -0.01  0.02 -0.01  0.  ]]
[[-0.01  0.05 -0.08  0.04 -0.01]
 [-0.03 -0.05  0.13 -0.09  0.04]
 [ 0.15 -0.61 -0.27  0.95 -0.2 ]
 [-0.07  0.08 -0.07  0.03  0.01]
 [ 0.02 -0.02  0.02 -0.02  0.01]]
[[ 0.00e+00  0.00e+00  0.00e+00  8.30e-03  6.56e-03]
 [ 1.00e+00  0.00e+00  2.44e-02  4.97e-04 -5.58e-03]
 [ 0.00e+00  1.80e-02 -3.87e-02  3.95e-02 -6.08e-03]
 [-7.24e-02  1.14e-03  1.71e-02  7.12e-03 -1.25e-02]
 [-9.66e-02  1.12e-02 -6.44e-02  2.40e-02 -1.98e-02]]
[[-1.57e-02 -2.51e-02  1.11e-01 -4.71e-02 -8.28e-05]
 [ 6.17e-02  2.84e-03 -4.95e-01  4.92e-02  2.86e-02]
 [-9.79e-02  4.11e-02 -4.39e-01 -3.56e-02 -4.83e-02]
 [ 8.61e-02 -8.17e-02  1.09e+00 -1.12e-02  3.98e-02]
 [-3.18e-02  4.49e-02 -2.30e-01  1.03e-02 -9.32e-03]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00 -5.33e-02]
 [ 0.00e+00  0.00e+00  0.00e+00  1.42e-03  1.50e-02]
 [ 0.00e+00  0.00e+00  7.60e-03  7.55e-03 -3.49e-03]
 [ 0.00e+00 -7.50e-04 -4.67e-04 -4.23e-03 -7.98e-02]
 [ 9.61e-02  3.48e-03  3.76e-03 -3.94e-03  5.71e-03]]
[[ 4.84e-02 -1.89e-01  3.71e-01 -1.79e-01  4.54e-02]
 [-1.28e-01  4.92e-01 -1.07e+00  4.32e-01 -1.05e-01]
 [-7.10e-02  1.32e+00 -1.99e+00  1.44e+00 -1.17e-01]
 [ 4.61e-02 -2.15e-01  6.43e-04 -2.95e-01  7.93e-02]
 [-3.17e-02  1.36e-01 -1.22e-01  1.53e-01 -3.91e-02]]
[[ 0.    0.    0.    0.   -0.01]
 [ 0.    1.    0.   -0.01 -0.02]
 [ 0.    0.   -0.   -0.    0.  ]
 [ 0.   -0.   -0.    0.06  0.05]
 [ 0.    0.    0.   -0.01 -0.01]]
[[-0.01  0.06 -0.23  0.25 -0.06]
 [ 0.    0.11  0.66 -1.    0.21]
 [-0.05  0.25 -0.46  0.38 -0.1 ]
 [ 0.05 -0.39 -0.12  0.54 -0.09]
 [ 0.    0.    0.11 -0.15  0.04]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  4.65e-02]
 [ 0.00e+00  0.00e+00  0.00e+00  3.02e-04 -3.32e-03]
 [ 1.00e+00  0.00e+00  6.33e-03  6.84e-03 -3.79e-03]
 [ 0.00e+00 -4.21e-04 -7.87e-03 -2.93e-03  1.99e-02]
 [ 2.77e-03  2.73e-03  2.02e-02 -3.91e-03 -9.29e-03]]
[[-1.94e-02  1.03e-01 -2.55e-01  1.13e-01 -2.29e-02]
 [ 4.92e-02 -2.95e-01  1.85e+00 -3.53e-01  7.27e-02]
 [ 1.31e-02  8.83e-02 -2.75e+00  1.91e-01 -3.02e-02]
 [ 5.11e-04 -9.10e-02  1.54e+00 -1.61e-01  3.01e-02]
 [ 3.15e-03  8.27e-03 -1.12e-01  2.36e-02 -3.23e-03]]
SymNet parameters
[[ 1.11e-01 -2.79e-03 -3.36e-03  1.64e-03 -6.14e-05 -3.18e-06  1.92e-02 -5.34e-04
   4.00e-03  1.09e-04  1.56e-04 -2.18e-06]
 [ 1.32e+00 -1.98e+00 -3.56e-01 -4.40e-01 -1.51e-02 -4.35e-02 -2.87e-01  1.46e-01
   4.87e-04 -5.37e-03 -3.05e-02  1.32e-02]]
SymNet parameters
[-0.5  -0.13]
SymNet parameters
[[-6.75e-03  1.34e-02  7.80e-03  7.97e-03  6.21e-04  2.68e-03  1.66e+00 -6.15e-02
   1.12e-02 -1.60e-03  6.32e-04 -2.79e-03 -2.61e-02]
 [ 2.52e-02 -2.10e-02  1.93e-01 -5.52e-03 -7.00e-03 -4.77e-04 -4.73e-03  1.97e-03
  -6.57e-03 -1.79e-04 -4.15e-04 -2.64e-05  2.25e-02]]
SymNet parameters
[-0.7  -1.07]
SymNet parameters
[[ 1.99e-01 -2.07e-01  9.23e-01 -4.96e-02  1.43e-02 -4.75e-03 -9.16e-03  1.75e-02
  -3.27e-02 -9.88e-04 -3.11e-03  1.84e-03  1.00e-01  2.00e-02]
 [-6.79e-02  7.35e-02  3.15e-02  4.09e-02  1.75e-04  2.43e-03  2.88e+00  3.14e-02
   1.57e-02 -2.35e-03  4.13e-03 -4.15e-03 -4.51e-02  1.08e-03]]
SymNet parameters
[0.87 0.37]
SymNet parameters
[[-2.98e+00 -2.42e+00 -7.72e-01  8.21e-02  2.70e-02  3.69e-02 -4.04e+00  1.56e-01
  -1.29e-01  9.59e-03  1.24e-02 -2.10e-02 -3.00e-01 -3.55e+00  1.71e-01]
 [ 4.71e+00 -7.44e-01  1.54e-01  5.71e-02 -1.64e-02 -2.89e-04 -2.99e-01 -4.19e-02
   6.01e-01  4.51e-03  3.07e-03  3.17e-03  6.72e-01 -4.21e-01 -1.06e-02]]
SymNet parameters
[1.31 0.76]
SymNet parameters
[[-1.11e+00 -1.44e+00 -2.38e-01  1.41e-01  1.59e-02  1.83e-02 -2.75e+00  5.35e-02
  -9.32e-02  4.50e-03  1.10e-02 -5.57e-03 -7.09e-02 -1.78e+00  1.52e-01  3.08e-04]
 [-1.21e+00  1.19e-01 -1.98e-02  8.75e-03  1.58e-03  2.18e-03  6.12e-02 -1.85e-03
  -4.73e-02 -2.65e-05  5.26e-04 -6.48e-04 -1.25e-01  7.22e-02  4.37e-03 -2.44e-04]]
SymNet parameters
[ 0.77 -0.92]
SymNet parameters
[[ 1.86e+00 -1.13e+00 -2.56e-01 -4.22e-01 -1.59e-02  6.45e-04  3.70e-02  1.79e-01
   2.46e-02 -5.83e-03 -3.27e-02  1.69e-02  1.85e+00 -1.06e-01 -3.23e-01 -3.28e-02
  -5.56e-01]]
SymNet parameters
[0.3]
SymNet parameters
[[-2.70e-01  8.44e-04  1.85e-02  8.60e-05 -1.42e-04  3.34e-04  8.04e-03  3.98e-04
  -1.43e-05  5.13e-04  1.93e-04 -2.11e-04]
 [ 1.39e-02 -7.70e-03  8.97e-04 -6.24e-05  5.04e-04 -8.56e-05 -3.43e-02  3.91e-01
  -4.91e-03 -2.48e-03 -2.83e-02  7.08e-04]]
SymNet parameters
[-1.04  1.2 ]
SymNet parameters
[[-1.73e-03 -5.01e-02 -3.89e-03  8.04e-04  4.73e-04  2.46e-04  8.10e-01  2.87e-02
  -6.52e-03  7.48e-03 -1.08e-03  1.76e-03  5.15e-02]
 [-1.21e+00 -1.07e-01  7.35e-02 -4.73e-04  2.32e-03  4.89e-03 -1.70e+00 -1.19e+00
   2.03e+00 -7.17e-02  8.49e-02  8.05e-03 -2.71e+00]]
SymNet parameters
[ 1.19 -2.3 ]
SymNet parameters
[[-5.77e+00  4.86e-03 -8.82e-02  8.51e-03  1.31e-04  6.72e-03  1.85e-01  1.13e-01
   8.82e-03  3.19e-02 -6.37e-03  2.10e-03  1.51e-01  7.84e-03]
 [ 7.08e-01 -9.99e-02 -2.65e-01  1.98e-01  2.79e-02 -8.75e-02  6.21e+00 -4.60e+00
  -7.43e-01  4.90e+00 -3.49e-02  5.95e-01 -2.70e-01  1.01e+00]]
SymNet parameters
[-0.63 -0.78]
SymNet parameters
[[ 1.61e-01 -6.46e-02 -5.83e-02  4.12e-02  5.75e-03 -1.79e-02  1.07e+00  1.59e+00
  -1.14e-01  1.01e+00  1.75e-02  1.24e-01  2.50e-02  2.16e-01  4.02e-04]
 [-7.42e+00  4.44e-02 -9.54e-02  1.13e-02 -2.04e-03  6.22e-03 -4.74e-02 -1.09e-01
   5.38e-02  3.25e-02  3.32e-03  4.05e-03 -1.64e-01  1.81e-02 -1.05e-05]]
SymNet parameters
[-0.75  0.8 ]
SymNet parameters
[[ 6.85e-03  8.82e-02 -8.05e-03  4.93e-04  2.28e-03 -8.03e-04 -1.56e+00  3.89e-01
  -1.44e+00 -1.28e-02 -3.14e-02  1.25e-02  1.20e+00  1.64e-02  5.31e-03 -2.02e-02]
 [ 8.87e-02 -9.18e-02 -7.82e-03  7.42e-04  8.33e-04  7.09e-04 -1.17e+00  6.37e-02
  -6.26e-02  1.52e-02 -4.11e-03  3.48e-03  1.53e-01  1.77e-02  2.78e-04 -1.16e-03]]
SymNet parameters
[ 0.91 -0.63]
SymNet parameters
[[-2.90e-01 -6.67e-02  6.28e-03 -4.03e-03 -2.83e-05  3.23e-03 -1.52e-02 -4.64e-02
   1.07e+00 -7.63e-02  2.10e-03  3.98e-02 -7.89e-03 -3.58e-01 -1.31e-02  5.08e-02
  -2.55e-01]]
SymNet parameters
[0.55]
finally, finish this stage
iter:  1245    time: 12.50
Func: 2.96e-01  |g|: 1.92e-01
stableloss: 5.33e-02   dataloss: 2.59e-01   sparseloss: 1.27e+02 momentloss: 7.44e+00
current expression:
[u00*u01, u10*v00, u20, u02, u00, u00*u01**2, u01*u10*v00, u10*v00*v10, u00*u11*v00, u00*u10*v01, u01*u10, u00**3, 1, u00**2, u01*v00**2, u10*v10, u00**2*u02, u00*v00**2, u10, v00**2]
[-0.99 -0.99  0.05  0.05  0.01  0.01  0.01  0.01  0.01  0.01 -0.   -0.   -0.    0.
  0.   -0.    0.   -0.    0.    0.  ]
[u00*v01, v00*v10, v20, v02, v00, v00*v10**2, u00*u01*v01, u00*v01*v10, u00*v00*v11, u10*v00*v01, v00**3, 1, v00**2, u00**2*v02, v01, u00*v00, v10**2, u10*v01, u01, u00*v00**2*v01]
[-0.99 -0.99  0.05  0.05  0.01  0.01  0.01  0.01  0.01  0.01 -0.01 -0.01  0.    0.
  0.    0.   -0.   -0.    0.    0.  ]
block:  6
name:  burgers-2-upwind-sparse0-noise0.001-id1
device:  cuda:1
generate a random number to check random seed:  4.319667494207161
current stage is: block-6
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.8337, device='cuda:1', dtype=torch.float64)
u_obs variance
tensor([ 0.2472,  1.5189,  1.6144, 20.7739, 10.0929, 19.0386,  0.2666,  1.7504,
         1.8112, 21.8204, 11.8767, 24.3917], device='cuda:1',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 0.735125
         Iterations: 0
         Function evaluations: 15
         Gradient evaluations: 3
convolution moment and kernels
[[ 1.00e+00  0.00e+00  4.03e-04 -1.16e-02 -9.81e-02]
 [ 0.00e+00  8.77e-04 -2.53e-02  3.39e-03 -5.65e-02]
 [ 9.38e-04  2.87e-03  3.88e-02  6.03e-03  1.29e-03]
 [ 4.31e-02 -1.84e-03  2.36e-02 -2.18e-02 -3.41e-03]
 [-8.56e-02 -4.50e-04 -3.15e-03  1.48e-02  5.85e-03]]
[[-0.01 -0.01 -0.04 -0.06  0.02]
 [ 0.04  0.01  0.2   0.17 -0.03]
 [-0.09  0.18  0.38  0.04 -0.02]
 [-0.04  0.22 -0.09  0.29 -0.07]
 [ 0.01 -0.02 -0.03 -0.03  0.01]]
[[ 0.    1.    0.   -0.07 -0.05]
 [ 0.    0.    0.   -0.    0.  ]
 [ 0.    0.03  0.03  0.05 -0.  ]
 [ 0.01 -0.    0.01 -0.01  0.02]
 [ 0.   -0.01  0.02 -0.01  0.  ]]
[[-0.01  0.05 -0.08  0.04 -0.01]
 [-0.03 -0.05  0.13 -0.08  0.04]
 [ 0.15 -0.61 -0.27  0.95 -0.2 ]
 [-0.07  0.08 -0.07  0.03  0.01]
 [ 0.02 -0.02  0.02 -0.02  0.01]]
[[ 0.00e+00  0.00e+00  0.00e+00  8.31e-03  6.57e-03]
 [ 1.00e+00  0.00e+00  2.44e-02  4.98e-04 -5.57e-03]
 [ 0.00e+00  1.80e-02 -3.87e-02  3.95e-02 -6.08e-03]
 [-7.24e-02  1.14e-03  1.71e-02  7.12e-03 -1.25e-02]
 [-9.66e-02  1.12e-02 -6.44e-02  2.40e-02 -1.98e-02]]
[[-1.57e-02 -2.51e-02  1.11e-01 -4.72e-02 -6.06e-05]
 [ 6.17e-02  3.09e-03 -4.96e-01  4.95e-02  2.86e-02]
 [-9.78e-02  4.08e-02 -4.38e-01 -3.61e-02 -4.81e-02]
 [ 8.60e-02 -8.16e-02  1.09e+00 -1.10e-02  3.97e-02]
 [-3.18e-02  4.49e-02 -2.30e-01  1.02e-02 -9.31e-03]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00 -5.33e-02]
 [ 0.00e+00  0.00e+00  0.00e+00  1.42e-03  1.50e-02]
 [ 0.00e+00  0.00e+00  7.60e-03  7.55e-03 -3.50e-03]
 [ 0.00e+00 -7.49e-04 -4.65e-04 -4.23e-03 -7.98e-02]
 [ 9.61e-02  3.47e-03  3.76e-03 -3.94e-03  5.71e-03]]
[[ 4.84e-02 -1.89e-01  3.71e-01 -1.79e-01  4.54e-02]
 [-1.28e-01  4.92e-01 -1.07e+00  4.32e-01 -1.05e-01]
 [-7.09e-02  1.32e+00 -1.99e+00  1.44e+00 -1.17e-01]
 [ 4.61e-02 -2.15e-01  6.27e-04 -2.95e-01  7.93e-02]
 [-3.17e-02  1.36e-01 -1.22e-01  1.53e-01 -3.91e-02]]
[[ 0.    0.    0.    0.   -0.01]
 [ 0.    1.    0.   -0.01 -0.02]
 [ 0.    0.   -0.   -0.    0.  ]
 [ 0.   -0.   -0.    0.06  0.05]
 [ 0.    0.    0.   -0.01 -0.01]]
[[-0.01  0.06 -0.23  0.25 -0.06]
 [ 0.    0.11  0.66 -1.    0.21]
 [-0.05  0.25 -0.46  0.38 -0.1 ]
 [ 0.05 -0.39 -0.12  0.54 -0.09]
 [ 0.    0.    0.11 -0.15  0.04]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  4.65e-02]
 [ 0.00e+00  0.00e+00  0.00e+00  3.02e-04 -3.31e-03]
 [ 1.00e+00  0.00e+00  6.33e-03  6.84e-03 -3.79e-03]
 [ 0.00e+00 -4.22e-04 -7.86e-03 -2.93e-03  1.99e-02]
 [ 2.78e-03  2.73e-03  2.02e-02 -3.91e-03 -9.29e-03]]
[[-1.94e-02  1.03e-01 -2.55e-01  1.13e-01 -2.29e-02]
 [ 4.92e-02 -2.95e-01  1.85e+00 -3.53e-01  7.27e-02]
 [ 1.31e-02  8.83e-02 -2.75e+00  1.91e-01 -3.02e-02]
 [ 5.13e-04 -9.10e-02  1.54e+00 -1.61e-01  3.01e-02]
 [ 3.15e-03  8.26e-03 -1.12e-01  2.36e-02 -3.23e-03]]
SymNet parameters
[[ 1.11e-01 -2.86e-03 -3.32e-03  1.80e-03 -9.99e-05 -2.87e-05  1.92e-02 -4.92e-04
   3.98e-03  7.37e-05  1.24e-04 -3.61e-05]
 [ 1.32e+00 -1.98e+00 -3.56e-01 -4.40e-01 -1.51e-02 -4.35e-02 -2.87e-01  1.46e-01
   4.77e-04 -5.36e-03 -3.05e-02  1.32e-02]]
SymNet parameters
[-0.5  -0.13]
SymNet parameters
[[-6.75e-03  1.34e-02  7.80e-03  7.97e-03  6.17e-04  2.67e-03  1.66e+00 -6.15e-02
   1.12e-02 -1.61e-03  6.22e-04 -2.78e-03 -2.61e-02]
 [ 2.52e-02 -2.10e-02  1.93e-01 -5.53e-03 -7.00e-03 -5.29e-04 -4.73e-03  1.97e-03
  -6.58e-03 -1.99e-04 -4.23e-04 -4.60e-05  2.24e-02]]
SymNet parameters
[-0.7  -1.07]
SymNet parameters
[[ 1.99e-01 -2.07e-01  9.23e-01 -4.96e-02  1.43e-02 -4.78e-03 -9.15e-03  1.75e-02
  -3.27e-02 -9.84e-04 -3.11e-03  1.84e-03  1.00e-01  2.00e-02]
 [-6.79e-02  7.35e-02  3.15e-02  4.09e-02  1.74e-04  2.43e-03  2.88e+00  3.14e-02
   1.57e-02 -2.35e-03  4.12e-03 -4.15e-03 -4.51e-02  1.08e-03]]
SymNet parameters
[0.87 0.37]
SymNet parameters
[[-2.98e+00 -2.42e+00 -7.72e-01  8.20e-02  2.70e-02  3.69e-02 -4.04e+00  1.57e-01
  -1.29e-01  9.59e-03  1.24e-02 -2.10e-02 -3.00e-01 -3.55e+00  1.71e-01]
 [ 4.71e+00 -7.44e-01  1.54e-01  5.71e-02 -1.64e-02 -2.91e-04 -2.99e-01 -4.20e-02
   6.01e-01  4.51e-03  3.07e-03  3.17e-03  6.72e-01 -4.21e-01 -1.06e-02]]
SymNet parameters
[1.31 0.76]
SymNet parameters
[[-1.11e+00 -1.44e+00 -2.38e-01  1.41e-01  1.59e-02  1.83e-02 -2.75e+00  5.35e-02
  -9.32e-02  4.50e-03  1.10e-02 -5.57e-03 -7.09e-02 -1.78e+00  1.52e-01  2.54e-04]
 [-1.21e+00  1.19e-01 -1.98e-02  8.74e-03  1.59e-03  2.17e-03  6.12e-02 -1.85e-03
  -4.73e-02 -2.52e-06  5.27e-04 -6.30e-04 -1.25e-01  7.22e-02  4.33e-03 -5.40e-04]]
SymNet parameters
[ 0.77 -0.92]
SymNet parameters
[[ 1.86e+00 -1.13e+00 -2.56e-01 -4.22e-01 -1.59e-02  6.42e-04  3.70e-02  1.79e-01
   2.46e-02 -5.83e-03 -3.27e-02  1.69e-02  1.85e+00 -1.06e-01 -3.23e-01 -3.26e-02
  -5.56e-01]]
SymNet parameters
[0.3]
SymNet parameters
[[-2.70e-01  8.45e-04  1.85e-02  1.08e-04 -1.36e-04  3.47e-04  8.06e-03  4.11e-04
  -1.47e-05  4.49e-04  1.86e-04 -2.21e-04]
 [ 1.39e-02 -7.70e-03  8.95e-04 -6.89e-05  4.99e-04 -8.90e-05 -3.43e-02  3.91e-01
  -4.90e-03 -2.43e-03 -2.83e-02  7.13e-04]]
SymNet parameters
[-1.04  1.2 ]
SymNet parameters
[[-1.72e-03 -5.01e-02 -3.89e-03  8.02e-04  4.78e-04  2.58e-04  8.10e-01  2.87e-02
  -6.51e-03  7.47e-03 -1.08e-03  1.76e-03  5.15e-02]
 [-1.21e+00 -1.07e-01  7.35e-02 -4.75e-04  2.32e-03  4.88e-03 -1.70e+00 -1.19e+00
   2.03e+00 -7.17e-02  8.49e-02  8.05e-03 -2.71e+00]]
SymNet parameters
[ 1.19 -2.3 ]
SymNet parameters
[[-5.76e+00  4.85e-03 -8.82e-02  8.52e-03  1.30e-04  6.72e-03  1.85e-01  1.13e-01
   8.84e-03  3.19e-02 -6.37e-03  2.10e-03  1.51e-01  7.84e-03]
 [ 7.08e-01 -9.99e-02 -2.65e-01  1.98e-01  2.79e-02 -8.75e-02  6.21e+00 -4.60e+00
  -7.43e-01  4.90e+00 -3.49e-02  5.95e-01 -2.69e-01  1.01e+00]]
SymNet parameters
[-0.63 -0.78]
SymNet parameters
[[ 1.61e-01 -6.46e-02 -5.83e-02  4.12e-02  5.76e-03 -1.79e-02  1.07e+00  1.59e+00
  -1.14e-01  1.01e+00  1.75e-02  1.24e-01  2.52e-02  2.16e-01  3.01e-04]
 [-7.42e+00  4.44e-02 -9.54e-02  1.13e-02 -2.04e-03  6.22e-03 -4.74e-02 -1.09e-01
   5.38e-02  3.25e-02  3.32e-03  4.06e-03 -1.64e-01  1.81e-02  1.27e-05]]
SymNet parameters
[-0.75  0.8 ]
SymNet parameters
[[ 6.78e-03  8.82e-02 -8.04e-03  4.97e-04  2.28e-03 -8.00e-04 -1.56e+00  3.89e-01
  -1.44e+00 -1.28e-02 -3.14e-02  1.25e-02  1.20e+00  1.64e-02  5.24e-03 -2.02e-02]
 [ 8.87e-02 -9.18e-02 -7.82e-03  7.47e-04  8.35e-04  7.02e-04 -1.17e+00  6.36e-02
  -6.26e-02  1.52e-02 -4.10e-03  3.49e-03  1.53e-01  1.76e-02  3.68e-04 -1.15e-03]]
SymNet parameters
[ 0.91 -0.63]
SymNet parameters
[[-2.90e-01 -6.67e-02  6.28e-03 -4.02e-03 -3.11e-05  3.24e-03 -1.52e-02 -4.64e-02
   1.07e+00 -7.63e-02  2.09e-03  3.98e-02 -7.90e-03 -3.58e-01 -1.30e-02  5.08e-02
  -2.55e-01]]
SymNet parameters
[0.55]
finally, finish this stage
iter:     0    time: 360.35
Func: 7.35e-01  |g|: 3.93e+01
stableloss: 5.68e-02   dataloss: 6.90e-01   sparseloss: 1.27e+02 momentloss: 7.44e+00
current expression:
[u00*u01, u10*v00, u20, u02, u00, u00*u01**2, u01*u10*v00, u10*v00*v10, u00*u11*v00, u00*u10*v01, u01*u10, u00**3, 1, u00**2, u01*v00**2, u10*v10, u00**2*u02, u00*v00**2, u10, v00**2]
[-0.99 -0.99  0.05  0.05  0.01  0.01  0.01  0.01  0.01  0.01 -0.   -0.   -0.    0.
  0.   -0.    0.   -0.    0.    0.  ]
[u00*v01, v00*v10, v20, v02, v00, v00*v10**2, u00*u01*v01, u00*v01*v10, u00*v00*v11, u10*v00*v01, v00**3, 1, v00**2, u00**2*v02, v01, u00*v00, v10**2, u10*v01, u01, u00*v00**2*v01]
[-0.99 -0.99  0.05  0.05  0.01  0.01  0.01  0.01  0.01  0.01 -0.01 -0.01  0.    0.
  0.    0.   -0.   -0.    0.    0.  ]
block:  9
name:  burgers-2-upwind-sparse0-noise0.001-id1
device:  cuda:1
generate a random number to check random seed:  -1.4580446151365443
current stage is: block-9
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.8869, device='cuda:1', dtype=torch.float64)
u_obs variance
tensor([ 0.2354,  1.6147,  1.5859, 22.9245, 10.7011, 18.6802,  0.2545,  1.7086,
         1.7746, 20.7506, 11.5166, 24.5215], device='cuda:1',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 1.459409
         Iterations: 0
         Function evaluations: 15
         Gradient evaluations: 3
convolution moment and kernels
[[ 1.00e+00  0.00e+00  4.04e-04 -1.16e-02 -9.81e-02]
 [ 0.00e+00  8.77e-04 -2.53e-02  3.39e-03 -5.65e-02]
 [ 9.37e-04  2.87e-03  3.88e-02  6.03e-03  1.29e-03]
 [ 4.31e-02 -1.84e-03  2.36e-02 -2.18e-02 -3.40e-03]
 [-8.56e-02 -4.45e-04 -3.15e-03  1.48e-02  5.85e-03]]
[[-0.01 -0.01 -0.04 -0.06  0.02]
 [ 0.04  0.01  0.2   0.17 -0.03]
 [-0.09  0.18  0.38  0.04 -0.02]
 [-0.04  0.22 -0.09  0.29 -0.07]
 [ 0.01 -0.02 -0.03 -0.03  0.01]]
[[ 0.    1.    0.   -0.07 -0.05]
 [ 0.    0.    0.   -0.    0.  ]
 [ 0.    0.03  0.03  0.05 -0.  ]
 [ 0.01 -0.    0.01 -0.01  0.02]
 [ 0.   -0.01  0.02 -0.01  0.  ]]
[[-0.01  0.05 -0.08  0.04 -0.01]
 [-0.03 -0.05  0.13 -0.09  0.04]
 [ 0.15 -0.61 -0.27  0.95 -0.2 ]
 [-0.07  0.08 -0.07  0.03  0.01]
 [ 0.02 -0.02  0.02 -0.02  0.01]]
[[ 0.00e+00  0.00e+00  0.00e+00  8.30e-03  6.56e-03]
 [ 1.00e+00  0.00e+00  2.44e-02  4.97e-04 -5.58e-03]
 [ 0.00e+00  1.80e-02 -3.87e-02  3.95e-02 -6.08e-03]
 [-7.24e-02  1.14e-03  1.71e-02  7.12e-03 -1.25e-02]
 [-9.66e-02  1.13e-02 -6.44e-02  2.40e-02 -1.98e-02]]
[[-1.57e-02 -2.51e-02  1.11e-01 -4.71e-02 -8.01e-05]
 [ 6.17e-02  2.89e-03 -4.95e-01  4.92e-02  2.86e-02]
 [-9.79e-02  4.11e-02 -4.39e-01 -3.56e-02 -4.83e-02]
 [ 8.61e-02 -8.17e-02  1.09e+00 -1.12e-02  3.98e-02]
 [-3.18e-02  4.49e-02 -2.30e-01  1.03e-02 -9.32e-03]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00 -5.33e-02]
 [ 0.00e+00  0.00e+00  0.00e+00  1.42e-03  1.50e-02]
 [ 0.00e+00  0.00e+00  7.60e-03  7.55e-03 -3.49e-03]
 [ 0.00e+00 -7.49e-04 -4.67e-04 -4.23e-03 -7.98e-02]
 [ 9.61e-02  3.48e-03  3.76e-03 -3.94e-03  5.71e-03]]
[[ 4.84e-02 -1.89e-01  3.71e-01 -1.79e-01  4.54e-02]
 [-1.28e-01  4.92e-01 -1.07e+00  4.32e-01 -1.05e-01]
 [-7.09e-02  1.32e+00 -1.99e+00  1.44e+00 -1.17e-01]
 [ 4.61e-02 -2.15e-01  6.53e-04 -2.95e-01  7.93e-02]
 [-3.17e-02  1.36e-01 -1.22e-01  1.53e-01 -3.91e-02]]
[[ 0.    0.    0.    0.   -0.01]
 [ 0.    1.    0.   -0.01 -0.02]
 [ 0.    0.   -0.   -0.    0.  ]
 [ 0.   -0.   -0.    0.06  0.05]
 [ 0.    0.    0.   -0.01 -0.01]]
[[-0.01  0.06 -0.23  0.25 -0.06]
 [ 0.    0.11  0.66 -1.    0.21]
 [-0.05  0.25 -0.46  0.38 -0.1 ]
 [ 0.05 -0.39 -0.12  0.54 -0.09]
 [ 0.    0.    0.11 -0.15  0.04]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  4.65e-02]
 [ 0.00e+00  0.00e+00  0.00e+00  3.03e-04 -3.32e-03]
 [ 1.00e+00  0.00e+00  6.33e-03  6.84e-03 -3.79e-03]
 [ 0.00e+00 -4.22e-04 -7.86e-03 -2.93e-03  1.99e-02]
 [ 2.77e-03  2.73e-03  2.02e-02 -3.91e-03 -9.29e-03]]
[[-1.94e-02  1.03e-01 -2.55e-01  1.13e-01 -2.29e-02]
 [ 4.92e-02 -2.95e-01  1.85e+00 -3.53e-01  7.27e-02]
 [ 1.31e-02  8.83e-02 -2.75e+00  1.91e-01 -3.02e-02]
 [ 5.10e-04 -9.10e-02  1.54e+00 -1.61e-01  3.01e-02]
 [ 3.16e-03  8.26e-03 -1.12e-01  2.36e-02 -3.23e-03]]
SymNet parameters
[[ 1.11e-01 -2.81e-03 -3.34e-03  1.68e-03 -9.58e-05 -1.83e-05  1.92e-02 -5.27e-04
   4.00e-03  8.25e-05  1.61e-04 -1.40e-05]
 [ 1.32e+00 -1.98e+00 -3.56e-01 -4.40e-01 -1.51e-02 -4.35e-02 -2.87e-01  1.46e-01
   4.76e-04 -5.36e-03 -3.05e-02  1.32e-02]]
SymNet parameters
[-0.5  -0.13]
SymNet parameters
[[-6.75e-03  1.34e-02  7.80e-03  7.96e-03  6.19e-04  2.68e-03  1.66e+00 -6.15e-02
   1.12e-02 -1.60e-03  6.31e-04 -2.79e-03 -2.61e-02]
 [ 2.52e-02 -2.10e-02  1.93e-01 -5.53e-03 -7.00e-03 -4.87e-04 -4.73e-03  1.97e-03
  -6.58e-03 -1.80e-04 -4.14e-04 -3.73e-05  2.25e-02]]
SymNet parameters
[-0.7  -1.07]
SymNet parameters
[[ 1.99e-01 -2.07e-01  9.23e-01 -4.96e-02  1.43e-02 -4.76e-03 -9.15e-03  1.75e-02
  -3.27e-02 -9.92e-04 -3.11e-03  1.83e-03  1.00e-01  2.00e-02]
 [-6.79e-02  7.35e-02  3.15e-02  4.09e-02  1.76e-04  2.43e-03  2.88e+00  3.14e-02
   1.57e-02 -2.35e-03  4.12e-03 -4.15e-03 -4.51e-02  1.08e-03]]
SymNet parameters
[0.87 0.37]
SymNet parameters
[[-2.98e+00 -2.42e+00 -7.72e-01  8.20e-02  2.70e-02  3.69e-02 -4.04e+00  1.57e-01
  -1.29e-01  9.59e-03  1.24e-02 -2.10e-02 -3.00e-01 -3.55e+00  1.71e-01]
 [ 4.71e+00 -7.44e-01  1.54e-01  5.71e-02 -1.64e-02 -2.89e-04 -2.99e-01 -4.20e-02
   6.01e-01  4.51e-03  3.07e-03  3.17e-03  6.72e-01 -4.21e-01 -1.06e-02]]
SymNet parameters
[1.31 0.76]
SymNet parameters
[[-1.11e+00 -1.44e+00 -2.38e-01  1.41e-01  1.59e-02  1.83e-02 -2.75e+00  5.35e-02
  -9.32e-02  4.51e-03  1.10e-02 -5.57e-03 -7.09e-02 -1.78e+00  1.52e-01  2.71e-04]
 [-1.21e+00  1.19e-01 -1.98e-02  8.76e-03  1.58e-03  2.18e-03  6.12e-02 -1.85e-03
  -4.73e-02 -2.18e-05  5.28e-04 -6.53e-04 -1.25e-01  7.22e-02  4.38e-03 -4.51e-04]]
SymNet parameters
[ 0.77 -0.92]
SymNet parameters
[[ 1.86e+00 -1.13e+00 -2.56e-01 -4.22e-01 -1.59e-02  6.43e-04  3.70e-02  1.79e-01
   2.46e-02 -5.83e-03 -3.27e-02  1.69e-02  1.85e+00 -1.06e-01 -3.23e-01 -3.27e-02
  -5.56e-01]]
SymNet parameters
[0.3]
SymNet parameters
[[-2.70e-01  8.43e-04  1.85e-02  1.01e-04 -1.36e-04  3.46e-04  8.04e-03  4.00e-04
  -1.67e-05  5.10e-04  1.86e-04 -2.29e-04]
 [ 1.39e-02 -7.70e-03  8.97e-04 -6.88e-05  5.00e-04 -8.94e-05 -3.43e-02  3.91e-01
  -4.90e-03 -2.48e-03 -2.83e-02  7.16e-04]]
SymNet parameters
[-1.04  1.2 ]
SymNet parameters
[[-1.72e-03 -5.01e-02 -3.89e-03  8.07e-04  4.73e-04  2.48e-04  8.10e-01  2.87e-02
  -6.52e-03  7.49e-03 -1.08e-03  1.75e-03  5.15e-02]
 [-1.21e+00 -1.07e-01  7.35e-02 -4.73e-04  2.32e-03  4.88e-03 -1.70e+00 -1.19e+00
   2.03e+00 -7.17e-02  8.49e-02  8.05e-03 -2.71e+00]]
SymNet parameters
[ 1.19 -2.3 ]
SymNet parameters
[[-5.76e+00  4.85e-03 -8.82e-02  8.52e-03  1.31e-04  6.72e-03  1.85e-01  1.13e-01
   8.84e-03  3.19e-02 -6.37e-03  2.10e-03  1.51e-01  7.84e-03]
 [ 7.08e-01 -9.99e-02 -2.65e-01  1.98e-01  2.79e-02 -8.75e-02  6.21e+00 -4.60e+00
  -7.43e-01  4.90e+00 -3.49e-02  5.95e-01 -2.69e-01  1.01e+00]]
SymNet parameters
[-0.63 -0.78]
SymNet parameters
[[ 1.61e-01 -6.46e-02 -5.83e-02  4.12e-02  5.76e-03 -1.79e-02  1.07e+00  1.59e+00
  -1.14e-01  1.01e+00  1.75e-02  1.24e-01  2.52e-02  2.16e-01  2.32e-04]
 [-7.42e+00  4.44e-02 -9.54e-02  1.13e-02 -2.04e-03  6.22e-03 -4.74e-02 -1.09e-01
   5.38e-02  3.25e-02  3.32e-03  4.06e-03 -1.64e-01  1.81e-02  5.71e-06]]
SymNet parameters
[-0.75  0.8 ]
SymNet parameters
[[ 6.78e-03  8.82e-02 -8.04e-03  4.96e-04  2.28e-03 -8.01e-04 -1.56e+00  3.89e-01
  -1.44e+00 -1.28e-02 -3.14e-02  1.25e-02  1.20e+00  1.64e-02  5.33e-03 -2.02e-02]
 [ 8.87e-02 -9.18e-02 -7.82e-03  7.45e-04  8.35e-04  7.10e-04 -1.17e+00  6.36e-02
  -6.26e-02  1.53e-02 -4.11e-03  3.49e-03  1.53e-01  1.77e-02  5.66e-04 -1.08e-03]]
SymNet parameters
[ 0.91 -0.63]
SymNet parameters
[[-2.90e-01 -6.67e-02  6.28e-03 -4.03e-03 -2.79e-05  3.23e-03 -1.52e-02 -4.64e-02
   1.07e+00 -7.63e-02  2.10e-03  3.98e-02 -7.90e-03 -3.58e-01 -1.34e-02  5.08e-02
  -2.55e-01]]
SymNet parameters
[0.55]
finally, finish this stage
iter:     0    time: 30.48
Func: 1.46e+00  |g|: 2.71e+02
stableloss: 7.64e-02   dataloss: 1.39e+00   sparseloss: 1.27e+02 momentloss: 7.44e+00
current expression:
[u00*u01, u10*v00, u20, u02, u00, u00*u01**2, u01*u10*v00, u10*v00*v10, u00*u11*v00, u00*u10*v01, u01*u10, u00**3, 1, u00**2, u01*v00**2, u10*v10, u00**2*u02, u00*v00**2, u10, v00**2]
[-0.99 -0.99  0.05  0.05  0.01  0.01  0.01  0.01  0.01  0.01 -0.   -0.   -0.    0.
  0.   -0.    0.   -0.    0.    0.  ]
[u00*v01, v00*v10, v20, v02, v00, v00*v10**2, u00*u01*v01, u00*v01*v10, u00*v00*v11, u10*v00*v01, v00**3, 1, v00**2, u00**2*v02, v01, u00*v00, v10**2, u10*v01, u01, u00*v00**2*v01]
[-0.99 -0.99  0.05  0.05  0.01  0.01  0.01  0.01  0.01  0.01 -0.01 -0.01  0.    0.
  0.    0.   -0.   -0.    0.    0.  ]
u_obs.abs().max()
tensor(3.9303, device='cuda:1', dtype=torch.float64)
model(u_obs[0],T=50*dt).abs().max()
tensor(3.1215, device='cuda:1', dtype=torch.float64)
model(u_obs[0],T=100*dt).abs().max()
tensor(nan, device='cuda:1', dtype=torch.float64)
{'--name': 'burgers-2-upwind-sparse0-noise0.001-id2', '--dtype': 'double', '--device': 'cuda:2', '--constraint': '2', '--dt': 0.01, '--cell_num': 1, '--eps': 6.283185307179586, '--blocks': [0, 1, 2, 3, 4, 5, 6, 9], '--kernel_size': 5, '--max_order': 2, '--dx': 0.19634954084936207, '--hidden_layers': 5, '--scheme': 'upwind', '--dataname': 'burgers', '--viscosity': 0.05, '--zoom': 4, '--max_dt': 0.000625, '--batch_size': 28, '--data_timescheme': 'rk2', '--channel_names': 'u,v', '--freq': 4, '--data_start_time': 1.0, '--start_noise': 0.001, '--end_noise': 0.001, '--stablize': 0.0, '--sparsity': 0.0, '--momentsparsity': 0.001, '--npseed': -1, '--torchseed': -1, '--maxiter': 2000, '--recordfile': 'None', '--recordcycle': 200, '--savecycle': -1, '--start_from': -1}
block:  0
name:  burgers-2-upwind-sparse0-noise0.001-id2
device:  cuda:2
generate a random number to check random seed:  1.6961529630439873
current stage is: warmup
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.9170, device='cuda:2', dtype=torch.float64)
u_obs variance
tensor([ 0.2734,  2.1359,  2.0328, 19.4327,  9.7194, 17.7361,  0.2752,  2.2443,
         2.3912, 19.6790, 11.7257, 22.5758], device='cuda:2',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
iter:     0    time: 13.80
Func: 6.51e+00  |g|: 2.14e+00
stableloss: 1.14e-03   dataloss: 6.51e+00   sparseloss: 2.47e+01 momentloss: 7.27e+00
iter:   200    time: 13.50
Func: 4.02e-02  |g|: 5.94e-02
stableloss: 1.56e-02   dataloss: 4.02e-02   sparseloss: 6.57e+01 momentloss: 7.27e+00
iter:   400    time: 13.52
Func: 3.70e-02  |g|: 2.17e-02
stableloss: 1.65e-02   dataloss: 3.70e-02   sparseloss: 8.24e+01 momentloss: 7.27e+00
iter:   600    time: 10.06
Func: 3.63e-02  |g|: 5.05e-02
stableloss: 1.65e-02   dataloss: 3.63e-02   sparseloss: 9.70e+01 momentloss: 7.27e+00
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 0.036064
         Iterations: 765
         Function evaluations: 890
         Gradient evaluations: 881
convolution moment and kernels
[[1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
[[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 1. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
[[ 0.    1.    0.   -0.33 -0.25]
 [ 0.    0.    0.    0.    0.  ]
 [ 0.    0.    0.    0.    0.  ]
 [ 0.    0.    0.    0.    0.  ]
 [ 0.    0.    0.    0.    0.  ]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]
 [ 2.78e-17  3.33e-16 -1.50e+00  2.00e+00 -5.00e-01]
 [ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]]
[[ 0.    0.    0.    0.    0.  ]
 [ 1.    0.    0.    0.    0.  ]
 [ 0.    0.    0.    0.    0.  ]
 [-0.33  0.    0.    0.    0.  ]
 [-0.25  0.    0.    0.    0.  ]]
[[ 0.00e+00  0.00e+00  2.78e-17  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  3.33e-16  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00 -1.50e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  2.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00 -5.00e-01  0.00e+00  0.00e+00]]
[[0.   0.   1.   0.   0.08]
 [0.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.  ]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]
 [-2.22e-16  1.00e+00 -2.00e+00  1.00e+00 -1.53e-16]
 [ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]]
[[0. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
[[ 6.94e-03 -5.56e-02  9.25e-18  5.56e-02 -6.94e-03]
 [-5.56e-02  4.44e-01 -7.40e-17 -4.44e-01  5.56e-02]
 [ 9.25e-18 -7.40e-17  1.23e-32  7.40e-17 -9.25e-18]
 [ 5.56e-02 -4.44e-01  7.40e-17  4.44e-01 -5.56e-02]
 [-6.94e-03  5.56e-02 -9.25e-18 -5.56e-02  6.94e-03]]
[[0.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.  ]
 [1.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.  ]
 [0.08 0.   0.   0.   0.  ]]
[[ 0.00e+00  0.00e+00 -2.22e-16  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  1.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00 -2.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  1.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00 -1.53e-16  0.00e+00  0.00e+00]]
SymNet parameters
[[ 1.14e+00  7.07e-01  2.45e-01  1.05e-01 -8.22e-03  5.98e-03 -6.28e-01  4.01e-02
   3.83e-04  7.52e-03 -5.16e-03 -1.09e-02]
 [-1.44e+00  4.93e-02  7.67e-02 -3.35e-02  2.34e-03 -3.74e-03  2.26e-01 -1.27e-02
  -1.91e-03 -2.96e-03  1.28e-03  1.94e-03]]
SymNet parameters
[-0.7  -0.25]
SymNet parameters
[[-4.57 -0.28  0.06 -0.11  0.06  0.06 -0.21 -0.22  0.59 -0.03  0.02  0.01  0.07]
 [-1.93 -0.28 -2.83 -0.15  0.42 -0.08  0.7   0.09 -0.22 -0.04 -0.01  0.02  0.09]]
SymNet parameters
[-0.09 -0.14]
SymNet parameters
[[-6.67e-01  3.88e-02  2.43e+00 -6.27e-02  1.88e-02  2.23e-03  3.09e-01 -3.04e-02
   5.29e-04 -2.92e-03  9.89e-03  1.65e-02  9.77e-03  2.02e-02]
 [-4.79e-01 -1.20e-01 -1.04e-01 -1.04e-01  1.70e-02 -9.50e-03 -1.83e+00 -3.87e-02
  -1.65e-02 -3.85e-03  7.17e-03  2.23e-02  3.58e-02  7.96e-03]]
SymNet parameters
[-0.46 -0.17]
SymNet parameters
[[-1.19e+00  1.43e-01 -7.56e-02 -9.95e-02  4.44e-03 -3.70e-03  6.79e-01 -3.29e-02
  -3.16e-03 -1.08e-02  2.33e-03 -9.42e-05  1.32e-02 -6.78e-03  1.22e-02]
 [-2.25e+00 -4.60e-01 -4.60e-01 -1.12e-01  5.10e-02 -3.11e-02  5.14e-01 -4.13e-02
   4.00e-04  2.94e-02  1.84e-02  8.24e-02 -4.39e-02  5.82e-02 -5.19e-02]]
SymNet parameters
[-0.   -0.02]
SymNet parameters
[[-8.74e-01  9.79e-01 -1.01e+00  1.27e+00 -9.17e-01  5.75e-01  1.38e+00  4.04e-01
   2.15e-02 -7.04e-01 -3.32e-01 -1.51e+00 -2.37e-01 -1.22e+00  9.93e-01  2.55e-02]
 [ 2.02e+00 -3.55e-01 -1.07e-01  2.07e-01 -8.53e-03  6.97e-03 -1.18e+00  9.80e-02
   1.18e-02  2.17e-02 -5.95e-03  1.72e-03 -4.15e-02  1.27e-02 -2.71e-02  3.67e-04]]
SymNet parameters
[-0.05  0.52]
SymNet parameters
[[-0.74  0.22  0.17  0.05 -0.    0.04 -0.1  -0.   -0.   -0.01 -0.   -0.01  1.03 -0.01
   0.16  0.6  -0.01]]
SymNet parameters
[-0.2]
SymNet parameters
[[-8.95e-02  4.44e-04  7.91e-04 -3.05e-03  1.70e-03 -1.11e-03  1.11e+00  1.90e-01
   1.04e-02 -1.29e-02  1.64e-02  1.92e-02]
 [-2.18e+00  1.58e-02  1.09e-02 -6.95e-03  5.24e-03 -4.64e-03  8.52e-01 -2.04e-01
  -4.27e-01 -1.25e-02  2.83e-02  3.96e-02]]
SymNet parameters
[-0.16  1.44]
SymNet parameters
[[-1.79 -0.16 -0.1   0.02 -0.02  0.01 -0.42 -0.06  0.4  -0.04  0.07 -0.1  -0.22]
 [-0.1   0.02  0.02 -0.01  0.   -0.    1.33 -0.25 -0.03 -0.    0.01  0.02  0.03]]
SymNet parameters
[0.11 0.47]
SymNet parameters
[[ 1.04e-01  2.02e-02  1.35e-02 -5.54e-03  3.88e-03 -2.36e-03  8.18e-01 -1.79e-01
  -7.92e-03 -8.46e-04  7.11e-03  2.04e-02  2.18e-02 -2.35e-03]
 [-2.01e-02  1.47e-01  9.84e-02 -1.38e-02  1.66e-02 -1.01e-02  1.25e+00  2.14e-01
  -6.96e-02  5.22e-02 -9.03e-02  6.87e-02  2.31e-01 -2.41e-02]]
SymNet parameters
[0.2  0.86]
SymNet parameters
[[ 1.97e+00 -3.59e-01 -3.10e-01  1.29e-01 -8.15e-02  2.72e-02  5.31e-01 -2.56e-01
  -2.99e-01  3.46e-01  1.37e-02 -6.76e-01 -3.48e-04 -4.69e-01 -1.60e+00]
 [ 8.27e-01 -4.81e-01 -4.99e-01 -4.08e-02 -2.07e-01  1.53e-01  1.20e-01  3.19e-01
  -1.18e+00 -4.32e-01 -3.01e-01  9.64e-01 -4.24e-01 -8.55e-01 -1.10e+00]]
SymNet parameters
[0.02 0.01]
SymNet parameters
[[-1.30e+00 -6.16e-01 -4.63e-01  1.80e-01 -1.71e-01  8.28e-02  1.19e-01  1.48e-01
   7.21e-01  3.89e-01 -4.47e-01 -1.40e+00 -4.77e-01 -5.35e-01 -2.84e-01 -7.01e-03]
 [ 2.99e-01 -1.53e-02 -4.26e-02  2.71e-03 -1.46e-02  1.09e-02 -2.74e+00  3.82e-01
   5.41e-01  1.15e-03 -8.35e-02  2.01e-02 -1.06e-01 -8.34e-02 -1.44e-01  4.44e-03]]
SymNet parameters
[0.27 0.36]
SymNet parameters
[[-1.03e+00 -1.33e-02 -1.02e-02  8.54e-04 -8.38e-03  2.17e-03  1.40e-02 -5.04e-01
   1.01e-01  4.55e-02 -5.29e-04  1.18e-02  9.03e-01 -1.12e+00 -1.45e+00  2.99e-03
  -2.50e-02]]
SymNet parameters
[0.53]
finally, finish this stage
iter:   765    time: 10.65
Func: 3.61e-02  |g|: 4.40e-02
stableloss: 1.62e-02   dataloss: 3.61e-02   sparseloss: 1.03e+02 momentloss: 7.27e+00
current expression:
[u00*u01, u10*v00, u00, u02, u20, u00**3, u00*v00, 1, v00, u00**2*u02, u00*u01**2, u00*u11*v00, u00*v00**2, u10*v00*v10, u01*u10*v00, u00*u10*v01, u10, u00*u10, v00**2, u10*v00**2]
[-0.89 -0.89  0.07  0.04  0.03 -0.03 -0.01 -0.01 -0.01 -0.01  0.01  0.01 -0.01  0.01
  0.01  0.01  0.01 -0.01  0.   -0.  ]
[v00*v10, u00*v01, v00, v20, v02, v00**3, v00**2*v20, u00*v00*v11, u00**2*v00, 1, v00*v10**2, u00*v01*v10, u00*v00, u00, u00*v00*v20, u11, u00*v00**2*v10, v00*v20, u00*v00**2, u01*v00**2]
[-0.89 -0.89  0.06  0.05  0.03 -0.02 -0.01  0.01 -0.01  0.01  0.01  0.01  0.01 -0.01
  0.01 -0.    0.   -0.    0.   -0.  ]
block:  1
name:  burgers-2-upwind-sparse0-noise0.001-id2
device:  cuda:2
generate a random number to check random seed:  -1.7253384879052431
current stage is: block-1
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.8858, device='cuda:2', dtype=torch.float64)
u_obs variance
tensor([ 0.2464,  1.9502,  1.8887, 17.9163,  8.9283, 16.5615,  0.2502,  1.9312,
         2.1289, 16.6374,  9.8541, 20.0399], device='cuda:2',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
iter:     0    time: 3927.80
Func: 5.09e-02  |g|: 2.08e+00
stableloss: 1.27e-02   dataloss: 4.37e-02   sparseloss: 1.03e+02 momentloss: 7.27e+00
iter:   200    time: 13.39
Func: 2.15e-02  |g|: 3.98e-02
stableloss: 1.05e-02   dataloss: 1.45e-02   sparseloss: 1.02e+02 momentloss: 6.93e+00
iter:   400    time: 11.25
Func: 2.03e-02  |g|: 2.19e-02
stableloss: 9.85e-03   dataloss: 1.36e-02   sparseloss: 1.10e+02 momentloss: 6.64e+00
iter:   600    time: 10.80
Func: 2.00e-02  |g|: 2.21e-02
stableloss: 9.45e-03   dataloss: 1.34e-02   sparseloss: 1.13e+02 momentloss: 6.62e+00
iter:   800    time: 10.79
Func: 1.98e-02  |g|: 5.83e-03
stableloss: 9.48e-03   dataloss: 1.32e-02   sparseloss: 1.14e+02 momentloss: 6.60e+00
iter:  1000    time: 10.68
Func: 1.96e-02  |g|: 7.94e-03
stableloss: 9.37e-03   dataloss: 1.31e-02   sparseloss: 1.16e+02 momentloss: 6.57e+00
iter:  1200    time: 10.67
Func: 1.95e-02  |g|: 1.53e-02
stableloss: 9.29e-03   dataloss: 1.30e-02   sparseloss: 1.24e+02 momentloss: 6.57e+00
iter:  1400    time: 10.77
Func: 1.94e-02  |g|: 1.31e-02
stableloss: 9.33e-03   dataloss: 1.28e-02   sparseloss: 1.38e+02 momentloss: 6.56e+00
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 0.019285
         Iterations: 1580
         Function evaluations: 1646
         Gradient evaluations: 1640
convolution moment and kernels
[[ 1.00e+00  0.00e+00  4.03e-04  6.31e-02 -8.34e-03]
 [ 0.00e+00  1.11e-05  3.08e-03  2.37e-03 -8.87e-03]
 [ 2.22e-04  4.13e-04  2.85e-03 -4.53e-03 -4.36e-03]
 [-1.31e-03  2.23e-04 -3.19e-03 -2.09e-03 -3.65e-03]
 [-3.35e-02  2.59e-02  2.86e-04 -1.53e-02  7.59e-04]]
[[ 0.01 -0.04 -0.02  0.02 -0.01]
 [-0.04  0.14  0.1  -0.1   0.03]
 [ 0.03 -0.16  0.85  0.08 -0.01]
 [-0.05  0.18  0.05 -0.07  0.03]
 [ 0.01 -0.04 -0.03  0.03 -0.01]]
[[ 0.00e+00  1.00e+00  0.00e+00 -9.21e-02 -6.73e-02]
 [ 0.00e+00  0.00e+00 -4.78e-03 -8.41e-04 -2.16e-02]
 [ 0.00e+00  9.16e-03 -9.10e-04  8.77e-03 -1.31e-02]
 [ 8.52e-03  7.39e-03  1.43e-03 -8.07e-03 -2.02e-02]
 [ 5.88e-03 -8.74e-03 -4.09e-03 -2.90e-03 -3.87e-03]]
[[ 0.   -0.02  0.05 -0.04  0.01]
 [-0.01  0.04 -0.11  0.08 -0.01]
 [ 0.09 -0.55 -0.26  0.95 -0.2 ]
 [-0.01  0.   -0.04 -0.01  0.01]
 [-0.01  0.04 -0.05  0.04 -0.01]]
[[ 0.00e+00  0.00e+00  0.00e+00  5.63e-03  1.65e-03]
 [ 1.00e+00  0.00e+00  1.91e-02  4.49e-03 -4.88e-03]
 [ 0.00e+00  4.03e-03 -1.79e-03 -4.34e-03  1.36e-03]
 [-8.49e-02 -7.94e-05  1.86e-02 -2.26e-03 -5.62e-03]
 [-6.90e-02  4.17e-03 -8.08e-03 -1.88e-02 -2.25e-03]]
[[ 0.01 -0.04  0.1  -0.   -0.01]
 [-0.03  0.09 -0.51 -0.06  0.04]
 [ 0.04 -0.1  -0.4   0.11 -0.06]
 [-0.03  0.06  1.05 -0.1   0.05]
 [ 0.01 -0.   -0.22  0.04 -0.02]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00  4.16e-03]
 [ 0.00e+00  0.00e+00  0.00e+00 -6.87e-04  1.00e-04]
 [ 0.00e+00  0.00e+00  3.47e-03 -6.84e-03 -1.58e-03]
 [ 0.00e+00 -1.18e-03 -1.30e-03  1.18e-03  8.22e-04]
 [ 5.14e-03 -6.37e-03 -2.59e-03  2.75e-02 -4.50e-03]]
[[-0.02  0.05 -0.02 -0.02  0.01]
 [ 0.08 -0.18  0.05  0.09 -0.05]
 [-0.19  1.58 -2.52  1.17 -0.01]
 [ 0.08 -0.18  0.03  0.1  -0.05]
 [-0.02  0.04 -0.01 -0.02  0.01]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00 -6.13e-04]
 [ 0.00e+00  1.00e+00  0.00e+00 -2.32e-03 -3.24e-03]
 [ 0.00e+00  0.00e+00  1.44e-03 -2.05e-03 -1.96e-03]
 [ 0.00e+00 -1.75e-03 -1.76e-03  2.95e-03  4.60e-03]
 [ 1.98e-03 -3.87e-03 -4.24e-03  3.54e-03  7.81e-03]]
[[ 1.14e-02 -7.78e-02  4.31e-02  2.53e-02  2.07e-05]
 [-7.67e-02  5.54e-01 -2.13e-01 -2.92e-01  1.97e-02]
 [ 3.84e-02 -2.01e-01  3.91e-01 -2.85e-01  6.87e-02]
 [ 2.54e-02 -2.87e-01 -3.03e-01  6.67e-01 -1.10e-01]
 [ 9.45e-04  1.50e-02  7.83e-02 -1.13e-01  2.10e-02]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  6.76e-03]
 [ 0.00e+00  0.00e+00  0.00e+00  2.32e-04  3.81e-03]
 [ 1.00e+00  0.00e+00  4.03e-03 -5.88e-03 -4.72e-03]
 [ 0.00e+00  4.47e-04  1.22e-03 -2.96e-04 -3.66e-03]
 [ 5.60e-04 -6.07e-03 -3.59e-03  7.71e-03  6.88e-04]]
[[-1.10e-03 -6.39e-03 -5.21e-02 -3.15e-02  8.31e-03]
 [ 4.64e-03  3.33e-02  1.19e+00  1.45e-01 -3.86e-02]
 [-8.20e-03 -4.77e-02 -2.28e+00 -2.18e-01  5.89e-02]
 [ 1.67e-02 -1.80e-02  1.27e+00  9.02e-02 -2.55e-02]
 [-5.29e-03  1.18e-02 -8.09e-02 -1.21e-02  3.72e-03]]
SymNet parameters
[[ 1.29e-01  1.05e+00  6.19e-01  3.08e-01  1.45e-01  4.27e-03 -4.10e-02  1.17e-01
   5.20e-02  6.17e-03 -2.02e-04  4.09e-02]
 [-1.63e+00  1.59e-01 -1.31e-02 -4.51e-02 -2.00e-02 -2.03e-03 -5.60e-01 -7.67e-04
   2.71e-03 -1.91e-03 -2.52e-03 -4.81e-03]]
SymNet parameters
[-0.38  0.01]
SymNet parameters
[[-4.71e+00 -5.04e-02  6.80e-01 -4.97e-02  9.15e-02  1.24e-01  6.60e-01 -4.14e-01
   5.69e-01  1.03e-02  5.34e-02 -9.70e-02 -7.18e-04]
 [-2.28e+00 -2.35e-01 -3.41e+00 -5.69e-02  5.47e-01 -1.13e-01  1.98e-01  3.75e-02
  -3.69e-01  4.20e-02 -1.77e-02  9.93e-02  3.03e-02]]
SymNet parameters
[-2.69 -1.8 ]
SymNet parameters
[[ 1.65e+00 -1.50e-01  3.09e+00 -1.51e-01 -5.32e-02  2.07e-03 -1.72e-01 -6.21e-02
  -3.10e-02 -4.21e-03 -4.90e-04 -2.18e-02  2.79e-02  9.32e-03]
 [ 1.16e-01  1.24e-01 -2.29e-02 -5.01e-02 -1.84e-02 -4.50e-03 -1.83e+00 -4.42e-02
  -1.37e-02 -6.01e-03  3.19e-03 -1.74e-03 -1.98e-02  1.38e-03]]
SymNet parameters
[ 0.26 -2.07]
SymNet parameters
[[ 7.06e-02  1.14e+00 -2.50e-01 -3.61e-01 -1.19e-01 -5.40e-02 -1.05e+00 -1.19e-01
  -2.68e-02 -3.72e-02  3.42e-04  2.25e-03 -1.16e-01  1.04e-02 -2.10e-02]
 [-1.58e+00 -9.08e-02 -2.47e-01 -1.18e-01 -1.45e-02 -4.35e-02  1.54e-01 -2.49e-02
   1.85e-03 -2.53e-02  1.08e-03  2.79e-02 -1.15e-01  8.12e-03 -3.27e-02]]
SymNet parameters
[0.14 0.27]
SymNet parameters
[[-1.62 -0.47 -0.94  2.91  0.1   1.41  0.77  0.3  -0.33  0.78  0.03 -0.98  2.97 -0.27
   0.98 -0.22]
 [ 2.05 -1.19  0.38  0.47  0.16  0.05  0.95  0.23  0.09  0.04 -0.01  0.01  0.16 -0.01
   0.03  0.01]]
SymNet parameters
[-0.06  0.89]
SymNet parameters
[[ 4.50e-01 -1.35e-01  1.08e+00  5.23e-02 -6.71e-03  7.03e-02  7.63e-02 -8.07e-03
  -1.16e-02  9.63e-03 -8.11e-04 -1.66e-02  2.91e-01  2.28e-04  1.77e-01  3.30e-01
  -8.84e-03]]
SymNet parameters
[0.07]
SymNet parameters
[[-9.51e-02  3.01e-03 -3.16e-03 -1.77e-03 -1.25e-03  2.36e-04  5.65e-01  1.65e-01
   3.08e-02 -2.54e-03  4.07e-03 -7.73e-03]
 [-3.20e+00 -1.32e-02 -1.86e-02 -4.60e-04  5.60e-04 -1.01e-03  5.29e-01 -7.85e-02
  -4.84e-01 -4.66e-04 -6.67e-03  6.73e-03]]
SymNet parameters
[0.19 1.05]
SymNet parameters
[[-2.49 -0.04 -0.07 -0.04 -0.02  0.01  0.2   0.17  0.76 -0.04 -0.01 -0.15 -0.11]
 [-0.28  0.02  0.01  0.01  0.01 -0.    2.09 -0.35 -0.05  0.01  0.02  0.04  0.05]]
SymNet parameters
[0.92 0.09]
SymNet parameters
[[ 0.09 -0.01 -0.01 -0.   -0.    0.    0.25 -0.01  0.03 -0.   -0.01 -0.02 -0.01 -0.02]
 [ 0.84 -0.18  0.1   0.05  0.07 -0.01  0.84  0.04 -0.27  0.1  -0.14  0.21  0.32 -0.22]]
SymNet parameters
[-0.02  0.33]
SymNet parameters
[[ 3.    0.31  0.01 -0.21  0.09  0.07  2.46 -0.98 -2.49 -0.05 -0.56 -1.22  0.83 -0.45
   0.76]
 [-2.26 -0.41  0.05  0.43  0.62  0.1  -0.81  0.27 -1.96  0.69  0.26  1.05  2.24 -1.97
   2.66]]
SymNet parameters
[-0.    0.03]
SymNet parameters
[[ 4.87e-01 -1.66e+00 -8.34e-01 -5.20e-01 -1.34e-01  2.08e-01  3.59e-01  1.83e+00
   8.38e-01 -2.71e-01 -7.40e-01 -2.29e+00 -1.01e+00 -1.38e+00 -5.22e-01  5.79e-03]
 [-1.43e+00  7.40e-02 -7.84e-02 -5.08e-02 -6.13e-02  7.68e-03 -2.69e+00  4.06e-01
   4.69e-01 -7.70e-02  3.43e-02 -1.82e-01 -3.09e-01  1.78e-01 -7.50e-02 -1.21e-04]]
SymNet parameters
[0.25 0.51]
SymNet parameters
[[ 6.48e-01 -1.01e-02 -2.67e-03 -1.15e-03 -7.27e-04  6.84e-04  1.42e-01 -3.26e-01
   1.11e-01  4.94e-02 -1.94e-03  3.88e-02  1.22e+00 -4.88e-01 -8.80e-01 -6.22e-04
  -1.75e-02]]
SymNet parameters
[-0.2]
finally, finish this stage
iter:  1580    time: 12.50
Func: 1.93e-02  |g|: 2.07e-02
stableloss: 9.29e-03   dataloss: 1.27e-02   sparseloss: 1.38e+02 momentloss: 6.57e+00
current expression:
[u00*u01, u10*v00, u20, u02, u00*u01**2, u01, u01*u10*v00, u00**2*u01, u10*v00*v10, u00*u10, u00*u11*v00, u00**2, u10, u00*u01*v00, 1, u10*v00**2, u10*v01, u00*u10*v01, u00*u11, v00]
[-0.98 -0.98  0.05  0.05  0.01  0.01  0.01 -0.01  0.01  0.01  0.01  0.01  0.01 -0.01
 -0.01 -0.   -0.    0.   -0.   -0.  ]
[v00*v10, u00*v01, v02, v20, v00, v00*v10**2, 1, u00*v01*v10, u00*v00*v11, u00*v00, u00, v00**3, u00**2, u10*v01, v00**2, v10, u00*v00**2, u01*v01, u00*u01, u00**2*v00**2]
[-0.98 -0.98  0.05  0.05  0.02  0.01  0.01  0.01  0.01  0.01  0.01 -0.01 -0.01 -0.01
 -0.01  0.01 -0.   -0.   -0.    0.  ]
block:  2
name:  burgers-2-upwind-sparse0-noise0.001-id2
device:  cuda:2
generate a random number to check random seed:  -0.9236096502140428
current stage is: block-2
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.9617, device='cuda:2', dtype=torch.float64)
u_obs variance
tensor([ 0.2533,  1.5950,  1.5505, 20.4199,  9.2636, 18.0275,  0.2437,  1.4907,
         1.5137, 17.3125,  8.4748, 19.9620], device='cuda:2',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
iter:     0    time: 6088.46
Func: 9.83e-02  |g|: 2.17e+01
stableloss: 1.61e-02   dataloss: 8.52e-02   sparseloss: 1.38e+02 momentloss: 6.57e+00
iter:   200    time: 13.84
Func: 6.03e-02  |g|: 2.64e-01
stableloss: 1.34e-02   dataloss: 4.65e-02   sparseloss: 1.35e+02 momentloss: 6.88e+00
iter:   400    time: 13.56
Func: 5.86e-02  |g|: 2.11e-01
stableloss: 1.35e-02   dataloss: 4.49e-02   sparseloss: 1.38e+02 momentloss: 6.88e+00
iter:   600    time: 14.57
Func: 5.79e-02  |g|: 1.71e-01
stableloss: 1.35e-02   dataloss: 4.41e-02   sparseloss: 1.45e+02 momentloss: 6.91e+00
iter:   800    time: 14.15
Func: 5.73e-02  |g|: 1.12e-01
stableloss: 1.35e-02   dataloss: 4.35e-02   sparseloss: 1.52e+02 momentloss: 6.89e+00
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 0.057106
         Iterations: 989
         Function evaluations: 1070
         Gradient evaluations: 1064
convolution moment and kernels
[[ 1.00e+00  0.00e+00  1.66e-03 -3.68e-03 -5.63e-02]
 [ 0.00e+00  9.53e-05 -7.08e-04  2.11e-03  3.33e-02]
 [ 1.84e-04  4.74e-03  7.88e-03  2.31e-03 -6.44e-03]
 [ 7.14e-03 -2.76e-03 -2.24e-03  3.61e-04  2.41e-03]
 [-6.24e-02  3.88e-02 -8.16e-03 -6.16e-03  3.86e-03]]
[[ 1.31e-02 -6.71e-02 -1.08e-02 -1.33e-03  1.16e-04]
 [-7.32e-02  3.58e-01 -1.09e-01  1.03e-01 -2.13e-02]
 [ 3.02e-02 -2.15e-01  6.90e-01  1.72e-01 -5.30e-02]
 [-3.46e-02  2.03e-01  1.05e-01 -4.92e-02  1.86e-02]
 [ 9.91e-03 -5.55e-02 -1.72e-02  6.53e-03 -2.61e-03]]
[[ 0.00e+00  1.00e+00  0.00e+00 -9.15e-02 -6.81e-02]
 [ 0.00e+00  0.00e+00  4.70e-03  2.94e-03  1.93e-02]
 [ 0.00e+00  2.10e-02 -1.90e-03  2.55e-02 -1.93e-02]
 [ 1.33e-03 -3.50e-03 -3.88e-03 -1.55e-03 -4.31e-03]
 [-1.60e-02 -1.29e-02 -7.27e-04 -8.98e-03 -2.57e-03]]
[[ 6.63e-03 -1.04e-02 -4.27e-03 -7.37e-03 -1.31e-03]
 [-5.90e-02  1.38e-01 -1.14e-01  1.06e-01 -5.26e-03]
 [ 1.42e-01 -6.48e-01 -3.08e-01  9.30e-01 -2.12e-01]
 [-2.87e-02  2.13e-02  5.44e-02 -1.51e-02  3.09e-02]
 [ 2.15e-04  1.38e-02 -3.65e-02  1.62e-02 -9.18e-03]]
[[ 0.00e+00  0.00e+00  0.00e+00 -6.45e-04  1.88e-03]
 [ 1.00e+00  0.00e+00  2.51e-02 -2.93e-03 -1.12e-02]
 [ 0.00e+00  3.74e-03 -1.92e-02 -5.13e-03 -8.76e-03]
 [-9.91e-02 -5.25e-05  3.62e-02  2.09e-03 -4.51e-03]
 [-7.87e-02  8.93e-03 -2.48e-02  1.20e-04 -5.49e-03]]
[[ 9.13e-04 -4.50e-02  1.32e-01 -3.20e-02 -1.27e-03]
 [ 4.60e-03  8.82e-02 -6.04e-01  5.38e-02  6.46e-03]
 [-3.55e-03 -1.14e-01 -2.75e-01 -8.12e-02  1.98e-03]
 [ 5.92e-03  5.21e-02  9.89e-01  3.39e-02 -3.32e-04]
 [-5.68e-03  1.08e-02 -2.30e-01  1.86e-02 -5.28e-03]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00  3.76e-03]
 [ 0.00e+00  0.00e+00  0.00e+00  1.62e-04 -5.84e-03]
 [ 0.00e+00  0.00e+00  3.41e-03 -1.99e-03  5.36e-04]
 [ 0.00e+00  1.24e-04 -2.89e-03  6.08e-04  6.12e-03]
 [ 1.70e-01 -3.73e-03 -1.58e-04  5.05e-03 -2.93e-02]]
[[-0.04  0.14 -0.03  0.13 -0.03]
 [ 0.14 -0.54  0.08 -0.48  0.12]
 [-0.28  2.06 -2.5   1.96 -0.24]
 [ 0.12 -0.45 -0.05 -0.39  0.09]
 [-0.03  0.11  0.02  0.09 -0.02]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  1.21e-04]
 [ 0.00e+00  1.00e+00  0.00e+00 -2.02e-03 -4.41e-03]
 [ 0.00e+00  0.00e+00  3.50e-04 -4.00e-03  3.15e-04]
 [ 0.00e+00 -2.49e-03  1.14e-03  3.78e-03  7.18e-04]
 [ 2.54e-03 -5.02e-03  7.46e-05  8.21e-03 -2.25e-06]]
[[ 0.   -0.04 -0.    0.05 -0.  ]
 [-0.03  0.39  0.01 -0.41  0.04]
 [-0.03  0.08  0.01 -0.08  0.03]
 [ 0.08 -0.49 -0.03  0.51 -0.08]
 [-0.01  0.07  0.01 -0.07  0.01]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  9.07e-03]
 [ 0.00e+00  0.00e+00  0.00e+00  1.28e-03 -5.87e-03]
 [ 1.00e+00  0.00e+00  4.99e-03 -1.12e-03 -3.43e-03]
 [ 0.00e+00  3.24e-04 -2.84e-03  1.03e-04  6.16e-03]
 [ 1.28e-03 -3.58e-03  1.06e-03  3.66e-03 -7.09e-03]]
[[-1.28e-02  5.06e-02 -1.49e-01  3.80e-02 -8.33e-03]
 [ 4.36e-02 -1.63e-01  1.53e+00 -1.09e-01  2.42e-02]
 [-3.86e-02  1.31e-01 -2.63e+00  5.24e-02 -1.02e-02]
 [ 2.21e-02 -7.26e-02  1.40e+00 -2.32e-02  4.42e-03]
 [-5.31e-03  1.79e-02 -9.95e-02  5.94e-03 -1.04e-03]]
SymNet parameters
[[-2.50e-01  1.02e+00  1.63e-01  1.97e-01  3.55e-02 -1.11e-02 -1.32e-01  5.23e-02
  -7.20e-02 -8.34e-03  2.52e-02 -2.08e-03]
 [-1.78e+00  6.34e-02 -1.10e-02 -1.79e-02 -9.68e-04  3.04e-03 -1.55e-01 -3.43e-03
   2.35e-03  2.08e-03 -1.98e-03  2.20e-05]]
SymNet parameters
[-0.25 -0.37]
SymNet parameters
[[-5.95e+00 -4.45e-02 -1.31e-01 -7.64e-02 -2.17e-02  1.91e-03 -6.15e-02 -2.73e-02
   3.26e-01 -4.62e-03 -1.05e-02  9.07e-03 -9.49e-02]
 [-6.13e-01 -1.17e-01 -6.08e+00 -1.05e-01  2.27e-01  9.43e-03 -5.58e-02 -7.14e-02
   1.63e-02  2.56e-02 -3.37e-02  6.85e-03 -1.50e-01]]
SymNet parameters
[-3.4  -0.99]
SymNet parameters
[[ 4.99e-01 -2.41e-01  3.70e+00  4.70e-03  3.77e-02  1.22e-03  2.94e-02 -8.70e-04
   1.91e-03 -1.01e-02  1.38e-02  1.07e-02  8.92e-02  1.99e-04]
 [ 1.27e-01 -8.31e-03 -2.50e-03 -5.87e-03 -2.53e-03  2.33e-04 -2.09e+00 -1.57e-02
  -7.57e-03  1.22e-03 -1.96e-03  1.24e-03  9.57e-03  7.21e-04]]
SymNet parameters
[ 0.4  -1.84]
SymNet parameters
[[ 5.34e-01  1.24e+00  2.15e-01 -3.81e-01 -6.31e-02  1.77e-02 -2.17e-01 -9.49e-02
   1.46e-01  2.22e-02 -5.62e-02  2.50e-03 -3.31e-02  1.79e-02  8.73e-02]
 [-9.36e-01 -5.42e-02 -1.22e-02 -2.83e-02 -1.25e-02  3.61e-04 -2.13e-02 -8.80e-03
   1.41e-02  5.96e-03 -9.47e-03 -2.87e-03 -4.11e-02  1.10e-02 -3.60e-04]]
SymNet parameters
[0.24 0.52]
SymNet parameters
[[-1.49e+00 -5.14e-01 -9.66e-01  1.98e+00  1.25e+00  8.11e-02  6.79e-01  6.68e-01
  -1.13e+00 -7.66e-01  9.89e-01  4.32e-01  3.18e+00 -1.40e+00  5.73e-02  6.33e-02]
 [ 1.84e+00 -1.83e+00 -4.40e-01  7.22e-01  1.22e-01 -3.72e-02 -2.42e+00  3.08e-01
  -2.71e-01 -3.53e-02  1.07e-01 -5.62e-03  1.17e-01 -3.01e-02 -1.51e-01 -8.83e-04]]
SymNet parameters
[-0.02  1.14]
SymNet parameters
[[-0.09 -0.13  0.77  0.14  0.02  0.05  0.13  0.02 -0.04 -0.01  0.02  0.    0.35 -0.01
   0.09  0.33 -0.  ]]
SymNet parameters
[0.01]
SymNet parameters
[[ 3.63e-03  4.29e-02  4.16e-02 -3.42e-03  6.13e-04  1.41e-03  5.71e-01  1.03e-01
  -3.91e-02  2.06e-03 -8.39e-03 -1.62e-02]
 [-3.69e+00  2.95e-02  3.97e-03 -4.14e-03  2.33e-03  3.89e-03  2.08e-01 -2.93e-03
  -3.21e-02 -1.34e-02 -5.33e-02  3.54e-02]]
SymNet parameters
[0.22 0.51]
SymNet parameters
[[-2.21e+00 -2.56e-02 -5.44e-03  2.40e-03  8.64e-05 -2.84e-03  1.15e-01  9.18e-02
   3.32e-01  3.85e-03 -2.63e-02 -2.93e-02 -3.05e-02]
 [ 9.97e-03  1.84e-01  1.70e-01 -1.49e-02  2.52e-03  7.20e-03  2.46e+00 -5.41e-02
  -1.41e-01  6.00e-03 -3.50e-02 -5.46e-02  5.65e-03]]
SymNet parameters
[ 0.78 -0.09]
SymNet parameters
[[ 7.64e-03  1.60e-03 -1.36e-04 -4.16e-05  6.98e-05  1.21e-04  5.81e-02  1.23e-02
   2.36e-02 -3.33e-04  1.84e-03  2.08e-03 -3.48e-03  4.99e-05]
 [ 6.79e-01 -8.31e-01 -9.31e-01  3.14e-02  3.82e-03 -1.55e-02  1.29e+00  1.78e-01
   6.10e-01 -1.44e-01 -1.41e-01  6.43e-01  7.36e-01 -2.76e-01]]
SymNet parameters
[-0.39  0.8 ]
SymNet parameters
[[ 2.36  0.87  0.97 -0.13  0.05 -0.01  4.22  1.09 -3.75  0.03 -1.08 -0.55  0.85 -0.4
   2.39]
 [-3.77  0.71 -0.59 -0.16  0.1   0.16 -2.85  0.84 -3.03 -0.54 -0.58  2.41  1.14 -0.47
   1.83]]
SymNet parameters
[0.12 0.04]
SymNet parameters
[[ 9.52e-01 -3.41e+00 -2.12e+00  2.76e-01 -4.10e-02 -2.41e-01  8.63e-01  3.84e+00
  -1.95e+00  2.58e-01  2.75e-01 -8.90e-01 -4.44e-01 -4.28e-01 -7.55e-01  3.95e-03]
 [-6.10e-01 -1.92e-01 -1.53e-01  2.27e-04 -3.27e-05 -6.54e-03 -3.51e+00 -4.05e-03
   4.02e-01 -1.85e-02 -1.34e-01  2.16e-02 -1.97e-01  7.23e-02  2.79e-01  1.55e-04]]
SymNet parameters
[0.27 1.35]
SymNet parameters
[[ 1.73  0.46  0.55 -0.02 -0.    0.01  0.31 -0.19 -0.39  0.14  0.1  -0.35  1.96 -0.77
  -1.41 -0.   -0.01]]
SymNet parameters
[-0.76]
finally, finish this stage
iter:   989    time: 17.64
Func: 5.71e-02  |g|: 5.74e-02
stableloss: 1.35e-02   dataloss: 4.33e-02   sparseloss: 1.56e+02 momentloss: 6.89e+00
current expression:
[u00*u01, u10*v00, u20, u02, u00*u01**2, u00*u10*v01, u00*u11*v00, u10*v00*v10, u01*u10*v00, u00, 1, u00*v00**2, u00**2*v00, u00*u01*v00, v01, u01, u00*u01*u10, u00**2, u00*v01, u00*v00*v01]
[-0.98 -0.97  0.05  0.05  0.01  0.01  0.01  0.01  0.01  0.01 -0.   -0.    0.   -0.
 -0.    0.    0.    0.   -0.   -0.  ]
[v00*v10, u00*v01, v02, v20, v00, v00*v10**2, u00*v01*v10, u00*v00*v11, u00*u01*v01, v01, u00*u10*v01, v00**3, u00*v00, u00*u10, v10, u00**2, u00*u01, u00**2*v00, u01*v00*v01, v00**2*v01]
[-0.98 -0.98  0.05  0.05  0.01  0.01  0.01  0.01  0.01  0.01  0.01 -0.    0.   -0.
 -0.    0.   -0.   -0.    0.   -0.  ]
block:  3
name:  burgers-2-upwind-sparse0-noise0.001-id2
device:  cuda:2
generate a random number to check random seed:  -1.332297278298447
current stage is: block-3
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.6908, device='cuda:2', dtype=torch.float64)
u_obs variance
tensor([ 0.2658,  1.7401,  1.7522, 22.0516, 10.5130, 20.3718,  0.2207,  1.4996,
         1.4568, 17.0797,  8.8762, 18.7625], device='cuda:2',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 0.157239
         Iterations: 0
         Function evaluations: 15
         Gradient evaluations: 3
convolution moment and kernels
[[ 1.00e+00  0.00e+00  1.64e-03 -3.68e-03 -5.62e-02]
 [ 0.00e+00  8.44e-05 -7.01e-04  2.13e-03  3.33e-02]
 [ 1.57e-04  4.73e-03  7.89e-03  2.31e-03 -6.43e-03]
 [ 7.15e-03 -2.76e-03 -2.24e-03  3.58e-04  2.41e-03]
 [-6.24e-02  3.88e-02 -8.15e-03 -6.17e-03  3.86e-03]]
[[ 1.31e-02 -6.70e-02 -1.09e-02 -1.30e-03  1.12e-04]
 [-7.32e-02  3.58e-01 -1.09e-01  1.03e-01 -2.13e-02]
 [ 3.02e-02 -2.15e-01  6.90e-01  1.72e-01 -5.30e-02]
 [-3.45e-02  2.03e-01  1.05e-01 -4.93e-02  1.86e-02]
 [ 9.91e-03 -5.55e-02 -1.72e-02  6.54e-03 -2.61e-03]]
[[ 0.00e+00  1.00e+00  0.00e+00 -9.15e-02 -6.81e-02]
 [ 0.00e+00  0.00e+00  4.71e-03  2.94e-03  1.93e-02]
 [ 0.00e+00  2.10e-02 -1.90e-03  2.55e-02 -1.93e-02]
 [ 1.33e-03 -3.50e-03 -3.87e-03 -1.55e-03 -4.30e-03]
 [-1.60e-02 -1.29e-02 -7.27e-04 -8.98e-03 -2.57e-03]]
[[ 6.63e-03 -1.04e-02 -4.28e-03 -7.35e-03 -1.32e-03]
 [-5.90e-02  1.38e-01 -1.14e-01  1.06e-01 -5.24e-03]
 [ 1.42e-01 -6.48e-01 -3.08e-01  9.30e-01 -2.12e-01]
 [-2.88e-02  2.13e-02  5.44e-02 -1.50e-02  3.09e-02]
 [ 2.19e-04  1.38e-02 -3.64e-02  1.62e-02 -9.18e-03]]
[[ 0.00e+00  0.00e+00  0.00e+00 -6.39e-04  1.88e-03]
 [ 1.00e+00  0.00e+00  2.50e-02 -2.92e-03 -1.13e-02]
 [ 0.00e+00  3.74e-03 -1.92e-02 -5.13e-03 -8.75e-03]
 [-9.91e-02 -4.49e-05  3.62e-02  2.09e-03 -4.51e-03]
 [-7.87e-02  8.92e-03 -2.48e-02  1.22e-04 -5.49e-03]]
[[ 9.10e-04 -4.50e-02  1.32e-01 -3.20e-02 -1.27e-03]
 [ 4.62e-03  8.82e-02 -6.04e-01  5.38e-02  6.45e-03]
 [-3.57e-03 -1.14e-01 -2.75e-01 -8.12e-02  1.99e-03]
 [ 5.93e-03  5.21e-02  9.89e-01  3.39e-02 -3.34e-04]
 [-5.68e-03  1.08e-02 -2.30e-01  1.86e-02 -5.28e-03]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00  3.75e-03]
 [ 0.00e+00  0.00e+00  0.00e+00  1.51e-04 -5.83e-03]
 [ 0.00e+00  0.00e+00  3.40e-03 -1.98e-03  5.33e-04]
 [ 0.00e+00  1.18e-04 -2.90e-03  6.10e-04  6.11e-03]
 [ 1.70e-01 -3.72e-03 -1.67e-04  5.05e-03 -2.93e-02]]
[[-0.04  0.14 -0.03  0.13 -0.03]
 [ 0.14 -0.54  0.08 -0.48  0.12]
 [-0.28  2.06 -2.5   1.96 -0.24]
 [ 0.12 -0.45 -0.05 -0.39  0.09]
 [-0.03  0.11  0.02  0.09 -0.02]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  1.09e-04]
 [ 0.00e+00  1.00e+00  0.00e+00 -2.02e-03 -4.42e-03]
 [ 0.00e+00  0.00e+00  3.50e-04 -4.00e-03  3.22e-04]
 [ 0.00e+00 -2.48e-03  1.14e-03  3.78e-03  7.35e-04]
 [ 2.53e-03 -5.02e-03  7.52e-05  8.21e-03 -1.48e-05]]
[[ 0.   -0.04 -0.    0.05 -0.  ]
 [-0.03  0.38  0.01 -0.41  0.04]
 [-0.03  0.08  0.01 -0.08  0.03]
 [ 0.08 -0.49 -0.03  0.51 -0.08]
 [-0.01  0.07  0.01 -0.07  0.01]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  9.08e-03]
 [ 0.00e+00  0.00e+00  0.00e+00  1.28e-03 -5.86e-03]
 [ 1.00e+00  0.00e+00  5.00e-03 -1.13e-03 -3.42e-03]
 [ 0.00e+00  3.38e-04 -2.84e-03  9.40e-05  6.18e-03]
 [ 1.29e-03 -3.59e-03  1.07e-03  3.67e-03 -7.09e-03]]
[[-1.28e-02  5.06e-02 -1.50e-01  3.80e-02 -8.33e-03]
 [ 4.36e-02 -1.63e-01  1.53e+00 -1.09e-01  2.42e-02]
 [-3.86e-02  1.31e-01 -2.63e+00  5.23e-02 -1.02e-02]
 [ 2.22e-02 -7.26e-02  1.40e+00 -2.31e-02  4.39e-03]
 [-5.30e-03  1.79e-02 -9.95e-02  5.89e-03 -1.02e-03]]
SymNet parameters
[[-2.51e-01  1.02e+00  1.63e-01  1.97e-01  3.54e-02 -1.11e-02 -1.32e-01  5.23e-02
  -7.20e-02 -8.34e-03  2.52e-02 -2.07e-03]
 [-1.78e+00  6.34e-02 -1.09e-02 -1.79e-02 -9.69e-04  3.03e-03 -1.55e-01 -3.44e-03
   2.35e-03  2.08e-03 -1.98e-03  1.96e-05]]
SymNet parameters
[-0.25 -0.37]
SymNet parameters
[[-5.95e+00 -4.47e-02 -1.31e-01 -7.64e-02 -2.18e-02  1.90e-03 -6.13e-02 -2.72e-02
   3.26e-01 -4.60e-03 -1.05e-02  9.07e-03 -9.49e-02]
 [-6.13e-01 -1.17e-01 -6.08e+00 -1.05e-01  2.27e-01  9.41e-03 -5.56e-02 -7.13e-02
   1.63e-02  2.56e-02 -3.37e-02  6.85e-03 -1.50e-01]]
SymNet parameters
[-3.4  -0.99]
SymNet parameters
[[ 4.99e-01 -2.41e-01  3.70e+00  4.67e-03  3.77e-02  1.22e-03  2.94e-02 -8.67e-04
   1.93e-03 -1.01e-02  1.38e-02  1.07e-02  8.92e-02  1.80e-04]
 [ 1.26e-01 -8.36e-03 -2.51e-03 -5.87e-03 -2.53e-03  2.31e-04 -2.09e+00 -1.57e-02
  -7.56e-03  1.22e-03 -1.96e-03  1.24e-03  9.58e-03  7.42e-04]]
SymNet parameters
[ 0.4  -1.84]
SymNet parameters
[[ 5.34e-01  1.24e+00  2.15e-01 -3.81e-01 -6.31e-02  1.77e-02 -2.17e-01 -9.48e-02
   1.46e-01  2.22e-02 -5.62e-02  2.48e-03 -3.31e-02  1.80e-02  8.73e-02]
 [-9.36e-01 -5.42e-02 -1.21e-02 -2.83e-02 -1.25e-02  3.62e-04 -2.13e-02 -8.79e-03
   1.41e-02  5.96e-03 -9.47e-03 -2.87e-03 -4.11e-02  1.11e-02 -3.95e-04]]
SymNet parameters
[0.24 0.52]
SymNet parameters
[[-1.49e+00 -5.14e-01 -9.66e-01  1.98e+00  1.25e+00  8.11e-02  6.79e-01  6.68e-01
  -1.13e+00 -7.66e-01  9.89e-01  4.32e-01  3.18e+00 -1.40e+00  5.75e-02  6.35e-02]
 [ 1.84e+00 -1.83e+00 -4.40e-01  7.22e-01  1.22e-01 -3.72e-02 -2.42e+00  3.08e-01
  -2.71e-01 -3.53e-02  1.07e-01 -5.59e-03  1.17e-01 -3.01e-02 -1.51e-01 -8.88e-04]]
SymNet parameters
[-0.02  1.14]
SymNet parameters
[[-8.68e-02 -1.31e-01  7.71e-01  1.40e-01  2.26e-02  5.05e-02  1.29e-01  2.18e-02
  -3.66e-02 -8.52e-03  1.75e-02  2.09e-03  3.46e-01 -8.85e-03  9.40e-02  3.29e-01
  -3.10e-04]]
SymNet parameters
[0.01]
SymNet parameters
[[ 3.64e-03  4.30e-02  4.16e-02 -3.42e-03  5.90e-04  1.44e-03  5.71e-01  1.03e-01
  -3.91e-02  2.10e-03 -8.39e-03 -1.62e-02]
 [-3.69e+00  2.94e-02  3.95e-03 -4.14e-03  2.31e-03  3.88e-03  2.08e-01 -2.90e-03
  -3.21e-02 -1.34e-02 -5.33e-02  3.54e-02]]
SymNet parameters
[0.22 0.51]
SymNet parameters
[[-2.21e+00 -2.56e-02 -5.46e-03  2.39e-03  8.11e-05 -2.85e-03  1.15e-01  9.18e-02
   3.32e-01  3.86e-03 -2.64e-02 -2.93e-02 -3.05e-02]
 [ 1.00e-02  1.84e-01  1.70e-01 -1.49e-02  2.52e-03  7.19e-03  2.46e+00 -5.41e-02
  -1.41e-01  6.00e-03 -3.50e-02 -5.46e-02  5.65e-03]]
SymNet parameters
[ 0.78 -0.09]
SymNet parameters
[[ 7.63e-03  1.60e-03 -1.26e-04 -3.66e-05  6.40e-05  1.40e-04  5.81e-02  1.23e-02
   2.36e-02 -3.34e-04  1.84e-03  2.07e-03 -3.49e-03  1.63e-05]
 [ 6.79e-01 -8.31e-01 -9.31e-01  3.13e-02  3.79e-03 -1.55e-02  1.29e+00  1.78e-01
   6.10e-01 -1.44e-01 -1.41e-01  6.43e-01  7.36e-01 -2.76e-01]]
SymNet parameters
[-0.39  0.8 ]
SymNet parameters
[[ 2.36  0.87  0.97 -0.13  0.05 -0.01  4.22  1.09 -3.75  0.03 -1.08 -0.55  0.85 -0.4
   2.39]
 [-3.77  0.71 -0.59 -0.16  0.1   0.16 -2.85  0.84 -3.03 -0.54 -0.58  2.41  1.14 -0.47
   1.83]]
SymNet parameters
[0.12 0.04]
SymNet parameters
[[ 9.52e-01 -3.41e+00 -2.12e+00  2.76e-01 -4.10e-02 -2.41e-01  8.64e-01  3.84e+00
  -1.95e+00  2.58e-01  2.75e-01 -8.89e-01 -4.44e-01 -4.28e-01 -7.55e-01  3.94e-03]
 [-6.10e-01 -1.92e-01 -1.53e-01  2.17e-04 -5.65e-05 -6.55e-03 -3.51e+00 -4.02e-03
   4.02e-01 -1.85e-02 -1.34e-01  2.16e-02 -1.97e-01  7.23e-02  2.79e-01  1.59e-04]]
SymNet parameters
[0.27 1.35]
SymNet parameters
[[ 1.73  0.46  0.55 -0.02 -0.    0.01  0.31 -0.19 -0.39  0.14  0.1  -0.35  1.96 -0.77
  -1.41 -0.   -0.01]]
SymNet parameters
[-0.76]
finally, finish this stage
iter:     0    time: 1472.16
Func: 1.57e-01  |g|: 6.19e+01
stableloss: 2.73e-02   dataloss: 1.37e-01   sparseloss: 1.56e+02 momentloss: 6.89e+00
current expression:
[u00*u01, u10*v00, u20, u02, u00*u01**2, u00*u10*v01, u00*u11*v00, u10*v00*v10, u01*u10*v00, u00, 1, u00*v00**2, u00**2*v00, u00*u01*v00, v01, u01, u00*u01*u10, u00**2, u00*v01, u00*v00*v01]
[-0.98 -0.97  0.05  0.05  0.01  0.01  0.01  0.01  0.01  0.01 -0.   -0.    0.   -0.
 -0.    0.    0.    0.   -0.   -0.  ]
[v00*v10, u00*v01, v02, v20, v00, v00*v10**2, u00*v01*v10, u00*v00*v11, u00*u01*v01, v01, u00*u10*v01, v00**3, u00*v00, u00*u10, v10, u00**2, u00*u01, u00**2*v00, u01*v00*v01, v00**2*v01]
[-0.98 -0.98  0.05  0.05  0.01  0.01  0.01  0.01  0.01  0.01  0.01 -0.    0.   -0.
 -0.    0.   -0.   -0.    0.   -0.  ]
block:  4
name:  burgers-2-upwind-sparse0-noise0.001-id2
device:  cuda:2
generate a random number to check random seed:  3.990486988877996
current stage is: block-4
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.9058, device='cuda:2', dtype=torch.float64)
u_obs variance
tensor([ 0.2571,  1.7058,  1.6989, 20.9429, 10.6586, 20.1600,  0.2554,  1.5630,
         1.7071, 17.7411,  9.5763, 23.0487], device='cuda:2',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 0.306246
         Iterations: 0
         Function evaluations: 15
         Gradient evaluations: 3
convolution moment and kernels
[[ 1.00e+00  0.00e+00  1.64e-03 -3.68e-03 -5.62e-02]
 [ 0.00e+00  8.44e-05 -7.01e-04  2.13e-03  3.33e-02]
 [ 1.57e-04  4.73e-03  7.89e-03  2.31e-03 -6.44e-03]
 [ 7.15e-03 -2.76e-03 -2.24e-03  3.58e-04  2.41e-03]
 [-6.24e-02  3.88e-02 -8.15e-03 -6.17e-03  3.86e-03]]
[[ 1.31e-02 -6.70e-02 -1.09e-02 -1.31e-03  1.14e-04]
 [-7.32e-02  3.58e-01 -1.09e-01  1.03e-01 -2.13e-02]
 [ 3.02e-02 -2.15e-01  6.91e-01  1.72e-01 -5.30e-02]
 [-3.45e-02  2.03e-01  1.05e-01 -4.93e-02  1.86e-02]
 [ 9.91e-03 -5.55e-02 -1.72e-02  6.54e-03 -2.61e-03]]
[[ 0.00e+00  1.00e+00  0.00e+00 -9.15e-02 -6.81e-02]
 [ 0.00e+00  0.00e+00  4.71e-03  2.94e-03  1.93e-02]
 [ 0.00e+00  2.10e-02 -1.91e-03  2.55e-02 -1.93e-02]
 [ 1.33e-03 -3.50e-03 -3.87e-03 -1.55e-03 -4.31e-03]
 [-1.60e-02 -1.29e-02 -7.26e-04 -8.98e-03 -2.58e-03]]
[[ 6.62e-03 -1.04e-02 -4.29e-03 -7.35e-03 -1.32e-03]
 [-5.90e-02  1.38e-01 -1.14e-01  1.06e-01 -5.24e-03]
 [ 1.42e-01 -6.48e-01 -3.08e-01  9.31e-01 -2.12e-01]
 [-2.87e-02  2.12e-02  5.45e-02 -1.51e-02  3.09e-02]
 [ 2.14e-04  1.38e-02 -3.65e-02  1.63e-02 -9.18e-03]]
[[ 0.00e+00  0.00e+00  0.00e+00 -6.41e-04  1.88e-03]
 [ 1.00e+00  0.00e+00  2.50e-02 -2.92e-03 -1.13e-02]
 [ 0.00e+00  3.74e-03 -1.92e-02 -5.13e-03 -8.75e-03]
 [-9.91e-02 -4.53e-05  3.62e-02  2.09e-03 -4.52e-03]
 [-7.87e-02  8.92e-03 -2.48e-02  1.20e-04 -5.50e-03]]
[[ 9.12e-04 -4.50e-02  1.32e-01 -3.20e-02 -1.27e-03]
 [ 4.62e-03  8.82e-02 -6.04e-01  5.37e-02  6.46e-03]
 [-3.58e-03 -1.14e-01 -2.75e-01 -8.11e-02  1.96e-03]
 [ 5.94e-03  5.20e-02  9.89e-01  3.39e-02 -3.13e-04]
 [-5.69e-03  1.08e-02 -2.30e-01  1.86e-02 -5.28e-03]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00  3.75e-03]
 [ 0.00e+00  0.00e+00  0.00e+00  1.51e-04 -5.83e-03]
 [ 0.00e+00  0.00e+00  3.40e-03 -1.98e-03  5.33e-04]
 [ 0.00e+00  1.18e-04 -2.90e-03  6.10e-04  6.11e-03]
 [ 1.70e-01 -3.72e-03 -1.67e-04  5.05e-03 -2.93e-02]]
[[-0.04  0.14 -0.03  0.13 -0.03]
 [ 0.14 -0.54  0.08 -0.48  0.12]
 [-0.28  2.06 -2.5   1.96 -0.24]
 [ 0.12 -0.45 -0.05 -0.39  0.09]
 [-0.03  0.11  0.02  0.09 -0.02]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  1.09e-04]
 [ 0.00e+00  1.00e+00  0.00e+00 -2.02e-03 -4.42e-03]
 [ 0.00e+00  0.00e+00  3.50e-04 -4.00e-03  3.21e-04]
 [ 0.00e+00 -2.48e-03  1.14e-03  3.78e-03  7.35e-04]
 [ 2.53e-03 -5.02e-03  7.52e-05  8.21e-03 -1.48e-05]]
[[ 0.   -0.04 -0.    0.05 -0.  ]
 [-0.03  0.38  0.01 -0.41  0.04]
 [-0.03  0.08  0.01 -0.08  0.03]
 [ 0.08 -0.49 -0.03  0.51 -0.08]
 [-0.01  0.07  0.01 -0.07  0.01]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  9.08e-03]
 [ 0.00e+00  0.00e+00  0.00e+00  1.28e-03 -5.86e-03]
 [ 1.00e+00  0.00e+00  5.00e-03 -1.13e-03 -3.42e-03]
 [ 0.00e+00  3.39e-04 -2.84e-03  9.40e-05  6.18e-03]
 [ 1.29e-03 -3.59e-03  1.07e-03  3.67e-03 -7.09e-03]]
[[-1.28e-02  5.06e-02 -1.50e-01  3.80e-02 -8.33e-03]
 [ 4.36e-02 -1.63e-01  1.53e+00 -1.09e-01  2.42e-02]
 [-3.86e-02  1.31e-01 -2.63e+00  5.23e-02 -1.02e-02]
 [ 2.22e-02 -7.26e-02  1.40e+00 -2.31e-02  4.39e-03]
 [-5.30e-03  1.79e-02 -9.95e-02  5.90e-03 -1.03e-03]]
SymNet parameters
[[-2.51e-01  1.02e+00  1.63e-01  1.97e-01  3.54e-02 -1.11e-02 -1.32e-01  5.23e-02
  -7.20e-02 -8.34e-03  2.52e-02 -2.07e-03]
 [-1.78e+00  6.34e-02 -1.09e-02 -1.79e-02 -9.70e-04  3.03e-03 -1.55e-01 -3.44e-03
   2.35e-03  2.08e-03 -1.98e-03  2.06e-05]]
SymNet parameters
[-0.25 -0.37]
SymNet parameters
[[-5.95e+00 -4.47e-02 -1.31e-01 -7.64e-02 -2.18e-02  1.90e-03 -6.13e-02 -2.72e-02
   3.26e-01 -4.61e-03 -1.05e-02  9.07e-03 -9.49e-02]
 [-6.13e-01 -1.17e-01 -6.08e+00 -1.05e-01  2.27e-01  9.41e-03 -5.56e-02 -7.13e-02
   1.63e-02  2.56e-02 -3.37e-02  6.85e-03 -1.50e-01]]
SymNet parameters
[-3.4  -0.99]
SymNet parameters
[[ 4.99e-01 -2.41e-01  3.70e+00  4.67e-03  3.77e-02  1.22e-03  2.94e-02 -8.67e-04
   1.93e-03 -1.01e-02  1.38e-02  1.07e-02  8.92e-02  1.89e-04]
 [ 1.26e-01 -8.36e-03 -2.51e-03 -5.87e-03 -2.53e-03  2.33e-04 -2.09e+00 -1.57e-02
  -7.56e-03  1.22e-03 -1.96e-03  1.24e-03  9.58e-03  6.52e-04]]
SymNet parameters
[ 0.4  -1.84]
SymNet parameters
[[ 5.34e-01  1.24e+00  2.15e-01 -3.81e-01 -6.31e-02  1.77e-02 -2.17e-01 -9.48e-02
   1.46e-01  2.22e-02 -5.62e-02  2.48e-03 -3.31e-02  1.80e-02  8.73e-02]
 [-9.36e-01 -5.42e-02 -1.21e-02 -2.83e-02 -1.25e-02  3.60e-04 -2.13e-02 -8.79e-03
   1.41e-02  5.96e-03 -9.47e-03 -2.87e-03 -4.11e-02  1.11e-02 -3.69e-04]]
SymNet parameters
[0.24 0.52]
SymNet parameters
[[-1.49e+00 -5.14e-01 -9.66e-01  1.98e+00  1.25e+00  8.11e-02  6.79e-01  6.68e-01
  -1.13e+00 -7.66e-01  9.89e-01  4.32e-01  3.18e+00 -1.40e+00  5.75e-02  6.35e-02]
 [ 1.84e+00 -1.83e+00 -4.40e-01  7.22e-01  1.22e-01 -3.72e-02 -2.42e+00  3.08e-01
  -2.71e-01 -3.53e-02  1.07e-01 -5.59e-03  1.17e-01 -3.01e-02 -1.51e-01 -8.87e-04]]
SymNet parameters
[-0.02  1.14]
SymNet parameters
[[-8.68e-02 -1.31e-01  7.71e-01  1.40e-01  2.26e-02  5.05e-02  1.29e-01  2.18e-02
  -3.66e-02 -8.52e-03  1.75e-02  2.09e-03  3.46e-01 -8.87e-03  9.41e-02  3.29e-01
  -6.58e-04]]
SymNet parameters
[0.01]
SymNet parameters
[[ 3.65e-03  4.29e-02  4.16e-02 -3.45e-03  6.09e-04  1.38e-03  5.71e-01  1.03e-01
  -3.92e-02  2.08e-03 -8.39e-03 -1.62e-02]
 [-3.69e+00  2.94e-02  3.95e-03 -4.14e-03  2.32e-03  3.88e-03  2.08e-01 -2.90e-03
  -3.21e-02 -1.34e-02 -5.33e-02  3.54e-02]]
SymNet parameters
[0.22 0.51]
SymNet parameters
[[-2.21e+00 -2.56e-02 -5.46e-03  2.39e-03  7.57e-05 -2.86e-03  1.15e-01  9.18e-02
   3.32e-01  3.85e-03 -2.63e-02 -2.93e-02 -3.05e-02]
 [ 9.99e-03  1.84e-01  1.70e-01 -1.49e-02  2.51e-03  7.20e-03  2.46e+00 -5.41e-02
  -1.41e-01  6.00e-03 -3.50e-02 -5.46e-02  5.65e-03]]
SymNet parameters
[ 0.78 -0.09]
SymNet parameters
[[ 7.64e-03  1.60e-03 -1.35e-04 -3.69e-05  6.94e-05  1.21e-04  5.81e-02  1.23e-02
   2.36e-02 -3.41e-04  1.85e-03  2.08e-03 -3.51e-03 -1.61e-05]
 [ 6.79e-01 -8.31e-01 -9.31e-01  3.13e-02  3.79e-03 -1.55e-02  1.29e+00  1.78e-01
   6.10e-01 -1.44e-01 -1.41e-01  6.43e-01  7.36e-01 -2.76e-01]]
SymNet parameters
[-0.39  0.8 ]
SymNet parameters
[[ 2.36  0.87  0.97 -0.13  0.05 -0.01  4.22  1.09 -3.75  0.03 -1.08 -0.55  0.85 -0.4
   2.39]
 [-3.77  0.71 -0.59 -0.16  0.1   0.16 -2.85  0.84 -3.03 -0.54 -0.58  2.41  1.14 -0.47
   1.83]]
SymNet parameters
[0.12 0.04]
SymNet parameters
[[ 9.52e-01 -3.41e+00 -2.12e+00  2.76e-01 -4.10e-02 -2.41e-01  8.64e-01  3.84e+00
  -1.95e+00  2.58e-01  2.75e-01 -8.89e-01 -4.44e-01 -4.28e-01 -7.55e-01  3.94e-03]
 [-6.10e-01 -1.92e-01 -1.53e-01  2.17e-04 -5.64e-05 -6.55e-03 -3.51e+00 -4.02e-03
   4.02e-01 -1.85e-02 -1.34e-01  2.16e-02 -1.97e-01  7.23e-02  2.79e-01  1.41e-04]]
SymNet parameters
[0.27 1.35]
SymNet parameters
[[ 1.73  0.46  0.55 -0.02 -0.    0.01  0.31 -0.19 -0.39  0.14  0.1  -0.35  1.96 -0.77
  -1.41 -0.   -0.01]]
SymNet parameters
[-0.76]
finally, finish this stage
iter:     0    time: 93.66
Func: 3.06e-01  |g|: 1.88e+02
stableloss: 4.81e-02   dataloss: 2.79e-01   sparseloss: 1.56e+02 momentloss: 6.89e+00
current expression:
[u00*u01, u10*v00, u20, u02, u00*u01**2, u00*u10*v01, u00*u11*v00, u10*v00*v10, u01*u10*v00, u00, 1, u00*v00**2, u00**2*v00, u00*u01*v00, v01, u01, u00*u01*u10, u00**2, u00*v01, u00*v00*v01]
[-0.98 -0.97  0.05  0.05  0.01  0.01  0.01  0.01  0.01  0.01 -0.   -0.    0.   -0.
 -0.    0.    0.    0.   -0.   -0.  ]
[v00*v10, u00*v01, v02, v20, v00, v00*v10**2, u00*v01*v10, u00*v00*v11, u00*u01*v01, v01, u00*u10*v01, v00**3, u00*v00, u00*u10, v10, u00**2, u00*u01, u00**2*v00, u01*v00*v01, v00**2*v01]
[-0.98 -0.98  0.05  0.05  0.01  0.01  0.01  0.01  0.01  0.01  0.01 -0.    0.   -0.
 -0.    0.   -0.   -0.    0.   -0.  ]
block:  5
name:  burgers-2-upwind-sparse0-noise0.001-id2
device:  cuda:2
generate a random number to check random seed:  -0.36971406663442186
current stage is: block-5
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.7986, device='cuda:2', dtype=torch.float64)
u_obs variance
tensor([ 0.2472,  1.6431,  1.6238, 21.0497, 10.1305, 19.4078,  0.2632,  1.7000,
         1.8228, 19.7803, 10.3846, 24.8967], device='cuda:2',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 0.492386
         Iterations: 0
         Function evaluations: 15
         Gradient evaluations: 3
convolution moment and kernels
[[ 1.00e+00  0.00e+00  1.64e-03 -3.68e-03 -5.62e-02]
 [ 0.00e+00  8.45e-05 -7.01e-04  2.13e-03  3.33e-02]
 [ 1.57e-04  4.73e-03  7.89e-03  2.31e-03 -6.43e-03]
 [ 7.15e-03 -2.76e-03 -2.24e-03  3.58e-04  2.41e-03]
 [-6.24e-02  3.88e-02 -8.15e-03 -6.17e-03  3.86e-03]]
[[ 1.31e-02 -6.70e-02 -1.09e-02 -1.31e-03  1.13e-04]
 [-7.32e-02  3.58e-01 -1.09e-01  1.03e-01 -2.13e-02]
 [ 3.02e-02 -2.15e-01  6.91e-01  1.72e-01 -5.31e-02]
 [-3.45e-02  2.03e-01  1.05e-01 -4.93e-02  1.86e-02]
 [ 9.91e-03 -5.55e-02 -1.72e-02  6.54e-03 -2.61e-03]]
[[ 0.00e+00  1.00e+00  0.00e+00 -9.15e-02 -6.81e-02]
 [ 0.00e+00  0.00e+00  4.71e-03  2.94e-03  1.93e-02]
 [ 0.00e+00  2.10e-02 -1.90e-03  2.55e-02 -1.93e-02]
 [ 1.33e-03 -3.50e-03 -3.87e-03 -1.55e-03 -4.31e-03]
 [-1.60e-02 -1.29e-02 -7.26e-04 -8.98e-03 -2.58e-03]]
[[ 6.62e-03 -1.03e-02 -4.29e-03 -7.35e-03 -1.32e-03]
 [-5.90e-02  1.38e-01 -1.14e-01  1.06e-01 -5.24e-03]
 [ 1.42e-01 -6.48e-01 -3.08e-01  9.31e-01 -2.12e-01]
 [-2.87e-02  2.12e-02  5.45e-02 -1.51e-02  3.09e-02]
 [ 2.14e-04  1.38e-02 -3.65e-02  1.63e-02 -9.18e-03]]
[[ 0.00e+00  0.00e+00  0.00e+00 -6.41e-04  1.88e-03]
 [ 1.00e+00  0.00e+00  2.50e-02 -2.92e-03 -1.13e-02]
 [ 0.00e+00  3.74e-03 -1.92e-02 -5.13e-03 -8.75e-03]
 [-9.91e-02 -4.52e-05  3.62e-02  2.09e-03 -4.51e-03]
 [-7.87e-02  8.92e-03 -2.48e-02  1.20e-04 -5.50e-03]]
[[ 9.11e-04 -4.50e-02  1.32e-01 -3.20e-02 -1.27e-03]
 [ 4.62e-03  8.82e-02 -6.04e-01  5.37e-02  6.47e-03]
 [-3.58e-03 -1.14e-01 -2.75e-01 -8.11e-02  1.96e-03]
 [ 5.93e-03  5.20e-02  9.89e-01  3.39e-02 -3.14e-04]
 [-5.69e-03  1.08e-02 -2.30e-01  1.86e-02 -5.28e-03]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00  3.75e-03]
 [ 0.00e+00  0.00e+00  0.00e+00  1.51e-04 -5.83e-03]
 [ 0.00e+00  0.00e+00  3.40e-03 -1.98e-03  5.33e-04]
 [ 0.00e+00  1.18e-04 -2.90e-03  6.10e-04  6.11e-03]
 [ 1.70e-01 -3.72e-03 -1.66e-04  5.05e-03 -2.93e-02]]
[[-0.04  0.14 -0.03  0.13 -0.03]
 [ 0.14 -0.54  0.08 -0.48  0.12]
 [-0.28  2.06 -2.5   1.96 -0.24]
 [ 0.12 -0.45 -0.05 -0.39  0.09]
 [-0.03  0.11  0.02  0.09 -0.02]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  1.09e-04]
 [ 0.00e+00  1.00e+00  0.00e+00 -2.02e-03 -4.42e-03]
 [ 0.00e+00  0.00e+00  3.50e-04 -4.00e-03  3.22e-04]
 [ 0.00e+00 -2.48e-03  1.14e-03  3.78e-03  7.35e-04]
 [ 2.53e-03 -5.02e-03  7.52e-05  8.21e-03 -1.49e-05]]
[[ 0.   -0.04 -0.    0.05 -0.  ]
 [-0.03  0.38  0.01 -0.41  0.04]
 [-0.03  0.08  0.01 -0.08  0.03]
 [ 0.08 -0.49 -0.03  0.51 -0.08]
 [-0.01  0.07  0.01 -0.07  0.01]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  9.08e-03]
 [ 0.00e+00  0.00e+00  0.00e+00  1.28e-03 -5.86e-03]
 [ 1.00e+00  0.00e+00  5.00e-03 -1.13e-03 -3.42e-03]
 [ 0.00e+00  3.38e-04 -2.84e-03  9.41e-05  6.18e-03]
 [ 1.29e-03 -3.59e-03  1.07e-03  3.67e-03 -7.09e-03]]
[[-1.28e-02  5.06e-02 -1.50e-01  3.80e-02 -8.33e-03]
 [ 4.36e-02 -1.63e-01  1.53e+00 -1.09e-01  2.42e-02]
 [-3.86e-02  1.31e-01 -2.63e+00  5.23e-02 -1.02e-02]
 [ 2.22e-02 -7.26e-02  1.40e+00 -2.31e-02  4.40e-03]
 [-5.30e-03  1.79e-02 -9.95e-02  5.90e-03 -1.03e-03]]
SymNet parameters
[[-2.51e-01  1.02e+00  1.63e-01  1.97e-01  3.54e-02 -1.11e-02 -1.32e-01  5.23e-02
  -7.20e-02 -8.34e-03  2.52e-02 -2.07e-03]
 [-1.78e+00  6.34e-02 -1.09e-02 -1.79e-02 -9.70e-04  3.03e-03 -1.55e-01 -3.44e-03
   2.35e-03  2.08e-03 -1.98e-03  1.98e-05]]
SymNet parameters
[-0.25 -0.37]
SymNet parameters
[[-5.95e+00 -4.47e-02 -1.31e-01 -7.64e-02 -2.18e-02  1.90e-03 -6.13e-02 -2.72e-02
   3.26e-01 -4.60e-03 -1.05e-02  9.07e-03 -9.49e-02]
 [-6.13e-01 -1.17e-01 -6.08e+00 -1.05e-01  2.27e-01  9.41e-03 -5.56e-02 -7.13e-02
   1.63e-02  2.56e-02 -3.37e-02  6.85e-03 -1.50e-01]]
SymNet parameters
[-3.4  -0.99]
SymNet parameters
[[ 4.99e-01 -2.41e-01  3.70e+00  4.67e-03  3.77e-02  1.22e-03  2.94e-02 -8.67e-04
   1.93e-03 -1.01e-02  1.38e-02  1.07e-02  8.92e-02  1.88e-04]
 [ 1.26e-01 -8.36e-03 -2.51e-03 -5.87e-03 -2.53e-03  2.33e-04 -2.09e+00 -1.57e-02
  -7.56e-03  1.22e-03 -1.96e-03  1.24e-03  9.58e-03  6.78e-04]]
SymNet parameters
[ 0.4  -1.84]
SymNet parameters
[[ 5.34e-01  1.24e+00  2.15e-01 -3.81e-01 -6.31e-02  1.77e-02 -2.17e-01 -9.48e-02
   1.46e-01  2.22e-02 -5.62e-02  2.48e-03 -3.31e-02  1.79e-02  8.73e-02]
 [-9.36e-01 -5.42e-02 -1.21e-02 -2.83e-02 -1.25e-02  3.61e-04 -2.13e-02 -8.79e-03
   1.41e-02  5.96e-03 -9.47e-03 -2.87e-03 -4.11e-02  1.11e-02 -3.69e-04]]
SymNet parameters
[0.24 0.52]
SymNet parameters
[[-1.49e+00 -5.14e-01 -9.66e-01  1.98e+00  1.25e+00  8.11e-02  6.79e-01  6.68e-01
  -1.13e+00 -7.66e-01  9.89e-01  4.32e-01  3.18e+00 -1.40e+00  5.75e-02  6.35e-02]
 [ 1.84e+00 -1.83e+00 -4.40e-01  7.22e-01  1.22e-01 -3.72e-02 -2.42e+00  3.08e-01
  -2.71e-01 -3.53e-02  1.07e-01 -5.59e-03  1.17e-01 -3.01e-02 -1.51e-01 -8.87e-04]]
SymNet parameters
[-0.02  1.14]
SymNet parameters
[[-0.09 -0.13  0.77  0.14  0.02  0.05  0.13  0.02 -0.04 -0.01  0.02  0.    0.35 -0.01
   0.09  0.33 -0.  ]]
SymNet parameters
[0.01]
SymNet parameters
[[ 3.66e-03  4.29e-02  4.16e-02 -3.43e-03  6.15e-04  1.41e-03  5.71e-01  1.03e-01
  -3.91e-02  2.09e-03 -8.40e-03 -1.61e-02]
 [-3.69e+00  2.94e-02  3.95e-03 -4.15e-03  2.31e-03  3.88e-03  2.08e-01 -2.90e-03
  -3.21e-02 -1.34e-02 -5.33e-02  3.54e-02]]
SymNet parameters
[0.22 0.51]
SymNet parameters
[[-2.21e+00 -2.56e-02 -5.46e-03  2.40e-03  8.01e-05 -2.86e-03  1.15e-01  9.18e-02
   3.32e-01  3.86e-03 -2.63e-02 -2.93e-02 -3.05e-02]
 [ 9.99e-03  1.84e-01  1.70e-01 -1.49e-02  2.51e-03  7.20e-03  2.46e+00 -5.41e-02
  -1.41e-01  6.00e-03 -3.50e-02 -5.46e-02  5.65e-03]]
SymNet parameters
[ 0.78 -0.09]
SymNet parameters
[[ 7.64e-03  1.60e-03 -1.30e-04 -4.00e-05  6.69e-05  1.24e-04  5.81e-02  1.23e-02
   2.36e-02 -3.16e-04  1.84e-03  2.04e-03 -3.51e-03  4.52e-07]
 [ 6.79e-01 -8.31e-01 -9.31e-01  3.13e-02  3.79e-03 -1.55e-02  1.29e+00  1.78e-01
   6.10e-01 -1.44e-01 -1.41e-01  6.43e-01  7.36e-01 -2.76e-01]]
SymNet parameters
[-0.39  0.8 ]
SymNet parameters
[[ 2.36  0.87  0.97 -0.13  0.05 -0.01  4.22  1.09 -3.75  0.03 -1.08 -0.55  0.85 -0.4
   2.39]
 [-3.77  0.71 -0.59 -0.16  0.1   0.16 -2.85  0.84 -3.03 -0.54 -0.58  2.41  1.14 -0.47
   1.83]]
SymNet parameters
[0.12 0.04]
SymNet parameters
[[ 9.52e-01 -3.41e+00 -2.12e+00  2.76e-01 -4.10e-02 -2.41e-01  8.64e-01  3.84e+00
  -1.95e+00  2.58e-01  2.75e-01 -8.89e-01 -4.44e-01 -4.28e-01 -7.55e-01  3.92e-03]
 [-6.10e-01 -1.92e-01 -1.53e-01  2.17e-04 -5.62e-05 -6.55e-03 -3.51e+00 -4.02e-03
   4.02e-01 -1.85e-02 -1.34e-01  2.16e-02 -1.97e-01  7.23e-02  2.79e-01  1.76e-04]]
SymNet parameters
[0.27 1.35]
SymNet parameters
[[ 1.73  0.46  0.55 -0.02 -0.    0.01  0.31 -0.19 -0.39  0.14  0.1  -0.35  1.96 -0.77
  -1.41 -0.   -0.01]]
SymNet parameters
[-0.76]
finally, finish this stage
iter:     0    time: 94.05
Func: 4.92e-01  |g|: 1.63e+02
stableloss: 3.63e-02   dataloss: 4.58e-01   sparseloss: 1.56e+02 momentloss: 6.89e+00
current expression:
[u00*u01, u10*v00, u20, u02, u00*u01**2, u00*u10*v01, u00*u11*v00, u10*v00*v10, u01*u10*v00, u00, 1, u00*v00**2, u00**2*v00, u00*u01*v00, v01, u01, u00*u01*u10, u00**2, u00*v01, u00*v00*v01]
[-0.98 -0.97  0.05  0.05  0.01  0.01  0.01  0.01  0.01  0.01 -0.   -0.    0.   -0.
 -0.    0.    0.    0.   -0.   -0.  ]
[v00*v10, u00*v01, v02, v20, v00, v00*v10**2, u00*v01*v10, u00*v00*v11, u00*u01*v01, v01, u00*u10*v01, v00**3, u00*v00, u00*u10, v10, u00**2, u00*u01, u00**2*v00, u01*v00*v01, v00**2*v01]
[-0.98 -0.98  0.05  0.05  0.01  0.01  0.01  0.01  0.01  0.01  0.01 -0.    0.   -0.
 -0.    0.   -0.   -0.    0.   -0.  ]
block:  6
name:  burgers-2-upwind-sparse0-noise0.001-id2
device:  cuda:2
generate a random number to check random seed:  0.7567904047382403
current stage is: block-6
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.7656, device='cuda:2', dtype=torch.float64)
u_obs variance
tensor([ 0.2589,  1.7298,  1.7330, 21.4824, 10.8291, 20.7369,  0.2411,  1.5471,
         1.6353, 17.0193,  8.9021, 21.7225], device='cuda:2',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 0.741944
         Iterations: 0
         Function evaluations: 15
         Gradient evaluations: 3
convolution moment and kernels
[[ 1.00e+00  0.00e+00  1.64e-03 -3.68e-03 -5.62e-02]
 [ 0.00e+00  8.43e-05 -7.01e-04  2.13e-03  3.33e-02]
 [ 1.57e-04  4.73e-03  7.89e-03  2.31e-03 -6.44e-03]
 [ 7.15e-03 -2.76e-03 -2.24e-03  3.58e-04  2.41e-03]
 [-6.24e-02  3.88e-02 -8.15e-03 -6.17e-03  3.86e-03]]
[[ 1.31e-02 -6.71e-02 -1.09e-02 -1.32e-03  1.14e-04]
 [-7.32e-02  3.58e-01 -1.09e-01  1.03e-01 -2.13e-02]
 [ 3.02e-02 -2.15e-01  6.91e-01  1.72e-01 -5.30e-02]
 [-3.46e-02  2.03e-01  1.05e-01 -4.93e-02  1.86e-02]
 [ 9.91e-03 -5.55e-02 -1.72e-02  6.54e-03 -2.61e-03]]
[[ 0.00e+00  1.00e+00  0.00e+00 -9.15e-02 -6.81e-02]
 [ 0.00e+00  0.00e+00  4.71e-03  2.94e-03  1.93e-02]
 [ 0.00e+00  2.10e-02 -1.90e-03  2.55e-02 -1.93e-02]
 [ 1.33e-03 -3.50e-03 -3.87e-03 -1.55e-03 -4.31e-03]
 [-1.60e-02 -1.29e-02 -7.27e-04 -8.98e-03 -2.57e-03]]
[[ 6.63e-03 -1.04e-02 -4.27e-03 -7.36e-03 -1.31e-03]
 [-5.90e-02  1.38e-01 -1.14e-01  1.06e-01 -5.24e-03]
 [ 1.42e-01 -6.48e-01 -3.08e-01  9.30e-01 -2.12e-01]
 [-2.88e-02  2.12e-02  5.44e-02 -1.51e-02  3.09e-02]
 [ 2.15e-04  1.38e-02 -3.65e-02  1.62e-02 -9.18e-03]]
[[ 0.00e+00  0.00e+00  0.00e+00 -6.42e-04  1.88e-03]
 [ 1.00e+00  0.00e+00  2.50e-02 -2.92e-03 -1.13e-02]
 [ 0.00e+00  3.74e-03 -1.92e-02 -5.13e-03 -8.75e-03]
 [-9.91e-02 -4.51e-05  3.62e-02  2.09e-03 -4.51e-03]
 [-7.87e-02  8.93e-03 -2.48e-02  1.19e-04 -5.49e-03]]
[[ 9.15e-04 -4.50e-02  1.32e-01 -3.20e-02 -1.27e-03]
 [ 4.60e-03  8.82e-02 -6.04e-01  5.38e-02  6.46e-03]
 [-3.55e-03 -1.14e-01 -2.75e-01 -8.11e-02  1.97e-03]
 [ 5.92e-03  5.21e-02  9.89e-01  3.39e-02 -3.21e-04]
 [-5.68e-03  1.08e-02 -2.30e-01  1.86e-02 -5.28e-03]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00  3.75e-03]
 [ 0.00e+00  0.00e+00  0.00e+00  1.51e-04 -5.83e-03]
 [ 0.00e+00  0.00e+00  3.40e-03 -1.98e-03  5.33e-04]
 [ 0.00e+00  1.18e-04 -2.90e-03  6.10e-04  6.11e-03]
 [ 1.70e-01 -3.72e-03 -1.67e-04  5.05e-03 -2.93e-02]]
[[-0.04  0.14 -0.03  0.13 -0.03]
 [ 0.14 -0.54  0.08 -0.48  0.12]
 [-0.28  2.06 -2.5   1.96 -0.24]
 [ 0.12 -0.45 -0.05 -0.39  0.09]
 [-0.03  0.11  0.02  0.09 -0.02]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  1.09e-04]
 [ 0.00e+00  1.00e+00  0.00e+00 -2.02e-03 -4.42e-03]
 [ 0.00e+00  0.00e+00  3.50e-04 -4.00e-03  3.22e-04]
 [ 0.00e+00 -2.48e-03  1.14e-03  3.78e-03  7.35e-04]
 [ 2.53e-03 -5.02e-03  7.52e-05  8.21e-03 -1.49e-05]]
[[ 0.   -0.04 -0.    0.05 -0.  ]
 [-0.03  0.38  0.01 -0.41  0.04]
 [-0.03  0.08  0.01 -0.08  0.03]
 [ 0.08 -0.49 -0.03  0.51 -0.08]
 [-0.01  0.07  0.01 -0.07  0.01]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  9.08e-03]
 [ 0.00e+00  0.00e+00  0.00e+00  1.28e-03 -5.86e-03]
 [ 1.00e+00  0.00e+00  5.00e-03 -1.13e-03 -3.42e-03]
 [ 0.00e+00  3.39e-04 -2.84e-03  9.40e-05  6.18e-03]
 [ 1.29e-03 -3.59e-03  1.07e-03  3.67e-03 -7.09e-03]]
[[-1.28e-02  5.06e-02 -1.50e-01  3.80e-02 -8.33e-03]
 [ 4.36e-02 -1.63e-01  1.53e+00 -1.09e-01  2.42e-02]
 [-3.86e-02  1.31e-01 -2.63e+00  5.23e-02 -1.02e-02]
 [ 2.22e-02 -7.26e-02  1.40e+00 -2.31e-02  4.39e-03]
 [-5.30e-03  1.79e-02 -9.95e-02  5.90e-03 -1.03e-03]]
SymNet parameters
[[-2.51e-01  1.02e+00  1.63e-01  1.97e-01  3.54e-02 -1.11e-02 -1.32e-01  5.23e-02
  -7.20e-02 -8.35e-03  2.52e-02 -2.07e-03]
 [-1.78e+00  6.34e-02 -1.09e-02 -1.79e-02 -9.69e-04  3.03e-03 -1.55e-01 -3.44e-03
   2.35e-03  2.08e-03 -1.98e-03  2.11e-05]]
SymNet parameters
[-0.25 -0.37]
SymNet parameters
[[-5.95e+00 -4.47e-02 -1.31e-01 -7.64e-02 -2.18e-02  1.90e-03 -6.13e-02 -2.72e-02
   3.26e-01 -4.60e-03 -1.05e-02  9.07e-03 -9.49e-02]
 [-6.13e-01 -1.17e-01 -6.08e+00 -1.05e-01  2.27e-01  9.41e-03 -5.56e-02 -7.13e-02
   1.63e-02  2.56e-02 -3.37e-02  6.85e-03 -1.50e-01]]
SymNet parameters
[-3.4  -0.99]
SymNet parameters
[[ 4.99e-01 -2.41e-01  3.70e+00  4.67e-03  3.77e-02  1.22e-03  2.94e-02 -8.67e-04
   1.93e-03 -1.01e-02  1.38e-02  1.07e-02  8.92e-02  1.90e-04]
 [ 1.26e-01 -8.36e-03 -2.51e-03 -5.87e-03 -2.53e-03  2.33e-04 -2.09e+00 -1.57e-02
  -7.56e-03  1.22e-03 -1.96e-03  1.24e-03  9.58e-03  7.09e-04]]
SymNet parameters
[ 0.4  -1.84]
SymNet parameters
[[ 5.34e-01  1.24e+00  2.15e-01 -3.81e-01 -6.31e-02  1.77e-02 -2.17e-01 -9.48e-02
   1.46e-01  2.22e-02 -5.62e-02  2.48e-03 -3.31e-02  1.79e-02  8.73e-02]
 [-9.36e-01 -5.42e-02 -1.21e-02 -2.83e-02 -1.25e-02  3.61e-04 -2.13e-02 -8.79e-03
   1.41e-02  5.96e-03 -9.47e-03 -2.87e-03 -4.11e-02  1.11e-02 -3.58e-04]]
SymNet parameters
[0.24 0.52]
SymNet parameters
[[-1.49e+00 -5.14e-01 -9.66e-01  1.98e+00  1.25e+00  8.11e-02  6.79e-01  6.68e-01
  -1.13e+00 -7.66e-01  9.89e-01  4.32e-01  3.18e+00 -1.40e+00  5.75e-02  6.35e-02]
 [ 1.84e+00 -1.83e+00 -4.40e-01  7.22e-01  1.22e-01 -3.72e-02 -2.42e+00  3.08e-01
  -2.71e-01 -3.53e-02  1.07e-01 -5.59e-03  1.17e-01 -3.01e-02 -1.51e-01 -8.88e-04]]
SymNet parameters
[-0.02  1.14]
SymNet parameters
[[-0.09 -0.13  0.77  0.14  0.02  0.05  0.13  0.02 -0.04 -0.01  0.02  0.    0.35 -0.01
   0.09  0.33 -0.  ]]
SymNet parameters
[0.01]
SymNet parameters
[[ 3.66e-03  4.29e-02  4.16e-02 -3.47e-03  6.21e-04  1.37e-03  5.71e-01  1.03e-01
  -3.91e-02  2.03e-03 -8.38e-03 -1.62e-02]
 [-3.69e+00  2.94e-02  3.95e-03 -4.15e-03  2.31e-03  3.88e-03  2.08e-01 -2.90e-03
  -3.21e-02 -1.34e-02 -5.33e-02  3.54e-02]]
SymNet parameters
[0.22 0.51]
SymNet parameters
[[-2.21e+00 -2.56e-02 -5.46e-03  2.40e-03  7.74e-05 -2.85e-03  1.15e-01  9.18e-02
   3.32e-01  3.86e-03 -2.63e-02 -2.93e-02 -3.05e-02]
 [ 9.99e-03  1.84e-01  1.70e-01 -1.49e-02  2.51e-03  7.21e-03  2.46e+00 -5.41e-02
  -1.41e-01  6.01e-03 -3.50e-02 -5.46e-02  5.64e-03]]
SymNet parameters
[ 0.78 -0.09]
SymNet parameters
[[ 7.64e-03  1.60e-03 -1.35e-04 -3.02e-05  7.37e-05  1.20e-04  5.81e-02  1.23e-02
   2.36e-02 -3.22e-04  1.84e-03  2.07e-03 -3.49e-03  1.99e-05]
 [ 6.79e-01 -8.31e-01 -9.31e-01  3.13e-02  3.79e-03 -1.55e-02  1.29e+00  1.78e-01
   6.10e-01 -1.44e-01 -1.41e-01  6.43e-01  7.36e-01 -2.76e-01]]
SymNet parameters
[-0.39  0.8 ]
SymNet parameters
[[ 2.36  0.87  0.97 -0.13  0.05 -0.01  4.22  1.09 -3.75  0.03 -1.08 -0.55  0.85 -0.4
   2.39]
 [-3.77  0.71 -0.59 -0.16  0.1   0.16 -2.85  0.84 -3.03 -0.54 -0.58  2.41  1.14 -0.47
   1.83]]
SymNet parameters
[0.12 0.04]
SymNet parameters
[[ 9.52e-01 -3.41e+00 -2.12e+00  2.76e-01 -4.10e-02 -2.41e-01  8.64e-01  3.84e+00
  -1.95e+00  2.58e-01  2.75e-01 -8.89e-01 -4.44e-01 -4.28e-01 -7.55e-01  3.93e-03]
 [-6.10e-01 -1.92e-01 -1.53e-01  2.17e-04 -5.63e-05 -6.55e-03 -3.51e+00 -4.02e-03
   4.02e-01 -1.85e-02 -1.34e-01  2.16e-02 -1.97e-01  7.23e-02  2.79e-01  1.63e-04]]
SymNet parameters
[0.27 1.35]
SymNet parameters
[[ 1.73  0.46  0.55 -0.02 -0.    0.01  0.31 -0.19 -0.39  0.14  0.1  -0.35  1.96 -0.77
  -1.41 -0.   -0.01]]
SymNet parameters
[-0.76]
finally, finish this stage
iter:     0    time: 89.14
Func: 7.42e-01  |g|: 6.48e+02
stableloss: 6.61e-02   dataloss: 7.01e-01   sparseloss: 1.56e+02 momentloss: 6.89e+00
current expression:
[u00*u01, u10*v00, u20, u02, u00*u01**2, u00*u10*v01, u00*u11*v00, u10*v00*v10, u01*u10*v00, u00, 1, u00*v00**2, u00**2*v00, u00*u01*v00, v01, u01, u00*u01*u10, u00**2, u00*v01, u00*v00*v01]
[-0.98 -0.97  0.05  0.05  0.01  0.01  0.01  0.01  0.01  0.01 -0.   -0.    0.   -0.
 -0.    0.    0.    0.   -0.   -0.  ]
[v00*v10, u00*v01, v02, v20, v00, v00*v10**2, u00*v01*v10, u00*v00*v11, u00*u01*v01, v01, u00*u10*v01, v00**3, u00*v00, u00*u10, v10, u00**2, u00*u01, u00**2*v00, u01*v00*v01, v00**2*v01]
[-0.98 -0.98  0.05  0.05  0.01  0.01  0.01  0.01  0.01  0.01  0.01 -0.    0.   -0.
 -0.    0.   -0.   -0.    0.   -0.  ]
block:  9
name:  burgers-2-upwind-sparse0-noise0.001-id2
device:  cuda:2
generate a random number to check random seed:  1.261320953640535
current stage is: block-9
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.7865, device='cuda:2', dtype=torch.float64)
u_obs variance
tensor([ 0.2630,  1.7143,  1.7612, 21.4816, 10.3949, 20.7159,  0.2504,  1.7371,
         1.6956, 19.4920, 10.8034, 21.9170], device='cuda:2',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 2.076976
         Iterations: 0
         Function evaluations: 15
         Gradient evaluations: 3
convolution moment and kernels
[[ 1.00e+00  0.00e+00  1.64e-03 -3.68e-03 -5.62e-02]
 [ 0.00e+00  8.45e-05 -6.99e-04  2.13e-03  3.33e-02]
 [ 1.56e-04  4.73e-03  7.89e-03  2.31e-03 -6.43e-03]
 [ 7.15e-03 -2.76e-03 -2.24e-03  3.58e-04  2.42e-03]
 [-6.24e-02  3.88e-02 -8.15e-03 -6.17e-03  3.86e-03]]
[[ 1.31e-02 -6.70e-02 -1.09e-02 -1.30e-03  1.11e-04]
 [-7.32e-02  3.58e-01 -1.09e-01  1.03e-01 -2.13e-02]
 [ 3.02e-02 -2.15e-01  6.91e-01  1.72e-01 -5.31e-02]
 [-3.45e-02  2.03e-01  1.05e-01 -4.93e-02  1.86e-02]
 [ 9.91e-03 -5.55e-02 -1.72e-02  6.54e-03 -2.61e-03]]
[[ 0.00e+00  1.00e+00  0.00e+00 -9.15e-02 -6.81e-02]
 [ 0.00e+00  0.00e+00  4.71e-03  2.94e-03  1.93e-02]
 [ 0.00e+00  2.10e-02 -1.91e-03  2.55e-02 -1.93e-02]
 [ 1.33e-03 -3.50e-03 -3.88e-03 -1.55e-03 -4.30e-03]
 [-1.60e-02 -1.29e-02 -7.24e-04 -8.98e-03 -2.58e-03]]
[[ 6.61e-03 -1.03e-02 -4.35e-03 -7.31e-03 -1.32e-03]
 [-5.90e-02  1.38e-01 -1.14e-01  1.06e-01 -5.21e-03]
 [ 1.42e-01 -6.48e-01 -3.08e-01  9.31e-01 -2.12e-01]
 [-2.87e-02  2.12e-02  5.45e-02 -1.51e-02  3.09e-02]
 [ 2.12e-04  1.38e-02 -3.65e-02  1.63e-02 -9.18e-03]]
[[ 0.00e+00  0.00e+00  0.00e+00 -6.42e-04  1.87e-03]
 [ 1.00e+00  0.00e+00  2.51e-02 -2.92e-03 -1.13e-02]
 [ 0.00e+00  3.74e-03 -1.92e-02 -5.13e-03 -8.75e-03]
 [-9.91e-02 -4.58e-05  3.62e-02  2.09e-03 -4.51e-03]
 [-7.87e-02  8.92e-03 -2.48e-02  1.20e-04 -5.50e-03]]
[[ 8.96e-04 -4.49e-02  1.31e-01 -3.19e-02 -1.28e-03]
 [ 4.68e-03  8.79e-02 -6.04e-01  5.35e-02  6.52e-03]
 [-3.66e-03 -1.14e-01 -2.76e-01 -8.07e-02  1.89e-03]
 [ 5.97e-03  5.19e-02  9.89e-01  3.37e-02 -2.81e-04]
 [-5.69e-03  1.09e-02 -2.30e-01  1.86e-02 -5.29e-03]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00  3.75e-03]
 [ 0.00e+00  0.00e+00  0.00e+00  1.51e-04 -5.83e-03]
 [ 0.00e+00  0.00e+00  3.40e-03 -1.98e-03  5.33e-04]
 [ 0.00e+00  1.18e-04 -2.90e-03  6.10e-04  6.11e-03]
 [ 1.70e-01 -3.72e-03 -1.66e-04  5.05e-03 -2.93e-02]]
[[-0.04  0.14 -0.03  0.13 -0.03]
 [ 0.14 -0.54  0.08 -0.48  0.12]
 [-0.28  2.06 -2.5   1.96 -0.24]
 [ 0.12 -0.45 -0.05 -0.39  0.09]
 [-0.03  0.11  0.02  0.09 -0.02]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  1.09e-04]
 [ 0.00e+00  1.00e+00  0.00e+00 -2.02e-03 -4.42e-03]
 [ 0.00e+00  0.00e+00  3.50e-04 -4.00e-03  3.22e-04]
 [ 0.00e+00 -2.48e-03  1.14e-03  3.78e-03  7.35e-04]
 [ 2.53e-03 -5.02e-03  7.55e-05  8.21e-03 -1.55e-05]]
[[ 0.   -0.04 -0.    0.05 -0.  ]
 [-0.03  0.38  0.01 -0.41  0.04]
 [-0.03  0.08  0.01 -0.08  0.03]
 [ 0.08 -0.49 -0.03  0.51 -0.08]
 [-0.01  0.07  0.01 -0.07  0.01]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  9.08e-03]
 [ 0.00e+00  0.00e+00  0.00e+00  1.28e-03 -5.86e-03]
 [ 1.00e+00  0.00e+00  5.00e-03 -1.13e-03 -3.42e-03]
 [ 0.00e+00  3.39e-04 -2.84e-03  9.40e-05  6.18e-03]
 [ 1.29e-03 -3.59e-03  1.07e-03  3.67e-03 -7.09e-03]]
[[-1.28e-02  5.06e-02 -1.50e-01  3.80e-02 -8.33e-03]
 [ 4.36e-02 -1.63e-01  1.53e+00 -1.09e-01  2.42e-02]
 [-3.86e-02  1.31e-01 -2.63e+00  5.24e-02 -1.02e-02]
 [ 2.22e-02 -7.26e-02  1.40e+00 -2.31e-02  4.40e-03]
 [-5.30e-03  1.79e-02 -9.95e-02  5.90e-03 -1.03e-03]]
SymNet parameters
[[-2.51e-01  1.02e+00  1.63e-01  1.97e-01  3.54e-02 -1.11e-02 -1.32e-01  5.23e-02
  -7.20e-02 -8.34e-03  2.52e-02 -2.07e-03]
 [-1.78e+00  6.34e-02 -1.09e-02 -1.79e-02 -9.68e-04  3.03e-03 -1.55e-01 -3.43e-03
   2.36e-03  2.08e-03 -1.98e-03  2.19e-05]]
SymNet parameters
[-0.25 -0.37]
SymNet parameters
[[-5.95e+00 -4.47e-02 -1.31e-01 -7.64e-02 -2.18e-02  1.90e-03 -6.13e-02 -2.72e-02
   3.26e-01 -4.60e-03 -1.05e-02  9.07e-03 -9.49e-02]
 [-6.13e-01 -1.17e-01 -6.08e+00 -1.05e-01  2.27e-01  9.41e-03 -5.56e-02 -7.13e-02
   1.63e-02  2.56e-02 -3.37e-02  6.85e-03 -1.50e-01]]
SymNet parameters
[-3.4  -0.99]
SymNet parameters
[[ 4.99e-01 -2.41e-01  3.70e+00  4.67e-03  3.77e-02  1.22e-03  2.94e-02 -8.67e-04
   1.93e-03 -1.01e-02  1.38e-02  1.07e-02  8.92e-02  1.82e-04]
 [ 1.26e-01 -8.36e-03 -2.51e-03 -5.87e-03 -2.53e-03  2.31e-04 -2.09e+00 -1.57e-02
  -7.56e-03  1.22e-03 -1.96e-03  1.24e-03  9.59e-03  5.42e-04]]
SymNet parameters
[ 0.4  -1.84]
SymNet parameters
[[ 5.34e-01  1.24e+00  2.15e-01 -3.81e-01 -6.31e-02  1.77e-02 -2.17e-01 -9.48e-02
   1.46e-01  2.22e-02 -5.62e-02  2.48e-03 -3.31e-02  1.81e-02  8.73e-02]
 [-9.36e-01 -5.42e-02 -1.21e-02 -2.83e-02 -1.25e-02  3.68e-04 -2.13e-02 -8.79e-03
   1.41e-02  5.95e-03 -9.47e-03 -2.87e-03 -4.11e-02  1.10e-02 -4.00e-04]]
SymNet parameters
[0.24 0.52]
SymNet parameters
[[-1.49e+00 -5.14e-01 -9.66e-01  1.98e+00  1.25e+00  8.11e-02  6.79e-01  6.68e-01
  -1.13e+00 -7.66e-01  9.89e-01  4.32e-01  3.18e+00 -1.40e+00  5.75e-02  6.35e-02]
 [ 1.84e+00 -1.83e+00 -4.40e-01  7.22e-01  1.22e-01 -3.72e-02 -2.42e+00  3.08e-01
  -2.71e-01 -3.53e-02  1.07e-01 -5.59e-03  1.17e-01 -3.01e-02 -1.51e-01 -8.87e-04]]
SymNet parameters
[-0.02  1.14]
SymNet parameters
[[-0.09 -0.13  0.77  0.14  0.02  0.05  0.13  0.02 -0.04 -0.01  0.02  0.    0.35 -0.01
   0.09  0.33 -0.  ]]
SymNet parameters
[0.01]
SymNet parameters
[[ 3.71e-03  4.29e-02  4.16e-02 -3.59e-03  6.14e-04  1.37e-03  5.71e-01  1.03e-01
  -3.91e-02  2.26e-03 -8.40e-03 -1.62e-02]
 [-3.69e+00  2.94e-02  3.95e-03 -4.12e-03  2.32e-03  3.90e-03  2.08e-01 -2.91e-03
  -3.21e-02 -1.34e-02 -5.33e-02  3.54e-02]]
SymNet parameters
[0.22 0.51]
SymNet parameters
[[-2.21e+00 -2.56e-02 -5.46e-03  2.34e-03  7.87e-05 -2.88e-03  1.15e-01  9.18e-02
   3.32e-01  3.87e-03 -2.63e-02 -2.93e-02 -3.05e-02]
 [ 9.98e-03  1.84e-01  1.70e-01 -1.49e-02  2.51e-03  7.21e-03  2.46e+00 -5.41e-02
  -1.41e-01  5.96e-03 -3.50e-02 -5.46e-02  5.64e-03]]
SymNet parameters
[ 0.78 -0.09]
SymNet parameters
[[ 7.63e-03  1.61e-03 -1.16e-04 -2.18e-05  6.06e-05  2.03e-04  5.80e-02  1.23e-02
   2.36e-02 -3.46e-04  1.85e-03  2.16e-03 -3.50e-03 -3.86e-05]
 [ 6.79e-01 -8.31e-01 -9.31e-01  3.13e-02  3.79e-03 -1.55e-02  1.29e+00  1.78e-01
   6.10e-01 -1.44e-01 -1.41e-01  6.43e-01  7.36e-01 -2.76e-01]]
SymNet parameters
[-0.39  0.8 ]
SymNet parameters
[[ 2.36  0.87  0.97 -0.13  0.05 -0.01  4.22  1.09 -3.75  0.03 -1.08 -0.55  0.85 -0.4
   2.39]
 [-3.77  0.71 -0.59 -0.16  0.1   0.16 -2.85  0.84 -3.03 -0.54 -0.58  2.41  1.14 -0.47
   1.83]]
SymNet parameters
[0.12 0.04]
SymNet parameters
[[ 9.52e-01 -3.41e+00 -2.12e+00  2.76e-01 -4.10e-02 -2.41e-01  8.64e-01  3.84e+00
  -1.95e+00  2.58e-01  2.75e-01 -8.89e-01 -4.44e-01 -4.28e-01 -7.55e-01  3.87e-03]
 [-6.10e-01 -1.92e-01 -1.53e-01  2.19e-04 -5.67e-05 -6.55e-03 -3.51e+00 -4.02e-03
   4.02e-01 -1.85e-02 -1.34e-01  2.16e-02 -1.97e-01  7.23e-02  2.79e-01  2.19e-04]]
SymNet parameters
[0.27 1.35]
SymNet parameters
[[ 1.73e+00  4.63e-01  5.46e-01 -1.67e-02 -3.29e-03  6.08e-03  3.13e-01 -1.86e-01
  -3.94e-01  1.43e-01  9.96e-02 -3.53e-01  1.96e+00 -7.66e-01 -1.41e+00 -1.83e-03
  -1.33e-02]]
SymNet parameters
[-0.76]
finally, finish this stage
iter:     0    time: 95.68
Func: 2.08e+00  |g|: 3.51e+02
stableloss: 7.10e-02   dataloss: 2.01e+00   sparseloss: 1.56e+02 momentloss: 6.89e+00
current expression:
[u00*u01, u10*v00, u20, u02, u00*u01**2, u00*u10*v01, u00*u11*v00, u10*v00*v10, u01*u10*v00, u00, 1, u00*v00**2, u00**2*v00, u00*u01*v00, v01, u01, u00*u01*u10, u00**2, u00*v01, u00*v00*v01]
[-0.98 -0.97  0.05  0.05  0.01  0.01  0.01  0.01  0.01  0.01 -0.   -0.    0.   -0.
 -0.    0.    0.    0.   -0.   -0.  ]
[v00*v10, u00*v01, v02, v20, v00, v00*v10**2, u00*v01*v10, u00*v00*v11, u00*u01*v01, v01, u00*u10*v01, v00**3, u00*v00, u00*u10, v10, u00**2, u00*u01, u00**2*v00, u01*v00*v01, v00**2*v01]
[-0.98 -0.98  0.05  0.05  0.01  0.01  0.01  0.01  0.01  0.01  0.01 -0.    0.   -0.
 -0.    0.   -0.   -0.    0.   -0.  ]
u_obs.abs().max()
tensor(3.8730, device='cuda:2', dtype=torch.float64)
model(u_obs[0],T=50*dt).abs().max()
tensor(nan, device='cuda:2', dtype=torch.float64)
model(u_obs[0],T=100*dt).abs().max()
tensor(nan, device='cuda:2', dtype=torch.float64)
--name=burgers-2-upwind-sparse0-noise0.001-id4 --kernel_size=5 --viscosity=0.05 --blocks=0-6,9 --dataname=burgers --constraint=2 --device=cuda:0 --stablize=0 --sparsity=0 --momentsparsity=0.001 --data_start_time=1 --dt=1e-2 --max_dt=1/1600 --hidden_layers=5 --start_noise=0.001 --end_noise=0.001 --scheme=upwind
0
--name=burgers-2-upwind-sparse0-noise0.001-id5 --kernel_size=5 --viscosity=0.05 --blocks=0-6,9 --dataname=burgers --constraint=2 --device=cuda:1 --stablize=0 --sparsity=0 --momentsparsity=0.001 --data_start_time=1 --dt=1e-2 --max_dt=1/1600 --hidden_layers=5 --start_noise=0.001 --end_noise=0.001 --scheme=upwind
1
--name=burgers-2-upwind-sparse0-noise0.001-id6 --kernel_size=5 --viscosity=0.05 --blocks=0-6,9 --dataname=burgers --constraint=2 --device=cuda:2 --stablize=0 --sparsity=0 --momentsparsity=0.001 --data_start_time=1 --dt=1e-2 --max_dt=1/1600 --hidden_layers=5 --start_noise=0.001 --end_noise=0.001 --scheme=upwind
2
--name=burgers-2-upwind-sparse0-noise0.001-id7 --kernel_size=5 --viscosity=0.05 --blocks=0-6,9 --dataname=burgers --constraint=2 --device=cuda:3 --stablize=0 --sparsity=0 --momentsparsity=0.001 --data_start_time=1 --dt=1e-2 --max_dt=1/1600 --hidden_layers=5 --start_noise=0.001 --end_noise=0.001 --scheme=upwind
3
wait
{'--name': 'burgers-2-upwind-sparse0-noise0.001-id7', '--dtype': 'double', '--device': 'cuda:3', '--constraint': '2', '--dt': 0.01, '--cell_num': 1, '--eps': 6.283185307179586, '--blocks': [0, 1, 2, 3, 4, 5, 6, 9], '--kernel_size': 5, '--max_order': 2, '--dx': 0.19634954084936207, '--hidden_layers': 5, '--scheme': 'upwind', '--dataname': 'burgers', '--viscosity': 0.05, '--zoom': 4, '--max_dt': 0.000625, '--batch_size': 28, '--data_timescheme': 'rk2', '--channel_names': 'u,v', '--freq': 4, '--data_start_time': 1.0, '--start_noise': 0.001, '--end_noise': 0.001, '--stablize': 0.0, '--sparsity': 0.0, '--momentsparsity': 0.001, '--npseed': -1, '--torchseed': -1, '--maxiter': 2000, '--recordfile': 'None', '--recordcycle': 200, '--savecycle': -1, '--start_from': -1}
Traceback (most recent call last):
  File "train.py", line 58, in <module>
    globalnames, callback, model, data_model, sampling, addnoise = setenv.setenv(options)
  File "/data/users2/sajad/code/PDE-Net/setenv.py", line 68, in setenv
    globalnames, callback, model = _set_model(options)
  File "/data/users2/sajad/code/PDE-Net/setenv.py", line 45, in _set_model
    model.to(globalnames['device'])
  File "/home/users/mabavisani/anaconda3/envs/PDE-Net-2/lib/python3.7/site-packages/torch/nn/modules/module.py", line 386, in to
    return self._apply(convert)
  File "/home/users/mabavisani/anaconda3/envs/PDE-Net-2/lib/python3.7/site-packages/torch/nn/modules/module.py", line 193, in _apply
    module._apply(fn)
  File "/home/users/mabavisani/anaconda3/envs/PDE-Net-2/lib/python3.7/site-packages/torch/nn/modules/module.py", line 193, in _apply
    module._apply(fn)
  File "/home/users/mabavisani/anaconda3/envs/PDE-Net-2/lib/python3.7/site-packages/torch/nn/modules/module.py", line 205, in _apply
    self._buffers[key] = fn(buf)
  File "/home/users/mabavisani/anaconda3/envs/PDE-Net-2/lib/python3.7/site-packages/torch/nn/modules/module.py", line 384, in convert
    return t.to(device, dtype if t.is_floating_point() else None, non_blocking)
RuntimeError: CUDA error: invalid device ordinal
{'--name': 'burgers-2-upwind-sparse0-noise0.001-id6', '--dtype': 'double', '--device': 'cuda:2', '--constraint': '2', '--dt': 0.01, '--cell_num': 1, '--eps': 6.283185307179586, '--blocks': [0, 1, 2, 3, 4, 5, 6, 9], '--kernel_size': 5, '--max_order': 2, '--dx': 0.19634954084936207, '--hidden_layers': 5, '--scheme': 'upwind', '--dataname': 'burgers', '--viscosity': 0.05, '--zoom': 4, '--max_dt': 0.000625, '--batch_size': 28, '--data_timescheme': 'rk2', '--channel_names': 'u,v', '--freq': 4, '--data_start_time': 1.0, '--start_noise': 0.001, '--end_noise': 0.001, '--stablize': 0.0, '--sparsity': 0.0, '--momentsparsity': 0.001, '--npseed': -1, '--torchseed': -1, '--maxiter': 2000, '--recordfile': 'None', '--recordcycle': 200, '--savecycle': -1, '--start_from': -1}
block:  0
name:  burgers-2-upwind-sparse0-noise0.001-id6
device:  cuda:2
generate a random number to check random seed:  -2.5294585092489834
current stage is: warmup
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.8299, device='cuda:2', dtype=torch.float64)
u_obs variance
tensor([ 0.2516,  2.0415,  1.9036, 18.8841,  9.7196, 16.5449,  0.2598,  2.0692,
         2.0604, 18.3624,  9.5390, 19.0763], device='cuda:2',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
iter:     0    time: 6.87
Func: 5.58e+00  |g|: 2.53e+00
stableloss: 9.15e-04   dataloss: 5.58e+00   sparseloss: 2.74e+01 momentloss: 7.27e+00
iter:   200    time: 11.07
Func: 3.36e-02  |g|: 1.50e-02
stableloss: 1.25e-02   dataloss: 3.36e-02   sparseloss: 5.24e+01 momentloss: 7.27e+00
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 0.033099
         Iterations: 269
         Function evaluations: 313
         Gradient evaluations: 306
convolution moment and kernels
[[1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
[[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 1. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
[[ 0.    1.    0.   -0.33 -0.25]
 [ 0.    0.    0.    0.    0.  ]
 [ 0.    0.    0.    0.    0.  ]
 [ 0.    0.    0.    0.    0.  ]
 [ 0.    0.    0.    0.    0.  ]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]
 [ 2.78e-17  3.33e-16 -1.50e+00  2.00e+00 -5.00e-01]
 [ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]]
[[ 0.    0.    0.    0.    0.  ]
 [ 1.    0.    0.    0.    0.  ]
 [ 0.    0.    0.    0.    0.  ]
 [-0.33  0.    0.    0.    0.  ]
 [-0.25  0.    0.    0.    0.  ]]
[[ 0.00e+00  0.00e+00  2.78e-17  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  3.33e-16  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00 -1.50e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  2.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00 -5.00e-01  0.00e+00  0.00e+00]]
[[0.   0.   1.   0.   0.08]
 [0.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.  ]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]
 [-2.22e-16  1.00e+00 -2.00e+00  1.00e+00 -1.53e-16]
 [ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]]
[[0. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
[[ 6.94e-03 -5.56e-02  9.25e-18  5.56e-02 -6.94e-03]
 [-5.56e-02  4.44e-01 -7.40e-17 -4.44e-01  5.56e-02]
 [ 9.25e-18 -7.40e-17  1.23e-32  7.40e-17 -9.25e-18]
 [ 5.56e-02 -4.44e-01  7.40e-17  4.44e-01 -5.56e-02]
 [-6.94e-03  5.56e-02 -9.25e-18 -5.56e-02  6.94e-03]]
[[0.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.  ]
 [1.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.  ]
 [0.08 0.   0.   0.   0.  ]]
[[ 0.00e+00  0.00e+00 -2.22e-16  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  1.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00 -2.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  1.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00 -1.53e-16  0.00e+00  0.00e+00]]
SymNet parameters
[[-0.01  0.67  1.38  0.07 -0.45 -0.03 -0.08  0.02 -0.08 -0.02  0.08 -0.04]
 [ 0.71 -0.08 -0.09  0.01 -0.01  0.01  0.22 -0.03 -0.02  0.    0.   -0.  ]]
SymNet parameters
[-0.19  0.36]
SymNet parameters
[[ 0.31 -0.34 -0.45  0.08 -0.11  0.01 -0.12  0.02 -0.02 -0.02  0.02 -0.02 -0.06]
 [ 1.6   0.33  0.08  0.09 -0.01  0.02  1.06  0.01 -0.01 -0.01  0.01 -0.01 -0.05]]
SymNet parameters
[0.25 0.01]
SymNet parameters
[[ 8.39e-01 -3.34e-01 -1.52e-02  3.75e-01  3.58e-01  7.39e-02  2.60e-01  9.37e-02
  -2.19e-02  6.47e-03  4.34e-02  2.84e-02 -2.80e-02 -1.72e-01]
 [ 1.99e-01  2.83e-02 -4.83e-02  1.52e-02 -9.45e-03  7.11e-03 -7.57e-02 -1.02e-02
  -9.64e-03 -2.63e-03  5.84e-04 -4.23e-03 -1.46e-02  5.29e-03]]
SymNet parameters
[0.13 0.38]
SymNet parameters
[[-6.75e-01 -2.77e-02  1.89e-03 -1.39e-02  1.64e-02 -6.00e-03  4.83e-01  4.96e-03
   4.62e-03  4.60e-03  1.37e-04  4.90e-03  1.62e-02 -1.00e-02  1.11e-02]
 [-1.15e-01 -6.67e-01  9.80e-01  6.86e-02  4.45e-02  9.25e-03 -1.42e-01  1.24e-02
  -1.22e-02  1.85e-03  1.43e-02  6.31e-03 -3.29e-03 -3.99e-02 -1.32e-01]]
SymNet parameters
[0.42 0.28]
SymNet parameters
[[ 8.16e-01 -4.34e-01  2.25e-01 -1.72e-02 -2.00e-01 -2.44e-02  6.61e-01  8.56e-02
   3.79e-02 -2.35e-02  1.53e-02 -2.16e-02 -3.72e-02  2.85e-02  5.82e-02 -4.15e-02]
 [ 2.06e-01  1.20e+00  8.44e-01  3.20e-01 -7.12e-02  8.26e-02  4.67e-01  7.36e-02
   6.53e-03 -7.31e-02  4.11e-04 -6.44e-02 -2.37e-01  7.70e-02  4.95e-02  7.18e-02]]
SymNet parameters
[0.03 0.15]
SymNet parameters
[[-1.76e-01 -3.51e-01  5.76e-01  1.63e-01  6.32e-02  5.27e-02 -8.80e-03  3.96e-02
  -1.85e-02  8.14e-04  2.42e-02  6.13e-03 -3.07e-01  4.12e-01 -7.22e-01 -1.05e+00
  -1.03e-01]]
SymNet parameters
[0.13]
SymNet parameters
[[ 2.55e-01 -2.03e-01 -9.63e-02 -2.95e-02 -6.45e-02 -4.27e-02 -2.09e-02 -1.02e-02
  -5.94e-02 -2.05e-01 -3.21e-01 -3.41e-01]
 [-8.84e-02 -9.85e-03  2.49e-02 -8.54e-03  3.19e-05 -6.33e-03  2.06e-01 -1.02e-02
   3.01e-02  3.98e-03  4.16e-03  8.86e-03]]
SymNet parameters
[-0.13 -0.21]
SymNet parameters
[[ 0.4   0.01 -0.01 -0.01 -0.01 -0.02  0.53  0.02 -0.14 -0.02 -0.05 -0.02  0.4 ]
 [ 0.01 -0.04 -0.17 -0.01  0.    0.01  0.56 -0.15 -0.36  0.02 -0.11  0.04  0.37]]
SymNet parameters
[-0.01 -0.16]
SymNet parameters
[[ 0.05  0.05  0.1   0.   -0.    0.01 -0.33 -0.05  0.16  0.03  0.02 -0.01 -0.16  0.01]
 [ 0.39  0.01 -0.01  0.   -0.   -0.   -0.09 -0.13 -0.07  0.    0.   -0.02  0.08 -0.04]]
SymNet parameters
[0.25 0.35]
SymNet parameters
[[ 5.43e-01  1.86e-02  3.66e-02  2.03e-03 -1.65e-03  1.62e-03  4.71e-01 -9.56e-01
   9.22e-01  1.51e-02  1.09e-02 -3.12e-03 -1.58e-01 -1.23e-03  8.51e-02]
 [-7.23e-01 -7.03e-03 -1.55e-02 -1.42e-03  4.11e-04 -1.23e-03  6.52e-01  1.91e-01
   1.96e-01 -3.12e-03 -3.59e-03 -6.27e-04  2.80e-02  4.46e-02  8.98e-02]]
SymNet parameters
[0.28 0.33]
SymNet parameters
[[ 8.78e-01  1.42e-04  1.23e-02 -2.02e-03 -3.94e-05  3.06e-03  9.38e-01  2.86e-01
  -2.52e-01  2.45e-04  3.06e-03  2.32e-03 -1.91e-02  3.51e-02 -2.94e-02 -6.70e-03]
 [ 5.52e-01 -1.78e-02 -5.06e-02 -2.62e-04 -1.05e-03 -4.40e-03 -3.67e-01  8.46e-01
   8.88e-01 -9.74e-03 -1.89e-02 -9.47e-04  1.20e-01  7.34e-02  3.92e-01  1.67e-02]]
SymNet parameters
[0.23 0.21]
SymNet parameters
[[ 2.23e-01  1.22e-02  1.90e-02 -2.17e-03 -1.58e-03  2.89e-03  2.48e-01 -8.40e-02
   3.29e-01  4.90e-02  4.10e-04  3.07e-02  1.64e-02  1.16e-01 -5.95e-01 -6.27e-01
  -4.51e-01]]
SymNet parameters
[0.13]
finally, finish this stage
iter:   269    time: 5.00
Func: 3.31e-02  |g|: 9.92e-03
stableloss: 1.26e-02   dataloss: 3.31e-02   sparseloss: 5.19e+01 momentloss: 7.27e+00
current expression:
[u00*u01, u10*v00, u00, u02, u20, u00**3, u00**2*u02, u00*u11*v00, u00**2*v00, u00*u01**2, u00*v00, v00, u00**2, u00*u02*v00, u01*u10*v00, u01, v01, u00*u10*v01, u00*u01*v00, u00*u11]
[-0.89 -0.89  0.05  0.04  0.04 -0.02 -0.01  0.01  0.01  0.01  0.01 -0.01 -0.01  0.01
  0.01 -0.01  0.01  0.01 -0.    0.  ]
[v00*v10, u00*v01, v00, v02, v20, v00**3, u00*v00, v10, u00*v00*v11, v00*v10**2, v00**2*v20, 1, u00*v01*v10, u10, u10*v00**2, u00*v00*v20, u00**2, u00*v00*v10, u00*v00**2, v00**2*v10]
[-0.89 -0.89  0.05  0.04  0.04 -0.02  0.01  0.01  0.01  0.01 -0.01 -0.01  0.01 -0.
  0.    0.    0.    0.    0.   -0.  ]
block:  1
name:  burgers-2-upwind-sparse0-noise0.001-id6
device:  cuda:2
generate a random number to check random seed:  -3.550163556370814
current stage is: block-1
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.9061, device='cuda:2', dtype=torch.float64)
u_obs variance
tensor([ 0.2397,  2.0489,  1.7674, 19.0201,  9.2807, 15.4022,  0.2630,  2.0370,
         2.0823, 17.8055, 10.1611, 18.8749], device='cuda:2',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
iter:     0    time: 2293.99
Func: 4.01e-02  |g|: 6.19e-01
stableloss: 1.25e-02   dataloss: 3.29e-02   sparseloss: 5.19e+01 momentloss: 7.27e+00
iter:   200    time: 10.45
Func: 1.79e-02  |g|: 1.42e-02
stableloss: 9.80e-03   dataloss: 1.13e-02   sparseloss: 5.43e+01 momentloss: 6.56e+00
iter:   400    time: 10.28
Func: 1.71e-02  |g|: 4.85e-03
stableloss: 9.11e-03   dataloss: 1.06e-02   sparseloss: 5.72e+01 momentloss: 6.56e+00
iter:   600    time: 10.33
Func: 1.70e-02  |g|: 4.30e-03
stableloss: 9.16e-03   dataloss: 1.05e-02   sparseloss: 5.87e+01 momentloss: 6.54e+00
iter:   800    time: 10.35
Func: 1.69e-02  |g|: 1.81e-03
stableloss: 9.22e-03   dataloss: 1.04e-02   sparseloss: 6.23e+01 momentloss: 6.55e+00
iter:  1000    time: 10.29
Func: 1.69e-02  |g|: 7.16e-03
stableloss: 9.19e-03   dataloss: 1.04e-02   sparseloss: 6.59e+01 momentloss: 6.52e+00
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 0.016834
         Iterations: 1167
         Function evaluations: 1231
         Gradient evaluations: 1225
convolution moment and kernels
[[ 1.00e+00  0.00e+00  2.16e-04 -1.56e-02 -1.54e-02]
 [ 0.00e+00  1.92e-04  6.67e-04 -9.16e-04 -2.42e-04]
 [ 5.18e-05  2.25e-03  3.46e-03  2.18e-03  5.34e-04]
 [ 9.00e-02 -2.22e-03 -3.64e-03  1.79e-03  1.13e-04]
 [-4.17e-02 -7.01e-03 -2.19e-03  4.19e-03  1.84e-03]]
[[-2.56e-04 -5.97e-04 -7.48e-02 -1.48e-02  3.80e-03]
 [ 9.70e-04  7.31e-03  1.95e-01  6.85e-02 -1.53e-02]
 [-9.98e-03  3.01e-02  7.69e-01 -4.18e-02  2.11e-03]
 [ 2.53e-03  1.25e-02 -8.57e-03  8.95e-02 -1.93e-02]
 [-9.48e-04 -2.76e-03  2.55e-02 -2.38e-02  5.42e-03]]
[[ 0.00e+00  1.00e+00  0.00e+00 -7.65e-02 -7.93e-02]
 [ 0.00e+00  0.00e+00  2.58e-03  2.14e-03  2.00e-02]
 [ 0.00e+00  6.80e-03 -1.52e-03  5.30e-03 -7.23e-03]
 [ 7.31e-03  7.38e-04 -6.05e-03 -4.03e-03 -6.38e-03]
 [ 8.87e-03 -1.94e-02 -3.11e-03 -3.36e-03  2.71e-05]]
[[ 0.   -0.01  0.04 -0.03  0.01]
 [-0.03  0.08 -0.21  0.16 -0.03]
 [ 0.07 -0.46 -0.28  0.91 -0.19]
 [ 0.   -0.05 -0.03  0.02  0.01]
 [-0.    0.02  0.    0.   -0.01]]
[[ 0.00e+00  0.00e+00  0.00e+00 -2.06e-02  1.82e-02]
 [ 1.00e+00  0.00e+00  1.53e-02 -2.35e-03 -7.86e-03]
 [ 0.00e+00  8.65e-04  3.81e-03  4.05e-03 -5.13e-04]
 [-9.09e-02  3.84e-03  7.37e-03  6.66e-05 -1.02e-02]
 [-5.31e-02 -2.28e-03 -4.96e-03 -1.25e-03 -2.62e-03]]
[[ 0.   -0.02  0.11 -0.02  0.  ]
 [-0.    0.01 -0.57  0.01  0.01]
 [ 0.02 -0.09 -0.2  -0.04 -0.01]
 [ 0.01 -0.02  0.99 -0.03  0.02]
 [-0.01  0.02 -0.22  0.03 -0.01]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00 -4.72e-03]
 [ 0.00e+00  0.00e+00  0.00e+00  3.46e-04 -5.02e-03]
 [ 0.00e+00  0.00e+00  2.49e-03  7.08e-04  1.11e-03]
 [ 0.00e+00 -3.90e-04 -4.42e-03  6.11e-05  4.49e-03]
 [ 1.81e-03 -6.45e-04 -7.55e-04  6.79e-04 -3.64e-03]]
[[-6.85e-03  2.82e-02 -3.97e-02  2.63e-02 -6.16e-03]
 [ 2.49e-02 -9.64e-02  1.31e-01 -8.96e-02  2.26e-02]
 [-1.13e-01  1.44e+00 -2.64e+00  1.43e+00 -1.10e-01]
 [ 8.36e-03 -2.21e-02  1.51e-02 -1.49e-02  6.27e-03]
 [-1.19e-03  1.24e-03  3.30e-03 -1.12e-03 -4.28e-04]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00 -1.88e-03]
 [ 0.00e+00  1.00e+00  0.00e+00 -1.05e-03 -1.16e-03]
 [ 0.00e+00  0.00e+00 -2.72e-04 -4.97e-04  1.46e-03]
 [ 0.00e+00 -1.22e-03  6.28e-04  1.50e-03  5.05e-04]
 [-7.58e-04  2.40e-03  5.98e-04 -1.39e-03 -1.59e-03]]
[[ 0.01 -0.05 -0.01  0.07 -0.01]
 [-0.05  0.42  0.07 -0.5   0.07]
 [-0.01  0.05 -0.11  0.08 -0.02]
 [ 0.06 -0.47  0.05  0.4  -0.05]
 [-0.01  0.06 -0.01 -0.05  0.01]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00 -7.40e-04]
 [ 0.00e+00  0.00e+00  0.00e+00  3.46e-04 -5.31e-03]
 [ 1.00e+00  0.00e+00  2.09e-03  3.85e-04  3.91e-04]
 [ 0.00e+00 -1.27e-03 -4.94e-03  6.72e-04  4.98e-03]
 [-3.78e-04  7.66e-04 -5.87e-04  4.44e-04 -1.87e-03]]
[[-4.92e-03  2.08e-02 -1.17e-01  2.25e-02 -5.05e-03]
 [ 1.66e-02 -6.38e-02  1.43e+00 -6.80e-02  1.65e-02]
 [-1.27e-02  3.88e-02 -2.56e+00  4.15e-02 -1.18e-02]
 [-6.50e-04  1.50e-02  1.31e+00  1.60e-02 -2.05e-03]
 [ 9.50e-04 -7.79e-03 -6.95e-02 -9.06e-03  1.65e-03]]
SymNet parameters
[[ 5.41e-01  1.31e+00  8.99e-01 -3.25e-01 -5.35e-01 -3.74e-02 -7.37e-01  4.99e-02
  -2.48e-01 -8.42e-03  3.09e-03 -3.57e-02]
 [ 3.72e-01  1.68e-02  5.42e-02  2.62e-04 -1.00e-04 -3.32e-03 -6.08e-02 -7.83e-03
  -1.07e-03  2.68e-04 -1.15e-03  2.08e-03]]
SymNet parameters
[-0.36  0.71]
SymNet parameters
[[ 2.88e-02 -7.92e-01 -3.06e-01 -4.68e-02 -7.63e-02 -1.16e-02  8.53e-02  8.80e-03
  -2.24e-02 -1.17e-03  1.21e-03 -6.18e-03 -1.86e-02]
 [ 1.97e+00 -7.58e-03  1.99e-01 -1.14e-03  4.48e-04 -8.03e-03  6.42e-01 -5.40e-03
   1.62e-02  5.46e-04 -1.86e-04  2.79e-03  3.60e-03]]
SymNet parameters
[0.19 0.03]
SymNet parameters
[[ 1.09e+00  9.11e-01  1.08e+00 -3.01e-01 -1.38e-01 -2.20e-01 -2.59e-01  2.23e-01
  -4.37e-01  1.21e-02 -5.08e-03 -3.57e-02  8.15e-03 -8.69e-02]
 [ 1.05e-02  3.10e-03 -2.07e-02 -1.62e-03  5.53e-04  9.13e-04 -1.46e-02 -1.19e-03
   9.96e-04 -8.27e-05 -1.03e-04  6.10e-04 -5.94e-04 -6.21e-04]]
SymNet parameters
[0.11 0.48]
SymNet parameters
[[-4.34e-01 -5.47e-02 -2.55e-02 -3.33e-03 -6.70e-04 -2.64e-03  1.01e+00 -2.30e-03
   1.31e-02  7.64e-04 -4.76e-04  2.25e-04 -7.45e-04 -2.79e-03  7.32e-03]
 [ 3.94e-01 -4.75e-03  9.80e-01 -7.58e-02 -3.93e-02 -5.32e-02 -3.59e-02  5.50e-02
  -1.13e-01  3.19e-03 -1.50e-03 -9.01e-03  4.29e-02 -1.78e-02 -5.22e-01]]
SymNet parameters
[0.93 0.33]
SymNet parameters
[[ 6.49e-01 -7.45e-01 -6.35e-01  5.84e-02  2.07e-02  5.25e-02  1.23e+00  7.88e-02
   5.67e-02  8.18e-04  1.76e-02 -4.79e-02  3.66e-02  1.68e-01  3.04e-01 -8.53e-01]
 [ 7.68e-01  1.66e+00  8.59e-01 -1.62e-01 -2.33e-01 -1.18e-01  8.41e-02 -7.18e-02
   3.72e-01 -2.69e-03  7.34e-03 -1.99e-02 -1.66e-01  6.00e-02  9.65e-01 -4.38e-02]]
SymNet parameters
[0.03 0.1 ]
SymNet parameters
[[ 1.55e-01  2.35e-01  1.23e+00 -1.01e-01 -1.61e-01 -8.03e-03  1.15e-01  6.43e-02
  -1.67e-01  1.02e-03 -2.70e-04 -1.69e-02 -2.84e-01  4.21e-01 -4.94e-01 -1.22e+00
  -2.14e-02]]
SymNet parameters
[0.28]
SymNet parameters
[[-2.01e-01  7.60e-02  1.39e-01 -3.04e-02  1.87e-02  7.76e-02  1.75e-01  1.15e-01
   1.80e+00  5.18e-02 -7.30e-02 -4.81e-01]
 [-1.95e-03 -4.44e-04 -2.50e-04  2.53e-05  1.18e-04 -2.23e-06 -4.08e-03 -6.27e-05
   8.82e-03 -1.16e-04 -2.70e-04  1.51e-03]]
SymNet parameters
[-0.1  -0.17]
SymNet parameters
[[-3.61e-02  2.24e-02  5.95e-04 -1.41e-03 -2.78e-03 -5.04e-03  1.08e+00  6.11e-01
   7.98e-02  1.71e-02 -2.92e-02 -1.15e-02  6.99e-01]
 [-2.20e-02 -5.96e-02  1.28e-02 -1.59e-03 -3.75e-04  4.44e-03  1.30e+00 -1.02e-01
   5.11e-02  3.60e-03 -7.26e-03 -2.49e-02  3.52e-01]]
SymNet parameters
[ 0.08 -0.09]
SymNet parameters
[[ 0.04  0.03 -0.   -0.    0.01  0.01 -1.04 -0.6   0.07 -0.01 -0.01 -0.02 -0.28  0.01]
 [ 0.84  0.    0.05 -0.    0.    0.01 -0.14 -0.01  0.34  0.01 -0.01 -0.07  0.76 -0.01]]
SymNet parameters
[0.22 0.09]
SymNet parameters
[[ 9.03e-01 -1.27e-02  1.45e-02  8.73e-04 -2.12e-04 -3.53e-03  3.24e-01 -5.40e-01
   1.10e+00 -5.94e-04 -4.92e-03  3.48e-02 -4.13e-01 -1.48e-01  4.00e-01]
 [-6.00e-01 -1.28e-02 -1.80e-02  2.69e-03 -3.72e-03 -9.83e-03  9.62e-01  6.35e-01
   2.73e-01  2.37e-03  2.35e-03  4.28e-02 -2.54e-01  8.55e-02  1.66e-01]]
SymNet parameters
[0.25 0.34]
SymNet parameters
[[ 1.11e+00 -3.29e-03  3.29e-02 -2.46e-03  2.24e-03  8.81e-03  4.44e-01  3.47e-01
  -5.69e-01  6.08e-03  5.54e-04 -6.30e-02  7.45e-01  1.07e-01 -3.17e-01  2.18e-04]
 [ 7.09e-01 -3.50e-02  2.02e-02  1.68e-03 -4.84e-03 -8.29e-03  2.21e-01  1.40e+00
   9.27e-01  1.33e-02 -9.80e-04  2.15e-02  2.11e-01  1.45e-01  3.36e-01 -3.85e-03]]
SymNet parameters
[0.1  0.07]
SymNet parameters
[[ 0.34  0.    0.02 -0.    0.    0.01  0.18  0.02  0.53  0.06 -0.01  0.02  0.4   0.26
  -0.75 -0.71 -0.45]]
SymNet parameters
[0.08]
finally, finish this stage
iter:  1167    time: 12.12
Func: 1.68e-02  |g|: 5.95e-03
stableloss: 9.27e-03   dataloss: 1.03e-02   sparseloss: 6.92e+01 momentloss: 6.51e+00
current expression:
[u00*u01, u10*v00, u20, u02, u00*u01**2, u01*u10*v00, u10*v00*v10, u00*u11*v00, u01, u00, u00*u01*v00, u01*u10, u10*v10, u00*u10*v10, u00*v00, u00*v00**2, u00**3, u10*v00*v01, v00**2*v10, u00*u02]
[-0.98 -0.98  0.05  0.05  0.01  0.01  0.01  0.01 -0.01  0.01 -0.01 -0.01 -0.   -0.
  0.    0.   -0.   -0.    0.    0.  ]
[v00*v10, u00*v01, v02, v20, v00*v10**2, v00, u00*v00*v11, u00*u01*v01, u10*v01, u00*v01*v10, v00**2*v10, v10, v01, u00, v10**2, u00*v00**2, v00**2, u00*v00*v10, 1, v00**2*v10**2]
[-0.98 -0.98  0.05  0.05  0.02  0.01  0.01  0.01 -0.01  0.01 -0.01  0.01 -0.01  0.01
 -0.   -0.   -0.    0.    0.    0.  ]
block:  2
name:  burgers-2-upwind-sparse0-noise0.001-id6
device:  cuda:2
generate a random number to check random seed:  1.2307644029038958
current stage is: block-2
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.9367, device='cuda:2', dtype=torch.float64)
u_obs variance
tensor([ 0.2576,  1.6552,  1.7453, 21.7702, 10.2610, 20.7663,  0.2535,  1.5918,
         1.7548, 18.9823, 10.3687, 23.8197], device='cuda:2',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
iter:     0    time: 552.13
Func: 7.34e-02  |g|: 5.19e+00
stableloss: 1.33e-02   dataloss: 6.04e-02   sparseloss: 6.92e+01 momentloss: 6.51e+00
iter:   200    time: 20.39
Func: 5.49e-02  |g|: 1.10e-01
stableloss: 1.35e-02   dataloss: 4.12e-02   sparseloss: 6.90e+01 momentloss: 6.80e+00
iter:   400    time: 14.02
Func: 5.31e-02  |g|: 2.38e-02
stableloss: 1.36e-02   dataloss: 3.95e-02   sparseloss: 7.47e+01 momentloss: 6.76e+00
iter:   600    time: 13.95
Func: 5.29e-02  |g|: 3.80e-02
stableloss: 1.36e-02   dataloss: 3.94e-02   sparseloss: 7.80e+01 momentloss: 6.74e+00
iter:   800    time: 13.83
Func: 5.27e-02  |g|: 3.58e-02
stableloss: 1.35e-02   dataloss: 3.92e-02   sparseloss: 8.11e+01 momentloss: 6.76e+00
iter:  1000    time: 13.85
Func: 5.25e-02  |g|: 2.03e-02
stableloss: 1.36e-02   dataloss: 3.90e-02   sparseloss: 8.14e+01 momentloss: 6.75e+00
iter:  1200    time: 13.86
Func: 5.23e-02  |g|: 4.99e-02
stableloss: 1.37e-02   dataloss: 3.88e-02   sparseloss: 8.80e+01 momentloss: 6.74e+00
iter:  1400    time: 13.85
Func: 5.20e-02  |g|: 1.86e-02
stableloss: 1.36e-02   dataloss: 3.85e-02   sparseloss: 9.47e+01 momentloss: 6.72e+00
iter:  1600    time: 13.97
Func: 5.19e-02  |g|: 1.46e-02
stableloss: 1.36e-02   dataloss: 3.85e-02   sparseloss: 9.89e+01 momentloss: 6.73e+00
iter:  1800    time: 14.26
Func: 5.19e-02  |g|: 2.97e-02
stableloss: 1.35e-02   dataloss: 3.84e-02   sparseloss: 1.06e+02 momentloss: 6.73e+00
Warning: Maximum number of iterations has been exceeded.
         Current function value: 0.051831
         Iterations: 2000
         Function evaluations: 2018
         Gradient evaluations: 2009
convolution moment and kernels
[[ 1.00e+00  0.00e+00 -8.67e-05 -9.75e-03  2.17e-03]
 [ 0.00e+00  3.02e-06 -3.97e-03  2.59e-03  2.66e-02]
 [-1.54e-04  5.28e-03  5.51e-03 -3.48e-03  7.74e-02]
 [-3.93e-04  5.01e-05 -2.82e-03 -3.07e-03  3.75e-02]
 [-1.10e-01  2.60e-02 -5.09e-02 -5.74e-03  1.47e-02]]
[[-1.18e-04 -5.46e-02 -3.35e-02 -1.31e-02 -8.08e-03]
 [ 3.18e-02  1.02e-01  2.97e-01 -5.41e-02  6.15e-02]
 [-4.69e-02 -1.44e-01  5.21e-01  1.18e-01 -1.06e-01]
 [-1.26e-02  2.71e-01  5.92e-02  9.50e-02  2.67e-02]
 [ 3.49e-02 -1.93e-01  1.70e-01 -1.45e-01  2.34e-02]]
[[ 0.00e+00  1.00e+00  0.00e+00 -9.04e-02 -2.74e-02]
 [ 0.00e+00  0.00e+00  3.53e-03 -4.82e-03  6.50e-03]
 [ 0.00e+00  2.92e-02  8.11e-03  3.80e-02  1.92e-02]
 [-4.84e-03  7.60e-05  4.26e-03  3.72e-03  8.91e-03]
 [ 7.79e-03 -1.93e-03 -4.63e-03  4.90e-03  3.90e-03]]
[[-1.12e-03 -6.79e-04  1.84e-02 -5.48e-03 -9.16e-04]
 [-3.21e-03 -9.56e-03 -2.68e-02 -2.35e-02  2.71e-02]
 [ 1.06e-01 -6.23e-01 -1.45e-01  9.10e-01 -2.02e-01]
 [-5.11e-03  8.15e-03 -6.25e-02  2.18e-02  1.13e-02]
 [ 4.14e-03 -2.26e-02  5.13e-02 -3.63e-02  8.86e-03]]
[[ 0.00e+00  0.00e+00  0.00e+00 -4.53e-04 -1.70e-03]
 [ 1.00e+00  0.00e+00  2.33e-02 -1.32e-03 -1.69e-02]
 [ 0.00e+00 -2.87e-03  1.34e-02 -4.29e-03 -2.45e-03]
 [-7.40e-02 -3.51e-03  5.86e-02  1.69e-03 -1.12e-03]
 [-5.20e-02 -9.95e-04 -1.38e-03  3.58e-04 -4.48e-04]]
[[ 1.60e-03 -3.64e-02  1.36e-01 -3.46e-02  1.19e-03]
 [ 5.15e-03  5.17e-02 -6.47e-01  5.64e-02  1.11e-03]
 [-8.92e-04 -5.11e-02 -1.97e-01 -7.44e-02  1.13e-02]
 [-4.81e-03  8.07e-03  9.28e-01  3.24e-02 -1.51e-02]
 [-2.51e-03  3.41e-02 -2.31e-01  2.74e-02 -4.25e-04]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00 -1.93e-02]
 [ 0.00e+00  0.00e+00  0.00e+00  1.17e-03  3.63e-03]
 [ 0.00e+00  0.00e+00  2.53e-03 -1.80e-03  3.75e-03]
 [ 0.00e+00  8.02e-04  1.02e-03 -2.23e-03 -1.56e-03]
 [-4.55e-03 -4.72e-03  1.58e-03  5.34e-03 -5.99e-03]]
[[-9.07e-03  3.21e-02 -3.80e-02  1.19e-02 -1.52e-03]
 [ 4.02e-02 -1.42e-01  1.73e-01 -6.26e-02  1.01e-02]
 [-1.69e-01  1.65e+00 -2.92e+00  1.54e+00 -1.28e-01]
 [ 4.52e-02 -1.70e-01  2.26e-01 -1.04e-01  2.14e-02]
 [-1.00e-02  3.92e-02 -5.36e-02  2.49e-02 -5.05e-03]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00 -7.74e-04]
 [ 0.00e+00  1.00e+00  0.00e+00 -2.83e-03  1.68e-03]
 [ 0.00e+00  0.00e+00  1.48e-03  6.08e-04 -2.49e-03]
 [ 0.00e+00 -2.38e-03  2.71e-04  4.58e-03 -1.90e-03]
 [ 7.41e-05  8.76e-04 -1.94e-03  2.87e-04  2.60e-03]]
[[ 0.01 -0.08  0.03  0.04 -0.  ]
 [-0.08  0.53 -0.13 -0.37  0.04]
 [ 0.02 -0.11  0.17 -0.1   0.02]
 [ 0.05 -0.4  -0.09  0.51 -0.07]
 [-0.01  0.05  0.02 -0.07  0.01]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  2.28e-03]
 [ 0.00e+00  0.00e+00  0.00e+00  7.58e-04  9.03e-04]
 [ 1.00e+00  0.00e+00  2.65e-03  8.84e-04 -1.87e-03]
 [ 0.00e+00 -7.40e-04  5.98e-04 -4.41e-04  8.44e-04]
 [-7.08e-03 -2.21e-04  1.23e-03 -2.69e-04 -1.46e-03]]
[[-1.67e-03  7.38e-03 -1.02e-01  7.70e-03 -1.75e-03]
 [ 3.00e-03 -1.42e-02  1.39e+00 -1.66e-02  4.29e-03]
 [-4.85e-05  5.23e-03 -2.56e+00  1.11e-02 -3.65e-03]
 [ 1.80e-03 -1.29e-02  1.39e+00 -1.72e-02  4.73e-03]
 [-8.00e-04  5.33e-03 -9.94e-02  5.80e-03 -1.33e-03]]
SymNet parameters
[[ 9.12e-01  1.17e+00  1.35e+00 -4.36e-01 -2.69e-01  8.71e-02  2.78e+00  5.47e-01
  -4.83e-01  4.39e-03 -2.25e-02 -6.81e-02]
 [ 4.11e-01 -1.63e-03 -6.83e-03  3.13e-03  2.53e-03  1.11e-03 -2.80e-02  3.17e-03
  -4.06e-03 -3.55e-04 -3.79e-04  1.06e-03]]
SymNet parameters
[-0.43  1.22]
SymNet parameters
[[-2.19e-03 -7.74e-01  5.11e-02 -4.93e-02 -3.73e-02  1.16e-02  1.24e+00  6.27e-02
  -5.59e-02  1.00e-03 -2.95e-03 -1.02e-02  1.03e-03]
 [ 1.52e+00  1.40e-01 -2.46e-01 -2.59e-02 -1.08e-02 -4.20e-03  1.02e-02  7.58e-04
  -2.01e-03  2.31e-03 -2.18e-03 -1.87e-03 -4.90e-02]]
SymNet parameters
[ 0.07 -0.84]
SymNet parameters
[[ 9.82e-01  7.79e-01  1.40e+00 -5.72e-01 -2.47e-01  9.67e-02  3.97e+00  6.83e-01
  -5.89e-01  9.26e-03 -2.89e-02 -8.30e-02 -6.46e-03 -4.38e-03]
 [ 1.74e-01  9.90e-04 -9.30e-03  1.59e-03  1.57e-03  1.46e-03 -1.68e-02  1.49e-03
  -3.57e-04 -2.69e-04 -1.42e-04  4.71e-04  4.78e-04 -1.24e-03]]
SymNet parameters
[0.04 0.68]
SymNet parameters
[[-1.57e-01  6.23e-02  8.85e-03 -1.77e-03  5.36e-03  2.54e-03  1.08e+00  2.26e-02
  -2.48e-02  1.28e-04  3.37e-04 -3.53e-03  5.32e-02  2.23e-03 -1.19e-01]
 [ 1.04e+00 -2.17e-01  1.07e+00 -9.93e-02 -1.41e-02  1.48e-02  9.03e-01  1.49e-01
  -1.29e-01  1.67e-03 -4.71e-03 -1.56e-02  3.38e-01  4.77e-02 -7.47e-01]]
SymNet parameters
[0.85 0.37]
SymNet parameters
[[ 1.5  -1.24  1.99  0.37  0.05 -0.01  2.79 -0.25  0.27 -0.02  0.03  0.01 -0.25  0.1
   1.52 -0.67]
 [ 0.99  3.11  0.21 -0.07 -0.02 -0.08 -1.97 -0.67  0.67  0.02 -0.01  0.04 -0.64 -0.01
   1.09 -0.13]]
SymNet parameters
[-0.07 -0.19]
SymNet parameters
[[ 0.89 -0.03  1.29 -0.16 -0.12  0.09  2.07  0.29 -0.26  0.   -0.01 -0.04 -0.23  0.62
  -0.18 -0.91 -0.01]]
SymNet parameters
[0.05]
SymNet parameters
[[-8.74e-01  6.38e-01 -1.71e-01  3.66e-02 -3.16e-02 -2.50e-02  2.50e+00 -9.38e-01
   1.04e+00 -2.69e-01 -2.67e-02 -2.18e-01]
 [-1.07e-02  7.91e-05 -6.25e-04 -7.14e-06  1.45e-05  2.79e-05  7.41e-04 -4.98e-04
   1.22e-03 -4.90e-05  2.10e-05  3.18e-04]]
SymNet parameters
[ 0.51 -0.19]
SymNet parameters
[[ 7.03e-01 -2.24e-01  8.86e-02 -1.80e-02  1.25e-02  3.25e-03 -7.15e-01  7.75e-01
  -1.44e-01  8.66e-02 -3.81e-02  6.79e-02 -1.00e+00]
 [ 8.29e-02 -1.94e-01  2.27e-02  8.95e-03 -1.86e-03 -6.18e-03  3.14e+00  3.03e-01
  -2.46e-01 -4.11e-02  1.77e-02 -9.48e-04 -2.82e-01]]
SymNet parameters
[ 0.16 -0.57]
SymNet parameters
[[-0.43  0.06 -0.01  0.01 -0.   -0.    0.14 -0.35 -0.01 -0.03 -0.   -0.02  0.56  0.  ]
 [ 0.77 -0.02  0.08 -0.    0.    0.   -0.25 -0.1   0.07  0.01  0.01  0.01 -0.32 -0.01]]
SymNet parameters
[0.04 0.75]
SymNet parameters
[[ 0.29 -0.23  0.06 -0.01  0.01  0.01 -0.85 -0.33  0.41  0.1   0.01  0.08 -1.82 -0.04
   0.32]
 [-0.17 -0.07  0.03 -0.01  0.    0.    0.92  0.46  0.01  0.03  0.    0.03 -0.64  0.01
  -0.  ]]
SymNet parameters
[0.53 0.5 ]
SymNet parameters
[[ 1.49e+00  1.54e-01  2.11e-03  7.46e-03 -7.96e-03 -8.19e-03  1.82e+00  4.27e-02
  -7.41e-02 -6.84e-02  1.96e-03 -5.12e-02  1.18e+00  5.23e-03 -1.07e-01  2.08e-03]
 [ 9.57e-01 -3.50e-01  1.29e-01 -2.66e-02  1.88e-02  1.21e-02 -1.49e+00  2.10e+00
   8.74e-03  1.48e-01  1.63e-02  1.25e-01 -2.96e+00  6.48e-02  1.04e-01  2.92e-02]]
SymNet parameters
[0.27 0.42]
SymNet parameters
[[ 0.17 -0.13  0.05 -0.    0.    0.    0.39  0.02  0.06  0.11  0.01  0.09 -1.03  0.02
  -1.03 -0.79 -0.36]]
SymNet parameters
[0.25]
finally, finish this stage
iter:  2000    time: 14.63
Func: 5.18e-02  |g|: 8.37e-03
stableloss: 1.35e-02   dataloss: 3.84e-02   sparseloss: 1.09e+02 momentloss: 6.73e+00
current expression:
[u10*v00, u00*u01, u20, u02, u00*u01**2, u01*u10*v00, u00*u11*v00, u10*v00*v10, u10*v00*v01, u00, v00, u00**2*v00, u00*u10*v01, u00*u10*v10, u20*v00**2, u00**2*u02, u00*v00*v01, v00**2*v01, u00**3, u00*u01*v00**2]
[-0.98 -0.98  0.05  0.05  0.01  0.01  0.01  0.01 -0.01  0.    0.   -0.    0.   -0.
  0.    0.    0.    0.   -0.    0.  ]
[v00*v10, u00*v01, v02, v20, v00*v10**2, u00*v01*v10, u00*v00*v11, u10*v00*v01, u00*u01*v01, v00, v00**3, u00**2*v02, u10, v00**2*v20, 1, u00*u10, u00*u01, u00*v00, u01*v00*v10, v01*v10]
[-0.99 -0.98  0.05  0.05  0.01  0.01  0.01  0.01  0.01  0.01 -0.    0.   -0.    0.
  0.   -0.    0.   -0.    0.    0.  ]
block:  3
name:  burgers-2-upwind-sparse0-noise0.001-id6
device:  cuda:2
generate a random number to check random seed:  -0.4884513883156556
current stage is: block-3
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.8345, device='cuda:2', dtype=torch.float64)
u_obs variance
tensor([ 0.2569,  1.7029,  1.7015, 23.7965,  9.8621, 20.5676,  0.2612,  1.7498,
         1.8376, 21.1134, 11.1492, 24.4293], device='cuda:2',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 0.167461
         Iterations: 0
         Function evaluations: 15
         Gradient evaluations: 3
convolution moment and kernels
[[ 1.00e+00  0.00e+00 -8.38e-05 -9.75e-03  2.17e-03]
 [ 0.00e+00  3.78e-06 -3.97e-03  2.59e-03  2.66e-02]
 [-1.54e-04  5.28e-03  5.51e-03 -3.48e-03  7.74e-02]
 [-3.92e-04  4.98e-05 -2.82e-03 -3.07e-03  3.75e-02]
 [-1.10e-01  2.60e-02 -5.09e-02 -5.74e-03  1.47e-02]]
[[-1.20e-04 -5.46e-02 -3.36e-02 -1.31e-02 -8.08e-03]
 [ 3.18e-02  1.02e-01  2.97e-01 -5.41e-02  6.15e-02]
 [-4.70e-02 -1.44e-01  5.21e-01  1.18e-01 -1.06e-01]
 [-1.26e-02  2.71e-01  5.93e-02  9.50e-02  2.67e-02]
 [ 3.49e-02 -1.93e-01  1.70e-01 -1.45e-01  2.34e-02]]
[[ 0.00e+00  1.00e+00  0.00e+00 -9.04e-02 -2.75e-02]
 [ 0.00e+00  0.00e+00  3.53e-03 -4.82e-03  6.50e-03]
 [ 0.00e+00  2.92e-02  8.11e-03  3.81e-02  1.92e-02]
 [-4.84e-03  7.69e-05  4.26e-03  3.72e-03  8.90e-03]
 [ 7.79e-03 -1.93e-03 -4.63e-03  4.90e-03  3.90e-03]]
[[-1.11e-03 -6.90e-04  1.84e-02 -5.49e-03 -9.13e-04]
 [-3.21e-03 -9.55e-03 -2.69e-02 -2.34e-02  2.71e-02]
 [ 1.06e-01 -6.22e-01 -1.45e-01  9.10e-01 -2.02e-01]
 [-5.10e-03  8.11e-03 -6.24e-02  2.18e-02  1.13e-02]
 [ 4.14e-03 -2.26e-02  5.13e-02 -3.63e-02  8.85e-03]]
[[ 0.00e+00  0.00e+00  0.00e+00 -4.53e-04 -1.71e-03]
 [ 1.00e+00  0.00e+00  2.33e-02 -1.31e-03 -1.69e-02]
 [ 0.00e+00 -2.87e-03  1.34e-02 -4.29e-03 -2.44e-03]
 [-7.40e-02 -3.51e-03  5.86e-02  1.69e-03 -1.12e-03]
 [-5.20e-02 -9.98e-04 -1.38e-03  3.60e-04 -4.53e-04]]
[[ 1.59e-03 -3.63e-02  1.36e-01 -3.45e-02  1.19e-03]
 [ 5.17e-03  5.16e-02 -6.47e-01  5.63e-02  1.13e-03]
 [-9.49e-04 -5.09e-02 -1.97e-01 -7.42e-02  1.13e-02]
 [-4.78e-03  7.93e-03  9.28e-01  3.23e-02 -1.51e-02]
 [-2.52e-03  3.41e-02 -2.31e-01  2.74e-02 -4.29e-04]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00 -1.93e-02]
 [ 0.00e+00  0.00e+00  0.00e+00  1.17e-03  3.63e-03]
 [ 0.00e+00  0.00e+00  2.53e-03 -1.80e-03  3.75e-03]
 [ 0.00e+00  8.02e-04  1.02e-03 -2.23e-03 -1.56e-03]
 [-4.55e-03 -4.72e-03  1.58e-03  5.34e-03 -5.99e-03]]
[[-9.07e-03  3.21e-02 -3.80e-02  1.19e-02 -1.52e-03]
 [ 4.02e-02 -1.42e-01  1.73e-01 -6.26e-02  1.01e-02]
 [-1.69e-01  1.65e+00 -2.92e+00  1.54e+00 -1.28e-01]
 [ 4.52e-02 -1.70e-01  2.26e-01 -1.04e-01  2.14e-02]
 [-1.00e-02  3.92e-02 -5.36e-02  2.49e-02 -5.05e-03]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00 -7.74e-04]
 [ 0.00e+00  1.00e+00  0.00e+00 -2.83e-03  1.68e-03]
 [ 0.00e+00  0.00e+00  1.49e-03  6.08e-04 -2.49e-03]
 [ 0.00e+00 -2.38e-03  2.71e-04  4.58e-03 -1.90e-03]
 [ 7.43e-05  8.76e-04 -1.94e-03  2.87e-04  2.60e-03]]
[[ 0.01 -0.08  0.03  0.04 -0.  ]
 [-0.08  0.53 -0.13 -0.37  0.04]
 [ 0.02 -0.11  0.17 -0.1   0.02]
 [ 0.05 -0.4  -0.09  0.51 -0.07]
 [-0.01  0.05  0.02 -0.07  0.01]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  2.28e-03]
 [ 0.00e+00  0.00e+00  0.00e+00  7.58e-04  9.03e-04]
 [ 1.00e+00  0.00e+00  2.65e-03  8.84e-04 -1.87e-03]
 [ 0.00e+00 -7.40e-04  5.98e-04 -4.41e-04  8.43e-04]
 [-7.08e-03 -2.22e-04  1.23e-03 -2.69e-04 -1.46e-03]]
[[-1.67e-03  7.39e-03 -1.02e-01  7.70e-03 -1.75e-03]
 [ 3.01e-03 -1.42e-02  1.39e+00 -1.66e-02  4.29e-03]
 [-5.86e-05  5.27e-03 -2.56e+00  1.11e-02 -3.66e-03]
 [ 1.80e-03 -1.29e-02  1.39e+00 -1.72e-02  4.73e-03]
 [-8.02e-04  5.34e-03 -9.94e-02  5.80e-03 -1.33e-03]]
SymNet parameters
[[ 9.12e-01  1.17e+00  1.35e+00 -4.36e-01 -2.69e-01  8.70e-02  2.78e+00  5.47e-01
  -4.83e-01  4.40e-03 -2.25e-02 -6.81e-02]
 [ 4.11e-01 -1.65e-03 -6.83e-03  3.18e-03  2.52e-03  1.10e-03 -2.80e-02  3.18e-03
  -4.05e-03 -3.50e-04 -3.93e-04  1.05e-03]]
SymNet parameters
[-0.43  1.22]
SymNet parameters
[[-2.19e-03 -7.74e-01  5.11e-02 -4.93e-02 -3.73e-02  1.16e-02  1.24e+00  6.27e-02
  -5.59e-02  1.01e-03 -2.94e-03 -1.02e-02  1.03e-03]
 [ 1.52e+00  1.40e-01 -2.46e-01 -2.58e-02 -1.08e-02 -4.20e-03  1.02e-02  7.62e-04
  -2.02e-03  2.29e-03 -2.18e-03 -1.87e-03 -4.90e-02]]
SymNet parameters
[ 0.07 -0.84]
SymNet parameters
[[ 9.82e-01  7.79e-01  1.40e+00 -5.72e-01 -2.47e-01  9.67e-02  3.97e+00  6.83e-01
  -5.89e-01  9.26e-03 -2.89e-02 -8.30e-02 -6.44e-03 -4.37e-03]
 [ 1.74e-01  1.03e-03 -9.29e-03  1.52e-03  1.55e-03  1.48e-03 -1.67e-02  1.46e-03
  -3.81e-04 -2.69e-04 -1.20e-04  4.69e-04  7.54e-04 -1.10e-03]]
SymNet parameters
[0.04 0.68]
SymNet parameters
[[-1.57e-01  6.23e-02  8.85e-03 -1.77e-03  5.36e-03  2.55e-03  1.08e+00  2.27e-02
  -2.48e-02  1.26e-04  3.37e-04 -3.53e-03  5.32e-02  2.21e-03 -1.19e-01]
 [ 1.04e+00 -2.17e-01  1.07e+00 -9.93e-02 -1.41e-02  1.48e-02  9.03e-01  1.49e-01
  -1.29e-01  1.68e-03 -4.71e-03 -1.56e-02  3.38e-01  4.76e-02 -7.47e-01]]
SymNet parameters
[0.85 0.37]
SymNet parameters
[[ 1.5  -1.24  1.99  0.37  0.05 -0.01  2.79 -0.25  0.27 -0.02  0.03  0.01 -0.25  0.1
   1.52 -0.67]
 [ 0.99  3.11  0.21 -0.07 -0.02 -0.08 -1.97 -0.67  0.67  0.02 -0.01  0.04 -0.64 -0.01
   1.09 -0.13]]
SymNet parameters
[-0.07 -0.19]
SymNet parameters
[[ 0.89 -0.03  1.29 -0.16 -0.12  0.09  2.07  0.29 -0.26  0.   -0.01 -0.04 -0.23  0.62
  -0.18 -0.91 -0.01]]
SymNet parameters
[0.05]
SymNet parameters
[[-8.74e-01  6.38e-01 -1.71e-01  3.66e-02 -3.16e-02 -2.50e-02  2.50e+00 -9.38e-01
   1.04e+00 -2.69e-01 -2.67e-02 -2.18e-01]
 [-1.06e-02 -4.95e-05 -6.44e-04  3.93e-05 -9.01e-05 -1.24e-04  7.39e-04 -5.65e-04
   1.19e-03  4.00e-04  6.03e-05  1.74e-04]]
SymNet parameters
[ 0.51 -0.19]
SymNet parameters
[[ 7.03e-01 -2.24e-01  8.86e-02 -1.80e-02  1.25e-02  3.25e-03 -7.15e-01  7.75e-01
  -1.44e-01  8.66e-02 -3.81e-02  6.79e-02 -1.00e+00]
 [ 8.29e-02 -1.94e-01  2.27e-02  8.95e-03 -1.86e-03 -6.18e-03  3.14e+00  3.03e-01
  -2.46e-01 -4.11e-02  1.77e-02 -9.48e-04 -2.82e-01]]
SymNet parameters
[ 0.16 -0.57]
SymNet parameters
[[-0.43  0.06 -0.01  0.01 -0.   -0.    0.14 -0.35 -0.01 -0.03 -0.   -0.02  0.56  0.  ]
 [ 0.77 -0.02  0.08 -0.    0.    0.   -0.25 -0.1   0.07  0.01  0.01  0.01 -0.32 -0.01]]
SymNet parameters
[0.04 0.75]
SymNet parameters
[[ 0.29 -0.23  0.06 -0.01  0.01  0.01 -0.85 -0.33  0.41  0.1   0.01  0.08 -1.82 -0.04
   0.32]
 [-0.17 -0.07  0.03 -0.01  0.    0.    0.92  0.46  0.01  0.03  0.    0.03 -0.64  0.01
  -0.  ]]
SymNet parameters
[0.53 0.5 ]
SymNet parameters
[[ 1.49e+00  1.54e-01  2.11e-03  7.48e-03 -7.95e-03 -8.18e-03  1.82e+00  4.27e-02
  -7.41e-02 -6.84e-02  1.96e-03 -5.12e-02  1.18e+00  5.23e-03 -1.07e-01  2.08e-03]
 [ 9.57e-01 -3.50e-01  1.29e-01 -2.66e-02  1.88e-02  1.21e-02 -1.49e+00  2.10e+00
   8.75e-03  1.48e-01  1.63e-02  1.25e-01 -2.96e+00  6.48e-02  1.04e-01  2.92e-02]]
SymNet parameters
[0.27 0.42]
SymNet parameters
[[ 0.17 -0.13  0.05 -0.    0.    0.    0.39  0.02  0.06  0.11  0.01  0.09 -1.03  0.02
  -1.03 -0.79 -0.36]]
SymNet parameters
[0.25]
finally, finish this stage
iter:     0    time: 680.63
Func: 1.67e-01  |g|: 1.74e+01
stableloss: 3.53e-02   dataloss: 1.47e-01   sparseloss: 1.09e+02 momentloss: 6.73e+00
current expression:
[u10*v00, u00*u01, u20, u02, u00*u01**2, u01*u10*v00, u00*u11*v00, u10*v00*v10, u10*v00*v01, u00, v00, u00**2*v00, u00*u10*v01, u00*u10*v10, u20*v00**2, u00**2*u02, u00*v00*v01, v00**2*v01, u00**3, u00*u01*v00**2]
[-0.98 -0.98  0.05  0.05  0.01  0.01  0.01  0.01 -0.01  0.    0.   -0.    0.   -0.
  0.    0.    0.    0.   -0.    0.  ]
[v00*v10, u00*v01, v02, v20, v00*v10**2, u00*v01*v10, u00*v00*v11, u10*v00*v01, u00*u01*v01, v00, v00**3, u00**2*v02, u10, v00**2*v20, 1, u00*u10, u00*u01, u00*v00, u01*v00*v10, v01*v10]
[-0.99 -0.98  0.05  0.05  0.01  0.01  0.01  0.01  0.01  0.01 -0.    0.   -0.    0.
  0.   -0.    0.   -0.    0.    0.  ]
block:  4
name:  burgers-2-upwind-sparse0-noise0.001-id6
device:  cuda:2
generate a random number to check random seed:  -0.5403196404452092
current stage is: block-4
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.9366, device='cuda:2', dtype=torch.float64)
u_obs variance
tensor([ 0.2415,  1.6510,  1.4947, 22.7614,  9.4203, 18.0679,  0.2496,  1.6741,
         1.7130, 20.3510, 10.3363, 23.2835], device='cuda:2',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 0.222293
         Iterations: 0
         Function evaluations: 15
         Gradient evaluations: 3
convolution moment and kernels
[[ 1.00e+00  0.00e+00 -8.68e-05 -9.75e-03  2.17e-03]
 [ 0.00e+00  3.03e-06 -3.97e-03  2.59e-03  2.66e-02]
 [-1.54e-04  5.28e-03  5.51e-03 -3.48e-03  7.74e-02]
 [-3.92e-04  5.01e-05 -2.82e-03 -3.07e-03  3.75e-02]
 [-1.10e-01  2.60e-02 -5.09e-02 -5.74e-03  1.47e-02]]
[[-1.19e-04 -5.46e-02 -3.36e-02 -1.31e-02 -8.08e-03]
 [ 3.18e-02  1.02e-01  2.97e-01 -5.41e-02  6.15e-02]
 [-4.69e-02 -1.44e-01  5.21e-01  1.18e-01 -1.06e-01]
 [-1.26e-02  2.71e-01  5.92e-02  9.50e-02  2.67e-02]
 [ 3.49e-02 -1.93e-01  1.70e-01 -1.45e-01  2.34e-02]]
[[ 0.00e+00  1.00e+00  0.00e+00 -9.04e-02 -2.74e-02]
 [ 0.00e+00  0.00e+00  3.53e-03 -4.82e-03  6.50e-03]
 [ 0.00e+00  2.92e-02  8.11e-03  3.80e-02  1.92e-02]
 [-4.84e-03  7.57e-05  4.26e-03  3.72e-03  8.91e-03]
 [ 7.79e-03 -1.93e-03 -4.63e-03  4.90e-03  3.90e-03]]
[[-1.12e-03 -6.79e-04  1.84e-02 -5.48e-03 -9.17e-04]
 [-3.21e-03 -9.56e-03 -2.68e-02 -2.35e-02  2.71e-02]
 [ 1.06e-01 -6.23e-01 -1.45e-01  9.10e-01 -2.02e-01]
 [-5.11e-03  8.15e-03 -6.25e-02  2.18e-02  1.13e-02]
 [ 4.14e-03 -2.26e-02  5.13e-02 -3.63e-02  8.86e-03]]
[[ 0.00e+00  0.00e+00  0.00e+00 -4.56e-04 -1.70e-03]
 [ 1.00e+00  0.00e+00  2.33e-02 -1.31e-03 -1.69e-02]
 [ 0.00e+00 -2.88e-03  1.34e-02 -4.29e-03 -2.45e-03]
 [-7.40e-02 -3.51e-03  5.86e-02  1.69e-03 -1.12e-03]
 [-5.20e-02 -9.96e-04 -1.38e-03  3.58e-04 -4.50e-04]]
[[ 1.60e-03 -3.64e-02  1.36e-01 -3.46e-02  1.19e-03]
 [ 5.15e-03  5.17e-02 -6.47e-01  5.64e-02  1.12e-03]
 [-9.01e-04 -5.11e-02 -1.97e-01 -7.43e-02  1.13e-02]
 [-4.81e-03  8.04e-03  9.28e-01  3.24e-02 -1.51e-02]
 [-2.51e-03  3.41e-02 -2.31e-01  2.74e-02 -4.26e-04]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00 -1.93e-02]
 [ 0.00e+00  0.00e+00  0.00e+00  1.17e-03  3.63e-03]
 [ 0.00e+00  0.00e+00  2.53e-03 -1.80e-03  3.75e-03]
 [ 0.00e+00  8.02e-04  1.02e-03 -2.23e-03 -1.56e-03]
 [-4.55e-03 -4.72e-03  1.58e-03  5.34e-03 -5.99e-03]]
[[-9.07e-03  3.22e-02 -3.80e-02  1.19e-02 -1.52e-03]
 [ 4.02e-02 -1.42e-01  1.73e-01 -6.27e-02  1.01e-02]
 [-1.69e-01  1.65e+00 -2.92e+00  1.54e+00 -1.28e-01]
 [ 4.52e-02 -1.70e-01  2.26e-01 -1.04e-01  2.14e-02]
 [-1.00e-02  3.92e-02 -5.36e-02  2.49e-02 -5.05e-03]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00 -7.74e-04]
 [ 0.00e+00  1.00e+00  0.00e+00 -2.83e-03  1.68e-03]
 [ 0.00e+00  0.00e+00  1.48e-03  6.08e-04 -2.49e-03]
 [ 0.00e+00 -2.38e-03  2.71e-04  4.58e-03 -1.90e-03]
 [ 7.42e-05  8.76e-04 -1.94e-03  2.87e-04  2.60e-03]]
[[ 0.01 -0.08  0.03  0.04 -0.  ]
 [-0.08  0.53 -0.13 -0.37  0.04]
 [ 0.02 -0.11  0.17 -0.1   0.02]
 [ 0.05 -0.4  -0.09  0.51 -0.07]
 [-0.01  0.05  0.02 -0.07  0.01]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  2.28e-03]
 [ 0.00e+00  0.00e+00  0.00e+00  7.58e-04  9.03e-04]
 [ 1.00e+00  0.00e+00  2.65e-03  8.84e-04 -1.87e-03]
 [ 0.00e+00 -7.39e-04  5.98e-04 -4.41e-04  8.44e-04]
 [-7.08e-03 -2.22e-04  1.23e-03 -2.69e-04 -1.46e-03]]
[[-1.67e-03  7.39e-03 -1.02e-01  7.70e-03 -1.75e-03]
 [ 3.00e-03 -1.42e-02  1.39e+00 -1.66e-02  4.29e-03]
 [-5.11e-05  5.24e-03 -2.56e+00  1.11e-02 -3.65e-03]
 [ 1.80e-03 -1.29e-02  1.39e+00 -1.72e-02  4.73e-03]
 [-8.00e-04  5.34e-03 -9.94e-02  5.80e-03 -1.33e-03]]
SymNet parameters
[[ 9.12e-01  1.17e+00  1.35e+00 -4.36e-01 -2.69e-01  8.70e-02  2.78e+00  5.47e-01
  -4.83e-01  4.40e-03 -2.25e-02 -6.81e-02]
 [ 4.11e-01 -1.64e-03 -6.82e-03  3.16e-03  2.54e-03  1.11e-03 -2.80e-02  3.17e-03
  -4.06e-03 -3.40e-04 -3.78e-04  1.06e-03]]
SymNet parameters
[-0.43  1.22]
SymNet parameters
[[-2.19e-03 -7.74e-01  5.11e-02 -4.93e-02 -3.73e-02  1.16e-02  1.24e+00  6.27e-02
  -5.59e-02  1.00e-03 -2.95e-03 -1.02e-02  1.04e-03]
 [ 1.52e+00  1.40e-01 -2.46e-01 -2.59e-02 -1.08e-02 -4.20e-03  1.02e-02  7.58e-04
  -2.01e-03  2.30e-03 -2.18e-03 -1.87e-03 -4.90e-02]]
SymNet parameters
[ 0.07 -0.84]
SymNet parameters
[[ 9.82e-01  7.79e-01  1.40e+00 -5.72e-01 -2.47e-01  9.67e-02  3.97e+00  6.83e-01
  -5.89e-01  9.25e-03 -2.89e-02 -8.30e-02 -6.46e-03 -4.37e-03]
 [ 1.74e-01  1.01e-03 -9.32e-03  1.54e-03  1.55e-03  1.45e-03 -1.68e-02  1.47e-03
  -3.68e-04 -2.96e-04 -1.34e-04  4.74e-04  5.71e-04 -1.14e-03]]
SymNet parameters
[0.04 0.68]
SymNet parameters
[[-1.57e-01  6.23e-02  8.85e-03 -1.76e-03  5.37e-03  2.55e-03  1.08e+00  2.26e-02
  -2.48e-02  1.23e-04  3.34e-04 -3.53e-03  5.32e-02  2.21e-03 -1.19e-01]
 [ 1.04e+00 -2.17e-01  1.07e+00 -9.93e-02 -1.41e-02  1.48e-02  9.03e-01  1.49e-01
  -1.29e-01  1.68e-03 -4.71e-03 -1.56e-02  3.38e-01  4.76e-02 -7.47e-01]]
SymNet parameters
[0.85 0.37]
SymNet parameters
[[ 1.5  -1.24  1.99  0.37  0.05 -0.01  2.79 -0.25  0.27 -0.02  0.03  0.01 -0.25  0.1
   1.52 -0.67]
 [ 0.99  3.11  0.21 -0.07 -0.02 -0.08 -1.97 -0.67  0.67  0.02 -0.01  0.04 -0.64 -0.01
   1.09 -0.13]]
SymNet parameters
[-0.07 -0.19]
SymNet parameters
[[ 0.89 -0.03  1.29 -0.16 -0.12  0.09  2.07  0.29 -0.26  0.   -0.01 -0.04 -0.23  0.62
  -0.18 -0.91 -0.01]]
SymNet parameters
[0.05]
SymNet parameters
[[-8.74e-01  6.38e-01 -1.71e-01  3.66e-02 -3.16e-02 -2.50e-02  2.50e+00 -9.38e-01
   1.04e+00 -2.69e-01 -2.67e-02 -2.18e-01]
 [-1.07e-02 -1.84e-06 -6.48e-04  2.85e-04 -1.35e-04  2.40e-04  7.65e-04 -4.84e-04
   1.19e-03  8.61e-05  6.17e-05  4.87e-04]]
SymNet parameters
[ 0.51 -0.19]
SymNet parameters
[[ 7.03e-01 -2.24e-01  8.86e-02 -1.80e-02  1.25e-02  3.25e-03 -7.15e-01  7.75e-01
  -1.44e-01  8.66e-02 -3.81e-02  6.79e-02 -1.00e+00]
 [ 8.29e-02 -1.94e-01  2.27e-02  8.95e-03 -1.85e-03 -6.18e-03  3.14e+00  3.03e-01
  -2.46e-01 -4.11e-02  1.77e-02 -9.48e-04 -2.82e-01]]
SymNet parameters
[ 0.16 -0.57]
SymNet parameters
[[-0.43  0.06 -0.01  0.01 -0.   -0.    0.14 -0.35 -0.01 -0.03 -0.   -0.02  0.56  0.  ]
 [ 0.77 -0.02  0.08 -0.    0.    0.   -0.25 -0.1   0.07  0.01  0.01  0.01 -0.32 -0.01]]
SymNet parameters
[0.04 0.75]
SymNet parameters
[[ 0.29 -0.23  0.06 -0.01  0.01  0.01 -0.85 -0.33  0.41  0.1   0.01  0.08 -1.82 -0.04
   0.32]
 [-0.17 -0.07  0.03 -0.01  0.    0.    0.92  0.46  0.01  0.03  0.    0.03 -0.64  0.01
  -0.  ]]
SymNet parameters
[0.53 0.5 ]
SymNet parameters
[[ 1.49e+00  1.54e-01  2.11e-03  7.46e-03 -7.96e-03 -8.19e-03  1.82e+00  4.27e-02
  -7.41e-02 -6.84e-02  1.96e-03 -5.12e-02  1.18e+00  5.23e-03 -1.07e-01  2.08e-03]
 [ 9.57e-01 -3.50e-01  1.29e-01 -2.66e-02  1.88e-02  1.21e-02 -1.49e+00  2.10e+00
   8.74e-03  1.48e-01  1.63e-02  1.25e-01 -2.96e+00  6.48e-02  1.04e-01  2.92e-02]]
SymNet parameters
[0.27 0.42]
SymNet parameters
[[ 0.17 -0.13  0.05 -0.    0.    0.    0.39  0.02  0.06  0.11  0.01  0.09 -1.03  0.02
  -1.03 -0.79 -0.36]]
SymNet parameters
[0.25]
finally, finish this stage
iter:     0    time: 58.12
Func: 2.22e-01  |g|: 4.16e+01
stableloss: 3.37e-02   dataloss: 1.95e-01   sparseloss: 1.09e+02 momentloss: 6.73e+00
current expression:
[u10*v00, u00*u01, u20, u02, u00*u01**2, u01*u10*v00, u00*u11*v00, u10*v00*v10, u10*v00*v01, u00, v00, u00**2*v00, u00*u10*v01, u00*u10*v10, u20*v00**2, u00**2*u02, u00*v00*v01, v00**2*v01, u00**3, u00*u01*v00**2]
[-0.98 -0.98  0.05  0.05  0.01  0.01  0.01  0.01 -0.01  0.    0.   -0.    0.   -0.
  0.    0.    0.    0.   -0.    0.  ]
[v00*v10, u00*v01, v02, v20, v00*v10**2, u00*v01*v10, u00*v00*v11, u10*v00*v01, u00*u01*v01, v00, v00**3, u00**2*v02, u10, v00**2*v20, 1, u00*u10, u00*u01, u00*v00, u01*v00*v10, v01*v10]
[-0.99 -0.98  0.05  0.05  0.01  0.01  0.01  0.01  0.01  0.01 -0.    0.   -0.    0.
  0.   -0.    0.   -0.    0.    0.  ]
block:  5
name:  burgers-2-upwind-sparse0-noise0.001-id6
device:  cuda:2
generate a random number to check random seed:  0.29692456722513555
current stage is: block-5
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.9327, device='cuda:2', dtype=torch.float64)
u_obs variance
tensor([ 0.2595,  1.7307,  1.5547, 22.8581,  8.9614, 18.5219,  0.2408,  1.4710,
         1.5753, 17.5000,  8.9902, 20.7173], device='cuda:2',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 0.319752
         Iterations: 0
         Function evaluations: 15
         Gradient evaluations: 3
convolution moment and kernels
[[ 1.00e+00  0.00e+00 -8.63e-05 -9.75e-03  2.17e-03]
 [ 0.00e+00  3.16e-06 -3.97e-03  2.59e-03  2.66e-02]
 [-1.55e-04  5.28e-03  5.51e-03 -3.48e-03  7.74e-02]
 [-3.93e-04  5.01e-05 -2.82e-03 -3.07e-03  3.75e-02]
 [-1.10e-01  2.60e-02 -5.09e-02 -5.74e-03  1.47e-02]]
[[-1.21e-04 -5.46e-02 -3.36e-02 -1.31e-02 -8.08e-03]
 [ 3.18e-02  1.02e-01  2.97e-01 -5.41e-02  6.15e-02]
 [-4.70e-02 -1.44e-01  5.21e-01  1.18e-01 -1.06e-01]
 [-1.26e-02  2.71e-01  5.93e-02  9.50e-02  2.67e-02]
 [ 3.49e-02 -1.93e-01  1.70e-01 -1.45e-01  2.34e-02]]
[[ 0.00e+00  1.00e+00  0.00e+00 -9.04e-02 -2.74e-02]
 [ 0.00e+00  0.00e+00  3.53e-03 -4.82e-03  6.50e-03]
 [ 0.00e+00  2.92e-02  8.11e-03  3.80e-02  1.92e-02]
 [-4.84e-03  7.57e-05  4.26e-03  3.72e-03  8.90e-03]
 [ 7.79e-03 -1.93e-03 -4.63e-03  4.90e-03  3.90e-03]]
[[-1.12e-03 -6.76e-04  1.84e-02 -5.47e-03 -9.17e-04]
 [-3.20e-03 -9.59e-03 -2.68e-02 -2.35e-02  2.71e-02]
 [ 1.06e-01 -6.22e-01 -1.45e-01  9.10e-01 -2.02e-01]
 [-5.10e-03  8.11e-03 -6.24e-02  2.17e-02  1.13e-02]
 [ 4.14e-03 -2.26e-02  5.13e-02 -3.63e-02  8.85e-03]]
[[ 0.00e+00  0.00e+00  0.00e+00 -4.54e-04 -1.70e-03]
 [ 1.00e+00  0.00e+00  2.33e-02 -1.31e-03 -1.69e-02]
 [ 0.00e+00 -2.88e-03  1.34e-02 -4.29e-03 -2.45e-03]
 [-7.40e-02 -3.51e-03  5.86e-02  1.68e-03 -1.12e-03]
 [-5.20e-02 -9.94e-04 -1.38e-03  3.57e-04 -4.52e-04]]
[[ 1.59e-03 -3.64e-02  1.36e-01 -3.45e-02  1.19e-03]
 [ 5.16e-03  5.16e-02 -6.47e-01  5.63e-02  1.14e-03]
 [-9.19e-04 -5.10e-02 -1.97e-01 -7.42e-02  1.13e-02]
 [-4.80e-03  8.00e-03  9.28e-01  3.23e-02 -1.51e-02]
 [-2.51e-03  3.41e-02 -2.31e-01  2.74e-02 -4.29e-04]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00 -1.93e-02]
 [ 0.00e+00  0.00e+00  0.00e+00  1.17e-03  3.63e-03]
 [ 0.00e+00  0.00e+00  2.53e-03 -1.80e-03  3.75e-03]
 [ 0.00e+00  8.02e-04  1.02e-03 -2.23e-03 -1.56e-03]
 [-4.55e-03 -4.72e-03  1.58e-03  5.34e-03 -5.99e-03]]
[[-9.07e-03  3.22e-02 -3.80e-02  1.19e-02 -1.52e-03]
 [ 4.02e-02 -1.42e-01  1.73e-01 -6.27e-02  1.01e-02]
 [-1.69e-01  1.65e+00 -2.92e+00  1.54e+00 -1.28e-01]
 [ 4.52e-02 -1.70e-01  2.26e-01 -1.04e-01  2.14e-02]
 [-1.00e-02  3.92e-02 -5.36e-02  2.49e-02 -5.05e-03]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00 -7.74e-04]
 [ 0.00e+00  1.00e+00  0.00e+00 -2.83e-03  1.68e-03]
 [ 0.00e+00  0.00e+00  1.48e-03  6.08e-04 -2.49e-03]
 [ 0.00e+00 -2.38e-03  2.71e-04  4.58e-03 -1.90e-03]
 [ 7.41e-05  8.76e-04 -1.94e-03  2.87e-04  2.60e-03]]
[[ 0.01 -0.08  0.03  0.04 -0.  ]
 [-0.08  0.53 -0.13 -0.37  0.04]
 [ 0.02 -0.11  0.17 -0.1   0.02]
 [ 0.05 -0.4  -0.09  0.51 -0.07]
 [-0.01  0.05  0.02 -0.07  0.01]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  2.28e-03]
 [ 0.00e+00  0.00e+00  0.00e+00  7.58e-04  9.03e-04]
 [ 1.00e+00  0.00e+00  2.65e-03  8.84e-04 -1.87e-03]
 [ 0.00e+00 -7.39e-04  5.98e-04 -4.41e-04  8.43e-04]
 [-7.08e-03 -2.21e-04  1.23e-03 -2.69e-04 -1.46e-03]]
[[-1.67e-03  7.39e-03 -1.02e-01  7.70e-03 -1.75e-03]
 [ 3.01e-03 -1.42e-02  1.39e+00 -1.66e-02  4.29e-03]
 [-5.53e-05  5.26e-03 -2.56e+00  1.11e-02 -3.66e-03]
 [ 1.80e-03 -1.29e-02  1.39e+00 -1.72e-02  4.73e-03]
 [-8.01e-04  5.34e-03 -9.94e-02  5.80e-03 -1.33e-03]]
SymNet parameters
[[ 9.12e-01  1.17e+00  1.35e+00 -4.36e-01 -2.69e-01  8.71e-02  2.78e+00  5.47e-01
  -4.83e-01  4.40e-03 -2.25e-02 -6.81e-02]
 [ 4.11e-01 -1.65e-03 -6.82e-03  3.19e-03  2.55e-03  1.13e-03 -2.80e-02  3.17e-03
  -4.06e-03 -3.45e-04 -3.61e-04  1.07e-03]]
SymNet parameters
[-0.43  1.22]
SymNet parameters
[[-2.19e-03 -7.74e-01  5.11e-02 -4.93e-02 -3.73e-02  1.16e-02  1.24e+00  6.27e-02
  -5.59e-02  1.00e-03 -2.95e-03 -1.02e-02  1.05e-03]
 [ 1.52e+00  1.40e-01 -2.46e-01 -2.59e-02 -1.08e-02 -4.20e-03  1.02e-02  7.57e-04
  -2.02e-03  2.30e-03 -2.18e-03 -1.88e-03 -4.90e-02]]
SymNet parameters
[ 0.07 -0.84]
SymNet parameters
[[ 9.82e-01  7.79e-01  1.40e+00 -5.72e-01 -2.47e-01  9.67e-02  3.97e+00  6.83e-01
  -5.89e-01  9.26e-03 -2.89e-02 -8.30e-02 -6.46e-03 -4.37e-03]
 [ 1.74e-01  1.01e-03 -9.32e-03  1.50e-03  1.53e-03  1.39e-03 -1.68e-02  1.48e-03
  -3.67e-04 -2.85e-04 -1.65e-04  4.42e-04  6.28e-04 -1.18e-03]]
SymNet parameters
[0.04 0.68]
SymNet parameters
[[-1.57e-01  6.23e-02  8.85e-03 -1.77e-03  5.37e-03  2.55e-03  1.08e+00  2.26e-02
  -2.48e-02  1.27e-04  3.38e-04 -3.54e-03  5.32e-02  2.22e-03 -1.19e-01]
 [ 1.04e+00 -2.17e-01  1.07e+00 -9.93e-02 -1.41e-02  1.48e-02  9.03e-01  1.49e-01
  -1.29e-01  1.68e-03 -4.71e-03 -1.56e-02  3.38e-01  4.76e-02 -7.47e-01]]
SymNet parameters
[0.85 0.37]
SymNet parameters
[[ 1.5  -1.24  1.99  0.37  0.05 -0.01  2.79 -0.25  0.27 -0.02  0.03  0.01 -0.25  0.1
   1.52 -0.67]
 [ 0.99  3.11  0.21 -0.07 -0.02 -0.08 -1.97 -0.67  0.67  0.02 -0.01  0.04 -0.64 -0.01
   1.09 -0.13]]
SymNet parameters
[-0.07 -0.19]
SymNet parameters
[[ 0.89 -0.03  1.29 -0.16 -0.12  0.09  2.07  0.29 -0.26  0.   -0.01 -0.04 -0.23  0.62
  -0.18 -0.91 -0.01]]
SymNet parameters
[0.05]
SymNet parameters
[[-8.74e-01  6.38e-01 -1.71e-01  3.66e-02 -3.16e-02 -2.50e-02  2.50e+00 -9.38e-01
   1.04e+00 -2.69e-01 -2.67e-02 -2.18e-01]
 [-1.07e-02 -1.18e-05 -6.42e-04  1.70e-04 -5.77e-05  1.93e-04  7.38e-04 -4.79e-04
   1.19e-03  2.03e-04  7.19e-05  5.42e-04]]
SymNet parameters
[ 0.51 -0.19]
SymNet parameters
[[ 7.03e-01 -2.24e-01  8.86e-02 -1.80e-02  1.25e-02  3.25e-03 -7.15e-01  7.75e-01
  -1.44e-01  8.66e-02 -3.81e-02  6.79e-02 -1.00e+00]
 [ 8.29e-02 -1.94e-01  2.27e-02  8.95e-03 -1.85e-03 -6.18e-03  3.14e+00  3.03e-01
  -2.46e-01 -4.11e-02  1.77e-02 -9.47e-04 -2.82e-01]]
SymNet parameters
[ 0.16 -0.57]
SymNet parameters
[[-0.43  0.06 -0.01  0.01 -0.   -0.    0.14 -0.35 -0.01 -0.03 -0.   -0.02  0.56  0.  ]
 [ 0.77 -0.02  0.08 -0.    0.    0.   -0.25 -0.1   0.07  0.01  0.01  0.01 -0.32 -0.01]]
SymNet parameters
[0.04 0.75]
SymNet parameters
[[ 0.29 -0.23  0.06 -0.01  0.01  0.01 -0.85 -0.33  0.41  0.1   0.01  0.08 -1.82 -0.04
   0.32]
 [-0.17 -0.07  0.03 -0.01  0.    0.    0.92  0.46  0.01  0.03  0.    0.03 -0.64  0.01
  -0.  ]]
SymNet parameters
[0.53 0.5 ]
SymNet parameters
[[ 1.49e+00  1.54e-01  2.11e-03  7.46e-03 -7.96e-03 -8.19e-03  1.82e+00  4.27e-02
  -7.41e-02 -6.84e-02  1.96e-03 -5.12e-02  1.18e+00  5.22e-03 -1.07e-01  2.08e-03]
 [ 9.57e-01 -3.50e-01  1.29e-01 -2.66e-02  1.88e-02  1.21e-02 -1.49e+00  2.10e+00
   8.75e-03  1.48e-01  1.63e-02  1.25e-01 -2.96e+00  6.48e-02  1.04e-01  2.92e-02]]
SymNet parameters
[0.27 0.42]
SymNet parameters
[[ 0.17 -0.13  0.05 -0.    0.    0.    0.39  0.02  0.06  0.11  0.01  0.09 -1.03  0.02
  -1.03 -0.79 -0.36]]
SymNet parameters
[0.25]
finally, finish this stage
iter:     0    time: 56.15
Func: 3.20e-01  |g|: 4.93e+01
stableloss: 3.74e-02   dataloss: 2.86e-01   sparseloss: 1.09e+02 momentloss: 6.73e+00
current expression:
[u10*v00, u00*u01, u20, u02, u00*u01**2, u01*u10*v00, u00*u11*v00, u10*v00*v10, u10*v00*v01, u00, v00, u00**2*v00, u00*u10*v01, u00*u10*v10, u20*v00**2, u00**2*u02, u00*v00*v01, v00**2*v01, u00**3, u00*u01*v00**2]
[-0.98 -0.98  0.05  0.05  0.01  0.01  0.01  0.01 -0.01  0.    0.   -0.    0.   -0.
  0.    0.    0.    0.   -0.    0.  ]
[v00*v10, u00*v01, v02, v20, v00*v10**2, u00*v01*v10, u00*v00*v11, u10*v00*v01, u00*u01*v01, v00, v00**3, u00**2*v02, u10, v00**2*v20, 1, u00*u10, u00*u01, u00*v00, u01*v00*v10, v01*v10]
[-0.99 -0.98  0.05  0.05  0.01  0.01  0.01  0.01  0.01  0.01 -0.    0.   -0.    0.
  0.   -0.    0.   -0.    0.    0.  ]
block:  6
name:  burgers-2-upwind-sparse0-noise0.001-id6
device:  cuda:2
generate a random number to check random seed:  1.8496489946007966
current stage is: block-6
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.9646, device='cuda:2', dtype=torch.float64)
u_obs variance
tensor([ 0.2545,  1.6365,  1.6434, 23.2047, 10.3729, 19.7592,  0.2465,  1.6051,
         1.6267, 19.8692,  9.4582, 21.9291], device='cuda:2',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
iter:     0    time: 60.71
Func: 7.40e-01  |g|: 7.20e+01
stableloss: 3.65e-02   dataloss: 7.00e-01   sparseloss: 1.09e+02 momentloss: 6.73e+00
iter:   200    time: 42.79
Func: 6.06e-01  |g|: 3.16e+00
stableloss: 3.72e-02   dataloss: 5.59e-01   sparseloss: 1.08e+02 momentloss: 7.86e+00
iter:   400    time: 41.06
Func: 5.98e-01  |g|: 1.13e+00
stableloss: 3.72e-02   dataloss: 5.50e-01   sparseloss: 1.10e+02 momentloss: 7.99e+00
iter:   600    time: 39.86
Func: 5.95e-01  |g|: 1.35e+00
stableloss: 3.70e-02   dataloss: 5.47e-01   sparseloss: 1.12e+02 momentloss: 8.06e+00
iter:   800    time: 31.24
Func: 5.94e-01  |g|: 1.01e+00
stableloss: 3.68e-02   dataloss: 5.45e-01   sparseloss: 1.23e+02 momentloss: 8.15e+00
iter:  1000    time: 31.15
Func: 5.92e-01  |g|: 2.19e+00
stableloss: 3.69e-02   dataloss: 5.44e-01   sparseloss: 1.38e+02 momentloss: 7.98e+00
iter:  1200    time: 31.48
Func: 5.90e-01  |g|: 1.02e+00
stableloss: 3.69e-02   dataloss: 5.43e-01   sparseloss: 1.46e+02 momentloss: 7.89e+00
iter:  1400    time: 31.36
Func: 5.89e-01  |g|: 2.71e+00
stableloss: 3.70e-02   dataloss: 5.41e-01   sparseloss: 1.49e+02 momentloss: 7.88e+00
iter:  1600    time: 31.20
Func: 5.86e-01  |g|: 1.57e+00
stableloss: 3.69e-02   dataloss: 5.38e-01   sparseloss: 1.51e+02 momentloss: 7.94e+00
iter:  1800    time: 31.37
Func: 5.85e-01  |g|: 3.54e-01
stableloss: 3.68e-02   dataloss: 5.38e-01   sparseloss: 1.50e+02 momentloss: 7.95e+00
Warning: Maximum number of iterations has been exceeded.
         Current function value: 0.585037
         Iterations: 2000
         Function evaluations: 2022
         Gradient evaluations: 2011
convolution moment and kernels
[[ 1.00e+00  0.00e+00  5.21e-04 -2.28e-03 -1.02e-01]
 [ 0.00e+00  1.34e-03 -5.40e-03  2.55e-03 -3.51e-02]
 [ 1.74e-04 -9.05e-03  4.04e-02  9.65e-03 -7.98e-03]
 [ 4.85e-02 -5.46e-03 -1.78e-02  4.78e-03 -3.56e-02]
 [-9.15e-02 -3.94e-02  1.77e-02 -3.37e-02  5.22e-03]]
[[ 0.03 -0.07 -0.05 -0.04  0.  ]
 [-0.1   0.19  0.23  0.08  0.02]
 [ 0.05  0.12  0.13  0.3  -0.15]
 [-0.08  0.12  0.21  0.03  0.04]
 [ 0.    0.04 -0.14  0.05 -0.02]]
[[ 0.00e+00  1.00e+00  0.00e+00 -1.03e-01 -6.48e-02]
 [ 0.00e+00  0.00e+00  2.37e-03  3.40e-03  8.75e-03]
 [ 0.00e+00  2.48e-02  1.44e-02  3.75e-02  7.42e-04]
 [ 4.74e-04  3.12e-03 -1.32e-02  7.59e-04 -9.53e-03]
 [-2.12e-04 -2.65e-02 -4.98e-03 -9.35e-03  8.05e-04]]
[[ 9.96e-03 -1.66e-02  3.54e-02 -3.16e-02  2.41e-03]
 [-5.07e-02  9.38e-02 -1.65e-01  1.12e-01  1.15e-02]
 [ 1.35e-01 -6.13e-01 -2.08e-01  9.32e-01 -2.48e-01]
 [-2.45e-02  1.76e-02 -5.55e-02  2.10e-02  4.18e-02]
 [ 2.73e-04  7.33e-03  3.98e-03 -3.95e-03 -7.61e-03]]
[[ 0.00e+00  0.00e+00  0.00e+00  1.12e-03  5.31e-03]
 [ 1.00e+00  0.00e+00  3.44e-02  3.97e-03 -1.30e-02]
 [ 0.00e+00 -3.61e-03  1.22e-02  3.48e-03  2.71e-03]
 [-8.33e-02 -7.67e-03  5.04e-02 -7.21e-04 -3.71e-03]
 [-4.98e-02 -1.43e-02  6.14e-03 -5.44e-03  1.68e-03]]
[[ 5.33e-03 -3.01e-02  1.32e-01 -3.36e-02  1.98e-03]
 [-7.51e-03  1.13e-02 -5.88e-01  2.50e-02  8.06e-03]
 [ 2.18e-02 -1.51e-02 -2.63e-01 -3.71e-02 -5.62e-03]
 [-1.50e-02 -2.56e-02  9.90e-01 -4.99e-03  4.77e-03]
 [ 1.20e-04  3.94e-02 -2.39e-01  2.84e-02 -3.33e-03]]
[[ 0.    0.    1.    0.   -0.03]
 [ 0.    0.    0.   -0.01 -0.  ]
 [ 0.    0.   -0.    0.    0.  ]
 [ 0.   -0.    0.01  0.    0.01]
 [ 0.13 -0.01  0.01  0.02 -0.02]]
[[-2.89e-02  1.02e-01  5.56e-03  5.66e-02 -8.96e-03]
 [ 1.11e-01 -4.05e-01 -2.04e-02 -2.26e-01  3.48e-02]
 [-2.71e-01  2.03e+00 -2.59e+00  1.74e+00 -1.48e-01]
 [ 1.03e-01 -3.79e-01 -8.03e-02 -1.62e-01  1.32e-02]
 [-2.46e-02  9.08e-02  2.78e-02  3.36e-02 -1.16e-03]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  4.37e-03]
 [ 0.00e+00  1.00e+00  0.00e+00 -4.40e-03  2.34e-01]
 [ 0.00e+00  0.00e+00 -9.54e-04 -7.02e-03 -2.61e-03]
 [ 0.00e+00 -2.97e-03 -1.94e-01  1.47e-01  5.83e-03]
 [-1.55e-03  1.01e-01  4.42e-03  1.30e-02 -5.58e-03]]
[[ 0.05 -0.09 -0.19  0.27 -0.04]
 [-0.25  1.05 -0.25 -0.56  0.02]
 [-0.02 -0.18 -0.22  0.44 -0.03]
 [ 0.28 -0.83  0.58 -0.05  0.03]
 [-0.06  0.04  0.1  -0.11  0.03]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  1.05e-01]
 [ 0.00e+00  0.00e+00  0.00e+00 -6.87e-03 -1.75e-02]
 [ 1.00e+00  0.00e+00 -2.08e-03  7.94e-03 -2.24e-03]
 [ 0.00e+00 -3.29e-03  2.15e-02  2.68e-04  3.37e-03]
 [-6.56e-02  6.82e-03  3.72e-03 -6.04e-03  2.71e-03]]
[[ 4.73e-03 -2.12e-02 -1.33e-01  4.90e-03 -4.09e-03]
 [-2.15e-02  6.03e-02  1.59e+00 -5.96e-02  2.32e-02]
 [ 1.56e-01 -5.53e-01 -2.20e+00 -3.86e-01  9.28e-02]
 [-4.25e-02  1.09e-01  1.52e+00  1.72e-02 -8.62e-03]
 [ 8.24e-03 -1.40e-02 -1.49e-01  4.84e-03  1.39e-03]]
SymNet parameters
[[-1.16e-01  1.81e+00  5.89e-01 -2.58e-01 -1.72e-01 -3.69e-02  6.19e+00  3.61e-01
  -8.56e-01 -2.24e-02  5.92e-02 -5.93e-02]
 [ 2.35e-01 -3.29e-03  1.45e-02  5.09e-03  2.47e-03 -4.64e-04  1.90e-03  4.16e-03
  -1.46e-02  1.60e-04 -9.15e-04 -6.53e-04]]
SymNet parameters
[-0.55  1.07]
SymNet parameters
[[-2.10e-01 -3.83e-01  1.83e-02 -5.56e-02 -1.96e-02 -7.74e-03  1.69e+00  2.09e-02
  -4.37e-02 -4.57e-03  9.70e-03 -5.40e-03 -2.22e-02]
 [ 1.52e+00  1.57e-01 -2.81e-01  1.55e-03 -4.95e-03 -1.22e-03  3.70e-01 -1.29e-02
   3.46e-02  6.15e-04 -9.37e-05  8.21e-04 -5.76e-02]]
SymNet parameters
[ 1.43 -0.29]
SymNet parameters
[[-1.61e-01  1.07e+00  6.66e-01 -4.36e-01 -3.87e-02 -5.74e-02  7.13e+00  2.83e-01
  -6.45e-01 -3.28e-02  8.02e-02 -3.83e-02 -1.01e-01  5.97e-02]
 [ 5.37e-02  5.34e-04 -1.16e-04  1.12e-03  3.90e-04  4.61e-04  9.75e-04  5.94e-04
  -2.39e-03 -2.37e-05 -2.43e-04 -1.03e-04 -8.43e-05 -1.78e-04]]
SymNet parameters
[-0.11  0.4 ]
SymNet parameters
[[-9.76e-02  1.05e-01 -9.61e-03  1.37e-02  1.67e-02  1.95e-03  1.34e+00 -3.10e-03
  -1.04e-02 -1.67e-03 -2.75e-03 -7.80e-04  2.31e-02 -4.37e-03 -1.56e-01]
 [ 1.59e-01  9.62e-02  5.31e-01 -1.02e-01  9.86e-03 -1.49e-02  1.47e+00  1.85e-02
  -2.22e-02 -6.81e-03  1.76e-02 -5.87e-04  8.02e-02  3.41e-02 -7.97e-01]]
SymNet parameters
[-1.22 -0.6 ]
SymNet parameters
[[ 4.27e+00 -5.58e-01  6.04e-01 -2.42e-02 -2.21e-01  2.54e-03 -2.65e+00  1.09e-01
  -2.71e-01  1.09e-02  5.44e-03 -3.03e-02 -4.44e-01  1.69e-01  3.17e+00 -6.84e-01]
 [-2.36e+00  2.25e+00  2.74e-01  8.68e-02 -1.13e-01  6.17e-04 -8.23e-01 -5.63e-01
   1.46e+00  2.03e-02 -2.40e-02  6.27e-02 -2.79e-01 -1.53e-02  1.64e+00  1.07e-02]]
SymNet parameters
[0.94 1.45]
SymNet parameters
[[-1.95  1.29  0.31 -0.3  -0.15  0.01  5.26  0.4  -0.94 -0.03  0.07 -0.06 -0.64  0.72
  -0.55 -1.3  -0.02]]
SymNet parameters
[0.9]
SymNet parameters
[[-1.90e-01  4.78e-01  3.33e-02  7.79e-03 -1.76e-04 -5.10e-03  5.45e+00 -1.26e-01
   3.56e-01 -6.08e-02  2.93e-02  2.17e-03]
 [-5.11e-03  2.87e-05 -4.35e-04  2.36e-05 -1.47e-07  7.55e-06  1.09e-04  4.37e-05
   1.43e-04  1.21e-05 -8.26e-06  1.36e-06]]
SymNet parameters
[-2.7  -0.19]
SymNet parameters
[[ 4.40e-01 -7.56e-02 -2.07e-02 -1.03e-02  1.18e-03  2.06e-03 -7.67e-01  2.01e-01
   1.11e-01  1.02e-02 -2.38e-02 -4.37e-03 -7.70e-01]
 [ 3.49e-02  8.98e-02  5.67e-03  3.65e-03 -1.48e-03 -4.20e-03  2.77e+00 -8.64e-02
   7.03e-02 -4.43e-02  1.27e-02  2.30e-03  1.32e+00]]
SymNet parameters
[-0.16 -2.92]
SymNet parameters
[[-1.39e-01  5.61e-03  2.69e-03  1.48e-03 -2.78e-04 -9.83e-04  4.77e-02  2.09e-02
  -2.14e-02 -8.79e-04 -1.08e-03  8.47e-03  5.81e-02  1.39e-02]
 [ 5.84e-01  1.65e-02  3.06e-03 -4.98e-03  4.61e-05 -2.05e-03  1.51e-01 -7.75e-02
   6.09e-02 -9.42e-04  1.02e-02  2.96e-02  2.19e-01 -2.52e-02]]
SymNet parameters
[-0.05  1.28]
SymNet parameters
[[ 6.79e-01 -9.98e-02 -4.36e-03 -8.14e-03  1.25e-03  5.24e-03 -1.14e+00 -2.39e-01
   1.68e+00  1.40e-02  1.48e-03 -3.84e-02 -1.11e+00 -1.18e-01  3.30e+00]
 [ 4.39e-01 -6.62e-02 -6.42e-03 -3.78e-03 -6.04e-05  4.69e-04  1.67e+00  7.97e-01
  -1.18e-01  4.04e-03 -9.03e-03  1.20e-03 -7.42e-01  1.07e-01 -1.60e-01]]
SymNet parameters
[ 1.33 -0.39]
SymNet parameters
[[ 8.29e-01  4.49e-01  2.96e-02  7.18e-03 -7.43e-04 -6.91e-03  5.25e+00 -5.50e-02
  -7.48e-02 -5.81e-02  2.55e-02  1.02e-02  5.01e+00  3.42e-02 -7.37e-01 -2.20e-04]
 [ 5.08e-01 -2.45e-01 -2.82e-02 -1.25e-02  1.47e-03  3.11e-03 -2.26e+00  2.14e+00
  -2.95e-01  2.24e-02 -3.46e-02 -1.72e-03 -2.71e+00  5.06e-01 -3.75e-01  2.88e-03]]
SymNet parameters
[-1.34  1.87]
SymNet parameters
[[ 8.08e-01 -1.55e-01 -1.41e-02 -6.44e-03  4.81e-05  3.94e-04 -1.02e+00  1.37e+00
  -6.68e-01  6.34e-02 -2.40e-02  5.68e-02 -1.71e+00  3.41e-01 -1.04e+00 -2.61e-01
  -4.35e-01]]
SymNet parameters
[0.95]
finally, finish this stage
iter:  2000    time: 31.63
Func: 5.85e-01  |g|: 4.12e-01
stableloss: 3.68e-02   dataloss: 5.37e-01   sparseloss: 1.48e+02 momentloss: 7.96e+00
current expression:
[u10*v00, u00*u01, u20, u02, u00*u01**2, u10*v00*v10, u00*u11*v00, u01*u10*v00, u01*u10, u00*v00, u10*v01, u10*v00*v01, u10*v10, u20*v00**2, u00*u10*v10, u10*v00**2, u00**2*u01, u01, u01*v00**2, u00*u01*u10]
[-0.98 -0.98  0.05  0.05  0.02  0.01  0.01  0.01 -0.01  0.01  0.01 -0.   -0.    0.
 -0.    0.   -0.   -0.    0.    0.  ]
[v00*v10, u00*v01, v02, v20, v00*v10**2, u00*u01*v01, u00*v00*v11, u10*v00*v01, u00*v01*v10, v10**2, v10, u10*v01, v00, u00**2*v02, v00**2*v10, u10*v00*v10, u00*u10, v00**2*v20, u00**2, u10]
[-0.99 -0.97  0.05  0.05  0.02  0.01  0.01  0.01  0.01 -0.01  0.   -0.    0.    0.
  0.   -0.   -0.    0.    0.    0.  ]
block:  9
name:  burgers-2-upwind-sparse0-noise0.001-id6
device:  cuda:2
generate a random number to check random seed:  -2.2665616911689352
current stage is: block-9
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.8041, device='cuda:2', dtype=torch.float64)
u_obs variance
tensor([ 0.2436,  1.7609,  1.5953, 24.1212, 12.1612, 19.2275,  0.2526,  1.7137,
         1.6778, 19.9852, 11.2651, 23.4476], device='cuda:2',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 1.967815
         Iterations: 0
         Function evaluations: 15
         Gradient evaluations: 3
convolution moment and kernels
[[ 1.00e+00  0.00e+00  5.21e-04 -2.28e-03 -1.02e-01]
 [ 0.00e+00  1.34e-03 -5.40e-03  2.55e-03 -3.51e-02]
 [ 1.74e-04 -9.05e-03  4.04e-02  9.65e-03 -7.98e-03]
 [ 4.85e-02 -5.46e-03 -1.78e-02  4.78e-03 -3.56e-02]
 [-9.15e-02 -3.94e-02  1.77e-02 -3.37e-02  5.22e-03]]
[[ 0.03 -0.07 -0.05 -0.04  0.  ]
 [-0.1   0.19  0.23  0.08  0.02]
 [ 0.05  0.12  0.13  0.3  -0.15]
 [-0.08  0.12  0.21  0.03  0.04]
 [ 0.    0.04 -0.14  0.05 -0.02]]
[[ 0.00e+00  1.00e+00  0.00e+00 -1.03e-01 -6.48e-02]
 [ 0.00e+00  0.00e+00  2.37e-03  3.40e-03  8.75e-03]
 [ 0.00e+00  2.48e-02  1.44e-02  3.75e-02  7.42e-04]
 [ 4.75e-04  3.12e-03 -1.32e-02  7.59e-04 -9.53e-03]
 [-2.12e-04 -2.65e-02 -4.98e-03 -9.35e-03  8.05e-04]]
[[ 9.96e-03 -1.66e-02  3.54e-02 -3.16e-02  2.41e-03]
 [-5.07e-02  9.38e-02 -1.65e-01  1.12e-01  1.15e-02]
 [ 1.35e-01 -6.13e-01 -2.08e-01  9.32e-01 -2.48e-01]
 [-2.45e-02  1.76e-02 -5.55e-02  2.10e-02  4.18e-02]
 [ 2.73e-04  7.33e-03  3.98e-03 -3.95e-03 -7.61e-03]]
[[ 0.00e+00  0.00e+00  0.00e+00  1.12e-03  5.31e-03]
 [ 1.00e+00  0.00e+00  3.44e-02  3.97e-03 -1.30e-02]
 [ 0.00e+00 -3.62e-03  1.22e-02  3.48e-03  2.71e-03]
 [-8.33e-02 -7.67e-03  5.04e-02 -7.21e-04 -3.71e-03]
 [-4.98e-02 -1.43e-02  6.14e-03 -5.44e-03  1.68e-03]]
[[ 5.33e-03 -3.01e-02  1.32e-01 -3.36e-02  1.98e-03]
 [-7.51e-03  1.13e-02 -5.88e-01  2.49e-02  8.07e-03]
 [ 2.18e-02 -1.51e-02 -2.63e-01 -3.71e-02 -5.63e-03]
 [-1.50e-02 -2.56e-02  9.90e-01 -4.99e-03  4.77e-03]
 [ 1.21e-04  3.94e-02 -2.39e-01  2.84e-02 -3.33e-03]]
[[ 0.    0.    1.    0.   -0.03]
 [ 0.    0.    0.   -0.01 -0.  ]
 [ 0.    0.   -0.    0.    0.  ]
 [ 0.   -0.    0.01  0.    0.01]
 [ 0.13 -0.01  0.01  0.02 -0.02]]
[[-2.89e-02  1.02e-01  5.56e-03  5.66e-02 -8.96e-03]
 [ 1.11e-01 -4.05e-01 -2.04e-02 -2.26e-01  3.48e-02]
 [-2.71e-01  2.03e+00 -2.59e+00  1.74e+00 -1.48e-01]
 [ 1.03e-01 -3.79e-01 -8.03e-02 -1.62e-01  1.32e-02]
 [-2.46e-02  9.08e-02  2.78e-02  3.35e-02 -1.16e-03]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  4.37e-03]
 [ 0.00e+00  1.00e+00  0.00e+00 -4.40e-03  2.34e-01]
 [ 0.00e+00  0.00e+00 -9.54e-04 -7.02e-03 -2.61e-03]
 [ 0.00e+00 -2.97e-03 -1.94e-01  1.47e-01  5.83e-03]
 [-1.55e-03  1.01e-01  4.42e-03  1.30e-02 -5.58e-03]]
[[ 0.05 -0.09 -0.19  0.27 -0.04]
 [-0.25  1.05 -0.25 -0.56  0.02]
 [-0.02 -0.18 -0.22  0.44 -0.03]
 [ 0.28 -0.83  0.58 -0.05  0.03]
 [-0.06  0.04  0.1  -0.11  0.03]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  1.05e-01]
 [ 0.00e+00  0.00e+00  0.00e+00 -6.87e-03 -1.75e-02]
 [ 1.00e+00  0.00e+00 -2.08e-03  7.94e-03 -2.24e-03]
 [ 0.00e+00 -3.29e-03  2.15e-02  2.68e-04  3.37e-03]
 [-6.56e-02  6.82e-03  3.72e-03 -6.04e-03  2.71e-03]]
[[ 4.73e-03 -2.12e-02 -1.33e-01  4.90e-03 -4.09e-03]
 [-2.15e-02  6.03e-02  1.59e+00 -5.96e-02  2.32e-02]
 [ 1.56e-01 -5.53e-01 -2.20e+00 -3.86e-01  9.28e-02]
 [-4.25e-02  1.09e-01  1.52e+00  1.72e-02 -8.62e-03]
 [ 8.24e-03 -1.40e-02 -1.49e-01  4.84e-03  1.39e-03]]
SymNet parameters
[[-1.16e-01  1.81e+00  5.89e-01 -2.58e-01 -1.72e-01 -3.69e-02  6.19e+00  3.61e-01
  -8.56e-01 -2.24e-02  5.92e-02 -5.93e-02]
 [ 2.35e-01 -3.29e-03  1.45e-02  5.09e-03  2.47e-03 -4.66e-04  1.90e-03  4.16e-03
  -1.46e-02  1.60e-04 -9.09e-04 -6.56e-04]]
SymNet parameters
[-0.55  1.07]
SymNet parameters
[[-2.10e-01 -3.83e-01  1.83e-02 -5.56e-02 -1.96e-02 -7.74e-03  1.69e+00  2.09e-02
  -4.37e-02 -4.57e-03  9.70e-03 -5.40e-03 -2.22e-02]
 [ 1.52e+00  1.57e-01 -2.81e-01  1.55e-03 -4.95e-03 -1.22e-03  3.70e-01 -1.29e-02
   3.46e-02  6.08e-04 -9.39e-05  8.21e-04 -5.76e-02]]
SymNet parameters
[ 1.43 -0.29]
SymNet parameters
[[-1.61e-01  1.07e+00  6.66e-01 -4.36e-01 -3.87e-02 -5.74e-02  7.13e+00  2.83e-01
  -6.45e-01 -3.28e-02  8.02e-02 -3.83e-02 -1.01e-01  5.97e-02]
 [ 5.37e-02  5.17e-04 -1.30e-04  1.19e-03  3.82e-04  5.06e-04  9.40e-04  6.15e-04
  -2.37e-03  1.13e-04 -2.26e-04 -6.77e-05 -2.53e-04 -1.06e-04]]
SymNet parameters
[-0.11  0.4 ]
SymNet parameters
[[-9.76e-02  1.05e-01 -9.61e-03  1.37e-02  1.67e-02  1.96e-03  1.34e+00 -3.10e-03
  -1.04e-02 -1.67e-03 -2.75e-03 -7.80e-04  2.31e-02 -4.37e-03 -1.56e-01]
 [ 1.59e-01  9.62e-02  5.31e-01 -1.02e-01  9.86e-03 -1.49e-02  1.47e+00  1.85e-02
  -2.22e-02 -6.81e-03  1.76e-02 -5.86e-04  8.02e-02  3.41e-02 -7.97e-01]]
SymNet parameters
[-1.22 -0.6 ]
SymNet parameters
[[ 4.27e+00 -5.58e-01  6.04e-01 -2.42e-02 -2.21e-01  2.54e-03 -2.65e+00  1.09e-01
  -2.71e-01  1.09e-02  5.44e-03 -3.03e-02 -4.44e-01  1.69e-01  3.17e+00 -6.84e-01]
 [-2.36e+00  2.25e+00  2.74e-01  8.68e-02 -1.13e-01  6.17e-04 -8.23e-01 -5.63e-01
   1.46e+00  2.03e-02 -2.40e-02  6.27e-02 -2.79e-01 -1.53e-02  1.64e+00  1.07e-02]]
SymNet parameters
[0.94 1.45]
SymNet parameters
[[-1.95  1.29  0.31 -0.3  -0.15  0.01  5.26  0.4  -0.94 -0.03  0.07 -0.06 -0.64  0.72
  -0.55 -1.3  -0.02]]
SymNet parameters
[0.9]
SymNet parameters
[[-1.90e-01  4.78e-01  3.33e-02  7.79e-03 -1.78e-04 -5.10e-03  5.45e+00 -1.26e-01
   3.56e-01 -6.08e-02  2.93e-02  2.18e-03]
 [-5.17e-03  3.58e-05 -4.30e-04  2.21e-04 -8.20e-05  5.70e-05 -2.45e-05  9.88e-05
   2.68e-05  1.75e-04 -9.97e-05  2.30e-04]]
SymNet parameters
[-2.7  -0.19]
SymNet parameters
[[ 4.40e-01 -7.56e-02 -2.07e-02 -1.03e-02  1.18e-03  2.06e-03 -7.67e-01  2.01e-01
   1.11e-01  1.02e-02 -2.38e-02 -4.37e-03 -7.70e-01]
 [ 3.49e-02  8.98e-02  5.67e-03  3.65e-03 -1.48e-03 -4.19e-03  2.77e+00 -8.64e-02
   7.03e-02 -4.43e-02  1.27e-02  2.30e-03  1.32e+00]]
SymNet parameters
[-0.16 -2.92]
SymNet parameters
[[-1.39e-01  5.61e-03  2.69e-03  1.47e-03 -2.77e-04 -9.86e-04  4.77e-02  2.09e-02
  -2.14e-02 -8.69e-04 -1.08e-03  8.47e-03  5.81e-02  1.39e-02]
 [ 5.84e-01  1.65e-02  3.06e-03 -4.98e-03  4.55e-05 -2.05e-03  1.51e-01 -7.75e-02
   6.09e-02 -9.39e-04  1.02e-02  2.96e-02  2.19e-01 -2.52e-02]]
SymNet parameters
[-0.05  1.28]
SymNet parameters
[[ 6.79e-01 -9.98e-02 -4.36e-03 -8.14e-03  1.25e-03  5.24e-03 -1.14e+00 -2.39e-01
   1.68e+00  1.40e-02  1.48e-03 -3.84e-02 -1.11e+00 -1.18e-01  3.30e+00]
 [ 4.39e-01 -6.62e-02 -6.42e-03 -3.77e-03 -6.10e-05  4.69e-04  1.67e+00  7.97e-01
  -1.18e-01  4.04e-03 -9.03e-03  1.20e-03 -7.42e-01  1.07e-01 -1.60e-01]]
SymNet parameters
[ 1.33 -0.39]
SymNet parameters
[[ 8.29e-01  4.49e-01  2.96e-02  7.18e-03 -7.41e-04 -6.91e-03  5.25e+00 -5.50e-02
  -7.48e-02 -5.81e-02  2.55e-02  1.02e-02  5.01e+00  3.42e-02 -7.37e-01 -2.27e-04]
 [ 5.08e-01 -2.45e-01 -2.82e-02 -1.25e-02  1.47e-03  3.11e-03 -2.26e+00  2.14e+00
  -2.95e-01  2.24e-02 -3.46e-02 -1.72e-03 -2.71e+00  5.06e-01 -3.75e-01  2.88e-03]]
SymNet parameters
[-1.34  1.87]
SymNet parameters
[[ 8.08e-01 -1.55e-01 -1.41e-02 -6.44e-03  4.74e-05  3.93e-04 -1.02e+00  1.37e+00
  -6.68e-01  6.34e-02 -2.40e-02  5.68e-02 -1.71e+00  3.41e-01 -1.04e+00 -2.61e-01
  -4.35e-01]]
SymNet parameters
[0.95]
finally, finish this stage
iter:     0    time: 491.98
Func: 1.97e+00  |g|: 1.19e+03
stableloss: 6.74e-02   dataloss: 1.90e+00   sparseloss: 1.48e+02 momentloss: 7.96e+00
current expression:
[u10*v00, u00*u01, u20, u02, u00*u01**2, u10*v00*v10, u00*u11*v00, u01*u10*v00, u01*u10, u00*v00, u10*v01, u10*v00*v01, u10*v10, u20*v00**2, u00*u10*v10, u10*v00**2, u00**2*u01, u01, u01*v00**2, u00*u01*u10]
[-0.98 -0.98  0.05  0.05  0.02  0.01  0.01  0.01 -0.01  0.01  0.01 -0.   -0.    0.
 -0.    0.   -0.   -0.    0.    0.  ]
[v00*v10, u00*v01, v02, v20, v00*v10**2, u00*u01*v01, u00*v00*v11, u10*v00*v01, u00*v01*v10, v10**2, v10, u10*v01, v00, u00**2*v02, v00**2*v10, u10*v00*v10, u00*u10, v00**2*v20, u00**2, u10]
[-0.99 -0.97  0.05  0.05  0.02  0.01  0.01  0.01  0.01 -0.01  0.   -0.    0.    0.
  0.   -0.   -0.    0.    0.    0.  ]
u_obs.abs().max()
tensor(3.9434, device='cuda:2', dtype=torch.float64)
model(u_obs[0],T=50*dt).abs().max()
tensor(nan, device='cuda:2', dtype=torch.float64)
model(u_obs[0],T=100*dt).abs().max()
tensor(nan, device='cuda:2', dtype=torch.float64)
{'--name': 'burgers-2-upwind-sparse0-noise0.001-id5', '--dtype': 'double', '--device': 'cuda:1', '--constraint': '2', '--dt': 0.01, '--cell_num': 1, '--eps': 6.283185307179586, '--blocks': [0, 1, 2, 3, 4, 5, 6, 9], '--kernel_size': 5, '--max_order': 2, '--dx': 0.19634954084936207, '--hidden_layers': 5, '--scheme': 'upwind', '--dataname': 'burgers', '--viscosity': 0.05, '--zoom': 4, '--max_dt': 0.000625, '--batch_size': 28, '--data_timescheme': 'rk2', '--channel_names': 'u,v', '--freq': 4, '--data_start_time': 1.0, '--start_noise': 0.001, '--end_noise': 0.001, '--stablize': 0.0, '--sparsity': 0.0, '--momentsparsity': 0.001, '--npseed': -1, '--torchseed': -1, '--maxiter': 2000, '--recordfile': 'None', '--recordcycle': 200, '--savecycle': -1, '--start_from': -1}
block:  0
name:  burgers-2-upwind-sparse0-noise0.001-id5
device:  cuda:1
generate a random number to check random seed:  -1.990014282881228
current stage is: warmup
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.8770, device='cuda:1', dtype=torch.float64)
u_obs variance
tensor([ 0.2428,  2.1010,  1.9233, 19.7878,  9.9188, 16.7443,  0.2515,  1.9491,
         2.1193, 16.9764,  9.9051, 19.6706], device='cuda:1',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
iter:     0    time: 6.44
Func: 6.12e+00  |g|: 3.38e+00
stableloss: 6.74e-03   dataloss: 6.12e+00   sparseloss: 2.48e+01 momentloss: 7.27e+00
iter:   200    time: 13.47
Func: 4.22e-02  |g|: 2.46e-02
stableloss: 1.49e-02   dataloss: 4.22e-02   sparseloss: 5.33e+01 momentloss: 7.27e+00
iter:   400    time: 9.57
Func: 3.94e-02  |g|: 1.38e-02
stableloss: 1.49e-02   dataloss: 3.94e-02   sparseloss: 6.20e+01 momentloss: 7.27e+00
iter:   600    time: 9.06
Func: 3.86e-02  |g|: 5.45e-03
stableloss: 1.47e-02   dataloss: 3.86e-02   sparseloss: 6.71e+01 momentloss: 7.27e+00
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 0.038535
         Iterations: 616
         Function evaluations: 680
         Gradient evaluations: 674
convolution moment and kernels
[[1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
[[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 1. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
[[ 0.    1.    0.   -0.33 -0.25]
 [ 0.    0.    0.    0.    0.  ]
 [ 0.    0.    0.    0.    0.  ]
 [ 0.    0.    0.    0.    0.  ]
 [ 0.    0.    0.    0.    0.  ]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]
 [ 2.78e-17  3.33e-16 -1.50e+00  2.00e+00 -5.00e-01]
 [ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]]
[[ 0.    0.    0.    0.    0.  ]
 [ 1.    0.    0.    0.    0.  ]
 [ 0.    0.    0.    0.    0.  ]
 [-0.33  0.    0.    0.    0.  ]
 [-0.25  0.    0.    0.    0.  ]]
[[ 0.00e+00  0.00e+00  2.78e-17  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  3.33e-16  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00 -1.50e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  2.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00 -5.00e-01  0.00e+00  0.00e+00]]
[[0.   0.   1.   0.   0.08]
 [0.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.  ]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]
 [-2.22e-16  1.00e+00 -2.00e+00  1.00e+00 -1.53e-16]
 [ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]]
[[0. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
[[ 6.94e-03 -5.56e-02  9.25e-18  5.56e-02 -6.94e-03]
 [-5.56e-02  4.44e-01 -7.40e-17 -4.44e-01  5.56e-02]
 [ 9.25e-18 -7.40e-17  1.23e-32  7.40e-17 -9.25e-18]
 [ 5.56e-02 -4.44e-01  7.40e-17  4.44e-01 -5.56e-02]
 [-6.94e-03  5.56e-02 -9.25e-18 -5.56e-02  6.94e-03]]
[[0.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.  ]
 [1.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.  ]
 [0.08 0.   0.   0.   0.  ]]
[[ 0.00e+00  0.00e+00 -2.22e-16  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  1.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00 -2.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  1.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00 -1.53e-16  0.00e+00  0.00e+00]]
SymNet parameters
[[-2.35e-01  3.88e-01 -1.10e-01 -1.31e-01  3.48e-02 -1.60e-02 -8.41e-01  1.44e-02
  -6.75e-02  3.04e-03 -2.05e-02 -3.06e-03]
 [-1.14e+00 -2.20e-02  2.77e-02 -1.07e-02  8.58e-03  2.91e-03 -5.30e-01 -6.74e-03
   1.73e-03  9.35e-04 -1.07e-03  3.15e-03]]
SymNet parameters
[0.18 0.15]
SymNet parameters
[[ 3.95e-01  3.43e-01  3.53e-01  2.09e-01 -5.95e-02  2.04e-02  1.30e+00 -1.74e-02
   1.04e-01 -6.45e-03  2.94e-02  1.26e-03  1.08e-02]
 [ 1.14e+00 -6.61e-02  1.84e-01  7.17e-03 -1.39e-03  9.31e-03  3.48e-01 -3.05e-03
   2.29e-02 -2.53e-04  5.27e-03  3.72e-03  2.92e-02]]
SymNet parameters
[-0.22 -0.09]
SymNet parameters
[[-1.26  0.04 -0.09  0.02 -0.08 -0.1  -0.37 -0.07  0.1  -0.03 -0.02 -0.03 -0.1   0.05]
 [-1.08  0.09  0.56  0.13 -0.25  0.14  0.98  0.08 -0.22  0.02  0.07 -0.02 -0.15  0.17]]
SymNet parameters
[0.01 0.14]
SymNet parameters
[[ 0.14 -0.71  1.91  0.09 -0.04 -0.02  0.46  0.   -0.01 -0.01 -0.   -0.01 -0.06 -0.08
  -0.06]
 [ 0.45  0.05  0.12  0.07 -0.02  0.01 -1.27 -0.    0.04 -0.    0.01  0.    0.02  0.01
   0.01]]
SymNet parameters
[-0.33  0.81]
SymNet parameters
[[ 0.39 -0.11 -1.43 -0.74  0.33 -0.16 -0.34 -0.29 -0.55  0.03 -0.26  0.02  0.37 -0.5
  -0.15  0.18]
 [-0.64 -1.28  0.4   0.25 -0.32 -0.33  0.51  0.18 -0.59 -0.07 -0.14 -0.2  -0.18 -0.19
  -0.   -0.03]]
SymNet parameters
[ 0.11 -0.22]
SymNet parameters
[[ 1.20e-01  7.99e-02 -4.56e-01  3.40e-02  2.28e-03  4.46e-02 -9.97e-02  6.29e-03
  -5.84e-04  1.52e-03 -8.23e-04  5.74e-03  1.19e+00 -7.73e-01  2.70e-02  2.66e-01
   8.40e-03]]
SymNet parameters
[0.04]
SymNet parameters
[[-0.   -0.04  0.08  0.02 -0.01 -0.   -0.43  0.34  0.14  0.03  0.02  0.12]
 [-0.47  0.07 -0.14 -0.02  0.02  0.01 -0.89  0.01  0.56  0.06 -0.13 -0.07]]
SymNet parameters
[0.31 0.38]
SymNet parameters
[[ 5.23e-01  1.04e-02  1.61e-02  1.52e-02 -1.48e-02  8.11e-03  1.44e+00  7.77e-02
  -4.56e-01 -3.95e-02  8.19e-02  8.42e-02 -1.43e-01]
 [ 7.37e-01  8.92e-03 -1.08e-03  3.16e-04 -1.10e-02  7.68e-03 -9.22e-01  2.21e-01
   3.08e-01 -7.33e-02  8.07e-02 -1.02e-01 -6.59e-02]]
SymNet parameters
[-0.03  0.15]
SymNet parameters
[[-1.26 -0.1   0.25  0.03 -0.03 -0.02  0.06 -0.12 -0.59 -0.1   0.22  0.11  0.01  0.11]
 [ 0.64 -0.04  0.08  0.01 -0.01 -0.01  0.06  0.28  0.05 -0.02  0.06  0.04  0.01  0.03]]
SymNet parameters
[ 0.16 -0.55]
SymNet parameters
[[ 9.12e-01  9.39e-02 -3.11e-01 -6.21e-03  1.68e-02  5.12e-02 -4.70e-01 -3.68e-01
  -3.60e-01  2.58e-01 -3.20e-01 -4.98e-02 -6.02e-02 -1.74e-01  1.46e-01]
 [-1.75e-02 -1.72e-03  2.06e-02 -1.80e-03  4.77e-04 -4.97e-03 -5.61e-01  1.19e-01
  -1.14e-01 -3.08e-02  2.96e-02 -4.01e-03  3.49e-04  2.59e-02 -2.15e-02]]
SymNet parameters
[0.03 0.23]
SymNet parameters
[[ 5.22e-01 -2.81e-02  7.98e-02  2.07e-03 -4.42e-03 -1.35e-02 -5.04e-01  2.11e-02
  -5.73e-03 -6.44e-02  8.26e-02  1.49e-02  1.79e-02  6.03e-02 -3.34e-02  5.99e-03]
 [-1.30e+00 -6.28e-02  1.98e-01  6.80e-03 -1.25e-02 -2.81e-02 -4.81e-01  6.53e-01
  -4.65e-01 -1.39e-01  1.86e-01  8.15e-03  3.90e-02  1.15e-01 -5.56e-02  2.68e-04]]
SymNet parameters
[-0.17  0.16]
SymNet parameters
[[-0.03 -0.01  0.02  0.01 -0.01  0.    0.25 -0.34 -0.4   0.05  0.01  0.07  0.53 -0.23
   0.82 -0.94 -1.03]]
SymNet parameters
[-0.03]
finally, finish this stage
iter:   616    time: 2.78
Func: 3.85e-02  |g|: 5.14e-03
stableloss: 1.47e-02   dataloss: 3.85e-02   sparseloss: 6.69e+01 momentloss: 7.27e+00
current expression:
[u00*u01, u10*v00, u00, u20, u02, u00**3, 1, u00*u11*v00, u00*u01**2, u00**2*u02, u01*u10*v00, u10, v01, u00*u02*v00, u00*v10, u00*u02, u00*v00, u10*v00*v10, v10, u00*v00**2]
[-0.89 -0.89  0.04  0.04  0.04 -0.02 -0.01  0.01  0.01 -0.01  0.01 -0.01  0.01 -0.01
 -0.01  0.01 -0.01  0.01 -0.01  0.01]
[v00*v10, u00*v01, v00, v20, v02, v00**3, u00*v00, v00**2, 1, v11, u00*v10, v00**2*v20, u00*v00*v11, v00*v10**2, u00*v00**2, v10, u00*v01*v10, u00*v00*v02, u10*v01, v10**2]
[-0.9  -0.89  0.05  0.04  0.04 -0.02  0.02  0.02 -0.01 -0.01 -0.01 -0.01  0.01  0.01
 -0.01  0.01  0.01 -0.01  0.    0.  ]
block:  1
name:  burgers-2-upwind-sparse0-noise0.001-id5
device:  cuda:1
generate a random number to check random seed:  -0.8113202296151237
current stage is: block-1
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.8955, device='cuda:1', dtype=torch.float64)
u_obs variance
tensor([ 0.2443,  2.0184,  1.8862, 18.8047,  9.3088, 16.1740,  0.2568,  2.0525,
         2.2323, 18.3382, 11.0563, 20.7232], device='cuda:1',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
iter:     0    time: 2824.56
Func: 4.93e-02  |g|: 1.04e+00
stableloss: 9.73e-03   dataloss: 4.21e-02   sparseloss: 6.69e+01 momentloss: 7.27e+00
iter:   200    time: 10.12
Func: 2.01e-02  |g|: 1.29e-02
stableloss: 6.52e-03   dataloss: 1.36e-02   sparseloss: 6.52e+01 momentloss: 6.48e+00
iter:   400    time: 10.16
Func: 1.94e-02  |g|: 1.35e-02
stableloss: 6.16e-03   dataloss: 1.29e-02   sparseloss: 6.58e+01 momentloss: 6.48e+00
iter:   600    time: 10.11
Func: 1.92e-02  |g|: 9.34e-03
stableloss: 6.27e-03   dataloss: 1.27e-02   sparseloss: 7.01e+01 momentloss: 6.48e+00
iter:   800    time: 10.07
Func: 1.91e-02  |g|: 1.07e-02
stableloss: 6.23e-03   dataloss: 1.26e-02   sparseloss: 7.03e+01 momentloss: 6.48e+00
iter:  1000    time: 10.09
Func: 1.89e-02  |g|: 4.72e-03
stableloss: 6.22e-03   dataloss: 1.24e-02   sparseloss: 7.34e+01 momentloss: 6.48e+00
iter:  1200    time: 10.11
Func: 1.89e-02  |g|: 7.14e-03
stableloss: 6.26e-03   dataloss: 1.24e-02   sparseloss: 7.94e+01 momentloss: 6.48e+00
iter:  1400    time: 11.58
Func: 1.88e-02  |g|: 1.01e-02
stableloss: 6.28e-03   dataloss: 1.23e-02   sparseloss: 8.96e+01 momentloss: 6.48e+00
iter:  1600    time: 10.42
Func: 1.87e-02  |g|: 1.01e-02
stableloss: 6.30e-03   dataloss: 1.22e-02   sparseloss: 9.89e+01 momentloss: 6.47e+00
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 0.018708
         Iterations: 1673
         Function evaluations: 1728
         Gradient evaluations: 1718
convolution moment and kernels
[[ 1.00e+00  0.00e+00 -1.55e-05 -9.18e-03 -5.13e-02]
 [ 0.00e+00 -1.79e-04  7.14e-04  4.36e-04 -2.86e-03]
 [ 7.99e-05  4.12e-03  4.90e-03 -6.26e-04 -3.33e-03]
 [-1.28e-03 -9.60e-04 -2.58e-03  9.46e-05  4.30e-03]
 [-5.74e-02  3.00e-03  5.19e-04 -9.41e-04  6.09e-03]]
[[ 0.   -0.02 -0.04 -0.01  0.  ]
 [-0.02  0.1   0.09  0.08 -0.02]
 [ 0.   -0.    0.64  0.03 -0.01]
 [-0.04  0.16  0.    0.14 -0.03]
 [ 0.01 -0.04 -0.   -0.03  0.01]]
[[ 0.00e+00  1.00e+00  0.00e+00 -9.94e-02 -5.58e-02]
 [ 0.00e+00  0.00e+00 -3.11e-03 -1.43e-03 -2.26e-03]
 [ 0.00e+00  1.32e-02  4.95e-03  6.44e-03 -7.94e-03]
 [ 2.29e-03  8.00e-04  7.27e-04 -1.83e-03 -2.26e-04]
 [ 1.51e-02 -1.81e-02  2.28e-03 -2.01e-02 -3.23e-03]]
[[ 0.01  0.01 -0.01  0.02 -0.01]
 [-0.03  0.01 -0.04 -0.04  0.04]
 [ 0.13 -0.59 -0.25  1.03 -0.25]
 [-0.04  0.02 -0.04 -0.04  0.04]
 [ 0.01  0.   -0.    0.02 -0.01]]
[[ 0.00e+00  0.00e+00  0.00e+00 -2.68e-03  3.51e-03]
 [ 1.00e+00  0.00e+00  1.75e-02 -1.43e-03 -7.17e-03]
 [ 0.00e+00 -1.82e-03  2.98e-03 -1.54e-03 -2.84e-03]
 [-9.68e-02 -1.58e-03  9.41e-03  1.53e-03 -1.01e-02]
 [-6.09e-02  3.50e-03 -2.47e-03  9.63e-03  3.85e-04]]
[[ 0.   -0.02  0.12 -0.03  0.01]
 [ 0.01  0.03 -0.61  0.08 -0.03]
 [-0.01 -0.04 -0.23 -0.12  0.04]
 [ 0.02 -0.01  0.97  0.05 -0.02]
 [-0.01  0.02 -0.22  0.01  0.  ]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00 -3.55e-03]
 [ 0.00e+00  0.00e+00  0.00e+00  4.61e-04  2.30e-04]
 [ 0.00e+00  0.00e+00  1.79e-03  1.36e-03 -5.47e-04]
 [ 0.00e+00 -3.50e-04  4.26e-04 -5.58e-04 -1.53e-03]
 [ 3.44e-03  9.81e-04 -6.68e-04 -1.33e-03 -1.88e-03]]
[[-3.04e-04  9.22e-04 -2.71e-04  4.71e-03 -1.62e-03]
 [ 1.16e-03 -3.98e-03  3.14e-03 -2.22e-02  8.12e-03]
 [-8.99e-02  1.36e+00 -2.54e+00  1.39e+00 -1.02e-01]
 [ 3.80e-03 -1.73e-02  2.55e-02 -3.81e-02  1.24e-02]
 [-1.62e-03  7.37e-03 -1.08e-02  1.20e-02 -3.51e-03]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00 -1.60e-04]
 [ 0.00e+00  1.00e+00  0.00e+00 -1.10e-03  3.19e-04]
 [ 0.00e+00  0.00e+00 -5.95e-04 -6.15e-04  1.39e-03]
 [ 0.00e+00 -1.31e-03 -1.21e-03  1.88e-03  1.59e-03]
 [-1.14e-04 -8.19e-04  5.48e-04 -7.84e-04 -2.60e-03]]
[[ 0.   -0.04 -0.02  0.07 -0.01]
 [-0.04  0.39  0.09 -0.51  0.07]
 [-0.02  0.08 -0.13  0.08 -0.02]
 [ 0.07 -0.49  0.07  0.4  -0.05]
 [-0.01  0.06 -0.01 -0.05  0.01]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00 -1.03e-03]
 [ 0.00e+00  0.00e+00  0.00e+00  5.12e-04  1.38e-04]
 [ 1.00e+00  0.00e+00  1.04e-03  2.89e-03  1.18e-03]
 [ 0.00e+00 -8.03e-04 -1.47e-04 -2.13e-04 -1.05e-03]
 [-2.61e-03  3.91e-03  1.92e-03 -4.73e-03 -6.21e-03]]
[[-0.    0.02 -0.13  0.03 -0.01]
 [ 0.01 -0.08  1.51 -0.14  0.04]
 [-0.02  0.13 -2.79  0.23 -0.06]
 [ 0.02 -0.09  1.52 -0.15  0.04]
 [-0.    0.02 -0.13  0.04 -0.01]]
SymNet parameters
[[-4.20e-03  1.84e-01  5.57e-02  6.52e-02 -2.52e-02  2.37e-03 -8.17e-01 -1.29e-02
  -3.17e-02 -8.10e-03  3.68e-03 -7.61e-04]
 [-2.16e+00 -4.90e-02 -1.21e-01 -1.02e-01  5.85e-02 -1.18e-02  6.61e-01  3.28e-02
  -5.30e-02  1.85e-02 -7.23e-03  2.54e-03]]
SymNet parameters
[-0.06  0.03]
SymNet parameters
[[-5.36e-01  2.45e-01  3.09e-01  4.28e-01 -3.07e-01  9.79e-02  1.95e+00 -1.33e-01
   3.09e-01 -9.10e-02  2.19e-02 -9.16e-03 -1.97e-01]
 [ 1.58e+00  3.57e-02  1.79e-01  4.63e-03  3.74e-02  1.68e-04 -5.10e-01  2.15e-03
   2.24e-02  8.28e-04  3.27e-04  3.03e-04  3.65e-02]]
SymNet parameters
[ 0.22 -0.15]
SymNet parameters
[[-1.28e+00 -4.98e-03 -1.05e-01 -2.93e-02 -2.58e-02  7.85e-04  5.67e-01  3.29e-04
   8.34e-03  1.43e-03 -1.65e-03 -4.11e-04 -2.60e-02  6.51e-04]
 [-1.65e+00  1.85e-01  8.37e-01  1.55e+00 -9.73e-01  2.79e-01  9.26e-01 -4.31e-01
   6.13e-01 -2.93e-01  8.17e-02 -2.88e-02 -5.28e-01 -1.08e-03]]
SymNet parameters
[0.05 0.07]
SymNet parameters
[[ 8.63e-01  9.21e-01  2.20e+00 -1.38e-01 -2.23e-01 -4.79e-02 -2.21e-01 -8.81e-03
  -1.73e-01  1.57e-02  1.53e-04 -5.87e-04  2.46e-01 -2.06e-01 -1.04e-01]
 [ 2.93e-01  1.11e-01  5.17e-02  4.20e-02 -3.04e-02  1.39e-02 -1.16e+00 -1.51e-02
   6.10e-02 -1.01e-02  2.73e-03 -8.76e-04 -3.65e-02 -3.41e-04  9.56e-05]]
SymNet parameters
[-0.36  1.  ]
SymNet parameters
[[ 0.5   0.04 -1.15 -2.12  0.47 -0.33 -0.18  0.49 -1.23  0.36 -0.11  0.04  1.51 -0.56
  -0.27  0.17]
 [-1.61 -1.16 -0.01  0.2  -0.   -0.03  2.15  0.03 -0.53  0.01  0.01  0.01 -0.07 -0.09
  -0.04  0.01]]
SymNet parameters
[ 0.11 -0.21]
SymNet parameters
[[-3.28e-02 -3.01e-01 -6.51e-01  2.96e-02  1.13e-01  5.47e-02 -3.90e-01  2.10e-02
   1.33e-02  8.72e-03 -3.77e-03  8.34e-04  1.81e+00 -1.17e+00 -4.99e-01  2.98e-01
   1.83e-02]]
SymNet parameters
[0.07]
SymNet parameters
[[-1.71e+00  9.65e-03  1.20e-02 -1.21e-02  1.99e-02 -5.93e-03  7.94e-03  1.34e+00
   1.25e+00  6.85e-03  1.23e-01  2.15e-01]
 [ 5.00e-02  3.57e-02 -3.21e-02 -1.75e-03 -1.51e-03 -4.44e-03 -1.35e+00 -2.05e-01
   9.43e-02  1.75e-03 -3.98e-02 -8.03e-04]]
SymNet parameters
[0.76 0.01]
SymNet parameters
[[-1.15e-01 -8.63e-02  5.33e-02  3.47e-03  1.26e-03  5.24e-03  2.08e+00  2.84e-01
  -1.73e-01  2.91e-03  6.33e-02  4.17e-03 -4.82e-04]
 [ 1.85e+00 -2.26e-02 -4.83e-03  1.36e-02 -1.81e-02  1.20e-02 -9.52e-02 -9.19e-01
  -1.02e+00 -7.50e-03 -6.70e-02 -2.26e-01 -1.21e-02]]
SymNet parameters
[ 0.21 -0.48]
SymNet parameters
[[-2.06 -0.23  0.41  0.02 -0.    0.07 -0.    0.96 -1.21 -0.04  0.2  -0.29  0.1  -0.2 ]
 [ 0.97 -0.04  0.08  0.   -0.    0.01 -0.05  0.5  -0.14 -0.01  0.02 -0.09  0.05 -0.06]]
SymNet parameters
[-0.28 -0.41]
SymNet parameters
[[-3.90e-01  2.06e-01 -4.03e-01 -1.86e-02 -1.01e-02 -6.81e-02 -2.63e+00 -2.61e+00
   8.29e-01  4.66e-02 -3.41e-01  1.95e-01  5.74e-03  6.43e-02 -7.26e-03]
 [ 7.05e-01 -3.18e-02  5.12e-02 -2.97e-03  9.75e-03  6.62e-03 -8.04e-01  6.78e-01
  -7.07e-02  1.40e-03  1.18e-01  5.25e-02 -8.54e-02  4.94e-02  1.67e-02]]
SymNet parameters
[0.02 0.47]
SymNet parameters
[[ 9.47e-01 -3.88e-02  6.89e-02  1.00e-03  3.29e-03  9.69e-03 -7.50e-01  3.74e-01
  -1.73e-01 -2.55e-03  7.07e-02 -1.66e-02 -6.42e-02  3.07e-02  8.08e-03  9.41e-04]
 [-4.19e-01 -1.33e-01  2.71e-01  1.12e-02  9.81e-03  4.69e-02  1.29e+00  2.27e+00
  -6.77e-01 -3.04e-02  2.51e-01 -1.04e-01  3.45e-02 -8.19e-02  1.26e-02 -2.07e-03]]
SymNet parameters
[0.   0.02]
SymNet parameters
[[-4.93e-02  9.65e-03 -3.19e-02  1.01e-03 -4.54e-03 -3.31e-03 -1.24e-02 -5.06e-01
  -1.16e-01  5.46e-02 -4.66e-02  2.73e-02  1.21e+00 -5.09e-01  3.22e-01 -5.75e-01
  -1.16e+00]]
SymNet parameters
[-0.09]
finally, finish this stage
iter:  1673    time: 6.41
Func: 1.87e-02  |g|: 2.43e-03
stableloss: 6.30e-03   dataloss: 1.22e-02   sparseloss: 9.98e+01 momentloss: 6.47e+00
current expression:
[u00*u01, u10*v00, u20, u02, u00*u01**2, u01*u10*v00, u00*u11*v00, u00, u10*v00*v10, u00*u01*v00, u10, u00**2*u01*v00, u00**2, u01, u00*v10, u00*u10*v10, v00**2*v10, u01*v00**2, u00*u01*u10, u00*v00]
[-0.98 -0.98  0.05  0.05  0.01  0.01  0.01  0.01  0.01 -0.01  0.    0.   -0.    0.
 -0.   -0.    0.   -0.    0.   -0.  ]
[v00*v10, u00*v01, v02, v20, v00, v00*v10**2, u00*v00*v11, u00*v01*v10, u10*v00*v01, u00*u01*v01, v00**3, v10, u00, u00*v00**2*v10, u00*v10, u01, u00**2*u01, u10, u00*u10*v01, u00**2*v10]
[-0.98 -0.97  0.05  0.05  0.02  0.01  0.01  0.01  0.01  0.01 -0.01  0.    0.    0.
 -0.    0.   -0.   -0.   -0.   -0.  ]
block:  2
name:  burgers-2-upwind-sparse0-noise0.001-id5
device:  cuda:1
generate a random number to check random seed:  1.7830385115291143
current stage is: block-2
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.9317, device='cuda:1', dtype=torch.float64)
u_obs variance
tensor([ 0.2392,  1.6615,  1.4868, 21.7367,  8.9272, 17.4391,  0.2672,  1.8042,
         1.8110, 20.9946, 11.0165, 23.5488], device='cuda:1',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
iter:     0    time: 945.11
Func: 7.38e-02  |g|: 2.90e+00
stableloss: 1.69e-02   dataloss: 6.09e-02   sparseloss: 9.98e+01 momentloss: 6.47e+00
iter:   200    time: 13.93
Func: 6.49e-02  |g|: 2.94e-01
stableloss: 1.65e-02   dataloss: 5.09e-02   sparseloss: 9.97e+01 momentloss: 7.01e+00
iter:   400    time: 13.79
Func: 6.43e-02  |g|: 3.64e-02
stableloss: 1.64e-02   dataloss: 5.02e-02   sparseloss: 1.01e+02 momentloss: 7.04e+00
iter:   600    time: 14.01
Func: 6.41e-02  |g|: 5.92e-02
stableloss: 1.63e-02   dataloss: 5.00e-02   sparseloss: 1.09e+02 momentloss: 7.02e+00
iter:   800    time: 15.03
Func: 6.36e-02  |g|: 4.99e-02
stableloss: 1.62e-02   dataloss: 4.96e-02   sparseloss: 1.15e+02 momentloss: 6.99e+00
iter:  1000    time: 18.29
Func: 6.33e-02  |g|: 3.68e-02
stableloss: 1.63e-02   dataloss: 4.93e-02   sparseloss: 1.21e+02 momentloss: 7.00e+00
iter:  1200    time: 14.58
Func: 6.32e-02  |g|: 4.73e-02
stableloss: 1.64e-02   dataloss: 4.92e-02   sparseloss: 1.29e+02 momentloss: 6.99e+00
iter:  1400    time: 19.94
Func: 6.31e-02  |g|: 5.23e-02
stableloss: 1.64e-02   dataloss: 4.91e-02   sparseloss: 1.37e+02 momentloss: 7.01e+00
iter:  1600    time: 14.57
Func: 6.30e-02  |g|: 6.18e-02
stableloss: 1.64e-02   dataloss: 4.91e-02   sparseloss: 1.46e+02 momentloss: 6.99e+00
iter:  1800    time: 14.64
Func: 6.30e-02  |g|: 1.31e-01
stableloss: 1.64e-02   dataloss: 4.90e-02   sparseloss: 1.57e+02 momentloss: 6.99e+00
Warning: Maximum number of iterations has been exceeded.
         Current function value: 0.062927
         Iterations: 2000
         Function evaluations: 2009
         Gradient evaluations: 2009
convolution moment and kernels
[[ 1.00e+00  0.00e+00  9.46e-04  3.75e-02 -8.42e-02]
 [ 0.00e+00  5.39e-05  2.86e-03  2.55e-03 -3.12e-03]
 [-6.86e-05  1.56e-03  8.00e-03 -4.14e-03  1.04e-03]
 [-4.66e-02  1.97e-03  6.15e-04 -3.54e-03  8.13e-03]
 [-1.54e-01  7.90e-03 -6.35e-02 -2.62e-03 -6.26e-03]]
[[-0.   -0.05 -0.03 -0.04 -0.01]
 [ 0.01  0.22  0.13  0.19  0.02]
 [-0.1  -0.03  0.33 -0.04 -0.08]
 [-0.01  0.32  0.09  0.26  0.  ]
 [ 0.01 -0.09 -0.03 -0.07  0.  ]]
[[ 0.00e+00  1.00e+00  0.00e+00 -1.00e-01 -6.60e-02]
 [ 0.00e+00  0.00e+00  1.82e-04 -4.08e-06  3.37e-03]
 [ 0.00e+00  1.87e-02  6.26e-03  2.64e-02 -1.55e-02]
 [-1.80e-02 -7.15e-03  3.15e-03  3.54e-03  1.92e-03]
 [ 8.77e-04 -1.96e-02  5.29e-03 -1.11e-02 -3.64e-03]]
[[ 2.79e-03  1.30e-02 -1.63e-02  1.98e-02 -9.37e-03]
 [-3.92e-02  3.18e-02 -3.56e-02 -6.40e-03  2.79e-02]
 [ 1.36e-01 -5.72e-01 -3.29e-01  1.01e+00 -2.36e-01]
 [-3.33e-02  4.45e-03  1.94e-02 -5.13e-04  2.44e-02]
 [ 1.51e-03  2.00e-02 -3.39e-02  1.02e-02 -5.91e-03]]
[[ 0.00e+00  0.00e+00  0.00e+00  8.92e-03  1.26e-02]
 [ 1.00e+00  0.00e+00  2.81e-02 -1.83e-03 -4.44e-03]
 [ 0.00e+00 -2.35e-03 -6.35e-03  1.15e-04  5.11e-03]
 [-9.65e-02  8.92e-04  2.92e-02  2.91e-03 -2.38e-03]
 [-7.54e-02 -2.64e-03 -1.99e-02 -9.93e-04 -4.51e-03]]
[[-4.18e-04 -2.64e-02  1.11e-01 -2.51e-02 -2.54e-03]
 [ 1.52e-02  9.84e-03 -5.13e-01  4.43e-03  2.21e-02]
 [-2.08e-02 -1.96e-02 -3.57e-01 -3.83e-02 -1.65e-02]
 [ 1.98e-02 -2.05e-02  1.06e+00 -1.18e-02  1.87e-02]
 [-5.63e-03  1.55e-02 -2.24e-01  1.16e-02 -4.69e-03]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00 -2.43e-03]
 [ 0.00e+00  0.00e+00  0.00e+00  8.35e-04 -3.90e-03]
 [ 0.00e+00  0.00e+00  1.95e-03  1.12e-04  1.41e-04]
 [ 0.00e+00  4.87e-04 -4.38e-03 -1.40e-03  1.50e-02]
 [ 1.37e-01 -1.20e-03 -6.37e-04  2.15e-03 -3.91e-03]]
[[-1.34e-02  5.26e-02  6.30e-02  4.49e-02 -1.03e-02]
 [ 3.90e-02 -1.46e-01 -3.49e-01 -1.19e-01  2.77e-02]
 [-1.16e-01  1.44e+00 -1.81e+00  1.41e+00 -1.02e-01]
 [ 1.10e-03  1.02e-02 -5.82e-01  2.90e-02 -6.12e-03]
 [ 3.36e-03 -1.75e-02  1.68e-01 -2.15e-02  4.89e-03]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  1.37e-04]
 [ 0.00e+00  1.00e+00  0.00e+00 -1.72e-03  1.01e-03]
 [ 0.00e+00  0.00e+00 -5.92e-04 -1.79e-04  1.49e-03]
 [ 0.00e+00 -3.34e-03  1.59e-03  3.94e-03 -6.25e-04]
 [-3.99e-03 -4.96e-03  4.31e-03  3.08e-03 -7.58e-03]]
[[-0.   -0.02 -0.06  0.09 -0.01]
 [-0.02  0.28  0.24 -0.57  0.08]
 [-0.06  0.27 -0.39  0.19 -0.04]
 [ 0.1  -0.64  0.27  0.32 -0.03]
 [-0.02  0.1  -0.07 -0.03  0.  ]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  5.21e-03]
 [ 0.00e+00  0.00e+00  0.00e+00  1.67e-04  9.74e-04]
 [ 1.00e+00  0.00e+00  2.47e-03  2.74e-03 -2.40e-03]
 [ 0.00e+00  1.00e-04 -2.10e-03 -1.75e-04  3.95e-03]
 [-3.07e-03 -4.01e-05  5.59e-04 -2.80e-03 -1.07e-03]]
[[-1.42e-03  1.00e-02 -1.06e-01  1.58e-02 -4.33e-03]
 [-2.82e-03 -4.43e-03  1.37e+00 -3.33e-02  1.17e-02]
 [ 1.69e-02 -4.65e-02 -2.48e+00  5.28e-04 -6.78e-03]
 [-1.01e-02  2.82e-02  1.32e+00 -1.99e-03  5.08e-03]
 [ 2.65e-03 -8.17e-03 -7.85e-02 -1.89e-03 -4.84e-04]]
SymNet parameters
[[-1.73e-01 -1.12e-01 -8.52e-02  7.68e-02 -2.81e-02  2.32e-02 -1.70e+00  6.06e-03
   1.77e-02 -3.53e-03  6.37e-03  8.96e-04]
 [-2.99e+00  2.13e-01  2.14e-01 -1.21e-01  1.02e-02 -1.59e-02  1.02e+00  3.47e-02
  -1.65e-01  1.63e-03 -7.82e-03  1.05e-02]]
SymNet parameters
[1.21 0.15]
SymNet parameters
[[ 1.86e+00 -2.43e+00 -1.21e-01  9.28e-01 -4.34e-01  2.40e-01  1.58e+00 -1.35e-01
   1.10e+00 -1.88e-02  6.34e-02 -1.08e-01 -1.68e-01]
 [ 2.94e+00 -1.96e-01 -2.14e-01  1.53e-01  3.45e-02  1.82e-02 -1.04e+00 -2.69e-02
   1.71e-01 -2.09e-03  9.99e-03 -9.25e-03 -2.31e-03]]
SymNet parameters
[-0.89 -0.02]
SymNet parameters
[[-1.88e+00  1.22e-01  1.43e-01 -9.58e-02 -1.98e-02 -1.16e-02  6.48e-01  1.50e-02
  -1.01e-01  1.48e-03 -6.32e-03  5.60e-03  4.30e-04 -1.27e-04]
 [ 3.91e+00 -7.19e+00 -7.06e-01  2.65e+00 -1.19e+00  6.97e-01 -8.44e-01 -3.14e-01
   2.86e+00 -6.15e-02  1.85e-01 -2.74e-01 -4.23e-01 -1.71e-04]]
SymNet parameters
[-0.07  0.72]
SymNet parameters
[[ 3.56e+00  8.20e-02  1.34e+00  1.84e-02 -2.34e-01  1.84e-02 -1.02e+00 -6.58e-02
   1.53e-01 -1.16e-03  1.82e-03 -1.88e-02  5.07e-02 -4.10e-02 -2.99e-02]
 [ 4.27e-01 -2.55e-01 -3.78e-02  7.05e-02  6.50e-03  1.38e-02 -2.68e+00 -1.71e-02
   8.72e-02 -7.09e-04  4.17e-03  1.30e-03 -1.99e-02  1.32e-03  1.45e-03]]
SymNet parameters
[-0.76  1.62]
SymNet parameters
[[-0.21  3.13  0.62 -2.67  0.25 -0.5   3.1   0.11 -2.33  0.04 -0.21  0.22  1.97 -1.07
  -0.64  0.26]
 [-4.71 -3.66  0.33 -0.11 -0.02  0.05  2.19  0.97 -3.17 -0.06  0.03  0.14 -0.49  0.48
   0.25 -0.02]]
SymNet parameters
[ 0.07 -1.15]
SymNet parameters
[[ 8.39e-01  2.49e-01 -6.29e-01 -1.09e-01  1.04e-01  2.84e-03 -3.52e-01  1.65e-03
  -1.23e-01  4.89e-03 -1.22e-02  1.65e-02  1.97e+00 -1.35e+00 -8.20e-01  2.46e-01
   2.80e-03]]
SymNet parameters
[-0.06]
SymNet parameters
[[-3.00e+00 -6.41e-02  5.10e-01  3.96e-02  5.28e-02  8.54e-04 -4.26e-02  1.68e+00
   2.15e+00 -8.20e-02  1.25e-01  4.56e-01]
 [-9.10e-02  2.10e-02  1.13e-02 -2.69e-03 -1.15e-03  2.09e-03 -1.25e+00 -1.03e-01
   4.69e-02 -5.43e-03  1.44e-02 -2.75e-02]]
SymNet parameters
[1.64 0.6 ]
SymNet parameters
[[ 1.79e-01 -4.74e-02 -2.24e-02  5.56e-03  2.25e-03 -4.22e-03  2.44e+00  2.02e-01
  -9.67e-02  1.15e-02 -2.82e-02  5.49e-02 -4.95e-05]
 [ 2.16e+00  5.00e-02 -3.76e-01 -2.78e-02 -3.79e-02 -2.30e-04  3.53e-03 -1.18e+00
  -1.49e+00  5.90e-02 -8.34e-02 -3.26e-01 -6.48e-04]]
SymNet parameters
[-1.48 -0.4 ]
SymNet parameters
[[ 6.50e-01 -1.66e-01  4.92e-01 -6.67e-03  1.31e-02  5.84e-03 -2.91e+00 -5.49e-01
  -1.54e+00 -4.74e-02  3.02e-01 -1.37e-01  4.97e-01 -4.03e-01]
 [ 1.78e+00 -3.82e-03 -1.78e-02 -7.15e-03 -6.14e-03 -2.11e-03 -7.53e-01  7.48e-02
  -3.31e-02  7.83e-03 -4.99e-03 -6.37e-02 -4.87e-02  3.04e-02]]
SymNet parameters
[-0.05 -0.18]
SymNet parameters
[[-3.51e-01  1.78e-02 -1.35e-01 -2.60e-03 -7.97e-03 -4.26e-03 -4.87e+00  3.86e-01
   2.69e-01  3.90e-02 -1.36e-01  3.28e-02  1.06e-01 -1.16e-01 -5.74e-03]
 [ 1.87e+00  3.24e-03  1.58e-02 -4.25e-03 -1.69e-03 -1.11e-03 -1.15e+00 -2.01e-01
  -4.93e-01 -4.66e-03  4.03e-02 -4.67e-02 -3.71e-01  2.70e-01  5.85e-03]]
SymNet parameters
[0.56 0.75]
SymNet parameters
[[ 2.26e+00  4.55e-03 -1.02e-02 -7.11e-03 -4.91e-03 -2.09e-03 -1.16e+00 -2.55e-01
  -2.31e-01 -3.01e-04  2.65e-02 -7.23e-02 -4.05e-01  2.97e-01  3.36e-03  3.24e-03]
 [ 2.66e-01 -7.17e-02  2.54e-01  2.70e-03  1.22e-02  3.51e-03  3.21e+00  7.02e-01
  -5.51e-01 -4.01e-02  1.64e-01 -1.93e-02  5.19e-01 -3.61e-01  3.54e-03 -4.33e-03]]
SymNet parameters
[-0.13  0.13]
SymNet parameters
[[ 0.5  -0.03  0.02  0.    0.   -0.01 -0.22  0.18  0.07  0.06 -0.04  0.13  1.19 -0.78
   0.17 -0.4  -0.51]]
SymNet parameters
[-0.66]
finally, finish this stage
iter:  2000    time: 15.57
Func: 6.29e-02  |g|: 5.99e-02
stableloss: 1.64e-02   dataloss: 4.89e-02   sparseloss: 1.65e+02 momentloss: 6.99e+00
current expression:
[u10*v00, u00*u01, u20, u02, u00*u01**2, u01*u10*v00, u00*u11*v00, u10*v00*v10, u01, u00, u01*v00, v00, u00**2*u10, u01**2, u01*u10, u00*u01*v00, u00**2*u01, u10*v00*v01, u00**2*u01*v00, u00*u01*v10]
[-0.98 -0.97  0.05  0.05  0.01  0.01  0.01  0.01  0.01  0.01 -0.    0.   -0.   -0.
  0.    0.   -0.   -0.    0.    0.  ]
[v00*v10, u00*v01, v02, v20, v00*v10**2, u00*v01*v10, u00*v00*v11, v00, u10*v00*v01, u10, u01, 1, u00, u00*u01*v01, v00**2, u10*v00**2, u00**2*u01, v00**3, v10**2, u00*v00]
[-0.98 -0.97  0.05  0.05  0.01  0.01  0.01  0.01  0.01  0.01  0.01 -0.01 -0.01  0.
  0.   -0.   -0.   -0.    0.   -0.  ]
block:  3
name:  burgers-2-upwind-sparse0-noise0.001-id5
device:  cuda:1
generate a random number to check random seed:  -2.148458531181838
current stage is: block-3
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.8326, device='cuda:1', dtype=torch.float64)
u_obs variance
tensor([ 0.2342,  1.6580,  1.5464, 21.2569,  9.9000, 18.7241,  0.2418,  1.5669,
         1.7481, 16.5883, 10.1596, 23.3851], device='cuda:1',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 0.150852
         Iterations: 0
         Function evaluations: 15
         Gradient evaluations: 3
convolution moment and kernels
[[ 1.00e+00  0.00e+00  9.46e-04  3.75e-02 -8.42e-02]
 [ 0.00e+00  5.39e-05  2.86e-03  2.55e-03 -3.12e-03]
 [-6.86e-05  1.56e-03  8.00e-03 -4.14e-03  1.04e-03]
 [-4.66e-02  1.97e-03  6.15e-04 -3.54e-03  8.13e-03]
 [-1.54e-01  7.90e-03 -6.35e-02 -2.62e-03 -6.26e-03]]
[[-0.   -0.05 -0.03 -0.04 -0.01]
 [ 0.01  0.22  0.13  0.19  0.02]
 [-0.1  -0.03  0.33 -0.04 -0.08]
 [-0.01  0.32  0.09  0.26  0.  ]
 [ 0.01 -0.09 -0.03 -0.07  0.  ]]
[[ 0.00e+00  1.00e+00  0.00e+00 -1.00e-01 -6.60e-02]
 [ 0.00e+00  0.00e+00  1.82e-04 -4.02e-06  3.37e-03]
 [ 0.00e+00  1.87e-02  6.26e-03  2.64e-02 -1.55e-02]
 [-1.80e-02 -7.15e-03  3.15e-03  3.54e-03  1.92e-03]
 [ 8.76e-04 -1.96e-02  5.29e-03 -1.11e-02 -3.64e-03]]
[[ 2.78e-03  1.30e-02 -1.63e-02  1.98e-02 -9.37e-03]
 [-3.92e-02  3.18e-02 -3.55e-02 -6.46e-03  2.80e-02]
 [ 1.36e-01 -5.72e-01 -3.30e-01  1.01e+00 -2.36e-01]
 [-3.33e-02  4.41e-03  1.95e-02 -5.80e-04  2.44e-02]
 [ 1.51e-03  2.00e-02 -3.40e-02  1.02e-02 -5.91e-03]]
[[ 0.00e+00  0.00e+00  0.00e+00  8.92e-03  1.26e-02]
 [ 1.00e+00  0.00e+00  2.81e-02 -1.83e-03 -4.44e-03]
 [ 0.00e+00 -2.35e-03 -6.35e-03  1.15e-04  5.11e-03]
 [-9.65e-02  8.92e-04  2.92e-02  2.91e-03 -2.38e-03]
 [-7.54e-02 -2.64e-03 -1.99e-02 -9.92e-04 -4.51e-03]]
[[-4.20e-04 -2.64e-02  1.11e-01 -2.51e-02 -2.55e-03]
 [ 1.52e-02  9.81e-03 -5.13e-01  4.41e-03  2.21e-02]
 [-2.08e-02 -1.96e-02 -3.57e-01 -3.82e-02 -1.65e-02]
 [ 1.98e-02 -2.06e-02  1.06e+00 -1.19e-02  1.87e-02]
 [-5.63e-03  1.55e-02 -2.24e-01  1.16e-02 -4.70e-03]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00 -2.43e-03]
 [ 0.00e+00  0.00e+00  0.00e+00  8.35e-04 -3.90e-03]
 [ 0.00e+00  0.00e+00  1.95e-03  1.12e-04  1.41e-04]
 [ 0.00e+00  4.87e-04 -4.38e-03 -1.40e-03  1.50e-02]
 [ 1.37e-01 -1.20e-03 -6.36e-04  2.15e-03 -3.91e-03]]
[[-1.34e-02  5.26e-02  6.30e-02  4.49e-02 -1.03e-02]
 [ 3.90e-02 -1.46e-01 -3.49e-01 -1.19e-01  2.77e-02]
 [-1.16e-01  1.44e+00 -1.81e+00  1.41e+00 -1.02e-01]
 [ 1.10e-03  1.02e-02 -5.82e-01  2.90e-02 -6.12e-03]
 [ 3.36e-03 -1.75e-02  1.68e-01 -2.15e-02  4.89e-03]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  1.37e-04]
 [ 0.00e+00  1.00e+00  0.00e+00 -1.72e-03  1.01e-03]
 [ 0.00e+00  0.00e+00 -5.92e-04 -1.79e-04  1.49e-03]
 [ 0.00e+00 -3.34e-03  1.59e-03  3.94e-03 -6.25e-04]
 [-3.99e-03 -4.96e-03  4.31e-03  3.08e-03 -7.58e-03]]
[[-0.   -0.02 -0.06  0.09 -0.01]
 [-0.02  0.28  0.24 -0.57  0.08]
 [-0.06  0.27 -0.39  0.19 -0.04]
 [ 0.1  -0.64  0.27  0.32 -0.03]
 [-0.02  0.1  -0.07 -0.03  0.  ]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  5.21e-03]
 [ 0.00e+00  0.00e+00  0.00e+00  1.67e-04  9.75e-04]
 [ 1.00e+00  0.00e+00  2.47e-03  2.74e-03 -2.40e-03]
 [ 0.00e+00  1.00e-04 -2.10e-03 -1.75e-04  3.95e-03]
 [-3.07e-03 -4.03e-05  5.59e-04 -2.80e-03 -1.07e-03]]
[[-1.42e-03  1.00e-02 -1.06e-01  1.58e-02 -4.33e-03]
 [-2.82e-03 -4.44e-03  1.37e+00 -3.33e-02  1.17e-02]
 [ 1.69e-02 -4.65e-02 -2.48e+00  5.36e-04 -6.78e-03]
 [-1.01e-02  2.82e-02  1.32e+00 -2.00e-03  5.08e-03]
 [ 2.65e-03 -8.17e-03 -7.85e-02 -1.89e-03 -4.84e-04]]
SymNet parameters
[[-1.73e-01 -1.12e-01 -8.52e-02  7.68e-02 -2.81e-02  2.32e-02 -1.70e+00  6.06e-03
   1.77e-02 -3.53e-03  6.36e-03  8.95e-04]
 [-2.99e+00  2.13e-01  2.14e-01 -1.21e-01  1.02e-02 -1.59e-02  1.02e+00  3.47e-02
  -1.65e-01  1.63e-03 -7.83e-03  1.05e-02]]
SymNet parameters
[1.21 0.15]
SymNet parameters
[[ 1.86e+00 -2.43e+00 -1.21e-01  9.28e-01 -4.34e-01  2.40e-01  1.58e+00 -1.35e-01
   1.10e+00 -1.88e-02  6.34e-02 -1.08e-01 -1.68e-01]
 [ 2.94e+00 -1.96e-01 -2.14e-01  1.53e-01  3.45e-02  1.82e-02 -1.04e+00 -2.69e-02
   1.71e-01 -2.13e-03  9.99e-03 -9.26e-03 -2.35e-03]]
SymNet parameters
[-0.89 -0.02]
SymNet parameters
[[-1.88e+00  1.22e-01  1.43e-01 -9.57e-02 -1.98e-02 -1.16e-02  6.48e-01  1.50e-02
  -1.01e-01  1.41e-03 -6.31e-03  5.59e-03  3.33e-04  3.32e-04]
 [ 3.91e+00 -7.19e+00 -7.06e-01  2.65e+00 -1.19e+00  6.97e-01 -8.44e-01 -3.14e-01
   2.86e+00 -6.14e-02  1.85e-01 -2.74e-01 -4.23e-01 -1.68e-04]]
SymNet parameters
[-0.07  0.72]
SymNet parameters
[[ 3.56e+00  8.20e-02  1.34e+00  1.84e-02 -2.34e-01  1.84e-02 -1.02e+00 -6.58e-02
   1.53e-01 -1.16e-03  1.82e-03 -1.88e-02  5.07e-02 -4.10e-02 -2.99e-02]
 [ 4.27e-01 -2.55e-01 -3.78e-02  7.05e-02  6.51e-03  1.38e-02 -2.68e+00 -1.71e-02
   8.72e-02 -7.09e-04  4.18e-03  1.30e-03 -1.99e-02  1.31e-03  1.46e-03]]
SymNet parameters
[-0.76  1.62]
SymNet parameters
[[-0.21  3.13  0.62 -2.67  0.25 -0.5   3.1   0.11 -2.33  0.04 -0.21  0.22  1.97 -1.07
  -0.64  0.26]
 [-4.71 -3.66  0.33 -0.11 -0.02  0.05  2.19  0.97 -3.17 -0.06  0.03  0.14 -0.49  0.48
   0.25 -0.02]]
SymNet parameters
[ 0.07 -1.15]
SymNet parameters
[[ 8.39e-01  2.49e-01 -6.29e-01 -1.09e-01  1.04e-01  2.85e-03 -3.52e-01  1.64e-03
  -1.23e-01  4.89e-03 -1.22e-02  1.65e-02  1.97e+00 -1.35e+00 -8.20e-01  2.46e-01
   2.78e-03]]
SymNet parameters
[-0.06]
SymNet parameters
[[-3.00e+00 -6.41e-02  5.10e-01  3.96e-02  5.28e-02  8.54e-04 -4.26e-02  1.68e+00
   2.15e+00 -8.20e-02  1.25e-01  4.56e-01]
 [-9.10e-02  2.10e-02  1.13e-02 -2.72e-03 -1.14e-03  2.07e-03 -1.25e+00 -1.03e-01
   4.69e-02 -5.43e-03  1.44e-02 -2.75e-02]]
SymNet parameters
[1.64 0.6 ]
SymNet parameters
[[ 1.79e-01 -4.74e-02 -2.24e-02  5.55e-03  2.26e-03 -4.22e-03  2.44e+00  2.02e-01
  -9.67e-02  1.15e-02 -2.82e-02  5.49e-02 -5.91e-05]
 [ 2.16e+00  5.00e-02 -3.76e-01 -2.78e-02 -3.79e-02 -2.30e-04  3.53e-03 -1.18e+00
  -1.49e+00  5.90e-02 -8.34e-02 -3.26e-01 -6.51e-04]]
SymNet parameters
[-1.48 -0.4 ]
SymNet parameters
[[ 6.50e-01 -1.66e-01  4.92e-01 -6.67e-03  1.31e-02  5.84e-03 -2.91e+00 -5.49e-01
  -1.54e+00 -4.74e-02  3.02e-01 -1.37e-01  4.97e-01 -4.03e-01]
 [ 1.78e+00 -3.82e-03 -1.78e-02 -7.15e-03 -6.14e-03 -2.11e-03 -7.53e-01  7.48e-02
  -3.31e-02  7.83e-03 -4.99e-03 -6.37e-02 -4.87e-02  3.04e-02]]
SymNet parameters
[-0.05 -0.18]
SymNet parameters
[[-3.51e-01  1.78e-02 -1.35e-01 -2.60e-03 -7.97e-03 -4.26e-03 -4.87e+00  3.86e-01
   2.69e-01  3.90e-02 -1.36e-01  3.28e-02  1.06e-01 -1.16e-01 -5.75e-03]
 [ 1.87e+00  3.24e-03  1.58e-02 -4.25e-03 -1.69e-03 -1.11e-03 -1.15e+00 -2.01e-01
  -4.93e-01 -4.66e-03  4.03e-02 -4.67e-02 -3.71e-01  2.70e-01  5.85e-03]]
SymNet parameters
[0.56 0.75]
SymNet parameters
[[ 2.26e+00  4.55e-03 -1.02e-02 -7.11e-03 -4.91e-03 -2.09e-03 -1.16e+00 -2.55e-01
  -2.31e-01 -3.01e-04  2.65e-02 -7.23e-02 -4.05e-01  2.97e-01  3.36e-03  3.25e-03]
 [ 2.66e-01 -7.17e-02  2.54e-01  2.69e-03  1.22e-02  3.51e-03  3.21e+00  7.02e-01
  -5.51e-01 -4.01e-02  1.64e-01 -1.93e-02  5.19e-01 -3.61e-01  3.52e-03 -4.33e-03]]
SymNet parameters
[-0.13  0.13]
SymNet parameters
[[ 0.5  -0.03  0.02  0.    0.   -0.01 -0.22  0.18  0.07  0.06 -0.04  0.13  1.19 -0.78
   0.17 -0.4  -0.51]]
SymNet parameters
[-0.66]
finally, finish this stage
iter:     0    time: 658.45
Func: 1.51e-01  |g|: 8.60e+01
stableloss: 2.18e-02   dataloss: 1.30e-01   sparseloss: 1.65e+02 momentloss: 6.99e+00
current expression:
[u10*v00, u00*u01, u20, u02, u00*u01**2, u01*u10*v00, u00*u11*v00, u10*v00*v10, u01, u00, u01*v00, v00, u00**2*u10, u01**2, u01*u10, u00*u01*v00, u00**2*u01, u10*v00*v01, u00**2*u01*v00, u00*u01*v10]
[-0.98 -0.97  0.05  0.05  0.01  0.01  0.01  0.01  0.01  0.01 -0.    0.   -0.   -0.
  0.    0.   -0.   -0.    0.    0.  ]
[v00*v10, u00*v01, v02, v20, v00*v10**2, u00*v01*v10, u00*v00*v11, v00, u10*v00*v01, u10, u01, 1, u00, u00*u01*v01, v00**2, u10*v00**2, u00**2*u01, v00**3, v10**2, u00*v00]
[-0.98 -0.97  0.05  0.05  0.01  0.01  0.01  0.01  0.01  0.01  0.01 -0.01 -0.01  0.
  0.   -0.   -0.   -0.    0.   -0.  ]
block:  4
name:  burgers-2-upwind-sparse0-noise0.001-id5
device:  cuda:1
generate a random number to check random seed:  -2.0580383214170337
current stage is: block-4
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.9219, device='cuda:1', dtype=torch.float64)
u_obs variance
tensor([ 0.2407,  1.6839,  1.6258, 21.1569, 10.2677, 19.0371,  0.2510,  1.6984,
         1.7664, 18.5976, 10.9481, 23.0699], device='cuda:1',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 0.297244
         Iterations: 0
         Function evaluations: 15
         Gradient evaluations: 3
convolution moment and kernels
[[ 1.00e+00  0.00e+00  9.46e-04  3.75e-02 -8.42e-02]
 [ 0.00e+00  5.41e-05  2.86e-03  2.55e-03 -3.12e-03]
 [-6.89e-05  1.56e-03  8.00e-03 -4.14e-03  1.04e-03]
 [-4.66e-02  1.97e-03  6.15e-04 -3.54e-03  8.13e-03]
 [-1.54e-01  7.90e-03 -6.35e-02 -2.62e-03 -6.26e-03]]
[[-0.   -0.05 -0.03 -0.04 -0.01]
 [ 0.01  0.22  0.13  0.19  0.02]
 [-0.1  -0.03  0.33 -0.04 -0.08]
 [-0.01  0.32  0.09  0.26  0.  ]
 [ 0.01 -0.09 -0.03 -0.07  0.  ]]
[[ 0.00e+00  1.00e+00  0.00e+00 -1.00e-01 -6.60e-02]
 [ 0.00e+00  0.00e+00  1.84e-04 -4.35e-06  3.37e-03]
 [ 0.00e+00  1.87e-02  6.26e-03  2.64e-02 -1.55e-02]
 [-1.80e-02 -7.15e-03  3.15e-03  3.54e-03  1.92e-03]
 [ 8.77e-04 -1.96e-02  5.29e-03 -1.11e-02 -3.64e-03]]
[[ 2.78e-03  1.30e-02 -1.63e-02  1.98e-02 -9.37e-03]
 [-3.92e-02  3.17e-02 -3.55e-02 -6.46e-03  2.80e-02]
 [ 1.36e-01 -5.72e-01 -3.30e-01  1.01e+00 -2.36e-01]
 [-3.33e-02  4.40e-03  1.95e-02 -5.56e-04  2.44e-02]
 [ 1.51e-03  2.00e-02 -3.39e-02  1.02e-02 -5.91e-03]]
[[ 0.00e+00  0.00e+00  0.00e+00  8.92e-03  1.26e-02]
 [ 1.00e+00  0.00e+00  2.81e-02 -1.83e-03 -4.44e-03]
 [ 0.00e+00 -2.35e-03 -6.35e-03  1.16e-04  5.11e-03]
 [-9.65e-02  8.92e-04  2.92e-02  2.91e-03 -2.38e-03]
 [-7.54e-02 -2.64e-03 -1.99e-02 -9.95e-04 -4.51e-03]]
[[-4.18e-04 -2.64e-02  1.11e-01 -2.51e-02 -2.55e-03]
 [ 1.52e-02  9.84e-03 -5.13e-01  4.39e-03  2.21e-02]
 [-2.08e-02 -1.96e-02 -3.57e-01 -3.82e-02 -1.65e-02]
 [ 1.98e-02 -2.05e-02  1.06e+00 -1.18e-02  1.87e-02]
 [-5.63e-03  1.55e-02 -2.24e-01  1.16e-02 -4.70e-03]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00 -2.43e-03]
 [ 0.00e+00  0.00e+00  0.00e+00  8.35e-04 -3.90e-03]
 [ 0.00e+00  0.00e+00  1.95e-03  1.12e-04  1.41e-04]
 [ 0.00e+00  4.87e-04 -4.38e-03 -1.40e-03  1.50e-02]
 [ 1.37e-01 -1.20e-03 -6.36e-04  2.15e-03 -3.91e-03]]
[[-1.34e-02  5.26e-02  6.30e-02  4.49e-02 -1.03e-02]
 [ 3.90e-02 -1.46e-01 -3.49e-01 -1.19e-01  2.77e-02]
 [-1.16e-01  1.44e+00 -1.81e+00  1.41e+00 -1.02e-01]
 [ 1.10e-03  1.02e-02 -5.82e-01  2.89e-02 -6.12e-03]
 [ 3.36e-03 -1.75e-02  1.68e-01 -2.15e-02  4.89e-03]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  1.37e-04]
 [ 0.00e+00  1.00e+00  0.00e+00 -1.72e-03  1.01e-03]
 [ 0.00e+00  0.00e+00 -5.92e-04 -1.79e-04  1.49e-03]
 [ 0.00e+00 -3.34e-03  1.59e-03  3.94e-03 -6.25e-04]
 [-3.99e-03 -4.96e-03  4.31e-03  3.08e-03 -7.58e-03]]
[[-0.   -0.02 -0.06  0.09 -0.01]
 [-0.02  0.28  0.24 -0.57  0.08]
 [-0.06  0.27 -0.39  0.19 -0.04]
 [ 0.1  -0.64  0.27  0.32 -0.03]
 [-0.02  0.1  -0.07 -0.03  0.  ]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  5.21e-03]
 [ 0.00e+00  0.00e+00  0.00e+00  1.66e-04  9.74e-04]
 [ 1.00e+00  0.00e+00  2.47e-03  2.74e-03 -2.40e-03]
 [ 0.00e+00  1.00e-04 -2.10e-03 -1.75e-04  3.95e-03]
 [-3.07e-03 -3.99e-05  5.59e-04 -2.80e-03 -1.07e-03]]
[[-1.42e-03  1.00e-02 -1.06e-01  1.58e-02 -4.33e-03]
 [-2.82e-03 -4.44e-03  1.37e+00 -3.33e-02  1.17e-02]
 [ 1.69e-02 -4.65e-02 -2.48e+00  5.43e-04 -6.78e-03]
 [-1.01e-02  2.82e-02  1.32e+00 -2.00e-03  5.08e-03]
 [ 2.65e-03 -8.17e-03 -7.85e-02 -1.89e-03 -4.84e-04]]
SymNet parameters
[[-1.73e-01 -1.12e-01 -8.52e-02  7.68e-02 -2.81e-02  2.32e-02 -1.70e+00  6.07e-03
   1.77e-02 -3.51e-03  6.35e-03  9.17e-04]
 [-2.99e+00  2.13e-01  2.14e-01 -1.21e-01  1.02e-02 -1.59e-02  1.02e+00  3.46e-02
  -1.65e-01  1.62e-03 -7.81e-03  1.05e-02]]
SymNet parameters
[1.21 0.15]
SymNet parameters
[[ 1.86e+00 -2.43e+00 -1.21e-01  9.28e-01 -4.34e-01  2.40e-01  1.58e+00 -1.35e-01
   1.10e+00 -1.88e-02  6.34e-02 -1.08e-01 -1.68e-01]
 [ 2.94e+00 -1.96e-01 -2.14e-01  1.53e-01  3.46e-02  1.82e-02 -1.04e+00 -2.69e-02
   1.71e-01 -2.08e-03  9.97e-03 -9.22e-03 -2.35e-03]]
SymNet parameters
[-0.89 -0.02]
SymNet parameters
[[-1.88e+00  1.22e-01  1.43e-01 -9.59e-02 -1.98e-02 -1.17e-02  6.48e-01  1.50e-02
  -1.01e-01  1.50e-03 -6.38e-03  5.67e-03  2.15e-04  3.48e-04]
 [ 3.91e+00 -7.19e+00 -7.06e-01  2.65e+00 -1.19e+00  6.97e-01 -8.44e-01 -3.14e-01
   2.86e+00 -6.15e-02  1.85e-01 -2.74e-01 -4.23e-01 -2.99e-04]]
SymNet parameters
[-0.07  0.72]
SymNet parameters
[[ 3.56e+00  8.20e-02  1.34e+00  1.84e-02 -2.34e-01  1.84e-02 -1.02e+00 -6.58e-02
   1.53e-01 -1.17e-03  1.83e-03 -1.88e-02  5.08e-02 -4.11e-02 -2.98e-02]
 [ 4.27e-01 -2.55e-01 -3.79e-02  7.05e-02  6.50e-03  1.38e-02 -2.68e+00 -1.71e-02
   8.72e-02 -7.12e-04  4.18e-03  1.29e-03 -1.99e-02  1.22e-03  1.64e-03]]
SymNet parameters
[-0.76  1.62]
SymNet parameters
[[-0.21  3.13  0.62 -2.67  0.25 -0.5   3.1   0.11 -2.33  0.04 -0.21  0.22  1.97 -1.07
  -0.64  0.26]
 [-4.71 -3.66  0.33 -0.11 -0.02  0.05  2.19  0.97 -3.17 -0.06  0.03  0.14 -0.49  0.48
   0.25 -0.02]]
SymNet parameters
[ 0.07 -1.15]
SymNet parameters
[[ 8.39e-01  2.49e-01 -6.29e-01 -1.09e-01  1.04e-01  2.85e-03 -3.52e-01  1.64e-03
  -1.23e-01  4.89e-03 -1.21e-02  1.65e-02  1.97e+00 -1.35e+00 -8.20e-01  2.46e-01
   2.87e-03]]
SymNet parameters
[-0.06]
SymNet parameters
[[-3.00e+00 -6.41e-02  5.10e-01  3.96e-02  5.28e-02  8.59e-04 -4.26e-02  1.68e+00
   2.15e+00 -8.20e-02  1.25e-01  4.56e-01]
 [-9.10e-02  2.10e-02  1.13e-02 -2.70e-03 -1.15e-03  2.10e-03 -1.25e+00 -1.03e-01
   4.69e-02 -5.38e-03  1.44e-02 -2.75e-02]]
SymNet parameters
[1.64 0.6 ]
SymNet parameters
[[ 1.79e-01 -4.74e-02 -2.24e-02  5.56e-03  2.25e-03 -4.21e-03  2.44e+00  2.02e-01
  -9.67e-02  1.16e-02 -2.81e-02  5.49e-02  6.09e-05]
 [ 2.16e+00  5.01e-02 -3.76e-01 -2.78e-02 -3.79e-02 -2.24e-04  3.52e-03 -1.18e+00
  -1.49e+00  5.90e-02 -8.34e-02 -3.26e-01 -5.51e-04]]
SymNet parameters
[-1.48 -0.4 ]
SymNet parameters
[[ 6.50e-01 -1.66e-01  4.92e-01 -6.67e-03  1.31e-02  5.84e-03 -2.91e+00 -5.49e-01
  -1.54e+00 -4.74e-02  3.02e-01 -1.37e-01  4.97e-01 -4.03e-01]
 [ 1.78e+00 -3.81e-03 -1.78e-02 -7.15e-03 -6.14e-03 -2.10e-03 -7.53e-01  7.48e-02
  -3.31e-02  7.83e-03 -4.99e-03 -6.37e-02 -4.87e-02  3.04e-02]]
SymNet parameters
[-0.05 -0.18]
SymNet parameters
[[-3.51e-01  1.78e-02 -1.35e-01 -2.60e-03 -7.97e-03 -4.27e-03 -4.87e+00  3.86e-01
   2.69e-01  3.90e-02 -1.36e-01  3.28e-02  1.06e-01 -1.16e-01 -5.76e-03]
 [ 1.87e+00  3.24e-03  1.58e-02 -4.25e-03 -1.69e-03 -1.12e-03 -1.15e+00 -2.01e-01
  -4.93e-01 -4.67e-03  4.03e-02 -4.67e-02 -3.71e-01  2.70e-01  5.85e-03]]
SymNet parameters
[0.56 0.75]
SymNet parameters
[[ 2.26e+00  4.55e-03 -1.02e-02 -7.11e-03 -4.91e-03 -2.08e-03 -1.16e+00 -2.55e-01
  -2.31e-01 -2.93e-04  2.65e-02 -7.22e-02 -4.05e-01  2.97e-01  3.35e-03  3.23e-03]
 [ 2.66e-01 -7.17e-02  2.54e-01  2.70e-03  1.22e-02  3.51e-03  3.21e+00  7.02e-01
  -5.51e-01 -4.01e-02  1.64e-01 -1.93e-02  5.19e-01 -3.61e-01  3.50e-03 -4.33e-03]]
SymNet parameters
[-0.13  0.13]
SymNet parameters
[[ 0.5  -0.03  0.02  0.    0.   -0.01 -0.22  0.18  0.07  0.06 -0.04  0.13  1.19 -0.78
   0.17 -0.4  -0.51]]
SymNet parameters
[-0.66]
finally, finish this stage
iter:     0    time: 62.02
Func: 2.97e-01  |g|: 1.18e+02
stableloss: 4.16e-02   dataloss: 2.69e-01   sparseloss: 1.65e+02 momentloss: 6.99e+00
current expression:
[u10*v00, u00*u01, u20, u02, u00*u01**2, u01*u10*v00, u00*u11*v00, u10*v00*v10, u01, u00, u01*v00, v00, u00**2*u10, u01**2, u01*u10, u00*u01*v00, u00**2*u01, u10*v00*v01, u00**2*u01*v00, u00*u01*v10]
[-0.98 -0.97  0.05  0.05  0.01  0.01  0.01  0.01  0.01  0.01 -0.    0.   -0.   -0.
  0.    0.   -0.   -0.    0.    0.  ]
[v00*v10, u00*v01, v02, v20, v00*v10**2, u00*v01*v10, u00*v00*v11, v00, u10*v00*v01, u10, u01, 1, u00, u00*u01*v01, v00**2, u10*v00**2, u00**2*u01, v00**3, v10**2, u00*v00]
[-0.98 -0.97  0.05  0.05  0.01  0.01  0.01  0.01  0.01  0.01  0.01 -0.01 -0.01  0.
  0.   -0.   -0.   -0.    0.   -0.  ]
block:  5
name:  burgers-2-upwind-sparse0-noise0.001-id5
device:  cuda:1
generate a random number to check random seed:  -1.0598664394353605
current stage is: block-5
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.8374, device='cuda:1', dtype=torch.float64)
u_obs variance
tensor([ 0.2620,  1.8681,  1.7071, 23.0423, 10.9555, 19.9816,  0.2444,  1.6406,
         1.8458, 18.4058, 10.7371, 25.0762], device='cuda:1',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 0.492374
         Iterations: 0
         Function evaluations: 15
         Gradient evaluations: 3
convolution moment and kernels
[[ 1.00e+00  0.00e+00  9.46e-04  3.75e-02 -8.42e-02]
 [ 0.00e+00  5.41e-05  2.86e-03  2.55e-03 -3.12e-03]
 [-6.90e-05  1.56e-03  8.00e-03 -4.14e-03  1.04e-03]
 [-4.66e-02  1.97e-03  6.15e-04 -3.54e-03  8.13e-03]
 [-1.54e-01  7.90e-03 -6.35e-02 -2.62e-03 -6.26e-03]]
[[-0.   -0.05 -0.03 -0.04 -0.01]
 [ 0.01  0.22  0.13  0.19  0.02]
 [-0.1  -0.03  0.33 -0.04 -0.08]
 [-0.01  0.32  0.09  0.26  0.  ]
 [ 0.01 -0.09 -0.03 -0.07  0.  ]]
[[ 0.00e+00  1.00e+00  0.00e+00 -1.00e-01 -6.60e-02]
 [ 0.00e+00  0.00e+00  1.82e-04 -3.90e-06  3.37e-03]
 [ 0.00e+00  1.87e-02  6.26e-03  2.64e-02 -1.55e-02]
 [-1.80e-02 -7.15e-03  3.15e-03  3.54e-03  1.92e-03]
 [ 8.77e-04 -1.96e-02  5.29e-03 -1.11e-02 -3.64e-03]]
[[ 2.78e-03  1.30e-02 -1.63e-02  1.98e-02 -9.37e-03]
 [-3.92e-02  3.18e-02 -3.55e-02 -6.45e-03  2.80e-02]
 [ 1.36e-01 -5.72e-01 -3.30e-01  1.01e+00 -2.36e-01]
 [-3.33e-02  4.40e-03  1.95e-02 -5.72e-04  2.44e-02]
 [ 1.51e-03  2.00e-02 -3.40e-02  1.02e-02 -5.91e-03]]
[[ 0.00e+00  0.00e+00  0.00e+00  8.92e-03  1.26e-02]
 [ 1.00e+00  0.00e+00  2.81e-02 -1.83e-03 -4.44e-03]
 [ 0.00e+00 -2.35e-03 -6.35e-03  1.16e-04  5.12e-03]
 [-9.65e-02  8.93e-04  2.92e-02  2.91e-03 -2.38e-03]
 [-7.54e-02 -2.64e-03 -1.99e-02 -9.94e-04 -4.51e-03]]
[[-4.21e-04 -2.64e-02  1.11e-01 -2.50e-02 -2.55e-03]
 [ 1.52e-02  9.79e-03 -5.13e-01  4.37e-03  2.21e-02]
 [-2.09e-02 -1.96e-02 -3.57e-01 -3.82e-02 -1.65e-02]
 [ 1.98e-02 -2.06e-02  1.06e+00 -1.19e-02  1.87e-02]
 [-5.63e-03  1.55e-02 -2.24e-01  1.16e-02 -4.70e-03]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00 -2.43e-03]
 [ 0.00e+00  0.00e+00  0.00e+00  8.35e-04 -3.90e-03]
 [ 0.00e+00  0.00e+00  1.95e-03  1.12e-04  1.41e-04]
 [ 0.00e+00  4.87e-04 -4.38e-03 -1.40e-03  1.50e-02]
 [ 1.37e-01 -1.20e-03 -6.36e-04  2.15e-03 -3.91e-03]]
[[-1.34e-02  5.26e-02  6.30e-02  4.49e-02 -1.03e-02]
 [ 3.90e-02 -1.46e-01 -3.49e-01 -1.19e-01  2.77e-02]
 [-1.16e-01  1.44e+00 -1.81e+00  1.41e+00 -1.02e-01]
 [ 1.10e-03  1.02e-02 -5.82e-01  2.89e-02 -6.12e-03]
 [ 3.36e-03 -1.75e-02  1.68e-01 -2.15e-02  4.89e-03]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  1.37e-04]
 [ 0.00e+00  1.00e+00  0.00e+00 -1.72e-03  1.01e-03]
 [ 0.00e+00  0.00e+00 -5.92e-04 -1.79e-04  1.49e-03]
 [ 0.00e+00 -3.34e-03  1.59e-03  3.94e-03 -6.25e-04]
 [-3.99e-03 -4.96e-03  4.31e-03  3.08e-03 -7.58e-03]]
[[-0.   -0.02 -0.06  0.09 -0.01]
 [-0.02  0.28  0.24 -0.57  0.08]
 [-0.06  0.27 -0.39  0.19 -0.04]
 [ 0.1  -0.64  0.27  0.32 -0.03]
 [-0.02  0.1  -0.07 -0.03  0.  ]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  5.21e-03]
 [ 0.00e+00  0.00e+00  0.00e+00  1.66e-04  9.75e-04]
 [ 1.00e+00  0.00e+00  2.47e-03  2.74e-03 -2.40e-03]
 [ 0.00e+00  1.00e-04 -2.10e-03 -1.75e-04  3.95e-03]
 [-3.07e-03 -3.99e-05  5.59e-04 -2.80e-03 -1.07e-03]]
[[-1.42e-03  1.00e-02 -1.06e-01  1.58e-02 -4.33e-03]
 [-2.82e-03 -4.45e-03  1.37e+00 -3.33e-02  1.17e-02]
 [ 1.69e-02 -4.65e-02 -2.48e+00  5.55e-04 -6.78e-03]
 [-1.01e-02  2.82e-02  1.32e+00 -2.01e-03  5.08e-03]
 [ 2.65e-03 -8.17e-03 -7.85e-02 -1.89e-03 -4.85e-04]]
SymNet parameters
[[-1.73e-01 -1.12e-01 -8.52e-02  7.68e-02 -2.81e-02  2.32e-02 -1.70e+00  6.06e-03
   1.77e-02 -3.53e-03  6.36e-03  9.01e-04]
 [-2.99e+00  2.13e-01  2.14e-01 -1.21e-01  1.02e-02 -1.60e-02  1.02e+00  3.47e-02
  -1.65e-01  1.64e-03 -7.82e-03  1.05e-02]]
SymNet parameters
[1.21 0.15]
SymNet parameters
[[ 1.86e+00 -2.43e+00 -1.21e-01  9.28e-01 -4.34e-01  2.40e-01  1.58e+00 -1.35e-01
   1.10e+00 -1.88e-02  6.34e-02 -1.08e-01 -1.68e-01]
 [ 2.94e+00 -1.96e-01 -2.14e-01  1.53e-01  3.45e-02  1.82e-02 -1.04e+00 -2.69e-02
   1.71e-01 -2.10e-03  9.99e-03 -9.24e-03 -2.32e-03]]
SymNet parameters
[-0.89 -0.02]
SymNet parameters
[[-1.88e+00  1.22e-01  1.43e-01 -9.59e-02 -1.98e-02 -1.16e-02  6.48e-01  1.50e-02
  -1.01e-01  1.45e-03 -6.32e-03  5.63e-03  3.77e-04 -5.95e-04]
 [ 3.91e+00 -7.19e+00 -7.06e-01  2.65e+00 -1.19e+00  6.97e-01 -8.44e-01 -3.14e-01
   2.86e+00 -6.14e-02  1.85e-01 -2.74e-01 -4.23e-01 -1.70e-04]]
SymNet parameters
[-0.07  0.72]
SymNet parameters
[[ 3.56e+00  8.20e-02  1.34e+00  1.84e-02 -2.34e-01  1.84e-02 -1.02e+00 -6.58e-02
   1.53e-01 -1.16e-03  1.82e-03 -1.88e-02  5.07e-02 -4.10e-02 -2.99e-02]
 [ 4.27e-01 -2.55e-01 -3.78e-02  7.05e-02  6.50e-03  1.38e-02 -2.68e+00 -1.71e-02
   8.72e-02 -7.09e-04  4.17e-03  1.30e-03 -1.99e-02  1.31e-03  1.45e-03]]
SymNet parameters
[-0.76  1.62]
SymNet parameters
[[-0.21  3.13  0.62 -2.67  0.25 -0.5   3.1   0.11 -2.33  0.04 -0.21  0.22  1.97 -1.07
  -0.64  0.26]
 [-4.71 -3.66  0.33 -0.11 -0.02  0.05  2.19  0.97 -3.17 -0.06  0.03  0.14 -0.49  0.48
   0.25 -0.02]]
SymNet parameters
[ 0.07 -1.15]
SymNet parameters
[[ 8.39e-01  2.49e-01 -6.29e-01 -1.09e-01  1.04e-01  2.85e-03 -3.52e-01  1.65e-03
  -1.23e-01  4.89e-03 -1.22e-02  1.65e-02  1.97e+00 -1.35e+00 -8.20e-01  2.46e-01
   2.77e-03]]
SymNet parameters
[-0.06]
SymNet parameters
[[-3.00e+00 -6.41e-02  5.10e-01  3.96e-02  5.28e-02  8.57e-04 -4.26e-02  1.68e+00
   2.15e+00 -8.20e-02  1.25e-01  4.56e-01]
 [-9.10e-02  2.10e-02  1.13e-02 -2.70e-03 -1.16e-03  2.09e-03 -1.25e+00 -1.03e-01
   4.69e-02 -5.40e-03  1.44e-02 -2.75e-02]]
SymNet parameters
[1.64 0.6 ]
SymNet parameters
[[ 1.79e-01 -4.74e-02 -2.24e-02  5.55e-03  2.25e-03 -4.22e-03  2.44e+00  2.02e-01
  -9.67e-02  1.15e-02 -2.82e-02  5.49e-02 -5.89e-08]
 [ 2.16e+00  5.00e-02 -3.76e-01 -2.78e-02 -3.79e-02 -2.26e-04  3.52e-03 -1.18e+00
  -1.49e+00  5.90e-02 -8.34e-02 -3.26e-01 -5.99e-04]]
SymNet parameters
[-1.48 -0.4 ]
SymNet parameters
[[ 6.50e-01 -1.66e-01  4.92e-01 -6.67e-03  1.31e-02  5.84e-03 -2.91e+00 -5.49e-01
  -1.54e+00 -4.74e-02  3.02e-01 -1.37e-01  4.97e-01 -4.03e-01]
 [ 1.78e+00 -3.82e-03 -1.78e-02 -7.15e-03 -6.14e-03 -2.10e-03 -7.53e-01  7.48e-02
  -3.31e-02  7.83e-03 -4.99e-03 -6.37e-02 -4.87e-02  3.04e-02]]
SymNet parameters
[-0.05 -0.18]
SymNet parameters
[[-3.51e-01  1.78e-02 -1.35e-01 -2.60e-03 -7.97e-03 -4.26e-03 -4.87e+00  3.86e-01
   2.69e-01  3.90e-02 -1.36e-01  3.28e-02  1.06e-01 -1.16e-01 -5.74e-03]
 [ 1.87e+00  3.24e-03  1.58e-02 -4.26e-03 -1.69e-03 -1.12e-03 -1.15e+00 -2.01e-01
  -4.93e-01 -4.66e-03  4.03e-02 -4.67e-02 -3.71e-01  2.70e-01  5.85e-03]]
SymNet parameters
[0.56 0.75]
SymNet parameters
[[ 2.26e+00  4.55e-03 -1.02e-02 -7.11e-03 -4.91e-03 -2.08e-03 -1.16e+00 -2.55e-01
  -2.31e-01 -3.02e-04  2.65e-02 -7.22e-02 -4.05e-01  2.97e-01  3.37e-03  3.22e-03]
 [ 2.66e-01 -7.17e-02  2.54e-01  2.70e-03  1.22e-02  3.51e-03  3.21e+00  7.02e-01
  -5.51e-01 -4.01e-02  1.64e-01 -1.93e-02  5.19e-01 -3.61e-01  3.52e-03 -4.32e-03]]
SymNet parameters
[-0.13  0.13]
SymNet parameters
[[ 0.5  -0.03  0.02  0.    0.   -0.01 -0.22  0.18  0.07  0.06 -0.04  0.13  1.19 -0.78
   0.17 -0.4  -0.51]]
SymNet parameters
[-0.66]
finally, finish this stage
iter:     0    time: 62.31
Func: 4.92e-01  |g|: 2.29e+02
stableloss: 5.08e-02   dataloss: 4.57e-01   sparseloss: 1.65e+02 momentloss: 6.99e+00
current expression:
[u10*v00, u00*u01, u20, u02, u00*u01**2, u01*u10*v00, u00*u11*v00, u10*v00*v10, u01, u00, u01*v00, v00, u00**2*u10, u01**2, u01*u10, u00*u01*v00, u00**2*u01, u10*v00*v01, u00**2*u01*v00, u00*u01*v10]
[-0.98 -0.97  0.05  0.05  0.01  0.01  0.01  0.01  0.01  0.01 -0.    0.   -0.   -0.
  0.    0.   -0.   -0.    0.    0.  ]
[v00*v10, u00*v01, v02, v20, v00*v10**2, u00*v01*v10, u00*v00*v11, v00, u10*v00*v01, u10, u01, 1, u00, u00*u01*v01, v00**2, u10*v00**2, u00**2*u01, v00**3, v10**2, u00*v00]
[-0.98 -0.97  0.05  0.05  0.01  0.01  0.01  0.01  0.01  0.01  0.01 -0.01 -0.01  0.
  0.   -0.   -0.   -0.    0.   -0.  ]
block:  6
name:  burgers-2-upwind-sparse0-noise0.001-id5
device:  cuda:1
generate a random number to check random seed:  -0.49853039680226724
current stage is: block-6
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.8865, device='cuda:1', dtype=torch.float64)
u_obs variance
tensor([ 0.2479,  1.7618,  1.6442, 22.1977, 10.3419, 19.4142,  0.2800,  1.9476,
         1.9058, 21.8483, 11.6473, 24.9440], device='cuda:1',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 0.860940
         Iterations: 0
         Function evaluations: 15
         Gradient evaluations: 3
convolution moment and kernels
[[ 1.00e+00  0.00e+00  9.46e-04  3.75e-02 -8.42e-02]
 [ 0.00e+00  5.39e-05  2.86e-03  2.55e-03 -3.12e-03]
 [-6.89e-05  1.56e-03  8.00e-03 -4.14e-03  1.04e-03]
 [-4.66e-02  1.97e-03  6.15e-04 -3.54e-03  8.13e-03]
 [-1.54e-01  7.90e-03 -6.35e-02 -2.62e-03 -6.26e-03]]
[[-0.   -0.05 -0.03 -0.04 -0.01]
 [ 0.01  0.22  0.13  0.19  0.02]
 [-0.1  -0.03  0.33 -0.04 -0.08]
 [-0.01  0.32  0.09  0.26  0.  ]
 [ 0.01 -0.09 -0.03 -0.07  0.  ]]
[[ 0.00e+00  1.00e+00  0.00e+00 -1.00e-01 -6.60e-02]
 [ 0.00e+00  0.00e+00  1.82e-04 -4.00e-06  3.37e-03]
 [ 0.00e+00  1.87e-02  6.26e-03  2.64e-02 -1.55e-02]
 [-1.80e-02 -7.15e-03  3.15e-03  3.54e-03  1.92e-03]
 [ 8.77e-04 -1.96e-02  5.29e-03 -1.11e-02 -3.64e-03]]
[[ 2.79e-03  1.30e-02 -1.63e-02  1.98e-02 -9.37e-03]
 [-3.92e-02  3.18e-02 -3.56e-02 -6.42e-03  2.79e-02]
 [ 1.36e-01 -5.72e-01 -3.30e-01  1.01e+00 -2.36e-01]
 [-3.33e-02  4.43e-03  1.95e-02 -5.43e-04  2.44e-02]
 [ 1.51e-03  2.00e-02 -3.39e-02  1.02e-02 -5.91e-03]]
[[ 0.00e+00  0.00e+00  0.00e+00  8.92e-03  1.26e-02]
 [ 1.00e+00  0.00e+00  2.81e-02 -1.83e-03 -4.44e-03]
 [ 0.00e+00 -2.35e-03 -6.35e-03  1.16e-04  5.11e-03]
 [-9.65e-02  8.93e-04  2.92e-02  2.91e-03 -2.38e-03]
 [-7.54e-02 -2.64e-03 -1.99e-02 -9.94e-04 -4.51e-03]]
[[-4.19e-04 -2.64e-02  1.11e-01 -2.51e-02 -2.55e-03]
 [ 1.52e-02  9.83e-03 -5.13e-01  4.41e-03  2.21e-02]
 [-2.08e-02 -1.96e-02 -3.57e-01 -3.82e-02 -1.65e-02]
 [ 1.98e-02 -2.06e-02  1.06e+00 -1.18e-02  1.87e-02]
 [-5.63e-03  1.55e-02 -2.24e-01  1.16e-02 -4.70e-03]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00 -2.43e-03]
 [ 0.00e+00  0.00e+00  0.00e+00  8.35e-04 -3.90e-03]
 [ 0.00e+00  0.00e+00  1.95e-03  1.12e-04  1.41e-04]
 [ 0.00e+00  4.87e-04 -4.38e-03 -1.40e-03  1.50e-02]
 [ 1.37e-01 -1.20e-03 -6.37e-04  2.15e-03 -3.91e-03]]
[[-1.34e-02  5.26e-02  6.30e-02  4.49e-02 -1.03e-02]
 [ 3.90e-02 -1.46e-01 -3.49e-01 -1.19e-01  2.77e-02]
 [-1.16e-01  1.44e+00 -1.81e+00  1.41e+00 -1.02e-01]
 [ 1.10e-03  1.02e-02 -5.82e-01  2.90e-02 -6.12e-03]
 [ 3.36e-03 -1.75e-02  1.68e-01 -2.15e-02  4.89e-03]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  1.37e-04]
 [ 0.00e+00  1.00e+00  0.00e+00 -1.72e-03  1.01e-03]
 [ 0.00e+00  0.00e+00 -5.92e-04 -1.79e-04  1.49e-03]
 [ 0.00e+00 -3.34e-03  1.59e-03  3.94e-03 -6.25e-04]
 [-3.99e-03 -4.96e-03  4.31e-03  3.08e-03 -7.58e-03]]
[[-0.   -0.02 -0.06  0.09 -0.01]
 [-0.02  0.28  0.24 -0.57  0.08]
 [-0.06  0.27 -0.39  0.19 -0.04]
 [ 0.1  -0.64  0.27  0.32 -0.03]
 [-0.02  0.1  -0.07 -0.03  0.  ]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  5.21e-03]
 [ 0.00e+00  0.00e+00  0.00e+00  1.66e-04  9.75e-04]
 [ 1.00e+00  0.00e+00  2.47e-03  2.74e-03 -2.40e-03]
 [ 0.00e+00  1.00e-04 -2.10e-03 -1.75e-04  3.95e-03]
 [-3.07e-03 -4.00e-05  5.59e-04 -2.80e-03 -1.07e-03]]
[[-1.42e-03  1.00e-02 -1.06e-01  1.58e-02 -4.33e-03]
 [-2.82e-03 -4.44e-03  1.37e+00 -3.33e-02  1.17e-02]
 [ 1.69e-02 -4.65e-02 -2.48e+00  5.36e-04 -6.78e-03]
 [-1.01e-02  2.82e-02  1.32e+00 -2.00e-03  5.08e-03]
 [ 2.65e-03 -8.17e-03 -7.85e-02 -1.89e-03 -4.84e-04]]
SymNet parameters
[[-1.73e-01 -1.12e-01 -8.52e-02  7.68e-02 -2.81e-02  2.32e-02 -1.70e+00  6.07e-03
   1.77e-02 -3.54e-03  6.37e-03  8.97e-04]
 [-2.99e+00  2.13e-01  2.14e-01 -1.21e-01  1.02e-02 -1.59e-02  1.02e+00  3.47e-02
  -1.65e-01  1.64e-03 -7.82e-03  1.05e-02]]
SymNet parameters
[1.21 0.15]
SymNet parameters
[[ 1.86e+00 -2.43e+00 -1.21e-01  9.28e-01 -4.34e-01  2.40e-01  1.58e+00 -1.35e-01
   1.10e+00 -1.88e-02  6.34e-02 -1.08e-01 -1.68e-01]
 [ 2.94e+00 -1.96e-01 -2.14e-01  1.53e-01  3.45e-02  1.82e-02 -1.04e+00 -2.69e-02
   1.71e-01 -2.08e-03  9.99e-03 -9.23e-03 -2.37e-03]]
SymNet parameters
[-0.89 -0.02]
SymNet parameters
[[-1.88e+00  1.22e-01  1.43e-01 -9.59e-02 -1.98e-02 -1.16e-02  6.48e-01  1.50e-02
  -1.01e-01  1.48e-03 -6.33e-03  5.63e-03  3.08e-04  3.05e-04]
 [ 3.91e+00 -7.19e+00 -7.06e-01  2.65e+00 -1.19e+00  6.97e-01 -8.44e-01 -3.14e-01
   2.86e+00 -6.14e-02  1.85e-01 -2.74e-01 -4.23e-01 -2.12e-04]]
SymNet parameters
[-0.07  0.72]
SymNet parameters
[[ 3.56e+00  8.20e-02  1.34e+00  1.84e-02 -2.34e-01  1.84e-02 -1.02e+00 -6.58e-02
   1.53e-01 -1.16e-03  1.82e-03 -1.88e-02  5.07e-02 -4.11e-02 -2.99e-02]
 [ 4.27e-01 -2.55e-01 -3.78e-02  7.05e-02  6.50e-03  1.38e-02 -2.68e+00 -1.71e-02
   8.72e-02 -7.08e-04  4.17e-03  1.30e-03 -1.99e-02  1.29e-03  1.50e-03]]
SymNet parameters
[-0.76  1.62]
SymNet parameters
[[-0.21  3.13  0.62 -2.67  0.25 -0.5   3.1   0.11 -2.33  0.04 -0.21  0.22  1.97 -1.07
  -0.64  0.26]
 [-4.71 -3.66  0.33 -0.11 -0.02  0.05  2.19  0.97 -3.17 -0.06  0.03  0.14 -0.49  0.48
   0.25 -0.02]]
SymNet parameters
[ 0.07 -1.15]
SymNet parameters
[[ 8.39e-01  2.49e-01 -6.29e-01 -1.09e-01  1.04e-01  2.85e-03 -3.52e-01  1.64e-03
  -1.23e-01  4.89e-03 -1.22e-02  1.65e-02  1.97e+00 -1.35e+00 -8.20e-01  2.46e-01
   2.91e-03]]
SymNet parameters
[-0.06]
SymNet parameters
[[-3.00e+00 -6.41e-02  5.10e-01  3.96e-02  5.28e-02  8.53e-04 -4.26e-02  1.68e+00
   2.15e+00 -8.20e-02  1.25e-01  4.56e-01]
 [-9.10e-02  2.10e-02  1.13e-02 -2.69e-03 -1.15e-03  2.08e-03 -1.25e+00 -1.03e-01
   4.69e-02 -5.43e-03  1.44e-02 -2.75e-02]]
SymNet parameters
[1.64 0.6 ]
SymNet parameters
[[ 1.79e-01 -4.74e-02 -2.24e-02  5.56e-03  2.26e-03 -4.22e-03  2.44e+00  2.02e-01
  -9.67e-02  1.15e-02 -2.82e-02  5.49e-02 -4.09e-05]
 [ 2.16e+00  5.00e-02 -3.76e-01 -2.78e-02 -3.79e-02 -2.31e-04  3.53e-03 -1.18e+00
  -1.49e+00  5.89e-02 -8.34e-02 -3.26e-01 -6.31e-04]]
SymNet parameters
[-1.48 -0.4 ]
SymNet parameters
[[ 6.50e-01 -1.66e-01  4.92e-01 -6.67e-03  1.31e-02  5.84e-03 -2.91e+00 -5.49e-01
  -1.54e+00 -4.74e-02  3.02e-01 -1.37e-01  4.97e-01 -4.03e-01]
 [ 1.78e+00 -3.82e-03 -1.78e-02 -7.15e-03 -6.14e-03 -2.11e-03 -7.53e-01  7.48e-02
  -3.31e-02  7.83e-03 -4.99e-03 -6.37e-02 -4.87e-02  3.04e-02]]
SymNet parameters
[-0.05 -0.18]
SymNet parameters
[[-3.51e-01  1.78e-02 -1.35e-01 -2.60e-03 -7.97e-03 -4.27e-03 -4.87e+00  3.86e-01
   2.69e-01  3.90e-02 -1.36e-01  3.28e-02  1.06e-01 -1.16e-01 -5.74e-03]
 [ 1.87e+00  3.24e-03  1.58e-02 -4.25e-03 -1.69e-03 -1.11e-03 -1.15e+00 -2.01e-01
  -4.93e-01 -4.65e-03  4.03e-02 -4.67e-02 -3.71e-01  2.70e-01  5.85e-03]]
SymNet parameters
[0.56 0.75]
SymNet parameters
[[ 2.26e+00  4.55e-03 -1.02e-02 -7.11e-03 -4.91e-03 -2.09e-03 -1.16e+00 -2.55e-01
  -2.31e-01 -3.07e-04  2.65e-02 -7.23e-02 -4.05e-01  2.97e-01  3.36e-03  3.21e-03]
 [ 2.66e-01 -7.17e-02  2.54e-01  2.70e-03  1.22e-02  3.51e-03  3.21e+00  7.02e-01
  -5.51e-01 -4.01e-02  1.64e-01 -1.93e-02  5.19e-01 -3.61e-01  3.54e-03 -4.33e-03]]
SymNet parameters
[-0.13  0.13]
SymNet parameters
[[ 0.5  -0.03  0.02  0.    0.   -0.01 -0.22  0.18  0.07  0.06 -0.04  0.13  1.19 -0.78
   0.17 -0.4  -0.51]]
SymNet parameters
[-0.66]
finally, finish this stage
iter:     0    time: 60.01
Func: 8.61e-01  |g|: 6.37e+02
stableloss: 6.08e-02   dataloss: 8.19e-01   sparseloss: 1.65e+02 momentloss: 6.99e+00
current expression:
[u10*v00, u00*u01, u20, u02, u00*u01**2, u01*u10*v00, u00*u11*v00, u10*v00*v10, u01, u00, u01*v00, v00, u00**2*u10, u01**2, u01*u10, u00*u01*v00, u00**2*u01, u10*v00*v01, u00**2*u01*v00, u00*u01*v10]
[-0.98 -0.97  0.05  0.05  0.01  0.01  0.01  0.01  0.01  0.01 -0.    0.   -0.   -0.
  0.    0.   -0.   -0.    0.    0.  ]
[v00*v10, u00*v01, v02, v20, v00*v10**2, u00*v01*v10, u00*v00*v11, v00, u10*v00*v01, u10, u01, 1, u00, u00*u01*v01, v00**2, u10*v00**2, u00**2*u01, v00**3, v10**2, u00*v00]
[-0.98 -0.97  0.05  0.05  0.01  0.01  0.01  0.01  0.01  0.01  0.01 -0.01 -0.01  0.
  0.   -0.   -0.   -0.    0.   -0.  ]
block:  9
name:  burgers-2-upwind-sparse0-noise0.001-id5
device:  cuda:1
generate a random number to check random seed:  0.1962960545718519
current stage is: block-9
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.8032, device='cuda:1', dtype=torch.float64)
u_obs variance
tensor([ 0.2330,  1.5271,  1.5162, 18.3844,  8.8111, 17.7515,  0.2504,  1.6517,
         1.7300, 18.3272, 10.1174, 22.8984], device='cuda:1',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 1.735330
         Iterations: 0
         Function evaluations: 15
         Gradient evaluations: 3
convolution moment and kernels
[[ 1.00e+00  0.00e+00  9.45e-04  3.75e-02 -8.42e-02]
 [ 0.00e+00  5.38e-05  2.86e-03  2.55e-03 -3.12e-03]
 [-7.00e-05  1.56e-03  8.00e-03 -4.14e-03  1.04e-03]
 [-4.66e-02  1.97e-03  6.15e-04 -3.54e-03  8.13e-03]
 [-1.54e-01  7.90e-03 -6.35e-02 -2.62e-03 -6.26e-03]]
[[-0.   -0.05 -0.03 -0.04 -0.01]
 [ 0.01  0.22  0.13  0.19  0.02]
 [-0.1  -0.03  0.33 -0.04 -0.08]
 [-0.01  0.32  0.09  0.26  0.  ]
 [ 0.01 -0.09 -0.03 -0.07  0.  ]]
[[ 0.00e+00  1.00e+00  0.00e+00 -1.00e-01 -6.60e-02]
 [ 0.00e+00  0.00e+00  1.83e-04 -4.44e-06  3.37e-03]
 [ 0.00e+00  1.87e-02  6.26e-03  2.64e-02 -1.55e-02]
 [-1.80e-02 -7.15e-03  3.15e-03  3.54e-03  1.92e-03]
 [ 8.79e-04 -1.96e-02  5.29e-03 -1.11e-02 -3.64e-03]]
[[ 2.79e-03  1.30e-02 -1.63e-02  1.98e-02 -9.37e-03]
 [-3.92e-02  3.18e-02 -3.56e-02 -6.44e-03  2.79e-02]
 [ 1.36e-01 -5.72e-01 -3.30e-01  1.01e+00 -2.36e-01]
 [-3.33e-02  4.42e-03  1.95e-02 -5.59e-04  2.44e-02]
 [ 1.51e-03  2.00e-02 -3.39e-02  1.02e-02 -5.91e-03]]
[[ 0.00e+00  0.00e+00  0.00e+00  8.92e-03  1.26e-02]
 [ 1.00e+00  0.00e+00  2.81e-02 -1.83e-03 -4.44e-03]
 [ 0.00e+00 -2.35e-03 -6.35e-03  1.16e-04  5.11e-03]
 [-9.65e-02  8.92e-04  2.92e-02  2.91e-03 -2.38e-03]
 [-7.54e-02 -2.64e-03 -1.99e-02 -9.94e-04 -4.51e-03]]
[[-4.19e-04 -2.64e-02  1.11e-01 -2.51e-02 -2.55e-03]
 [ 1.52e-02  9.83e-03 -5.13e-01  4.39e-03  2.21e-02]
 [-2.08e-02 -1.96e-02 -3.57e-01 -3.82e-02 -1.65e-02]
 [ 1.98e-02 -2.06e-02  1.06e+00 -1.19e-02  1.87e-02]
 [-5.63e-03  1.55e-02 -2.24e-01  1.16e-02 -4.70e-03]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00 -2.43e-03]
 [ 0.00e+00  0.00e+00  0.00e+00  8.35e-04 -3.90e-03]
 [ 0.00e+00  0.00e+00  1.95e-03  1.12e-04  1.41e-04]
 [ 0.00e+00  4.87e-04 -4.38e-03 -1.40e-03  1.50e-02]
 [ 1.37e-01 -1.20e-03 -6.36e-04  2.15e-03 -3.91e-03]]
[[-1.34e-02  5.26e-02  6.30e-02  4.49e-02 -1.03e-02]
 [ 3.90e-02 -1.46e-01 -3.49e-01 -1.19e-01  2.77e-02]
 [-1.16e-01  1.44e+00 -1.81e+00  1.41e+00 -1.02e-01]
 [ 1.10e-03  1.02e-02 -5.82e-01  2.89e-02 -6.12e-03]
 [ 3.36e-03 -1.75e-02  1.68e-01 -2.15e-02  4.89e-03]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  1.37e-04]
 [ 0.00e+00  1.00e+00  0.00e+00 -1.72e-03  1.01e-03]
 [ 0.00e+00  0.00e+00 -5.92e-04 -1.79e-04  1.49e-03]
 [ 0.00e+00 -3.34e-03  1.59e-03  3.94e-03 -6.25e-04]
 [-3.99e-03 -4.96e-03  4.31e-03  3.08e-03 -7.58e-03]]
[[-0.   -0.02 -0.06  0.09 -0.01]
 [-0.02  0.28  0.24 -0.57  0.08]
 [-0.06  0.27 -0.39  0.19 -0.04]
 [ 0.1  -0.64  0.27  0.32 -0.03]
 [-0.02  0.1  -0.07 -0.03  0.  ]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  5.21e-03]
 [ 0.00e+00  0.00e+00  0.00e+00  1.66e-04  9.75e-04]
 [ 1.00e+00  0.00e+00  2.47e-03  2.74e-03 -2.40e-03]
 [ 0.00e+00  1.00e-04 -2.10e-03 -1.75e-04  3.95e-03]
 [-3.07e-03 -3.98e-05  5.59e-04 -2.80e-03 -1.07e-03]]
[[-1.42e-03  1.00e-02 -1.06e-01  1.58e-02 -4.33e-03]
 [-2.82e-03 -4.44e-03  1.37e+00 -3.33e-02  1.17e-02]
 [ 1.69e-02 -4.65e-02 -2.48e+00  5.50e-04 -6.78e-03]
 [-1.01e-02  2.82e-02  1.32e+00 -2.01e-03  5.08e-03]
 [ 2.65e-03 -8.17e-03 -7.85e-02 -1.89e-03 -4.85e-04]]
SymNet parameters
[[-1.73e-01 -1.12e-01 -8.52e-02  7.68e-02 -2.81e-02  2.32e-02 -1.70e+00  6.04e-03
   1.77e-02 -3.49e-03  6.37e-03  9.11e-04]
 [-2.99e+00  2.13e-01  2.14e-01 -1.21e-01  1.02e-02 -1.59e-02  1.02e+00  3.47e-02
  -1.65e-01  1.63e-03 -7.83e-03  1.05e-02]]
SymNet parameters
[1.21 0.15]
SymNet parameters
[[ 1.86e+00 -2.43e+00 -1.21e-01  9.28e-01 -4.34e-01  2.40e-01  1.58e+00 -1.35e-01
   1.10e+00 -1.88e-02  6.34e-02 -1.08e-01 -1.67e-01]
 [ 2.94e+00 -1.96e-01 -2.14e-01  1.53e-01  3.45e-02  1.82e-02 -1.04e+00 -2.69e-02
   1.71e-01 -2.12e-03  1.00e-02 -9.28e-03 -2.37e-03]]
SymNet parameters
[-0.89 -0.02]
SymNet parameters
[[-1.88e+00  1.22e-01  1.43e-01 -9.58e-02 -1.98e-02 -1.16e-02  6.48e-01  1.50e-02
  -1.01e-01  1.43e-03 -6.28e-03  5.58e-03  3.87e-04 -3.79e-04]
 [ 3.91e+00 -7.19e+00 -7.06e-01  2.65e+00 -1.19e+00  6.97e-01 -8.44e-01 -3.14e-01
   2.86e+00 -6.15e-02  1.85e-01 -2.74e-01 -4.23e-01 -2.95e-04]]
SymNet parameters
[-0.07  0.72]
SymNet parameters
[[ 3.56e+00  8.20e-02  1.34e+00  1.84e-02 -2.34e-01  1.84e-02 -1.02e+00 -6.58e-02
   1.53e-01 -1.17e-03  1.82e-03 -1.88e-02  5.07e-02 -4.11e-02 -2.98e-02]
 [ 4.27e-01 -2.55e-01 -3.79e-02  7.05e-02  6.50e-03  1.38e-02 -2.68e+00 -1.71e-02
   8.72e-02 -7.12e-04  4.18e-03  1.30e-03 -1.99e-02  1.25e-03  1.56e-03]]
SymNet parameters
[-0.76  1.62]
SymNet parameters
[[-0.21  3.13  0.62 -2.67  0.25 -0.5   3.1   0.11 -2.33  0.04 -0.21  0.22  1.97 -1.07
  -0.64  0.26]
 [-4.71 -3.66  0.33 -0.11 -0.02  0.05  2.19  0.97 -3.17 -0.06  0.03  0.14 -0.49  0.48
   0.25 -0.02]]
SymNet parameters
[ 0.07 -1.15]
SymNet parameters
[[ 8.39e-01  2.49e-01 -6.29e-01 -1.09e-01  1.04e-01  2.85e-03 -3.52e-01  1.65e-03
  -1.23e-01  4.89e-03 -1.22e-02  1.65e-02  1.97e+00 -1.35e+00 -8.20e-01  2.46e-01
   3.01e-03]]
SymNet parameters
[-0.06]
SymNet parameters
[[-3.00e+00 -6.41e-02  5.10e-01  3.96e-02  5.28e-02  8.47e-04 -4.26e-02  1.68e+00
   2.15e+00 -8.20e-02  1.25e-01  4.56e-01]
 [-9.10e-02  2.10e-02  1.13e-02 -2.73e-03 -1.15e-03  2.09e-03 -1.25e+00 -1.03e-01
   4.69e-02 -5.37e-03  1.44e-02 -2.76e-02]]
SymNet parameters
[1.64 0.6 ]
SymNet parameters
[[ 1.79e-01 -4.74e-02 -2.24e-02  5.54e-03  2.25e-03 -4.22e-03  2.44e+00  2.02e-01
  -9.67e-02  1.16e-02 -2.81e-02  5.48e-02  2.75e-05]
 [ 2.16e+00  5.00e-02 -3.76e-01 -2.78e-02 -3.79e-02 -2.39e-04  3.52e-03 -1.18e+00
  -1.49e+00  5.90e-02 -8.34e-02 -3.26e-01 -5.44e-04]]
SymNet parameters
[-1.48 -0.4 ]
SymNet parameters
[[ 6.50e-01 -1.66e-01  4.92e-01 -6.66e-03  1.31e-02  5.84e-03 -2.91e+00 -5.49e-01
  -1.54e+00 -4.74e-02  3.02e-01 -1.37e-01  4.97e-01 -4.03e-01]
 [ 1.78e+00 -3.81e-03 -1.78e-02 -7.15e-03 -6.13e-03 -2.10e-03 -7.53e-01  7.48e-02
  -3.31e-02  7.83e-03 -4.99e-03 -6.37e-02 -4.87e-02  3.04e-02]]
SymNet parameters
[-0.05 -0.18]
SymNet parameters
[[-3.51e-01  1.78e-02 -1.35e-01 -2.61e-03 -7.97e-03 -4.27e-03 -4.87e+00  3.86e-01
   2.69e-01  3.90e-02 -1.36e-01  3.28e-02  1.06e-01 -1.16e-01 -5.73e-03]
 [ 1.87e+00  3.24e-03  1.58e-02 -4.25e-03 -1.70e-03 -1.11e-03 -1.15e+00 -2.01e-01
  -4.93e-01 -4.67e-03  4.03e-02 -4.67e-02 -3.71e-01  2.70e-01  5.87e-03]]
SymNet parameters
[0.56 0.75]
SymNet parameters
[[ 2.26e+00  4.55e-03 -1.02e-02 -7.11e-03 -4.90e-03 -2.10e-03 -1.16e+00 -2.55e-01
  -2.31e-01 -2.93e-04  2.65e-02 -7.23e-02 -4.05e-01  2.97e-01  3.36e-03  3.21e-03]
 [ 2.66e-01 -7.17e-02  2.54e-01  2.69e-03  1.22e-02  3.50e-03  3.21e+00  7.02e-01
  -5.51e-01 -4.01e-02  1.64e-01 -1.93e-02  5.19e-01 -3.61e-01  3.53e-03 -4.31e-03]]
SymNet parameters
[-0.13  0.13]
SymNet parameters
[[ 0.5  -0.03  0.02  0.    0.   -0.01 -0.22  0.18  0.07  0.06 -0.04  0.13  1.19 -0.78
   0.17 -0.4  -0.51]]
SymNet parameters
[-0.66]
finally, finish this stage
iter:     0    time: 58.46
Func: 1.74e+00  |g|: 3.57e+02
stableloss: 7.14e-02   dataloss: 1.67e+00   sparseloss: 1.65e+02 momentloss: 6.99e+00
current expression:
[u10*v00, u00*u01, u20, u02, u00*u01**2, u01*u10*v00, u00*u11*v00, u10*v00*v10, u01, u00, u01*v00, v00, u00**2*u10, u01**2, u01*u10, u00*u01*v00, u00**2*u01, u10*v00*v01, u00**2*u01*v00, u00*u01*v10]
[-0.98 -0.97  0.05  0.05  0.01  0.01  0.01  0.01  0.01  0.01 -0.    0.   -0.   -0.
  0.    0.   -0.   -0.    0.    0.  ]
[v00*v10, u00*v01, v02, v20, v00*v10**2, u00*v01*v10, u00*v00*v11, v00, u10*v00*v01, u10, u01, 1, u00, u00*u01*v01, v00**2, u10*v00**2, u00**2*u01, v00**3, v10**2, u00*v00]
[-0.98 -0.97  0.05  0.05  0.01  0.01  0.01  0.01  0.01  0.01  0.01 -0.01 -0.01  0.
  0.   -0.   -0.   -0.    0.   -0.  ]
u_obs.abs().max()
tensor(3.8390, device='cuda:1', dtype=torch.float64)
model(u_obs[0],T=50*dt).abs().max()
tensor(nan, device='cuda:1', dtype=torch.float64)
model(u_obs[0],T=100*dt).abs().max()
tensor(nan, device='cuda:1', dtype=torch.float64)
{'--name': 'burgers-2-upwind-sparse0-noise0.001-id4', '--dtype': 'double', '--device': 'cuda:0', '--constraint': '2', '--dt': 0.01, '--cell_num': 1, '--eps': 6.283185307179586, '--blocks': [0, 1, 2, 3, 4, 5, 6, 9], '--kernel_size': 5, '--max_order': 2, '--dx': 0.19634954084936207, '--hidden_layers': 5, '--scheme': 'upwind', '--dataname': 'burgers', '--viscosity': 0.05, '--zoom': 4, '--max_dt': 0.000625, '--batch_size': 28, '--data_timescheme': 'rk2', '--channel_names': 'u,v', '--freq': 4, '--data_start_time': 1.0, '--start_noise': 0.001, '--end_noise': 0.001, '--stablize': 0.0, '--sparsity': 0.0, '--momentsparsity': 0.001, '--npseed': -1, '--torchseed': -1, '--maxiter': 2000, '--recordfile': 'None', '--recordcycle': 200, '--savecycle': -1, '--start_from': -1}
block:  0
name:  burgers-2-upwind-sparse0-noise0.001-id4
device:  cuda:0
generate a random number to check random seed:  -0.17430939675877105
current stage is: warmup
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.8984, device='cuda:0', dtype=torch.float64)
u_obs variance
tensor([ 0.2517,  1.9775,  2.0185, 18.5392, 10.0942, 17.8230,  0.2298,  1.8013,
         1.8444, 15.7947,  9.1026, 17.4331], device='cuda:0',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
iter:     0    time: 6.36
Func: 5.69e+00  |g|: 2.80e+00
stableloss: 9.75e-03   dataloss: 5.69e+00   sparseloss: 2.64e+01 momentloss: 7.27e+00
iter:   200    time: 12.85
Func: 4.25e-02  |g|: 1.14e-02
stableloss: 1.47e-02   dataloss: 4.25e-02   sparseloss: 4.77e+01 momentloss: 7.27e+00
iter:   400    time: 10.36
Func: 4.11e-02  |g|: 1.47e-02
stableloss: 1.45e-02   dataloss: 4.11e-02   sparseloss: 6.03e+01 momentloss: 7.27e+00
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 0.040623
         Iterations: 521
         Function evaluations: 597
         Gradient evaluations: 591
convolution moment and kernels
[[1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
[[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 1. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
[[ 0.    1.    0.   -0.33 -0.25]
 [ 0.    0.    0.    0.    0.  ]
 [ 0.    0.    0.    0.    0.  ]
 [ 0.    0.    0.    0.    0.  ]
 [ 0.    0.    0.    0.    0.  ]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]
 [ 2.78e-17  3.33e-16 -1.50e+00  2.00e+00 -5.00e-01]
 [ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]]
[[ 0.    0.    0.    0.    0.  ]
 [ 1.    0.    0.    0.    0.  ]
 [ 0.    0.    0.    0.    0.  ]
 [-0.33  0.    0.    0.    0.  ]
 [-0.25  0.    0.    0.    0.  ]]
[[ 0.00e+00  0.00e+00  2.78e-17  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  3.33e-16  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00 -1.50e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  2.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00 -5.00e-01  0.00e+00  0.00e+00]]
[[0.   0.   1.   0.   0.08]
 [0.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.  ]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]
 [-2.22e-16  1.00e+00 -2.00e+00  1.00e+00 -1.53e-16]
 [ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]]
[[0. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
[[ 6.94e-03 -5.56e-02  9.25e-18  5.56e-02 -6.94e-03]
 [-5.56e-02  4.44e-01 -7.40e-17 -4.44e-01  5.56e-02]
 [ 9.25e-18 -7.40e-17  1.23e-32  7.40e-17 -9.25e-18]
 [ 5.56e-02 -4.44e-01  7.40e-17  4.44e-01 -5.56e-02]
 [-6.94e-03  5.56e-02 -9.25e-18 -5.56e-02  6.94e-03]]
[[0.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.  ]
 [1.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.  ]
 [0.08 0.   0.   0.   0.  ]]
[[ 0.00e+00  0.00e+00 -2.22e-16  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  1.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00 -2.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  1.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00 -1.53e-16  0.00e+00  0.00e+00]]
SymNet parameters
[[ 0.73 -0.5  -0.1   0.1   0.16 -0.13 -1.52  0.03  0.07  0.01  0.01 -0.01]
 [ 0.12 -0.06  0.04  0.04  0.02  0.03 -0.01 -0.01 -0.    0.01  0.   -0.  ]]
SymNet parameters
[0.2  0.22]
SymNet parameters
[[-4.73e-01 -8.53e-02 -8.04e-02 -9.65e-03  4.47e-02 -4.60e-02  1.64e-01 -9.70e-04
   4.72e-04 -5.30e-03 -1.32e-03 -1.25e-02 -1.09e-01]
 [ 8.89e-01 -4.78e-01 -8.57e-02  3.34e-01 -2.54e-02 -4.21e-03 -3.34e-01 -1.77e-01
  -3.30e-02  2.24e-02  3.72e-02 -4.92e-02  2.63e-01]]
SymNet parameters
[-0.27 -0.08]
SymNet parameters
[[-0.96 -0.42  0.32  0.39  0.11  0.16 -1.08 -0.14  0.03  0.06  0.03 -0.04  0.3  -0.06]
 [ 0.69 -0.82  1.26 -0.23 -0.79  0.42 -0.97 -0.18 -0.17 -0.03 -0.    0.07  0.38  0.26]]
SymNet parameters
[0.03 0.05]
SymNet parameters
[[ 2.99e-01 -1.77e-01  5.31e-02  2.13e-03 -2.02e-02  5.17e-03  1.32e+00 -3.32e-03
   9.31e-04 -1.22e-03 -5.78e-04 -8.54e-04  2.10e-02  9.75e-03 -4.95e-04]
 [ 1.21e+00  1.63e-01 -9.94e-01  6.21e-03 -2.04e-03  4.54e-02  2.23e-01  2.47e-03
  -2.45e-03  7.23e-03  4.64e-04 -3.89e-04  6.84e-02  4.96e-02  5.44e-03]]
SymNet parameters
[-0.37 -0.04]
SymNet parameters
[[-1.75e+00 -6.60e-02 -1.80e-01  8.15e-02  3.18e-02  3.49e-02 -4.11e-01 -2.24e-02
  -2.30e-03  1.39e-02  8.04e-03 -8.34e-03 -3.55e-02  3.62e-02  2.38e-03 -1.78e-02]
 [-2.23e-01 -1.18e+00  2.67e-01 -2.46e-02 -7.54e-02 -4.32e-03 -1.31e+00 -2.43e-02
  -1.91e-02 -1.03e-02  1.69e-03  5.58e-03  4.28e-02  6.97e-02 -1.59e-03  2.85e-04]]
SymNet parameters
[-0.33  0.08]
SymNet parameters
[[ 0.21  0.23 -0.24  0.04 -0.02  0.06  0.45 -0.01 -0.01  0.   -0.   -0.    0.71  0.21
   0.04  0.57 -0.38]]
SymNet parameters
[-0.05]
SymNet parameters
[[ 0.37  0.02 -0.06  0.01  0.01  0.    1.16  0.13 -0.05  0.1   0.09  0.08]
 [ 1.64 -0.1   0.15 -0.06 -0.03 -0.03  0.11 -0.24  0.72 -0.2  -0.27 -0.17]]
SymNet parameters
[ 0.2  -0.11]
SymNet parameters
[[ 0.17 -0.07  0.29 -0.09 -0.06 -0.05 -0.04  0.95 -0.28 -0.37 -0.41 -0.05 -0.07]
 [ 0.57  0.05 -0.08  0.01  0.    0.01  0.68 -0.05  0.08  0.04  0.07  0.06 -0.02]]
SymNet parameters
[0.05 0.01]
SymNet parameters
[[ 0.64 -0.09  0.15 -0.06 -0.03 -0.01 -0.92  0.82 -0.6  -0.29 -0.3  -0.26  0.   -0.08]
 [ 0.02  0.02 -0.06  0.01  0.    0.    1.47 -0.18 -0.06  0.05  0.05  0.05 -0.01  0.  ]]
SymNet parameters
[-0.54 -0.09]
SymNet parameters
[[-9.14e-01  7.25e-02 -1.17e-01  4.58e-02  3.05e-02  2.91e-02 -7.75e-01  7.36e-01
  -4.53e-01  1.24e-01  1.99e-01  5.62e-02  1.08e-02 -1.31e-02 -1.62e-02]
 [-1.20e+00 -6.24e-02  1.36e-01 -3.79e-02 -2.09e-02 -1.18e-02 -1.86e+00  7.12e-02
   2.73e-01 -2.17e-01 -2.11e-01 -1.85e-01  2.66e-03 -5.62e-03 -1.79e-03]]
SymNet parameters
[-0.19 -0.26]
SymNet parameters
[[ 0.76  0.01  0.11  0.04  0.04  0.01 -0.3  -0.26 -1.81  0.26  0.19  0.21  0.09  0.1
   0.01  0.05]
 [ 0.32 -0.53 -0.07 -0.36 -0.28 -0.37  0.2   0.12  0.44  0.4  -0.93  1.41  0.55 -0.05
   0.   -0.39]]
SymNet parameters
[-0.2 -0. ]
SymNet parameters
[[ 0.07 -0.01  0.02 -0.01 -0.01 -0.    0.    0.05  0.08 -0.02 -0.06 -0.02 -1.06 -0.24
   0.53  0.61 -0.01]]
SymNet parameters
[-0.06]
finally, finish this stage
iter:   521    time: 8.55
Func: 4.06e-02  |g|: 1.65e-02
stableloss: 1.48e-02   dataloss: 4.06e-02   sparseloss: 7.30e+01 momentloss: 7.27e+00
current expression:
[u00*u01, u10*v00, u00, u02, u20, u00**3, u00*v00, u00**2*u02, v00, u00**2*v00, u01*u10*v00, u00*u01**2, u00*u11*v00, u01, v00**2, u00**2*v01, v10, u20*v00**2, u01*v00, u00*u10]
[-0.89 -0.88  0.06  0.04  0.04 -0.03 -0.02 -0.01  0.01 -0.01  0.01  0.01  0.01 -0.01
 -0.01  0.    0.   -0.   -0.    0.  ]
[v00*v10, u00*v01, v00, v20, v02, v00**3, 1, v00**2*v20, v00*v10**2, v10, u00*v00**2, v00*v01, u00*v00*v11, u00*v01*v10, v00**2, u00*v00**3, u00**2, u00*u10*v00, u01, v00**2*v10]
[-0.89 -0.88  0.06  0.04  0.04 -0.03  0.02 -0.01  0.01  0.01  0.01  0.01  0.01  0.01
 -0.01  0.01 -0.   -0.    0.   -0.  ]
block:  1
name:  burgers-2-upwind-sparse0-noise0.001-id4
device:  cuda:0
generate a random number to check random seed:  0.46286042000327365
current stage is: block-1
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.6836, device='cuda:0', dtype=torch.float64)
u_obs variance
tensor([ 0.2563,  2.1587,  1.9626, 20.3932, 10.2225, 17.2324,  0.2583,  2.0176,
         2.0745, 17.8508,  9.7638, 19.1657], device='cuda:0',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
iter:     0    time: 2338.43
Func: 5.44e-02  |g|: 8.20e-01
stableloss: 1.07e-02   dataloss: 4.72e-02   sparseloss: 7.30e+01 momentloss: 7.27e+00
iter:   200    time: 10.42
Func: 2.24e-02  |g|: 1.88e-02
stableloss: 7.15e-03   dataloss: 1.56e-02   sparseloss: 6.99e+01 momentloss: 6.79e+00
iter:   400    time: 10.18
Func: 2.16e-02  |g|: 8.75e-03
stableloss: 6.59e-03   dataloss: 1.49e-02   sparseloss: 7.26e+01 momentloss: 6.65e+00
iter:   600    time: 10.15
Func: 2.13e-02  |g|: 1.65e-02
stableloss: 6.45e-03   dataloss: 1.47e-02   sparseloss: 7.72e+01 momentloss: 6.58e+00
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 0.021173
         Iterations: 671
         Function evaluations: 728
         Gradient evaluations: 721
convolution moment and kernels
[[ 1.00e+00  0.00e+00  4.62e-04 -1.26e-02 -3.25e-02]
 [ 0.00e+00  1.30e-04 -1.05e-03  8.57e-04 -2.90e-02]
 [-1.71e-04  5.87e-03  6.72e-04  5.04e-03  2.47e-03]
 [ 1.63e-02  1.68e-03  1.23e-03 -2.32e-03 -5.50e-03]
 [-5.88e-02 -1.58e-02  8.05e-04 -5.28e-03  3.79e-03]]
[[ 0.   -0.01 -0.04 -0.02  0.  ]
 [-0.   -0.03  0.26  0.02  0.01]
 [ 0.    0.08  0.54  0.05 -0.04]
 [-0.03  0.08  0.07  0.11 -0.02]
 [ 0.01 -0.01 -0.03 -0.01  0.  ]]
[[ 0.00e+00  1.00e+00  0.00e+00 -8.89e-02 -6.75e-02]
 [ 0.00e+00  0.00e+00  1.44e-03  4.25e-03 -1.70e-03]
 [ 0.00e+00  6.55e-03  5.50e-03  9.78e-03 -4.24e-03]
 [-1.24e-03  3.69e-03  4.70e-04 -7.85e-03 -6.15e-03]
 [ 3.84e-03 -3.33e-02 -3.49e-03 -2.96e-02 -3.64e-03]]
[[ 0.01 -0.01  0.01 -0.   -0.01]
 [-0.05  0.04 -0.05 -0.01  0.05]
 [ 0.13 -0.54 -0.36  1.08 -0.29]
 [-0.05  0.02  0.01 -0.08  0.07]
 [ 0.01  0.01 -0.02  0.03 -0.02]]
[[ 0.00e+00  0.00e+00  0.00e+00 -5.38e-03 -1.38e-04]
 [ 1.00e+00  0.00e+00  1.27e-02 -7.34e-04 -3.12e-02]
 [ 0.00e+00  1.90e-03  5.04e-03  4.99e-03 -2.52e-03]
 [-1.13e-01 -5.44e-04  1.83e-02  6.37e-04 -1.49e-02]
 [-5.27e-02 -5.74e-03  8.44e-04 -4.71e-03 -9.00e-04]]
[[ 0.01 -0.03  0.13 -0.03  0.  ]
 [-0.01  0.   -0.56 -0.02  0.02]
 [ 0.02 -0.03 -0.29  0.01 -0.02]
 [-0.02  0.02  0.97  0.01  0.  ]
 [-0.    0.03 -0.25  0.03 -0.01]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00 -7.57e-04]
 [ 0.00e+00  0.00e+00  0.00e+00  2.18e-03 -3.37e-04]
 [ 0.00e+00  0.00e+00  3.06e-03 -1.18e-03 -1.11e-03]
 [ 0.00e+00  1.31e-03 -8.35e-04 -2.68e-03 -1.53e-03]
 [ 6.45e-03 -5.89e-03 -3.35e-03  6.50e-03  2.48e-04]]
[[-0.    0.    0.02 -0.02  0.01]
 [ 0.01 -0.01 -0.09  0.09 -0.02]
 [-0.1   1.35 -2.37  1.22 -0.05]
 [ 0.01 -0.01 -0.08  0.07 -0.02]
 [-0.    0.    0.01 -0.01  0.  ]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00 -1.56e-03]
 [ 0.00e+00  1.00e+00  0.00e+00 -1.68e-03  3.22e-03]
 [ 0.00e+00  0.00e+00 -1.18e-03  1.40e-03  3.21e-03]
 [ 0.00e+00 -2.51e-03  1.17e-03  2.65e-03 -4.64e-03]
 [-8.91e-04  1.49e-03  2.43e-03 -3.24e-03 -6.79e-03]]
[[ 0.   -0.04 -0.03  0.08 -0.01]
 [-0.04  0.36  0.18 -0.58  0.09]
 [-0.04  0.2  -0.35  0.25 -0.06]
 [ 0.09 -0.6   0.26  0.26 -0.01]
 [-0.02  0.1  -0.07 -0.01 -0.  ]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  2.22e-03]
 [ 0.00e+00  0.00e+00  0.00e+00  1.11e-03  1.64e-03]
 [ 1.00e+00  0.00e+00  3.75e-03  1.70e-03 -2.20e-03]
 [ 0.00e+00  5.16e-05  4.20e-04 -6.32e-04 -3.15e-03]
 [-5.66e-03  9.62e-04 -1.38e-03 -1.73e-03 -1.18e-03]]
[[ 1.69e-03 -7.51e-03 -7.99e-02 -3.33e-03  6.90e-05]
 [-7.62e-03  3.49e-02  1.31e+00  1.42e-02  8.35e-04]
 [ 9.95e-03 -4.47e-02 -2.49e+00 -7.74e-03 -5.66e-03]
 [-4.36e-04  2.58e-03  1.37e+00 -2.38e-02  1.08e-02]
 [-1.36e-03  5.90e-03 -1.02e-01  1.18e-02 -3.81e-03]]
SymNet parameters
[[ 4.16e-01 -1.06e+00 -7.22e-02 -2.26e-01  1.70e-01  4.73e-02 -1.96e+00 -9.36e-02
   1.83e-01 -5.97e-03  2.23e-03  6.96e-02]
 [ 9.73e-02  1.10e-02  2.85e-02 -1.53e-03  6.83e-04 -3.37e-03 -1.08e-02 -1.41e-03
  -3.17e-03 -1.27e-03 -2.85e-04  3.95e-04]]
SymNet parameters
[0.1  0.73]
SymNet parameters
[[ 4.26e-02  1.64e-01 -3.64e-01  1.25e-01  5.18e-02  1.57e-03  6.00e-01  4.85e-02
  -9.69e-02 -4.12e-04  5.28e-03 -9.02e-03 -1.50e-01]
 [ 8.69e-01 -2.60e-01 -1.07e-01 -2.59e-01 -8.29e-02 -5.46e-02 -9.77e-01 -3.96e-01
  -4.09e-01  2.66e-02 -1.99e-02  3.17e-03  6.93e-01]]
SymNet parameters
[-0.44 -0.02]
SymNet parameters
[[-1.24 -0.48 -0.1  -0.39 -0.23 -0.15 -1.2  -0.41  0.12  0.07 -0.07 -0.07  0.82 -0.03]
 [-0.37 -0.43  1.14 -0.52 -0.15  0.08 -2.46 -0.42 -0.39 -0.01  0.05  0.15  0.88  0.03]]
SymNet parameters
[0.01 0.04]
SymNet parameters
[[ 2.75e-01 -2.44e-01  4.60e-02 -2.94e-03  3.42e-03  6.35e-04  1.25e+00 -6.33e-03
   8.33e-03  6.68e-04  2.73e-04  4.55e-04 -2.44e-02 -4.63e-03 -1.03e-03]
 [ 1.28e+00 -1.88e-01 -1.17e+00  9.67e-02 -8.39e-02 -2.63e-02  8.10e-02  3.28e-02
  -9.83e-02  3.32e-03 -2.13e-03 -3.08e-02  6.44e-01  7.03e-02  9.58e-03]]
SymNet parameters
[-0.38  0.01]
SymNet parameters
[[-1.74e+00 -1.84e-01 -2.86e-01 -1.09e-02  4.19e-03 -3.42e-04  9.07e-01 -1.01e-02
   2.65e-03  2.94e-04 -1.15e-03  1.30e-03 -2.94e-02  2.25e-02  3.80e-03 -2.17e-02]
 [-2.54e-01 -1.18e+00  2.39e-01 -2.21e-02  1.07e-02  6.67e-03 -1.47e+00 -2.46e-03
   1.46e-02  5.20e-06  3.76e-04  7.56e-03 -1.58e-01 -1.05e-02 -2.96e-03 -1.61e-02]]
SymNet parameters
[-0.23  0.05]
SymNet parameters
[[ 0.14  0.33 -0.22  0.12 -0.06  0.03  0.59  0.02 -0.06  0.   -0.   -0.02  0.47  0.04
   0.01  0.47 -0.38]]
SymNet parameters
[-0.03]
SymNet parameters
[[ 0.56 -0.05  0.08 -0.01 -0.01 -0.02  1.72  0.26 -0.09 -0.01  0.    0.14]
 [ 1.57  0.    0.08 -0.01 -0.    0.    0.4  -0.01  0.59 -0.02 -0.08 -0.03]]
SymNet parameters
[-0.09 -0.17]
SymNet parameters
[[ 1.3  -0.01  0.06 -0.04  0.02  0.06 -0.15  1.07  0.35 -0.06 -0.16  0.04  0.01]
 [ 0.54 -0.2  -0.35  0.01 -0.03 -0.04  0.04  0.1  -0.8  -0.    0.05  0.2  -0.03]]
SymNet parameters
[0.01 0.04]
SymNet parameters
[[ 1.39e+00  8.49e-02 -2.46e-02  1.82e-03  9.85e-03  3.44e-02 -9.24e-02  1.38e+00
  -4.72e-01 -6.70e-03 -8.22e-02 -2.42e-01 -7.08e-02 -2.21e-02]
 [-5.53e-02 -1.86e-02  3.31e-02 -7.02e-03 -2.85e-03 -3.61e-03  1.33e+00  1.35e-01
   1.80e-03 -2.03e-03  2.94e-04  4.96e-02 -2.50e-02  1.23e-03]]
SymNet parameters
[-0.55 -0.16]
SymNet parameters
[[-9.76e-01  3.97e-02 -1.04e-01  9.26e-03  8.24e-03  1.52e-02 -5.68e-01  7.96e-01
  -3.42e-01  1.99e-02  5.41e-02 -9.67e-02 -4.74e-02  3.68e-03 -3.73e-03]
 [-1.36e+00  3.74e-02 -5.07e-02  9.75e-03  4.13e-03  8.60e-03 -1.94e+00 -2.02e-01
   2.07e-01  2.46e-03 -9.48e-03 -8.65e-02  3.63e-02 -1.97e-03  1.29e-03]]
SymNet parameters
[-0.05 -0.1 ]
SymNet parameters
[[-0.09 -0.02 -0.12  0.02  0.01 -0.01 -0.87 -0.17 -1.92  0.03  0.13  0.06  0.04 -0.02
  -0.07 -0.01]
 [-0.29 -0.72  1.19 -0.16 -0.13 -0.23  0.    0.49 -0.   -0.13 -0.03  2.02  0.37  0.02
  -0.28 -0.11]]
SymNet parameters
[-0.16 -0.01]
SymNet parameters
[[-0.25  0.02 -0.03  0.    0.    0.01 -0.02  0.17 -0.1   0.05 -0.    0.   -1.03 -0.01
   0.6   0.7  -0.02]]
SymNet parameters
[-0.04]
finally, finish this stage
iter:   671    time: 5.94
Func: 2.12e-02  |g|: 1.70e-02
stableloss: 6.39e-03   dataloss: 1.46e-02   sparseloss: 7.81e+01 momentloss: 6.57e+00
current expression:
[u00*u01, u10*v00, u20, u02, u00, u10*v00*v10, u00*u01**2, u01*u10*v00, u00*u11*v00, u00**3, 1, u00*u01*v00, u10*v01, v10, u00**2*u10, u00**2*u01, u10*v00*v01, u20*v00**2, u00*u10*v00, v01]
[-0.99 -0.97  0.05  0.05  0.02  0.01  0.01  0.01  0.01 -0.01 -0.01 -0.01  0.01  0.
  0.    0.    0.    0.   -0.   -0.  ]
[v00*v10, u00*v01, v02, v20, v00*v10**2, u00*v01*v10, u10*v00*v01, u00*v00*v11, 1, v00**2, u00*u10*v00, u01*v01, v10, v11, v00, u00**2*v00, u00*v00**2*v10, u00*u01*v00, u00*v00*v10, u00**2*v10]
[-0.98 -0.98  0.05  0.05  0.02  0.01  0.01  0.01 -0.01  0.01  0.01  0.   -0.   -0.
  0.   -0.    0.    0.    0.    0.  ]
block:  2
name:  burgers-2-upwind-sparse0-noise0.001-id4
device:  cuda:0
generate a random number to check random seed:  0.947200457975059
current stage is: block-2
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.8619, device='cuda:0', dtype=torch.float64)
u_obs variance
tensor([ 0.2371,  1.6125,  1.5421, 21.3891,  9.8193, 17.9246,  0.2634,  1.7786,
         1.7507, 21.2219, 10.6031, 22.2144], device='cuda:0',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
iter:     0    time: 1162.51
Func: 7.89e-02  |g|: 3.08e+00
stableloss: 1.92e-02   dataloss: 6.58e-02   sparseloss: 7.81e+01 momentloss: 6.57e+00
iter:   200    time: 14.46
Func: 5.81e-02  |g|: 1.32e-01
stableloss: 1.81e-02   dataloss: 4.48e-02   sparseloss: 7.93e+01 momentloss: 6.66e+00
iter:   400    time: 14.37
Func: 5.68e-02  |g|: 8.10e-02
stableloss: 1.78e-02   dataloss: 4.35e-02   sparseloss: 8.41e+01 momentloss: 6.63e+00
iter:   600    time: 14.36
Func: 5.63e-02  |g|: 5.79e-02
stableloss: 1.80e-02   dataloss: 4.31e-02   sparseloss: 8.84e+01 momentloss: 6.59e+00
iter:   800    time: 14.27
Func: 5.58e-02  |g|: 6.73e-02
stableloss: 1.80e-02   dataloss: 4.26e-02   sparseloss: 9.12e+01 momentloss: 6.60e+00
iter:  1000    time: 14.28
Func: 5.55e-02  |g|: 2.19e-02
stableloss: 1.78e-02   dataloss: 4.23e-02   sparseloss: 9.66e+01 momentloss: 6.59e+00
iter:  1200    time: 14.32
Func: 5.54e-02  |g|: 2.13e-02
stableloss: 1.77e-02   dataloss: 4.22e-02   sparseloss: 9.99e+01 momentloss: 6.59e+00
iter:  1400    time: 14.29
Func: 5.53e-02  |g|: 2.09e-02
stableloss: 1.78e-02   dataloss: 4.21e-02   sparseloss: 9.92e+01 momentloss: 6.59e+00
iter:  1600    time: 14.55
Func: 5.52e-02  |g|: 3.20e-02
stableloss: 1.78e-02   dataloss: 4.20e-02   sparseloss: 1.04e+02 momentloss: 6.59e+00
iter:  1800    time: 14.36
Func: 5.49e-02  |g|: 3.41e-02
stableloss: 1.78e-02   dataloss: 4.18e-02   sparseloss: 1.13e+02 momentloss: 6.57e+00
Warning: Maximum number of iterations has been exceeded.
         Current function value: 0.054769
         Iterations: 2000
         Function evaluations: 2019
         Gradient evaluations: 2008
convolution moment and kernels
[[ 1.00e+00  0.00e+00  8.35e-05 -2.20e-02 -5.70e-02]
 [ 0.00e+00  1.64e-04 -6.83e-03  1.57e-03 -2.90e-02]
 [-4.36e-05  2.90e-03  6.06e-03 -1.30e-04  4.45e-03]
 [ 2.51e-02 -2.01e-03  1.90e-03  2.03e-03  1.95e-03]
 [-7.46e-02  5.86e-03 -5.67e-03 -7.03e-03  3.48e-03]]
[[ 0.   -0.02 -0.07  0.   -0.  ]
 [-0.01  0.04  0.31 -0.05  0.03]
 [-0.01  0.04  0.39  0.21 -0.08]
 [-0.05  0.19  0.04  0.11 -0.02]
 [ 0.01 -0.04 -0.01 -0.02  0.  ]]
[[ 0.00e+00  1.00e+00  0.00e+00 -9.66e-02 -5.44e-02]
 [ 0.00e+00  0.00e+00 -2.28e-03 -1.86e-03 -5.45e-03]
 [ 0.00e+00  1.74e-02 -1.74e-03  1.96e-02 -2.93e-03]
 [-4.50e-04  1.44e-03  6.75e-04  3.48e-04  1.31e-03]
 [ 5.66e-04 -1.39e-02 -4.83e-03 -9.35e-03 -6.37e-04]]
[[ 3.25e-03 -1.56e-03  4.80e-03 -3.02e-04 -5.39e-03]
 [-2.39e-02  2.30e-02 -2.92e-02 -5.04e-04  2.79e-02]
 [ 1.25e-01 -6.13e-01 -2.40e-01  9.55e-01 -2.22e-01]
 [-3.21e-02  5.55e-02 -7.67e-02  3.45e-02  1.70e-02]
 [ 5.18e-03 -9.35e-03  1.50e-02 -7.49e-03 -3.05e-03]]
[[ 0.00e+00  0.00e+00  0.00e+00 -6.94e-03 -1.42e-03]
 [ 1.00e+00  0.00e+00  2.19e-02 -5.27e-05 -7.34e-03]
 [ 0.00e+00  1.61e-03  6.97e-03 -1.96e-03 -1.86e-03]
 [-8.53e-02 -1.97e-03  2.41e-02  3.77e-03 -9.46e-03]
 [-4.68e-02 -1.31e-03 -6.23e-03 -6.58e-03 -3.11e-03]]
[[ 0.01 -0.04  0.13 -0.02 -0.  ]
 [-0.01  0.06 -0.64  0.01  0.02]
 [ 0.01 -0.04 -0.24  0.02 -0.03]
 [ 0.   -0.01  0.96 -0.04  0.02]
 [-0.01  0.03 -0.22  0.04 -0.01]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00  4.47e-03]
 [ 0.00e+00  0.00e+00  0.00e+00  1.69e-03  3.49e-04]
 [ 0.00e+00  0.00e+00  3.90e-03 -1.40e-03 -2.20e-03]
 [ 0.00e+00 -1.27e-03  2.49e-03 -6.25e-05 -5.75e-03]
 [ 3.69e-03 -1.22e-03 -2.14e-03  9.59e-04 -3.06e-03]]
[[-3.37e-04 -3.42e-03  1.31e-02 -6.70e-03  1.01e-03]
 [ 5.72e-03 -9.25e-04 -3.55e-02  1.77e-02 -1.78e-03]
 [-9.51e-02  1.35e+00 -2.47e+00  1.32e+00 -8.46e-02]
 [ 1.71e-02 -5.48e-02  4.88e-02 -3.75e-02  1.16e-02]
 [-6.29e-03  2.36e-02 -2.79e-02  1.94e-02 -5.07e-03]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00 -2.35e-03]
 [ 0.00e+00  1.00e+00  0.00e+00 -2.71e-03 -7.57e-03]
 [ 0.00e+00  0.00e+00 -1.26e-04 -8.37e-04  8.32e-04]
 [ 0.00e+00 -2.35e-03 -1.48e-03  4.16e-03  6.05e-03]
 [-1.69e-03 -7.79e-04  2.49e-04  9.15e-04 -6.99e-04]]
[[ 0.   -0.04 -0.03  0.08 -0.01]
 [-0.04  0.38  0.1  -0.51  0.07]
 [-0.01  0.05 -0.07  0.03 -0.  ]
 [ 0.05 -0.43 -0.04  0.49 -0.07]
 [-0.01  0.05  0.02 -0.07  0.01]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  2.60e-02]
 [ 0.00e+00  0.00e+00  0.00e+00  4.28e-04  5.32e-04]
 [ 1.00e+00  0.00e+00  3.10e-03  1.65e-04 -9.54e-04]
 [ 0.00e+00 -1.79e-03  2.60e-03  9.80e-04 -4.78e-03]
 [-7.18e-03  5.14e-05 -1.01e-03 -8.56e-04 -3.90e-03]]
[[-4.33e-04  1.69e-04 -9.24e-02  4.08e-03 -1.91e-03]
 [ 5.96e-03 -1.67e-02  1.39e+00 -2.81e-02  1.06e-02]
 [ 8.91e-03 -4.40e-02 -2.48e+00 -3.25e-02  3.31e-03]
 [ 1.77e-02 -6.85e-02  1.46e+00 -7.23e-02  2.03e-02]
 [-6.12e-03  2.52e-02 -1.28e-01  2.49e-02 -6.39e-03]]
SymNet parameters
[[ 2.41e-01 -7.28e-01  4.13e-02 -1.35e-01  2.55e-02  1.13e-02 -2.50e+00 -1.81e-02
   3.70e-03  2.12e-03 -1.15e-02  5.75e-03]
 [ 7.80e-02  1.94e-03  8.91e-04  5.80e-04  3.42e-04 -4.18e-04  1.74e-02  2.10e-04
  -9.03e-04  5.76e-05  4.47e-05  4.15e-06]]
SymNet parameters
[0.56 0.89]
SymNet parameters
[[-1.45e+00  2.46e-01 -2.96e-01  7.96e-02  1.17e-02 -9.98e-03  8.51e-01  2.94e-02
  -1.10e-01  5.03e-04  1.02e-02 -8.70e-03 -4.53e-03]
 [ 2.32e-01 -6.70e-01 -6.82e-02 -1.86e-01 -1.73e-02  1.05e-02 -2.65e+00 -3.40e-02
   2.77e-02  1.99e-03 -1.33e-02  5.08e-03 -1.88e-02]]
SymNet parameters
[-0.25 -0.13]
SymNet parameters
[[-5.60e-01 -6.90e-01 -8.75e-02 -2.49e-01 -2.15e-02  1.60e-02 -3.58e+00 -8.02e-02
   3.07e-01 -8.54e-04 -1.78e-02  8.95e-03 -1.83e-01 -5.39e-03]
 [ 7.21e-01 -9.06e-01  9.80e-01 -2.96e-01 -4.43e-02  3.12e-02 -3.99e+00 -5.73e-02
   4.65e-02  6.12e-04 -3.70e-02  2.38e-02  9.60e-02  4.39e-03]]
SymNet parameters
[0.05 0.05]
SymNet parameters
[[ 6.52e-01 -9.82e-01  2.17e-01 -6.54e-03  2.53e-02 -8.47e-04  1.50e+00 -6.05e-03
  -4.69e-02  1.27e-04 -8.58e-04 -2.26e-03 -6.38e-01 -4.17e-02 -1.49e-02]
 [ 1.57e+00  6.16e-01 -6.43e-01  3.32e-01 -3.31e-02 -2.67e-02  1.46e+00  6.28e-02
   6.01e-02 -2.64e-03  2.97e-02 -9.69e-03  1.84e+00  5.60e-02  8.55e-03]]
SymNet parameters
[-0.58  0.69]
SymNet parameters
[[-9.91e-01  1.45e-01 -3.12e-01  1.36e-01 -1.22e-02 -8.77e-03  3.70e+00  1.40e-02
  -2.96e-02 -2.34e-03  1.01e-02 -6.67e-03  8.35e-01  6.22e-02  1.49e-02 -2.13e-03]
 [-5.19e-01 -7.71e-01  1.61e-01 -3.61e-02  1.86e-02  4.26e-03 -2.99e+00  4.83e-03
   4.18e-02  1.24e-03 -3.03e-03  3.75e-03 -6.67e-01 -2.51e-02 -7.00e-03 -3.97e-03]]
SymNet parameters
[-0.85  0.83]
SymNet parameters
[[ 1.37e-01  3.18e-01 -3.23e-01  9.63e-02 -8.44e-03  4.62e-02  3.63e-01  7.64e-03
   1.56e-02 -2.13e-04  2.79e-03 -9.84e-04  3.41e-01 -2.68e-01 -5.90e-02  2.30e-01
  -6.72e-01]]
SymNet parameters
[0.03]
SymNet parameters
[[ 2.98e-01  3.80e-02 -5.61e-03  3.87e-03  3.88e-04  2.27e-03  1.46e+00  5.79e-02
   8.88e-02 -1.48e-02 -3.55e-03  6.69e-02]
 [ 1.78e+00  8.68e-02 -9.59e-02 -4.10e-03 -3.11e-03 -6.49e-03  4.18e-01  8.80e-03
   8.65e-01 -2.45e-02 -3.11e-03 -1.14e-01]]
SymNet parameters
[ 0.52 -0.31]
SymNet parameters
[[ 2.20e+00 -4.76e-01  2.58e-01 -1.99e-02  3.00e-03  3.12e-03 -2.07e+00  2.11e+00
   2.98e-01  3.73e-02 -3.47e-01  9.19e-02 -1.18e-01]
 [-4.07e-01  1.76e-01  8.58e-03 -5.73e-03  5.74e-03 -7.61e-03 -3.30e+00 -5.42e-01
   2.96e-02  1.18e-01 -5.62e-02 -6.00e-02  4.65e-02]]
SymNet parameters
[-0.15 -0.56]
SymNet parameters
[[ 3.35e+00  4.49e-02 -1.97e-01 -1.81e-02 -5.29e-03 -1.57e-02 -3.46e-01 -3.50e-01
  -3.54e-01 -1.40e-02  8.76e-03 -3.52e-01 -1.36e-03 -5.32e-03]
 [ 5.86e-02 -2.74e-02  6.38e-02  2.01e-03  2.98e-03 -1.01e-03  1.88e+00 -5.28e-02
  -3.00e-01  1.52e-02  8.65e-04  1.07e-02 -5.04e-02  5.76e-03]]
SymNet parameters
[-2.15 -0.28]
SymNet parameters
[[-2.90e-01 -2.38e-02  2.67e-02 -6.94e-04  1.06e-03 -7.06e-04 -4.69e-01  5.60e-01
  -3.02e-01  1.07e-02  1.91e-03 -9.27e-03 -2.91e-02 -2.51e-03 -4.86e-03]
 [-2.10e+00 -1.25e-02  1.48e-02  5.74e-04  1.97e-04  2.17e-03  1.17e-02 -9.99e-03
  -1.03e-01  3.67e-03 -1.30e-03  1.15e-02 -7.42e-03 -6.14e-04 -1.84e-03]]
SymNet parameters
[-0.32  0.15]
SymNet parameters
[[-3.81e+00 -2.89e-01  1.83e-01  8.32e-03  6.80e-03  1.82e-02 -3.35e+00 -1.49e-02
  -1.80e+00  6.02e-02  1.11e-02  3.37e-01  7.66e-02 -1.16e-02 -1.81e-02  1.49e-01]
 [ 1.02e-01  6.98e-01 -3.11e-01  3.97e-02 -5.39e-03  2.44e-02  8.53e+00  1.70e+00
   6.08e-01 -2.54e-01 -6.32e-02  7.82e-01  1.09e-01 -1.25e-02 -7.76e-02 -1.54e-01]]
SymNet parameters
[-0.07  0.16]
SymNet parameters
[[ 5.49e-01  1.87e-02 -3.56e-02 -3.28e-03 -1.25e-03 -4.97e-03  5.62e-01 -1.38e-01
   3.03e-01  4.80e-02 -5.68e-04 -5.08e-02 -1.09e+00  2.26e-03  1.97e-01  8.37e-01
  -2.72e-02]]
SymNet parameters
[-0.25]
finally, finish this stage
iter:  2000    time: 14.64
Func: 5.48e-02  |g|: 4.87e-02
stableloss: 1.78e-02   dataloss: 4.16e-02   sparseloss: 1.16e+02 momentloss: 6.57e+00
current expression:
[u00*u01, u10*v00, u20, u02, u00*u01**2, u10*v00*v10, u01*u10*v00, u00*u11*v00, u00, u10*v01, u01*v00, u20*v00**2, u00**3, u00*u01*v00, u00*v00, u10*v10, u00**2*u01, u10, u00**2, u01*u10]
[-0.98 -0.98  0.05  0.05  0.01  0.01  0.01  0.01  0.01  0.01 -0.01  0.   -0.    0.
 -0.   -0.    0.   -0.   -0.   -0.  ]
[v00*v10, u00*v01, v02, v20, v00*v10**2, v00, u00*v01*v10, u00*v00*v11, u00*u01*v01, u00*v00*v10, v01, u01, v01*v10, v00**2*v10, v00**3, u00*v10, v10, u00*v10**2, u01*v01, u10]
[-0.99 -0.97  0.05  0.05  0.01  0.01  0.01  0.01  0.01  0.01 -0.01 -0.    0.    0.
 -0.   -0.   -0.    0.    0.   -0.  ]
block:  3
name:  burgers-2-upwind-sparse0-noise0.001-id4
device:  cuda:0
generate a random number to check random seed:  -2.942075065888866
current stage is: block-3
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.8611, device='cuda:0', dtype=torch.float64)
u_obs variance
tensor([ 0.2640,  1.7958,  1.6522, 22.6511, 10.4360, 19.2293,  0.2576,  1.6885,
         1.8083, 19.3110, 11.1004, 24.9418], device='cuda:0',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 0.162188
         Iterations: 0
         Function evaluations: 15
         Gradient evaluations: 3
convolution moment and kernels
[[ 1.00e+00  0.00e+00  8.38e-05 -2.20e-02 -5.70e-02]
 [ 0.00e+00  1.64e-04 -6.83e-03  1.57e-03 -2.90e-02]
 [-4.44e-05  2.90e-03  6.06e-03 -1.32e-04  4.45e-03]
 [ 2.51e-02 -2.01e-03  1.90e-03  2.03e-03  1.95e-03]
 [-7.46e-02  5.86e-03 -5.67e-03 -7.02e-03  3.48e-03]]
[[ 0.   -0.02 -0.07  0.   -0.  ]
 [-0.01  0.04  0.31 -0.05  0.03]
 [-0.01  0.04  0.39  0.21 -0.08]
 [-0.05  0.19  0.04  0.11 -0.02]
 [ 0.01 -0.04 -0.01 -0.02  0.  ]]
[[ 0.00e+00  1.00e+00  0.00e+00 -9.66e-02 -5.44e-02]
 [ 0.00e+00  0.00e+00 -2.28e-03 -1.86e-03 -5.45e-03]
 [ 0.00e+00  1.74e-02 -1.74e-03  1.96e-02 -2.93e-03]
 [-4.49e-04  1.44e-03  6.77e-04  3.48e-04  1.31e-03]
 [ 5.63e-04 -1.39e-02 -4.83e-03 -9.35e-03 -6.42e-04]]
[[ 3.25e-03 -1.55e-03  4.77e-03 -2.91e-04 -5.39e-03]
 [-2.39e-02  2.29e-02 -2.91e-02 -5.70e-04  2.79e-02]
 [ 1.25e-01 -6.13e-01 -2.41e-01  9.55e-01 -2.23e-01]
 [-3.20e-02  5.53e-02 -7.65e-02  3.44e-02  1.70e-02]
 [ 5.17e-03 -9.31e-03  1.50e-02 -7.46e-03 -3.05e-03]]
[[ 0.00e+00  0.00e+00  0.00e+00 -6.94e-03 -1.42e-03]
 [ 1.00e+00  0.00e+00  2.19e-02 -5.36e-05 -7.34e-03]
 [ 0.00e+00  1.61e-03  6.96e-03 -1.97e-03 -1.85e-03]
 [-8.53e-02 -1.97e-03  2.41e-02  3.77e-03 -9.46e-03]
 [-4.68e-02 -1.31e-03 -6.22e-03 -6.57e-03 -3.11e-03]]
[[ 0.01 -0.04  0.13 -0.02 -0.  ]
 [-0.01  0.06 -0.64  0.01  0.02]
 [ 0.01 -0.04 -0.24  0.02 -0.03]
 [ 0.   -0.01  0.96 -0.04  0.02]
 [-0.01  0.03 -0.22  0.04 -0.01]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00  4.47e-03]
 [ 0.00e+00  0.00e+00  0.00e+00  1.69e-03  3.50e-04]
 [ 0.00e+00  0.00e+00  3.90e-03 -1.40e-03 -2.20e-03]
 [ 0.00e+00 -1.27e-03  2.49e-03 -6.25e-05 -5.75e-03]
 [ 3.69e-03 -1.22e-03 -2.14e-03  9.61e-04 -3.06e-03]]
[[-3.39e-04 -3.41e-03  1.31e-02 -6.70e-03  1.01e-03]
 [ 5.73e-03 -9.60e-04 -3.54e-02  1.77e-02 -1.78e-03]
 [-9.51e-02  1.35e+00 -2.47e+00  1.32e+00 -8.46e-02]
 [ 1.71e-02 -5.48e-02  4.88e-02 -3.75e-02  1.16e-02]
 [-6.29e-03  2.37e-02 -2.80e-02  1.94e-02 -5.08e-03]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00 -2.35e-03]
 [ 0.00e+00  1.00e+00  0.00e+00 -2.71e-03 -7.57e-03]
 [ 0.00e+00  0.00e+00 -1.26e-04 -8.37e-04  8.32e-04]
 [ 0.00e+00 -2.35e-03 -1.48e-03  4.16e-03  6.05e-03]
 [-1.69e-03 -7.79e-04  2.48e-04  9.15e-04 -6.99e-04]]
[[ 0.   -0.04 -0.03  0.08 -0.01]
 [-0.04  0.38  0.1  -0.51  0.07]
 [-0.01  0.05 -0.07  0.03 -0.  ]
 [ 0.05 -0.43 -0.04  0.49 -0.07]
 [-0.01  0.05  0.02 -0.07  0.01]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  2.60e-02]
 [ 0.00e+00  0.00e+00  0.00e+00  4.28e-04  5.33e-04]
 [ 1.00e+00  0.00e+00  3.10e-03  1.64e-04 -9.53e-04]
 [ 0.00e+00 -1.79e-03  2.60e-03  9.80e-04 -4.78e-03]
 [-7.18e-03  4.97e-05 -1.01e-03 -8.54e-04 -3.90e-03]]
[[-4.35e-04  1.76e-04 -9.24e-02  4.08e-03 -1.91e-03]
 [ 5.97e-03 -1.68e-02  1.39e+00 -2.81e-02  1.06e-02]
 [ 8.90e-03 -4.40e-02 -2.48e+00 -3.25e-02  3.31e-03]
 [ 1.77e-02 -6.86e-02  1.46e+00 -7.23e-02  2.03e-02]
 [-6.12e-03  2.52e-02 -1.28e-01  2.49e-02 -6.39e-03]]
SymNet parameters
[[ 2.42e-01 -7.28e-01  4.13e-02 -1.35e-01  2.55e-02  1.13e-02 -2.50e+00 -1.81e-02
   3.72e-03  2.10e-03 -1.15e-02  5.77e-03]
 [ 7.80e-02  2.07e-03  8.84e-04  4.02e-04  3.87e-04 -5.07e-04  1.75e-02  1.63e-04
  -7.77e-04 -1.92e-04  5.09e-05  4.69e-05]]
SymNet parameters
[0.56 0.89]
SymNet parameters
[[-1.45e+00  2.46e-01 -2.96e-01  7.96e-02  1.17e-02 -9.99e-03  8.51e-01  2.94e-02
  -1.10e-01  4.91e-04  1.02e-02 -8.68e-03 -4.55e-03]
 [ 2.32e-01 -6.70e-01 -6.82e-02 -1.86e-01 -1.73e-02  1.05e-02 -2.65e+00 -3.40e-02
   2.77e-02  1.99e-03 -1.33e-02  5.07e-03 -1.88e-02]]
SymNet parameters
[-0.25 -0.13]
SymNet parameters
[[-5.60e-01 -6.90e-01 -8.75e-02 -2.49e-01 -2.15e-02  1.60e-02 -3.58e+00 -8.02e-02
   3.07e-01 -8.57e-04 -1.78e-02  8.96e-03 -1.83e-01 -5.37e-03]
 [ 7.21e-01 -9.06e-01  9.80e-01 -2.96e-01 -4.43e-02  3.12e-02 -3.99e+00 -5.73e-02
   4.65e-02  6.08e-04 -3.70e-02  2.38e-02  9.60e-02  4.40e-03]]
SymNet parameters
[0.05 0.05]
SymNet parameters
[[ 6.52e-01 -9.82e-01  2.17e-01 -6.54e-03  2.53e-02 -8.46e-04  1.50e+00 -6.05e-03
  -4.69e-02  1.29e-04 -8.53e-04 -2.26e-03 -6.38e-01 -4.17e-02 -1.48e-02]
 [ 1.57e+00  6.16e-01 -6.43e-01  3.32e-01 -3.31e-02 -2.67e-02  1.46e+00  6.28e-02
   6.01e-02 -2.64e-03  2.97e-02 -9.68e-03  1.84e+00  5.60e-02  8.46e-03]]
SymNet parameters
[-0.58  0.69]
SymNet parameters
[[-9.91e-01  1.45e-01 -3.12e-01  1.36e-01 -1.22e-02 -8.76e-03  3.70e+00  1.40e-02
  -2.96e-02 -2.36e-03  1.01e-02 -6.67e-03  8.35e-01  6.22e-02  1.47e-02 -2.01e-03]
 [-5.19e-01 -7.71e-01  1.61e-01 -3.61e-02  1.86e-02  4.27e-03 -2.99e+00  4.83e-03
   4.18e-02  1.24e-03 -3.02e-03  3.74e-03 -6.67e-01 -2.52e-02 -6.77e-03 -4.00e-03]]
SymNet parameters
[-0.85  0.83]
SymNet parameters
[[ 1.37e-01  3.18e-01 -3.23e-01  9.63e-02 -8.44e-03  4.62e-02  3.63e-01  7.64e-03
   1.56e-02 -2.09e-04  2.79e-03 -9.86e-04  3.41e-01 -2.68e-01 -5.90e-02  2.30e-01
  -6.72e-01]]
SymNet parameters
[0.03]
SymNet parameters
[[ 2.98e-01  3.81e-02 -5.62e-03  3.88e-03  3.79e-04  2.27e-03  1.46e+00  5.79e-02
   8.88e-02 -1.48e-02 -3.54e-03  6.69e-02]
 [ 1.78e+00  8.68e-02 -9.59e-02 -4.11e-03 -3.11e-03 -6.48e-03  4.18e-01  8.80e-03
   8.65e-01 -2.45e-02 -3.10e-03 -1.14e-01]]
SymNet parameters
[ 0.52 -0.31]
SymNet parameters
[[ 2.20e+00 -4.76e-01  2.58e-01 -1.99e-02  3.00e-03  3.12e-03 -2.07e+00  2.11e+00
   2.98e-01  3.73e-02 -3.47e-01  9.19e-02 -1.18e-01]
 [-4.07e-01  1.76e-01  8.58e-03 -5.73e-03  5.74e-03 -7.61e-03 -3.30e+00 -5.42e-01
   2.96e-02  1.18e-01 -5.62e-02 -6.00e-02  4.65e-02]]
SymNet parameters
[-0.15 -0.56]
SymNet parameters
[[ 3.35e+00  4.49e-02 -1.97e-01 -1.81e-02 -5.29e-03 -1.57e-02 -3.46e-01 -3.50e-01
  -3.54e-01 -1.40e-02  8.76e-03 -3.52e-01 -1.37e-03 -5.31e-03]
 [ 5.86e-02 -2.74e-02  6.38e-02  2.01e-03  2.98e-03 -1.01e-03  1.88e+00 -5.28e-02
  -3.00e-01  1.52e-02  8.68e-04  1.07e-02 -5.04e-02  5.78e-03]]
SymNet parameters
[-2.15 -0.28]
SymNet parameters
[[-2.90e-01 -2.38e-02  2.67e-02 -6.88e-04  1.06e-03 -7.06e-04 -4.69e-01  5.60e-01
  -3.02e-01  1.07e-02  1.91e-03 -9.26e-03 -2.91e-02 -2.58e-03 -4.90e-03]
 [-2.10e+00 -1.25e-02  1.48e-02  5.78e-04  1.98e-04  2.18e-03  1.17e-02 -9.99e-03
  -1.03e-01  3.67e-03 -1.30e-03  1.15e-02 -7.39e-03 -5.46e-04 -1.84e-03]]
SymNet parameters
[-0.32  0.15]
SymNet parameters
[[-3.81e+00 -2.89e-01  1.83e-01  8.31e-03  6.80e-03  1.82e-02 -3.35e+00 -1.49e-02
  -1.80e+00  6.02e-02  1.11e-02  3.37e-01  7.66e-02 -1.17e-02 -1.81e-02  1.49e-01]
 [ 1.02e-01  6.98e-01 -3.11e-01  3.97e-02 -5.38e-03  2.44e-02  8.53e+00  1.70e+00
   6.08e-01 -2.54e-01 -6.32e-02  7.82e-01  1.09e-01 -1.25e-02 -7.76e-02 -1.54e-01]]
SymNet parameters
[-0.07  0.16]
SymNet parameters
[[ 5.49e-01  1.87e-02 -3.56e-02 -3.28e-03 -1.25e-03 -4.97e-03  5.62e-01 -1.38e-01
   3.03e-01  4.80e-02 -5.61e-04 -5.08e-02 -1.09e+00  2.23e-03  1.97e-01  8.37e-01
  -2.75e-02]]
SymNet parameters
[-0.25]
finally, finish this stage
iter:     0    time: 625.33
Func: 1.62e-01  |g|: 1.54e+01
stableloss: 2.32e-02   dataloss: 1.42e-01   sparseloss: 1.16e+02 momentloss: 6.57e+00
current expression:
[u00*u01, u10*v00, u20, u02, u00*u01**2, u10*v00*v10, u01*u10*v00, u00*u11*v00, u00, u10*v01, u01*v00, u20*v00**2, u00**3, u00*u01*v00, u00*v00, u10*v10, u00**2*u01, u10, u00**2, u01*u10]
[-0.98 -0.98  0.05  0.05  0.01  0.01  0.01  0.01  0.01  0.01 -0.01  0.   -0.    0.
 -0.   -0.    0.   -0.   -0.   -0.  ]
[v00*v10, u00*v01, v02, v20, v00*v10**2, v00, u00*v01*v10, u00*v00*v11, u00*u01*v01, u00*v00*v10, v01, u01, v01*v10, v00**2*v10, v00**3, u00*v10, v10, u00*v10**2, u01*v01, u10]
[-0.99 -0.97  0.05  0.05  0.01  0.01  0.01  0.01  0.01  0.01 -0.01 -0.    0.    0.
 -0.   -0.   -0.    0.    0.   -0.  ]
block:  4
name:  burgers-2-upwind-sparse0-noise0.001-id4
device:  cuda:0
generate a random number to check random seed:  -0.04069531376868751
current stage is: block-4
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.8172, device='cuda:0', dtype=torch.float64)
u_obs variance
tensor([ 0.2460,  1.6970,  1.8604, 21.1572, 11.3252, 22.7783,  0.2521,  1.6789,
         1.6213, 19.6048,  9.8811, 21.5282], device='cuda:0',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
iter:     0    time: 42.64
Func: 3.43e-01  |g|: 5.09e+01
stableloss: 3.07e-02   dataloss: 3.17e-01   sparseloss: 1.16e+02 momentloss: 6.57e+00
iter:   200    time: 23.33
Func: 2.77e-01  |g|: 2.67e+00
stableloss: 3.02e-02   dataloss: 2.47e-01   sparseloss: 1.16e+02 momentloss: 7.59e+00
iter:   400    time: 22.77
Func: 2.72e-01  |g|: 5.48e-01
stableloss: 3.04e-02   dataloss: 2.42e-01   sparseloss: 1.17e+02 momentloss: 7.70e+00
iter:   600    time: 22.61
Func: 2.72e-01  |g|: 4.73e-01
stableloss: 3.05e-02   dataloss: 2.41e-01   sparseloss: 1.19e+02 momentloss: 7.73e+00
iter:   800    time: 22.79
Func: 2.72e-01  |g|: 4.44e-01
stableloss: 3.05e-02   dataloss: 2.41e-01   sparseloss: 1.32e+02 momentloss: 7.74e+00
iter:  1000    time: 22.93
Func: 2.71e-01  |g|: 7.10e-01
stableloss: 3.06e-02   dataloss: 2.41e-01   sparseloss: 1.52e+02 momentloss: 7.72e+00
iter:  1200    time: 22.62
Func: 2.71e-01  |g|: 1.84e+00
stableloss: 3.06e-02   dataloss: 2.40e-01   sparseloss: 1.71e+02 momentloss: 7.73e+00
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 0.270654
         Iterations: 1363
         Function evaluations: 1452
         Gradient evaluations: 1432
convolution moment and kernels
[[ 1.00e+00  0.00e+00  1.78e-03 -6.51e-02 -7.54e-02]
 [ 0.00e+00 -3.19e-03  6.76e-03  2.27e-03  1.67e-03]
 [ 9.70e-04  1.50e-02  5.29e-02  8.39e-03  9.95e-04]
 [-4.69e-02  2.17e-03 -3.21e-03  5.45e-03 -3.88e-03]
 [-1.14e-01  3.60e-02 -1.35e-02  1.98e-02 -3.62e-03]]
[[-0.01 -0.02 -0.06 -0.01  0.01]
 [ 0.02  0.13  0.18  0.1  -0.02]
 [-0.08  0.03  0.25  0.2  -0.08]
 [ 0.04  0.11  0.3   0.08 -0.02]
 [-0.01 -0.01 -0.12 -0.    0.  ]]
[[ 0.00e+00  1.00e+00  0.00e+00 -9.90e-02 -7.75e-02]
 [ 0.00e+00  0.00e+00 -9.36e-04 -1.77e-03  7.16e-05]
 [ 0.00e+00  4.17e-02 -5.78e-03  6.06e-02 -1.68e-02]
 [-6.86e-03  6.38e-03  1.09e-03  1.30e-02  8.90e-03]
 [-1.02e-02  7.60e-03 -8.93e-04  1.61e-02 -8.05e-05]]
[[-5.18e-03  1.49e-02 -2.29e-02  7.33e-03 -9.06e-04]
 [-2.56e-02  5.89e-02 -3.90e-02  4.00e-02 -3.45e-04]
 [ 1.18e-01 -6.25e-01 -3.01e-01  9.38e-01 -1.92e-01]
 [-2.99e-02  1.05e-01 -1.23e-01  1.26e-01 -3.09e-02]
 [-2.52e-03 -9.89e-03  2.04e-02 -3.56e-02  1.40e-02]]
[[ 0.00e+00  0.00e+00  0.00e+00  2.23e-03 -5.91e-03]
 [ 1.00e+00  0.00e+00  3.58e-02  6.98e-04 -2.73e-03]
 [ 0.00e+00  1.22e-03  2.42e-02  3.86e-03  1.79e-02]
 [-9.62e-02  3.72e-03  4.24e-02  2.28e-03  1.08e-03]
 [-6.41e-02 -5.04e-03 -2.44e-03  7.55e-03  6.35e-03]]
[[ 2.32e-03 -3.58e-02  1.49e-01 -5.74e-02  9.63e-03]
 [ 1.01e-02  3.50e-02 -6.49e-01  1.15e-01 -1.74e-02]
 [-2.80e-02  1.01e-02 -2.72e-01 -1.10e-01  1.54e-02]
 [ 8.54e-03  1.02e-02  9.34e-01  8.80e-02 -2.13e-02]
 [ 4.82e-05  6.34e-03 -1.96e-01 -1.47e-02  8.91e-03]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00 -1.66e-03]
 [ 0.00e+00  0.00e+00  0.00e+00 -1.74e-03 -5.48e-03]
 [ 0.00e+00  0.00e+00  1.31e-03 -3.52e-03  9.40e-04]
 [ 0.00e+00  3.17e-03  2.35e-03 -1.90e-03  1.38e-03]
 [ 1.81e-01  3.30e-03  6.01e-03  1.34e-03 -1.09e-02]]
[[-0.01  0.06  0.1   0.05 -0.01]
 [ 0.06 -0.23 -0.38 -0.22  0.05]
 [-0.16  1.66 -1.91  1.65 -0.15]
 [ 0.04 -0.19 -0.43 -0.19  0.04]
 [-0.01  0.05  0.1   0.05 -0.01]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00 -3.19e-03]
 [ 0.00e+00  1.00e+00  0.00e+00 -5.14e-03 -3.69e-03]
 [ 0.00e+00  0.00e+00 -2.52e-04 -2.91e-03  2.29e-03]
 [ 0.00e+00 -4.91e-03 -1.20e-03  2.93e-01  6.05e-03]
 [-7.19e-02  7.88e-03 -6.54e-03  3.04e-03  1.42e-02]]
[[ 0.09 -0.26  0.01  0.16 -0.07]
 [-0.25  0.96 -0.05 -0.54  0.15]
 [ 0.07 -0.36  0.12 -0.35  0.09]
 [ 0.15 -0.45 -0.15  1.02 -0.27]
 [-0.06  0.12  0.05 -0.28  0.1 ]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  1.68e-01]
 [ 0.00e+00  0.00e+00  0.00e+00 -5.15e-04 -1.06e-03]
 [ 1.00e+00  0.00e+00  1.37e-03 -5.55e-04  4.53e-03]
 [ 0.00e+00  3.17e-03  5.50e-03 -3.25e-03 -6.82e-03]
 [-3.11e-02  2.20e-02  1.24e-03 -4.38e-03 -2.53e-02]]
[[-0.02  0.07 -0.24  0.1  -0.03]
 [ 0.09 -0.33  2.06 -0.47  0.11]
 [ 0.03 -0.13 -2.67  0.1  -0.02]
 [ 0.1  -0.38  2.16 -0.55  0.13]
 [-0.02  0.1  -0.3   0.14 -0.03]]
SymNet parameters
[[-1.37e-01 -3.58e-01  5.27e-02 -7.37e-02  1.55e-02  9.57e-03 -3.71e+00  1.95e-02
   8.35e-02  4.09e-03 -3.70e-03  1.04e-02]
 [ 8.55e-02 -2.38e-03  5.93e-03 -3.52e-04 -1.62e-04 -3.07e-04 -4.98e-02  3.40e-05
  -3.67e-05 -4.67e-05 -6.58e-05  1.47e-04]]
SymNet parameters
[-0.18  0.84]
SymNet parameters
[[ 1.06e+00  3.40e-01 -2.02e-01  1.32e-01 -7.92e-03 -2.13e-02  3.99e+00  4.21e-03
   1.53e-02 -4.84e-03  4.85e-03 -1.55e-02 -5.64e-03]
 [ 4.83e-02 -2.67e-01  3.63e-02 -9.47e-02  8.20e-03  6.53e-03 -2.88e+00 -2.17e-02
  -8.32e-02  1.22e-03 -4.41e-03  1.31e-02 -1.07e-03]]
SymNet parameters
[ 0.48 -0.27]
SymNet parameters
[[-1.06e-01 -3.55e-01  5.70e-02 -1.49e-01  5.88e-03  1.43e-02 -4.89e+00 -7.02e-03
  -1.11e-02  3.17e-03 -6.86e-03  1.91e-02 -5.11e-02 -1.06e-03]
 [-4.92e+00 -8.88e-01  3.35e-01 -3.58e-01  3.68e-02  5.26e-02 -8.10e+00 -8.36e-02
  -3.38e-01  1.07e-02 -1.15e-02  4.14e-02  6.06e-02  9.16e-04]]
SymNet parameters
[-0.42  0.11]
SymNet parameters
[[ 5.71e-01 -4.11e-01  4.37e-02  2.38e-02  7.75e-03 -6.18e-03  4.10e+00 -2.86e-02
  -8.81e-02 -2.90e-03  2.71e-03 -7.01e-03 -1.68e-02 -1.28e-02 -4.34e-03]
 [ 2.72e+00  4.98e-01 -4.56e-01  2.63e-01 -3.92e-02 -3.48e-02  7.00e+00 -1.35e-02
  -1.16e-01 -1.04e-02  1.05e-02 -2.86e-02  2.69e+00  2.36e-01  5.52e-02]]
SymNet parameters
[-2.27  0.85]
SymNet parameters
[[-6.90e-01  1.90e-02 -1.12e-01  3.50e-02 -4.41e-03 -4.48e-03  3.28e+00 -2.28e-02
  -8.05e-02 -2.58e-03  1.99e-03 -6.86e-03  6.25e-01  1.11e-01  2.94e-02 -6.83e-03]
 [-4.76e-01 -4.65e-01  6.25e-02  2.93e-02  6.21e-03 -6.45e-04 -3.30e+00  3.22e-02
   8.66e-02  3.16e-03  7.03e-05  1.95e-03 -6.51e-01 -6.40e-02 -1.66e-02 -1.56e-03]]
SymNet parameters
[0.27 2.19]
SymNet parameters
[[ 2.87e-02 -9.98e-01 -5.44e-01  8.18e-02  7.53e-03  4.41e-02 -3.10e-01 -6.25e-03
  -3.66e-02 -8.08e-04 -8.23e-04 -1.16e-04  5.04e-02 -8.31e-01 -2.15e-01  4.02e-01
  -1.37e+00]]
SymNet parameters
[0.79]
SymNet parameters
[[ 9.04e-02  1.66e-02 -1.47e-01 -4.63e-03  6.09e-04 -3.21e-03  2.30e+00 -2.51e-01
   5.20e-02 -1.17e-03 -1.05e-02  5.80e-02]
 [ 1.37e+00  7.08e-02 -7.64e-02  5.35e-03 -5.86e-03 -1.40e-03  3.09e-01  3.89e-01
   9.54e-01 -1.16e-02  9.67e-03 -2.08e-01]]
SymNet parameters
[1.4  0.58]
SymNet parameters
[[-7.17e-02 -2.15e-01  9.96e-01 -1.84e-02 -6.92e-03 -2.31e-02 -1.32e+00  8.49e+00
   1.08e+00 -6.52e-03 -6.13e-01 -7.29e-02 -1.91e-01]
 [-7.94e-03  3.42e-01  1.49e-01  7.02e-03  3.70e-03  1.21e-02 -4.58e+00 -1.09e-01
  -5.49e-02  1.59e-02 -3.58e-02  9.23e-02  2.86e-02]]
SymNet parameters
[-0.65 -0.25]
SymNet parameters
[[ 2.84e+00 -5.85e-02  7.21e-02 -3.85e-03  2.30e-03 -5.88e-03 -2.28e+00 -3.67e-01
  -1.56e+00  2.34e-02 -1.97e-02  4.20e-02 -1.30e-02 -6.20e-03]
 [-1.33e-01 -5.29e-03 -2.83e-02 -4.83e-03  9.03e-04 -4.69e-04  3.22e+00 -4.00e-01
  -2.48e-01 -1.41e-03 -4.66e-03  7.43e-02 -2.79e-02  1.00e-03]]
SymNet parameters
[-3.36 -1.96]
SymNet parameters
[[-1.48e-01 -9.71e-03  1.19e-01  2.28e-03 -8.68e-04  3.06e-03 -6.46e-02  8.29e-01
  -4.15e-02 -2.74e-03  1.01e-02 -3.29e-02 -2.18e-02 -9.66e-04 -2.91e-04]
 [-1.71e+00 -6.75e-03  9.53e-02  4.06e-03 -8.62e-04  4.11e-03 -1.01e+00  1.71e-01
  -7.54e-02 -6.27e-04  7.18e-03 -4.65e-02  4.63e-03  6.62e-05  6.97e-03]]
SymNet parameters
[-1.46 -1.03]
SymNet parameters
[[-8.06e-01 -4.56e-01  1.24e-01 -4.43e-02  3.84e-02 -1.48e-02 -6.36e+00 -4.54e+00
  -5.92e+00  1.17e-01 -1.20e-01  1.31e+00  4.19e-02 -1.23e-02 -3.22e-04  7.06e-02]
 [ 1.28e+00  8.92e-02 -7.60e-01 -2.69e-02  3.08e-03 -1.78e-02  1.28e+01 -1.71e+00
  -2.74e-01 -5.47e-03 -6.07e-02  3.22e-01 -4.27e-02  7.12e-04 -3.46e-03 -6.00e-02]]
SymNet parameters
[0.46 0.2 ]
SymNet parameters
[[ 1.44e+00  6.58e-02 -2.84e-03  4.12e-03 -7.99e-03 -1.13e-03  2.63e+00  6.24e-01
   2.11e-01  4.55e-02  7.21e-03 -1.97e-01 -1.08e+00 -2.14e-03  2.82e-01  7.71e-01
  -3.41e-02]]
SymNet parameters
[-2.11]
finally, finish this stage
iter:  1363    time: 25.09
Func: 2.71e-01  |g|: 6.95e-01
stableloss: 3.05e-02   dataloss: 2.40e-01   sparseloss: 1.77e+02 momentloss: 7.74e+00
current expression:
[u00*u01, u10*v00, u20, u02, u00*u01**2, u00, u10*v00*v10, u00*u11*v00, u01*u10*v00, u00*v00, u01**2, 1, u00**3, u01*u10, v00, u10*v01, u20*v00**2, v00**2, u01, u10*v00*v01]
[-0.98 -0.98  0.05  0.05  0.01  0.01  0.01  0.01  0.01 -0.    0.    0.   -0.    0.
 -0.    0.    0.   -0.   -0.    0.  ]
[v00*v10, u00*v01, v02, v20, v00*v10**2, u00*v01*v10, u00*u01*v01, u00*v00*v11, v01*v10, u10*v00*v01, v00, u01*v01, 1, u01, v10**2, u10*v01, v01, v00**3, u00*v00, v00*v01]
[-0.98 -0.97  0.05  0.05  0.01  0.01  0.01  0.01  0.01  0.01  0.01  0.    0.    0.
  0.    0.   -0.   -0.    0.   -0.  ]
block:  5
name:  burgers-2-upwind-sparse0-noise0.001-id4
device:  cuda:0
generate a random number to check random seed:  0.9223784663860559
current stage is: block-5
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.9854, device='cuda:0', dtype=torch.float64)
u_obs variance
tensor([ 0.2370,  1.6747,  1.4996, 20.9557, 10.6826, 17.4876,  0.2440,  1.5516,
         1.6038, 17.2611, 11.0040, 22.2595], device='cuda:0',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 0.550214
         Iterations: 0
         Function evaluations: 15
         Gradient evaluations: 3
convolution moment and kernels
[[ 1.00e+00  0.00e+00  1.78e-03 -6.51e-02 -7.54e-02]
 [ 0.00e+00 -3.19e-03  6.76e-03  2.27e-03  1.67e-03]
 [ 9.71e-04  1.50e-02  5.29e-02  8.39e-03  9.96e-04]
 [-4.69e-02  2.17e-03 -3.20e-03  5.45e-03 -3.88e-03]
 [-1.14e-01  3.60e-02 -1.34e-02  1.98e-02 -3.62e-03]]
[[-0.01 -0.02 -0.06 -0.01  0.01]
 [ 0.02  0.13  0.18  0.1  -0.02]
 [-0.08  0.03  0.25  0.2  -0.08]
 [ 0.04  0.11  0.3   0.08 -0.02]
 [-0.01 -0.01 -0.12 -0.    0.  ]]
[[ 0.00e+00  1.00e+00  0.00e+00 -9.90e-02 -7.75e-02]
 [ 0.00e+00  0.00e+00 -9.37e-04 -1.77e-03  7.17e-05]
 [ 0.00e+00  4.17e-02 -5.78e-03  6.06e-02 -1.68e-02]
 [-6.86e-03  6.38e-03  1.09e-03  1.30e-02  8.90e-03]
 [-1.02e-02  7.60e-03 -8.91e-04  1.61e-02 -8.38e-05]]
[[-5.18e-03  1.49e-02 -2.30e-02  7.35e-03 -9.10e-04]
 [-2.56e-02  5.88e-02 -3.89e-02  3.99e-02 -3.26e-04]
 [ 1.18e-01 -6.25e-01 -3.01e-01  9.38e-01 -1.92e-01]
 [-2.99e-02  1.05e-01 -1.23e-01  1.26e-01 -3.09e-02]
 [-2.52e-03 -9.87e-03  2.04e-02 -3.56e-02  1.40e-02]]
[[ 0.00e+00  0.00e+00  0.00e+00  2.23e-03 -5.91e-03]
 [ 1.00e+00  0.00e+00  3.58e-02  6.98e-04 -2.73e-03]
 [ 0.00e+00  1.22e-03  2.42e-02  3.86e-03  1.79e-02]
 [-9.62e-02  3.72e-03  4.24e-02  2.28e-03  1.08e-03]
 [-6.41e-02 -5.05e-03 -2.43e-03  7.55e-03  6.34e-03]]
[[ 2.31e-03 -3.57e-02  1.48e-01 -5.74e-02  9.63e-03]
 [ 1.01e-02  3.48e-02 -6.49e-01  1.15e-01 -1.74e-02]
 [-2.81e-02  1.04e-02 -2.73e-01 -1.10e-01  1.54e-02]
 [ 8.59e-03  9.97e-03  9.34e-01  8.79e-02 -2.13e-02]
 [ 3.59e-05  6.40e-03 -1.96e-01 -1.46e-02  8.90e-03]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00 -1.66e-03]
 [ 0.00e+00  0.00e+00  0.00e+00 -1.74e-03 -5.48e-03]
 [ 0.00e+00  0.00e+00  1.31e-03 -3.52e-03  9.40e-04]
 [ 0.00e+00  3.17e-03  2.35e-03 -1.90e-03  1.38e-03]
 [ 1.81e-01  3.30e-03  6.01e-03  1.34e-03 -1.09e-02]]
[[-0.01  0.06  0.1   0.05 -0.01]
 [ 0.06 -0.23 -0.38 -0.22  0.05]
 [-0.16  1.66 -1.91  1.65 -0.15]
 [ 0.04 -0.19 -0.43 -0.19  0.04]
 [-0.01  0.05  0.1   0.05 -0.01]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00 -3.19e-03]
 [ 0.00e+00  1.00e+00  0.00e+00 -5.14e-03 -3.69e-03]
 [ 0.00e+00  0.00e+00 -2.52e-04 -2.91e-03  2.29e-03]
 [ 0.00e+00 -4.91e-03 -1.20e-03  2.93e-01  6.05e-03]
 [-7.19e-02  7.88e-03 -6.54e-03  3.04e-03  1.42e-02]]
[[ 0.09 -0.26  0.01  0.16 -0.07]
 [-0.25  0.96 -0.05 -0.54  0.15]
 [ 0.07 -0.36  0.12 -0.35  0.09]
 [ 0.15 -0.45 -0.15  1.02 -0.27]
 [-0.06  0.12  0.05 -0.28  0.1 ]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  1.68e-01]
 [ 0.00e+00  0.00e+00  0.00e+00 -5.15e-04 -1.06e-03]
 [ 1.00e+00  0.00e+00  1.38e-03 -5.56e-04  4.53e-03]
 [ 0.00e+00  3.17e-03  5.50e-03 -3.24e-03 -6.82e-03]
 [-3.11e-02  2.20e-02  1.24e-03 -4.38e-03 -2.53e-02]]
[[-0.02  0.07 -0.24  0.1  -0.03]
 [ 0.09 -0.33  2.06 -0.47  0.11]
 [ 0.03 -0.13 -2.67  0.1  -0.02]
 [ 0.1  -0.38  2.16 -0.54  0.13]
 [-0.02  0.1  -0.3   0.14 -0.03]]
SymNet parameters
[[-1.37e-01 -3.58e-01  5.27e-02 -7.38e-02  1.54e-02  9.56e-03 -3.71e+00  1.95e-02
   8.35e-02  4.09e-03 -3.69e-03  1.05e-02]
 [ 8.55e-02 -2.36e-03  5.87e-03 -5.13e-04 -2.54e-04 -4.58e-04 -4.98e-02  3.93e-06
  -7.44e-05 -2.62e-04 -1.42e-04  3.34e-04]]
SymNet parameters
[-0.18  0.84]
SymNet parameters
[[ 1.06e+00  3.40e-01 -2.02e-01  1.32e-01 -7.94e-03 -2.13e-02  3.99e+00  4.21e-03
   1.53e-02 -4.85e-03  4.85e-03 -1.54e-02 -5.63e-03]
 [ 4.83e-02 -2.67e-01  3.64e-02 -9.47e-02  8.22e-03  6.54e-03 -2.88e+00 -2.17e-02
  -8.32e-02  1.24e-03 -4.41e-03  1.30e-02 -1.08e-03]]
SymNet parameters
[ 0.48 -0.27]
SymNet parameters
[[-1.06e-01 -3.55e-01  5.70e-02 -1.49e-01  5.87e-03  1.43e-02 -4.89e+00 -7.02e-03
  -1.11e-02  3.16e-03 -6.86e-03  1.91e-02 -5.11e-02 -1.25e-03]
 [-4.92e+00 -8.88e-01  3.35e-01 -3.58e-01  3.68e-02  5.26e-02 -8.10e+00 -8.36e-02
  -3.38e-01  1.07e-02 -1.15e-02  4.14e-02  6.06e-02  8.26e-04]]
SymNet parameters
[-0.42  0.11]
SymNet parameters
[[ 5.71e-01 -4.11e-01  4.37e-02  2.38e-02  7.75e-03 -6.18e-03  4.10e+00 -2.86e-02
  -8.81e-02 -2.90e-03  2.71e-03 -7.02e-03 -1.68e-02 -1.28e-02 -4.32e-03]
 [ 2.72e+00  4.98e-01 -4.56e-01  2.63e-01 -3.92e-02 -3.48e-02  7.00e+00 -1.35e-02
  -1.16e-01 -1.04e-02  1.05e-02 -2.86e-02  2.69e+00  2.36e-01  5.52e-02]]
SymNet parameters
[-2.27  0.85]
SymNet parameters
[[-6.90e-01  1.90e-02 -1.12e-01  3.50e-02 -4.42e-03 -4.49e-03  3.28e+00 -2.28e-02
  -8.05e-02 -2.59e-03  1.99e-03 -6.84e-03  6.25e-01  1.11e-01  2.94e-02 -6.85e-03]
 [-4.76e-01 -4.65e-01  6.25e-02  2.93e-02  6.21e-03 -6.42e-04 -3.30e+00  3.22e-02
   8.66e-02  3.15e-03  6.93e-05  1.94e-03 -6.51e-01 -6.41e-02 -1.64e-02 -1.55e-03]]
SymNet parameters
[0.27 2.19]
SymNet parameters
[[ 2.87e-02 -9.98e-01 -5.44e-01  8.18e-02  7.53e-03  4.41e-02 -3.10e-01 -6.25e-03
  -3.66e-02 -8.06e-04 -8.23e-04 -1.17e-04  5.04e-02 -8.31e-01 -2.15e-01  4.02e-01
  -1.37e+00]]
SymNet parameters
[0.79]
SymNet parameters
[[ 9.04e-02  1.66e-02 -1.47e-01 -4.61e-03  6.00e-04 -3.20e-03  2.30e+00 -2.51e-01
   5.20e-02 -1.17e-03 -1.05e-02  5.80e-02]
 [ 1.37e+00  7.08e-02 -7.64e-02  5.35e-03 -5.85e-03 -1.40e-03  3.09e-01  3.89e-01
   9.54e-01 -1.16e-02  9.66e-03 -2.08e-01]]
SymNet parameters
[1.4  0.58]
SymNet parameters
[[-7.17e-02 -2.15e-01  9.96e-01 -1.84e-02 -6.93e-03 -2.31e-02 -1.32e+00  8.49e+00
   1.08e+00 -6.52e-03 -6.13e-01 -7.29e-02 -1.91e-01]
 [-7.94e-03  3.42e-01  1.49e-01  7.02e-03  3.70e-03  1.21e-02 -4.58e+00 -1.09e-01
  -5.49e-02  1.59e-02 -3.58e-02  9.23e-02  2.86e-02]]
SymNet parameters
[-0.65 -0.25]
SymNet parameters
[[ 2.84e+00 -5.85e-02  7.21e-02 -3.85e-03  2.30e-03 -5.88e-03 -2.28e+00 -3.67e-01
  -1.56e+00  2.34e-02 -1.97e-02  4.20e-02 -1.30e-02 -6.01e-03]
 [-1.33e-01 -5.29e-03 -2.83e-02 -4.83e-03  9.06e-04 -4.74e-04  3.22e+00 -4.00e-01
  -2.48e-01 -1.42e-03 -4.66e-03  7.43e-02 -2.79e-02  8.85e-04]]
SymNet parameters
[-3.36 -1.96]
SymNet parameters
[[-1.48e-01 -9.71e-03  1.19e-01  2.28e-03 -8.64e-04  3.06e-03 -6.46e-02  8.29e-01
  -4.15e-02 -2.74e-03  1.01e-02 -3.29e-02 -2.18e-02 -1.12e-03 -2.72e-04]
 [-1.71e+00 -6.75e-03  9.53e-02  4.07e-03 -8.58e-04  4.11e-03 -1.01e+00  1.71e-01
  -7.54e-02 -6.23e-04  7.18e-03 -4.64e-02  4.64e-03 -1.52e-04  6.98e-03]]
SymNet parameters
[-1.46 -1.03]
SymNet parameters
[[-8.06e-01 -4.56e-01  1.24e-01 -4.43e-02  3.84e-02 -1.48e-02 -6.36e+00 -4.54e+00
  -5.92e+00  1.17e-01 -1.20e-01  1.31e+00  4.19e-02 -1.24e-02 -2.95e-04  7.06e-02]
 [ 1.28e+00  8.92e-02 -7.60e-01 -2.69e-02  3.09e-03 -1.78e-02  1.28e+01 -1.71e+00
  -2.74e-01 -5.47e-03 -6.07e-02  3.22e-01 -4.27e-02  7.43e-04 -3.49e-03 -6.00e-02]]
SymNet parameters
[0.46 0.2 ]
SymNet parameters
[[ 1.44e+00  6.58e-02 -2.84e-03  4.12e-03 -8.00e-03 -1.13e-03  2.63e+00  6.24e-01
   2.11e-01  4.55e-02  7.21e-03 -1.97e-01 -1.08e+00 -2.16e-03  2.82e-01  7.71e-01
  -3.39e-02]]
SymNet parameters
[-2.11]
finally, finish this stage
iter:     0    time: 480.90
Func: 5.50e-01  |g|: 1.24e+02
stableloss: 3.88e-02   dataloss: 5.12e-01   sparseloss: 1.77e+02 momentloss: 7.74e+00
current expression:
[u00*u01, u10*v00, u20, u02, u00*u01**2, u00, u10*v00*v10, u00*u11*v00, u01*u10*v00, u00*v00, u01**2, 1, u00**3, u01*u10, v00, u10*v01, u20*v00**2, v00**2, u01, u10*v00*v01]
[-0.98 -0.98  0.05  0.05  0.01  0.01  0.01  0.01  0.01 -0.    0.    0.   -0.    0.
 -0.    0.    0.   -0.   -0.    0.  ]
[v00*v10, u00*v01, v02, v20, v00*v10**2, u00*v01*v10, u00*u01*v01, u00*v00*v11, v01*v10, u10*v00*v01, v00, u01*v01, 1, u01, v10**2, u10*v01, v01, v00**3, u00*v00, v00*v01]
[-0.98 -0.97  0.05  0.05  0.01  0.01  0.01  0.01  0.01  0.01  0.01  0.    0.    0.
  0.    0.   -0.   -0.    0.   -0.  ]
block:  6
name:  burgers-2-upwind-sparse0-noise0.001-id4
device:  cuda:0
generate a random number to check random seed:  1.1143758823573664
current stage is: block-6
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.8897, device='cuda:0', dtype=torch.float64)
u_obs variance
tensor([ 0.2468,  1.7609,  1.5722, 22.1688, 11.4060, 18.3960,  0.2466,  1.5867,
         1.5552, 18.0756, 10.6069, 21.0109], device='cuda:0',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 0.714186
         Iterations: 0
         Function evaluations: 15
         Gradient evaluations: 3
convolution moment and kernels
[[ 1.00e+00  0.00e+00  1.78e-03 -6.51e-02 -7.54e-02]
 [ 0.00e+00 -3.19e-03  6.76e-03  2.27e-03  1.67e-03]
 [ 9.70e-04  1.50e-02  5.29e-02  8.39e-03  9.94e-04]
 [-4.69e-02  2.17e-03 -3.21e-03  5.45e-03 -3.88e-03]
 [-1.14e-01  3.60e-02 -1.35e-02  1.98e-02 -3.62e-03]]
[[-0.01 -0.02 -0.06 -0.01  0.01]
 [ 0.02  0.13  0.18  0.1  -0.02]
 [-0.08  0.03  0.25  0.2  -0.08]
 [ 0.04  0.11  0.3   0.08 -0.02]
 [-0.01 -0.01 -0.12 -0.    0.  ]]
[[ 0.00e+00  1.00e+00  0.00e+00 -9.90e-02 -7.75e-02]
 [ 0.00e+00  0.00e+00 -9.36e-04 -1.77e-03  7.15e-05]
 [ 0.00e+00  4.17e-02 -5.78e-03  6.06e-02 -1.68e-02]
 [-6.86e-03  6.38e-03  1.09e-03  1.30e-02  8.90e-03]
 [-1.02e-02  7.60e-03 -8.93e-04  1.61e-02 -8.11e-05]]
[[-5.18e-03  1.49e-02 -2.30e-02  7.33e-03 -9.07e-04]
 [-2.56e-02  5.89e-02 -3.90e-02  4.00e-02 -3.41e-04]
 [ 1.18e-01 -6.25e-01 -3.01e-01  9.38e-01 -1.92e-01]
 [-2.99e-02  1.05e-01 -1.23e-01  1.26e-01 -3.09e-02]
 [-2.52e-03 -9.88e-03  2.04e-02 -3.56e-02  1.40e-02]]
[[ 0.00e+00  0.00e+00  0.00e+00  2.23e-03 -5.91e-03]
 [ 1.00e+00  0.00e+00  3.58e-02  6.98e-04 -2.73e-03]
 [ 0.00e+00  1.22e-03  2.42e-02  3.87e-03  1.79e-02]
 [-9.62e-02  3.72e-03  4.24e-02  2.28e-03  1.08e-03]
 [-6.41e-02 -5.04e-03 -2.44e-03  7.55e-03  6.35e-03]]
[[ 2.32e-03 -3.58e-02  1.49e-01 -5.74e-02  9.63e-03]
 [ 1.01e-02  3.50e-02 -6.49e-01  1.15e-01 -1.74e-02]
 [-2.80e-02  1.01e-02 -2.72e-01 -1.10e-01  1.54e-02]
 [ 8.54e-03  1.02e-02  9.34e-01  8.80e-02 -2.13e-02]
 [ 4.84e-05  6.34e-03 -1.96e-01 -1.46e-02  8.90e-03]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00 -1.66e-03]
 [ 0.00e+00  0.00e+00  0.00e+00 -1.74e-03 -5.48e-03]
 [ 0.00e+00  0.00e+00  1.31e-03 -3.52e-03  9.40e-04]
 [ 0.00e+00  3.17e-03  2.35e-03 -1.90e-03  1.38e-03]
 [ 1.81e-01  3.30e-03  6.01e-03  1.33e-03 -1.09e-02]]
[[-0.01  0.06  0.1   0.05 -0.01]
 [ 0.06 -0.23 -0.38 -0.22  0.05]
 [-0.16  1.66 -1.91  1.65 -0.15]
 [ 0.04 -0.19 -0.43 -0.19  0.04]
 [-0.01  0.05  0.1   0.05 -0.01]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00 -3.19e-03]
 [ 0.00e+00  1.00e+00  0.00e+00 -5.14e-03 -3.69e-03]
 [ 0.00e+00  0.00e+00 -2.52e-04 -2.91e-03  2.29e-03]
 [ 0.00e+00 -4.91e-03 -1.20e-03  2.93e-01  6.05e-03]
 [-7.19e-02  7.88e-03 -6.54e-03  3.04e-03  1.42e-02]]
[[ 0.09 -0.26  0.01  0.16 -0.07]
 [-0.25  0.96 -0.05 -0.54  0.15]
 [ 0.07 -0.36  0.12 -0.35  0.09]
 [ 0.15 -0.45 -0.15  1.02 -0.27]
 [-0.06  0.12  0.05 -0.28  0.1 ]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  1.68e-01]
 [ 0.00e+00  0.00e+00  0.00e+00 -5.15e-04 -1.06e-03]
 [ 1.00e+00  0.00e+00  1.37e-03 -5.55e-04  4.53e-03]
 [ 0.00e+00  3.17e-03  5.50e-03 -3.25e-03 -6.82e-03]
 [-3.11e-02  2.20e-02  1.24e-03 -4.38e-03 -2.53e-02]]
[[-0.02  0.07 -0.24  0.1  -0.03]
 [ 0.09 -0.33  2.06 -0.47  0.11]
 [ 0.03 -0.13 -2.67  0.1  -0.02]
 [ 0.1  -0.38  2.16 -0.55  0.13]
 [-0.02  0.1  -0.3   0.14 -0.03]]
SymNet parameters
[[-1.37e-01 -3.58e-01  5.27e-02 -7.37e-02  1.55e-02  9.58e-03 -3.71e+00  1.95e-02
   8.35e-02  4.10e-03 -3.70e-03  1.04e-02]
 [ 8.55e-02 -2.41e-03  5.93e-03 -2.46e-04 -2.11e-04 -2.86e-04 -4.99e-02  2.05e-05
  -5.13e-05  2.63e-06 -6.84e-05  1.63e-04]]
SymNet parameters
[-0.18  0.84]
SymNet parameters
[[ 1.06e+00  3.40e-01 -2.02e-01  1.32e-01 -7.93e-03 -2.13e-02  3.99e+00  4.21e-03
   1.53e-02 -4.83e-03  4.84e-03 -1.55e-02 -5.62e-03]
 [ 4.83e-02 -2.67e-01  3.63e-02 -9.48e-02  8.20e-03  6.52e-03 -2.88e+00 -2.17e-02
  -8.32e-02  1.21e-03 -4.41e-03  1.31e-02 -1.10e-03]]
SymNet parameters
[ 0.48 -0.27]
SymNet parameters
[[-1.06e-01 -3.55e-01  5.70e-02 -1.49e-01  5.88e-03  1.43e-02 -4.89e+00 -7.02e-03
  -1.11e-02  3.18e-03 -6.86e-03  1.91e-02 -5.11e-02 -1.25e-03]
 [-4.92e+00 -8.88e-01  3.35e-01 -3.58e-01  3.68e-02  5.26e-02 -8.10e+00 -8.36e-02
  -3.38e-01  1.07e-02 -1.15e-02  4.14e-02  6.06e-02  8.31e-04]]
SymNet parameters
[-0.42  0.11]
SymNet parameters
[[ 5.71e-01 -4.11e-01  4.37e-02  2.38e-02  7.75e-03 -6.18e-03  4.10e+00 -2.86e-02
  -8.81e-02 -2.90e-03  2.71e-03 -7.01e-03 -1.68e-02 -1.27e-02 -4.35e-03]
 [ 2.72e+00  4.98e-01 -4.56e-01  2.63e-01 -3.92e-02 -3.48e-02  7.00e+00 -1.35e-02
  -1.16e-01 -1.04e-02  1.05e-02 -2.86e-02  2.69e+00  2.36e-01  5.54e-02]]
SymNet parameters
[-2.27  0.85]
SymNet parameters
[[-6.90e-01  1.90e-02 -1.12e-01  3.51e-02 -4.41e-03 -4.48e-03  3.28e+00 -2.28e-02
  -8.05e-02 -2.58e-03  1.98e-03 -6.85e-03  6.25e-01  1.11e-01  2.97e-02 -6.86e-03]
 [-4.76e-01 -4.65e-01  6.25e-02  2.93e-02  6.21e-03 -6.48e-04 -3.30e+00  3.22e-02
   8.66e-02  3.16e-03  6.95e-05  1.94e-03 -6.51e-01 -6.40e-02 -1.66e-02 -1.56e-03]]
SymNet parameters
[0.27 2.19]
SymNet parameters
[[ 2.87e-02 -9.98e-01 -5.44e-01  8.18e-02  7.53e-03  4.41e-02 -3.10e-01 -6.25e-03
  -3.66e-02 -8.09e-04 -8.23e-04 -1.16e-04  5.04e-02 -8.31e-01 -2.15e-01  4.02e-01
  -1.37e+00]]
SymNet parameters
[0.79]
SymNet parameters
[[ 9.04e-02  1.66e-02 -1.47e-01 -4.62e-03  6.13e-04 -3.21e-03  2.30e+00 -2.51e-01
   5.20e-02 -1.17e-03 -1.05e-02  5.80e-02]
 [ 1.37e+00  7.08e-02 -7.64e-02  5.34e-03 -5.86e-03 -1.40e-03  3.09e-01  3.89e-01
   9.54e-01 -1.16e-02  9.67e-03 -2.08e-01]]
SymNet parameters
[1.4  0.58]
SymNet parameters
[[-7.17e-02 -2.15e-01  9.96e-01 -1.84e-02 -6.93e-03 -2.31e-02 -1.32e+00  8.49e+00
   1.08e+00 -6.52e-03 -6.13e-01 -7.29e-02 -1.91e-01]
 [-7.94e-03  3.42e-01  1.49e-01  7.02e-03  3.70e-03  1.21e-02 -4.58e+00 -1.09e-01
  -5.49e-02  1.59e-02 -3.58e-02  9.23e-02  2.86e-02]]
SymNet parameters
[-0.65 -0.25]
SymNet parameters
[[ 2.84e+00 -5.85e-02  7.21e-02 -3.85e-03  2.30e-03 -5.88e-03 -2.28e+00 -3.67e-01
  -1.56e+00  2.34e-02 -1.97e-02  4.20e-02 -1.30e-02 -6.22e-03]
 [-1.33e-01 -5.29e-03 -2.83e-02 -4.83e-03  9.02e-04 -4.71e-04  3.22e+00 -4.00e-01
  -2.48e-01 -1.41e-03 -4.66e-03  7.43e-02 -2.79e-02  1.06e-03]]
SymNet parameters
[-3.36 -1.96]
SymNet parameters
[[-1.48e-01 -9.70e-03  1.19e-01  2.28e-03 -8.66e-04  3.06e-03 -6.46e-02  8.29e-01
  -4.15e-02 -2.74e-03  1.01e-02 -3.29e-02 -2.18e-02 -1.01e-03 -2.80e-04]
 [-1.71e+00 -6.75e-03  9.53e-02  4.06e-03 -8.62e-04  4.11e-03 -1.01e+00  1.71e-01
  -7.54e-02 -6.27e-04  7.19e-03 -4.64e-02  4.64e-03 -2.45e-05  6.95e-03]]
SymNet parameters
[-1.46 -1.03]
SymNet parameters
[[-8.06e-01 -4.56e-01  1.24e-01 -4.43e-02  3.84e-02 -1.48e-02 -6.36e+00 -4.54e+00
  -5.92e+00  1.17e-01 -1.20e-01  1.31e+00  4.19e-02 -1.23e-02 -3.25e-04  7.06e-02]
 [ 1.28e+00  8.92e-02 -7.60e-01 -2.69e-02  3.08e-03 -1.78e-02  1.28e+01 -1.71e+00
  -2.74e-01 -5.47e-03 -6.07e-02  3.22e-01 -4.27e-02  6.69e-04 -3.47e-03 -6.00e-02]]
SymNet parameters
[0.46 0.2 ]
SymNet parameters
[[ 1.44e+00  6.58e-02 -2.84e-03  4.13e-03 -7.99e-03 -1.13e-03  2.63e+00  6.24e-01
   2.11e-01  4.55e-02  7.21e-03 -1.97e-01 -1.08e+00 -2.11e-03  2.82e-01  7.71e-01
  -3.39e-02]]
SymNet parameters
[-2.11]
finally, finish this stage
iter:     0    time: 32.42
Func: 7.14e-01  |g|: 3.04e+02
stableloss: 2.97e-02   dataloss: 6.68e-01   sparseloss: 1.77e+02 momentloss: 7.74e+00
current expression:
[u00*u01, u10*v00, u20, u02, u00*u01**2, u00, u10*v00*v10, u00*u11*v00, u01*u10*v00, u00*v00, u01**2, 1, u00**3, u01*u10, v00, u10*v01, u20*v00**2, v00**2, u01, u10*v00*v01]
[-0.98 -0.98  0.05  0.05  0.01  0.01  0.01  0.01  0.01 -0.    0.    0.   -0.    0.
 -0.    0.    0.   -0.   -0.    0.  ]
[v00*v10, u00*v01, v02, v20, v00*v10**2, u00*v01*v10, u00*u01*v01, u00*v00*v11, v01*v10, u10*v00*v01, v00, u01*v01, 1, u01, v10**2, u10*v01, v01, v00**3, u00*v00, v00*v01]
[-0.98 -0.97  0.05  0.05  0.01  0.01  0.01  0.01  0.01  0.01  0.01  0.    0.    0.
  0.    0.   -0.   -0.    0.   -0.  ]
block:  9
name:  burgers-2-upwind-sparse0-noise0.001-id4
device:  cuda:0
generate a random number to check random seed:  -1.3899006246084076
current stage is: block-9
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.8948, device='cuda:0', dtype=torch.float64)
u_obs variance
tensor([ 0.2510,  1.7640,  1.6341, 21.7131, 12.0833, 19.2841,  0.2448,  1.6129,
         1.6440, 17.6760, 11.1268, 21.8044], device='cuda:0',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 1.891997
         Iterations: 0
         Function evaluations: 15
         Gradient evaluations: 3
convolution moment and kernels
[[ 1.00e+00  0.00e+00  1.78e-03 -6.51e-02 -7.54e-02]
 [ 0.00e+00 -3.19e-03  6.76e-03  2.27e-03  1.67e-03]
 [ 9.70e-04  1.50e-02  5.29e-02  8.39e-03  9.95e-04]
 [-4.69e-02  2.17e-03 -3.21e-03  5.45e-03 -3.88e-03]
 [-1.14e-01  3.60e-02 -1.35e-02  1.98e-02 -3.62e-03]]
[[-0.01 -0.02 -0.06 -0.01  0.01]
 [ 0.02  0.13  0.18  0.1  -0.02]
 [-0.08  0.03  0.25  0.2  -0.08]
 [ 0.04  0.11  0.3   0.08 -0.02]
 [-0.01 -0.01 -0.12 -0.    0.  ]]
[[ 0.00e+00  1.00e+00  0.00e+00 -9.90e-02 -7.75e-02]
 [ 0.00e+00  0.00e+00 -9.37e-04 -1.77e-03  7.25e-05]
 [ 0.00e+00  4.17e-02 -5.78e-03  6.06e-02 -1.68e-02]
 [-6.86e-03  6.38e-03  1.09e-03  1.30e-02  8.90e-03]
 [-1.02e-02  7.60e-03 -8.92e-04  1.61e-02 -8.22e-05]]
[[-5.18e-03  1.49e-02 -2.30e-02  7.33e-03 -9.07e-04]
 [-2.56e-02  5.89e-02 -3.90e-02  4.00e-02 -3.40e-04]
 [ 1.18e-01 -6.25e-01 -3.01e-01  9.38e-01 -1.92e-01]
 [-2.99e-02  1.05e-01 -1.23e-01  1.26e-01 -3.09e-02]
 [-2.52e-03 -9.87e-03  2.04e-02 -3.56e-02  1.40e-02]]
[[ 0.00e+00  0.00e+00  0.00e+00  2.23e-03 -5.91e-03]
 [ 1.00e+00  0.00e+00  3.58e-02  6.98e-04 -2.73e-03]
 [ 0.00e+00  1.22e-03  2.42e-02  3.87e-03  1.79e-02]
 [-9.62e-02  3.72e-03  4.24e-02  2.28e-03  1.08e-03]
 [-6.41e-02 -5.04e-03 -2.44e-03  7.55e-03  6.34e-03]]
[[ 2.32e-03 -3.58e-02  1.48e-01 -5.74e-02  9.63e-03]
 [ 1.01e-02  3.50e-02 -6.49e-01  1.15e-01 -1.74e-02]
 [-2.80e-02  1.02e-02 -2.72e-01 -1.10e-01  1.54e-02]
 [ 8.55e-03  1.02e-02  9.34e-01  8.79e-02 -2.13e-02]
 [ 4.69e-05  6.35e-03 -1.96e-01 -1.46e-02  8.90e-03]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00 -1.66e-03]
 [ 0.00e+00  0.00e+00  0.00e+00 -1.74e-03 -5.48e-03]
 [ 0.00e+00  0.00e+00  1.31e-03 -3.52e-03  9.40e-04]
 [ 0.00e+00  3.17e-03  2.35e-03 -1.90e-03  1.38e-03]
 [ 1.81e-01  3.30e-03  6.01e-03  1.33e-03 -1.09e-02]]
[[-0.01  0.06  0.1   0.05 -0.01]
 [ 0.06 -0.23 -0.38 -0.22  0.05]
 [-0.16  1.66 -1.91  1.65 -0.15]
 [ 0.04 -0.19 -0.43 -0.19  0.04]
 [-0.01  0.05  0.1   0.05 -0.01]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00 -3.19e-03]
 [ 0.00e+00  1.00e+00  0.00e+00 -5.14e-03 -3.69e-03]
 [ 0.00e+00  0.00e+00 -2.52e-04 -2.91e-03  2.29e-03]
 [ 0.00e+00 -4.91e-03 -1.20e-03  2.93e-01  6.05e-03]
 [-7.19e-02  7.88e-03 -6.54e-03  3.04e-03  1.42e-02]]
[[ 0.09 -0.26  0.01  0.16 -0.07]
 [-0.25  0.96 -0.05 -0.54  0.15]
 [ 0.07 -0.36  0.12 -0.35  0.09]
 [ 0.15 -0.45 -0.15  1.02 -0.27]
 [-0.06  0.12  0.05 -0.28  0.1 ]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  1.68e-01]
 [ 0.00e+00  0.00e+00  0.00e+00 -5.15e-04 -1.06e-03]
 [ 1.00e+00  0.00e+00  1.37e-03 -5.55e-04  4.53e-03]
 [ 0.00e+00  3.17e-03  5.50e-03 -3.25e-03 -6.82e-03]
 [-3.11e-02  2.20e-02  1.24e-03 -4.38e-03 -2.53e-02]]
[[-0.02  0.07 -0.24  0.1  -0.03]
 [ 0.09 -0.33  2.06 -0.47  0.11]
 [ 0.03 -0.13 -2.67  0.1  -0.02]
 [ 0.1  -0.38  2.16 -0.55  0.13]
 [-0.02  0.1  -0.3   0.14 -0.03]]
SymNet parameters
[[-1.37e-01 -3.58e-01  5.27e-02 -7.37e-02  1.54e-02  9.58e-03 -3.71e+00  1.95e-02
   8.35e-02  4.03e-03 -3.69e-03  1.04e-02]
 [ 8.54e-02 -2.48e-03  5.98e-03 -2.69e-04 -2.39e-04 -1.88e-04 -4.97e-02  2.05e-05
  -7.61e-05 -3.83e-04 -1.14e-04  5.13e-05]]
SymNet parameters
[-0.18  0.84]
SymNet parameters
[[ 1.06e+00  3.40e-01 -2.02e-01  1.32e-01 -7.93e-03 -2.12e-02  3.99e+00  4.21e-03
   1.53e-02 -4.88e-03  4.85e-03 -1.55e-02 -5.69e-03]
 [ 4.83e-02 -2.67e-01  3.63e-02 -9.48e-02  8.21e-03  6.51e-03 -2.88e+00 -2.17e-02
  -8.32e-02  1.26e-03 -4.41e-03  1.31e-02 -1.02e-03]]
SymNet parameters
[ 0.48 -0.27]
SymNet parameters
[[-1.06e-01 -3.55e-01  5.70e-02 -1.49e-01  5.87e-03  1.43e-02 -4.89e+00 -7.01e-03
  -1.11e-02  3.16e-03 -6.87e-03  1.91e-02 -5.11e-02 -9.61e-04]
 [-4.92e+00 -8.88e-01  3.35e-01 -3.58e-01  3.68e-02  5.26e-02 -8.10e+00 -8.36e-02
  -3.38e-01  1.07e-02 -1.15e-02  4.14e-02  6.06e-02  1.00e-03]]
SymNet parameters
[-0.42  0.11]
SymNet parameters
[[ 5.71e-01 -4.11e-01  4.37e-02  2.38e-02  7.75e-03 -6.18e-03  4.10e+00 -2.86e-02
  -8.81e-02 -2.89e-03  2.71e-03 -7.00e-03 -1.68e-02 -1.28e-02 -4.27e-03]
 [ 2.72e+00  4.98e-01 -4.56e-01  2.63e-01 -3.92e-02 -3.48e-02  7.00e+00 -1.35e-02
  -1.16e-01 -1.04e-02  1.05e-02 -2.86e-02  2.69e+00  2.36e-01  5.51e-02]]
SymNet parameters
[-2.27  0.85]
SymNet parameters
[[-6.90e-01  1.89e-02 -1.12e-01  3.50e-02 -4.42e-03 -4.48e-03  3.28e+00 -2.28e-02
  -8.05e-02 -2.61e-03  1.98e-03 -6.87e-03  6.25e-01  1.11e-01  2.93e-02 -6.64e-03]
 [-4.76e-01 -4.65e-01  6.25e-02  2.93e-02  6.21e-03 -6.44e-04 -3.30e+00  3.22e-02
   8.66e-02  3.17e-03  6.63e-05  1.96e-03 -6.51e-01 -6.41e-02 -1.65e-02 -1.74e-03]]
SymNet parameters
[0.27 2.19]
SymNet parameters
[[ 2.87e-02 -9.98e-01 -5.44e-01  8.18e-02  7.53e-03  4.41e-02 -3.10e-01 -6.25e-03
  -3.66e-02 -8.03e-04 -8.23e-04 -1.14e-04  5.04e-02 -8.31e-01 -2.15e-01  4.02e-01
  -1.37e+00]]
SymNet parameters
[0.79]
SymNet parameters
[[ 9.04e-02  1.66e-02 -1.47e-01 -4.63e-03  6.12e-04 -3.21e-03  2.30e+00 -2.51e-01
   5.20e-02 -1.20e-03 -1.05e-02  5.80e-02]
 [ 1.37e+00  7.08e-02 -7.64e-02  5.34e-03 -5.86e-03 -1.40e-03  3.09e-01  3.89e-01
   9.54e-01 -1.16e-02  9.67e-03 -2.08e-01]]
SymNet parameters
[1.4  0.58]
SymNet parameters
[[-7.17e-02 -2.15e-01  9.96e-01 -1.84e-02 -6.93e-03 -2.31e-02 -1.32e+00  8.49e+00
   1.08e+00 -6.52e-03 -6.13e-01 -7.29e-02 -1.91e-01]
 [-7.94e-03  3.42e-01  1.49e-01  7.02e-03  3.70e-03  1.21e-02 -4.58e+00 -1.09e-01
  -5.49e-02  1.59e-02 -3.58e-02  9.23e-02  2.86e-02]]
SymNet parameters
[-0.65 -0.25]
SymNet parameters
[[ 2.84e+00 -5.85e-02  7.21e-02 -3.85e-03  2.30e-03 -5.88e-03 -2.28e+00 -3.67e-01
  -1.56e+00  2.34e-02 -1.97e-02  4.20e-02 -1.30e-02 -6.16e-03]
 [-1.33e-01 -5.29e-03 -2.83e-02 -4.83e-03  9.04e-04 -4.70e-04  3.22e+00 -4.00e-01
  -2.48e-01 -1.40e-03 -4.66e-03  7.43e-02 -2.79e-02  9.10e-04]]
SymNet parameters
[-3.36 -1.96]
SymNet parameters
[[-1.48e-01 -9.71e-03  1.19e-01  2.27e-03 -8.64e-04  3.06e-03 -6.46e-02  8.29e-01
  -4.15e-02 -2.77e-03  1.01e-02 -3.29e-02 -2.17e-02 -1.09e-03 -2.28e-04]
 [-1.71e+00 -6.75e-03  9.53e-02  4.06e-03 -8.62e-04  4.12e-03 -1.01e+00  1.71e-01
  -7.54e-02 -6.31e-04  7.19e-03 -4.64e-02  4.64e-03 -1.37e-04  7.01e-03]]
SymNet parameters
[-1.46 -1.03]
SymNet parameters
[[-8.06e-01 -4.56e-01  1.24e-01 -4.43e-02  3.84e-02 -1.48e-02 -6.36e+00 -4.54e+00
  -5.92e+00  1.17e-01 -1.20e-01  1.31e+00  4.19e-02 -1.23e-02 -3.12e-04  7.06e-02]
 [ 1.28e+00  8.92e-02 -7.60e-01 -2.69e-02  3.08e-03 -1.78e-02  1.28e+01 -1.71e+00
  -2.74e-01 -5.47e-03 -6.07e-02  3.22e-01 -4.27e-02  6.89e-04 -3.47e-03 -6.00e-02]]
SymNet parameters
[0.46 0.2 ]
SymNet parameters
[[ 1.44e+00  6.58e-02 -2.84e-03  4.13e-03 -7.99e-03 -1.13e-03  2.63e+00  6.24e-01
   2.11e-01  4.55e-02  7.21e-03 -1.97e-01 -1.08e+00 -2.07e-03  2.82e-01  7.71e-01
  -3.41e-02]]
SymNet parameters
[-2.11]
finally, finish this stage
iter:     0    time: 35.81
Func: 1.89e+00  |g|: 7.29e+02
stableloss: 7.53e-02   dataloss: 1.82e+00   sparseloss: 1.77e+02 momentloss: 7.74e+00
current expression:
[u00*u01, u10*v00, u20, u02, u00*u01**2, u00, u10*v00*v10, u00*u11*v00, u01*u10*v00, u00*v00, u01**2, 1, u00**3, u01*u10, v00, u10*v01, u20*v00**2, v00**2, u01, u10*v00*v01]
[-0.98 -0.98  0.05  0.05  0.01  0.01  0.01  0.01  0.01 -0.    0.    0.   -0.    0.
 -0.    0.    0.   -0.   -0.    0.  ]
[v00*v10, u00*v01, v02, v20, v00*v10**2, u00*v01*v10, u00*u01*v01, u00*v00*v11, v01*v10, u10*v00*v01, v00, u01*v01, 1, u01, v10**2, u10*v01, v01, v00**3, u00*v00, v00*v01]
[-0.98 -0.97  0.05  0.05  0.01  0.01  0.01  0.01  0.01  0.01  0.01  0.    0.    0.
  0.    0.   -0.   -0.    0.   -0.  ]
u_obs.abs().max()
tensor(3.8486, device='cuda:0', dtype=torch.float64)
model(u_obs[0],T=50*dt).abs().max()
tensor(nan, device='cuda:0', dtype=torch.float64)
model(u_obs[0],T=100*dt).abs().max()
tensor(nan, device='cuda:0', dtype=torch.float64)
--name=burgers-2-upwind-sparse0-noise0.001-id8 --kernel_size=5 --viscosity=0.05 --blocks=0-6,9 --dataname=burgers --constraint=2 --device=cuda:0 --stablize=0 --sparsity=0 --momentsparsity=0.001 --data_start_time=1 --dt=1e-2 --max_dt=1/1600 --hidden_layers=5 --start_noise=0.001 --end_noise=0.001 --scheme=upwind
0
--name=burgers-2-upwind-sparse0-noise0.001-id9 --kernel_size=5 --viscosity=0.05 --blocks=0-6,9 --dataname=burgers --constraint=2 --device=cuda:1 --stablize=0 --sparsity=0 --momentsparsity=0.001 --data_start_time=1 --dt=1e-2 --max_dt=1/1600 --hidden_layers=5 --start_noise=0.001 --end_noise=0.001 --scheme=upwind
1
--name=burgers-2-upwind-sparse0-noise0.001-id10 --kernel_size=5 --viscosity=0.05 --blocks=0-6,9 --dataname=burgers --constraint=2 --device=cuda:2 --stablize=0 --sparsity=0 --momentsparsity=0.001 --data_start_time=1 --dt=1e-2 --max_dt=1/1600 --hidden_layers=5 --start_noise=0.001 --end_noise=0.001 --scheme=upwind
2
--name=burgers-2-upwind-sparse0-noise0.001-id11 --kernel_size=5 --viscosity=0.05 --blocks=0-6,9 --dataname=burgers --constraint=2 --device=cuda:3 --stablize=0 --sparsity=0 --momentsparsity=0.001 --data_start_time=1 --dt=1e-2 --max_dt=1/1600 --hidden_layers=5 --start_noise=0.001 --end_noise=0.001 --scheme=upwind
3
wait
{'--name': 'burgers-2-upwind-sparse0-noise0.001-id11', '--dtype': 'double', '--device': 'cuda:3', '--constraint': '2', '--dt': 0.01, '--cell_num': 1, '--eps': 6.283185307179586, '--blocks': [0, 1, 2, 3, 4, 5, 6, 9], '--kernel_size': 5, '--max_order': 2, '--dx': 0.19634954084936207, '--hidden_layers': 5, '--scheme': 'upwind', '--dataname': 'burgers', '--viscosity': 0.05, '--zoom': 4, '--max_dt': 0.000625, '--batch_size': 28, '--data_timescheme': 'rk2', '--channel_names': 'u,v', '--freq': 4, '--data_start_time': 1.0, '--start_noise': 0.001, '--end_noise': 0.001, '--stablize': 0.0, '--sparsity': 0.0, '--momentsparsity': 0.001, '--npseed': -1, '--torchseed': -1, '--maxiter': 2000, '--recordfile': 'None', '--recordcycle': 200, '--savecycle': -1, '--start_from': -1}
Traceback (most recent call last):
  File "train.py", line 58, in <module>
    globalnames, callback, model, data_model, sampling, addnoise = setenv.setenv(options)
  File "/data/users2/sajad/code/PDE-Net/setenv.py", line 68, in setenv
    globalnames, callback, model = _set_model(options)
  File "/data/users2/sajad/code/PDE-Net/setenv.py", line 45, in _set_model
    model.to(globalnames['device'])
  File "/home/users/mabavisani/anaconda3/envs/PDE-Net-2/lib/python3.7/site-packages/torch/nn/modules/module.py", line 386, in to
    return self._apply(convert)
  File "/home/users/mabavisani/anaconda3/envs/PDE-Net-2/lib/python3.7/site-packages/torch/nn/modules/module.py", line 193, in _apply
    module._apply(fn)
  File "/home/users/mabavisani/anaconda3/envs/PDE-Net-2/lib/python3.7/site-packages/torch/nn/modules/module.py", line 193, in _apply
    module._apply(fn)
  File "/home/users/mabavisani/anaconda3/envs/PDE-Net-2/lib/python3.7/site-packages/torch/nn/modules/module.py", line 205, in _apply
    self._buffers[key] = fn(buf)
  File "/home/users/mabavisani/anaconda3/envs/PDE-Net-2/lib/python3.7/site-packages/torch/nn/modules/module.py", line 384, in convert
    return t.to(device, dtype if t.is_floating_point() else None, non_blocking)
RuntimeError: CUDA error: invalid device ordinal
{'--name': 'burgers-2-upwind-sparse0-noise0.001-id8', '--dtype': 'double', '--device': 'cuda:0', '--constraint': '2', '--dt': 0.01, '--cell_num': 1, '--eps': 6.283185307179586, '--blocks': [0, 1, 2, 3, 4, 5, 6, 9], '--kernel_size': 5, '--max_order': 2, '--dx': 0.19634954084936207, '--hidden_layers': 5, '--scheme': 'upwind', '--dataname': 'burgers', '--viscosity': 0.05, '--zoom': 4, '--max_dt': 0.000625, '--batch_size': 28, '--data_timescheme': 'rk2', '--channel_names': 'u,v', '--freq': 4, '--data_start_time': 1.0, '--start_noise': 0.001, '--end_noise': 0.001, '--stablize': 0.0, '--sparsity': 0.0, '--momentsparsity': 0.001, '--npseed': -1, '--torchseed': -1, '--maxiter': 2000, '--recordfile': 'None', '--recordcycle': 200, '--savecycle': -1, '--start_from': -1}
block:  0
name:  burgers-2-upwind-sparse0-noise0.001-id8
device:  cuda:0
generate a random number to check random seed:  -1.2678560070625868
current stage is: warmup
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.7553, device='cuda:0', dtype=torch.float64)
u_obs variance
tensor([ 0.2716,  2.1241,  2.0102, 19.7535,  9.7062, 17.1929,  0.2615,  1.8886,
         2.1006, 16.0708,  9.3426, 19.3869], device='cuda:0',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
iter:     0    time: 6.63
Func: 6.90e+00  |g|: 8.71e+00
stableloss: 1.10e-01   dataloss: 6.90e+00   sparseloss: 2.81e+01 momentloss: 7.27e+00
iter:   200    time: 13.97
Func: 3.69e-02  |g|: 4.40e-02
stableloss: 1.20e-02   dataloss: 3.69e-02   sparseloss: 5.44e+01 momentloss: 7.27e+00
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 0.035822
         Iterations: 265
         Function evaluations: 342
         Gradient evaluations: 338
convolution moment and kernels
[[1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
[[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 1. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
[[ 0.    1.    0.   -0.33 -0.25]
 [ 0.    0.    0.    0.    0.  ]
 [ 0.    0.    0.    0.    0.  ]
 [ 0.    0.    0.    0.    0.  ]
 [ 0.    0.    0.    0.    0.  ]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]
 [ 2.78e-17  3.33e-16 -1.50e+00  2.00e+00 -5.00e-01]
 [ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]]
[[ 0.    0.    0.    0.    0.  ]
 [ 1.    0.    0.    0.    0.  ]
 [ 0.    0.    0.    0.    0.  ]
 [-0.33  0.    0.    0.    0.  ]
 [-0.25  0.    0.    0.    0.  ]]
[[ 0.00e+00  0.00e+00  2.78e-17  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  3.33e-16  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00 -1.50e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  2.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00 -5.00e-01  0.00e+00  0.00e+00]]
[[0.   0.   1.   0.   0.08]
 [0.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.  ]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]
 [-2.22e-16  1.00e+00 -2.00e+00  1.00e+00 -1.53e-16]
 [ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]]
[[0. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
[[ 6.94e-03 -5.56e-02  9.25e-18  5.56e-02 -6.94e-03]
 [-5.56e-02  4.44e-01 -7.40e-17 -4.44e-01  5.56e-02]
 [ 9.25e-18 -7.40e-17  1.23e-32  7.40e-17 -9.25e-18]
 [ 5.56e-02 -4.44e-01  7.40e-17  4.44e-01 -5.56e-02]
 [-6.94e-03  5.56e-02 -9.25e-18 -5.56e-02  6.94e-03]]
[[0.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.  ]
 [1.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.  ]
 [0.08 0.   0.   0.   0.  ]]
[[ 0.00e+00  0.00e+00 -2.22e-16  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  1.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00 -2.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  1.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00 -1.53e-16  0.00e+00  0.00e+00]]
SymNet parameters
[[-0.71 -0.03 -0.11  0.43  0.02 -0.08  0.03 -0.06  0.05  0.17 -0.06  0.04]
 [ 0.16 -1.    0.53 -0.21  0.19  0.09 -0.64 -0.04  0.05  0.04 -0.07  0.02]]
SymNet parameters
[-0.19 -0.26]
SymNet parameters
[[-1.06e+00 -8.99e-02  2.58e-01 -1.64e-01 -2.31e-01 -4.25e-02 -4.30e-01  2.17e-01
  -2.68e-02 -2.67e-03  7.30e-03 -1.93e-02 -1.99e-02]
 [-5.77e-02 -7.15e-03 -1.07e-02 -6.72e-03  4.95e-03 -1.47e-03  2.82e-02 -1.23e-02
   4.39e-03  9.82e-04 -2.26e-03 -2.45e-04 -1.93e-03]]
SymNet parameters
[ 0.05 -0.12]
SymNet parameters
[[ 9.09e-01  4.26e-02  1.27e-01 -1.29e-02 -6.60e-03  2.74e-03  2.09e-02 -1.37e-03
  -4.40e-03 -8.88e-03  3.68e-03 -3.93e-03  6.57e-03  7.26e-02]
 [ 2.44e-01 -6.79e-01  6.20e-02  1.84e-01 -9.88e-02 -6.79e-02  1.68e-01 -4.44e-03
  -2.17e-02 -1.16e-04  3.18e-02 -7.61e-03 -1.25e-03 -2.75e-01]]
SymNet parameters
[-0.7   0.23]
SymNet parameters
[[ 3.56e-01 -4.54e-01  1.20e+00  4.96e-02  4.96e-02  6.94e-03  2.89e-01 -2.69e-02
   3.01e-02  4.57e-02 -2.77e-02  1.33e-02  8.70e-04 -3.67e-01  4.09e-02]
 [ 1.32e-01 -1.73e-01 -1.78e-01  2.90e-02  4.19e-02  6.41e-03 -9.17e-01 -1.21e-02
   1.81e-02  3.33e-02 -1.92e-02  1.13e-02 -8.60e-04 -2.06e-01  1.77e-02]]
SymNet parameters
[0.24 0.81]
SymNet parameters
[[ 2.98e-01  6.24e-01  4.54e-01  1.29e-01 -9.04e-02 -5.20e-02 -4.17e-01  9.98e-03
  -1.70e-02 -1.53e-03  1.93e-02 -5.60e-03  1.26e-03  3.81e-01  2.27e-02  5.30e-03]
 [ 9.32e-01  3.86e-02 -4.28e-01  1.26e-01 -2.40e-02 -3.36e-02  6.01e-01 -5.18e-03
   7.31e-04  3.21e-02 -3.32e-03  6.20e-03 -1.86e-03 -1.28e-01  2.85e-02  7.07e-03]]
SymNet parameters
[0.26 0.11]
SymNet parameters
[[ 0.01 -0.04 -0.56  0.13 -0.09 -0.01  0.14  0.01 -0.03 -0.03  0.03 -0.01 -0.11 -0.02
   0.67  0.56 -0.55]]
SymNet parameters
[0.03]
SymNet parameters
[[-5.53e-01 -3.85e-01  6.73e-01 -1.06e-01 -1.53e-01  1.29e-02  9.37e-01 -3.29e-02
  -1.39e-01 -1.95e-01  7.54e-01  6.03e-01]
 [-7.13e-03 -2.01e-03  9.33e-04 -4.97e-04  5.73e-04  2.39e-04  1.22e-02 -1.29e-03
   4.95e-04  5.78e-04 -1.21e-03  1.18e-03]]
SymNet parameters
[-0.01  0.17]
SymNet parameters
[[ 0.2   0.03 -0.04  0.01  0.02  0.    0.04  0.02  0.05  0.02 -0.06 -0.04  0.32]
 [ 0.11  0.37 -0.18 -0.1   0.13  0.07  0.03  0.12 -1.04 -0.49 -0.8   0.45  0.45]]
SymNet parameters
[-0.14 -0.21]
SymNet parameters
[[-1.13 -0.02  0.03 -0.   -0.   -0.    0.59 -0.03 -0.08 -0.    0.03  0.02 -0.21  0.02]
 [ 0.02  0.34 -0.26  0.04 -0.03  0.04  1.17  1.55 -0.69 -0.    0.03  0.06  0.11 -0.16]]
SymNet parameters
[ 0.64 -0.75]
SymNet parameters
[[-1.06e+00  5.61e-02 -8.41e-02  1.32e-02  1.65e-02 -9.96e-04 -4.21e-01  2.03e-02
   9.90e-02  1.62e-02 -8.54e-02 -6.33e-02  6.52e-01  4.14e-03  8.26e-03]
 [-1.14e-01  3.98e-01 -2.74e-01  4.55e-02 -4.64e-02  5.34e-02  7.31e-01 -7.23e-01
  -4.88e-01 -2.79e-02  7.96e-02  1.33e-01 -2.27e-01 -1.51e-01 -1.43e-02]]
SymNet parameters
[ 0.06 -0.06]
SymNet parameters
[[-2.64e-01  4.22e-02 -1.67e-02  1.58e-03 -8.51e-03  1.12e-02 -1.60e+00  6.44e-02
  -8.91e-02 -7.11e-03  2.55e-02  3.38e-02 -1.49e-01 -1.35e-02 -1.38e-02  1.00e-02]
 [-2.57e-01  1.69e-01 -1.52e-01  2.54e-02  1.20e-03  1.76e-02  2.87e-01  2.60e-01
   8.22e-01  1.31e-02 -5.56e-02 -2.08e-02  5.19e-01  1.69e-02 -2.94e-03  3.01e-03]]
SymNet parameters
[-0.07 -0.21]
SymNet parameters
[[-0.34 -0.07  0.07 -0.01 -0.01 -0.01 -0.19 -0.34  0.13  0.03  0.03  0.05 -0.25  0.
   0.33 -0.33  0.49]]
SymNet parameters
[0.16]
finally, finish this stage
iter:   265    time: 5.50
Func: 3.58e-02  |g|: 3.55e-02
stableloss: 1.21e-02   dataloss: 3.58e-02   sparseloss: 5.88e+01 momentloss: 7.27e+00
current expression:
[u00*u01, u10*v00, u02, u00, u20, u00**3, u00**2, u00*u01**2, u00**2*u02, u00*u01*v00, v00, u00*v00, u00*u11*v00, u10, u01*u10*v00, u00*v00*v01, 1, v00*v10, u11, u01*v00]
[-0.89 -0.89  0.04  0.04  0.04 -0.03 -0.02  0.01 -0.01  0.01 -0.01 -0.01  0.01 -0.01
  0.   -0.    0.   -0.   -0.   -0.  ]
[v00*v10, u00*v01, v20, v02, v00, u00, v00**3, u00*v00**2, v00**2*v20, u00*v00*v11, u00*v01*v10, 1, u00*v00*v10, v00**2*v10, v00*v10**2, u00*v00, u10*v00, u00*u01*v01, v00**2*v02, u00*v20]
[-0.89 -0.89  0.04  0.03  0.03 -0.01 -0.01  0.01 -0.01  0.01  0.01  0.01  0.01  0.01
  0.    0.   -0.    0.    0.    0.  ]
block:  1
name:  burgers-2-upwind-sparse0-noise0.001-id8
device:  cuda:0
generate a random number to check random seed:  1.352302071309527
current stage is: block-1
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.8417, device='cuda:0', dtype=torch.float64)
u_obs variance
tensor([ 0.2551,  2.0634,  1.9021, 19.0091, 10.1534, 16.1228,  0.2410,  1.9133,
         1.9630, 16.9294,  9.4340, 18.0962], device='cuda:0',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
iter:     0    time: 1115.58
Func: 5.60e-02  |g|: 1.78e+00
stableloss: 1.05e-02   dataloss: 4.87e-02   sparseloss: 5.88e+01 momentloss: 7.27e+00
iter:   200    time: 9.81
Func: 2.23e-02  |g|: 8.40e-02
stableloss: 7.02e-03   dataloss: 1.57e-02   sparseloss: 5.99e+01 momentloss: 6.60e+00
iter:   400    time: 9.85
Func: 2.12e-02  |g|: 4.68e-02
stableloss: 6.95e-03   dataloss: 1.46e-02   sparseloss: 7.25e+01 momentloss: 6.58e+00
iter:   600    time: 9.80
Func: 2.08e-02  |g|: 2.91e-02
stableloss: 6.90e-03   dataloss: 1.43e-02   sparseloss: 8.33e+01 momentloss: 6.54e+00
iter:   800    time: 9.80
Func: 2.05e-02  |g|: 1.41e-02
stableloss: 6.69e-03   dataloss: 1.40e-02   sparseloss: 8.41e+01 momentloss: 6.53e+00
iter:  1000    time: 9.80
Func: 2.04e-02  |g|: 1.49e-02
stableloss: 6.68e-03   dataloss: 1.39e-02   sparseloss: 8.88e+01 momentloss: 6.53e+00
iter:  1200    time: 9.81
Func: 2.04e-02  |g|: 1.23e-02
stableloss: 6.72e-03   dataloss: 1.39e-02   sparseloss: 8.92e+01 momentloss: 6.53e+00
iter:  1400    time: 9.92
Func: 2.04e-02  |g|: 1.17e-02
stableloss: 6.73e-03   dataloss: 1.38e-02   sparseloss: 9.26e+01 momentloss: 6.54e+00
iter:  1600    time: 9.85
Func: 2.03e-02  |g|: 4.35e-03
stableloss: 6.75e-03   dataloss: 1.38e-02   sparseloss: 9.37e+01 momentloss: 6.54e+00
iter:  1800    time: 9.78
Func: 2.03e-02  |g|: 2.01e-03
stableloss: 6.73e-03   dataloss: 1.38e-02   sparseloss: 9.36e+01 momentloss: 6.54e+00
Warning: Maximum number of iterations has been exceeded.
         Current function value: 0.020324
         Iterations: 2000
         Function evaluations: 2004
         Gradient evaluations: 2004
convolution moment and kernels
[[ 1.00e+00  0.00e+00  1.44e-04 -3.82e-02 -4.26e-02]
 [ 0.00e+00  3.02e-05  2.22e-03  1.27e-03  9.47e-04]
 [ 8.99e-05  6.54e-04  2.38e-03 -1.33e-03  1.78e-03]
 [-3.33e-03 -5.70e-04  1.75e-03 -3.68e-04 -9.75e-03]
 [-7.08e-02  4.64e-03 -4.10e-03  3.12e-03  8.78e-03]]
[[ 0.01 -0.06  0.02 -0.06  0.02]
 [-0.04  0.2  -0.03  0.2  -0.05]
 [ 0.02 -0.1   0.68 -0.03 -0.  ]
 [-0.02  0.11  0.1   0.12 -0.03]
 [ 0.   -0.02 -0.04 -0.02  0.01]]
[[ 0.00e+00  1.00e+00  0.00e+00 -1.15e-01 -6.06e-02]
 [ 0.00e+00  0.00e+00  2.02e-03  4.27e-04 -3.53e-04]
 [ 0.00e+00  2.75e-02  8.56e-04  1.28e-02 -2.89e-03]
 [-1.21e-03  3.12e-03 -3.84e-03 -1.14e-03 -3.86e-03]
 [ 1.26e-02 -5.28e-03 -6.94e-04 -8.92e-03  7.54e-04]]
[[ 0.01 -0.01  0.03 -0.01 -0.  ]
 [-0.03  0.05 -0.11  0.03  0.01]
 [ 0.13 -0.61 -0.2   0.99 -0.22]
 [-0.03  0.04 -0.09  0.01  0.02]
 [ 0.   -0.01  0.01  0.01 -0.01]]
[[ 0.00e+00  0.00e+00  0.00e+00 -3.61e-03  8.13e-03]
 [ 1.00e+00  0.00e+00  1.98e-02  6.04e-04 -7.57e-03]
 [ 0.00e+00  3.76e-04  7.78e-03 -3.39e-03 -1.69e-03]
 [-1.03e-01 -2.06e-03  8.12e-03  2.03e-03 -1.07e-02]
 [-5.80e-02  7.28e-03 -6.16e-03  1.29e-03 -3.51e-03]]
[[ 0.   -0.02  0.11 -0.01  0.  ]
 [ 0.01  0.03 -0.58  0.    0.  ]
 [-0.01 -0.06 -0.26 -0.02 -0.  ]
 [ 0.02 -0.01  1.01 -0.02  0.01]
 [-0.01  0.02 -0.23  0.03 -0.01]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00  3.10e-03]
 [ 0.00e+00  0.00e+00  0.00e+00  6.43e-04 -3.38e-03]
 [ 0.00e+00  0.00e+00  1.16e-03 -1.43e-03  5.90e-04]
 [ 0.00e+00 -8.41e-04 -1.94e-03  5.46e-04  1.83e-03]
 [ 5.22e-03 -1.80e-03 -5.01e-04  2.95e-03 -4.75e-03]]
[[-7.57e-03  2.83e-02 -3.17e-02  2.07e-02 -4.49e-03]
 [ 3.11e-02 -1.11e-01  1.18e-01 -7.55e-02  1.64e-02]
 [-1.21e-01  1.46e+00 -2.62e+00  1.40e+00 -9.82e-02]
 [ 2.28e-02 -7.47e-02  5.96e-02 -3.63e-02  7.67e-03]
 [-5.30e-03  1.71e-02 -1.25e-02  7.55e-03 -1.64e-03]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  5.59e-04]
 [ 0.00e+00  1.00e+00  0.00e+00 -1.84e-03 -4.86e-03]
 [ 0.00e+00  0.00e+00  7.02e-04  1.57e-03 -1.60e-03]
 [ 0.00e+00 -1.89e-03 -2.22e-03  3.07e-03  5.63e-03]
 [ 6.41e-04  6.21e-03 -1.12e-03 -4.44e-03  1.86e-03]]
[[ 9.45e-03 -6.18e-02 -6.52e-03  7.14e-02 -1.19e-02]
 [-7.08e-02  4.94e-01 -1.49e-02 -4.79e-01  6.89e-02]
 [ 3.48e-02 -1.30e-01  1.19e-01 -1.88e-02 -1.96e-03]
 [ 2.68e-02 -3.30e-01 -1.32e-01  4.98e-01 -6.49e-02]
 [ 3.44e-04  2.52e-02  3.77e-02 -7.31e-02  1.05e-02]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  6.28e-03]
 [ 0.00e+00  0.00e+00  0.00e+00  7.56e-04 -3.18e-03]
 [ 1.00e+00  0.00e+00  1.98e-03 -1.32e-03 -1.56e-03]
 [ 0.00e+00 -1.89e-05 -1.72e-03 -3.36e-04  1.71e-03]
 [ 9.07e-05 -1.43e-03 -1.07e-03  2.54e-03 -1.60e-03]]
[[-4.12e-03  1.37e-02 -9.79e-02  6.05e-03 -1.00e-03]
 [ 1.46e-02 -4.23e-02  1.37e+00 -9.20e-03  8.77e-04]
 [-8.49e-03  6.92e-03 -2.47e+00 -4.16e-02  1.15e-02]
 [ 5.82e-03 -5.46e-03  1.31e+00  2.44e-02 -6.23e-03]
 [-1.51e-03  2.01e-03 -8.01e-02 -4.75e-03  1.15e-03]]
SymNet parameters
[[-2.51e+00  1.14e-01  4.80e-01  1.01e-01 -4.49e-02  2.11e-02  1.21e+00  4.34e-02
  -4.48e-01  6.49e-03  2.80e-02 -4.40e-02]
 [ 6.18e-02 -3.02e-01  3.62e+00 -1.63e-03  1.87e-01 -2.88e-01 -1.65e-01  5.34e-02
  -1.76e-01 -1.63e-02 -8.60e-03  4.87e-02]]
SymNet parameters
[-0.09 -0.14]
SymNet parameters
[[ 3.03e-01 -4.78e-02  4.22e+00 -3.62e-01 -1.03e-01 -6.20e-02 -1.78e+00  1.68e-01
  -5.31e-02 -5.10e-03 -2.91e-02  1.90e-02  2.93e-02]
 [ 3.22e-03  2.44e-04 -1.34e-03 -1.01e-03  2.80e-04  1.93e-04  3.76e-02 -2.09e-03
  -1.99e-04 -6.78e-06 -9.97e-05  6.81e-05  1.09e-05]]
SymNet parameters
[ 0.1  -0.24]
SymNet parameters
[[ 1.83e+00  9.52e-02 -1.10e-01  3.50e-02 -2.84e-03 -6.46e-03 -1.83e-01 -1.00e-02
  -6.67e-03 -5.44e-04  3.40e-03 -3.62e-04 -3.94e-04 -5.72e-02]
 [-9.66e-02 -4.90e-01 -3.50e-02  1.18e-01 -1.05e-02 -9.12e-03  7.72e-01 -6.59e-02
   2.88e-03  1.73e-03  8.42e-03 -6.86e-03 -1.37e-03 -3.74e-01]]
SymNet parameters
[0.39 0.48]
SymNet parameters
[[ 4.00e-02  3.55e-02  1.56e+00 -4.36e-02  3.67e-02  2.47e-02 -4.59e-01  4.90e-02
  -3.05e-03 -2.15e-04 -1.63e-03  2.61e-03  1.38e-02  1.57e-02 -4.04e-03]
 [-4.21e-01 -4.44e-03  1.04e-01  9.83e-03 -5.57e-03 -2.28e-03 -1.50e+00 -3.75e-02
  -1.11e-02  7.80e-04  2.53e-05 -6.25e-04  4.06e-05  3.13e-02  4.03e-03]]
SymNet parameters
[-0.11  0.94]
SymNet parameters
[[-1.34e-01  1.20e+00  1.55e+00  1.59e-01 -9.01e-02 -7.06e-02  1.38e+00 -1.14e-01
  -1.68e-02  1.00e-03  9.43e-03 -8.57e-03  2.08e-03  1.14e+00 -5.37e-04  9.20e-02]
 [ 1.67e+00 -9.86e-02  1.90e-01  5.79e-03 -6.60e-03 -4.00e-03  4.25e-01 -1.67e-02
   3.70e-03 -4.01e-04  5.75e-04 -1.13e-03  2.83e-05  7.66e-02  5.46e-02  2.68e-02]]
SymNet parameters
[0.88 0.54]
SymNet parameters
[[-2.98e-01  2.10e-01 -1.37e+00  1.50e-01  1.32e-02  5.48e-02  7.25e-01 -6.30e-02
   1.45e-02  1.17e-03  6.31e-03 -5.14e-03 -1.49e-02 -1.01e+00  5.70e-01  2.67e-01
  -2.16e-01]]
SymNet parameters
[-0.01]
SymNet parameters
[[ 1.18e+00  5.66e-01 -9.27e-01  1.70e-01  1.96e-01 -1.58e-01 -1.15e+00 -2.09e+00
  -2.68e-01  5.46e-01  2.11e+00  1.11e+00]
 [-4.14e-03 -1.59e-04 -4.18e-05  5.28e-05 -7.47e-06  9.55e-06 -2.65e-04 -4.38e-04
   1.88e-04 -4.70e-05  3.14e-05  7.86e-05]]
SymNet parameters
[-0.07  0.06]
SymNet parameters
[[ 2.57e-01  9.36e-03 -3.38e-01  3.52e-02  4.03e-02 -4.34e-02 -3.18e-01 -4.29e-01
   2.20e-01  7.45e-02  1.29e-01  2.15e-01 -9.79e-01]
 [ 2.95e+00  2.88e-01  8.25e-01 -7.57e-02  1.07e-02  2.27e-03  2.19e-01  1.59e+00
  -1.47e+00 -6.49e-02 -2.96e-01  3.70e-01  1.16e-01]]
SymNet parameters
[-0.3  -0.25]
SymNet parameters
[[-1.15e+00 -4.11e-02 -7.20e-02  8.69e-03  6.24e-03 -8.51e-03 -4.79e-01 -2.46e-01
   3.27e-01  2.03e-02  8.31e-02  4.71e-02 -3.91e-01  2.05e-03]
 [-4.36e-02  3.57e-02  8.23e-02 -1.05e-02 -8.61e-03  1.03e-02 -2.04e-02  2.61e+00
  -4.84e-02 -2.54e-02 -1.03e-01 -5.96e-02  3.41e-01 -7.75e-03]]
SymNet parameters
[ 0.63 -1.04]
SymNet parameters
[[-1.81e-01  4.91e-02 -5.94e-03  3.79e-03  6.41e-03 -5.88e-03 -2.11e+00 -1.06e+00
   1.97e-01  1.81e-02  6.09e-02  2.38e-02 -4.56e-01 -6.90e-04  1.53e-02]
 [-8.71e-02  2.60e-01  1.10e-01 -5.09e-03  1.01e-02  4.57e-03  6.03e-01  6.32e-01
  -1.74e+00  1.92e-02  5.15e-02  7.61e-03 -1.20e+00 -1.89e-02  1.94e-02]]
SymNet parameters
[0.43 0.01]
SymNet parameters
[[ 4.10e-01  5.73e-02  5.41e-02 -2.78e-03 -3.81e-03  1.13e-02 -2.01e+00  5.67e-01
  -4.26e-01 -1.00e-02 -3.67e-02 -1.94e-02 -1.94e-02  4.19e-03 -5.55e-02  2.23e-02]
 [ 1.27e-02  7.27e-02  1.18e-01 -1.45e-02 -9.94e-03  1.48e-02  3.78e-01  2.17e-01
   3.43e-01 -3.21e-02 -1.33e-01 -7.49e-02  6.49e-01  5.25e-03  2.80e-04 -2.62e-04]]
SymNet parameters
[ 0.31 -0.31]
SymNet parameters
[[-4.65e-01 -5.33e-02  4.01e-02 -9.26e-03 -1.27e-02  9.62e-03 -2.99e-01 -3.63e-01
  -8.38e-02  2.08e-02 -1.19e-01 -1.45e-02  1.02e+00 -1.25e-04  3.30e-01 -1.74e-01
   3.93e-01]]
SymNet parameters
[0.26]
finally, finish this stage
iter:  2000    time: 10.03
Func: 2.03e-02  |g|: 3.94e-03
stableloss: 6.74e-03   dataloss: 1.38e-02   sparseloss: 9.32e+01 momentloss: 6.54e+00
current expression:
[u10*v00, u00*u01, u20, u02, u00*u01**2, u00*u10*v01, u10*v00*v10, u00*u11*v00, u01*u10*v00, 1, u00*u10, u10*v01, u00, v00, u20*v00**2, v00**2, u01, v10, u00*v00*v10, u01**2]
[-0.98 -0.97  0.05  0.05  0.01  0.01  0.01  0.01  0.01 -0.01  0.    0.    0.    0.
  0.    0.   -0.   -0.   -0.    0.  ]
[v00*v10, u00*v01, v02, v20, v00, v00*v10**2, u00*v01*v10, u00, u00*v00*v11, u00*u01*v01, u10*v00*v01, v00**3, u10*v00*v10, v00**2*v01, v00**2*v10, v01, u01*v01, u00**2*v00, u00*u10*v01, u00*v10]
[-0.98 -0.97  0.05  0.05  0.02  0.01  0.01 -0.01  0.01  0.01  0.01 -0.   -0.   -0.
  0.    0.    0.   -0.    0.    0.  ]
block:  2
name:  burgers-2-upwind-sparse0-noise0.001-id8
device:  cuda:0
generate a random number to check random seed:  -1.138896186254358
current stage is: block-2
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.8817, device='cuda:0', dtype=torch.float64)
u_obs variance
tensor([ 0.2451,  1.6795,  1.6103, 21.8424,  9.9388, 18.9402,  0.2557,  1.6670,
         1.8335, 19.5034, 10.1676, 23.5130], device='cuda:0',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 0.061519
         Iterations: 0
         Function evaluations: 15
         Gradient evaluations: 3
convolution moment and kernels
[[ 1.00e+00  0.00e+00  1.44e-04 -3.82e-02 -4.26e-02]
 [ 0.00e+00  3.06e-05  2.23e-03  1.27e-03  9.50e-04]
 [ 8.19e-05  6.61e-04  2.38e-03 -1.34e-03  1.79e-03]
 [-3.31e-03 -5.69e-04  1.74e-03 -3.68e-04 -9.75e-03]
 [-7.08e-02  4.63e-03 -4.09e-03  3.13e-03  8.76e-03]]
[[ 0.01 -0.06  0.02 -0.06  0.02]
 [-0.04  0.2  -0.03  0.2  -0.05]
 [ 0.02 -0.1   0.68 -0.03 -0.  ]
 [-0.02  0.11  0.1   0.12 -0.03]
 [ 0.   -0.02 -0.04 -0.02  0.01]]
[[ 0.00e+00  1.00e+00  0.00e+00 -1.15e-01 -6.06e-02]
 [ 0.00e+00  0.00e+00  2.02e-03  4.24e-04 -3.38e-04]
 [ 0.00e+00  2.75e-02  8.51e-04  1.28e-02 -2.87e-03]
 [-1.18e-03  3.12e-03 -3.84e-03 -1.14e-03 -3.87e-03]
 [ 1.26e-02 -5.30e-03 -6.78e-04 -8.91e-03  7.12e-04]]
[[ 0.01 -0.01  0.03 -0.01 -0.  ]
 [-0.03  0.05 -0.11  0.03  0.01]
 [ 0.13 -0.61 -0.2   0.99 -0.22]
 [-0.03  0.04 -0.09  0.01  0.02]
 [ 0.   -0.01  0.01  0.01 -0.01]]
[[ 0.00e+00  0.00e+00  0.00e+00 -3.59e-03  8.10e-03]
 [ 1.00e+00  0.00e+00  1.98e-02  6.06e-04 -7.57e-03]
 [ 0.00e+00  3.89e-04  7.78e-03 -3.40e-03 -1.67e-03]
 [-1.04e-01 -2.05e-03  8.13e-03  2.03e-03 -1.07e-02]
 [-5.80e-02  7.27e-03 -6.16e-03  1.31e-03 -3.53e-03]]
[[ 0.   -0.02  0.11 -0.01  0.  ]
 [ 0.01  0.03 -0.58  0.    0.  ]
 [-0.01 -0.06 -0.26 -0.02 -0.  ]
 [ 0.02 -0.01  1.01 -0.02  0.01]
 [-0.01  0.03 -0.23  0.03 -0.01]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00  3.09e-03]
 [ 0.00e+00  0.00e+00  0.00e+00  6.43e-04 -3.37e-03]
 [ 0.00e+00  0.00e+00  1.16e-03 -1.43e-03  5.95e-04]
 [ 0.00e+00 -8.41e-04 -1.94e-03  5.46e-04  1.83e-03]
 [ 5.22e-03 -1.80e-03 -4.97e-04  2.95e-03 -4.76e-03]]
[[-7.58e-03  2.83e-02 -3.18e-02  2.08e-02 -4.50e-03]
 [ 3.11e-02 -1.11e-01  1.19e-01 -7.57e-02  1.65e-02]
 [-1.21e-01  1.46e+00 -2.62e+00  1.40e+00 -9.83e-02]
 [ 2.29e-02 -7.49e-02  6.00e-02 -3.65e-02  7.71e-03]
 [-5.32e-03  1.71e-02 -1.26e-02  7.60e-03 -1.65e-03]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  5.59e-04]
 [ 0.00e+00  1.00e+00  0.00e+00 -1.84e-03 -4.85e-03]
 [ 0.00e+00  0.00e+00  7.02e-04  1.57e-03 -1.60e-03]
 [ 0.00e+00 -1.89e-03 -2.22e-03  3.07e-03  5.63e-03]
 [ 6.39e-04  6.21e-03 -1.12e-03 -4.44e-03  1.86e-03]]
[[ 9.45e-03 -6.18e-02 -6.53e-03  7.14e-02 -1.19e-02]
 [-7.08e-02  4.94e-01 -1.48e-02 -4.79e-01  6.89e-02]
 [ 3.48e-02 -1.30e-01  1.19e-01 -1.88e-02 -1.96e-03]
 [ 2.68e-02 -3.30e-01 -1.32e-01  4.98e-01 -6.49e-02]
 [ 3.43e-04  2.52e-02  3.77e-02 -7.31e-02  1.05e-02]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  6.28e-03]
 [ 0.00e+00  0.00e+00  0.00e+00  7.56e-04 -3.18e-03]
 [ 1.00e+00  0.00e+00  1.97e-03 -1.32e-03 -1.55e-03]
 [ 0.00e+00 -1.88e-05 -1.72e-03 -3.36e-04  1.71e-03]
 [ 9.12e-05 -1.43e-03 -1.06e-03  2.55e-03 -1.62e-03]]
[[-4.13e-03  1.38e-02 -9.79e-02  6.09e-03 -1.01e-03]
 [ 1.47e-02 -4.25e-02  1.37e+00 -9.37e-03  9.15e-04]
 [-8.59e-03  7.33e-03 -2.47e+00 -4.13e-02  1.14e-02]
 [ 5.88e-03 -5.72e-03  1.31e+00  2.41e-02 -6.18e-03]
 [-1.53e-03  2.07e-03 -8.02e-02 -4.70e-03  1.14e-03]]
SymNet parameters
[[-2.51e+00  1.14e-01  4.80e-01  1.01e-01 -4.49e-02  2.11e-02  1.21e+00  4.34e-02
  -4.48e-01  6.50e-03  2.80e-02 -4.40e-02]
 [ 6.18e-02 -3.02e-01  3.62e+00 -1.63e-03  1.87e-01 -2.88e-01 -1.65e-01  5.34e-02
  -1.76e-01 -1.63e-02 -8.60e-03  4.87e-02]]
SymNet parameters
[-0.09 -0.14]
SymNet parameters
[[ 3.03e-01 -4.78e-02  4.22e+00 -3.62e-01 -1.03e-01 -6.20e-02 -1.78e+00  1.68e-01
  -5.31e-02 -5.09e-03 -2.91e-02  1.90e-02  2.93e-02]
 [ 3.29e-03  1.90e-04 -1.37e-03 -7.99e-04  2.62e-04  3.34e-04  3.76e-02 -1.91e-03
  -2.77e-04 -7.81e-05 -5.62e-05 -6.25e-04  1.02e-03]]
SymNet parameters
[ 0.1  -0.24]
SymNet parameters
[[ 1.83e+00  9.52e-02 -1.10e-01  3.50e-02 -2.85e-03 -6.47e-03 -1.83e-01 -1.00e-02
  -6.66e-03 -5.19e-04  3.38e-03 -3.94e-04 -3.10e-04 -5.72e-02]
 [-9.66e-02 -4.90e-01 -3.50e-02  1.18e-01 -1.05e-02 -9.11e-03  7.72e-01 -6.59e-02
   2.88e-03  1.71e-03  8.43e-03 -6.78e-03 -1.42e-03 -3.74e-01]]
SymNet parameters
[0.39 0.48]
SymNet parameters
[[ 4.00e-02  3.55e-02  1.56e+00 -4.36e-02  3.67e-02  2.48e-02 -4.59e-01  4.90e-02
  -3.05e-03 -1.70e-04 -1.63e-03  2.66e-03  1.37e-02  1.57e-02 -4.06e-03]
 [-4.21e-01 -4.44e-03  1.04e-01  9.82e-03 -5.57e-03 -2.27e-03 -1.50e+00 -3.75e-02
  -1.11e-02  7.83e-04  2.30e-05 -6.12e-04 -8.75e-05  3.13e-02  4.00e-03]]
SymNet parameters
[-0.11  0.94]
SymNet parameters
[[-1.34e-01  1.20e+00  1.55e+00  1.59e-01 -9.01e-02 -7.06e-02  1.38e+00 -1.14e-01
  -1.68e-02  1.01e-03  9.43e-03 -8.59e-03  2.10e-03  1.14e+00 -5.32e-04  9.20e-02]
 [ 1.67e+00 -9.86e-02  1.90e-01  5.80e-03 -6.61e-03 -4.00e-03  4.25e-01 -1.67e-02
   3.70e-03 -3.61e-04  5.69e-04 -1.08e-03 -8.37e-05  7.66e-02  5.46e-02  2.68e-02]]
SymNet parameters
[0.88 0.54]
SymNet parameters
[[-2.98e-01  2.10e-01 -1.37e+00  1.50e-01  1.32e-02  5.48e-02  7.25e-01 -6.30e-02
   1.45e-02  1.21e-03  6.30e-03 -5.10e-03 -1.47e-02 -1.01e+00  5.70e-01  2.68e-01
  -2.16e-01]]
SymNet parameters
[-0.01]
SymNet parameters
[[ 1.18e+00  5.66e-01 -9.27e-01  1.70e-01  1.95e-01 -1.58e-01 -1.15e+00 -2.09e+00
  -2.68e-01  5.46e-01  2.11e+00  1.11e+00]
 [-4.25e-03  1.21e-05  2.45e-05 -1.30e-03 -2.69e-04 -1.09e-04 -5.48e-05 -8.41e-04
   5.20e-04  1.04e-03 -4.32e-05 -1.23e-03]]
SymNet parameters
[-0.07  0.06]
SymNet parameters
[[ 2.57e-01  9.36e-03 -3.38e-01  3.52e-02  4.03e-02 -4.34e-02 -3.18e-01 -4.29e-01
   2.20e-01  7.45e-02  1.29e-01  2.15e-01 -9.79e-01]
 [ 2.95e+00  2.88e-01  8.25e-01 -7.57e-02  1.07e-02  2.27e-03  2.19e-01  1.59e+00
  -1.47e+00 -6.49e-02 -2.96e-01  3.70e-01  1.16e-01]]
SymNet parameters
[-0.3  -0.25]
SymNet parameters
[[-1.15e+00 -4.11e-02 -7.20e-02  8.71e-03  6.27e-03 -8.48e-03 -4.79e-01 -2.46e-01
   3.27e-01  2.03e-02  8.31e-02  4.71e-02 -3.91e-01  2.01e-03]
 [-4.36e-02  3.57e-02  8.23e-02 -1.05e-02 -8.61e-03  1.03e-02 -2.04e-02  2.61e+00
  -4.84e-02 -2.54e-02 -1.03e-01 -5.96e-02  3.41e-01 -7.68e-03]]
SymNet parameters
[ 0.63 -1.04]
SymNet parameters
[[-1.81e-01  4.91e-02 -5.95e-03  3.79e-03  6.41e-03 -5.86e-03 -2.11e+00 -1.06e+00
   1.97e-01  1.81e-02  6.08e-02  2.39e-02 -4.56e-01 -6.40e-04  1.53e-02]
 [-8.71e-02  2.60e-01  1.10e-01 -5.08e-03  1.01e-02  4.56e-03  6.03e-01  6.32e-01
  -1.74e+00  1.92e-02  5.15e-02  7.60e-03 -1.20e+00 -1.88e-02  1.94e-02]]
SymNet parameters
[0.43 0.01]
SymNet parameters
[[ 4.10e-01  5.73e-02  5.41e-02 -2.78e-03 -3.81e-03  1.13e-02 -2.01e+00  5.67e-01
  -4.26e-01 -1.00e-02 -3.67e-02 -1.94e-02 -1.94e-02  4.24e-03 -5.55e-02  2.23e-02]
 [ 1.27e-02  7.27e-02  1.18e-01 -1.45e-02 -9.95e-03  1.48e-02  3.78e-01  2.17e-01
   3.43e-01 -3.21e-02 -1.33e-01 -7.50e-02  6.49e-01  5.01e-03  1.44e-04  4.38e-05]]
SymNet parameters
[ 0.31 -0.31]
SymNet parameters
[[-4.65e-01 -5.33e-02  4.02e-02 -9.26e-03 -1.27e-02  9.63e-03 -2.99e-01 -3.63e-01
  -8.38e-02  2.08e-02 -1.19e-01 -1.45e-02  1.02e+00 -3.05e-04  3.30e-01 -1.74e-01
   3.93e-01]]
SymNet parameters
[0.26]
finally, finish this stage
iter:     0    time: 493.08
Func: 6.15e-02  |g|: 3.81e+00
stableloss: 1.35e-02   dataloss: 4.84e-02   sparseloss: 9.32e+01 momentloss: 6.54e+00
current expression:
[u10*v00, u00*u01, u20, u02, u00*u01**2, u00*u10*v01, u10*v00*v10, u00*u11*v00, u01*u10*v00, 1, u00*u10, u10*v01, u00, v00, u20*v00**2, v00**2, u01, v10, u00*v00*v10, u01**2]
[-0.98 -0.97  0.05  0.05  0.01  0.01  0.01  0.01  0.01 -0.01  0.    0.    0.    0.
  0.    0.   -0.   -0.   -0.    0.  ]
[v00*v10, u00*v01, v02, v20, v00, v00*v10**2, u00*v01*v10, u00, u00*v00*v11, u00*u01*v01, u10*v00*v01, v00**3, u10*v00*v10, v00**2*v01, v00**2*v10, v01, u01*v01, u00**2*v00, u00*u10*v01, u00*v10]
[-0.98 -0.97  0.05  0.05  0.02  0.01  0.01 -0.01  0.01  0.01  0.01 -0.   -0.   -0.
  0.    0.    0.   -0.    0.    0.  ]
block:  3
name:  burgers-2-upwind-sparse0-noise0.001-id8
device:  cuda:0
generate a random number to check random seed:  -1.6856962317843824
current stage is: block-3
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.9240, device='cuda:0', dtype=torch.float64)
u_obs variance
tensor([ 0.2553,  1.7970,  1.5861, 23.8095,  9.5460, 18.5607,  0.2600,  1.6792,
         1.7745, 19.7649, 10.1603, 24.3876], device='cuda:0',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 0.175562
         Iterations: 0
         Function evaluations: 15
         Gradient evaluations: 3
convolution moment and kernels
[[ 1.00e+00  0.00e+00  1.45e-04 -3.82e-02 -4.26e-02]
 [ 0.00e+00  3.03e-05  2.22e-03  1.27e-03  9.46e-04]
 [ 8.97e-05  6.54e-04  2.38e-03 -1.33e-03  1.78e-03]
 [-3.32e-03 -5.70e-04  1.75e-03 -3.68e-04 -9.75e-03]
 [-7.08e-02  4.64e-03 -4.09e-03  3.12e-03  8.77e-03]]
[[ 0.01 -0.06  0.02 -0.06  0.02]
 [-0.04  0.2  -0.03  0.2  -0.05]
 [ 0.02 -0.1   0.68 -0.03 -0.  ]
 [-0.02  0.11  0.1   0.12 -0.03]
 [ 0.   -0.02 -0.04 -0.02  0.01]]
[[ 0.00e+00  1.00e+00  0.00e+00 -1.15e-01 -6.06e-02]
 [ 0.00e+00  0.00e+00  2.03e-03  4.28e-04 -3.53e-04]
 [ 0.00e+00  2.75e-02  8.53e-04  1.28e-02 -2.88e-03]
 [-1.20e-03  3.12e-03 -3.84e-03 -1.14e-03 -3.86e-03]
 [ 1.26e-02 -5.29e-03 -6.86e-04 -8.91e-03  7.37e-04]]
[[ 0.01 -0.01  0.03 -0.01 -0.  ]
 [-0.03  0.05 -0.11  0.03  0.01]
 [ 0.13 -0.61 -0.2   0.99 -0.22]
 [-0.03  0.04 -0.09  0.01  0.02]
 [ 0.   -0.01  0.01  0.01 -0.01]]
[[ 0.00e+00  0.00e+00  0.00e+00 -3.61e-03  8.12e-03]
 [ 1.00e+00  0.00e+00  1.98e-02  6.04e-04 -7.57e-03]
 [ 0.00e+00  3.78e-04  7.78e-03 -3.39e-03 -1.69e-03]
 [-1.03e-01 -2.05e-03  8.12e-03  2.03e-03 -1.07e-02]
 [-5.80e-02  7.28e-03 -6.16e-03  1.29e-03 -3.52e-03]]
[[ 0.   -0.02  0.11 -0.01  0.  ]
 [ 0.01  0.03 -0.58  0.    0.  ]
 [-0.01 -0.06 -0.26 -0.02 -0.  ]
 [ 0.02 -0.01  1.01 -0.02  0.01]
 [-0.01  0.02 -0.23  0.03 -0.01]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00  3.10e-03]
 [ 0.00e+00  0.00e+00  0.00e+00  6.43e-04 -3.38e-03]
 [ 0.00e+00  0.00e+00  1.16e-03 -1.43e-03  5.92e-04]
 [ 0.00e+00 -8.41e-04 -1.94e-03  5.46e-04  1.83e-03]
 [ 5.22e-03 -1.80e-03 -4.99e-04  2.95e-03 -4.76e-03]]
[[-7.57e-03  2.83e-02 -3.17e-02  2.07e-02 -4.49e-03]
 [ 3.11e-02 -1.11e-01  1.18e-01 -7.56e-02  1.64e-02]
 [-1.21e-01  1.46e+00 -2.62e+00  1.40e+00 -9.82e-02]
 [ 2.28e-02 -7.48e-02  5.98e-02 -3.64e-02  7.69e-03]
 [-5.31e-03  1.71e-02 -1.25e-02  7.57e-03 -1.65e-03]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  5.59e-04]
 [ 0.00e+00  1.00e+00  0.00e+00 -1.84e-03 -4.86e-03]
 [ 0.00e+00  0.00e+00  7.02e-04  1.57e-03 -1.60e-03]
 [ 0.00e+00 -1.89e-03 -2.22e-03  3.07e-03  5.63e-03]
 [ 6.41e-04  6.21e-03 -1.12e-03 -4.44e-03  1.86e-03]]
[[ 9.45e-03 -6.18e-02 -6.53e-03  7.14e-02 -1.19e-02]
 [-7.08e-02  4.94e-01 -1.48e-02 -4.79e-01  6.89e-02]
 [ 3.48e-02 -1.30e-01  1.19e-01 -1.88e-02 -1.97e-03]
 [ 2.68e-02 -3.30e-01 -1.32e-01  4.98e-01 -6.49e-02]
 [ 3.43e-04  2.52e-02  3.77e-02 -7.31e-02  1.05e-02]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  6.28e-03]
 [ 0.00e+00  0.00e+00  0.00e+00  7.56e-04 -3.18e-03]
 [ 1.00e+00  0.00e+00  1.97e-03 -1.32e-03 -1.56e-03]
 [ 0.00e+00 -1.88e-05 -1.72e-03 -3.36e-04  1.71e-03]
 [ 8.99e-05 -1.43e-03 -1.07e-03  2.54e-03 -1.61e-03]]
[[-4.13e-03  1.37e-02 -9.79e-02  6.06e-03 -1.01e-03]
 [ 1.46e-02 -4.24e-02  1.37e+00 -9.26e-03  8.91e-04]
 [-8.52e-03  7.03e-03 -2.47e+00 -4.15e-02  1.15e-02]
 [ 5.83e-03 -5.53e-03  1.31e+00  2.43e-02 -6.22e-03]
 [-1.52e-03  2.03e-03 -8.02e-02 -4.73e-03  1.15e-03]]
SymNet parameters
[[-2.51e+00  1.14e-01  4.80e-01  1.01e-01 -4.49e-02  2.11e-02  1.21e+00  4.34e-02
  -4.48e-01  6.49e-03  2.80e-02 -4.40e-02]
 [ 6.18e-02 -3.02e-01  3.62e+00 -1.63e-03  1.87e-01 -2.88e-01 -1.65e-01  5.34e-02
  -1.76e-01 -1.63e-02 -8.60e-03  4.87e-02]]
SymNet parameters
[-0.09 -0.14]
SymNet parameters
[[ 3.03e-01 -4.78e-02  4.22e+00 -3.62e-01 -1.03e-01 -6.20e-02 -1.78e+00  1.68e-01
  -5.31e-02 -5.10e-03 -2.91e-02  1.90e-02  2.93e-02]
 [ 3.23e-03  2.49e-04 -1.30e-03 -8.57e-04  2.86e-04  2.09e-04  3.76e-02 -2.05e-03
  -2.20e-04 -2.59e-05 -1.36e-04 -4.53e-05 -3.49e-04]]
SymNet parameters
[ 0.1  -0.24]
SymNet parameters
[[ 1.83e+00  9.52e-02 -1.10e-01  3.50e-02 -2.84e-03 -6.45e-03 -1.83e-01 -1.00e-02
  -6.67e-03 -5.47e-04  3.40e-03 -3.67e-04 -4.04e-04 -5.72e-02]
 [-9.66e-02 -4.90e-01 -3.50e-02  1.18e-01 -1.05e-02 -9.11e-03  7.72e-01 -6.59e-02
   2.88e-03  1.72e-03  8.42e-03 -6.85e-03 -1.37e-03 -3.74e-01]]
SymNet parameters
[0.39 0.48]
SymNet parameters
[[ 4.00e-02  3.55e-02  1.56e+00 -4.36e-02  3.67e-02  2.47e-02 -4.59e-01  4.90e-02
  -3.05e-03 -2.09e-04 -1.63e-03  2.62e-03  1.37e-02  1.57e-02 -4.04e-03]
 [-4.21e-01 -4.44e-03  1.04e-01  9.82e-03 -5.57e-03 -2.27e-03 -1.50e+00 -3.75e-02
  -1.11e-02  7.82e-04  2.44e-05 -6.19e-04  5.24e-05  3.13e-02  4.03e-03]]
SymNet parameters
[-0.11  0.94]
SymNet parameters
[[-1.34e-01  1.20e+00  1.55e+00  1.59e-01 -9.01e-02 -7.06e-02  1.38e+00 -1.14e-01
  -1.68e-02  1.00e-03  9.43e-03 -8.57e-03  2.08e-03  1.14e+00 -5.34e-04  9.20e-02]
 [ 1.67e+00 -9.85e-02  1.90e-01  5.78e-03 -6.60e-03 -4.00e-03  4.25e-01 -1.67e-02
   3.70e-03 -3.94e-04  5.74e-04 -1.12e-03 -4.85e-06  7.66e-02  5.46e-02  2.68e-02]]
SymNet parameters
[0.88 0.54]
SymNet parameters
[[-2.98e-01  2.10e-01 -1.37e+00  1.50e-01  1.32e-02  5.48e-02  7.25e-01 -6.30e-02
   1.45e-02  1.16e-03  6.31e-03 -5.14e-03 -1.49e-02 -1.01e+00  5.70e-01  2.67e-01
  -2.16e-01]]
SymNet parameters
[-0.01]
SymNet parameters
[[ 1.18e+00  5.66e-01 -9.27e-01  1.70e-01  1.96e-01 -1.58e-01 -1.15e+00 -2.09e+00
  -2.68e-01  5.46e-01  2.11e+00  1.11e+00]
 [-4.14e-03 -5.79e-05 -4.24e-05 -7.09e-05 -2.60e-05  2.69e-04 -2.09e-04 -4.34e-04
   1.46e-04  1.61e-04  1.46e-04 -8.06e-05]]
SymNet parameters
[-0.07  0.06]
SymNet parameters
[[ 2.57e-01  9.36e-03 -3.38e-01  3.52e-02  4.03e-02 -4.34e-02 -3.18e-01 -4.29e-01
   2.20e-01  7.45e-02  1.29e-01  2.15e-01 -9.79e-01]
 [ 2.95e+00  2.88e-01  8.25e-01 -7.57e-02  1.07e-02  2.27e-03  2.19e-01  1.59e+00
  -1.47e+00 -6.49e-02 -2.96e-01  3.70e-01  1.16e-01]]
SymNet parameters
[-0.3  -0.25]
SymNet parameters
[[-1.15e+00 -4.11e-02 -7.20e-02  8.69e-03  6.24e-03 -8.51e-03 -4.79e-01 -2.46e-01
   3.27e-01  2.03e-02  8.31e-02  4.71e-02 -3.91e-01  2.03e-03]
 [-4.36e-02  3.57e-02  8.23e-02 -1.05e-02 -8.61e-03  1.03e-02 -2.04e-02  2.61e+00
  -4.84e-02 -2.54e-02 -1.03e-01 -5.96e-02  3.41e-01 -7.74e-03]]
SymNet parameters
[ 0.63 -1.04]
SymNet parameters
[[-1.81e-01  4.91e-02 -5.94e-03  3.80e-03  6.41e-03 -5.88e-03 -2.11e+00 -1.06e+00
   1.97e-01  1.81e-02  6.09e-02  2.38e-02 -4.56e-01 -6.87e-04  1.53e-02]
 [-8.71e-02  2.60e-01  1.10e-01 -5.09e-03  1.01e-02  4.57e-03  6.03e-01  6.32e-01
  -1.74e+00  1.92e-02  5.15e-02  7.61e-03 -1.20e+00 -1.89e-02  1.94e-02]]
SymNet parameters
[0.43 0.01]
SymNet parameters
[[ 4.10e-01  5.73e-02  5.41e-02 -2.78e-03 -3.81e-03  1.13e-02 -2.01e+00  5.67e-01
  -4.26e-01 -1.00e-02 -3.67e-02 -1.94e-02 -1.94e-02  4.19e-03 -5.55e-02  2.23e-02]
 [ 1.27e-02  7.27e-02  1.18e-01 -1.45e-02 -9.95e-03  1.48e-02  3.78e-01  2.17e-01
   3.43e-01 -3.21e-02 -1.33e-01 -7.49e-02  6.49e-01  5.22e-03  2.80e-04 -1.94e-04]]
SymNet parameters
[ 0.31 -0.31]
SymNet parameters
[[-4.65e-01 -5.33e-02  4.01e-02 -9.26e-03 -1.27e-02  9.62e-03 -2.99e-01 -3.63e-01
  -8.38e-02  2.08e-02 -1.19e-01 -1.45e-02  1.02e+00 -1.38e-04  3.30e-01 -1.74e-01
   3.93e-01]]
SymNet parameters
[0.26]
finally, finish this stage
iter:     0    time: 39.25
Func: 1.76e-01  |g|: 1.42e+01
stableloss: 2.67e-02   dataloss: 1.56e-01   sparseloss: 9.32e+01 momentloss: 6.54e+00
current expression:
[u10*v00, u00*u01, u20, u02, u00*u01**2, u00*u10*v01, u10*v00*v10, u00*u11*v00, u01*u10*v00, 1, u00*u10, u10*v01, u00, v00, u20*v00**2, v00**2, u01, v10, u00*v00*v10, u01**2]
[-0.98 -0.97  0.05  0.05  0.01  0.01  0.01  0.01  0.01 -0.01  0.    0.    0.    0.
  0.    0.   -0.   -0.   -0.    0.  ]
[v00*v10, u00*v01, v02, v20, v00, v00*v10**2, u00*v01*v10, u00, u00*v00*v11, u00*u01*v01, u10*v00*v01, v00**3, u10*v00*v10, v00**2*v01, v00**2*v10, v01, u01*v01, u00**2*v00, u00*u10*v01, u00*v10]
[-0.98 -0.97  0.05  0.05  0.02  0.01  0.01 -0.01  0.01  0.01  0.01 -0.   -0.   -0.
  0.    0.    0.   -0.    0.    0.  ]
block:  4
name:  burgers-2-upwind-sparse0-noise0.001-id8
device:  cuda:0
generate a random number to check random seed:  0.02002789007327266
current stage is: block-4
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.6751, device='cuda:0', dtype=torch.float64)
u_obs variance
tensor([ 0.2474,  1.7628,  1.5970, 23.1284, 10.4232, 18.7748,  0.2539,  1.5906,
         1.7570, 18.3916,  9.4600, 23.6650], device='cuda:0',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 0.304579
         Iterations: 0
         Function evaluations: 15
         Gradient evaluations: 3
convolution moment and kernels
[[ 1.00e+00  0.00e+00  1.45e-04 -3.82e-02 -4.26e-02]
 [ 0.00e+00  3.04e-05  2.22e-03  1.27e-03  9.47e-04]
 [ 9.06e-05  6.56e-04  2.38e-03 -1.34e-03  1.78e-03]
 [-3.33e-03 -5.70e-04  1.75e-03 -3.68e-04 -9.75e-03]
 [-7.08e-02  4.63e-03 -4.09e-03  3.13e-03  8.77e-03]]
[[ 0.01 -0.06  0.02 -0.06  0.02]
 [-0.04  0.2  -0.03  0.2  -0.05]
 [ 0.02 -0.1   0.68 -0.03 -0.  ]
 [-0.02  0.11  0.1   0.12 -0.03]
 [ 0.   -0.02 -0.04 -0.02  0.01]]
[[ 0.00e+00  1.00e+00  0.00e+00 -1.15e-01 -6.06e-02]
 [ 0.00e+00  0.00e+00  2.03e-03  4.27e-04 -3.55e-04]
 [ 0.00e+00  2.75e-02  8.54e-04  1.28e-02 -2.88e-03]
 [-1.21e-03  3.12e-03 -3.84e-03 -1.14e-03 -3.86e-03]
 [ 1.26e-02 -5.29e-03 -6.87e-04 -8.91e-03  7.40e-04]]
[[ 0.01 -0.01  0.03 -0.01 -0.  ]
 [-0.03  0.05 -0.11  0.03  0.01]
 [ 0.13 -0.61 -0.2   0.99 -0.22]
 [-0.03  0.04 -0.09  0.01  0.02]
 [ 0.   -0.01  0.01  0.01 -0.01]]
[[ 0.00e+00  0.00e+00  0.00e+00 -3.61e-03  8.12e-03]
 [ 1.00e+00  0.00e+00  1.98e-02  6.05e-04 -7.58e-03]
 [ 0.00e+00  3.80e-04  7.78e-03 -3.39e-03 -1.69e-03]
 [-1.03e-01 -2.05e-03  8.12e-03  2.03e-03 -1.07e-02]
 [-5.80e-02  7.28e-03 -6.16e-03  1.30e-03 -3.52e-03]]
[[ 0.   -0.02  0.11 -0.01  0.  ]
 [ 0.01  0.03 -0.58  0.    0.  ]
 [-0.01 -0.06 -0.26 -0.02 -0.  ]
 [ 0.02 -0.01  1.01 -0.02  0.01]
 [-0.01  0.02 -0.23  0.03 -0.01]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00  3.10e-03]
 [ 0.00e+00  0.00e+00  0.00e+00  6.43e-04 -3.38e-03]
 [ 0.00e+00  0.00e+00  1.16e-03 -1.43e-03  5.92e-04]
 [ 0.00e+00 -8.41e-04 -1.94e-03  5.46e-04  1.83e-03]
 [ 5.22e-03 -1.80e-03 -4.99e-04  2.95e-03 -4.76e-03]]
[[-7.57e-03  2.83e-02 -3.17e-02  2.07e-02 -4.49e-03]
 [ 3.11e-02 -1.11e-01  1.18e-01 -7.56e-02  1.64e-02]
 [-1.21e-01  1.46e+00 -2.62e+00  1.40e+00 -9.82e-02]
 [ 2.29e-02 -7.48e-02  5.97e-02 -3.64e-02  7.68e-03]
 [-5.31e-03  1.71e-02 -1.25e-02  7.56e-03 -1.65e-03]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  5.59e-04]
 [ 0.00e+00  1.00e+00  0.00e+00 -1.84e-03 -4.86e-03]
 [ 0.00e+00  0.00e+00  7.02e-04  1.57e-03 -1.60e-03]
 [ 0.00e+00 -1.89e-03 -2.22e-03  3.07e-03  5.63e-03]
 [ 6.41e-04  6.21e-03 -1.12e-03 -4.44e-03  1.86e-03]]
[[ 9.45e-03 -6.18e-02 -6.53e-03  7.14e-02 -1.19e-02]
 [-7.08e-02  4.94e-01 -1.48e-02 -4.79e-01  6.89e-02]
 [ 3.48e-02 -1.30e-01  1.19e-01 -1.88e-02 -1.97e-03]
 [ 2.68e-02 -3.30e-01 -1.32e-01  4.98e-01 -6.49e-02]
 [ 3.43e-04  2.52e-02  3.77e-02 -7.31e-02  1.05e-02]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  6.28e-03]
 [ 0.00e+00  0.00e+00  0.00e+00  7.56e-04 -3.18e-03]
 [ 1.00e+00  0.00e+00  1.98e-03 -1.32e-03 -1.56e-03]
 [ 0.00e+00 -1.89e-05 -1.72e-03 -3.36e-04  1.71e-03]
 [ 9.05e-05 -1.43e-03 -1.07e-03  2.55e-03 -1.61e-03]]
[[-4.13e-03  1.37e-02 -9.79e-02  6.05e-03 -1.00e-03]
 [ 1.46e-02 -4.24e-02  1.37e+00 -9.23e-03  8.83e-04]
 [-8.52e-03  7.02e-03 -2.47e+00 -4.15e-02  1.15e-02]
 [ 5.83e-03 -5.52e-03  1.31e+00  2.43e-02 -6.22e-03]
 [-1.52e-03  2.03e-03 -8.02e-02 -4.74e-03  1.15e-03]]
SymNet parameters
[[-2.51e+00  1.14e-01  4.80e-01  1.01e-01 -4.49e-02  2.11e-02  1.21e+00  4.34e-02
  -4.48e-01  6.49e-03  2.80e-02 -4.40e-02]
 [ 6.18e-02 -3.02e-01  3.62e+00 -1.63e-03  1.87e-01 -2.88e-01 -1.65e-01  5.34e-02
  -1.76e-01 -1.63e-02 -8.60e-03  4.87e-02]]
SymNet parameters
[-0.09 -0.14]
SymNet parameters
[[ 3.03e-01 -4.78e-02  4.22e+00 -3.62e-01 -1.03e-01 -6.20e-02 -1.78e+00  1.68e-01
  -5.31e-02 -5.10e-03 -2.91e-02  1.90e-02  2.93e-02]
 [ 3.24e-03  1.92e-04 -1.29e-03 -9.62e-04  2.43e-04  1.91e-04  3.76e-02 -2.08e-03
  -2.05e-04 -7.93e-06 -7.78e-05 -3.54e-05 -3.33e-04]]
SymNet parameters
[ 0.1  -0.24]
SymNet parameters
[[ 1.83e+00  9.52e-02 -1.10e-01  3.50e-02 -2.84e-03 -6.45e-03 -1.83e-01 -1.00e-02
  -6.67e-03 -5.37e-04  3.40e-03 -3.61e-04 -3.08e-04 -5.72e-02]
 [-9.66e-02 -4.90e-01 -3.50e-02  1.18e-01 -1.05e-02 -9.12e-03  7.72e-01 -6.59e-02
   2.88e-03  1.72e-03  8.42e-03 -6.86e-03 -1.44e-03 -3.74e-01]]
SymNet parameters
[0.39 0.48]
SymNet parameters
[[ 4.00e-02  3.55e-02  1.56e+00 -4.36e-02  3.67e-02  2.47e-02 -4.59e-01  4.90e-02
  -3.05e-03 -2.16e-04 -1.63e-03  2.62e-03  1.37e-02  1.57e-02 -4.04e-03]
 [-4.21e-01 -4.44e-03  1.04e-01  9.83e-03 -5.57e-03 -2.27e-03 -1.50e+00 -3.75e-02
  -1.11e-02  7.79e-04  2.35e-05 -6.25e-04  4.26e-05  3.13e-02  4.02e-03]]
SymNet parameters
[-0.11  0.94]
SymNet parameters
[[-1.34e-01  1.20e+00  1.55e+00  1.59e-01 -9.01e-02 -7.06e-02  1.38e+00 -1.14e-01
  -1.68e-02  1.00e-03  9.43e-03 -8.57e-03  2.09e-03  1.14e+00 -5.36e-04  9.20e-02]
 [ 1.67e+00 -9.85e-02  1.90e-01  5.79e-03 -6.60e-03 -4.00e-03  4.25e-01 -1.67e-02
   3.70e-03 -4.05e-04  5.72e-04 -1.13e-03 -2.68e-05  7.66e-02  5.46e-02  2.68e-02]]
SymNet parameters
[0.88 0.54]
SymNet parameters
[[-2.98e-01  2.10e-01 -1.37e+00  1.50e-01  1.32e-02  5.48e-02  7.25e-01 -6.30e-02
   1.45e-02  1.17e-03  6.31e-03 -5.13e-03 -1.49e-02 -1.01e+00  5.70e-01  2.67e-01
  -2.16e-01]]
SymNet parameters
[-0.01]
SymNet parameters
[[ 1.18e+00  5.66e-01 -9.27e-01  1.70e-01  1.96e-01 -1.58e-01 -1.15e+00 -2.09e+00
  -2.68e-01  5.46e-01  2.11e+00  1.11e+00]
 [-4.22e-03 -3.74e-05 -3.71e-05  1.61e-05 -1.62e-04  1.73e-04 -2.19e-04 -4.34e-04
   7.90e-06  1.32e-04 -8.66e-05 -2.61e-04]]
SymNet parameters
[-0.07  0.06]
SymNet parameters
[[ 2.57e-01  9.36e-03 -3.38e-01  3.52e-02  4.03e-02 -4.34e-02 -3.18e-01 -4.29e-01
   2.20e-01  7.45e-02  1.29e-01  2.15e-01 -9.79e-01]
 [ 2.95e+00  2.88e-01  8.25e-01 -7.57e-02  1.07e-02  2.27e-03  2.19e-01  1.59e+00
  -1.47e+00 -6.49e-02 -2.96e-01  3.70e-01  1.16e-01]]
SymNet parameters
[-0.3  -0.25]
SymNet parameters
[[-1.15e+00 -4.11e-02 -7.20e-02  8.69e-03  6.25e-03 -8.51e-03 -4.79e-01 -2.46e-01
   3.27e-01  2.03e-02  8.31e-02  4.71e-02 -3.91e-01  2.04e-03]
 [-4.36e-02  3.57e-02  8.23e-02 -1.05e-02 -8.61e-03  1.03e-02 -2.04e-02  2.61e+00
  -4.84e-02 -2.54e-02 -1.03e-01 -5.96e-02  3.41e-01 -7.74e-03]]
SymNet parameters
[ 0.63 -1.04]
SymNet parameters
[[-1.81e-01  4.91e-02 -5.94e-03  3.80e-03  6.41e-03 -5.87e-03 -2.11e+00 -1.06e+00
   1.97e-01  1.81e-02  6.09e-02  2.38e-02 -4.56e-01 -6.93e-04  1.53e-02]
 [-8.71e-02  2.60e-01  1.10e-01 -5.09e-03  1.01e-02  4.57e-03  6.03e-01  6.32e-01
  -1.74e+00  1.92e-02  5.15e-02  7.61e-03 -1.20e+00 -1.89e-02  1.94e-02]]
SymNet parameters
[0.43 0.01]
SymNet parameters
[[ 4.10e-01  5.73e-02  5.41e-02 -2.78e-03 -3.81e-03  1.13e-02 -2.01e+00  5.67e-01
  -4.26e-01 -1.00e-02 -3.67e-02 -1.94e-02 -1.94e-02  4.19e-03 -5.55e-02  2.23e-02]
 [ 1.27e-02  7.27e-02  1.18e-01 -1.45e-02 -9.94e-03  1.48e-02  3.78e-01  2.17e-01
   3.43e-01 -3.21e-02 -1.33e-01 -7.49e-02  6.49e-01  5.22e-03  2.72e-04 -2.25e-04]]
SymNet parameters
[ 0.31 -0.31]
SymNet parameters
[[-4.65e-01 -5.33e-02  4.01e-02 -9.26e-03 -1.27e-02  9.62e-03 -2.99e-01 -3.63e-01
  -8.38e-02  2.08e-02 -1.19e-01 -1.45e-02  1.02e+00 -1.33e-04  3.30e-01 -1.74e-01
   3.93e-01]]
SymNet parameters
[0.26]
finally, finish this stage
iter:     0    time: 38.61
Func: 3.05e-01  |g|: 4.00e+01
stableloss: 3.67e-02   dataloss: 2.78e-01   sparseloss: 9.32e+01 momentloss: 6.54e+00
current expression:
[u10*v00, u00*u01, u20, u02, u00*u01**2, u00*u10*v01, u10*v00*v10, u00*u11*v00, u01*u10*v00, 1, u00*u10, u10*v01, u00, v00, u20*v00**2, v00**2, u01, v10, u00*v00*v10, u01**2]
[-0.98 -0.97  0.05  0.05  0.01  0.01  0.01  0.01  0.01 -0.01  0.    0.    0.    0.
  0.    0.   -0.   -0.   -0.    0.  ]
[v00*v10, u00*v01, v02, v20, v00, v00*v10**2, u00*v01*v10, u00, u00*v00*v11, u00*u01*v01, u10*v00*v01, v00**3, u10*v00*v10, v00**2*v01, v00**2*v10, v01, u01*v01, u00**2*v00, u00*u10*v01, u00*v10]
[-0.98 -0.97  0.05  0.05  0.02  0.01  0.01 -0.01  0.01  0.01  0.01 -0.   -0.   -0.
  0.    0.    0.   -0.    0.    0.  ]
block:  5
name:  burgers-2-upwind-sparse0-noise0.001-id8
device:  cuda:0
generate a random number to check random seed:  -1.0043955908976478
current stage is: block-5
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.9335, device='cuda:0', dtype=torch.float64)
u_obs variance
tensor([ 0.2599,  1.7726,  1.7462, 22.9430, 10.3791, 20.8990,  0.2636,  1.5848,
         1.8885, 17.8545, 10.1343, 24.9668], device='cuda:0',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 0.611921
         Iterations: 0
         Function evaluations: 15
         Gradient evaluations: 3
convolution moment and kernels
[[ 1.00e+00  0.00e+00  1.44e-04 -3.82e-02 -4.26e-02]
 [ 0.00e+00  3.03e-05  2.22e-03  1.27e-03  9.46e-04]
 [ 8.96e-05  6.54e-04  2.38e-03 -1.33e-03  1.78e-03]
 [-3.33e-03 -5.70e-04  1.75e-03 -3.68e-04 -9.75e-03]
 [-7.08e-02  4.64e-03 -4.10e-03  3.12e-03  8.77e-03]]
[[ 0.01 -0.06  0.02 -0.06  0.02]
 [-0.04  0.2  -0.03  0.2  -0.05]
 [ 0.02 -0.1   0.68 -0.03 -0.  ]
 [-0.02  0.11  0.1   0.12 -0.03]
 [ 0.   -0.02 -0.04 -0.02  0.01]]
[[ 0.00e+00  1.00e+00  0.00e+00 -1.15e-01 -6.06e-02]
 [ 0.00e+00  0.00e+00  2.03e-03  4.27e-04 -3.56e-04]
 [ 0.00e+00  2.75e-02  8.56e-04  1.28e-02 -2.88e-03]
 [-1.21e-03  3.12e-03 -3.84e-03 -1.14e-03 -3.86e-03]
 [ 1.26e-02 -5.28e-03 -6.92e-04 -8.92e-03  7.49e-04]]
[[ 0.01 -0.01  0.03 -0.01 -0.  ]
 [-0.03  0.05 -0.11  0.03  0.01]
 [ 0.13 -0.61 -0.2   0.99 -0.22]
 [-0.03  0.04 -0.09  0.01  0.02]
 [ 0.   -0.01  0.01  0.01 -0.01]]
[[ 0.00e+00  0.00e+00  0.00e+00 -3.61e-03  8.13e-03]
 [ 1.00e+00  0.00e+00  1.98e-02  6.04e-04 -7.58e-03]
 [ 0.00e+00  3.77e-04  7.78e-03 -3.39e-03 -1.69e-03]
 [-1.03e-01 -2.06e-03  8.12e-03  2.03e-03 -1.07e-02]
 [-5.80e-02  7.28e-03 -6.16e-03  1.29e-03 -3.51e-03]]
[[ 0.   -0.02  0.11 -0.01  0.  ]
 [ 0.01  0.03 -0.58  0.    0.  ]
 [-0.01 -0.06 -0.26 -0.02 -0.  ]
 [ 0.02 -0.01  1.01 -0.02  0.01]
 [-0.01  0.02 -0.23  0.03 -0.01]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00  3.10e-03]
 [ 0.00e+00  0.00e+00  0.00e+00  6.43e-04 -3.38e-03]
 [ 0.00e+00  0.00e+00  1.16e-03 -1.43e-03  5.91e-04]
 [ 0.00e+00 -8.41e-04 -1.94e-03  5.46e-04  1.83e-03]
 [ 5.22e-03 -1.80e-03 -5.00e-04  2.95e-03 -4.75e-03]]
[[-7.57e-03  2.83e-02 -3.17e-02  2.07e-02 -4.49e-03]
 [ 3.11e-02 -1.11e-01  1.18e-01 -7.56e-02  1.64e-02]
 [-1.21e-01  1.46e+00 -2.62e+00  1.40e+00 -9.82e-02]
 [ 2.28e-02 -7.47e-02  5.97e-02 -3.64e-02  7.68e-03]
 [-5.30e-03  1.71e-02 -1.25e-02  7.56e-03 -1.64e-03]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  5.59e-04]
 [ 0.00e+00  1.00e+00  0.00e+00 -1.84e-03 -4.85e-03]
 [ 0.00e+00  0.00e+00  7.02e-04  1.57e-03 -1.60e-03]
 [ 0.00e+00 -1.89e-03 -2.22e-03  3.07e-03  5.63e-03]
 [ 6.41e-04  6.21e-03 -1.12e-03 -4.44e-03  1.86e-03]]
[[ 9.45e-03 -6.18e-02 -6.52e-03  7.14e-02 -1.19e-02]
 [-7.08e-02  4.94e-01 -1.49e-02 -4.79e-01  6.89e-02]
 [ 3.48e-02 -1.30e-01  1.19e-01 -1.88e-02 -1.96e-03]
 [ 2.68e-02 -3.30e-01 -1.32e-01  4.98e-01 -6.49e-02]
 [ 3.44e-04  2.52e-02  3.77e-02 -7.31e-02  1.05e-02]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  6.28e-03]
 [ 0.00e+00  0.00e+00  0.00e+00  7.56e-04 -3.18e-03]
 [ 1.00e+00  0.00e+00  1.98e-03 -1.32e-03 -1.56e-03]
 [ 0.00e+00 -1.89e-05 -1.72e-03 -3.36e-04  1.71e-03]
 [ 9.10e-05 -1.43e-03 -1.07e-03  2.54e-03 -1.61e-03]]
[[-4.12e-03  1.37e-02 -9.79e-02  6.05e-03 -1.00e-03]
 [ 1.46e-02 -4.24e-02  1.37e+00 -9.22e-03  8.83e-04]
 [-8.50e-03  6.96e-03 -2.47e+00 -4.16e-02  1.15e-02]
 [ 5.82e-03 -5.48e-03  1.31e+00  2.43e-02 -6.22e-03]
 [-1.51e-03  2.02e-03 -8.02e-02 -4.74e-03  1.15e-03]]
SymNet parameters
[[-2.51e+00  1.14e-01  4.80e-01  1.01e-01 -4.49e-02  2.11e-02  1.21e+00  4.34e-02
  -4.48e-01  6.49e-03  2.80e-02 -4.40e-02]
 [ 6.18e-02 -3.02e-01  3.62e+00 -1.63e-03  1.87e-01 -2.88e-01 -1.65e-01  5.34e-02
  -1.76e-01 -1.63e-02 -8.60e-03  4.87e-02]]
SymNet parameters
[-0.09 -0.14]
SymNet parameters
[[ 3.03e-01 -4.78e-02  4.22e+00 -3.62e-01 -1.03e-01 -6.20e-02 -1.78e+00  1.68e-01
  -5.31e-02 -5.10e-03 -2.91e-02  1.90e-02  2.93e-02]
 [ 3.24e-03  2.43e-04 -1.31e-03 -1.01e-03  2.62e-04  1.77e-04  3.76e-02 -2.08e-03
  -2.00e-04  5.38e-06 -1.02e-04  2.28e-05 -5.36e-04]]
SymNet parameters
[ 0.1  -0.24]
SymNet parameters
[[ 1.83e+00  9.52e-02 -1.10e-01  3.50e-02 -2.84e-03 -6.46e-03 -1.83e-01 -1.00e-02
  -6.67e-03 -5.42e-04  3.40e-03 -3.64e-04 -3.84e-04 -5.72e-02]
 [-9.66e-02 -4.90e-01 -3.50e-02  1.18e-01 -1.05e-02 -9.11e-03  7.72e-01 -6.59e-02
   2.88e-03  1.73e-03  8.42e-03 -6.86e-03 -1.38e-03 -3.74e-01]]
SymNet parameters
[0.39 0.48]
SymNet parameters
[[ 4.00e-02  3.55e-02  1.56e+00 -4.36e-02  3.67e-02  2.47e-02 -4.59e-01  4.90e-02
  -3.05e-03 -2.15e-04 -1.63e-03  2.61e-03  1.37e-02  1.57e-02 -4.04e-03]
 [-4.21e-01 -4.44e-03  1.04e-01  9.83e-03 -5.57e-03 -2.28e-03 -1.50e+00 -3.75e-02
  -1.11e-02  7.80e-04  2.52e-05 -6.23e-04  5.07e-05  3.13e-02  4.02e-03]]
SymNet parameters
[-0.11  0.94]
SymNet parameters
[[-1.34e-01  1.20e+00  1.55e+00  1.59e-01 -9.01e-02 -7.06e-02  1.38e+00 -1.14e-01
  -1.68e-02  1.00e-03  9.43e-03 -8.57e-03  2.08e-03  1.14e+00 -5.37e-04  9.20e-02]
 [ 1.67e+00 -9.85e-02  1.90e-01  5.79e-03 -6.60e-03 -4.00e-03  4.25e-01 -1.67e-02
   3.70e-03 -4.01e-04  5.75e-04 -1.12e-03  8.06e-06  7.66e-02  5.46e-02  2.68e-02]]
SymNet parameters
[0.88 0.54]
SymNet parameters
[[-2.98e-01  2.10e-01 -1.37e+00  1.50e-01  1.32e-02  5.48e-02  7.25e-01 -6.30e-02
   1.45e-02  1.17e-03  6.31e-03 -5.14e-03 -1.49e-02 -1.01e+00  5.70e-01  2.67e-01
  -2.16e-01]]
SymNet parameters
[-0.01]
SymNet parameters
[[ 1.18e+00  5.66e-01 -9.27e-01  1.70e-01  1.96e-01 -1.58e-01 -1.15e+00 -2.09e+00
  -2.68e-01  5.46e-01  2.11e+00  1.11e+00]
 [-4.17e-03 -1.56e-04 -1.97e-05 -8.74e-06 -3.75e-05  1.39e-04 -2.16e-04 -4.54e-04
   1.70e-04 -8.02e-05 -6.62e-05 -2.19e-04]]
SymNet parameters
[-0.07  0.06]
SymNet parameters
[[ 2.57e-01  9.36e-03 -3.38e-01  3.52e-02  4.03e-02 -4.34e-02 -3.18e-01 -4.29e-01
   2.20e-01  7.45e-02  1.29e-01  2.15e-01 -9.79e-01]
 [ 2.95e+00  2.88e-01  8.25e-01 -7.57e-02  1.07e-02  2.27e-03  2.19e-01  1.59e+00
  -1.47e+00 -6.49e-02 -2.96e-01  3.70e-01  1.16e-01]]
SymNet parameters
[-0.3  -0.25]
SymNet parameters
[[-1.15e+00 -4.11e-02 -7.20e-02  8.69e-03  6.24e-03 -8.51e-03 -4.79e-01 -2.46e-01
   3.27e-01  2.03e-02  8.31e-02  4.71e-02 -3.91e-01  2.05e-03]
 [-4.36e-02  3.57e-02  8.23e-02 -1.05e-02 -8.61e-03  1.03e-02 -2.04e-02  2.61e+00
  -4.84e-02 -2.54e-02 -1.03e-01 -5.96e-02  3.41e-01 -7.75e-03]]
SymNet parameters
[ 0.63 -1.04]
SymNet parameters
[[-1.81e-01  4.91e-02 -5.94e-03  3.79e-03  6.41e-03 -5.88e-03 -2.11e+00 -1.06e+00
   1.97e-01  1.81e-02  6.09e-02  2.38e-02 -4.56e-01 -6.95e-04  1.53e-02]
 [-8.71e-02  2.60e-01  1.10e-01 -5.09e-03  1.01e-02  4.57e-03  6.03e-01  6.32e-01
  -1.74e+00  1.92e-02  5.15e-02  7.61e-03 -1.20e+00 -1.89e-02  1.94e-02]]
SymNet parameters
[0.43 0.01]
SymNet parameters
[[ 4.10e-01  5.73e-02  5.41e-02 -2.78e-03 -3.81e-03  1.13e-02 -2.01e+00  5.67e-01
  -4.26e-01 -1.00e-02 -3.67e-02 -1.94e-02 -1.94e-02  4.19e-03 -5.55e-02  2.23e-02]
 [ 1.27e-02  7.27e-02  1.18e-01 -1.45e-02 -9.94e-03  1.48e-02  3.78e-01  2.17e-01
   3.43e-01 -3.21e-02 -1.33e-01 -7.49e-02  6.49e-01  5.22e-03  2.77e-04 -2.32e-04]]
SymNet parameters
[ 0.31 -0.31]
SymNet parameters
[[-4.65e-01 -5.33e-02  4.01e-02 -9.26e-03 -1.27e-02  9.62e-03 -2.99e-01 -3.63e-01
  -8.38e-02  2.08e-02 -1.19e-01 -1.45e-02  1.02e+00 -1.32e-04  3.30e-01 -1.74e-01
   3.93e-01]]
SymNet parameters
[0.26]
finally, finish this stage
iter:     0    time: 39.85
Func: 6.12e-01  |g|: 2.30e+02
stableloss: 3.71e-02   dataloss: 5.79e-01   sparseloss: 9.32e+01 momentloss: 6.54e+00
current expression:
[u10*v00, u00*u01, u20, u02, u00*u01**2, u00*u10*v01, u10*v00*v10, u00*u11*v00, u01*u10*v00, 1, u00*u10, u10*v01, u00, v00, u20*v00**2, v00**2, u01, v10, u00*v00*v10, u01**2]
[-0.98 -0.97  0.05  0.05  0.01  0.01  0.01  0.01  0.01 -0.01  0.    0.    0.    0.
  0.    0.   -0.   -0.   -0.    0.  ]
[v00*v10, u00*v01, v02, v20, v00, v00*v10**2, u00*v01*v10, u00, u00*v00*v11, u00*u01*v01, u10*v00*v01, v00**3, u10*v00*v10, v00**2*v01, v00**2*v10, v01, u01*v01, u00**2*v00, u00*u10*v01, u00*v10]
[-0.98 -0.97  0.05  0.05  0.02  0.01  0.01 -0.01  0.01  0.01  0.01 -0.   -0.   -0.
  0.    0.    0.   -0.    0.    0.  ]
block:  6
name:  burgers-2-upwind-sparse0-noise0.001-id8
device:  cuda:0
generate a random number to check random seed:  -1.7026322350493697
current stage is: block-6
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.9462, device='cuda:0', dtype=torch.float64)
u_obs variance
tensor([ 0.2582,  1.7623,  1.6842, 22.7126, 10.4708, 19.9838,  0.2352,  1.4907,
         1.6485, 17.3266,  9.4805, 22.7456], device='cuda:0',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 0.714593
         Iterations: 0
         Function evaluations: 15
         Gradient evaluations: 3
convolution moment and kernels
[[ 1.00e+00  0.00e+00  1.44e-04 -3.82e-02 -4.26e-02]
 [ 0.00e+00  3.00e-05  2.22e-03  1.27e-03  9.48e-04]
 [ 9.03e-05  6.54e-04  2.38e-03 -1.33e-03  1.78e-03]
 [-3.33e-03 -5.70e-04  1.75e-03 -3.68e-04 -9.75e-03]
 [-7.08e-02  4.64e-03 -4.09e-03  3.12e-03  8.77e-03]]
[[ 0.01 -0.06  0.02 -0.06  0.02]
 [-0.04  0.2  -0.03  0.2  -0.05]
 [ 0.02 -0.1   0.68 -0.03 -0.  ]
 [-0.02  0.11  0.1   0.12 -0.03]
 [ 0.   -0.02 -0.04 -0.02  0.01]]
[[ 0.00e+00  1.00e+00  0.00e+00 -1.15e-01 -6.06e-02]
 [ 0.00e+00  0.00e+00  2.02e-03  4.28e-04 -3.52e-04]
 [ 0.00e+00  2.75e-02  8.56e-04  1.28e-02 -2.88e-03]
 [-1.21e-03  3.12e-03 -3.84e-03 -1.14e-03 -3.86e-03]
 [ 1.26e-02 -5.28e-03 -6.92e-04 -8.92e-03  7.47e-04]]
[[ 0.01 -0.01  0.03 -0.01 -0.  ]
 [-0.03  0.05 -0.11  0.03  0.01]
 [ 0.13 -0.61 -0.2   0.99 -0.22]
 [-0.03  0.04 -0.09  0.01  0.02]
 [ 0.   -0.01  0.01  0.01 -0.01]]
[[ 0.00e+00  0.00e+00  0.00e+00 -3.61e-03  8.13e-03]
 [ 1.00e+00  0.00e+00  1.98e-02  6.04e-04 -7.57e-03]
 [ 0.00e+00  3.76e-04  7.78e-03 -3.39e-03 -1.69e-03]
 [-1.03e-01 -2.06e-03  8.12e-03  2.03e-03 -1.07e-02]
 [-5.80e-02  7.29e-03 -6.16e-03  1.29e-03 -3.52e-03]]
[[ 0.   -0.02  0.11 -0.01  0.  ]
 [ 0.01  0.03 -0.58  0.    0.  ]
 [-0.01 -0.06 -0.26 -0.02 -0.  ]
 [ 0.02 -0.01  1.01 -0.02  0.01]
 [-0.01  0.02 -0.23  0.03 -0.01]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00  3.10e-03]
 [ 0.00e+00  0.00e+00  0.00e+00  6.43e-04 -3.38e-03]
 [ 0.00e+00  0.00e+00  1.16e-03 -1.43e-03  5.91e-04]
 [ 0.00e+00 -8.41e-04 -1.94e-03  5.46e-04  1.83e-03]
 [ 5.22e-03 -1.80e-03 -5.00e-04  2.95e-03 -4.75e-03]]
[[-7.57e-03  2.83e-02 -3.17e-02  2.07e-02 -4.49e-03]
 [ 3.11e-02 -1.11e-01  1.18e-01 -7.56e-02  1.64e-02]
 [-1.21e-01  1.46e+00 -2.62e+00  1.40e+00 -9.82e-02]
 [ 2.28e-02 -7.47e-02  5.97e-02 -3.64e-02  7.68e-03]
 [-5.30e-03  1.71e-02 -1.25e-02  7.57e-03 -1.65e-03]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  5.59e-04]
 [ 0.00e+00  1.00e+00  0.00e+00 -1.84e-03 -4.85e-03]
 [ 0.00e+00  0.00e+00  7.02e-04  1.57e-03 -1.60e-03]
 [ 0.00e+00 -1.89e-03 -2.22e-03  3.07e-03  5.63e-03]
 [ 6.41e-04  6.21e-03 -1.12e-03 -4.44e-03  1.86e-03]]
[[ 9.45e-03 -6.18e-02 -6.52e-03  7.14e-02 -1.19e-02]
 [-7.08e-02  4.94e-01 -1.49e-02 -4.79e-01  6.89e-02]
 [ 3.48e-02 -1.30e-01  1.19e-01 -1.88e-02 -1.96e-03]
 [ 2.68e-02 -3.30e-01 -1.32e-01  4.98e-01 -6.49e-02]
 [ 3.44e-04  2.52e-02  3.77e-02 -7.31e-02  1.05e-02]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  6.28e-03]
 [ 0.00e+00  0.00e+00  0.00e+00  7.56e-04 -3.18e-03]
 [ 1.00e+00  0.00e+00  1.98e-03 -1.32e-03 -1.56e-03]
 [ 0.00e+00 -1.88e-05 -1.72e-03 -3.36e-04  1.71e-03]
 [ 9.10e-05 -1.43e-03 -1.07e-03  2.54e-03 -1.61e-03]]
[[-4.12e-03  1.37e-02 -9.79e-02  6.05e-03 -1.00e-03]
 [ 1.46e-02 -4.23e-02  1.37e+00 -9.22e-03  8.82e-04]
 [-8.50e-03  6.96e-03 -2.47e+00 -4.16e-02  1.15e-02]
 [ 5.82e-03 -5.48e-03  1.31e+00  2.43e-02 -6.22e-03]
 [-1.51e-03  2.02e-03 -8.02e-02 -4.74e-03  1.15e-03]]
SymNet parameters
[[-2.51e+00  1.14e-01  4.80e-01  1.01e-01 -4.49e-02  2.11e-02  1.21e+00  4.34e-02
  -4.48e-01  6.49e-03  2.80e-02 -4.40e-02]
 [ 6.18e-02 -3.02e-01  3.62e+00 -1.63e-03  1.87e-01 -2.88e-01 -1.65e-01  5.34e-02
  -1.76e-01 -1.63e-02 -8.60e-03  4.87e-02]]
SymNet parameters
[-0.09 -0.14]
SymNet parameters
[[ 3.03e-01 -4.78e-02  4.22e+00 -3.62e-01 -1.03e-01 -6.20e-02 -1.78e+00  1.68e-01
  -5.31e-02 -5.10e-03 -2.91e-02  1.90e-02  2.93e-02]
 [ 3.22e-03  2.58e-04 -1.34e-03 -9.96e-04  2.92e-04  1.60e-04  3.76e-02 -2.08e-03
  -1.90e-04  1.64e-05 -1.16e-04  7.78e-05  2.85e-05]]
SymNet parameters
[ 0.1  -0.24]
SymNet parameters
[[ 1.83e+00  9.52e-02 -1.10e-01  3.49e-02 -2.84e-03 -6.46e-03 -1.83e-01 -1.00e-02
  -6.67e-03 -5.42e-04  3.40e-03 -3.63e-04 -3.79e-04 -5.72e-02]
 [-9.66e-02 -4.90e-01 -3.50e-02  1.18e-01 -1.05e-02 -9.12e-03  7.72e-01 -6.59e-02
   2.88e-03  1.73e-03  8.42e-03 -6.86e-03 -1.38e-03 -3.74e-01]]
SymNet parameters
[0.39 0.48]
SymNet parameters
[[ 4.00e-02  3.55e-02  1.56e+00 -4.36e-02  3.67e-02  2.47e-02 -4.59e-01  4.90e-02
  -3.05e-03 -2.16e-04 -1.63e-03  2.61e-03  1.37e-02  1.57e-02 -4.04e-03]
 [-4.21e-01 -4.44e-03  1.04e-01  9.83e-03 -5.57e-03 -2.27e-03 -1.50e+00 -3.75e-02
  -1.11e-02  7.79e-04  2.63e-05 -6.26e-04  3.09e-05  3.13e-02  4.02e-03]]
SymNet parameters
[-0.11  0.94]
SymNet parameters
[[-1.34e-01  1.20e+00  1.55e+00  1.59e-01 -9.01e-02 -7.06e-02  1.38e+00 -1.14e-01
  -1.68e-02  1.00e-03  9.43e-03 -8.57e-03  2.08e-03  1.14e+00 -5.38e-04  9.20e-02]
 [ 1.67e+00 -9.86e-02  1.90e-01  5.79e-03 -6.60e-03 -4.00e-03  4.25e-01 -1.67e-02
   3.70e-03 -4.02e-04  5.76e-04 -1.13e-03  2.34e-05  7.66e-02  5.46e-02  2.68e-02]]
SymNet parameters
[0.88 0.54]
SymNet parameters
[[-2.98e-01  2.10e-01 -1.37e+00  1.50e-01  1.32e-02  5.48e-02  7.25e-01 -6.30e-02
   1.45e-02  1.17e-03  6.30e-03 -5.14e-03 -1.49e-02 -1.01e+00  5.70e-01  2.67e-01
  -2.16e-01]]
SymNet parameters
[-0.01]
SymNet parameters
[[ 1.18e+00  5.66e-01 -9.27e-01  1.70e-01  1.96e-01 -1.58e-01 -1.15e+00 -2.09e+00
  -2.68e-01  5.46e-01  2.11e+00  1.11e+00]
 [-4.14e-03 -1.39e-04 -4.19e-05  3.13e-05 -1.91e-05  3.37e-05 -2.45e-04 -4.13e-04
   1.78e-04 -2.45e-04  1.27e-05 -3.64e-04]]
SymNet parameters
[-0.07  0.06]
SymNet parameters
[[ 2.57e-01  9.36e-03 -3.38e-01  3.52e-02  4.03e-02 -4.34e-02 -3.18e-01 -4.29e-01
   2.20e-01  7.45e-02  1.29e-01  2.15e-01 -9.79e-01]
 [ 2.95e+00  2.88e-01  8.25e-01 -7.57e-02  1.07e-02  2.27e-03  2.19e-01  1.59e+00
  -1.47e+00 -6.49e-02 -2.96e-01  3.70e-01  1.16e-01]]
SymNet parameters
[-0.3  -0.25]
SymNet parameters
[[-1.15e+00 -4.11e-02 -7.20e-02  8.69e-03  6.24e-03 -8.51e-03 -4.79e-01 -2.46e-01
   3.27e-01  2.03e-02  8.31e-02  4.71e-02 -3.91e-01  2.05e-03]
 [-4.36e-02  3.57e-02  8.23e-02 -1.05e-02 -8.61e-03  1.03e-02 -2.04e-02  2.61e+00
  -4.84e-02 -2.54e-02 -1.03e-01 -5.96e-02  3.41e-01 -7.75e-03]]
SymNet parameters
[ 0.63 -1.04]
SymNet parameters
[[-1.81e-01  4.91e-02 -5.94e-03  3.79e-03  6.41e-03 -5.88e-03 -2.11e+00 -1.06e+00
   1.97e-01  1.81e-02  6.09e-02  2.38e-02 -4.56e-01 -6.95e-04  1.53e-02]
 [-8.71e-02  2.60e-01  1.10e-01 -5.09e-03  1.01e-02  4.57e-03  6.03e-01  6.32e-01
  -1.74e+00  1.92e-02  5.15e-02  7.61e-03 -1.20e+00 -1.89e-02  1.94e-02]]
SymNet parameters
[0.43 0.01]
SymNet parameters
[[ 4.10e-01  5.73e-02  5.41e-02 -2.78e-03 -3.81e-03  1.13e-02 -2.01e+00  5.67e-01
  -4.26e-01 -1.00e-02 -3.67e-02 -1.94e-02 -1.94e-02  4.19e-03 -5.55e-02  2.23e-02]
 [ 1.27e-02  7.27e-02  1.18e-01 -1.45e-02 -9.94e-03  1.48e-02  3.78e-01  2.17e-01
   3.43e-01 -3.21e-02 -1.33e-01 -7.49e-02  6.49e-01  5.24e-03  2.80e-04 -2.43e-04]]
SymNet parameters
[ 0.31 -0.31]
SymNet parameters
[[-4.65e-01 -5.33e-02  4.01e-02 -9.26e-03 -1.27e-02  9.62e-03 -2.99e-01 -3.63e-01
  -8.38e-02  2.08e-02 -1.19e-01 -1.45e-02  1.02e+00 -1.23e-04  3.30e-01 -1.74e-01
   3.93e-01]]
SymNet parameters
[0.26]
finally, finish this stage
iter:     0    time: 38.96
Func: 7.15e-01  |g|: 1.64e+02
stableloss: 3.92e-02   dataloss: 6.75e-01   sparseloss: 9.32e+01 momentloss: 6.54e+00
current expression:
[u10*v00, u00*u01, u20, u02, u00*u01**2, u00*u10*v01, u10*v00*v10, u00*u11*v00, u01*u10*v00, 1, u00*u10, u10*v01, u00, v00, u20*v00**2, v00**2, u01, v10, u00*v00*v10, u01**2]
[-0.98 -0.97  0.05  0.05  0.01  0.01  0.01  0.01  0.01 -0.01  0.    0.    0.    0.
  0.    0.   -0.   -0.   -0.    0.  ]
[v00*v10, u00*v01, v02, v20, v00, v00*v10**2, u00*v01*v10, u00, u00*v00*v11, u00*u01*v01, u10*v00*v01, v00**3, u10*v00*v10, v00**2*v01, v00**2*v10, v01, u01*v01, u00**2*v00, u00*u10*v01, u00*v10]
[-0.98 -0.97  0.05  0.05  0.02  0.01  0.01 -0.01  0.01  0.01  0.01 -0.   -0.   -0.
  0.    0.    0.   -0.    0.    0.  ]
block:  9
name:  burgers-2-upwind-sparse0-noise0.001-id8
device:  cuda:0
generate a random number to check random seed:  -2.314844343803398
current stage is: block-9
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.9324, device='cuda:0', dtype=torch.float64)
u_obs variance
tensor([ 0.2677,  1.7998,  1.8556, 23.2538, 11.4846, 22.1013,  0.2567,  1.6659,
         1.8239, 19.1425, 10.7339, 24.7760], device='cuda:0',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 1.868254
         Iterations: 0
         Function evaluations: 15
         Gradient evaluations: 3
convolution moment and kernels
[[ 1.00e+00  0.00e+00  1.43e-04 -3.82e-02 -4.26e-02]
 [ 0.00e+00  3.02e-05  2.22e-03  1.27e-03  9.46e-04]
 [ 8.93e-05  6.54e-04  2.38e-03 -1.33e-03  1.78e-03]
 [-3.33e-03 -5.70e-04  1.75e-03 -3.68e-04 -9.75e-03]
 [-7.08e-02  4.64e-03 -4.10e-03  3.12e-03  8.78e-03]]
[[ 0.01 -0.06  0.02 -0.06  0.02]
 [-0.04  0.2  -0.03  0.2  -0.05]
 [ 0.02 -0.1   0.68 -0.03 -0.  ]
 [-0.02  0.11  0.1   0.12 -0.03]
 [ 0.   -0.02 -0.04 -0.02  0.01]]
[[ 0.00e+00  1.00e+00  0.00e+00 -1.15e-01 -6.06e-02]
 [ 0.00e+00  0.00e+00  2.02e-03  4.28e-04 -3.54e-04]
 [ 0.00e+00  2.75e-02  8.56e-04  1.28e-02 -2.88e-03]
 [-1.21e-03  3.12e-03 -3.84e-03 -1.14e-03 -3.86e-03]
 [ 1.26e-02 -5.29e-03 -6.92e-04 -8.92e-03  7.49e-04]]
[[ 0.01 -0.01  0.03 -0.01 -0.  ]
 [-0.03  0.05 -0.11  0.03  0.01]
 [ 0.13 -0.61 -0.2   0.99 -0.22]
 [-0.03  0.04 -0.09  0.01  0.02]
 [ 0.   -0.01  0.01  0.01 -0.01]]
[[ 0.00e+00  0.00e+00  0.00e+00 -3.60e-03  8.13e-03]
 [ 1.00e+00  0.00e+00  1.98e-02  6.04e-04 -7.57e-03]
 [ 0.00e+00  3.78e-04  7.78e-03 -3.39e-03 -1.69e-03]
 [-1.03e-01 -2.06e-03  8.12e-03  2.03e-03 -1.07e-02]
 [-5.80e-02  7.28e-03 -6.16e-03  1.29e-03 -3.51e-03]]
[[ 0.   -0.02  0.11 -0.01  0.  ]
 [ 0.01  0.03 -0.58  0.    0.  ]
 [-0.01 -0.06 -0.26 -0.02 -0.  ]
 [ 0.02 -0.01  1.01 -0.02  0.01]
 [-0.01  0.02 -0.23  0.03 -0.01]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00  3.10e-03]
 [ 0.00e+00  0.00e+00  0.00e+00  6.43e-04 -3.38e-03]
 [ 0.00e+00  0.00e+00  1.16e-03 -1.43e-03  5.91e-04]
 [ 0.00e+00 -8.41e-04 -1.94e-03  5.46e-04  1.83e-03]
 [ 5.22e-03 -1.80e-03 -5.00e-04  2.95e-03 -4.75e-03]]
[[-7.57e-03  2.83e-02 -3.17e-02  2.07e-02 -4.49e-03]
 [ 3.11e-02 -1.11e-01  1.18e-01 -7.56e-02  1.64e-02]
 [-1.21e-01  1.46e+00 -2.62e+00  1.40e+00 -9.82e-02]
 [ 2.28e-02 -7.47e-02  5.97e-02 -3.64e-02  7.68e-03]
 [-5.30e-03  1.71e-02 -1.25e-02  7.56e-03 -1.64e-03]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  5.59e-04]
 [ 0.00e+00  1.00e+00  0.00e+00 -1.84e-03 -4.85e-03]
 [ 0.00e+00  0.00e+00  7.02e-04  1.57e-03 -1.60e-03]
 [ 0.00e+00 -1.89e-03 -2.22e-03  3.07e-03  5.63e-03]
 [ 6.41e-04  6.21e-03 -1.12e-03 -4.44e-03  1.86e-03]]
[[ 9.45e-03 -6.18e-02 -6.52e-03  7.14e-02 -1.19e-02]
 [-7.08e-02  4.94e-01 -1.49e-02 -4.79e-01  6.89e-02]
 [ 3.48e-02 -1.30e-01  1.19e-01 -1.88e-02 -1.96e-03]
 [ 2.68e-02 -3.30e-01 -1.32e-01  4.98e-01 -6.49e-02]
 [ 3.44e-04  2.52e-02  3.77e-02 -7.31e-02  1.05e-02]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  6.28e-03]
 [ 0.00e+00  0.00e+00  0.00e+00  7.56e-04 -3.18e-03]
 [ 1.00e+00  0.00e+00  1.98e-03 -1.32e-03 -1.56e-03]
 [ 0.00e+00 -1.89e-05 -1.72e-03 -3.36e-04  1.71e-03]
 [ 9.09e-05 -1.43e-03 -1.07e-03  2.54e-03 -1.61e-03]]
[[-4.12e-03  1.37e-02 -9.79e-02  6.05e-03 -1.00e-03]
 [ 1.46e-02 -4.24e-02  1.37e+00 -9.22e-03  8.82e-04]
 [-8.50e-03  6.96e-03 -2.47e+00 -4.16e-02  1.15e-02]
 [ 5.82e-03 -5.48e-03  1.31e+00  2.43e-02 -6.22e-03]
 [-1.51e-03  2.02e-03 -8.02e-02 -4.74e-03  1.15e-03]]
SymNet parameters
[[-2.51e+00  1.14e-01  4.80e-01  1.01e-01 -4.49e-02  2.11e-02  1.21e+00  4.34e-02
  -4.48e-01  6.49e-03  2.80e-02 -4.40e-02]
 [ 6.18e-02 -3.02e-01  3.62e+00 -1.63e-03  1.87e-01 -2.88e-01 -1.65e-01  5.34e-02
  -1.76e-01 -1.63e-02 -8.60e-03  4.87e-02]]
SymNet parameters
[-0.09 -0.14]
SymNet parameters
[[ 3.03e-01 -4.78e-02  4.22e+00 -3.62e-01 -1.03e-01 -6.20e-02 -1.78e+00  1.68e-01
  -5.31e-02 -5.10e-03 -2.91e-02  1.90e-02  2.93e-02]
 [ 3.23e-03  2.52e-04 -1.34e-03 -8.77e-04  2.40e-04  2.34e-04  3.76e-02 -2.08e-03
  -1.98e-04 -2.04e-05 -8.72e-05  4.22e-05  4.48e-04]]
SymNet parameters
[ 0.1  -0.24]
SymNet parameters
[[ 1.83e+00  9.52e-02 -1.10e-01  3.50e-02 -2.84e-03 -6.46e-03 -1.83e-01 -1.00e-02
  -6.67e-03 -5.45e-04  3.40e-03 -3.66e-04 -3.96e-04 -5.72e-02]
 [-9.66e-02 -4.90e-01 -3.50e-02  1.18e-01 -1.05e-02 -9.12e-03  7.72e-01 -6.59e-02
   2.88e-03  1.73e-03  8.42e-03 -6.87e-03 -1.37e-03 -3.74e-01]]
SymNet parameters
[0.39 0.48]
SymNet parameters
[[ 4.00e-02  3.55e-02  1.56e+00 -4.36e-02  3.67e-02  2.47e-02 -4.59e-01  4.90e-02
  -3.05e-03 -2.11e-04 -1.63e-03  2.62e-03  1.38e-02  1.57e-02 -4.04e-03]
 [-4.21e-01 -4.44e-03  1.04e-01  9.83e-03 -5.57e-03 -2.28e-03 -1.50e+00 -3.75e-02
  -1.11e-02  7.80e-04  2.62e-05 -6.24e-04  3.79e-05  3.13e-02  4.02e-03]]
SymNet parameters
[-0.11  0.94]
SymNet parameters
[[-1.34e-01  1.20e+00  1.55e+00  1.59e-01 -9.01e-02 -7.06e-02  1.38e+00 -1.14e-01
  -1.68e-02  1.00e-03  9.43e-03 -8.57e-03  2.09e-03  1.14e+00 -5.40e-04  9.20e-02]
 [ 1.67e+00 -9.86e-02  1.90e-01  5.78e-03 -6.60e-03 -4.00e-03  4.25e-01 -1.67e-02
   3.70e-03 -3.99e-04  5.75e-04 -1.12e-03  2.90e-05  7.66e-02  5.46e-02  2.68e-02]]
SymNet parameters
[0.88 0.54]
SymNet parameters
[[-2.98e-01  2.10e-01 -1.37e+00  1.50e-01  1.32e-02  5.48e-02  7.25e-01 -6.30e-02
   1.45e-02  1.17e-03  6.30e-03 -5.14e-03 -1.49e-02 -1.01e+00  5.70e-01  2.67e-01
  -2.16e-01]]
SymNet parameters
[-0.01]
SymNet parameters
[[ 1.18e+00  5.66e-01 -9.27e-01  1.70e-01  1.96e-01 -1.58e-01 -1.15e+00 -2.09e+00
  -2.68e-01  5.46e-01  2.11e+00  1.11e+00]
 [-4.12e-03 -1.63e-04 -4.96e-05 -2.90e-05 -5.04e-06 -9.94e-06 -2.39e-04 -4.50e-04
   2.18e-04 -7.41e-05  3.76e-05 -5.69e-05]]
SymNet parameters
[-0.07  0.06]
SymNet parameters
[[ 2.57e-01  9.36e-03 -3.38e-01  3.52e-02  4.03e-02 -4.34e-02 -3.18e-01 -4.29e-01
   2.20e-01  7.45e-02  1.29e-01  2.15e-01 -9.79e-01]
 [ 2.95e+00  2.88e-01  8.25e-01 -7.57e-02  1.07e-02  2.27e-03  2.19e-01  1.59e+00
  -1.47e+00 -6.49e-02 -2.96e-01  3.70e-01  1.16e-01]]
SymNet parameters
[-0.3  -0.25]
SymNet parameters
[[-1.15e+00 -4.11e-02 -7.20e-02  8.70e-03  6.24e-03 -8.51e-03 -4.79e-01 -2.46e-01
   3.27e-01  2.03e-02  8.31e-02  4.71e-02 -3.91e-01  2.04e-03]
 [-4.36e-02  3.57e-02  8.23e-02 -1.05e-02 -8.61e-03  1.03e-02 -2.04e-02  2.61e+00
  -4.84e-02 -2.54e-02 -1.03e-01 -5.96e-02  3.41e-01 -7.74e-03]]
SymNet parameters
[ 0.63 -1.04]
SymNet parameters
[[-1.81e-01  4.91e-02 -5.94e-03  3.79e-03  6.41e-03 -5.88e-03 -2.11e+00 -1.06e+00
   1.97e-01  1.81e-02  6.09e-02  2.38e-02 -4.56e-01 -6.88e-04  1.53e-02]
 [-8.71e-02  2.60e-01  1.10e-01 -5.08e-03  1.01e-02  4.57e-03  6.03e-01  6.32e-01
  -1.74e+00  1.92e-02  5.15e-02  7.61e-03 -1.20e+00 -1.89e-02  1.94e-02]]
SymNet parameters
[0.43 0.01]
SymNet parameters
[[ 4.10e-01  5.73e-02  5.41e-02 -2.78e-03 -3.81e-03  1.13e-02 -2.01e+00  5.67e-01
  -4.26e-01 -1.00e-02 -3.67e-02 -1.94e-02 -1.94e-02  4.19e-03 -5.55e-02  2.23e-02]
 [ 1.27e-02  7.27e-02  1.18e-01 -1.45e-02 -9.94e-03  1.48e-02  3.78e-01  2.17e-01
   3.43e-01 -3.21e-02 -1.33e-01 -7.49e-02  6.49e-01  5.24e-03  2.69e-04 -2.53e-04]]
SymNet parameters
[ 0.31 -0.31]
SymNet parameters
[[-4.65e-01 -5.33e-02  4.01e-02 -9.26e-03 -1.27e-02  9.62e-03 -2.99e-01 -3.63e-01
  -8.38e-02  2.08e-02 -1.19e-01 -1.45e-02  1.02e+00 -1.27e-04  3.30e-01 -1.74e-01
   3.93e-01]]
SymNet parameters
[0.26]
finally, finish this stage
iter:     0    time: 41.17
Func: 1.87e+00  |g|: 5.53e+02
stableloss: 7.42e-02   dataloss: 1.81e+00   sparseloss: 9.32e+01 momentloss: 6.54e+00
current expression:
[u10*v00, u00*u01, u20, u02, u00*u01**2, u00*u10*v01, u10*v00*v10, u00*u11*v00, u01*u10*v00, 1, u00*u10, u10*v01, u00, v00, u20*v00**2, v00**2, u01, v10, u00*v00*v10, u01**2]
[-0.98 -0.97  0.05  0.05  0.01  0.01  0.01  0.01  0.01 -0.01  0.    0.    0.    0.
  0.    0.   -0.   -0.   -0.    0.  ]
[v00*v10, u00*v01, v02, v20, v00, v00*v10**2, u00*v01*v10, u00, u00*v00*v11, u00*u01*v01, u10*v00*v01, v00**3, u10*v00*v10, v00**2*v01, v00**2*v10, v01, u01*v01, u00**2*v00, u00*u10*v01, u00*v10]
[-0.98 -0.97  0.05  0.05  0.02  0.01  0.01 -0.01  0.01  0.01  0.01 -0.   -0.   -0.
  0.    0.    0.   -0.    0.    0.  ]
u_obs.abs().max()
tensor(3.8980, device='cuda:0', dtype=torch.float64)
model(u_obs[0],T=50*dt).abs().max()
tensor(nan, device='cuda:0', dtype=torch.float64)
model(u_obs[0],T=100*dt).abs().max()
tensor(nan, device='cuda:0', dtype=torch.float64)
{'--name': 'burgers-2-upwind-sparse0-noise0.001-id9', '--dtype': 'double', '--device': 'cuda:1', '--constraint': '2', '--dt': 0.01, '--cell_num': 1, '--eps': 6.283185307179586, '--blocks': [0, 1, 2, 3, 4, 5, 6, 9], '--kernel_size': 5, '--max_order': 2, '--dx': 0.19634954084936207, '--hidden_layers': 5, '--scheme': 'upwind', '--dataname': 'burgers', '--viscosity': 0.05, '--zoom': 4, '--max_dt': 0.000625, '--batch_size': 28, '--data_timescheme': 'rk2', '--channel_names': 'u,v', '--freq': 4, '--data_start_time': 1.0, '--start_noise': 0.001, '--end_noise': 0.001, '--stablize': 0.0, '--sparsity': 0.0, '--momentsparsity': 0.001, '--npseed': -1, '--torchseed': -1, '--maxiter': 2000, '--recordfile': 'None', '--recordcycle': 200, '--savecycle': -1, '--start_from': -1}
block:  0
name:  burgers-2-upwind-sparse0-noise0.001-id9
device:  cuda:1
generate a random number to check random seed:  1.1252427871041624
current stage is: warmup
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.8214, device='cuda:1', dtype=torch.float64)
u_obs variance
tensor([ 0.2688,  2.2475,  2.1638, 20.8358, 11.1646, 18.8486,  0.2658,  2.0935,
         2.2127, 18.2126, 11.1428, 20.5197], device='cuda:1',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
iter:     0    time: 6.24
Func: 6.20e+00  |g|: 2.82e+00
stableloss: 1.94e-03   dataloss: 6.20e+00   sparseloss: 2.65e+01 momentloss: 7.27e+00
iter:   200    time: 13.75
Func: 4.17e-02  |g|: 4.61e-02
stableloss: 1.65e-02   dataloss: 4.17e-02   sparseloss: 5.41e+01 momentloss: 7.27e+00
iter:   400    time: 10.37
Func: 3.94e-02  |g|: 1.76e-02
stableloss: 1.66e-02   dataloss: 3.94e-02   sparseloss: 6.59e+01 momentloss: 7.27e+00
iter:   600    time: 9.52
Func: 3.85e-02  |g|: 2.82e-02
stableloss: 1.70e-02   dataloss: 3.85e-02   sparseloss: 7.28e+01 momentloss: 7.27e+00
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 0.038332
         Iterations: 658
         Function evaluations: 736
         Gradient evaluations: 729
convolution moment and kernels
[[1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
[[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 1. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
[[ 0.    1.    0.   -0.33 -0.25]
 [ 0.    0.    0.    0.    0.  ]
 [ 0.    0.    0.    0.    0.  ]
 [ 0.    0.    0.    0.    0.  ]
 [ 0.    0.    0.    0.    0.  ]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]
 [ 2.78e-17  3.33e-16 -1.50e+00  2.00e+00 -5.00e-01]
 [ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]]
[[ 0.    0.    0.    0.    0.  ]
 [ 1.    0.    0.    0.    0.  ]
 [ 0.    0.    0.    0.    0.  ]
 [-0.33  0.    0.    0.    0.  ]
 [-0.25  0.    0.    0.    0.  ]]
[[ 0.00e+00  0.00e+00  2.78e-17  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  3.33e-16  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00 -1.50e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  2.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00 -5.00e-01  0.00e+00  0.00e+00]]
[[0.   0.   1.   0.   0.08]
 [0.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.  ]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]
 [-2.22e-16  1.00e+00 -2.00e+00  1.00e+00 -1.53e-16]
 [ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]]
[[0. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
[[ 6.94e-03 -5.56e-02  9.25e-18  5.56e-02 -6.94e-03]
 [-5.56e-02  4.44e-01 -7.40e-17 -4.44e-01  5.56e-02]
 [ 9.25e-18 -7.40e-17  1.23e-32  7.40e-17 -9.25e-18]
 [ 5.56e-02 -4.44e-01  7.40e-17  4.44e-01 -5.56e-02]
 [-6.94e-03  5.56e-02 -9.25e-18 -5.56e-02  6.94e-03]]
[[0.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.  ]
 [1.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.  ]
 [0.08 0.   0.   0.   0.  ]]
[[ 0.00e+00  0.00e+00 -2.22e-16  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  1.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00 -2.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  1.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00 -1.53e-16  0.00e+00  0.00e+00]]
SymNet parameters
[[ 2.53e+00  7.66e-02 -3.95e-01  1.97e-01  1.25e-01  3.83e-02  1.32e+00  6.88e-02
   1.33e-01 -2.45e-03  6.81e-03 -6.81e-04]
 [ 1.42e+00  1.34e-01  2.00e-01  6.33e-02  2.99e-02  1.92e-02 -5.84e-01  1.98e-02
   5.04e-02 -2.54e-03  3.21e-03 -1.57e-03]]
SymNet parameters
[ 0.1  -0.21]
SymNet parameters
[[-0.44  0.   -0.04 -0.05 -0.07  0.01 -0.22 -0.02 -0.01 -0.    0.   -0.01 -0.01]
 [ 0.79 -0.69 -0.22 -0.53 -0.32  0.25 -0.87 -0.3   0.24 -0.07  0.05 -0.1   0.02]]
SymNet parameters
[-0.05 -0.09]
SymNet parameters
[[ 1.75 -0.34  0.17 -0.43 -1.15  0.38 -0.79 -0.25  0.21 -0.09  0.12 -0.15  0.09 -0.1 ]
 [ 0.9  -1.46 -0.51 -0.34 -0.31  0.37  1.58 -0.25  0.49 -0.08  0.09 -0.13 -0.03  0.03]]
SymNet parameters
[ 0.19 -0.15]
SymNet parameters
[[-2.24e+00 -1.51e-01  2.36e-01 -2.54e-01 -1.93e-01  4.44e-02  7.95e-01 -1.16e-01
  -2.64e-02 -1.55e-02  1.55e-02 -2.98e-02  7.48e-03  3.63e-03  1.40e-03]
 [-1.93e+00  8.38e-02 -2.69e-01 -1.25e-01 -5.77e-02 -2.62e-02 -9.16e-01 -4.45e-02
  -7.86e-02  4.92e-04 -6.66e-03  1.58e-03  4.33e-03 -1.93e-02  5.39e-04]]
SymNet parameters
[-0.06  0.18]
SymNet parameters
[[ 0.49 -0.    0.18 -0.11 -0.01 -0.05 -0.21 -0.03 -0.11  0.01 -0.01  0.01 -0.05 -0.04
   0.    0.02]
 [ 0.86  1.28  0.42  0.15  0.26 -0.06 -0.26  0.08  0.02  0.01 -0.02  0.02  0.04 -0.03
  -0.   -0.05]]
SymNet parameters
[-0.   -0.02]
SymNet parameters
[[-0.11  0.06  0.07  0.06  0.01  0.01 -0.47  0.02 -0.03  0.01 -0.01  0.01 -1.05 -0.79
   0.03  0.83 -0.28]]
SymNet parameters
[-0.01]
SymNet parameters
[[ 1.32 -0.26  0.28  0.01 -0.03 -0.03 -1.62  0.55  0.69  0.21 -0.08 -0.56]
 [ 0.03 -0.19 -0.1   0.03 -0.02  0.03 -1.07 -0.2   0.08 -0.08 -0.04 -0.07]]
SymNet parameters
[-0.01 -0.11]
SymNet parameters
[[-2.02e-02  1.07e-01 -8.61e-02 -1.59e-02 -1.95e-02  2.90e-02 -1.72e+00  1.38e+00
   1.07e-01 -8.61e-03  1.68e-01 -5.54e-02 -7.16e-02]
 [-1.48e+00 -1.36e-01 -2.87e-03  1.01e-02  1.25e-03  1.14e-02  5.09e-01  9.15e-02
   9.03e-02 -8.02e-03 -4.28e-03  1.20e-02  8.69e-03]]
SymNet parameters
[ 0.17 -0.03]
SymNet parameters
[[-0.58  0.08 -0.   -0.01 -0.   -0.    0.13 -0.14 -0.3   0.01  0.02 -0.02 -0.01 -0.  ]
 [ 0.29  0.12  0.03 -0.01 -0.01 -0.01 -0.83 -0.56  1.11 -0.01 -0.    0.01 -0.    0.04]]
SymNet parameters
[-0.24  0.09]
SymNet parameters
[[ 3.58e-01  8.74e-02 -3.52e-01 -4.18e-02 -5.32e-02  1.21e-01 -5.82e-01 -2.23e-01
  -5.90e-02 -2.51e-02  5.74e-01 -1.97e-01 -1.72e-01 -4.46e-02 -1.11e-04]
 [ 1.32e+00  2.00e-02  2.55e-02 -1.63e-03 -9.50e-04  4.10e-04  1.03e-01 -1.66e-01
   1.05e-01 -4.01e-03 -1.18e-02  6.27e-03  6.25e-03  1.52e-02  1.39e-02]]
SymNet parameters
[ 0.1  -0.35]
SymNet parameters
[[ 8.08e-01  1.87e-01 -3.48e-02 -1.77e-02 -9.74e-03 -1.66e-03 -3.63e-01  2.66e-01
   1.23e+00  7.00e-03  7.37e-02 -3.58e-02 -1.22e-02 -7.93e-04  2.60e-02 -1.81e-02]
 [ 4.22e-01 -1.10e-01  1.20e-02  8.15e-03  6.57e-04  7.41e-03  1.08e+00 -2.78e-02
   3.38e-01 -1.42e-02 -2.30e-02  2.14e-02  9.57e-03  2.06e-02 -9.08e-03  5.79e-03]]
SymNet parameters
[0.29 0.24]
SymNet parameters
[[ 1.58e-01  4.16e-03 -1.96e-02 -4.23e-03 -3.39e-03  7.83e-03  2.21e-01  1.04e-01
   1.41e-02  3.41e-02  3.24e-02  2.90e-02  1.70e-04  2.99e-01 -6.08e-01  1.15e-01
  -4.98e-01]]
SymNet parameters
[0.03]
finally, finish this stage
iter:   658    time: 4.55
Func: 3.83e-02  |g|: 7.39e-03
stableloss: 1.68e-02   dataloss: 3.83e-02   sparseloss: 7.45e+01 momentloss: 7.27e+00
current expression:
[u00*u01, u10*v00, u00, u02, u20, u00**3, u00**2, v00, u00**2*u02, u00*u11*v00, u00*u01**2, u01*u10*v00, u00*v00**2, u00*v10, u00*v00, u00**2*v01, u00*u01*u10, v10, v00*v11, v01]
[-0.89 -0.88  0.05  0.04  0.04 -0.02  0.02  0.01 -0.01  0.01  0.01  0.01  0.01  0.01
  0.01 -0.    0.    0.   -0.    0.  ]
[v00*v10, u00*v01, v00, v20, v02, v00**3, v00**2*v20, u00*v00*v11, u00*u01*v01, v00*v10**2, u00*v01*v10, u00*v00**2, u00*v00, u00*u10*v00, u00, u00*v00**3, u00**2*v01, v00**2*v10, u00**2, u00*v00*v20]
[-0.88 -0.88  0.05  0.04  0.03 -0.02 -0.01  0.01  0.01  0.01  0.01  0.01  0.01 -0.
 -0.   -0.   -0.    0.   -0.    0.  ]
block:  1
name:  burgers-2-upwind-sparse0-noise0.001-id9
device:  cuda:1
generate a random number to check random seed:  -1.4363193555506175
current stage is: block-1
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.9305, device='cuda:1', dtype=torch.float64)
u_obs variance
tensor([ 0.2595,  2.1685,  2.0067, 19.9651,  9.9204, 17.3046,  0.2392,  1.8190,
         2.0178, 15.4741,  9.4712, 18.8830], device='cuda:1',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
iter:     0    time: 1305.61
Func: 4.91e-02  |g|: 1.37e+00
stableloss: 1.33e-02   dataloss: 4.18e-02   sparseloss: 7.45e+01 momentloss: 7.27e+00
iter:   200    time: 10.51
Func: 2.02e-02  |g|: 9.35e-02
stableloss: 7.85e-03   dataloss: 1.36e-02   sparseloss: 7.64e+01 momentloss: 6.62e+00
iter:   400    time: 10.43
Func: 1.94e-02  |g|: 1.68e-02
stableloss: 7.82e-03   dataloss: 1.28e-02   sparseloss: 8.53e+01 momentloss: 6.54e+00
iter:   600    time: 10.35
Func: 1.92e-02  |g|: 1.61e-02
stableloss: 7.82e-03   dataloss: 1.26e-02   sparseloss: 8.64e+01 momentloss: 6.53e+00
iter:   800    time: 10.39
Func: 1.90e-02  |g|: 1.06e-02
stableloss: 7.76e-03   dataloss: 1.25e-02   sparseloss: 8.99e+01 momentloss: 6.53e+00
iter:  1000    time: 10.36
Func: 1.89e-02  |g|: 1.04e-02
stableloss: 7.73e-03   dataloss: 1.24e-02   sparseloss: 9.21e+01 momentloss: 6.54e+00
iter:  1200    time: 10.38
Func: 1.89e-02  |g|: 1.64e-02
stableloss: 7.71e-03   dataloss: 1.23e-02   sparseloss: 9.94e+01 momentloss: 6.54e+00
iter:  1400    time: 10.37
Func: 1.88e-02  |g|: 3.47e-02
stableloss: 7.73e-03   dataloss: 1.23e-02   sparseloss: 1.10e+02 momentloss: 6.53e+00
iter:  1600    time: 10.42
Func: 1.88e-02  |g|: 3.29e-02
stableloss: 7.80e-03   dataloss: 1.23e-02   sparseloss: 1.14e+02 momentloss: 6.53e+00
iter:  1800    time: 10.37
Func: 1.88e-02  |g|: 4.32e-02
stableloss: 7.79e-03   dataloss: 1.23e-02   sparseloss: 1.23e+02 momentloss: 6.52e+00
Warning: Maximum number of iterations has been exceeded.
         Current function value: 0.018779
         Iterations: 2000
         Function evaluations: 2008
         Gradient evaluations: 2008
convolution moment and kernels
[[ 1.00e+00  0.00e+00  1.40e-04  4.36e-03 -4.50e-02]
 [ 0.00e+00 -9.93e-05  1.35e-03  6.48e-04 -3.28e-03]
 [ 2.93e-04 -5.11e-04  2.13e-03 -6.86e-04 -2.26e-03]
 [-2.16e-03  1.00e-04 -3.53e-03 -1.10e-03  9.48e-03]
 [-2.60e-02 -2.91e-03  2.06e-03  4.83e-03  6.82e-03]]
[[-0.    0.   -0.02 -0.01  0.  ]
 [-0.01  0.03  0.01  0.09 -0.03]
 [-0.02  0.05  0.84 -0.04  0.02]
 [-0.03  0.14 -0.14  0.19 -0.05]
 [ 0.01 -0.04  0.05 -0.05  0.01]]
[[ 0.00e+00  1.00e+00  0.00e+00 -1.00e-01 -6.62e-02]
 [ 0.00e+00  0.00e+00  3.28e-03 -6.87e-04  8.33e-03]
 [ 0.00e+00  1.99e-02  1.40e-03  2.78e-02 -1.16e-02]
 [-3.52e-03  6.79e-04 -3.54e-03 -1.56e-03  5.45e-03]
 [ 1.91e-02 -2.00e-02  4.82e-03 -9.34e-03 -1.31e-03]]
[[ 7.08e-04  2.22e-02 -1.02e-02  1.47e-02 -6.56e-03]
 [-3.62e-02  1.27e-02 -8.45e-02  8.81e-03  1.93e-02]
 [ 1.35e-01 -5.66e-01 -2.19e-01  9.93e-01 -2.29e-01]
 [-3.82e-02  3.02e-02 -1.05e-01  2.01e-02  1.97e-02]
 [ 5.89e-03 -1.41e-03  2.09e-02 -5.05e-03 -2.94e-03]]
[[ 0.00e+00  0.00e+00  0.00e+00  3.18e-04  1.02e-02]
 [ 1.00e+00  0.00e+00  4.32e-03 -3.22e-03 -4.31e-02]
 [ 0.00e+00 -2.19e-03  9.71e-04  1.31e-03 -3.95e-03]
 [-8.82e-02 -9.35e-04  2.96e-02  3.23e-03 -1.68e-02]
 [-6.79e-02 -2.56e-03 -4.69e-03  3.69e-03 -1.12e-03]]
[[ 0.   -0.04  0.13 -0.04  0.01]
 [ 0.01  0.01 -0.53  0.03  0.  ]
 [ 0.01 -0.07 -0.25 -0.12  0.03]
 [-0.    0.02  0.97  0.07 -0.02]
 [-0.01  0.04 -0.25  0.03 -0.  ]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00 -2.65e-03]
 [ 0.00e+00  0.00e+00  0.00e+00  5.27e-04  2.59e-03]
 [ 0.00e+00  0.00e+00  1.98e-03 -1.11e-03 -2.50e-04]
 [ 0.00e+00  1.88e-04  5.16e-04 -2.30e-04  3.96e-04]
 [ 5.22e-03  2.25e-03 -4.53e-04 -2.67e-05 -3.58e-03]]
[[-0.    0.01 -0.01  0.01 -0.  ]
 [ 0.01 -0.04  0.04 -0.05  0.01]
 [-0.11  1.41 -2.59  1.42 -0.11]
 [ 0.01 -0.05  0.06 -0.06  0.02]
 [-0.    0.01 -0.02  0.02 -0.  ]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00 -1.96e-03]
 [ 0.00e+00  1.00e+00  0.00e+00 -1.16e-03  2.41e-05]
 [ 0.00e+00  0.00e+00  5.47e-04 -1.12e-03 -9.52e-04]
 [ 0.00e+00 -1.18e-03  3.20e-04  1.75e-03 -6.31e-05]
 [-1.13e-03  7.06e-04 -8.56e-04  1.69e-03  2.15e-03]]
[[ 0.01 -0.07  0.02  0.05 -0.  ]
 [-0.06  0.49 -0.07 -0.4   0.04]
 [ 0.01 -0.05  0.09 -0.07  0.02]
 [ 0.05 -0.41 -0.06  0.5  -0.07]
 [-0.01  0.05  0.01 -0.07  0.01]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  2.21e-03]
 [ 0.00e+00  0.00e+00  0.00e+00  1.04e-04  2.11e-03]
 [ 1.00e+00  0.00e+00  1.63e-03  1.28e-04  3.84e-04]
 [ 0.00e+00 -4.42e-04  2.27e-03  3.09e-04 -2.16e-03]
 [-2.47e-04  2.73e-03  8.59e-04 -1.31e-03 -5.63e-03]]
[[-0.    0.01 -0.11  0.02 -0.01]
 [ 0.02 -0.06  1.45 -0.09  0.02]
 [-0.03  0.11 -2.7   0.15 -0.04]
 [ 0.02 -0.1   1.5  -0.12  0.03]
 [-0.01  0.03 -0.13  0.03 -0.01]]
SymNet parameters
[[ 2.59 -0.8   0.    0.32 -0.07  0.02  3.1  -0.14  0.29 -0.03  0.01  0.05]
 [ 2.31 -0.4   0.27  0.24 -0.04  0.01  0.37 -0.11  0.23 -0.02  0.01  0.04]]
SymNet parameters
[-0.09 -0.53]
SymNet parameters
[[-1.01e-01 -6.66e-02 -5.33e-02  4.38e-02 -1.22e-02  2.29e-03 -3.77e-02 -1.81e-02
   3.39e-02 -4.56e-03  1.27e-03  6.83e-03 -3.69e-04]
 [ 1.39e+00  3.71e-01 -3.24e-01 -2.90e-01 -4.62e-01  2.98e-02 -3.98e-01 -2.12e-01
   3.34e-01 -2.46e-02  2.14e-02 -9.94e-02 -7.98e-02]]
SymNet parameters
[-0.06 -0.06]
SymNet parameters
[[ 2.41  2.53 -0.48 -0.5  -1.46  0.03  1.98 -0.41  0.05 -0.13  0.02 -0.26 -0.17 -0.32]
 [ 1.02 -1.09 -0.05  0.45 -0.16  0.03  2.68 -0.24  0.52 -0.05  0.02  0.07  0.    0.03]]
SymNet parameters
[ 0.02 -0.06]
SymNet parameters
[[-3.52e+00  7.46e-01 -1.27e-01 -3.98e-01 -2.38e-02 -1.27e-02 -4.95e-01  1.36e-01
  -3.32e-01  2.44e-02 -1.20e-02 -7.78e-02 -1.27e-02 -8.54e-03  1.40e-04]
 [-2.00e+00  7.42e-01 -1.75e-01 -2.40e-01  7.94e-02 -1.33e-02 -2.37e+00  1.22e-01
  -2.45e-01  2.59e-02 -1.04e-02 -3.72e-02  4.19e-03 -1.12e-02  7.41e-04]]
SymNet parameters
[0.61 0.09]
SymNet parameters
[[ 1.58  0.77  0.47 -0.44 -0.07 -0.01 -0.79  0.13 -0.28  0.02 -0.01 -0.08 -0.27 -0.07
   0.01  0.2 ]
 [ 1.01  2.29  0.38 -0.38  0.01  0.05 -0.46 -0.22  0.87  0.05  0.05 -0.05  0.19  0.13
   0.   -0.21]]
SymNet parameters
[-0.2  -0.12]
SymNet parameters
[[-0.64  0.02  0.14  0.    0.04  0.05 -0.74  0.04 -0.08  0.01 -0.   -0.   -1.73 -1.27
   0.07  1.43 -0.05]]
SymNet parameters
[0.02]
SymNet parameters
[[ 3.47e+00 -1.18e-01  1.82e-01 -3.33e-03 -2.45e-02 -4.23e-02  1.04e+00  3.20e+00
   3.65e-02  2.21e-01 -4.40e-02 -3.97e-01]
 [-2.89e-01  1.09e+00 -7.14e-01  1.80e-02 -6.14e-02 -2.77e-02 -2.79e+00 -2.36e+00
   2.14e+00 -1.02e+00 -2.69e-01 -2.13e+00]]
SymNet parameters
[-0.07 -0.08]
SymNet parameters
[[ 9.93e-03 -1.04e-01  3.55e-03  1.41e-03  5.99e-04  4.39e-04  1.36e-01  2.61e+00
   3.12e-01  1.41e-02 -1.19e-02  2.42e-02  4.55e-04]
 [-2.03e+00 -5.54e-03  7.89e-03 -3.99e-05  6.27e-04 -5.70e-04  7.22e-02 -8.23e-03
  -6.43e-02 -3.57e-03 -8.82e-04 -4.12e-03 -1.15e-05]]
SymNet parameters
[ 0.27 -0.01]
SymNet parameters
[[-6.28e-01  1.17e-01  2.33e-02  2.19e-03 -9.09e-05 -1.51e-03 -1.52e+00  4.59e-02
  -1.98e+00 -7.15e-03 -2.81e-03 -3.76e-02  4.39e-04 -5.17e-02]
 [ 1.00e+00  9.37e-02 -2.71e-02 -8.34e-03 -1.82e-03  6.00e-05 -1.09e+00 -1.69e-02
   1.85e+00 -2.51e-03 -2.86e-03 -1.01e-03 -1.83e-04  5.15e-02]]
SymNet parameters
[-0.01  0.43]
SymNet parameters
[[ 1.19e-02 -1.66e-01  2.57e-03  2.94e-03  1.32e-03  9.99e-04  2.07e-01  4.22e+00
   5.04e-01  1.81e-02 -8.33e-03  3.26e-02  8.20e-04 -5.41e-04  3.37e-04]
 [ 2.21e+00  8.24e-03 -3.59e-03  4.41e-05 -8.87e-04  6.12e-04 -8.48e-02  5.45e-03
   7.39e-02  2.14e-03  5.19e-04  1.79e-03  1.99e-05 -1.62e-04  6.37e-05]]
SymNet parameters
[-0.01 -0.31]
SymNet parameters
[[ 9.22e-01  1.33e-01 -2.94e-02 -9.69e-03 -2.24e-03 -3.70e-04 -1.23e+00 -2.57e-01
   2.49e+00 -4.85e-03 -3.63e-03 -7.35e-03  1.42e-04 -2.74e-01  1.50e-03 -1.88e-01]
 [ 8.06e-01 -1.06e-01 -2.60e-02 -2.87e-03  9.96e-05  1.59e-03  1.61e+00  1.08e-01
   1.75e+00  6.80e-03  2.21e-03  3.81e-02 -6.37e-04  2.87e-01 -9.96e-04  1.31e-01]]
SymNet parameters
[0.64 0.03]
SymNet parameters
[[ 5.58e-02  9.17e-03 -6.64e-03 -6.35e-04  6.71e-05 -2.90e-04  1.89e-01 -2.33e-01
   1.04e-01  4.89e-02  9.62e-04  4.87e-02 -2.81e-04 -9.62e-02 -1.02e+00 -1.65e-01
  -8.58e-01]]
SymNet parameters
[0.01]
finally, finish this stage
iter:  2000    time: 10.46
Func: 1.88e-02  |g|: 4.37e-02
stableloss: 7.79e-03   dataloss: 1.23e-02   sparseloss: 1.23e+02 momentloss: 6.52e+00
current expression:
[u10*v00, u00*u01, u20, u02, u00, u00*u01**2, u01, u01*u10*v00, u10*v00*v10, u00*u11*v00, 1, u00**3, u00**2*v00, v00**2, u00**2*v00**2, v10, u01**2, u00**2*u01*v00, u00*u02, u10*v00*v01]
[-0.97 -0.97  0.05  0.05  0.02  0.01  0.01  0.01  0.01  0.01  0.01 -0.01 -0.   -0.
  0.   -0.   -0.   -0.    0.   -0.  ]
[v00*v10, u00*v01, v02, v20, v00*v10**2, u00*v01*v10, u10*v00*v01, u00*v00*v11, u00*u01*v01, v00, u00*v10, v00**3, u00*v00*v10, u00*v00*v01*v10, u10, v10*v20, v00*v20, u00**2*v20, u00**2*v00, v00**2*v01]
[-0.98 -0.98  0.05  0.05  0.01  0.01  0.01  0.01  0.01  0.01 -0.01 -0.    0.   -0.
 -0.   -0.    0.    0.    0.   -0.  ]
block:  2
name:  burgers-2-upwind-sparse0-noise0.001-id9
device:  cuda:1
generate a random number to check random seed:  0.020679435310346772
current stage is: block-2
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.9763, device='cuda:1', dtype=torch.float64)
u_obs variance
tensor([ 0.2541,  1.6609,  1.6007, 21.5484,  9.4994, 18.5140,  0.2530,  1.6793,
         1.6029, 19.7453,  9.5692, 20.3739], device='cuda:1',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 0.083488
         Iterations: 0
         Function evaluations: 15
         Gradient evaluations: 3
convolution moment and kernels
[[ 1.00e+00  0.00e+00  1.40e-04  4.36e-03 -4.50e-02]
 [ 0.00e+00 -9.93e-05  1.35e-03  6.48e-04 -3.28e-03]
 [ 2.93e-04 -5.11e-04  2.13e-03 -6.85e-04 -2.26e-03]
 [-2.16e-03  1.00e-04 -3.53e-03 -1.10e-03  9.48e-03]
 [-2.60e-02 -2.91e-03  2.06e-03  4.83e-03  6.82e-03]]
[[-0.    0.   -0.02 -0.01  0.  ]
 [-0.01  0.03  0.02  0.09 -0.03]
 [-0.02  0.05  0.83 -0.04  0.02]
 [-0.03  0.14 -0.14  0.19 -0.05]
 [ 0.01 -0.04  0.05 -0.05  0.01]]
[[ 0.00e+00  1.00e+00  0.00e+00 -1.00e-01 -6.62e-02]
 [ 0.00e+00  0.00e+00  3.28e-03 -6.87e-04  8.33e-03]
 [ 0.00e+00  1.99e-02  1.40e-03  2.78e-02 -1.16e-02]
 [-3.52e-03  6.79e-04 -3.54e-03 -1.56e-03  5.45e-03]
 [ 1.91e-02 -2.00e-02  4.83e-03 -9.34e-03 -1.31e-03]]
[[ 7.06e-04  2.22e-02 -1.02e-02  1.48e-02 -6.57e-03]
 [-3.62e-02  1.27e-02 -8.44e-02  8.77e-03  1.93e-02]
 [ 1.35e-01 -5.66e-01 -2.19e-01  9.93e-01 -2.29e-01]
 [-3.82e-02  3.02e-02 -1.05e-01  2.01e-02  1.97e-02]
 [ 5.89e-03 -1.40e-03  2.08e-02 -5.04e-03 -2.94e-03]]
[[ 0.00e+00  0.00e+00  0.00e+00  3.17e-04  1.02e-02]
 [ 1.00e+00  0.00e+00  4.32e-03 -3.22e-03 -4.31e-02]
 [ 0.00e+00 -2.19e-03  9.71e-04  1.31e-03 -3.95e-03]
 [-8.82e-02 -9.35e-04  2.96e-02  3.23e-03 -1.68e-02]
 [-6.79e-02 -2.56e-03 -4.69e-03  3.69e-03 -1.12e-03]]
[[ 0.   -0.04  0.13 -0.04  0.01]
 [ 0.01  0.01 -0.53  0.03  0.  ]
 [ 0.01 -0.07 -0.25 -0.12  0.03]
 [-0.    0.02  0.97  0.07 -0.02]
 [-0.01  0.04 -0.25  0.03 -0.  ]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00 -2.65e-03]
 [ 0.00e+00  0.00e+00  0.00e+00  5.27e-04  2.59e-03]
 [ 0.00e+00  0.00e+00  1.98e-03 -1.11e-03 -2.50e-04]
 [ 0.00e+00  1.88e-04  5.16e-04 -2.30e-04  3.96e-04]
 [ 5.22e-03  2.25e-03 -4.53e-04 -2.69e-05 -3.58e-03]]
[[-0.    0.01 -0.01  0.01 -0.  ]
 [ 0.01 -0.04  0.04 -0.05  0.01]
 [-0.11  1.41 -2.59  1.42 -0.11]
 [ 0.01 -0.05  0.06 -0.06  0.02]
 [-0.    0.01 -0.02  0.02 -0.  ]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00 -1.96e-03]
 [ 0.00e+00  1.00e+00  0.00e+00 -1.16e-03  2.41e-05]
 [ 0.00e+00  0.00e+00  5.47e-04 -1.12e-03 -9.52e-04]
 [ 0.00e+00 -1.18e-03  3.20e-04  1.75e-03 -6.31e-05]
 [-1.13e-03  7.06e-04 -8.56e-04  1.69e-03  2.15e-03]]
[[ 0.01 -0.07  0.02  0.05 -0.  ]
 [-0.06  0.49 -0.07 -0.4   0.04]
 [ 0.01 -0.05  0.09 -0.07  0.02]
 [ 0.05 -0.41 -0.06  0.5  -0.07]
 [-0.01  0.05  0.01 -0.07  0.01]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  2.21e-03]
 [ 0.00e+00  0.00e+00  0.00e+00  1.04e-04  2.11e-03]
 [ 1.00e+00  0.00e+00  1.63e-03  1.28e-04  3.84e-04]
 [ 0.00e+00 -4.42e-04  2.27e-03  3.09e-04 -2.16e-03]
 [-2.47e-04  2.73e-03  8.59e-04 -1.31e-03 -5.63e-03]]
[[-0.    0.01 -0.11  0.02 -0.01]
 [ 0.02 -0.06  1.45 -0.09  0.02]
 [-0.03  0.11 -2.7   0.15 -0.04]
 [ 0.02 -0.1   1.5  -0.12  0.03]
 [-0.01  0.03 -0.13  0.03 -0.01]]
SymNet parameters
[[ 2.59 -0.8   0.    0.32 -0.07  0.02  3.1  -0.14  0.29 -0.03  0.01  0.05]
 [ 2.31 -0.4   0.27  0.24 -0.04  0.01  0.37 -0.11  0.23 -0.02  0.01  0.04]]
SymNet parameters
[-0.09 -0.53]
SymNet parameters
[[-1.01e-01 -6.66e-02 -5.33e-02  4.38e-02 -1.22e-02  2.29e-03 -3.77e-02 -1.81e-02
   3.39e-02 -4.57e-03  1.27e-03  6.82e-03 -6.35e-04]
 [ 1.39e+00  3.71e-01 -3.24e-01 -2.90e-01 -4.62e-01  2.98e-02 -3.98e-01 -2.12e-01
   3.34e-01 -2.46e-02  2.14e-02 -9.94e-02 -7.98e-02]]
SymNet parameters
[-0.06 -0.06]
SymNet parameters
[[ 2.41  2.53 -0.48 -0.5  -1.46  0.03  1.98 -0.41  0.05 -0.13  0.02 -0.26 -0.17 -0.32]
 [ 1.02 -1.09 -0.05  0.45 -0.16  0.03  2.68 -0.24  0.52 -0.05  0.02  0.07  0.    0.03]]
SymNet parameters
[ 0.02 -0.06]
SymNet parameters
[[-3.52e+00  7.46e-01 -1.27e-01 -3.98e-01 -2.38e-02 -1.27e-02 -4.95e-01  1.36e-01
  -3.32e-01  2.43e-02 -1.20e-02 -7.78e-02 -1.27e-02 -8.53e-03 -9.87e-04]
 [-2.00e+00  7.42e-01 -1.75e-01 -2.40e-01  7.94e-02 -1.34e-02 -2.37e+00  1.22e-01
  -2.45e-01  2.58e-02 -1.04e-02 -3.72e-02  4.30e-03 -1.12e-02 -1.66e-04]]
SymNet parameters
[0.61 0.09]
SymNet parameters
[[ 1.58  0.77  0.47 -0.44 -0.07 -0.01 -0.79  0.13 -0.28  0.02 -0.01 -0.08 -0.27 -0.07
   0.01  0.2 ]
 [ 1.01  2.29  0.38 -0.38  0.01  0.05 -0.46 -0.22  0.87  0.05  0.05 -0.05  0.19  0.13
   0.   -0.21]]
SymNet parameters
[-0.2  -0.12]
SymNet parameters
[[-0.64  0.02  0.14  0.    0.04  0.05 -0.74  0.04 -0.08  0.01 -0.   -0.   -1.73 -1.27
   0.07  1.43 -0.05]]
SymNet parameters
[0.02]
SymNet parameters
[[ 3.47e+00 -1.18e-01  1.82e-01 -3.33e-03 -2.45e-02 -4.23e-02  1.04e+00  3.20e+00
   3.65e-02  2.21e-01 -4.40e-02 -3.97e-01]
 [-2.89e-01  1.09e+00 -7.14e-01  1.80e-02 -6.14e-02 -2.77e-02 -2.79e+00 -2.36e+00
   2.14e+00 -1.02e+00 -2.69e-01 -2.13e+00]]
SymNet parameters
[-0.07 -0.08]
SymNet parameters
[[ 9.94e-03 -1.04e-01  3.55e-03  1.41e-03  6.01e-04  4.36e-04  1.36e-01  2.61e+00
   3.12e-01  1.41e-02 -1.19e-02  2.42e-02  5.59e-04]
 [-2.03e+00 -5.54e-03  7.89e-03 -4.02e-05  6.29e-04 -5.67e-04  7.22e-02 -8.24e-03
  -6.43e-02 -3.57e-03 -8.80e-04 -4.13e-03 -1.09e-04]]
SymNet parameters
[ 0.27 -0.01]
SymNet parameters
[[-6.28e-01  1.17e-01  2.34e-02  2.19e-03 -9.22e-05 -1.51e-03 -1.52e+00  4.59e-02
  -1.98e+00 -7.14e-03 -2.81e-03 -3.76e-02  2.16e-04 -5.17e-02]
 [ 1.00e+00  9.37e-02 -2.71e-02 -8.34e-03 -1.82e-03  5.70e-05 -1.09e+00 -1.69e-02
   1.85e+00 -2.50e-03 -2.86e-03 -1.01e-03  2.78e-05  5.15e-02]]
SymNet parameters
[-0.01  0.43]
SymNet parameters
[[ 1.19e-02 -1.66e-01  2.57e-03  2.94e-03  1.31e-03  1.00e-03  2.07e-01  4.22e+00
   5.04e-01  1.81e-02 -8.33e-03  3.26e-02  7.56e-04 -5.38e-04  2.94e-04]
 [ 2.21e+00  8.24e-03 -3.59e-03  4.41e-05 -8.85e-04  6.14e-04 -8.48e-02  5.45e-03
   7.39e-02  2.13e-03  5.20e-04  1.78e-03 -7.01e-05 -1.62e-04 -5.63e-06]]
SymNet parameters
[-0.01 -0.31]
SymNet parameters
[[ 9.22e-01  1.33e-01 -2.94e-02 -9.69e-03 -2.24e-03 -3.67e-04 -1.23e+00 -2.57e-01
   2.49e+00 -4.85e-03 -3.63e-03 -7.35e-03 -1.44e-05 -2.74e-01  1.41e-03 -1.88e-01]
 [ 8.06e-01 -1.06e-01 -2.60e-02 -2.87e-03  9.84e-05  1.59e-03  1.61e+00  1.08e-01
   1.75e+00  6.80e-03  2.21e-03  3.81e-02 -8.81e-04  2.87e-01 -1.09e-03  1.31e-01]]
SymNet parameters
[0.64 0.03]
SymNet parameters
[[ 5.58e-02  9.17e-03 -6.64e-03 -6.35e-04  6.69e-05 -2.90e-04  1.89e-01 -2.33e-01
   1.04e-01  4.89e-02  9.62e-04  4.87e-02 -3.21e-04 -9.62e-02 -1.02e+00 -1.65e-01
  -8.58e-01]]
SymNet parameters
[0.01]
finally, finish this stage
iter:     0    time: 1287.90
Func: 8.35e-02  |g|: 1.33e+02
stableloss: 1.85e-02   dataloss: 7.04e-02   sparseloss: 1.23e+02 momentloss: 6.52e+00
current expression:
[u10*v00, u00*u01, u20, u02, u00, u00*u01**2, u01, u01*u10*v00, u10*v00*v10, u00*u11*v00, 1, u00**3, u00**2*v00, v00**2, u00**2*v00**2, v10, u01**2, u00**2*u01*v00, u00*u02, u10*v00*v01]
[-0.97 -0.97  0.05  0.05  0.02  0.01  0.01  0.01  0.01  0.01  0.01 -0.01 -0.   -0.
  0.   -0.   -0.   -0.    0.   -0.  ]
[v00*v10, u00*v01, v02, v20, v00*v10**2, u00*v01*v10, u10*v00*v01, u00*v00*v11, u00*u01*v01, v00, u00*v10, v00**3, u00*v00*v10, u00*v00*v01*v10, u10, v10*v20, v00*v20, u00**2*v20, u00**2*v00, v00**2*v01]
[-0.98 -0.98  0.05  0.05  0.01  0.01  0.01  0.01  0.01  0.01 -0.01 -0.    0.   -0.
 -0.   -0.    0.    0.    0.   -0.  ]
block:  3
name:  burgers-2-upwind-sparse0-noise0.001-id9
device:  cuda:1
generate a random number to check random seed:  0.11662052100247197
current stage is: block-3
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.7916, device='cuda:1', dtype=torch.float64)
u_obs variance
tensor([ 0.2266,  1.4797,  1.5101, 19.4360,  8.7833, 18.6438,  0.2307,  1.4646,
         1.5514, 17.2498,  9.0181, 20.8710], device='cuda:1',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 0.144459
         Iterations: 0
         Function evaluations: 15
         Gradient evaluations: 3
convolution moment and kernels
[[ 1.00e+00  0.00e+00  1.40e-04  4.36e-03 -4.50e-02]
 [ 0.00e+00 -9.92e-05  1.35e-03  6.48e-04 -3.28e-03]
 [ 2.93e-04 -5.11e-04  2.13e-03 -6.85e-04 -2.26e-03]
 [-2.16e-03  1.00e-04 -3.53e-03 -1.10e-03  9.48e-03]
 [-2.60e-02 -2.91e-03  2.06e-03  4.83e-03  6.82e-03]]
[[-0.    0.   -0.02 -0.01  0.  ]
 [-0.01  0.03  0.02  0.09 -0.03]
 [-0.02  0.05  0.83 -0.04  0.02]
 [-0.03  0.14 -0.14  0.19 -0.05]
 [ 0.01 -0.04  0.05 -0.05  0.01]]
[[ 0.00e+00  1.00e+00  0.00e+00 -1.00e-01 -6.62e-02]
 [ 0.00e+00  0.00e+00  3.28e-03 -6.87e-04  8.33e-03]
 [ 0.00e+00  1.99e-02  1.40e-03  2.78e-02 -1.16e-02]
 [-3.52e-03  6.78e-04 -3.54e-03 -1.56e-03  5.45e-03]
 [ 1.91e-02 -2.00e-02  4.83e-03 -9.34e-03 -1.31e-03]]
[[ 7.07e-04  2.22e-02 -1.02e-02  1.48e-02 -6.56e-03]
 [-3.62e-02  1.27e-02 -8.45e-02  8.79e-03  1.93e-02]
 [ 1.35e-01 -5.66e-01 -2.19e-01  9.93e-01 -2.29e-01]
 [-3.82e-02  3.02e-02 -1.05e-01  2.01e-02  1.97e-02]
 [ 5.89e-03 -1.40e-03  2.08e-02 -5.04e-03 -2.94e-03]]
[[ 0.00e+00  0.00e+00  0.00e+00  3.17e-04  1.02e-02]
 [ 1.00e+00  0.00e+00  4.32e-03 -3.22e-03 -4.31e-02]
 [ 0.00e+00 -2.19e-03  9.71e-04  1.31e-03 -3.95e-03]
 [-8.82e-02 -9.35e-04  2.96e-02  3.23e-03 -1.68e-02]
 [-6.79e-02 -2.56e-03 -4.69e-03  3.69e-03 -1.12e-03]]
[[ 0.   -0.04  0.13 -0.04  0.01]
 [ 0.01  0.01 -0.53  0.03  0.  ]
 [ 0.01 -0.07 -0.25 -0.12  0.03]
 [-0.    0.02  0.97  0.07 -0.02]
 [-0.01  0.04 -0.25  0.03 -0.  ]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00 -2.65e-03]
 [ 0.00e+00  0.00e+00  0.00e+00  5.27e-04  2.59e-03]
 [ 0.00e+00  0.00e+00  1.98e-03 -1.11e-03 -2.50e-04]
 [ 0.00e+00  1.88e-04  5.16e-04 -2.30e-04  3.96e-04]
 [ 5.22e-03  2.25e-03 -4.53e-04 -2.68e-05 -3.58e-03]]
[[-0.    0.01 -0.01  0.01 -0.  ]
 [ 0.01 -0.04  0.04 -0.05  0.01]
 [-0.11  1.41 -2.59  1.42 -0.11]
 [ 0.01 -0.05  0.06 -0.06  0.02]
 [-0.    0.01 -0.02  0.02 -0.  ]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00 -1.96e-03]
 [ 0.00e+00  1.00e+00  0.00e+00 -1.16e-03  2.41e-05]
 [ 0.00e+00  0.00e+00  5.47e-04 -1.12e-03 -9.52e-04]
 [ 0.00e+00 -1.18e-03  3.20e-04  1.75e-03 -6.31e-05]
 [-1.13e-03  7.06e-04 -8.56e-04  1.69e-03  2.15e-03]]
[[ 0.01 -0.07  0.02  0.05 -0.  ]
 [-0.06  0.49 -0.07 -0.4   0.04]
 [ 0.01 -0.05  0.09 -0.07  0.02]
 [ 0.05 -0.41 -0.06  0.5  -0.07]
 [-0.01  0.05  0.01 -0.07  0.01]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  2.21e-03]
 [ 0.00e+00  0.00e+00  0.00e+00  1.04e-04  2.11e-03]
 [ 1.00e+00  0.00e+00  1.63e-03  1.28e-04  3.84e-04]
 [ 0.00e+00 -4.42e-04  2.27e-03  3.09e-04 -2.16e-03]
 [-2.47e-04  2.73e-03  8.59e-04 -1.31e-03 -5.63e-03]]
[[-0.    0.01 -0.11  0.02 -0.01]
 [ 0.02 -0.06  1.45 -0.09  0.02]
 [-0.03  0.11 -2.7   0.15 -0.04]
 [ 0.02 -0.1   1.5  -0.12  0.03]
 [-0.01  0.03 -0.13  0.03 -0.01]]
SymNet parameters
[[ 2.59 -0.8   0.    0.32 -0.07  0.02  3.1  -0.14  0.29 -0.03  0.01  0.05]
 [ 2.31 -0.4   0.27  0.24 -0.04  0.01  0.37 -0.11  0.23 -0.02  0.01  0.04]]
SymNet parameters
[-0.09 -0.53]
SymNet parameters
[[-1.01e-01 -6.66e-02 -5.33e-02  4.38e-02 -1.22e-02  2.29e-03 -3.77e-02 -1.81e-02
   3.39e-02 -4.57e-03  1.27e-03  6.82e-03 -5.23e-04]
 [ 1.39e+00  3.71e-01 -3.24e-01 -2.90e-01 -4.62e-01  2.98e-02 -3.98e-01 -2.12e-01
   3.34e-01 -2.46e-02  2.14e-02 -9.94e-02 -7.98e-02]]
SymNet parameters
[-0.06 -0.06]
SymNet parameters
[[ 2.41  2.53 -0.48 -0.5  -1.46  0.03  1.98 -0.41  0.05 -0.13  0.02 -0.26 -0.17 -0.32]
 [ 1.02 -1.09 -0.05  0.45 -0.16  0.03  2.68 -0.24  0.52 -0.05  0.02  0.07  0.    0.03]]
SymNet parameters
[ 0.02 -0.06]
SymNet parameters
[[-3.52e+00  7.46e-01 -1.27e-01 -3.98e-01 -2.38e-02 -1.27e-02 -4.95e-01  1.36e-01
  -3.32e-01  2.44e-02 -1.20e-02 -7.78e-02 -1.27e-02 -8.53e-03 -4.95e-04]
 [-2.00e+00  7.42e-01 -1.75e-01 -2.40e-01  7.94e-02 -1.34e-02 -2.37e+00  1.22e-01
  -2.45e-01  2.58e-02 -1.04e-02 -3.72e-02  4.18e-03 -1.12e-02  2.45e-04]]
SymNet parameters
[0.61 0.09]
SymNet parameters
[[ 1.58  0.77  0.47 -0.44 -0.07 -0.01 -0.79  0.13 -0.28  0.02 -0.01 -0.08 -0.27 -0.07
   0.01  0.2 ]
 [ 1.01  2.29  0.38 -0.38  0.01  0.05 -0.46 -0.22  0.87  0.05  0.05 -0.05  0.19  0.13
   0.   -0.21]]
SymNet parameters
[-0.2  -0.12]
SymNet parameters
[[-0.64  0.02  0.14  0.    0.04  0.05 -0.74  0.04 -0.08  0.01 -0.   -0.   -1.73 -1.27
   0.07  1.43 -0.05]]
SymNet parameters
[0.02]
SymNet parameters
[[ 3.47e+00 -1.18e-01  1.82e-01 -3.33e-03 -2.45e-02 -4.23e-02  1.04e+00  3.20e+00
   3.65e-02  2.21e-01 -4.40e-02 -3.97e-01]
 [-2.89e-01  1.09e+00 -7.14e-01  1.80e-02 -6.14e-02 -2.77e-02 -2.79e+00 -2.36e+00
   2.14e+00 -1.02e+00 -2.69e-01 -2.13e+00]]
SymNet parameters
[-0.07 -0.08]
SymNet parameters
[[ 9.93e-03 -1.04e-01  3.55e-03  1.41e-03  5.98e-04  4.37e-04  1.36e-01  2.61e+00
   3.12e-01  1.41e-02 -1.19e-02  2.42e-02  4.98e-04]
 [-2.03e+00 -5.54e-03  7.89e-03 -3.82e-05  6.28e-04 -5.67e-04  7.22e-02 -8.24e-03
  -6.43e-02 -3.57e-03 -8.80e-04 -4.12e-03 -7.19e-05]]
SymNet parameters
[ 0.27 -0.01]
SymNet parameters
[[-6.28e-01  1.17e-01  2.34e-02  2.19e-03 -9.10e-05 -1.52e-03 -1.52e+00  4.59e-02
  -1.98e+00 -7.14e-03 -2.81e-03 -3.76e-02  3.65e-04 -5.17e-02]
 [ 1.00e+00  9.37e-02 -2.71e-02 -8.34e-03 -1.82e-03  6.41e-05 -1.09e+00 -1.69e-02
   1.85e+00 -2.50e-03 -2.86e-03 -1.01e-03 -1.52e-04  5.15e-02]]
SymNet parameters
[-0.01  0.43]
SymNet parameters
[[ 1.19e-02 -1.66e-01  2.57e-03  2.94e-03  1.32e-03  1.00e-03  2.07e-01  4.22e+00
   5.04e-01  1.81e-02 -8.33e-03  3.26e-02  7.96e-04 -5.38e-04  3.38e-04]
 [ 2.21e+00  8.24e-03 -3.59e-03  4.55e-05 -8.86e-04  6.14e-04 -8.47e-02  5.45e-03
   7.39e-02  2.13e-03  5.20e-04  1.79e-03 -6.99e-06 -1.45e-04  3.71e-05]]
SymNet parameters
[-0.01 -0.31]
SymNet parameters
[[ 9.22e-01  1.33e-01 -2.94e-02 -9.69e-03 -2.23e-03 -3.73e-04 -1.23e+00 -2.57e-01
   2.49e+00 -4.85e-03 -3.63e-03 -7.34e-03  1.19e-04 -2.74e-01  1.46e-03 -1.88e-01]
 [ 8.06e-01 -1.06e-01 -2.60e-02 -2.87e-03  9.96e-05  1.59e-03  1.61e+00  1.08e-01
   1.75e+00  6.80e-03  2.21e-03  3.81e-02 -7.09e-04  2.87e-01 -1.05e-03  1.31e-01]]
SymNet parameters
[0.64 0.03]
SymNet parameters
[[ 5.58e-02  9.17e-03 -6.64e-03 -6.35e-04  6.72e-05 -2.90e-04  1.89e-01 -2.33e-01
   1.04e-01  4.89e-02  9.62e-04  4.87e-02 -2.97e-04 -9.62e-02 -1.02e+00 -1.65e-01
  -8.58e-01]]
SymNet parameters
[0.01]
finally, finish this stage
iter:     0    time: 89.05
Func: 1.44e-01  |g|: 1.60e+02
stableloss: 2.06e-02   dataloss: 1.25e-01   sparseloss: 1.23e+02 momentloss: 6.52e+00
current expression:
[u10*v00, u00*u01, u20, u02, u00, u00*u01**2, u01, u01*u10*v00, u10*v00*v10, u00*u11*v00, 1, u00**3, u00**2*v00, v00**2, u00**2*v00**2, v10, u01**2, u00**2*u01*v00, u00*u02, u10*v00*v01]
[-0.97 -0.97  0.05  0.05  0.02  0.01  0.01  0.01  0.01  0.01  0.01 -0.01 -0.   -0.
  0.   -0.   -0.   -0.    0.   -0.  ]
[v00*v10, u00*v01, v02, v20, v00*v10**2, u00*v01*v10, u10*v00*v01, u00*v00*v11, u00*u01*v01, v00, u00*v10, v00**3, u00*v00*v10, u00*v00*v01*v10, u10, v10*v20, v00*v20, u00**2*v20, u00**2*v00, v00**2*v01]
[-0.98 -0.98  0.05  0.05  0.01  0.01  0.01  0.01  0.01  0.01 -0.01 -0.    0.   -0.
 -0.   -0.    0.    0.    0.   -0.  ]
block:  4
name:  burgers-2-upwind-sparse0-noise0.001-id9
device:  cuda:1
generate a random number to check random seed:  0.4458831675259695
current stage is: block-4
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.6973, device='cuda:1', dtype=torch.float64)
u_obs variance
tensor([ 0.2513,  1.7221,  1.6201, 23.2992, 10.2513, 19.3773,  0.2631,  1.6656,
         1.8113, 19.5155, 10.5906, 24.2959], device='cuda:1',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 0.334154
         Iterations: 0
         Function evaluations: 15
         Gradient evaluations: 3
convolution moment and kernels
[[ 1.00e+00  0.00e+00  1.40e-04  4.36e-03 -4.50e-02]
 [ 0.00e+00 -9.94e-05  1.35e-03  6.48e-04 -3.28e-03]
 [ 2.93e-04 -5.11e-04  2.13e-03 -6.86e-04 -2.26e-03]
 [-2.16e-03  1.00e-04 -3.53e-03 -1.10e-03  9.48e-03]
 [-2.60e-02 -2.91e-03  2.06e-03  4.83e-03  6.82e-03]]
[[-0.    0.   -0.02 -0.01  0.  ]
 [-0.01  0.03  0.02  0.09 -0.03]
 [-0.02  0.05  0.83 -0.04  0.02]
 [-0.03  0.14 -0.14  0.19 -0.05]
 [ 0.01 -0.04  0.05 -0.05  0.01]]
[[ 0.00e+00  1.00e+00  0.00e+00 -1.00e-01 -6.62e-02]
 [ 0.00e+00  0.00e+00  3.28e-03 -6.87e-04  8.33e-03]
 [ 0.00e+00  1.99e-02  1.40e-03  2.78e-02 -1.16e-02]
 [-3.52e-03  6.79e-04 -3.54e-03 -1.56e-03  5.45e-03]
 [ 1.91e-02 -2.00e-02  4.83e-03 -9.34e-03 -1.31e-03]]
[[ 7.03e-04  2.22e-02 -1.02e-02  1.48e-02 -6.57e-03]
 [-3.62e-02  1.26e-02 -8.43e-02  8.72e-03  1.93e-02]
 [ 1.35e-01 -5.66e-01 -2.19e-01  9.94e-01 -2.29e-01]
 [-3.82e-02  3.01e-02 -1.05e-01  2.00e-02  1.98e-02]
 [ 5.88e-03 -1.39e-03  2.08e-02 -5.03e-03 -2.95e-03]]
[[ 0.00e+00  0.00e+00  0.00e+00  3.17e-04  1.02e-02]
 [ 1.00e+00  0.00e+00  4.32e-03 -3.22e-03 -4.31e-02]
 [ 0.00e+00 -2.19e-03  9.71e-04  1.31e-03 -3.95e-03]
 [-8.82e-02 -9.35e-04  2.96e-02  3.23e-03 -1.68e-02]
 [-6.79e-02 -2.56e-03 -4.69e-03  3.69e-03 -1.12e-03]]
[[ 0.   -0.04  0.13 -0.04  0.01]
 [ 0.01  0.01 -0.53  0.03  0.  ]
 [ 0.01 -0.07 -0.25 -0.12  0.03]
 [-0.    0.02  0.97  0.07 -0.02]
 [-0.01  0.04 -0.25  0.03 -0.  ]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00 -2.65e-03]
 [ 0.00e+00  0.00e+00  0.00e+00  5.27e-04  2.59e-03]
 [ 0.00e+00  0.00e+00  1.98e-03 -1.11e-03 -2.50e-04]
 [ 0.00e+00  1.88e-04  5.16e-04 -2.30e-04  3.96e-04]
 [ 5.22e-03  2.25e-03 -4.53e-04 -2.67e-05 -3.58e-03]]
[[-0.    0.01 -0.01  0.01 -0.  ]
 [ 0.01 -0.04  0.04 -0.05  0.01]
 [-0.11  1.41 -2.59  1.42 -0.11]
 [ 0.01 -0.05  0.06 -0.06  0.02]
 [-0.    0.01 -0.02  0.02 -0.  ]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00 -1.96e-03]
 [ 0.00e+00  1.00e+00  0.00e+00 -1.16e-03  2.41e-05]
 [ 0.00e+00  0.00e+00  5.47e-04 -1.12e-03 -9.52e-04]
 [ 0.00e+00 -1.18e-03  3.20e-04  1.75e-03 -6.31e-05]
 [-1.13e-03  7.06e-04 -8.56e-04  1.69e-03  2.15e-03]]
[[ 0.01 -0.07  0.02  0.05 -0.  ]
 [-0.06  0.49 -0.07 -0.4   0.04]
 [ 0.01 -0.05  0.09 -0.07  0.02]
 [ 0.05 -0.41 -0.06  0.5  -0.07]
 [-0.01  0.05  0.01 -0.07  0.01]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  2.20e-03]
 [ 0.00e+00  0.00e+00  0.00e+00  1.04e-04  2.11e-03]
 [ 1.00e+00  0.00e+00  1.63e-03  1.28e-04  3.84e-04]
 [ 0.00e+00 -4.42e-04  2.27e-03  3.09e-04 -2.16e-03]
 [-2.47e-04  2.73e-03  8.59e-04 -1.31e-03 -5.63e-03]]
[[-0.    0.01 -0.11  0.02 -0.01]
 [ 0.02 -0.06  1.45 -0.09  0.02]
 [-0.03  0.11 -2.7   0.15 -0.04]
 [ 0.02 -0.1   1.5  -0.12  0.03]
 [-0.01  0.03 -0.13  0.03 -0.01]]
SymNet parameters
[[ 2.59 -0.8   0.    0.32 -0.07  0.02  3.1  -0.14  0.29 -0.03  0.01  0.05]
 [ 2.31 -0.4   0.27  0.24 -0.04  0.01  0.37 -0.11  0.23 -0.02  0.01  0.04]]
SymNet parameters
[-0.09 -0.53]
SymNet parameters
[[-1.01e-01 -6.66e-02 -5.33e-02  4.38e-02 -1.22e-02  2.29e-03 -3.77e-02 -1.81e-02
   3.39e-02 -4.55e-03  1.27e-03  6.83e-03 -4.03e-04]
 [ 1.39e+00  3.71e-01 -3.24e-01 -2.90e-01 -4.62e-01  2.98e-02 -3.98e-01 -2.12e-01
   3.34e-01 -2.46e-02  2.14e-02 -9.94e-02 -7.98e-02]]
SymNet parameters
[-0.06 -0.06]
SymNet parameters
[[ 2.41  2.53 -0.48 -0.5  -1.46  0.03  1.98 -0.41  0.05 -0.13  0.02 -0.26 -0.17 -0.32]
 [ 1.02 -1.09 -0.05  0.45 -0.16  0.03  2.68 -0.24  0.52 -0.05  0.02  0.07  0.    0.03]]
SymNet parameters
[ 0.02 -0.06]
SymNet parameters
[[-3.52e+00  7.46e-01 -1.27e-01 -3.98e-01 -2.38e-02 -1.27e-02 -4.95e-01  1.36e-01
  -3.32e-01  2.44e-02 -1.20e-02 -7.78e-02 -1.26e-02 -8.52e-03 -3.21e-04]
 [-2.00e+00  7.42e-01 -1.75e-01 -2.40e-01  7.94e-02 -1.34e-02 -2.37e+00  1.22e-01
  -2.45e-01  2.58e-02 -1.04e-02 -3.72e-02  4.28e-03 -1.12e-02  5.10e-04]]
SymNet parameters
[0.61 0.09]
SymNet parameters
[[ 1.58  0.77  0.47 -0.44 -0.07 -0.01 -0.79  0.13 -0.28  0.02 -0.01 -0.08 -0.27 -0.07
   0.01  0.2 ]
 [ 1.01  2.29  0.38 -0.38  0.01  0.05 -0.46 -0.22  0.87  0.05  0.05 -0.05  0.19  0.13
   0.   -0.21]]
SymNet parameters
[-0.2  -0.12]
SymNet parameters
[[-0.64  0.02  0.14  0.    0.04  0.05 -0.74  0.04 -0.08  0.01 -0.   -0.   -1.73 -1.27
   0.07  1.43 -0.05]]
SymNet parameters
[0.02]
SymNet parameters
[[ 3.47e+00 -1.18e-01  1.82e-01 -3.33e-03 -2.45e-02 -4.23e-02  1.04e+00  3.20e+00
   3.65e-02  2.21e-01 -4.40e-02 -3.97e-01]
 [-2.89e-01  1.09e+00 -7.14e-01  1.80e-02 -6.14e-02 -2.77e-02 -2.79e+00 -2.36e+00
   2.14e+00 -1.02e+00 -2.69e-01 -2.13e+00]]
SymNet parameters
[-0.07 -0.08]
SymNet parameters
[[ 9.93e-03 -1.04e-01  3.55e-03  1.41e-03  6.02e-04  4.40e-04  1.36e-01  2.61e+00
   3.12e-01  1.41e-02 -1.19e-02  2.42e-02  4.89e-04]
 [-2.03e+00 -5.54e-03  7.89e-03 -3.74e-05  6.29e-04 -5.66e-04  7.22e-02 -8.24e-03
  -6.43e-02 -3.57e-03 -8.82e-04 -4.12e-03 -1.62e-05]]
SymNet parameters
[ 0.27 -0.01]
SymNet parameters
[[-6.28e-01  1.17e-01  2.34e-02  2.19e-03 -9.25e-05 -1.51e-03 -1.52e+00  4.59e-02
  -1.98e+00 -7.15e-03 -2.81e-03 -3.76e-02  2.96e-04 -5.17e-02]
 [ 1.00e+00  9.37e-02 -2.71e-02 -8.33e-03 -1.81e-03  6.17e-05 -1.09e+00 -1.69e-02
   1.85e+00 -2.50e-03 -2.86e-03 -1.01e-03  3.47e-05  5.15e-02]]
SymNet parameters
[-0.01  0.43]
SymNet parameters
[[ 1.19e-02 -1.66e-01  2.57e-03  2.94e-03  1.31e-03  9.98e-04  2.07e-01  4.22e+00
   5.04e-01  1.81e-02 -8.33e-03  3.26e-02  7.90e-04 -5.31e-04  3.41e-04]
 [ 2.21e+00  8.24e-03 -3.59e-03  4.63e-05 -8.85e-04  6.16e-04 -8.48e-02  5.45e-03
   7.39e-02  2.14e-03  5.19e-04  1.79e-03  2.29e-05 -1.34e-04  4.31e-05]]
SymNet parameters
[-0.01 -0.31]
SymNet parameters
[[ 9.22e-01  1.33e-01 -2.94e-02 -9.70e-03 -2.24e-03 -3.71e-04 -1.23e+00 -2.57e-01
   2.49e+00 -4.85e-03 -3.63e-03 -7.34e-03 -3.34e-05 -2.74e-01  1.45e-03 -1.88e-01]
 [ 8.06e-01 -1.06e-01 -2.60e-02 -2.87e-03  9.80e-05  1.59e-03  1.61e+00  1.08e-01
   1.75e+00  6.79e-03  2.21e-03  3.81e-02 -7.87e-04  2.87e-01 -1.06e-03  1.31e-01]]
SymNet parameters
[0.64 0.03]
SymNet parameters
[[ 5.58e-02  9.17e-03 -6.64e-03 -6.34e-04  6.62e-05 -2.89e-04  1.89e-01 -2.33e-01
   1.04e-01  4.89e-02  9.62e-04  4.87e-02 -3.16e-04 -9.62e-02 -1.02e+00 -1.65e-01
  -8.58e-01]]
SymNet parameters
[0.01]
finally, finish this stage
iter:     0    time: 89.52
Func: 3.34e-01  |g|: 2.05e+02
stableloss: 3.31e-02   dataloss: 3.08e-01   sparseloss: 1.23e+02 momentloss: 6.52e+00
current expression:
[u10*v00, u00*u01, u20, u02, u00, u00*u01**2, u01, u01*u10*v00, u10*v00*v10, u00*u11*v00, 1, u00**3, u00**2*v00, v00**2, u00**2*v00**2, v10, u01**2, u00**2*u01*v00, u00*u02, u10*v00*v01]
[-0.97 -0.97  0.05  0.05  0.02  0.01  0.01  0.01  0.01  0.01  0.01 -0.01 -0.   -0.
  0.   -0.   -0.   -0.    0.   -0.  ]
[v00*v10, u00*v01, v02, v20, v00*v10**2, u00*v01*v10, u10*v00*v01, u00*v00*v11, u00*u01*v01, v00, u00*v10, v00**3, u00*v00*v10, u00*v00*v01*v10, u10, v10*v20, v00*v20, u00**2*v20, u00**2*v00, v00**2*v01]
[-0.98 -0.98  0.05  0.05  0.01  0.01  0.01  0.01  0.01  0.01 -0.01 -0.    0.   -0.
 -0.   -0.    0.    0.    0.   -0.  ]
block:  5
name:  burgers-2-upwind-sparse0-noise0.001-id9
device:  cuda:1
generate a random number to check random seed:  0.07108415780355792
current stage is: block-5
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.9550, device='cuda:1', dtype=torch.float64)
u_obs variance
tensor([ 0.2682,  1.8291,  1.6962, 24.2785, 10.2427, 20.2301,  0.2311,  1.5779,
         1.6076, 19.1392,  9.9592, 22.1249], device='cuda:1',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 0.588297
         Iterations: 0
         Function evaluations: 15
         Gradient evaluations: 3
convolution moment and kernels
[[ 1.00e+00  0.00e+00  1.40e-04  4.36e-03 -4.50e-02]
 [ 0.00e+00 -9.93e-05  1.35e-03  6.48e-04 -3.28e-03]
 [ 2.93e-04 -5.11e-04  2.13e-03 -6.85e-04 -2.26e-03]
 [-2.16e-03  1.00e-04 -3.53e-03 -1.10e-03  9.48e-03]
 [-2.60e-02 -2.91e-03  2.06e-03  4.83e-03  6.82e-03]]
[[-0.    0.   -0.02 -0.01  0.  ]
 [-0.01  0.03  0.01  0.09 -0.03]
 [-0.02  0.05  0.83 -0.04  0.02]
 [-0.03  0.14 -0.14  0.19 -0.05]
 [ 0.01 -0.04  0.05 -0.05  0.01]]
[[ 0.00e+00  1.00e+00  0.00e+00 -1.00e-01 -6.62e-02]
 [ 0.00e+00  0.00e+00  3.28e-03 -6.87e-04  8.33e-03]
 [ 0.00e+00  1.99e-02  1.40e-03  2.78e-02 -1.16e-02]
 [-3.52e-03  6.79e-04 -3.54e-03 -1.56e-03  5.45e-03]
 [ 1.91e-02 -2.00e-02  4.83e-03 -9.34e-03 -1.31e-03]]
[[ 7.07e-04  2.22e-02 -1.02e-02  1.48e-02 -6.57e-03]
 [-3.62e-02  1.27e-02 -8.45e-02  8.79e-03  1.93e-02]
 [ 1.35e-01 -5.66e-01 -2.19e-01  9.93e-01 -2.29e-01]
 [-3.82e-02  3.02e-02 -1.05e-01  2.01e-02  1.97e-02]
 [ 5.89e-03 -1.40e-03  2.08e-02 -5.04e-03 -2.94e-03]]
[[ 0.00e+00  0.00e+00  0.00e+00  3.17e-04  1.02e-02]
 [ 1.00e+00  0.00e+00  4.32e-03 -3.22e-03 -4.31e-02]
 [ 0.00e+00 -2.19e-03  9.71e-04  1.31e-03 -3.95e-03]
 [-8.82e-02 -9.35e-04  2.96e-02  3.23e-03 -1.68e-02]
 [-6.79e-02 -2.56e-03 -4.69e-03  3.69e-03 -1.12e-03]]
[[ 0.   -0.04  0.13 -0.04  0.01]
 [ 0.01  0.01 -0.53  0.03  0.  ]
 [ 0.01 -0.07 -0.25 -0.12  0.03]
 [-0.    0.02  0.97  0.07 -0.02]
 [-0.01  0.04 -0.25  0.03 -0.  ]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00 -2.65e-03]
 [ 0.00e+00  0.00e+00  0.00e+00  5.27e-04  2.59e-03]
 [ 0.00e+00  0.00e+00  1.98e-03 -1.11e-03 -2.50e-04]
 [ 0.00e+00  1.88e-04  5.16e-04 -2.30e-04  3.96e-04]
 [ 5.22e-03  2.25e-03 -4.53e-04 -2.68e-05 -3.58e-03]]
[[-0.    0.01 -0.01  0.01 -0.  ]
 [ 0.01 -0.04  0.04 -0.05  0.01]
 [-0.11  1.41 -2.59  1.42 -0.11]
 [ 0.01 -0.05  0.06 -0.06  0.02]
 [-0.    0.01 -0.02  0.02 -0.  ]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00 -1.96e-03]
 [ 0.00e+00  1.00e+00  0.00e+00 -1.16e-03  2.41e-05]
 [ 0.00e+00  0.00e+00  5.47e-04 -1.12e-03 -9.52e-04]
 [ 0.00e+00 -1.18e-03  3.20e-04  1.75e-03 -6.31e-05]
 [-1.13e-03  7.06e-04 -8.56e-04  1.69e-03  2.15e-03]]
[[ 0.01 -0.07  0.02  0.05 -0.  ]
 [-0.06  0.49 -0.07 -0.4   0.04]
 [ 0.01 -0.05  0.09 -0.07  0.02]
 [ 0.05 -0.41 -0.06  0.5  -0.07]
 [-0.01  0.05  0.01 -0.07  0.01]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  2.21e-03]
 [ 0.00e+00  0.00e+00  0.00e+00  1.04e-04  2.11e-03]
 [ 1.00e+00  0.00e+00  1.63e-03  1.28e-04  3.84e-04]
 [ 0.00e+00 -4.42e-04  2.27e-03  3.09e-04 -2.16e-03]
 [-2.47e-04  2.73e-03  8.59e-04 -1.31e-03 -5.63e-03]]
[[-0.    0.01 -0.11  0.02 -0.01]
 [ 0.02 -0.06  1.45 -0.09  0.02]
 [-0.03  0.11 -2.7   0.15 -0.04]
 [ 0.02 -0.1   1.5  -0.12  0.03]
 [-0.01  0.03 -0.13  0.03 -0.01]]
SymNet parameters
[[ 2.59 -0.8   0.    0.32 -0.07  0.02  3.1  -0.14  0.29 -0.03  0.01  0.05]
 [ 2.31 -0.4   0.27  0.24 -0.04  0.01  0.37 -0.11  0.23 -0.02  0.01  0.04]]
SymNet parameters
[-0.09 -0.53]
SymNet parameters
[[-1.01e-01 -6.66e-02 -5.33e-02  4.38e-02 -1.22e-02  2.29e-03 -3.77e-02 -1.81e-02
   3.39e-02 -4.56e-03  1.27e-03  6.83e-03 -4.22e-04]
 [ 1.39e+00  3.71e-01 -3.24e-01 -2.90e-01 -4.62e-01  2.98e-02 -3.98e-01 -2.12e-01
   3.34e-01 -2.46e-02  2.14e-02 -9.94e-02 -7.98e-02]]
SymNet parameters
[-0.06 -0.06]
SymNet parameters
[[ 2.41  2.53 -0.48 -0.5  -1.46  0.03  1.98 -0.41  0.05 -0.13  0.02 -0.26 -0.17 -0.32]
 [ 1.02 -1.09 -0.05  0.45 -0.16  0.03  2.68 -0.24  0.52 -0.05  0.02  0.07  0.    0.03]]
SymNet parameters
[ 0.02 -0.06]
SymNet parameters
[[-3.52e+00  7.46e-01 -1.27e-01 -3.98e-01 -2.38e-02 -1.27e-02 -4.95e-01  1.36e-01
  -3.32e-01  2.44e-02 -1.20e-02 -7.78e-02 -1.26e-02 -8.54e-03 -1.60e-04]
 [-2.00e+00  7.42e-01 -1.75e-01 -2.40e-01  7.94e-02 -1.34e-02 -2.37e+00  1.22e-01
  -2.45e-01  2.58e-02 -1.04e-02 -3.72e-02  4.27e-03 -1.12e-02  5.33e-04]]
SymNet parameters
[0.61 0.09]
SymNet parameters
[[ 1.58  0.77  0.47 -0.44 -0.07 -0.01 -0.79  0.13 -0.28  0.02 -0.01 -0.08 -0.27 -0.07
   0.01  0.2 ]
 [ 1.01  2.29  0.38 -0.38  0.01  0.05 -0.46 -0.22  0.87  0.05  0.05 -0.05  0.19  0.13
   0.   -0.21]]
SymNet parameters
[-0.2  -0.12]
SymNet parameters
[[-0.64  0.02  0.14  0.    0.04  0.05 -0.74  0.04 -0.08  0.01 -0.   -0.   -1.73 -1.27
   0.07  1.43 -0.05]]
SymNet parameters
[0.02]
SymNet parameters
[[ 3.47e+00 -1.18e-01  1.82e-01 -3.33e-03 -2.45e-02 -4.23e-02  1.04e+00  3.20e+00
   3.65e-02  2.21e-01 -4.40e-02 -3.97e-01]
 [-2.89e-01  1.09e+00 -7.14e-01  1.80e-02 -6.14e-02 -2.77e-02 -2.79e+00 -2.36e+00
   2.14e+00 -1.02e+00 -2.69e-01 -2.13e+00]]
SymNet parameters
[-0.07 -0.08]
SymNet parameters
[[ 9.93e-03 -1.04e-01  3.55e-03  1.41e-03  6.00e-04  4.39e-04  1.36e-01  2.61e+00
   3.12e-01  1.41e-02 -1.19e-02  2.42e-02  5.51e-04]
 [-2.03e+00 -5.54e-03  7.89e-03 -3.85e-05  6.28e-04 -5.68e-04  7.22e-02 -8.24e-03
  -6.43e-02 -3.57e-03 -8.81e-04 -4.12e-03 -5.08e-06]]
SymNet parameters
[ 0.27 -0.01]
SymNet parameters
[[-6.28e-01  1.17e-01  2.34e-02  2.19e-03 -9.18e-05 -1.51e-03 -1.52e+00  4.59e-02
  -1.98e+00 -7.15e-03 -2.81e-03 -3.76e-02  3.14e-04 -5.17e-02]
 [ 1.00e+00  9.37e-02 -2.71e-02 -8.34e-03 -1.82e-03  5.81e-05 -1.09e+00 -1.69e-02
   1.85e+00 -2.50e-03 -2.86e-03 -1.01e-03 -2.79e-05  5.14e-02]]
SymNet parameters
[-0.01  0.43]
SymNet parameters
[[ 1.19e-02 -1.66e-01  2.57e-03  2.94e-03  1.32e-03  9.99e-04  2.07e-01  4.22e+00
   5.04e-01  1.81e-02 -8.33e-03  3.26e-02  7.59e-04 -5.40e-04  3.40e-04]
 [ 2.21e+00  8.24e-03 -3.59e-03  4.47e-05 -8.86e-04  6.13e-04 -8.48e-02  5.45e-03
   7.39e-02  2.14e-03  5.19e-04  1.79e-03  2.07e-05 -1.51e-04  5.73e-05]]
SymNet parameters
[-0.01 -0.31]
SymNet parameters
[[ 9.22e-01  1.33e-01 -2.94e-02 -9.69e-03 -2.24e-03 -3.68e-04 -1.23e+00 -2.57e-01
   2.49e+00 -4.85e-03 -3.63e-03 -7.34e-03  2.38e-05 -2.74e-01  1.53e-03 -1.88e-01]
 [ 8.06e-01 -1.06e-01 -2.60e-02 -2.86e-03  9.86e-05  1.60e-03  1.61e+00  1.08e-01
   1.75e+00  6.80e-03  2.21e-03  3.81e-02 -7.74e-04  2.87e-01 -9.64e-04  1.31e-01]]
SymNet parameters
[0.64 0.03]
SymNet parameters
[[ 5.58e-02  9.17e-03 -6.64e-03 -6.35e-04  6.67e-05 -2.90e-04  1.89e-01 -2.33e-01
   1.04e-01  4.89e-02  9.62e-04  4.87e-02 -3.03e-04 -9.62e-02 -1.02e+00 -1.65e-01
  -8.58e-01]]
SymNet parameters
[0.01]
finally, finish this stage
iter:     0    time: 91.16
Func: 5.88e-01  |g|: 5.60e+02
stableloss: 3.94e-02   dataloss: 5.56e-01   sparseloss: 1.23e+02 momentloss: 6.52e+00
current expression:
[u10*v00, u00*u01, u20, u02, u00, u00*u01**2, u01, u01*u10*v00, u10*v00*v10, u00*u11*v00, 1, u00**3, u00**2*v00, v00**2, u00**2*v00**2, v10, u01**2, u00**2*u01*v00, u00*u02, u10*v00*v01]
[-0.97 -0.97  0.05  0.05  0.02  0.01  0.01  0.01  0.01  0.01  0.01 -0.01 -0.   -0.
  0.   -0.   -0.   -0.    0.   -0.  ]
[v00*v10, u00*v01, v02, v20, v00*v10**2, u00*v01*v10, u10*v00*v01, u00*v00*v11, u00*u01*v01, v00, u00*v10, v00**3, u00*v00*v10, u00*v00*v01*v10, u10, v10*v20, v00*v20, u00**2*v20, u00**2*v00, v00**2*v01]
[-0.98 -0.98  0.05  0.05  0.01  0.01  0.01  0.01  0.01  0.01 -0.01 -0.    0.   -0.
 -0.   -0.    0.    0.    0.   -0.  ]
block:  6
name:  burgers-2-upwind-sparse0-noise0.001-id9
device:  cuda:1
generate a random number to check random seed:  -0.39982051949357533
current stage is: block-6
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.7334, device='cuda:1', dtype=torch.float64)
u_obs variance
tensor([ 0.2539,  1.6837,  1.6113, 23.0050, 10.1634, 19.0957,  0.2555,  1.6032,
         1.7001, 18.6295,  9.4775, 22.4324], device='cuda:1',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 0.873215
         Iterations: 0
         Function evaluations: 15
         Gradient evaluations: 3
convolution moment and kernels
[[ 1.00e+00  0.00e+00  1.40e-04  4.36e-03 -4.50e-02]
 [ 0.00e+00 -9.93e-05  1.35e-03  6.48e-04 -3.28e-03]
 [ 2.93e-04 -5.11e-04  2.13e-03 -6.86e-04 -2.26e-03]
 [-2.16e-03  1.00e-04 -3.53e-03 -1.10e-03  9.48e-03]
 [-2.60e-02 -2.91e-03  2.06e-03  4.83e-03  6.82e-03]]
[[-0.    0.   -0.02 -0.01  0.  ]
 [-0.01  0.03  0.02  0.09 -0.03]
 [-0.02  0.05  0.83 -0.04  0.02]
 [-0.03  0.14 -0.14  0.19 -0.05]
 [ 0.01 -0.04  0.05 -0.05  0.01]]
[[ 0.00e+00  1.00e+00  0.00e+00 -1.00e-01 -6.62e-02]
 [ 0.00e+00  0.00e+00  3.28e-03 -6.87e-04  8.33e-03]
 [ 0.00e+00  1.99e-02  1.40e-03  2.78e-02 -1.16e-02]
 [-3.52e-03  6.79e-04 -3.54e-03 -1.56e-03  5.45e-03]
 [ 1.91e-02 -2.00e-02  4.83e-03 -9.34e-03 -1.31e-03]]
[[ 7.07e-04  2.22e-02 -1.02e-02  1.48e-02 -6.57e-03]
 [-3.62e-02  1.27e-02 -8.45e-02  8.78e-03  1.93e-02]
 [ 1.35e-01 -5.66e-01 -2.19e-01  9.93e-01 -2.29e-01]
 [-3.82e-02  3.02e-02 -1.05e-01  2.01e-02  1.97e-02]
 [ 5.89e-03 -1.40e-03  2.08e-02 -5.04e-03 -2.94e-03]]
[[ 0.00e+00  0.00e+00  0.00e+00  3.18e-04  1.02e-02]
 [ 1.00e+00  0.00e+00  4.32e-03 -3.22e-03 -4.31e-02]
 [ 0.00e+00 -2.19e-03  9.71e-04  1.31e-03 -3.95e-03]
 [-8.82e-02 -9.35e-04  2.96e-02  3.23e-03 -1.68e-02]
 [-6.79e-02 -2.56e-03 -4.69e-03  3.69e-03 -1.12e-03]]
[[ 0.   -0.04  0.13 -0.04  0.01]
 [ 0.01  0.01 -0.53  0.03  0.  ]
 [ 0.01 -0.07 -0.25 -0.12  0.03]
 [-0.    0.02  0.97  0.07 -0.02]
 [-0.01  0.04 -0.25  0.03 -0.  ]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00 -2.65e-03]
 [ 0.00e+00  0.00e+00  0.00e+00  5.27e-04  2.59e-03]
 [ 0.00e+00  0.00e+00  1.98e-03 -1.11e-03 -2.50e-04]
 [ 0.00e+00  1.88e-04  5.16e-04 -2.30e-04  3.96e-04]
 [ 5.22e-03  2.25e-03 -4.53e-04 -2.66e-05 -3.58e-03]]
[[-0.    0.01 -0.01  0.01 -0.  ]
 [ 0.01 -0.04  0.04 -0.05  0.01]
 [-0.11  1.41 -2.59  1.42 -0.11]
 [ 0.01 -0.05  0.06 -0.06  0.02]
 [-0.    0.01 -0.02  0.02 -0.  ]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00 -1.96e-03]
 [ 0.00e+00  1.00e+00  0.00e+00 -1.16e-03  2.41e-05]
 [ 0.00e+00  0.00e+00  5.47e-04 -1.12e-03 -9.52e-04]
 [ 0.00e+00 -1.18e-03  3.20e-04  1.75e-03 -6.31e-05]
 [-1.13e-03  7.06e-04 -8.56e-04  1.69e-03  2.15e-03]]
[[ 0.01 -0.07  0.02  0.05 -0.  ]
 [-0.06  0.49 -0.07 -0.4   0.04]
 [ 0.01 -0.05  0.09 -0.07  0.02]
 [ 0.05 -0.41 -0.06  0.5  -0.07]
 [-0.01  0.05  0.01 -0.07  0.01]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  2.21e-03]
 [ 0.00e+00  0.00e+00  0.00e+00  1.04e-04  2.11e-03]
 [ 1.00e+00  0.00e+00  1.63e-03  1.28e-04  3.84e-04]
 [ 0.00e+00 -4.42e-04  2.27e-03  3.09e-04 -2.16e-03]
 [-2.47e-04  2.73e-03  8.59e-04 -1.31e-03 -5.63e-03]]
[[-0.    0.01 -0.11  0.02 -0.01]
 [ 0.02 -0.06  1.45 -0.09  0.02]
 [-0.03  0.11 -2.7   0.15 -0.04]
 [ 0.02 -0.1   1.5  -0.12  0.03]
 [-0.01  0.03 -0.13  0.03 -0.01]]
SymNet parameters
[[ 2.59 -0.8   0.    0.32 -0.07  0.02  3.1  -0.14  0.29 -0.03  0.01  0.05]
 [ 2.31 -0.4   0.27  0.24 -0.04  0.01  0.37 -0.11  0.23 -0.02  0.01  0.04]]
SymNet parameters
[-0.09 -0.53]
SymNet parameters
[[-1.01e-01 -6.66e-02 -5.33e-02  4.38e-02 -1.22e-02  2.28e-03 -3.77e-02 -1.81e-02
   3.39e-02 -4.56e-03  1.27e-03  6.82e-03 -3.69e-04]
 [ 1.39e+00  3.71e-01 -3.24e-01 -2.90e-01 -4.62e-01  2.98e-02 -3.98e-01 -2.12e-01
   3.34e-01 -2.46e-02  2.14e-02 -9.94e-02 -7.98e-02]]
SymNet parameters
[-0.06 -0.06]
SymNet parameters
[[ 2.41  2.53 -0.48 -0.5  -1.46  0.03  1.98 -0.41  0.05 -0.13  0.02 -0.26 -0.17 -0.32]
 [ 1.02 -1.09 -0.05  0.45 -0.16  0.03  2.68 -0.24  0.52 -0.05  0.02  0.07  0.    0.03]]
SymNet parameters
[ 0.02 -0.06]
SymNet parameters
[[-3.52e+00  7.46e-01 -1.27e-01 -3.98e-01 -2.38e-02 -1.27e-02 -4.95e-01  1.36e-01
  -3.32e-01  2.44e-02 -1.20e-02 -7.78e-02 -1.28e-02 -8.54e-03  1.51e-04]
 [-2.00e+00  7.42e-01 -1.75e-01 -2.40e-01  7.94e-02 -1.34e-02 -2.37e+00  1.22e-01
  -2.45e-01  2.58e-02 -1.04e-02 -3.72e-02  4.04e-03 -1.12e-02  8.83e-04]]
SymNet parameters
[0.61 0.09]
SymNet parameters
[[ 1.58  0.77  0.47 -0.44 -0.07 -0.01 -0.79  0.13 -0.28  0.02 -0.01 -0.08 -0.27 -0.07
   0.01  0.2 ]
 [ 1.01  2.29  0.38 -0.38  0.01  0.05 -0.46 -0.22  0.87  0.05  0.05 -0.05  0.19  0.13
   0.   -0.21]]
SymNet parameters
[-0.2  -0.12]
SymNet parameters
[[-0.64  0.02  0.14  0.    0.04  0.05 -0.74  0.04 -0.08  0.01 -0.   -0.   -1.73 -1.27
   0.07  1.43 -0.05]]
SymNet parameters
[0.02]
SymNet parameters
[[ 3.47e+00 -1.18e-01  1.82e-01 -3.33e-03 -2.45e-02 -4.23e-02  1.04e+00  3.20e+00
   3.65e-02  2.21e-01 -4.40e-02 -3.97e-01]
 [-2.89e-01  1.09e+00 -7.14e-01  1.80e-02 -6.14e-02 -2.77e-02 -2.79e+00 -2.36e+00
   2.14e+00 -1.02e+00 -2.69e-01 -2.13e+00]]
SymNet parameters
[-0.07 -0.08]
SymNet parameters
[[ 9.93e-03 -1.04e-01  3.55e-03  1.41e-03  6.00e-04  4.39e-04  1.36e-01  2.61e+00
   3.12e-01  1.41e-02 -1.19e-02  2.42e-02  5.04e-04]
 [-2.03e+00 -5.54e-03  7.89e-03 -3.85e-05  6.26e-04 -5.68e-04  7.22e-02 -8.24e-03
  -6.43e-02 -3.57e-03 -8.81e-04 -4.12e-03  1.15e-04]]
SymNet parameters
[ 0.27 -0.01]
SymNet parameters
[[-6.28e-01  1.17e-01  2.34e-02  2.19e-03 -9.37e-05 -1.51e-03 -1.52e+00  4.59e-02
  -1.98e+00 -7.15e-03 -2.81e-03 -3.76e-02  2.83e-04 -5.17e-02]
 [ 1.00e+00  9.37e-02 -2.71e-02 -8.34e-03 -1.81e-03  5.92e-05 -1.09e+00 -1.69e-02
   1.85e+00 -2.50e-03 -2.86e-03 -1.01e-03  6.82e-05  5.15e-02]]
SymNet parameters
[-0.01  0.43]
SymNet parameters
[[ 1.19e-02 -1.66e-01  2.57e-03  2.94e-03  1.31e-03  9.99e-04  2.07e-01  4.22e+00
   5.04e-01  1.81e-02 -8.33e-03  3.26e-02  7.78e-04 -5.38e-04  3.32e-04]
 [ 2.21e+00  8.24e-03 -3.59e-03  4.48e-05 -8.88e-04  6.13e-04 -8.48e-02  5.45e-03
   7.39e-02  2.14e-03  5.19e-04  1.79e-03  1.12e-04 -1.62e-04  3.95e-05]]
SymNet parameters
[-0.01 -0.31]
SymNet parameters
[[ 9.22e-01  1.33e-01 -2.94e-02 -9.69e-03 -2.24e-03 -3.69e-04 -1.23e+00 -2.57e-01
   2.49e+00 -4.85e-03 -3.63e-03 -7.34e-03 -5.66e-05 -2.74e-01  1.47e-03 -1.88e-01]
 [ 8.06e-01 -1.06e-01 -2.60e-02 -2.87e-03  9.65e-05  1.59e-03  1.61e+00  1.08e-01
   1.75e+00  6.79e-03  2.21e-03  3.81e-02 -8.09e-04  2.87e-01 -1.04e-03  1.31e-01]]
SymNet parameters
[0.64 0.03]
SymNet parameters
[[ 5.58e-02  9.17e-03 -6.64e-03 -6.34e-04  6.67e-05 -2.90e-04  1.89e-01 -2.33e-01
   1.04e-01  4.89e-02  9.62e-04  4.87e-02 -3.03e-04 -9.62e-02 -1.02e+00 -1.65e-01
  -8.58e-01]]
SymNet parameters
[0.01]
finally, finish this stage
iter:     0    time: 90.15
Func: 8.73e-01  |g|: 7.04e+02
stableloss: 5.06e-02   dataloss: 8.34e-01   sparseloss: 1.23e+02 momentloss: 6.52e+00
current expression:
[u10*v00, u00*u01, u20, u02, u00, u00*u01**2, u01, u01*u10*v00, u10*v00*v10, u00*u11*v00, 1, u00**3, u00**2*v00, v00**2, u00**2*v00**2, v10, u01**2, u00**2*u01*v00, u00*u02, u10*v00*v01]
[-0.97 -0.97  0.05  0.05  0.02  0.01  0.01  0.01  0.01  0.01  0.01 -0.01 -0.   -0.
  0.   -0.   -0.   -0.    0.   -0.  ]
[v00*v10, u00*v01, v02, v20, v00*v10**2, u00*v01*v10, u10*v00*v01, u00*v00*v11, u00*u01*v01, v00, u00*v10, v00**3, u00*v00*v10, u00*v00*v01*v10, u10, v10*v20, v00*v20, u00**2*v20, u00**2*v00, v00**2*v01]
[-0.98 -0.98  0.05  0.05  0.01  0.01  0.01  0.01  0.01  0.01 -0.01 -0.    0.   -0.
 -0.   -0.    0.    0.    0.   -0.  ]
block:  9
name:  burgers-2-upwind-sparse0-noise0.001-id9
device:  cuda:1
generate a random number to check random seed:  -2.8202912242460383
current stage is: block-9
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.8883, device='cuda:1', dtype=torch.float64)
u_obs variance
tensor([ 0.2582,  1.7424,  1.6614, 22.7606, 10.3401, 19.9282,  0.2443,  1.5243,
         1.6251, 17.6389,  9.3203, 21.7814], device='cuda:1',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 2.449413
         Iterations: 0
         Function evaluations: 15
         Gradient evaluations: 3
convolution moment and kernels
[[ 1.00e+00  0.00e+00  1.40e-04  4.36e-03 -4.50e-02]
 [ 0.00e+00 -9.93e-05  1.35e-03  6.48e-04 -3.28e-03]
 [ 2.93e-04 -5.11e-04  2.13e-03 -6.86e-04 -2.26e-03]
 [-2.16e-03  1.00e-04 -3.53e-03 -1.10e-03  9.48e-03]
 [-2.60e-02 -2.91e-03  2.06e-03  4.83e-03  6.82e-03]]
[[-0.    0.   -0.02 -0.01  0.  ]
 [-0.01  0.03  0.01  0.09 -0.03]
 [-0.02  0.05  0.84 -0.04  0.02]
 [-0.03  0.14 -0.14  0.19 -0.05]
 [ 0.01 -0.04  0.05 -0.05  0.01]]
[[ 0.00e+00  1.00e+00  0.00e+00 -1.00e-01 -6.62e-02]
 [ 0.00e+00  0.00e+00  3.28e-03 -6.87e-04  8.33e-03]
 [ 0.00e+00  1.99e-02  1.40e-03  2.78e-02 -1.16e-02]
 [-3.52e-03  6.79e-04 -3.54e-03 -1.56e-03  5.45e-03]
 [ 1.91e-02 -2.00e-02  4.82e-03 -9.34e-03 -1.31e-03]]
[[ 7.07e-04  2.22e-02 -1.02e-02  1.48e-02 -6.56e-03]
 [-3.62e-02  1.27e-02 -8.45e-02  8.80e-03  1.93e-02]
 [ 1.35e-01 -5.66e-01 -2.19e-01  9.93e-01 -2.29e-01]
 [-3.82e-02  3.02e-02 -1.05e-01  2.01e-02  1.97e-02]
 [ 5.89e-03 -1.41e-03  2.09e-02 -5.05e-03 -2.94e-03]]
[[ 0.00e+00  0.00e+00  0.00e+00  3.17e-04  1.02e-02]
 [ 1.00e+00  0.00e+00  4.32e-03 -3.22e-03 -4.31e-02]
 [ 0.00e+00 -2.19e-03  9.71e-04  1.31e-03 -3.95e-03]
 [-8.82e-02 -9.35e-04  2.96e-02  3.23e-03 -1.68e-02]
 [-6.79e-02 -2.56e-03 -4.69e-03  3.69e-03 -1.12e-03]]
[[ 0.   -0.04  0.13 -0.04  0.01]
 [ 0.01  0.01 -0.53  0.03  0.  ]
 [ 0.01 -0.07 -0.25 -0.12  0.03]
 [-0.    0.02  0.97  0.07 -0.02]
 [-0.01  0.04 -0.25  0.03 -0.  ]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00 -2.65e-03]
 [ 0.00e+00  0.00e+00  0.00e+00  5.27e-04  2.59e-03]
 [ 0.00e+00  0.00e+00  1.98e-03 -1.11e-03 -2.50e-04]
 [ 0.00e+00  1.88e-04  5.16e-04 -2.30e-04  3.96e-04]
 [ 5.22e-03  2.25e-03 -4.53e-04 -2.67e-05 -3.58e-03]]
[[-0.    0.01 -0.01  0.01 -0.  ]
 [ 0.01 -0.04  0.04 -0.05  0.01]
 [-0.11  1.41 -2.59  1.42 -0.11]
 [ 0.01 -0.05  0.06 -0.06  0.02]
 [-0.    0.01 -0.02  0.02 -0.  ]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00 -1.96e-03]
 [ 0.00e+00  1.00e+00  0.00e+00 -1.16e-03  2.41e-05]
 [ 0.00e+00  0.00e+00  5.47e-04 -1.12e-03 -9.52e-04]
 [ 0.00e+00 -1.18e-03  3.20e-04  1.75e-03 -6.31e-05]
 [-1.13e-03  7.06e-04 -8.56e-04  1.69e-03  2.15e-03]]
[[ 0.01 -0.07  0.02  0.05 -0.  ]
 [-0.06  0.49 -0.07 -0.4   0.04]
 [ 0.01 -0.05  0.09 -0.07  0.02]
 [ 0.05 -0.41 -0.06  0.5  -0.07]
 [-0.01  0.05  0.01 -0.07  0.01]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  2.21e-03]
 [ 0.00e+00  0.00e+00  0.00e+00  1.04e-04  2.11e-03]
 [ 1.00e+00  0.00e+00  1.63e-03  1.28e-04  3.84e-04]
 [ 0.00e+00 -4.42e-04  2.27e-03  3.09e-04 -2.16e-03]
 [-2.47e-04  2.73e-03  8.59e-04 -1.31e-03 -5.63e-03]]
[[-0.    0.01 -0.11  0.02 -0.01]
 [ 0.02 -0.06  1.45 -0.09  0.02]
 [-0.03  0.11 -2.7   0.15 -0.04]
 [ 0.02 -0.1   1.5  -0.12  0.03]
 [-0.01  0.03 -0.13  0.03 -0.01]]
SymNet parameters
[[ 2.59 -0.8   0.    0.32 -0.07  0.02  3.1  -0.14  0.29 -0.03  0.01  0.05]
 [ 2.31 -0.4   0.27  0.24 -0.04  0.01  0.37 -0.11  0.23 -0.02  0.01  0.04]]
SymNet parameters
[-0.09 -0.53]
SymNet parameters
[[-1.01e-01 -6.66e-02 -5.33e-02  4.38e-02 -1.22e-02  2.29e-03 -3.77e-02 -1.81e-02
   3.39e-02 -4.56e-03  1.27e-03  6.83e-03 -4.43e-04]
 [ 1.39e+00  3.71e-01 -3.24e-01 -2.90e-01 -4.62e-01  2.98e-02 -3.98e-01 -2.12e-01
   3.34e-01 -2.46e-02  2.14e-02 -9.94e-02 -7.98e-02]]
SymNet parameters
[-0.06 -0.06]
SymNet parameters
[[ 2.41  2.53 -0.48 -0.5  -1.46  0.03  1.98 -0.41  0.05 -0.13  0.02 -0.26 -0.17 -0.32]
 [ 1.02 -1.09 -0.05  0.45 -0.16  0.03  2.68 -0.24  0.52 -0.05  0.02  0.07  0.    0.03]]
SymNet parameters
[ 0.02 -0.06]
SymNet parameters
[[-3.52e+00  7.46e-01 -1.27e-01 -3.98e-01 -2.38e-02 -1.27e-02 -4.95e-01  1.36e-01
  -3.32e-01  2.44e-02 -1.20e-02 -7.78e-02 -1.26e-02 -8.54e-03 -1.61e-04]
 [-2.00e+00  7.42e-01 -1.75e-01 -2.40e-01  7.94e-02 -1.34e-02 -2.37e+00  1.22e-01
  -2.45e-01  2.58e-02 -1.04e-02 -3.72e-02  4.31e-03 -1.12e-02  4.14e-04]]
SymNet parameters
[0.61 0.09]
SymNet parameters
[[ 1.58  0.77  0.47 -0.44 -0.07 -0.01 -0.79  0.13 -0.28  0.02 -0.01 -0.08 -0.27 -0.07
   0.01  0.2 ]
 [ 1.01  2.29  0.38 -0.38  0.01  0.05 -0.46 -0.22  0.87  0.05  0.05 -0.05  0.19  0.13
   0.   -0.21]]
SymNet parameters
[-0.2  -0.12]
SymNet parameters
[[-0.64  0.02  0.14  0.    0.04  0.05 -0.74  0.04 -0.08  0.01 -0.   -0.   -1.73 -1.27
   0.07  1.43 -0.05]]
SymNet parameters
[0.02]
SymNet parameters
[[ 3.47e+00 -1.18e-01  1.82e-01 -3.33e-03 -2.45e-02 -4.23e-02  1.04e+00  3.20e+00
   3.65e-02  2.21e-01 -4.40e-02 -3.97e-01]
 [-2.89e-01  1.09e+00 -7.14e-01  1.80e-02 -6.14e-02 -2.77e-02 -2.79e+00 -2.36e+00
   2.14e+00 -1.02e+00 -2.69e-01 -2.13e+00]]
SymNet parameters
[-0.07 -0.08]
SymNet parameters
[[ 9.93e-03 -1.04e-01  3.55e-03  1.41e-03  5.99e-04  4.39e-04  1.36e-01  2.61e+00
   3.12e-01  1.41e-02 -1.19e-02  2.42e-02  4.91e-04]
 [-2.03e+00 -5.54e-03  7.89e-03 -4.13e-05  6.27e-04 -5.70e-04  7.22e-02 -8.24e-03
  -6.43e-02 -3.57e-03 -8.82e-04 -4.12e-03 -6.38e-05]]
SymNet parameters
[ 0.27 -0.01]
SymNet parameters
[[-6.28e-01  1.17e-01  2.34e-02  2.19e-03 -9.14e-05 -1.51e-03 -1.52e+00  4.59e-02
  -1.98e+00 -7.15e-03 -2.81e-03 -3.76e-02  4.12e-04 -5.17e-02]
 [ 1.00e+00  9.37e-02 -2.71e-02 -8.34e-03 -1.82e-03  6.02e-05 -1.09e+00 -1.69e-02
   1.85e+00 -2.50e-03 -2.86e-03 -1.00e-03 -1.46e-04  5.15e-02]]
SymNet parameters
[-0.01  0.43]
SymNet parameters
[[ 1.19e-02 -1.66e-01  2.57e-03  2.94e-03  1.32e-03  9.99e-04  2.07e-01  4.22e+00
   5.04e-01  1.81e-02 -8.33e-03  3.26e-02  7.97e-04 -5.41e-04  3.36e-04]
 [ 2.21e+00  8.24e-03 -3.59e-03  4.26e-05 -8.87e-04  6.11e-04 -8.48e-02  5.45e-03
   7.39e-02  2.14e-03  5.19e-04  1.79e-03 -2.80e-05 -1.55e-04  5.04e-05]]
SymNet parameters
[-0.01 -0.31]
SymNet parameters
[[ 9.22e-01  1.33e-01 -2.94e-02 -9.69e-03 -2.24e-03 -3.70e-04 -1.23e+00 -2.57e-01
   2.49e+00 -4.85e-03 -3.63e-03 -7.35e-03  1.13e-04 -2.74e-01  1.49e-03 -1.88e-01]
 [ 8.06e-01 -1.06e-01 -2.60e-02 -2.87e-03  9.91e-05  1.59e-03  1.61e+00  1.08e-01
   1.75e+00  6.80e-03  2.21e-03  3.81e-02 -6.67e-04  2.87e-01 -1.01e-03  1.31e-01]]
SymNet parameters
[0.64 0.03]
SymNet parameters
[[ 5.58e-02  9.17e-03 -6.64e-03 -6.34e-04  6.69e-05 -2.90e-04  1.89e-01 -2.33e-01
   1.04e-01  4.89e-02  9.62e-04  4.87e-02 -2.89e-04 -9.62e-02 -1.02e+00 -1.65e-01
  -8.58e-01]]
SymNet parameters
[0.01]
finally, finish this stage
iter:     0    time: 90.97
Func: 2.45e+00  |g|: 5.46e+03
stableloss: 7.03e-02   dataloss: 2.39e+00   sparseloss: 1.23e+02 momentloss: 6.52e+00
current expression:
[u10*v00, u00*u01, u20, u02, u00, u00*u01**2, u01, u01*u10*v00, u10*v00*v10, u00*u11*v00, 1, u00**3, u00**2*v00, v00**2, u00**2*v00**2, v10, u01**2, u00**2*u01*v00, u00*u02, u10*v00*v01]
[-0.97 -0.97  0.05  0.05  0.02  0.01  0.01  0.01  0.01  0.01  0.01 -0.01 -0.   -0.
  0.   -0.   -0.   -0.    0.   -0.  ]
[v00*v10, u00*v01, v02, v20, v00*v10**2, u00*v01*v10, u10*v00*v01, u00*v00*v11, u00*u01*v01, v00, u00*v10, v00**3, u00*v00*v10, u00*v00*v01*v10, u10, v10*v20, v00*v20, u00**2*v20, u00**2*v00, v00**2*v01]
[-0.98 -0.98  0.05  0.05  0.01  0.01  0.01  0.01  0.01  0.01 -0.01 -0.    0.   -0.
 -0.   -0.    0.    0.    0.   -0.  ]
u_obs.abs().max()
tensor(3.9243, device='cuda:1', dtype=torch.float64)
model(u_obs[0],T=50*dt).abs().max()
tensor(nan, device='cuda:1', dtype=torch.float64)
model(u_obs[0],T=100*dt).abs().max()
tensor(nan, device='cuda:1', dtype=torch.float64)
{'--name': 'burgers-2-upwind-sparse0-noise0.001-id10', '--dtype': 'double', '--device': 'cuda:2', '--constraint': '2', '--dt': 0.01, '--cell_num': 1, '--eps': 6.283185307179586, '--blocks': [0, 1, 2, 3, 4, 5, 6, 9], '--kernel_size': 5, '--max_order': 2, '--dx': 0.19634954084936207, '--hidden_layers': 5, '--scheme': 'upwind', '--dataname': 'burgers', '--viscosity': 0.05, '--zoom': 4, '--max_dt': 0.000625, '--batch_size': 28, '--data_timescheme': 'rk2', '--channel_names': 'u,v', '--freq': 4, '--data_start_time': 1.0, '--start_noise': 0.001, '--end_noise': 0.001, '--stablize': 0.0, '--sparsity': 0.0, '--momentsparsity': 0.001, '--npseed': -1, '--torchseed': -1, '--maxiter': 2000, '--recordfile': 'None', '--recordcycle': 200, '--savecycle': -1, '--start_from': -1}
block:  0
name:  burgers-2-upwind-sparse0-noise0.001-id10
device:  cuda:2
generate a random number to check random seed:  0.19511207806251926
current stage is: warmup
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.8029, device='cuda:2', dtype=torch.float64)
u_obs variance
tensor([ 0.2694,  2.1875,  2.1109, 20.0980, 10.8208, 18.5615,  0.2691,  2.0558,
         2.2020, 17.9656,  9.8368, 20.5027], device='cuda:2',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
iter:     0    time: 6.74
Func: 6.01e+00  |g|: 3.13e+00
stableloss: 6.32e-03   dataloss: 6.01e+00   sparseloss: 2.54e+01 momentloss: 7.27e+00
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 0.054496
         Iterations: 108
         Function evaluations: 185
         Gradient evaluations: 177
convolution moment and kernels
[[1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
[[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 1. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
[[ 0.    1.    0.   -0.33 -0.25]
 [ 0.    0.    0.    0.    0.  ]
 [ 0.    0.    0.    0.    0.  ]
 [ 0.    0.    0.    0.    0.  ]
 [ 0.    0.    0.    0.    0.  ]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]
 [ 2.78e-17  3.33e-16 -1.50e+00  2.00e+00 -5.00e-01]
 [ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]]
[[ 0.    0.    0.    0.    0.  ]
 [ 1.    0.    0.    0.    0.  ]
 [ 0.    0.    0.    0.    0.  ]
 [-0.33  0.    0.    0.    0.  ]
 [-0.25  0.    0.    0.    0.  ]]
[[ 0.00e+00  0.00e+00  2.78e-17  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  3.33e-16  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00 -1.50e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  2.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00 -5.00e-01  0.00e+00  0.00e+00]]
[[0.   0.   1.   0.   0.08]
 [0.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.  ]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]
 [-2.22e-16  1.00e+00 -2.00e+00  1.00e+00 -1.53e-16]
 [ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]]
[[0. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
[[ 6.94e-03 -5.56e-02  9.25e-18  5.56e-02 -6.94e-03]
 [-5.56e-02  4.44e-01 -7.40e-17 -4.44e-01  5.56e-02]
 [ 9.25e-18 -7.40e-17  1.23e-32  7.40e-17 -9.25e-18]
 [ 5.56e-02 -4.44e-01  7.40e-17  4.44e-01 -5.56e-02]
 [-6.94e-03  5.56e-02 -9.25e-18 -5.56e-02  6.94e-03]]
[[0.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.  ]
 [1.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.  ]
 [0.08 0.   0.   0.   0.  ]]
[[ 0.00e+00  0.00e+00 -2.22e-16  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  1.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00 -2.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  1.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00 -1.53e-16  0.00e+00  0.00e+00]]
SymNet parameters
[[ 1.23e-01  7.66e-02 -5.12e-01  2.65e-02  6.28e-03  5.06e-03 -6.30e-02  1.53e-02
  -2.98e-02  1.65e-03  1.11e-02 -1.47e-02]
 [ 4.83e-01  5.93e-01 -1.31e-01 -8.46e-02 -1.94e-02 -1.41e-02 -1.91e+00 -5.56e-02
   9.36e-02 -4.81e-03 -3.55e-02  4.68e-02]]
SymNet parameters
[ 0.77 -0.11]
SymNet parameters
[[ 0.56 -0.57 -0.37 -0.16 -0.04 -0.03  0.28 -0.1   0.16 -0.02 -0.07  0.08 -0.01]
 [-0.77  0.74  0.1  -0.07 -0.03 -0.01 -0.17 -0.04  0.08 -0.01 -0.03  0.04  0.  ]]
SymNet parameters
[-0.17  0.09]
SymNet parameters
[[ 0.23 -0.26  0.11 -0.18  0.01  0.05  0.06  0.   -0.05 -0.02 -0.01 -0.03  0.01 -0.08]
 [-0.15  0.19  0.18  0.08  0.08  0.03 -0.08 -0.03 -0.05 -0.01  0.05 -0.03  0.06  0.27]]
SymNet parameters
[-0.05  0.24]
SymNet parameters
[[ 0.26  1.01 -0.1  -0.08 -0.03 -0.01  0.67 -0.05  0.09 -0.01 -0.04  0.04 -0.   -0.
   0.03]
 [-1.   -0.26 -0.69 -0.06 -0.02 -0.01  0.19 -0.04  0.07 -0.01 -0.03  0.04  0.01  0.01
  -0.02]]
SymNet parameters
[0.1  0.21]
SymNet parameters
[[ 0.23 -0.1  -0.17  0.09 -0.23  0.03 -0.15  0.07  0.16 -0.25 -0.11 -0.16 -0.08  0.12
   0.35 -0.12]
 [-0.18 -0.18  0.24 -0.21 -0.03 -0.06  0.23 -0.04 -0.07 -0.07  0.07  0.02  0.23 -0.07
   0.08  0.24]]
SymNet parameters
[-0.06  0.3 ]
SymNet parameters
[[ 0.31  0.15  0.   -0.   -0.01  0.03 -0.98 -0.02  0.03 -0.   -0.02  0.02 -0.63 -0.36
  -0.05  0.46  0.  ]]
SymNet parameters
[-0.07]
SymNet parameters
[[ 4.35e-01  6.85e-02  3.99e-02  2.20e-02 -2.85e-02 -1.59e-02 -4.40e-02  2.38e-01
   4.53e-01  2.56e-02 -2.31e-02 -1.18e-01]
 [-5.58e-03 -5.20e-02 -5.08e-02 -5.73e-02 -4.34e-05 -5.82e-02 -4.96e-01 -5.47e-01
  -4.90e-03  4.89e-02 -5.74e-02  8.80e-02]]
SymNet parameters
[-0.6   0.18]
SymNet parameters
[[-1.32e-01  2.91e-02  2.38e-02 -7.02e-03  1.57e-03 -9.05e-03 -2.18e-01  5.11e-02
   4.49e-01 -1.18e-02 -1.10e-04 -8.48e-02  1.82e-02]
 [-1.95e-01  1.67e-03 -4.70e-02  4.15e-02 -7.79e-03  1.81e-02 -8.88e-03  5.08e-02
  -2.74e-01 -8.43e-02  8.91e-02 -1.23e-01 -9.81e-02]]
SymNet parameters
[-0.18 -0.03]
SymNet parameters
[[ 1.20e+00  7.24e-03  8.97e-03 -1.61e-03  6.07e-04  5.63e-03 -5.06e-01 -7.91e-01
  -1.87e+00 -2.88e-03  2.56e-03 -1.92e-02 -9.24e-02 -1.83e-01]
 [-8.14e-01  1.52e-02  1.17e-02  3.05e-03 -1.65e-03  4.66e-04 -1.68e+00  6.92e-01
  -2.92e-01  2.88e-03 -3.09e-03 -2.62e-04  1.09e-02 -2.23e-04]]
SymNet parameters
[-0.21  0.19]
SymNet parameters
[[ 0.12  0.05 -0.03  0.15  0.05  0.09 -0.19 -0.08  0.05  0.03  0.05 -0.08 -0.03  0.15
   0.01]
 [ 0.2   0.05  0.1   0.01 -0.05 -0.01  0.05 -0.06  0.25  0.06 -0.06 -0.21 -0.1  -0.03
   0.  ]]
SymNet parameters
[-0.03  0.22]
SymNet parameters
[[ 4.57e-01 -6.71e-03 -9.85e-03 -4.21e-03 -1.21e-03 -7.93e-03  9.01e-01  1.46e+00
  -7.63e-01  1.14e-02 -1.07e-02  4.02e-03  7.63e-03  3.41e-02  5.34e-03  3.43e-03]
 [ 1.20e+00 -9.44e-03 -8.37e-03 -7.10e-03  4.27e-03  1.76e-05 -5.50e-01  1.93e-01
   4.57e-01 -1.96e-03 -3.36e-03  2.17e-02  9.72e-03  4.66e-02  3.27e-03 -1.13e-02]]
SymNet parameters
[0.44 0.43]
SymNet parameters
[[ 0.28 -0.01 -0.01 -0.01 -0.   -0.01  0.05  0.13 -0.11  0.04 -0.01  0.04  0.1   0.08
  -0.18  0.03 -0.32]]
SymNet parameters
[0.07]
finally, finish this stage
iter:   108    time: 12.49
Func: 5.45e-02  |g|: 5.92e-02
stableloss: 1.15e-02   dataloss: 5.45e-02   sparseloss: 5.16e+01 momentloss: 7.27e+00
current expression:
[u10*v00, u00*u01, u20, u02, u01, u00, u00*u01**2, u01*u02, u00*u10, u01*u10*v00, u00**2, u01*v00, u10, u01**2, u00**2*u01, v00, u01**2*u10, u00*u11, u00*u01*v00, u00*v00]
[-0.88 -0.87  0.04  0.03  0.02 -0.01  0.01  0.01  0.01  0.01 -0.01  0.01  0.01  0.
 -0.   -0.   -0.    0.   -0.   -0.  ]
[v00*v10, u00*v01, v02, v20, v00, v00*v10**2, u00, u00*v00*v01, v01, u00*v01*v10, v10, u00*v00*v20, v11, v10*v20, u00*v10**2, u00**2*v00, u00*v10, u00**2*v01, 1, v00**2]
[-0.88 -0.88  0.04  0.03 -0.01  0.01 -0.01  0.01 -0.01  0.01 -0.01 -0.01 -0.01  0.
  0.    0.    0.    0.    0.   -0.  ]
block:  1
name:  burgers-2-upwind-sparse0-noise0.001-id10
device:  cuda:2
generate a random number to check random seed:  2.505138023647401
current stage is: block-1
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.5572, device='cuda:2', dtype=torch.float64)
u_obs variance
tensor([ 0.2549,  2.1147,  2.0265, 19.5728, 10.0066, 17.6194,  0.2621,  2.0391,
         2.2020, 17.7496, 10.4728, 20.5951], device='cuda:2',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
iter:     0    time: 2135.39
Func: 5.15e-02  |g|: 4.52e-01
stableloss: 1.26e-02   dataloss: 4.42e-02   sparseloss: 5.16e+01 momentloss: 7.27e+00
iter:   200    time: 10.22
Func: 2.06e-02  |g|: 7.56e-03
stableloss: 7.80e-03   dataloss: 1.41e-02   sparseloss: 5.34e+01 momentloss: 6.50e+00
iter:   400    time: 10.13
Func: 1.98e-02  |g|: 5.54e-03
stableloss: 7.52e-03   dataloss: 1.34e-02   sparseloss: 6.43e+01 momentloss: 6.48e+00
iter:   600    time: 10.11
Func: 1.96e-02  |g|: 6.41e-03
stableloss: 7.63e-03   dataloss: 1.31e-02   sparseloss: 7.16e+01 momentloss: 6.47e+00
iter:   800    time: 10.17
Func: 1.95e-02  |g|: 1.08e-02
stableloss: 7.60e-03   dataloss: 1.31e-02   sparseloss: 7.63e+01 momentloss: 6.46e+00
iter:  1000    time: 10.15
Func: 1.94e-02  |g|: 9.85e-03
stableloss: 7.54e-03   dataloss: 1.30e-02   sparseloss: 8.16e+01 momentloss: 6.46e+00
iter:  1200    time: 10.11
Func: 1.94e-02  |g|: 2.40e-02
stableloss: 7.49e-03   dataloss: 1.29e-02   sparseloss: 8.63e+01 momentloss: 6.45e+00
iter:  1400    time: 10.16
Func: 1.93e-02  |g|: 2.86e-02
stableloss: 7.48e-03   dataloss: 1.29e-02   sparseloss: 1.02e+02 momentloss: 6.45e+00
iter:  1600    time: 10.15
Func: 1.93e-02  |g|: 7.98e-03
stableloss: 7.48e-03   dataloss: 1.29e-02   sparseloss: 1.07e+02 momentloss: 6.45e+00
iter:  1800    time: 10.19
Func: 1.93e-02  |g|: 2.94e-02
stableloss: 7.49e-03   dataloss: 1.29e-02   sparseloss: 1.22e+02 momentloss: 6.46e+00
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 0.019289
         Iterations: 1992
         Function evaluations: 2053
         Gradient evaluations: 2045
convolution moment and kernels
[[ 1.00e+00  0.00e+00 -3.41e-05 -1.76e-03 -9.56e-03]
 [ 0.00e+00 -1.49e-04  3.43e-04 -6.60e-04  5.83e-03]
 [ 6.76e-05 -1.56e-03  2.85e-03 -8.54e-04  2.37e-03]
 [-2.25e-02  3.99e-04  3.38e-03  8.15e-05 -6.05e-03]
 [-7.20e-02 -4.57e-03 -6.19e-03  2.14e-02  4.39e-03]]
[[-0.   -0.02  0.01 -0.07  0.02]
 [ 0.02  0.04  0.04  0.24 -0.07]
 [-0.05  0.04  0.74 -0.25  0.08]
 [ 0.04 -0.05  0.22  0.15 -0.05]
 [-0.01  0.02 -0.07 -0.03  0.01]]
[[ 0.00e+00  1.00e+00  0.00e+00 -1.07e-01 -6.05e-02]
 [ 0.00e+00  0.00e+00 -1.48e-03  3.11e-03  3.35e-03]
 [ 0.00e+00  1.19e-02  3.06e-03  7.03e-03 -2.82e-03]
 [-5.51e-03 -5.94e-04 -4.25e-03 -5.41e-04  1.92e-03]
 [ 6.97e-03 -3.56e-03 -4.94e-03 -7.51e-03 -1.78e-03]]
[[ 1.47e-03 -9.93e-05  4.38e-03  9.36e-03 -5.39e-03]
 [-1.46e-02  3.24e-02 -6.67e-02 -1.76e-03  1.73e-02]
 [ 1.03e-01 -5.95e-01 -2.50e-01  1.01e+00 -2.25e-01]
 [-1.71e-02  4.30e-02 -6.82e-02 -8.17e-06  1.99e-02]
 [ 3.65e-03 -1.16e-02  1.71e-02 -7.72e-04 -4.17e-03]]
[[ 0.00e+00  0.00e+00  0.00e+00  6.39e-04  8.26e-03]
 [ 1.00e+00  0.00e+00  7.71e-03  1.17e-04 -1.34e-02]
 [ 0.00e+00  1.07e-04  5.96e-03  3.62e-03  7.95e-04]
 [-9.60e-02 -9.75e-04  8.88e-03  9.61e-04 -5.47e-03]
 [-6.78e-02  1.89e-03 -9.29e-03  6.76e-03 -7.36e-04]]
[[-8.44e-04 -1.70e-02  1.02e-01 -2.58e-02  4.75e-03]
 [ 1.33e-02  1.97e-02 -5.69e-01  5.11e-02 -6.59e-03]
 [-7.40e-03 -7.69e-02 -2.19e-01 -1.26e-01  2.29e-02]
 [ 8.12e-03  3.41e-02  9.34e-01  7.17e-02 -1.39e-02]
 [-5.27e-03  7.70e-03 -1.99e-01 -4.29e-03  1.42e-03]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00 -3.54e-03]
 [ 0.00e+00  0.00e+00  0.00e+00 -9.88e-04  1.69e-03]
 [ 0.00e+00  0.00e+00  2.92e-03  1.60e-03  1.52e-03]
 [ 0.00e+00  2.66e-05  1.85e-03  1.54e-04 -3.63e-03]
 [ 3.81e-03  1.60e-03 -1.16e-03 -1.27e-03 -7.57e-03]]
[[-0.    0.02 -0.02  0.02 -0.01]
 [ 0.02 -0.08  0.12 -0.11  0.03]
 [-0.13  1.51 -2.76  1.54 -0.14]
 [ 0.03 -0.13  0.19 -0.15  0.04]
 [-0.01  0.04 -0.05  0.04 -0.01]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00 -2.58e-03]
 [ 0.00e+00  1.00e+00  0.00e+00 -1.66e-03  1.66e-03]
 [ 0.00e+00  0.00e+00  2.32e-04 -9.40e-04 -2.28e-04]
 [ 0.00e+00 -1.78e-03  9.55e-04  2.98e-03 -1.43e-03]
 [-1.46e-03 -2.43e-03  1.06e-04  2.58e-03  1.03e-03]]
[[ 0.01 -0.06  0.01  0.05 -0.  ]
 [-0.06  0.46 -0.04 -0.4   0.04]
 [-0.01  0.01  0.02 -0.04  0.01]
 [ 0.06 -0.46 -0.    0.47 -0.07]
 [-0.01  0.06 -0.   -0.06  0.01]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  4.38e-03]
 [ 0.00e+00  0.00e+00  0.00e+00 -1.17e-04  1.34e-03]
 [ 1.00e+00  0.00e+00  1.92e-03  2.87e-03  1.42e-03]
 [ 0.00e+00  2.24e-04  1.68e-03 -5.20e-04 -3.58e-03]
 [ 1.55e-04  4.10e-03 -3.84e-04 -5.37e-03 -5.95e-03]]
[[-1.04e-03  6.80e-03 -1.05e-01  2.28e-02 -7.06e-03]
 [ 6.95e-03 -4.15e-02  1.45e+00 -1.13e-01  3.45e-02]
 [-1.25e-02  7.42e-02 -2.69e+00  1.86e-01 -5.60e-02]
 [ 1.57e-02 -8.06e-02  1.51e+00 -1.54e-01  4.42e-02]
 [-4.71e-03  2.36e-02 -1.32e-01  4.09e-02 -1.13e-02]]
SymNet parameters
[[ 8.63e-01 -4.79e-02 -3.96e-01 -8.19e-03 -1.58e-02 -3.09e-03 -1.27e-01  2.98e-03
   8.47e-03 -3.61e-04 -1.51e-03 -2.10e-03]
 [-1.53e-01  1.34e-01  1.06e-03 -3.27e-03 -8.61e-03 -1.69e-03 -1.86e+00  6.35e-03
   3.25e-02 -7.97e-04 -3.87e-04  1.28e-03]]
SymNet parameters
[1.02 1.95]
SymNet parameters
[[-1.29 -2.89  0.78 -0.11 -0.11  0.03 -1.01 -0.04 -0.29 -0.02 -0.02  0.01 -0.58]
 [-2.1  -0.03 -0.02 -0.05 -0.09 -0.01  0.03  0.05  0.2   0.01 -0.01 -0.01  0.06]]
SymNet parameters
[-1.31 -0.05]
SymNet parameters
[[ 1.66 -1.06 -0.49 -0.32  0.14  0.19 -2.43 -0.36  0.17 -0.09  0.02  0.1  -0.08 -0.03]
 [-2.4  -2.5  -2.21  1.54  0.21  0.64 -1.71 -0.23  0.6  -0.35  0.27  0.33 -0.55 -0.21]]
SymNet parameters
[0.12 0.63]
SymNet parameters
[[ 6.23e-02  5.92e-01 -1.20e-02 -1.33e-02 -1.41e-02  1.42e-03  1.65e+00 -6.33e-03
  -4.23e-02  4.05e-04 -3.20e-03 -2.45e-03 -3.36e-02  8.37e-04 -6.25e-04]
 [-1.82e+00  1.38e-02 -1.13e-01  1.65e-02  3.06e-02  5.23e-03  2.88e-01 -7.12e-03
  -2.33e-02  1.23e-03  2.47e-03  3.91e-03  1.27e-02  2.70e-03 -5.55e-04]]
SymNet parameters
[-1.64 -0.64]
SymNet parameters
[[ 4.63e-03  4.77e+00  7.64e-01 -2.13e-01 -6.41e-01 -3.69e-02 -3.24e+00  2.33e-01
   8.84e-01  6.26e-02 -9.14e-02  7.07e-03 -1.10e+00  1.71e-01  1.20e-03  1.84e+00]
 [ 2.53e+00 -2.78e+00 -9.32e-01 -1.13e+00 -1.27e+00 -9.15e-02 -8.27e-01 -8.24e-01
  -3.07e+00 -9.83e-02 -2.33e-01 -1.73e-01  6.77e-01  1.32e-01  2.62e-02  2.87e-01]]
SymNet parameters
[-0.06  0.31]
SymNet parameters
[[ 1.38e-01  2.72e-01 -1.01e+00  3.82e-02 -1.06e-02  4.92e-02 -1.60e+00 -3.20e-04
   8.50e-04 -4.65e-04 -2.76e-03 -1.43e-04 -1.16e+00 -3.34e-02 -9.07e-04  5.88e-01
   7.86e-04]]
SymNet parameters
[1.7]
SymNet parameters
[[ 1.75e+00  8.04e-03 -7.45e-02  5.05e-03 -1.39e-02 -3.07e-03 -1.92e-01  2.44e-01
   4.87e-01  1.56e-02  4.60e-04 -1.08e-01]
 [-2.20e+00 -4.39e-01  2.35e-01  2.01e-01  5.69e-02 -5.93e-02  3.35e-01  1.58e+00
  -2.68e+00 -2.46e-01 -3.02e-01 -8.15e-01]]
SymNet parameters
[0.65 0.15]
SymNet parameters
[[ 2.82e-01  2.05e-01 -9.58e-02  5.93e-03  1.82e-03  1.19e-02  1.80e+00 -1.65e-01
   1.73e-01 -2.46e-02  2.98e-02  1.47e-03 -6.17e-03]
 [-6.35e-01 -1.49e-01  5.00e-02  8.38e-02  1.38e-02 -1.51e-02 -1.95e-01  1.37e+00
  -7.14e-01 -7.57e-02  1.73e-01 -2.02e-01  3.31e-03]]
SymNet parameters
[ 1.02 -0.06]
SymNet parameters
[[-5.58e-01  1.54e-02 -6.82e-03 -4.82e-03 -6.03e-04  6.13e-04  1.02e+00 -3.52e+00
  -2.10e+00  6.30e-03 -2.49e-02  1.14e-02 -1.63e-02  6.33e-02]
 [-6.42e-01 -5.47e-03  1.54e-02  3.42e-03  1.44e-03 -4.75e-05 -2.29e+00  2.61e-01
  -6.52e-02 -3.88e-03  2.60e-03 -9.54e-03 -7.18e-04 -1.40e-02]]
SymNet parameters
[-0.08  1.76]
SymNet parameters
[[-0.18 -0.05  1.41  0.17 -0.04 -0.01 -0.52 -0.01 -1.76  0.82 -0.37 -0.78  0.81  0.03
   1.86]
 [-2.07 -0.1   0.55  0.08  0.01 -0.01 -0.93  2.49 -0.31 -0.07  0.02 -0.23 -0.   -0.01
   0.01]]
SymNet parameters
[-0.02  0.22]
SymNet parameters
[[-1.94e-01 -9.51e-03  1.71e-03  3.56e-03  1.23e-03  2.09e-04 -6.19e-01  2.17e+00
  -5.83e-01 -4.88e-03  9.79e-03 -9.54e-03 -3.33e-03 -4.51e-02  3.55e-03 -1.11e-04]
 [ 8.14e-01  1.14e-03  1.33e-03  1.72e-03  5.84e-04 -4.38e-04 -1.31e+00  1.32e-01
   7.96e-02  2.62e-04  1.24e-03 -3.92e-03  2.77e-03 -4.37e-03  2.83e-03  8.65e-06]]
SymNet parameters
[0.23 0.73]
SymNet parameters
[[-1.15e-01  4.84e-03  2.88e-03  1.05e-03 -1.66e-04 -7.16e-06 -2.33e-02 -2.39e-01
  -7.05e-01  5.17e-02 -3.42e-03  4.70e-02 -4.33e-03  8.37e-03 -1.45e-01  8.83e-04
  -4.16e-01]]
SymNet parameters
[0.04]
finally, finish this stage
iter:  1992    time: 11.87
Func: 1.93e-02  |g|: 1.35e-02
stableloss: 7.52e-03   dataloss: 1.28e-02   sparseloss: 1.40e+02 momentloss: 6.46e+00
current expression:
[u00*u01, u10*v00, u20, u02, u00*u01**2, u01*v00, u00*u01*v00, u00*u11*v00, u01*u10*v00, u10*v00*v10, u00, u01*u10, 1, u01, v00*v10, u00**2*u01, v00, u10, u00**3, u01*v00**2]
[-0.98 -0.97  0.05  0.04  0.01  0.01  0.01  0.01  0.01  0.01  0.01  0.    0.    0.
 -0.   -0.    0.    0.   -0.   -0.  ]
[v00*v10, u00*v01, v02, v20, v00*v10**2, u00*v01*v10, u00*v00*v11, u10*v00*v01, 1, u00*u01*v01, u00*v10, v01, u10, v00**2*v10, u10*v01, u10*v00, u00, u00**2, v00*v01, u00**2*v10]
[-0.98 -0.97  0.05  0.05  0.01  0.01  0.01  0.01 -0.01  0.01  0.01  0.    0.    0.
  0.   -0.   -0.    0.    0.   -0.  ]
block:  2
name:  burgers-2-upwind-sparse0-noise0.001-id10
device:  cuda:2
generate a random number to check random seed:  -0.43245514621457004
current stage is: block-2
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.6206, device='cuda:2', dtype=torch.float64)
u_obs variance
tensor([ 0.2609,  1.7810,  1.7221, 22.8145, 11.0551, 20.9621,  0.2646,  1.7707,
         1.8246, 20.8188, 10.7838, 23.8281], device='cuda:2',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
iter:     0    time: 3207.25
Func: 8.44e-02  |g|: 4.87e+01
stableloss: 2.62e-02   dataloss: 7.15e-02   sparseloss: 1.40e+02 momentloss: 6.46e+00
iter:   200    time: 14.31
Func: 6.80e-02  |g|: 6.29e-01
stableloss: 2.55e-02   dataloss: 5.36e-02   sparseloss: 1.41e+02 momentloss: 7.22e+00
iter:   400    time: 14.27
Func: 6.65e-02  |g|: 2.63e-01
stableloss: 2.48e-02   dataloss: 5.22e-02   sparseloss: 1.43e+02 momentloss: 7.16e+00
iter:   600    time: 14.24
Func: 6.61e-02  |g|: 1.14e+00
stableloss: 2.50e-02   dataloss: 5.17e-02   sparseloss: 1.49e+02 momentloss: 7.20e+00
iter:   800    time: 14.29
Func: 6.58e-02  |g|: 1.87e+00
stableloss: 2.52e-02   dataloss: 5.14e-02   sparseloss: 1.60e+02 momentloss: 7.22e+00
iter:  1000    time: 14.21
Func: 6.56e-02  |g|: 5.18e-01
stableloss: 2.53e-02   dataloss: 5.11e-02   sparseloss: 1.80e+02 momentloss: 7.26e+00
iter:  1200    time: 14.41
Func: 6.54e-02  |g|: 4.65e-01
stableloss: 2.53e-02   dataloss: 5.08e-02   sparseloss: 1.94e+02 momentloss: 7.31e+00
iter:  1400    time: 14.26
Func: 6.52e-02  |g|: 1.60e+00
stableloss: 2.53e-02   dataloss: 5.06e-02   sparseloss: 2.22e+02 momentloss: 7.32e+00
iter:  1600    time: 14.31
Func: 6.52e-02  |g|: 1.19e+00
stableloss: 2.53e-02   dataloss: 5.05e-02   sparseloss: 2.42e+02 momentloss: 7.32e+00
iter:  1800    time: 14.28
Func: 6.51e-02  |g|: 1.42e+00
stableloss: 2.53e-02   dataloss: 5.05e-02   sparseloss: 2.80e+02 momentloss: 7.31e+00
Warning: Maximum number of iterations has been exceeded.
         Current function value: 0.064960
         Iterations: 2000
         Function evaluations: 2015
         Gradient evaluations: 2015
convolution moment and kernels
[[ 1.00e+00  0.00e+00  1.13e-03  2.85e-02 -9.67e-02]
 [ 0.00e+00 -1.57e-04 -3.15e-03 -4.22e-03  7.60e-03]
 [ 1.82e-03  3.29e-03  1.20e-02 -6.27e-03 -6.48e-03]
 [ 6.64e-02 -3.21e-03 -8.25e-04  7.24e-03 -4.10e-04]
 [-8.43e-02 -4.84e-04 -8.92e-03 -2.07e-03  2.49e-03]]
[[ 0.01 -0.03 -0.07 -0.02  0.  ]
 [-0.03  0.17  0.13  0.16 -0.02]
 [-0.08  0.19  0.3   0.11 -0.04]
 [-0.01  0.1   0.07  0.14 -0.02]
 [ 0.   -0.02 -0.01 -0.03  0.  ]]
[[ 0.00e+00  1.00e+00  0.00e+00 -1.01e-01 -7.43e-02]
 [ 0.00e+00  0.00e+00  3.81e-05  2.64e-03  2.68e-03]
 [ 0.00e+00  3.11e-02  2.43e-03  3.25e-02 -1.44e-02]
 [ 6.52e-03  9.55e-03  7.05e-04 -5.66e-03  2.01e-03]
 [ 9.04e-03 -5.50e-03  3.77e-03 -5.90e-03 -1.59e-03]]
[[ 2.70e-04  1.20e-02 -9.28e-03  5.95e-03 -3.15e-03]
 [-3.53e-02  4.63e-02 -7.73e-02  2.47e-02  1.20e-02]
 [ 1.34e-01 -5.97e-01 -2.74e-01  1.02e+00 -2.32e-01]
 [-4.47e-02  7.39e-02 -8.96e-02 -2.93e-03  2.07e-02]
 [ 5.62e-03 -5.80e-03  4.87e-03  1.31e-02 -5.49e-03]]
[[ 0.00e+00  0.00e+00  0.00e+00 -1.09e-03  3.44e-03]
 [ 1.00e+00  0.00e+00  1.37e-02  4.92e-03 -2.17e-02]
 [ 0.00e+00 -2.17e-03 -8.32e-03  3.19e-03  6.76e-04]
 [-9.88e-02  1.28e-03  2.35e-02  2.07e-03 -4.19e-03]
 [-8.10e-02 -1.14e-02 -2.21e-02  1.36e-02 -3.21e-03]]
[[-0.01 -0.01  0.11 -0.05  0.01]
 [ 0.05 -0.05 -0.53  0.11 -0.01]
 [-0.05  0.04 -0.31 -0.19  0.03]
 [ 0.03 -0.01  0.95  0.15 -0.03]
 [-0.01  0.02 -0.21 -0.02  0.01]]
[[ 0.    0.    1.    0.    0.  ]
 [ 0.    0.    0.    0.   -0.  ]
 [ 0.    0.    0.   -0.    0.  ]
 [ 0.   -0.   -0.    0.    0.01]
 [ 0.08  0.    0.   -0.   -0.02]]
[[-0.03  0.11 -0.09  0.11 -0.03]
 [ 0.1  -0.41  0.31 -0.43  0.11]
 [-0.22  1.88 -2.86  1.91 -0.23]
 [ 0.09 -0.35  0.21 -0.36  0.09]
 [-0.02  0.08 -0.04  0.08 -0.02]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00 -2.68e-03]
 [ 0.00e+00  1.00e+00  0.00e+00 -1.78e-03  8.03e-03]
 [ 0.00e+00  0.00e+00 -9.80e-04  1.01e-03  2.59e-03]
 [ 0.00e+00 -2.60e-03  4.37e-03  5.34e-03 -7.66e-02]
 [-2.93e-03  1.55e-02  5.38e-03 -1.62e-01 -3.89e-02]]
[[ 0.09 -0.23 -0.01  0.24 -0.09]
 [-0.31  0.81  0.52 -1.48  0.47]
 [ 0.25 -0.02 -1.56  2.05 -0.74]
 [-0.03 -0.76  1.53 -1.24  0.51]
 [-0.    0.21 -0.49  0.44 -0.15]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  1.35e-01]
 [ 0.00e+00  0.00e+00  0.00e+00  1.06e-03  3.33e-04]
 [ 1.00e+00  0.00e+00  5.17e-03  1.88e-03 -3.85e-03]
 [ 0.00e+00 -1.95e-03 -2.40e-03  1.96e-03  3.61e-03]
 [ 8.20e-03  9.38e-03 -2.15e-03 -3.19e-02 -2.01e-03]]
[[ 0.01 -0.03 -0.09  0.05 -0.02]
 [-0.06  0.15  1.31 -0.17  0.07]
 [ 0.24 -0.8  -1.59 -0.33  0.03]
 [-0.07  0.18  1.25 -0.13  0.07]
 [ 0.02 -0.04 -0.07  0.03 -0.02]]
SymNet parameters
[[ 2.17e+00  8.57e-03 -8.47e-02  4.56e-02  5.73e-03 -1.41e-02  7.95e-02 -3.54e-02
  -2.17e-01  1.04e-02 -7.11e-03 -1.79e-03]
 [ 3.87e-01  7.44e-01  5.98e-01 -1.81e-01 -1.25e-01 -1.49e-02 -4.51e+00  3.44e-01
  -1.99e-01 -1.62e-03 -1.58e-02 -6.57e-03]]
SymNet parameters
[ 1.86 -0.84]
SymNet parameters
[[ 7.32e+00 -6.34e-01  1.35e+01 -7.03e-01 -2.71e-01  1.80e-02 -2.08e+00  3.33e-01
   1.57e+00 -7.74e-02  2.45e-02 -1.43e-02 -4.06e-01]
 [-4.73e+00  3.12e-01  2.49e-01 -1.44e-01 -4.17e-02  2.43e-02  5.33e-01  1.41e-01
   3.96e-01 -2.39e-02  8.73e-03  3.30e-04 -2.48e-02]]
SymNet parameters
[0.2  1.54]
SymNet parameters
[[ 1.25e+00  5.54e-01  5.81e-01 -5.27e-01 -4.08e-01 -4.03e-02 -6.67e+00  3.83e-01
   2.44e-03 -3.56e-02 -2.82e-02 -1.70e-02 -6.92e-04 -2.11e-03]
 [-4.50e+00 -3.19e+00 -8.97e+00  1.41e+00 -9.58e-02  8.91e-02 -8.70e+00 -1.31e+00
  -1.77e-01  6.76e-02  4.93e-02  1.84e-04  2.41e-01  1.02e-03]]
SymNet parameters
[0.66 0.56]
SymNet parameters
[[ 9.58e-02 -5.75e-01  3.45e-01  1.71e-01  1.31e-01  1.74e-02  5.08e+00 -3.96e-01
   3.27e-01 -2.45e-03  2.00e-02  6.69e-03 -3.04e-02  1.85e-04 -5.73e-04]
 [-2.68e+00  1.41e-02  4.31e-02 -6.47e-02 -7.01e-03  1.75e-02 -7.31e-02  4.90e-02
   2.80e-01 -1.36e-02  8.74e-03  2.16e-03 -1.82e-03 -7.69e-05  6.72e-06]]
SymNet parameters
[ 1.03 -1.53]
SymNet parameters
[[ 8.66e+00  5.93e+00  3.83e+00  1.30e-01  2.12e-01  9.23e-03 -4.88e+00 -6.24e-01
   5.94e-02  2.31e-02 -1.02e-02  3.21e-02 -9.04e-01 -1.32e-02 -4.09e-03  5.63e-01]
 [-4.46e+00 -2.16e+00  7.05e+00  3.09e+00  7.17e-01 -8.35e-01 -4.77e+00 -2.82e+00
  -1.56e+01  7.13e-01 -5.52e-01 -1.49e-01  2.10e+00  1.20e-01  1.34e-02 -1.31e+00]]
SymNet parameters
[0.08 0.38]
SymNet parameters
[[ 1.58e+00  1.01e+00  2.88e+00 -2.05e-01 -1.50e-01  4.11e-02 -4.42e+00  3.29e-01
   4.40e-02 -1.23e-02 -1.15e-02 -8.53e-03 -1.42e+00 -3.95e-02 -3.27e-03  9.13e-01
   8.25e-04]]
SymNet parameters
[-0.67]
SymNet parameters
[[ 6.37e-01  1.28e-02 -2.60e-03 -5.99e-03  6.85e-03  6.28e-04 -6.09e-02  9.97e-02
   3.65e-01 -2.02e-02  6.70e-04 -8.54e-02]
 [-5.15e-01 -2.49e-02  2.88e-01 -4.77e-02 -1.00e-01 -8.69e-02  1.12e+00  6.17e+00
  -5.18e+00 -3.90e-01 -2.17e-01 -9.95e-01]]
SymNet parameters
[ 6.08 -3.88]
SymNet parameters
[[ 4.31e-02  1.96e-01 -3.91e-02  1.36e-03  7.88e-03  3.04e-03  1.88e+00 -1.33e-01
   2.65e-01 -6.11e-03  1.82e-02  6.27e-03  1.43e-03]
 [-8.20e-02 -1.46e-02  1.61e-02  9.13e-03 -1.01e-02  8.56e-03  3.10e-01  2.26e+00
  -2.88e-01 -3.21e-02  2.16e-01 -5.71e-02  5.31e-03]]
SymNet parameters
[-1.77 -2.75]
SymNet parameters
[[ 3.65e-02  1.53e-01  3.21e-02  5.60e-03  1.43e-02  3.47e-03 -5.40e-01 -8.97e+00
  -2.46e+00 -2.12e-02  4.19e-02  5.91e-03  6.39e-03  2.36e-01]
 [ 3.49e-01 -1.38e-03  7.71e-02 -4.81e-03 -4.03e-03 -2.52e-03 -5.39e+00  4.69e-01
   7.33e-02 -5.23e-03 -8.21e-03 -6.33e-02 -4.65e-03 -1.53e-02]]
SymNet parameters
[5.58 2.21]
SymNet parameters
[[-7.19e-01  7.74e-01 -1.14e+00  3.10e-01  9.00e-01  2.13e-01 -1.80e+00  4.03e-01
  -4.66e+00  1.51e+00  2.47e-01  5.76e+00  8.50e-01  8.04e-02  3.66e-01]
 [-5.84e+00 -5.90e-02  5.62e-01  9.39e-04  2.38e-02  5.14e-03  4.13e-01  1.67e+00
   1.94e+00 -3.10e-02 -1.96e-02 -2.05e-01  6.75e-03 -6.31e-02 -3.02e-03]]
SymNet parameters
[-0.01  0.64]
SymNet parameters
[[ 1.90e-02 -8.05e-02 -9.60e-03 -3.84e-03 -9.45e-03 -3.44e-03  2.98e-01  4.80e+00
   8.46e-01  5.42e-03 -2.70e-02 -1.91e-02 -6.04e-03 -1.25e-01 -2.83e-05  2.64e-05]
 [ 4.81e-01  1.08e-03  5.49e-02 -3.44e-03 -2.18e-03 -1.88e-03 -3.66e+00  3.12e-01
   7.82e-02 -2.82e-03 -5.24e-03 -4.08e-02 -2.69e-03 -1.07e-02  1.42e-04  1.46e-06]]
SymNet parameters
[-2.63  1.01]
SymNet parameters
[[-5.04e-01  2.65e-02  2.73e-02 -6.35e-04 -1.50e-03 -9.28e-04 -9.66e-01 -1.40e+00
  -8.65e-01  3.98e-02  4.22e-03  1.05e-02 -3.98e-03  5.03e-02 -2.52e-01  6.07e-04
  -7.04e-01]]
SymNet parameters
[1.15]
finally, finish this stage
iter:  2000    time: 14.61
Func: 6.50e-02  |g|: 9.99e-01
stableloss: 2.52e-02   dataloss: 5.04e-02   sparseloss: 3.03e+02 momentloss: 7.30e+00
current expression:
[u00*u01, u10*v00, u20, u02, u00*u01**2, u00*u11*v00, u01*u10*v00, u10*v00*v10, u00*u10*v01, u00*v00, u01, u01*u10, u10*v10, u10, v00, v00*v01, 1, u00, u00*u01*v00, u00**2*v00]
[-0.98 -0.97  0.05  0.05  0.01  0.01  0.01  0.01  0.01  0.01 -0.01 -0.   -0.    0.
 -0.   -0.   -0.    0.   -0.    0.  ]
[v00*v10, u00*v01, v02, v20, v00*v10**2, u00*v01*v10, u00*u01*v01, u00*v00*v11, u10*v00*v01, u00*v10, u00**2*v10, u10*v01, u00*v00*v01, v10, u00*v00**2*v10, v01*v10, v00**2*v10, u00, v10**2, v00]
[-0.98 -0.97  0.05  0.05  0.01  0.01  0.01  0.01  0.01  0.    0.   -0.   -0.   -0.
 -0.   -0.   -0.   -0.   -0.    0.  ]
block:  3
name:  burgers-2-upwind-sparse0-noise0.001-id10
device:  cuda:2
generate a random number to check random seed:  0.043744035087047606
current stage is: block-3
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.9472, device='cuda:2', dtype=torch.float64)
u_obs variance
tensor([ 0.2667,  1.8523,  1.7445, 23.7917, 11.4484, 18.7898,  0.2306,  1.6620,
         1.6971, 19.6048, 11.8287, 21.3271], device='cuda:2',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 0.178373
         Iterations: 0
         Function evaluations: 15
         Gradient evaluations: 3
convolution moment and kernels
[[ 1.00e+00  0.00e+00  1.13e-03  2.85e-02 -9.67e-02]
 [ 0.00e+00 -1.57e-04 -3.15e-03 -4.22e-03  7.60e-03]
 [ 1.82e-03  3.29e-03  1.20e-02 -6.27e-03 -6.48e-03]
 [ 6.64e-02 -3.21e-03 -8.25e-04  7.24e-03 -4.09e-04]
 [-8.43e-02 -4.84e-04 -8.92e-03 -2.07e-03  2.49e-03]]
[[ 0.01 -0.03 -0.07 -0.02  0.  ]
 [-0.03  0.17  0.13  0.16 -0.02]
 [-0.08  0.19  0.3   0.11 -0.04]
 [-0.01  0.1   0.07  0.14 -0.02]
 [ 0.   -0.02 -0.01 -0.03  0.  ]]
[[ 0.00e+00  1.00e+00  0.00e+00 -1.01e-01 -7.43e-02]
 [ 0.00e+00  0.00e+00  3.81e-05  2.64e-03  2.68e-03]
 [ 0.00e+00  3.11e-02  2.43e-03  3.25e-02 -1.44e-02]
 [ 6.52e-03  9.55e-03  7.05e-04 -5.66e-03  2.01e-03]
 [ 9.04e-03 -5.50e-03  3.77e-03 -5.90e-03 -1.59e-03]]
[[ 2.68e-04  1.20e-02 -9.29e-03  5.96e-03 -3.15e-03]
 [-3.53e-02  4.63e-02 -7.73e-02  2.46e-02  1.20e-02]
 [ 1.34e-01 -5.97e-01 -2.74e-01  1.02e+00 -2.32e-01]
 [-4.47e-02  7.38e-02 -8.96e-02 -2.95e-03  2.07e-02]
 [ 5.62e-03 -5.79e-03  4.86e-03  1.31e-02 -5.49e-03]]
[[ 0.00e+00  0.00e+00  0.00e+00 -1.09e-03  3.44e-03]
 [ 1.00e+00  0.00e+00  1.37e-02  4.92e-03 -2.17e-02]
 [ 0.00e+00 -2.17e-03 -8.32e-03  3.19e-03  6.77e-04]
 [-9.88e-02  1.28e-03  2.35e-02  2.07e-03 -4.19e-03]
 [-8.10e-02 -1.14e-02 -2.21e-02  1.36e-02 -3.21e-03]]
[[-0.01 -0.01  0.11 -0.05  0.01]
 [ 0.05 -0.05 -0.53  0.11 -0.01]
 [-0.05  0.04 -0.31 -0.19  0.03]
 [ 0.03 -0.01  0.95  0.15 -0.03]
 [-0.01  0.02 -0.21 -0.02  0.01]]
[[ 0.    0.    1.    0.    0.  ]
 [ 0.    0.    0.    0.   -0.  ]
 [ 0.    0.    0.   -0.    0.  ]
 [ 0.   -0.   -0.    0.    0.01]
 [ 0.08  0.    0.   -0.   -0.02]]
[[-0.03  0.11 -0.09  0.11 -0.03]
 [ 0.1  -0.41  0.31 -0.43  0.11]
 [-0.22  1.88 -2.86  1.91 -0.23]
 [ 0.09 -0.35  0.21 -0.36  0.09]
 [-0.02  0.08 -0.04  0.08 -0.02]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00 -2.68e-03]
 [ 0.00e+00  1.00e+00  0.00e+00 -1.78e-03  8.03e-03]
 [ 0.00e+00  0.00e+00 -9.80e-04  1.01e-03  2.59e-03]
 [ 0.00e+00 -2.60e-03  4.37e-03  5.34e-03 -7.66e-02]
 [-2.93e-03  1.55e-02  5.38e-03 -1.62e-01 -3.89e-02]]
[[ 0.09 -0.23 -0.01  0.24 -0.09]
 [-0.31  0.81  0.52 -1.48  0.47]
 [ 0.25 -0.02 -1.56  2.05 -0.74]
 [-0.03 -0.76  1.53 -1.24  0.51]
 [-0.    0.21 -0.49  0.44 -0.15]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  1.35e-01]
 [ 0.00e+00  0.00e+00  0.00e+00  1.06e-03  3.33e-04]
 [ 1.00e+00  0.00e+00  5.17e-03  1.88e-03 -3.85e-03]
 [ 0.00e+00 -1.95e-03 -2.40e-03  1.96e-03  3.61e-03]
 [ 8.20e-03  9.38e-03 -2.15e-03 -3.19e-02 -2.01e-03]]
[[ 0.01 -0.03 -0.09  0.05 -0.02]
 [-0.06  0.15  1.31 -0.17  0.07]
 [ 0.24 -0.8  -1.59 -0.33  0.03]
 [-0.07  0.18  1.25 -0.13  0.07]
 [ 0.02 -0.04 -0.07  0.03 -0.02]]
SymNet parameters
[[ 2.17e+00  8.57e-03 -8.47e-02  4.57e-02  5.73e-03 -1.41e-02  7.95e-02 -3.54e-02
  -2.17e-01  1.04e-02 -7.11e-03 -1.79e-03]
 [ 3.87e-01  7.44e-01  5.98e-01 -1.81e-01 -1.25e-01 -1.49e-02 -4.51e+00  3.44e-01
  -1.99e-01 -1.62e-03 -1.58e-02 -6.57e-03]]
SymNet parameters
[ 1.86 -0.84]
SymNet parameters
[[ 7.32e+00 -6.34e-01  1.35e+01 -7.03e-01 -2.71e-01  1.80e-02 -2.08e+00  3.33e-01
   1.57e+00 -7.74e-02  2.45e-02 -1.43e-02 -4.06e-01]
 [-4.73e+00  3.12e-01  2.49e-01 -1.44e-01 -4.17e-02  2.43e-02  5.33e-01  1.41e-01
   3.96e-01 -2.39e-02  8.73e-03  3.30e-04 -2.48e-02]]
SymNet parameters
[0.2  1.54]
SymNet parameters
[[ 1.25e+00  5.54e-01  5.81e-01 -5.27e-01 -4.08e-01 -4.03e-02 -6.67e+00  3.83e-01
   2.44e-03 -3.56e-02 -2.82e-02 -1.70e-02 -6.92e-04 -2.11e-03]
 [-4.50e+00 -3.19e+00 -8.97e+00  1.41e+00 -9.58e-02  8.91e-02 -8.70e+00 -1.31e+00
  -1.77e-01  6.76e-02  4.93e-02  1.84e-04  2.41e-01  1.02e-03]]
SymNet parameters
[0.66 0.56]
SymNet parameters
[[ 9.58e-02 -5.75e-01  3.45e-01  1.71e-01  1.31e-01  1.74e-02  5.08e+00 -3.96e-01
   3.27e-01 -2.45e-03  2.00e-02  6.70e-03 -3.04e-02  2.54e-04 -5.16e-04]
 [-2.68e+00  1.41e-02  4.31e-02 -6.47e-02 -7.01e-03  1.75e-02 -7.31e-02  4.90e-02
   2.80e-01 -1.36e-02  8.74e-03  2.16e-03 -1.84e-03 -2.60e-05  2.03e-04]]
SymNet parameters
[ 1.03 -1.53]
SymNet parameters
[[ 8.66e+00  5.93e+00  3.83e+00  1.30e-01  2.12e-01  9.23e-03 -4.88e+00 -6.24e-01
   5.94e-02  2.31e-02 -1.02e-02  3.21e-02 -9.04e-01 -1.32e-02 -4.09e-03  5.63e-01]
 [-4.46e+00 -2.16e+00  7.05e+00  3.09e+00  7.17e-01 -8.35e-01 -4.77e+00 -2.82e+00
  -1.56e+01  7.13e-01 -5.52e-01 -1.49e-01  2.10e+00  1.20e-01  1.34e-02 -1.31e+00]]
SymNet parameters
[0.08 0.38]
SymNet parameters
[[ 1.58e+00  1.01e+00  2.88e+00 -2.05e-01 -1.50e-01  4.11e-02 -4.42e+00  3.29e-01
   4.40e-02 -1.23e-02 -1.15e-02 -8.53e-03 -1.42e+00 -3.95e-02 -3.29e-03  9.13e-01
   9.06e-04]]
SymNet parameters
[-0.67]
SymNet parameters
[[ 6.37e-01  1.28e-02 -2.60e-03 -5.99e-03  6.85e-03  6.27e-04 -6.09e-02  9.97e-02
   3.65e-01 -2.02e-02  6.70e-04 -8.54e-02]
 [-5.15e-01 -2.49e-02  2.88e-01 -4.77e-02 -1.00e-01 -8.69e-02  1.12e+00  6.17e+00
  -5.18e+00 -3.90e-01 -2.17e-01 -9.95e-01]]
SymNet parameters
[ 6.08 -3.88]
SymNet parameters
[[ 4.31e-02  1.96e-01 -3.91e-02  1.36e-03  7.88e-03  3.04e-03  1.88e+00 -1.33e-01
   2.65e-01 -6.11e-03  1.82e-02  6.27e-03  1.43e-03]
 [-8.20e-02 -1.46e-02  1.61e-02  9.13e-03 -1.01e-02  8.56e-03  3.10e-01  2.26e+00
  -2.88e-01 -3.21e-02  2.16e-01 -5.71e-02  5.31e-03]]
SymNet parameters
[-1.77 -2.75]
SymNet parameters
[[ 3.65e-02  1.53e-01  3.21e-02  5.60e-03  1.43e-02  3.47e-03 -5.40e-01 -8.97e+00
  -2.46e+00 -2.12e-02  4.19e-02  5.91e-03  6.39e-03  2.36e-01]
 [ 3.49e-01 -1.38e-03  7.71e-02 -4.81e-03 -4.03e-03 -2.52e-03 -5.39e+00  4.69e-01
   7.33e-02 -5.23e-03 -8.21e-03 -6.33e-02 -4.61e-03 -1.53e-02]]
SymNet parameters
[5.58 2.21]
SymNet parameters
[[-7.19e-01  7.74e-01 -1.14e+00  3.10e-01  9.00e-01  2.13e-01 -1.80e+00  4.03e-01
  -4.66e+00  1.51e+00  2.47e-01  5.76e+00  8.50e-01  8.04e-02  3.66e-01]
 [-5.84e+00 -5.90e-02  5.62e-01  9.39e-04  2.38e-02  5.14e-03  4.13e-01  1.67e+00
   1.94e+00 -3.10e-02 -1.96e-02 -2.05e-01  6.75e-03 -6.31e-02 -3.03e-03]]
SymNet parameters
[-0.01  0.64]
SymNet parameters
[[ 1.90e-02 -8.05e-02 -9.60e-03 -3.84e-03 -9.45e-03 -3.44e-03  2.98e-01  4.80e+00
   8.46e-01  5.42e-03 -2.70e-02 -1.91e-02 -6.04e-03 -1.25e-01  3.32e-05 -7.84e-04]
 [ 4.81e-01  1.08e-03  5.49e-02 -3.44e-03 -2.18e-03 -1.88e-03 -3.66e+00  3.12e-01
   7.82e-02 -2.82e-03 -5.24e-03 -4.08e-02 -2.74e-03 -1.07e-02  9.81e-05 -2.00e-04]]
SymNet parameters
[-2.63  1.01]
SymNet parameters
[[-5.04e-01  2.65e-02  2.73e-02 -6.35e-04 -1.50e-03 -9.28e-04 -9.66e-01 -1.40e+00
  -8.65e-01  3.98e-02  4.22e-03  1.05e-02 -3.98e-03  5.03e-02 -2.52e-01  6.71e-04
  -7.05e-01]]
SymNet parameters
[1.15]
finally, finish this stage
iter:     0    time: 1894.89
Func: 1.78e-01  |g|: 3.07e+02
stableloss: 2.52e-02   dataloss: 1.56e-01   sparseloss: 3.03e+02 momentloss: 7.30e+00
current expression:
[u00*u01, u10*v00, u20, u02, u00*u01**2, u00*u11*v00, u01*u10*v00, u10*v00*v10, u00*u10*v01, u00*v00, u01, u01*u10, u10*v10, u10, v00, v00*v01, 1, u00, u00*u01*v00, u00**2*v00]
[-0.98 -0.97  0.05  0.05  0.01  0.01  0.01  0.01  0.01  0.01 -0.01 -0.   -0.    0.
 -0.   -0.   -0.    0.   -0.    0.  ]
[v00*v10, u00*v01, v02, v20, v00*v10**2, u00*v01*v10, u00*u01*v01, u00*v00*v11, u10*v00*v01, u00*v10, u00**2*v10, u10*v01, u00*v00*v01, v10, u00*v00**2*v10, v01*v10, v00**2*v10, u00, v10**2, v00]
[-0.98 -0.97  0.05  0.05  0.01  0.01  0.01  0.01  0.01  0.    0.   -0.   -0.   -0.
 -0.   -0.   -0.   -0.   -0.    0.  ]
block:  4
name:  burgers-2-upwind-sparse0-noise0.001-id10
device:  cuda:2
generate a random number to check random seed:  -0.9586955138162271
current stage is: block-4
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.8235, device='cuda:2', dtype=torch.float64)
u_obs variance
tensor([ 0.2504,  1.8620,  1.6109, 25.3638, 11.4121, 17.1241,  0.2618,  1.7859,
         1.8591, 20.8381, 11.6956, 21.9981], device='cuda:2',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 0.284342
         Iterations: 0
         Function evaluations: 15
         Gradient evaluations: 3
convolution moment and kernels
[[ 1.00e+00  0.00e+00  1.13e-03  2.85e-02 -9.67e-02]
 [ 0.00e+00 -1.57e-04 -3.15e-03 -4.22e-03  7.60e-03]
 [ 1.82e-03  3.29e-03  1.20e-02 -6.27e-03 -6.48e-03]
 [ 6.64e-02 -3.21e-03 -8.25e-04  7.24e-03 -4.10e-04]
 [-8.43e-02 -4.84e-04 -8.92e-03 -2.07e-03  2.49e-03]]
[[ 0.01 -0.03 -0.07 -0.02  0.  ]
 [-0.03  0.17  0.13  0.16 -0.02]
 [-0.08  0.19  0.3   0.11 -0.04]
 [-0.01  0.1   0.07  0.14 -0.02]
 [ 0.   -0.02 -0.01 -0.03  0.  ]]
[[ 0.00e+00  1.00e+00  0.00e+00 -1.01e-01 -7.43e-02]
 [ 0.00e+00  0.00e+00  3.81e-05  2.64e-03  2.68e-03]
 [ 0.00e+00  3.11e-02  2.43e-03  3.25e-02 -1.44e-02]
 [ 6.52e-03  9.55e-03  7.05e-04 -5.66e-03  2.01e-03]
 [ 9.04e-03 -5.50e-03  3.77e-03 -5.90e-03 -1.59e-03]]
[[ 2.70e-04  1.20e-02 -9.28e-03  5.95e-03 -3.15e-03]
 [-3.53e-02  4.63e-02 -7.73e-02  2.47e-02  1.20e-02]
 [ 1.34e-01 -5.97e-01 -2.74e-01  1.02e+00 -2.32e-01]
 [-4.47e-02  7.39e-02 -8.96e-02 -2.94e-03  2.07e-02]
 [ 5.62e-03 -5.80e-03  4.87e-03  1.31e-02 -5.49e-03]]
[[ 0.00e+00  0.00e+00  0.00e+00 -1.09e-03  3.44e-03]
 [ 1.00e+00  0.00e+00  1.37e-02  4.92e-03 -2.17e-02]
 [ 0.00e+00 -2.17e-03 -8.32e-03  3.19e-03  6.77e-04]
 [-9.88e-02  1.28e-03  2.35e-02  2.07e-03 -4.19e-03]
 [-8.10e-02 -1.14e-02 -2.21e-02  1.36e-02 -3.21e-03]]
[[-0.01 -0.01  0.11 -0.05  0.01]
 [ 0.05 -0.05 -0.53  0.11 -0.01]
 [-0.05  0.04 -0.31 -0.19  0.03]
 [ 0.03 -0.01  0.95  0.15 -0.03]
 [-0.01  0.02 -0.21 -0.02  0.01]]
[[ 0.    0.    1.    0.    0.  ]
 [ 0.    0.    0.    0.   -0.  ]
 [ 0.    0.    0.   -0.    0.  ]
 [ 0.   -0.   -0.    0.    0.01]
 [ 0.08  0.    0.   -0.   -0.02]]
[[-0.03  0.11 -0.09  0.11 -0.03]
 [ 0.1  -0.41  0.31 -0.43  0.11]
 [-0.22  1.88 -2.86  1.91 -0.23]
 [ 0.09 -0.35  0.21 -0.36  0.09]
 [-0.02  0.08 -0.04  0.08 -0.02]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00 -2.68e-03]
 [ 0.00e+00  1.00e+00  0.00e+00 -1.78e-03  8.03e-03]
 [ 0.00e+00  0.00e+00 -9.80e-04  1.01e-03  2.59e-03]
 [ 0.00e+00 -2.60e-03  4.37e-03  5.34e-03 -7.66e-02]
 [-2.93e-03  1.55e-02  5.38e-03 -1.62e-01 -3.89e-02]]
[[ 0.09 -0.23 -0.01  0.24 -0.09]
 [-0.31  0.81  0.52 -1.48  0.47]
 [ 0.25 -0.02 -1.56  2.05 -0.74]
 [-0.03 -0.76  1.53 -1.24  0.51]
 [-0.    0.21 -0.49  0.44 -0.15]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  1.35e-01]
 [ 0.00e+00  0.00e+00  0.00e+00  1.06e-03  3.33e-04]
 [ 1.00e+00  0.00e+00  5.17e-03  1.88e-03 -3.85e-03]
 [ 0.00e+00 -1.95e-03 -2.40e-03  1.96e-03  3.61e-03]
 [ 8.20e-03  9.38e-03 -2.15e-03 -3.19e-02 -2.01e-03]]
[[ 0.01 -0.03 -0.09  0.05 -0.02]
 [-0.06  0.15  1.31 -0.17  0.07]
 [ 0.24 -0.8  -1.59 -0.33  0.03]
 [-0.07  0.18  1.25 -0.13  0.07]
 [ 0.02 -0.04 -0.07  0.03 -0.02]]
SymNet parameters
[[ 2.17e+00  8.57e-03 -8.47e-02  4.56e-02  5.73e-03 -1.41e-02  7.95e-02 -3.54e-02
  -2.17e-01  1.04e-02 -7.11e-03 -1.79e-03]
 [ 3.87e-01  7.44e-01  5.98e-01 -1.81e-01 -1.25e-01 -1.48e-02 -4.51e+00  3.44e-01
  -1.99e-01 -1.62e-03 -1.58e-02 -6.57e-03]]
SymNet parameters
[ 1.86 -0.84]
SymNet parameters
[[ 7.32e+00 -6.34e-01  1.35e+01 -7.03e-01 -2.71e-01  1.80e-02 -2.08e+00  3.33e-01
   1.57e+00 -7.74e-02  2.45e-02 -1.43e-02 -4.06e-01]
 [-4.73e+00  3.12e-01  2.49e-01 -1.44e-01 -4.17e-02  2.43e-02  5.33e-01  1.41e-01
   3.96e-01 -2.39e-02  8.73e-03  3.30e-04 -2.48e-02]]
SymNet parameters
[0.2  1.54]
SymNet parameters
[[ 1.25e+00  5.54e-01  5.81e-01 -5.27e-01 -4.08e-01 -4.03e-02 -6.67e+00  3.83e-01
   2.44e-03 -3.56e-02 -2.82e-02 -1.70e-02 -6.92e-04 -2.11e-03]
 [-4.50e+00 -3.19e+00 -8.97e+00  1.41e+00 -9.58e-02  8.91e-02 -8.70e+00 -1.31e+00
  -1.77e-01  6.76e-02  4.93e-02  1.84e-04  2.41e-01  1.02e-03]]
SymNet parameters
[0.66 0.56]
SymNet parameters
[[ 9.58e-02 -5.75e-01  3.45e-01  1.71e-01  1.31e-01  1.74e-02  5.08e+00 -3.96e-01
   3.27e-01 -2.45e-03  2.00e-02  6.69e-03 -3.04e-02  1.83e-04 -5.29e-04]
 [-2.68e+00  1.41e-02  4.31e-02 -6.47e-02 -7.01e-03  1.75e-02 -7.31e-02  4.90e-02
   2.80e-01 -1.36e-02  8.74e-03  2.16e-03 -1.82e-03 -9.11e-05 -1.20e-04]]
SymNet parameters
[ 1.03 -1.53]
SymNet parameters
[[ 8.66e+00  5.93e+00  3.83e+00  1.30e-01  2.12e-01  9.23e-03 -4.88e+00 -6.24e-01
   5.94e-02  2.31e-02 -1.02e-02  3.21e-02 -9.04e-01 -1.32e-02 -4.09e-03  5.63e-01]
 [-4.46e+00 -2.16e+00  7.05e+00  3.09e+00  7.17e-01 -8.35e-01 -4.77e+00 -2.82e+00
  -1.56e+01  7.13e-01 -5.52e-01 -1.49e-01  2.10e+00  1.20e-01  1.34e-02 -1.31e+00]]
SymNet parameters
[0.08 0.38]
SymNet parameters
[[ 1.58e+00  1.01e+00  2.88e+00 -2.05e-01 -1.50e-01  4.11e-02 -4.42e+00  3.29e-01
   4.40e-02 -1.23e-02 -1.15e-02 -8.53e-03 -1.42e+00 -3.95e-02 -3.29e-03  9.13e-01
   8.60e-04]]
SymNet parameters
[-0.67]
SymNet parameters
[[ 6.37e-01  1.28e-02 -2.60e-03 -5.99e-03  6.85e-03  6.28e-04 -6.09e-02  9.97e-02
   3.65e-01 -2.02e-02  6.70e-04 -8.54e-02]
 [-5.15e-01 -2.49e-02  2.88e-01 -4.77e-02 -1.00e-01 -8.69e-02  1.12e+00  6.17e+00
  -5.18e+00 -3.90e-01 -2.17e-01 -9.95e-01]]
SymNet parameters
[ 6.08 -3.88]
SymNet parameters
[[ 4.31e-02  1.96e-01 -3.91e-02  1.36e-03  7.88e-03  3.04e-03  1.88e+00 -1.33e-01
   2.65e-01 -6.11e-03  1.82e-02  6.27e-03  1.42e-03]
 [-8.20e-02 -1.46e-02  1.61e-02  9.13e-03 -1.01e-02  8.56e-03  3.10e-01  2.26e+00
  -2.88e-01 -3.21e-02  2.16e-01 -5.71e-02  5.31e-03]]
SymNet parameters
[-1.77 -2.75]
SymNet parameters
[[ 3.65e-02  1.53e-01  3.21e-02  5.60e-03  1.43e-02  3.47e-03 -5.40e-01 -8.97e+00
  -2.46e+00 -2.12e-02  4.19e-02  5.91e-03  6.40e-03  2.36e-01]
 [ 3.49e-01 -1.38e-03  7.71e-02 -4.81e-03 -4.03e-03 -2.52e-03 -5.39e+00  4.69e-01
   7.33e-02 -5.23e-03 -8.22e-03 -6.33e-02 -4.64e-03 -1.52e-02]]
SymNet parameters
[5.58 2.21]
SymNet parameters
[[-7.19e-01  7.74e-01 -1.14e+00  3.10e-01  9.00e-01  2.13e-01 -1.80e+00  4.03e-01
  -4.66e+00  1.51e+00  2.47e-01  5.76e+00  8.50e-01  8.04e-02  3.66e-01]
 [-5.84e+00 -5.90e-02  5.62e-01  9.39e-04  2.38e-02  5.14e-03  4.13e-01  1.67e+00
   1.94e+00 -3.10e-02 -1.96e-02 -2.05e-01  6.75e-03 -6.31e-02 -3.03e-03]]
SymNet parameters
[-0.01  0.64]
SymNet parameters
[[ 1.90e-02 -8.05e-02 -9.60e-03 -3.84e-03 -9.45e-03 -3.44e-03  2.98e-01  4.80e+00
   8.46e-01  5.42e-03 -2.70e-02 -1.91e-02 -6.03e-03 -1.25e-01 -7.35e-06 -3.33e-04]
 [ 4.81e-01  1.08e-03  5.49e-02 -3.44e-03 -2.18e-03 -1.88e-03 -3.66e+00  3.12e-01
   7.82e-02 -2.82e-03 -5.24e-03 -4.08e-02 -2.69e-03 -1.07e-02  2.63e-05  2.70e-04]]
SymNet parameters
[-2.63  1.01]
SymNet parameters
[[-5.04e-01  2.65e-02  2.73e-02 -6.35e-04 -1.50e-03 -9.28e-04 -9.66e-01 -1.40e+00
  -8.65e-01  3.98e-02  4.22e-03  1.05e-02 -3.97e-03  5.03e-02 -2.52e-01  6.93e-04
  -7.05e-01]]
SymNet parameters
[1.15]
finally, finish this stage
iter:     0    time: 105.80
Func: 2.84e-01  |g|: 6.43e+02
stableloss: 2.87e-02   dataloss: 2.55e-01   sparseloss: 3.03e+02 momentloss: 7.30e+00
current expression:
[u00*u01, u10*v00, u20, u02, u00*u01**2, u00*u11*v00, u01*u10*v00, u10*v00*v10, u00*u10*v01, u00*v00, u01, u01*u10, u10*v10, u10, v00, v00*v01, 1, u00, u00*u01*v00, u00**2*v00]
[-0.98 -0.97  0.05  0.05  0.01  0.01  0.01  0.01  0.01  0.01 -0.01 -0.   -0.    0.
 -0.   -0.   -0.    0.   -0.    0.  ]
[v00*v10, u00*v01, v02, v20, v00*v10**2, u00*v01*v10, u00*u01*v01, u00*v00*v11, u10*v00*v01, u00*v10, u00**2*v10, u10*v01, u00*v00*v01, v10, u00*v00**2*v10, v01*v10, v00**2*v10, u00, v10**2, v00]
[-0.98 -0.97  0.05  0.05  0.01  0.01  0.01  0.01  0.01  0.    0.   -0.   -0.   -0.
 -0.   -0.   -0.   -0.   -0.    0.  ]
block:  5
name:  burgers-2-upwind-sparse0-noise0.001-id10
device:  cuda:2
generate a random number to check random seed:  -1.4458984704213256
current stage is: block-5
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.9974, device='cuda:2', dtype=torch.float64)
u_obs variance
tensor([ 0.2675,  1.8956,  1.7507, 23.9620, 11.3752, 19.1078,  0.2222,  1.3765,
         1.6021, 15.4557,  9.3068, 20.7753], device='cuda:2',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 0.493988
         Iterations: 0
         Function evaluations: 15
         Gradient evaluations: 3
convolution moment and kernels
[[ 1.00e+00  0.00e+00  1.13e-03  2.85e-02 -9.67e-02]
 [ 0.00e+00 -1.57e-04 -3.15e-03 -4.22e-03  7.60e-03]
 [ 1.82e-03  3.29e-03  1.20e-02 -6.27e-03 -6.48e-03]
 [ 6.64e-02 -3.21e-03 -8.25e-04  7.24e-03 -4.10e-04]
 [-8.43e-02 -4.84e-04 -8.92e-03 -2.07e-03  2.49e-03]]
[[ 0.01 -0.03 -0.07 -0.02  0.  ]
 [-0.03  0.17  0.13  0.16 -0.02]
 [-0.08  0.19  0.3   0.11 -0.04]
 [-0.01  0.1   0.07  0.14 -0.02]
 [ 0.   -0.02 -0.01 -0.03  0.  ]]
[[ 0.00e+00  1.00e+00  0.00e+00 -1.01e-01 -7.43e-02]
 [ 0.00e+00  0.00e+00  3.81e-05  2.64e-03  2.68e-03]
 [ 0.00e+00  3.11e-02  2.43e-03  3.25e-02 -1.44e-02]
 [ 6.52e-03  9.55e-03  7.05e-04 -5.66e-03  2.01e-03]
 [ 9.04e-03 -5.50e-03  3.77e-03 -5.90e-03 -1.59e-03]]
[[ 2.69e-04  1.20e-02 -9.29e-03  5.95e-03 -3.15e-03]
 [-3.53e-02  4.63e-02 -7.73e-02  2.47e-02  1.20e-02]
 [ 1.34e-01 -5.97e-01 -2.74e-01  1.02e+00 -2.32e-01]
 [-4.47e-02  7.39e-02 -8.96e-02 -2.94e-03  2.07e-02]
 [ 5.62e-03 -5.80e-03  4.86e-03  1.31e-02 -5.49e-03]]
[[ 0.00e+00  0.00e+00  0.00e+00 -1.09e-03  3.44e-03]
 [ 1.00e+00  0.00e+00  1.37e-02  4.92e-03 -2.17e-02]
 [ 0.00e+00 -2.17e-03 -8.32e-03  3.19e-03  6.77e-04]
 [-9.88e-02  1.28e-03  2.35e-02  2.07e-03 -4.19e-03]
 [-8.10e-02 -1.14e-02 -2.21e-02  1.36e-02 -3.21e-03]]
[[-0.01 -0.01  0.11 -0.05  0.01]
 [ 0.05 -0.05 -0.53  0.11 -0.01]
 [-0.05  0.04 -0.31 -0.19  0.03]
 [ 0.03 -0.01  0.95  0.15 -0.03]
 [-0.01  0.02 -0.21 -0.02  0.01]]
[[ 0.    0.    1.    0.    0.  ]
 [ 0.    0.    0.    0.   -0.  ]
 [ 0.    0.    0.   -0.    0.  ]
 [ 0.   -0.   -0.    0.    0.01]
 [ 0.08  0.    0.   -0.   -0.02]]
[[-0.03  0.11 -0.09  0.11 -0.03]
 [ 0.1  -0.41  0.31 -0.43  0.11]
 [-0.22  1.88 -2.86  1.91 -0.23]
 [ 0.09 -0.35  0.21 -0.36  0.09]
 [-0.02  0.08 -0.04  0.08 -0.02]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00 -2.68e-03]
 [ 0.00e+00  1.00e+00  0.00e+00 -1.78e-03  8.03e-03]
 [ 0.00e+00  0.00e+00 -9.80e-04  1.01e-03  2.59e-03]
 [ 0.00e+00 -2.60e-03  4.37e-03  5.34e-03 -7.66e-02]
 [-2.93e-03  1.55e-02  5.38e-03 -1.62e-01 -3.89e-02]]
[[ 0.09 -0.23 -0.01  0.24 -0.09]
 [-0.31  0.81  0.52 -1.48  0.47]
 [ 0.25 -0.02 -1.56  2.05 -0.74]
 [-0.03 -0.76  1.53 -1.24  0.51]
 [-0.    0.21 -0.49  0.44 -0.15]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  1.35e-01]
 [ 0.00e+00  0.00e+00  0.00e+00  1.06e-03  3.33e-04]
 [ 1.00e+00  0.00e+00  5.17e-03  1.88e-03 -3.85e-03]
 [ 0.00e+00 -1.95e-03 -2.40e-03  1.96e-03  3.61e-03]
 [ 8.20e-03  9.38e-03 -2.15e-03 -3.19e-02 -2.01e-03]]
[[ 0.01 -0.03 -0.09  0.05 -0.02]
 [-0.06  0.15  1.31 -0.17  0.07]
 [ 0.24 -0.8  -1.59 -0.33  0.03]
 [-0.07  0.18  1.25 -0.13  0.07]
 [ 0.02 -0.04 -0.07  0.03 -0.02]]
SymNet parameters
[[ 2.17e+00  8.57e-03 -8.47e-02  4.56e-02  5.73e-03 -1.41e-02  7.95e-02 -3.54e-02
  -2.17e-01  1.04e-02 -7.11e-03 -1.79e-03]
 [ 3.87e-01  7.44e-01  5.98e-01 -1.81e-01 -1.25e-01 -1.49e-02 -4.51e+00  3.44e-01
  -1.99e-01 -1.62e-03 -1.58e-02 -6.57e-03]]
SymNet parameters
[ 1.86 -0.84]
SymNet parameters
[[ 7.32e+00 -6.34e-01  1.35e+01 -7.03e-01 -2.71e-01  1.80e-02 -2.08e+00  3.33e-01
   1.57e+00 -7.74e-02  2.45e-02 -1.43e-02 -4.06e-01]
 [-4.73e+00  3.12e-01  2.49e-01 -1.44e-01 -4.17e-02  2.43e-02  5.33e-01  1.41e-01
   3.96e-01 -2.39e-02  8.73e-03  3.30e-04 -2.48e-02]]
SymNet parameters
[0.2  1.54]
SymNet parameters
[[ 1.25e+00  5.54e-01  5.81e-01 -5.27e-01 -4.08e-01 -4.03e-02 -6.67e+00  3.83e-01
   2.44e-03 -3.56e-02 -2.82e-02 -1.70e-02 -6.92e-04 -2.11e-03]
 [-4.50e+00 -3.19e+00 -8.97e+00  1.41e+00 -9.58e-02  8.91e-02 -8.70e+00 -1.31e+00
  -1.77e-01  6.76e-02  4.93e-02  1.84e-04  2.41e-01  1.02e-03]]
SymNet parameters
[0.66 0.56]
SymNet parameters
[[ 9.58e-02 -5.75e-01  3.45e-01  1.71e-01  1.31e-01  1.74e-02  5.08e+00 -3.96e-01
   3.27e-01 -2.45e-03  2.00e-02  6.70e-03 -3.04e-02  1.54e-04 -6.34e-04]
 [-2.68e+00  1.41e-02  4.31e-02 -6.47e-02 -7.01e-03  1.75e-02 -7.31e-02  4.90e-02
   2.80e-01 -1.36e-02  8.74e-03  2.16e-03 -1.85e-03 -1.38e-04  1.74e-04]]
SymNet parameters
[ 1.03 -1.53]
SymNet parameters
[[ 8.66e+00  5.93e+00  3.83e+00  1.30e-01  2.12e-01  9.23e-03 -4.88e+00 -6.24e-01
   5.94e-02  2.31e-02 -1.02e-02  3.21e-02 -9.04e-01 -1.32e-02 -4.09e-03  5.63e-01]
 [-4.46e+00 -2.16e+00  7.05e+00  3.09e+00  7.17e-01 -8.35e-01 -4.77e+00 -2.82e+00
  -1.56e+01  7.13e-01 -5.52e-01 -1.49e-01  2.10e+00  1.20e-01  1.34e-02 -1.31e+00]]
SymNet parameters
[0.08 0.38]
SymNet parameters
[[ 1.58e+00  1.01e+00  2.88e+00 -2.05e-01 -1.50e-01  4.11e-02 -4.42e+00  3.29e-01
   4.40e-02 -1.23e-02 -1.15e-02 -8.53e-03 -1.42e+00 -3.95e-02 -3.28e-03  9.13e-01
   8.69e-04]]
SymNet parameters
[-0.67]
SymNet parameters
[[ 6.37e-01  1.28e-02 -2.60e-03 -5.99e-03  6.85e-03  6.27e-04 -6.09e-02  9.97e-02
   3.65e-01 -2.02e-02  6.70e-04 -8.54e-02]
 [-5.15e-01 -2.49e-02  2.88e-01 -4.77e-02 -1.00e-01 -8.69e-02  1.12e+00  6.17e+00
  -5.18e+00 -3.90e-01 -2.17e-01 -9.95e-01]]
SymNet parameters
[ 6.08 -3.88]
SymNet parameters
[[ 4.31e-02  1.96e-01 -3.91e-02  1.36e-03  7.88e-03  3.04e-03  1.88e+00 -1.33e-01
   2.65e-01 -6.11e-03  1.82e-02  6.27e-03  1.43e-03]
 [-8.20e-02 -1.46e-02  1.61e-02  9.13e-03 -1.01e-02  8.56e-03  3.10e-01  2.26e+00
  -2.88e-01 -3.21e-02  2.16e-01 -5.71e-02  5.31e-03]]
SymNet parameters
[-1.77 -2.75]
SymNet parameters
[[ 3.65e-02  1.53e-01  3.21e-02  5.60e-03  1.43e-02  3.47e-03 -5.40e-01 -8.97e+00
  -2.46e+00 -2.12e-02  4.19e-02  5.91e-03  6.39e-03  2.36e-01]
 [ 3.49e-01 -1.38e-03  7.71e-02 -4.81e-03 -4.03e-03 -2.52e-03 -5.39e+00  4.69e-01
   7.33e-02 -5.23e-03 -8.22e-03 -6.33e-02 -4.64e-03 -1.53e-02]]
SymNet parameters
[5.58 2.21]
SymNet parameters
[[-7.19e-01  7.74e-01 -1.14e+00  3.10e-01  9.00e-01  2.13e-01 -1.80e+00  4.03e-01
  -4.66e+00  1.51e+00  2.47e-01  5.76e+00  8.50e-01  8.04e-02  3.66e-01]
 [-5.84e+00 -5.90e-02  5.62e-01  9.39e-04  2.38e-02  5.14e-03  4.13e-01  1.67e+00
   1.94e+00 -3.10e-02 -1.96e-02 -2.05e-01  6.75e-03 -6.31e-02 -3.03e-03]]
SymNet parameters
[-0.01  0.64]
SymNet parameters
[[ 1.90e-02 -8.05e-02 -9.60e-03 -3.84e-03 -9.45e-03 -3.44e-03  2.98e-01  4.80e+00
   8.46e-01  5.42e-03 -2.70e-02 -1.91e-02 -6.06e-03 -1.25e-01 -6.33e-07 -2.52e-04]
 [ 4.81e-01  1.08e-03  5.49e-02 -3.44e-03 -2.18e-03 -1.88e-03 -3.66e+00  3.12e-01
   7.82e-02 -2.82e-03 -5.24e-03 -4.08e-02 -2.70e-03 -1.07e-02  1.36e-04  3.54e-04]]
SymNet parameters
[-2.63  1.01]
SymNet parameters
[[-5.04e-01  2.65e-02  2.73e-02 -6.35e-04 -1.50e-03 -9.27e-04 -9.66e-01 -1.40e+00
  -8.65e-01  3.98e-02  4.22e-03  1.05e-02 -3.99e-03  5.03e-02 -2.52e-01  6.36e-04
  -7.05e-01]]
SymNet parameters
[1.15]
finally, finish this stage
iter:     0    time: 106.31
Func: 4.94e-01  |g|: 9.09e+02
stableloss: 4.96e-02   dataloss: 4.57e-01   sparseloss: 3.03e+02 momentloss: 7.30e+00
current expression:
[u00*u01, u10*v00, u20, u02, u00*u01**2, u00*u11*v00, u01*u10*v00, u10*v00*v10, u00*u10*v01, u00*v00, u01, u01*u10, u10*v10, u10, v00, v00*v01, 1, u00, u00*u01*v00, u00**2*v00]
[-0.98 -0.97  0.05  0.05  0.01  0.01  0.01  0.01  0.01  0.01 -0.01 -0.   -0.    0.
 -0.   -0.   -0.    0.   -0.    0.  ]
[v00*v10, u00*v01, v02, v20, v00*v10**2, u00*v01*v10, u00*u01*v01, u00*v00*v11, u10*v00*v01, u00*v10, u00**2*v10, u10*v01, u00*v00*v01, v10, u00*v00**2*v10, v01*v10, v00**2*v10, u00, v10**2, v00]
[-0.98 -0.97  0.05  0.05  0.01  0.01  0.01  0.01  0.01  0.    0.   -0.   -0.   -0.
 -0.   -0.   -0.   -0.   -0.    0.  ]
block:  6
name:  burgers-2-upwind-sparse0-noise0.001-id10
device:  cuda:2
generate a random number to check random seed:  1.1243994794606433
current stage is: block-6
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.9436, device='cuda:2', dtype=torch.float64)
u_obs variance
tensor([ 0.2474,  1.7971,  1.6595, 23.0626, 11.1831, 17.9050,  0.2536,  1.7539,
         1.7810, 20.1329, 11.0709, 22.0780], device='cuda:2',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 0.878826
         Iterations: 0
         Function evaluations: 15
         Gradient evaluations: 3
convolution moment and kernels
[[ 1.00e+00  0.00e+00  1.13e-03  2.85e-02 -9.67e-02]
 [ 0.00e+00 -1.57e-04 -3.15e-03 -4.22e-03  7.60e-03]
 [ 1.82e-03  3.29e-03  1.20e-02 -6.27e-03 -6.48e-03]
 [ 6.64e-02 -3.21e-03 -8.25e-04  7.24e-03 -4.10e-04]
 [-8.43e-02 -4.84e-04 -8.92e-03 -2.07e-03  2.49e-03]]
[[ 0.01 -0.03 -0.07 -0.02  0.  ]
 [-0.03  0.17  0.13  0.16 -0.02]
 [-0.08  0.19  0.3   0.11 -0.04]
 [-0.01  0.1   0.07  0.14 -0.02]
 [ 0.   -0.02 -0.01 -0.03  0.  ]]
[[ 0.00e+00  1.00e+00  0.00e+00 -1.01e-01 -7.43e-02]
 [ 0.00e+00  0.00e+00  3.81e-05  2.64e-03  2.68e-03]
 [ 0.00e+00  3.11e-02  2.43e-03  3.25e-02 -1.44e-02]
 [ 6.52e-03  9.55e-03  7.05e-04 -5.66e-03  2.01e-03]
 [ 9.04e-03 -5.50e-03  3.77e-03 -5.90e-03 -1.59e-03]]
[[ 2.69e-04  1.20e-02 -9.28e-03  5.95e-03 -3.15e-03]
 [-3.53e-02  4.63e-02 -7.73e-02  2.47e-02  1.20e-02]
 [ 1.34e-01 -5.97e-01 -2.74e-01  1.02e+00 -2.32e-01]
 [-4.47e-02  7.39e-02 -8.96e-02 -2.94e-03  2.07e-02]
 [ 5.62e-03 -5.80e-03  4.87e-03  1.31e-02 -5.49e-03]]
[[ 0.00e+00  0.00e+00  0.00e+00 -1.09e-03  3.44e-03]
 [ 1.00e+00  0.00e+00  1.37e-02  4.92e-03 -2.17e-02]
 [ 0.00e+00 -2.17e-03 -8.32e-03  3.19e-03  6.77e-04]
 [-9.88e-02  1.28e-03  2.35e-02  2.07e-03 -4.19e-03]
 [-8.10e-02 -1.14e-02 -2.21e-02  1.36e-02 -3.21e-03]]
[[-0.01 -0.01  0.11 -0.05  0.01]
 [ 0.05 -0.05 -0.53  0.11 -0.01]
 [-0.05  0.04 -0.31 -0.19  0.03]
 [ 0.03 -0.01  0.95  0.15 -0.03]
 [-0.01  0.02 -0.21 -0.02  0.01]]
[[ 0.    0.    1.    0.    0.  ]
 [ 0.    0.    0.    0.   -0.  ]
 [ 0.    0.    0.   -0.    0.  ]
 [ 0.   -0.   -0.    0.    0.01]
 [ 0.08  0.    0.   -0.   -0.02]]
[[-0.03  0.11 -0.09  0.11 -0.03]
 [ 0.1  -0.41  0.31 -0.43  0.11]
 [-0.22  1.88 -2.86  1.91 -0.23]
 [ 0.09 -0.35  0.21 -0.36  0.09]
 [-0.02  0.08 -0.04  0.08 -0.02]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00 -2.68e-03]
 [ 0.00e+00  1.00e+00  0.00e+00 -1.78e-03  8.03e-03]
 [ 0.00e+00  0.00e+00 -9.80e-04  1.01e-03  2.59e-03]
 [ 0.00e+00 -2.60e-03  4.37e-03  5.34e-03 -7.66e-02]
 [-2.93e-03  1.55e-02  5.38e-03 -1.62e-01 -3.89e-02]]
[[ 0.09 -0.23 -0.01  0.24 -0.09]
 [-0.31  0.81  0.52 -1.48  0.47]
 [ 0.25 -0.02 -1.56  2.05 -0.74]
 [-0.03 -0.76  1.53 -1.24  0.51]
 [-0.    0.21 -0.49  0.44 -0.15]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  1.35e-01]
 [ 0.00e+00  0.00e+00  0.00e+00  1.06e-03  3.33e-04]
 [ 1.00e+00  0.00e+00  5.17e-03  1.88e-03 -3.85e-03]
 [ 0.00e+00 -1.95e-03 -2.40e-03  1.96e-03  3.61e-03]
 [ 8.20e-03  9.38e-03 -2.15e-03 -3.19e-02 -2.01e-03]]
[[ 0.01 -0.03 -0.09  0.05 -0.02]
 [-0.06  0.15  1.31 -0.17  0.07]
 [ 0.24 -0.8  -1.59 -0.33  0.03]
 [-0.07  0.18  1.25 -0.13  0.07]
 [ 0.02 -0.04 -0.07  0.03 -0.02]]
SymNet parameters
[[ 2.17e+00  8.57e-03 -8.47e-02  4.56e-02  5.73e-03 -1.41e-02  7.95e-02 -3.54e-02
  -2.17e-01  1.04e-02 -7.11e-03 -1.79e-03]
 [ 3.87e-01  7.44e-01  5.98e-01 -1.81e-01 -1.25e-01 -1.49e-02 -4.51e+00  3.44e-01
  -1.99e-01 -1.62e-03 -1.58e-02 -6.57e-03]]
SymNet parameters
[ 1.86 -0.84]
SymNet parameters
[[ 7.32e+00 -6.34e-01  1.35e+01 -7.03e-01 -2.71e-01  1.80e-02 -2.08e+00  3.33e-01
   1.57e+00 -7.74e-02  2.45e-02 -1.43e-02 -4.06e-01]
 [-4.73e+00  3.12e-01  2.49e-01 -1.44e-01 -4.17e-02  2.43e-02  5.33e-01  1.41e-01
   3.96e-01 -2.39e-02  8.73e-03  3.30e-04 -2.48e-02]]
SymNet parameters
[0.2  1.54]
SymNet parameters
[[ 1.25e+00  5.54e-01  5.81e-01 -5.27e-01 -4.08e-01 -4.03e-02 -6.67e+00  3.83e-01
   2.44e-03 -3.56e-02 -2.82e-02 -1.70e-02 -6.92e-04 -2.11e-03]
 [-4.50e+00 -3.19e+00 -8.97e+00  1.41e+00 -9.58e-02  8.91e-02 -8.70e+00 -1.31e+00
  -1.77e-01  6.76e-02  4.93e-02  1.83e-04  2.41e-01  1.02e-03]]
SymNet parameters
[0.66 0.56]
SymNet parameters
[[ 9.58e-02 -5.75e-01  3.45e-01  1.71e-01  1.31e-01  1.74e-02  5.08e+00 -3.96e-01
   3.27e-01 -2.45e-03  2.00e-02  6.70e-03 -3.04e-02  1.29e-04 -5.81e-04]
 [-2.68e+00  1.41e-02  4.31e-02 -6.47e-02 -7.01e-03  1.75e-02 -7.31e-02  4.90e-02
   2.80e-01 -1.36e-02  8.74e-03  2.16e-03 -1.82e-03 -9.90e-05 -9.70e-05]]
SymNet parameters
[ 1.03 -1.53]
SymNet parameters
[[ 8.66e+00  5.93e+00  3.83e+00  1.30e-01  2.12e-01  9.23e-03 -4.88e+00 -6.24e-01
   5.94e-02  2.31e-02 -1.02e-02  3.21e-02 -9.04e-01 -1.32e-02 -4.09e-03  5.63e-01]
 [-4.46e+00 -2.16e+00  7.05e+00  3.09e+00  7.17e-01 -8.35e-01 -4.77e+00 -2.82e+00
  -1.56e+01  7.13e-01 -5.52e-01 -1.49e-01  2.10e+00  1.20e-01  1.34e-02 -1.31e+00]]
SymNet parameters
[0.08 0.38]
SymNet parameters
[[ 1.58e+00  1.01e+00  2.88e+00 -2.05e-01 -1.50e-01  4.11e-02 -4.42e+00  3.29e-01
   4.40e-02 -1.23e-02 -1.15e-02 -8.53e-03 -1.42e+00 -3.95e-02 -3.28e-03  9.13e-01
   9.07e-04]]
SymNet parameters
[-0.67]
SymNet parameters
[[ 6.37e-01  1.28e-02 -2.60e-03 -5.99e-03  6.85e-03  6.27e-04 -6.09e-02  9.97e-02
   3.65e-01 -2.02e-02  6.70e-04 -8.54e-02]
 [-5.15e-01 -2.49e-02  2.88e-01 -4.77e-02 -1.00e-01 -8.69e-02  1.12e+00  6.17e+00
  -5.18e+00 -3.90e-01 -2.17e-01 -9.95e-01]]
SymNet parameters
[ 6.08 -3.88]
SymNet parameters
[[ 4.31e-02  1.96e-01 -3.91e-02  1.36e-03  7.88e-03  3.04e-03  1.88e+00 -1.33e-01
   2.65e-01 -6.11e-03  1.82e-02  6.27e-03  1.43e-03]
 [-8.20e-02 -1.46e-02  1.61e-02  9.13e-03 -1.01e-02  8.56e-03  3.10e-01  2.26e+00
  -2.88e-01 -3.21e-02  2.16e-01 -5.71e-02  5.31e-03]]
SymNet parameters
[-1.77 -2.75]
SymNet parameters
[[ 3.65e-02  1.53e-01  3.21e-02  5.60e-03  1.43e-02  3.47e-03 -5.40e-01 -8.97e+00
  -2.46e+00 -2.12e-02  4.19e-02  5.91e-03  6.38e-03  2.36e-01]
 [ 3.49e-01 -1.38e-03  7.71e-02 -4.81e-03 -4.03e-03 -2.52e-03 -5.39e+00  4.69e-01
   7.33e-02 -5.23e-03 -8.22e-03 -6.33e-02 -4.62e-03 -1.53e-02]]
SymNet parameters
[5.58 2.21]
SymNet parameters
[[-7.19e-01  7.74e-01 -1.14e+00  3.10e-01  9.00e-01  2.13e-01 -1.80e+00  4.03e-01
  -4.66e+00  1.51e+00  2.47e-01  5.76e+00  8.50e-01  8.04e-02  3.66e-01]
 [-5.84e+00 -5.90e-02  5.62e-01  9.39e-04  2.38e-02  5.14e-03  4.13e-01  1.67e+00
   1.94e+00 -3.10e-02 -1.96e-02 -2.05e-01  6.75e-03 -6.31e-02 -3.02e-03]]
SymNet parameters
[-0.01  0.64]
SymNet parameters
[[ 1.90e-02 -8.05e-02 -9.60e-03 -3.84e-03 -9.45e-03 -3.44e-03  2.98e-01  4.80e+00
   8.46e-01  5.42e-03 -2.70e-02 -1.91e-02 -6.06e-03 -1.25e-01 -5.06e-05 -2.26e-04]
 [ 4.81e-01  1.08e-03  5.49e-02 -3.44e-03 -2.18e-03 -1.88e-03 -3.66e+00  3.12e-01
   7.82e-02 -2.82e-03 -5.24e-03 -4.08e-02 -2.72e-03 -1.07e-02  1.96e-04 -3.88e-04]]
SymNet parameters
[-2.63  1.01]
SymNet parameters
[[-5.04e-01  2.65e-02  2.73e-02 -6.35e-04 -1.50e-03 -9.28e-04 -9.66e-01 -1.40e+00
  -8.65e-01  3.98e-02  4.22e-03  1.05e-02 -3.98e-03  5.03e-02 -2.52e-01  5.98e-04
  -7.05e-01]]
SymNet parameters
[1.15]
finally, finish this stage
iter:     0    time: 106.70
Func: 8.79e-01  |g|: 2.28e+03
stableloss: 6.75e-02   dataloss: 8.35e-01   sparseloss: 3.03e+02 momentloss: 7.30e+00
current expression:
[u00*u01, u10*v00, u20, u02, u00*u01**2, u00*u11*v00, u01*u10*v00, u10*v00*v10, u00*u10*v01, u00*v00, u01, u01*u10, u10*v10, u10, v00, v00*v01, 1, u00, u00*u01*v00, u00**2*v00]
[-0.98 -0.97  0.05  0.05  0.01  0.01  0.01  0.01  0.01  0.01 -0.01 -0.   -0.    0.
 -0.   -0.   -0.    0.   -0.    0.  ]
[v00*v10, u00*v01, v02, v20, v00*v10**2, u00*v01*v10, u00*u01*v01, u00*v00*v11, u10*v00*v01, u00*v10, u00**2*v10, u10*v01, u00*v00*v01, v10, u00*v00**2*v10, v01*v10, v00**2*v10, u00, v10**2, v00]
[-0.98 -0.97  0.05  0.05  0.01  0.01  0.01  0.01  0.01  0.    0.   -0.   -0.   -0.
 -0.   -0.   -0.   -0.   -0.    0.  ]
block:  9
name:  burgers-2-upwind-sparse0-noise0.001-id10
device:  cuda:2
generate a random number to check random seed:  -0.12460051248405157
current stage is: block-9
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.8280, device='cuda:2', dtype=torch.float64)
u_obs variance
tensor([ 0.2578,  1.7832,  1.7782, 22.4711, 12.2669, 19.5652,  0.2616,  1.7246,
         1.6450, 19.3096, 10.4852, 19.5900], device='cuda:2',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 1.795324
         Iterations: 0
         Function evaluations: 15
         Gradient evaluations: 3
convolution moment and kernels
[[ 1.00e+00  0.00e+00  1.13e-03  2.85e-02 -9.67e-02]
 [ 0.00e+00 -1.57e-04 -3.15e-03 -4.22e-03  7.60e-03]
 [ 1.82e-03  3.29e-03  1.20e-02 -6.27e-03 -6.48e-03]
 [ 6.64e-02 -3.21e-03 -8.25e-04  7.24e-03 -4.10e-04]
 [-8.43e-02 -4.84e-04 -8.92e-03 -2.07e-03  2.49e-03]]
[[ 0.01 -0.03 -0.07 -0.02  0.  ]
 [-0.03  0.17  0.13  0.16 -0.02]
 [-0.08  0.19  0.3   0.11 -0.04]
 [-0.01  0.1   0.07  0.14 -0.02]
 [ 0.   -0.02 -0.01 -0.03  0.  ]]
[[ 0.00e+00  1.00e+00  0.00e+00 -1.01e-01 -7.43e-02]
 [ 0.00e+00  0.00e+00  3.80e-05  2.64e-03  2.68e-03]
 [ 0.00e+00  3.11e-02  2.43e-03  3.25e-02 -1.44e-02]
 [ 6.52e-03  9.55e-03  7.05e-04 -5.66e-03  2.01e-03]
 [ 9.04e-03 -5.50e-03  3.77e-03 -5.90e-03 -1.59e-03]]
[[ 2.70e-04  1.20e-02 -9.28e-03  5.95e-03 -3.15e-03]
 [-3.53e-02  4.63e-02 -7.73e-02  2.47e-02  1.20e-02]
 [ 1.34e-01 -5.97e-01 -2.74e-01  1.02e+00 -2.32e-01]
 [-4.47e-02  7.39e-02 -8.96e-02 -2.94e-03  2.07e-02]
 [ 5.62e-03 -5.80e-03  4.87e-03  1.31e-02 -5.49e-03]]
[[ 0.00e+00  0.00e+00  0.00e+00 -1.09e-03  3.44e-03]
 [ 1.00e+00  0.00e+00  1.37e-02  4.92e-03 -2.17e-02]
 [ 0.00e+00 -2.17e-03 -8.32e-03  3.19e-03  6.77e-04]
 [-9.88e-02  1.28e-03  2.35e-02  2.07e-03 -4.19e-03]
 [-8.10e-02 -1.14e-02 -2.21e-02  1.36e-02 -3.21e-03]]
[[-0.01 -0.01  0.11 -0.05  0.01]
 [ 0.05 -0.05 -0.53  0.11 -0.01]
 [-0.05  0.04 -0.31 -0.19  0.03]
 [ 0.03 -0.01  0.95  0.15 -0.03]
 [-0.01  0.02 -0.21 -0.02  0.01]]
[[ 0.    0.    1.    0.    0.  ]
 [ 0.    0.    0.    0.   -0.  ]
 [ 0.    0.    0.   -0.    0.  ]
 [ 0.   -0.   -0.    0.    0.01]
 [ 0.08  0.    0.   -0.   -0.02]]
[[-0.03  0.11 -0.09  0.11 -0.03]
 [ 0.1  -0.41  0.31 -0.43  0.11]
 [-0.22  1.88 -2.86  1.91 -0.23]
 [ 0.09 -0.35  0.21 -0.36  0.09]
 [-0.02  0.08 -0.04  0.08 -0.02]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00 -2.68e-03]
 [ 0.00e+00  1.00e+00  0.00e+00 -1.78e-03  8.03e-03]
 [ 0.00e+00  0.00e+00 -9.80e-04  1.01e-03  2.59e-03]
 [ 0.00e+00 -2.60e-03  4.37e-03  5.34e-03 -7.66e-02]
 [-2.93e-03  1.55e-02  5.38e-03 -1.62e-01 -3.89e-02]]
[[ 0.09 -0.23 -0.01  0.24 -0.09]
 [-0.31  0.81  0.52 -1.48  0.47]
 [ 0.25 -0.02 -1.56  2.05 -0.74]
 [-0.03 -0.76  1.53 -1.24  0.51]
 [-0.    0.21 -0.49  0.44 -0.15]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  1.35e-01]
 [ 0.00e+00  0.00e+00  0.00e+00  1.06e-03  3.33e-04]
 [ 1.00e+00  0.00e+00  5.17e-03  1.88e-03 -3.85e-03]
 [ 0.00e+00 -1.95e-03 -2.40e-03  1.96e-03  3.61e-03]
 [ 8.20e-03  9.38e-03 -2.15e-03 -3.19e-02 -2.01e-03]]
[[ 0.01 -0.03 -0.09  0.05 -0.02]
 [-0.06  0.15  1.31 -0.17  0.07]
 [ 0.24 -0.8  -1.59 -0.33  0.03]
 [-0.07  0.18  1.25 -0.13  0.07]
 [ 0.02 -0.04 -0.07  0.03 -0.02]]
SymNet parameters
[[ 2.17e+00  8.57e-03 -8.47e-02  4.56e-02  5.73e-03 -1.41e-02  7.95e-02 -3.54e-02
  -2.17e-01  1.04e-02 -7.11e-03 -1.79e-03]
 [ 3.87e-01  7.44e-01  5.98e-01 -1.81e-01 -1.25e-01 -1.49e-02 -4.51e+00  3.44e-01
  -1.99e-01 -1.62e-03 -1.58e-02 -6.57e-03]]
SymNet parameters
[ 1.86 -0.84]
SymNet parameters
[[ 7.32e+00 -6.34e-01  1.35e+01 -7.03e-01 -2.71e-01  1.80e-02 -2.08e+00  3.33e-01
   1.57e+00 -7.74e-02  2.45e-02 -1.43e-02 -4.06e-01]
 [-4.73e+00  3.12e-01  2.49e-01 -1.44e-01 -4.17e-02  2.43e-02  5.33e-01  1.41e-01
   3.96e-01 -2.39e-02  8.73e-03  3.30e-04 -2.48e-02]]
SymNet parameters
[0.2  1.54]
SymNet parameters
[[ 1.25e+00  5.54e-01  5.81e-01 -5.27e-01 -4.08e-01 -4.03e-02 -6.67e+00  3.83e-01
   2.44e-03 -3.56e-02 -2.82e-02 -1.70e-02 -6.92e-04 -2.11e-03]
 [-4.50e+00 -3.19e+00 -8.97e+00  1.41e+00 -9.58e-02  8.91e-02 -8.70e+00 -1.31e+00
  -1.77e-01  6.76e-02  4.93e-02  1.83e-04  2.41e-01  1.02e-03]]
SymNet parameters
[0.66 0.56]
SymNet parameters
[[ 9.58e-02 -5.75e-01  3.45e-01  1.71e-01  1.31e-01  1.74e-02  5.08e+00 -3.96e-01
   3.27e-01 -2.45e-03  2.00e-02  6.70e-03 -3.04e-02  1.70e-04 -5.68e-04]
 [-2.68e+00  1.41e-02  4.31e-02 -6.47e-02 -7.01e-03  1.75e-02 -7.31e-02  4.90e-02
   2.80e-01 -1.36e-02  8.74e-03  2.16e-03 -1.82e-03 -3.44e-06  2.24e-04]]
SymNet parameters
[ 1.03 -1.53]
SymNet parameters
[[ 8.66e+00  5.93e+00  3.83e+00  1.30e-01  2.12e-01  9.23e-03 -4.88e+00 -6.24e-01
   5.94e-02  2.31e-02 -1.02e-02  3.21e-02 -9.04e-01 -1.32e-02 -4.09e-03  5.63e-01]
 [-4.46e+00 -2.16e+00  7.05e+00  3.09e+00  7.17e-01 -8.35e-01 -4.77e+00 -2.82e+00
  -1.56e+01  7.13e-01 -5.52e-01 -1.49e-01  2.10e+00  1.20e-01  1.34e-02 -1.31e+00]]
SymNet parameters
[0.08 0.38]
SymNet parameters
[[ 1.58e+00  1.01e+00  2.88e+00 -2.05e-01 -1.50e-01  4.11e-02 -4.42e+00  3.29e-01
   4.40e-02 -1.23e-02 -1.15e-02 -8.53e-03 -1.42e+00 -3.95e-02 -3.27e-03  9.13e-01
   8.76e-04]]
SymNet parameters
[-0.67]
SymNet parameters
[[ 6.37e-01  1.28e-02 -2.60e-03 -5.99e-03  6.85e-03  6.28e-04 -6.09e-02  9.97e-02
   3.65e-01 -2.02e-02  6.70e-04 -8.54e-02]
 [-5.15e-01 -2.49e-02  2.88e-01 -4.77e-02 -1.00e-01 -8.69e-02  1.12e+00  6.17e+00
  -5.18e+00 -3.90e-01 -2.17e-01 -9.95e-01]]
SymNet parameters
[ 6.08 -3.88]
SymNet parameters
[[ 4.31e-02  1.96e-01 -3.91e-02  1.36e-03  7.88e-03  3.04e-03  1.88e+00 -1.33e-01
   2.65e-01 -6.11e-03  1.82e-02  6.27e-03  1.43e-03]
 [-8.20e-02 -1.46e-02  1.61e-02  9.13e-03 -1.01e-02  8.56e-03  3.10e-01  2.26e+00
  -2.88e-01 -3.21e-02  2.16e-01 -5.71e-02  5.31e-03]]
SymNet parameters
[-1.77 -2.75]
SymNet parameters
[[ 3.65e-02  1.53e-01  3.21e-02  5.60e-03  1.43e-02  3.47e-03 -5.40e-01 -8.97e+00
  -2.46e+00 -2.12e-02  4.19e-02  5.91e-03  6.39e-03  2.36e-01]
 [ 3.49e-01 -1.38e-03  7.71e-02 -4.81e-03 -4.03e-03 -2.52e-03 -5.39e+00  4.69e-01
   7.33e-02 -5.23e-03 -8.22e-03 -6.33e-02 -4.66e-03 -1.52e-02]]
SymNet parameters
[5.58 2.21]
SymNet parameters
[[-7.19e-01  7.74e-01 -1.14e+00  3.10e-01  9.00e-01  2.13e-01 -1.80e+00  4.03e-01
  -4.66e+00  1.51e+00  2.47e-01  5.76e+00  8.50e-01  8.04e-02  3.66e-01]
 [-5.84e+00 -5.90e-02  5.62e-01  9.39e-04  2.38e-02  5.14e-03  4.13e-01  1.67e+00
   1.94e+00 -3.10e-02 -1.96e-02 -2.05e-01  6.75e-03 -6.31e-02 -3.03e-03]]
SymNet parameters
[-0.01  0.64]
SymNet parameters
[[ 1.90e-02 -8.05e-02 -9.60e-03 -3.84e-03 -9.45e-03 -3.44e-03  2.98e-01  4.80e+00
   8.46e-01  5.42e-03 -2.70e-02 -1.91e-02 -6.04e-03 -1.25e-01  4.58e-05 -3.83e-04]
 [ 4.81e-01  1.08e-03  5.49e-02 -3.44e-03 -2.18e-03 -1.88e-03 -3.66e+00  3.12e-01
   7.82e-02 -2.82e-03 -5.23e-03 -4.08e-02 -2.68e-03 -1.07e-02  1.07e-04 -1.07e-04]]
SymNet parameters
[-2.63  1.01]
SymNet parameters
[[-5.04e-01  2.65e-02  2.73e-02 -6.35e-04 -1.50e-03 -9.28e-04 -9.66e-01 -1.40e+00
  -8.65e-01  3.98e-02  4.22e-03  1.05e-02 -3.98e-03  5.03e-02 -2.52e-01  6.24e-04
  -7.05e-01]]
SymNet parameters
[1.15]
finally, finish this stage
iter:     0    time: 107.82
Func: 1.80e+00  |g|: 5.61e+03
stableloss: 7.01e-02   dataloss: 1.73e+00   sparseloss: 3.03e+02 momentloss: 7.30e+00
current expression:
[u00*u01, u10*v00, u20, u02, u00*u01**2, u00*u11*v00, u01*u10*v00, u10*v00*v10, u00*u10*v01, u00*v00, u01, u01*u10, u10*v10, u10, v00, v00*v01, 1, u00, u00*u01*v00, u00**2*v00]
[-0.98 -0.97  0.05  0.05  0.01  0.01  0.01  0.01  0.01  0.01 -0.01 -0.   -0.    0.
 -0.   -0.   -0.    0.   -0.    0.  ]
[v00*v10, u00*v01, v02, v20, v00*v10**2, u00*v01*v10, u00*u01*v01, u00*v00*v11, u10*v00*v01, u00*v10, u00**2*v10, u10*v01, u00*v00*v01, v10, u00*v00**2*v10, v01*v10, v00**2*v10, u00, v10**2, v00]
[-0.98 -0.97  0.05  0.05  0.01  0.01  0.01  0.01  0.01  0.    0.   -0.   -0.   -0.
 -0.   -0.   -0.   -0.   -0.    0.  ]
u_obs.abs().max()
tensor(3.9617, device='cuda:2', dtype=torch.float64)
model(u_obs[0],T=50*dt).abs().max()
tensor(nan, device='cuda:2', dtype=torch.float64)
model(u_obs[0],T=100*dt).abs().max()
tensor(nan, device='cuda:2', dtype=torch.float64)
--name=burgers-2-upwind-sparse0-noise0.001-id12 --kernel_size=5 --viscosity=0.05 --blocks=0-6,9 --dataname=burgers --constraint=2 --device=cuda:0 --stablize=0 --sparsity=0 --momentsparsity=0.001 --data_start_time=1 --dt=1e-2 --max_dt=1/1600 --hidden_layers=5 --start_noise=0.001 --end_noise=0.001 --scheme=upwind
0
--name=burgers-2-upwind-sparse0-noise0.001-id13 --kernel_size=5 --viscosity=0.05 --blocks=0-6,9 --dataname=burgers --constraint=2 --device=cuda:1 --stablize=0 --sparsity=0 --momentsparsity=0.001 --data_start_time=1 --dt=1e-2 --max_dt=1/1600 --hidden_layers=5 --start_noise=0.001 --end_noise=0.001 --scheme=upwind
1
--name=burgers-2-upwind-sparse0-noise0.001-id14 --kernel_size=5 --viscosity=0.05 --blocks=0-6,9 --dataname=burgers --constraint=2 --device=cuda:2 --stablize=0 --sparsity=0 --momentsparsity=0.001 --data_start_time=1 --dt=1e-2 --max_dt=1/1600 --hidden_layers=5 --start_noise=0.001 --end_noise=0.001 --scheme=upwind
2
--name=burgers-2-upwind-sparse0-noise0.001-id15 --kernel_size=5 --viscosity=0.05 --blocks=0-6,9 --dataname=burgers --constraint=2 --device=cuda:3 --stablize=0 --sparsity=0 --momentsparsity=0.001 --data_start_time=1 --dt=1e-2 --max_dt=1/1600 --hidden_layers=5 --start_noise=0.001 --end_noise=0.001 --scheme=upwind
3
wait
{'--name': 'burgers-2-upwind-sparse0-noise0.001-id15', '--dtype': 'double', '--device': 'cuda:3', '--constraint': '2', '--dt': 0.01, '--cell_num': 1, '--eps': 6.283185307179586, '--blocks': [0, 1, 2, 3, 4, 5, 6, 9], '--kernel_size': 5, '--max_order': 2, '--dx': 0.19634954084936207, '--hidden_layers': 5, '--scheme': 'upwind', '--dataname': 'burgers', '--viscosity': 0.05, '--zoom': 4, '--max_dt': 0.000625, '--batch_size': 28, '--data_timescheme': 'rk2', '--channel_names': 'u,v', '--freq': 4, '--data_start_time': 1.0, '--start_noise': 0.001, '--end_noise': 0.001, '--stablize': 0.0, '--sparsity': 0.0, '--momentsparsity': 0.001, '--npseed': -1, '--torchseed': -1, '--maxiter': 2000, '--recordfile': 'None', '--recordcycle': 200, '--savecycle': -1, '--start_from': -1}
Traceback (most recent call last):
  File "train.py", line 58, in <module>
    globalnames, callback, model, data_model, sampling, addnoise = setenv.setenv(options)
  File "/data/users2/sajad/code/PDE-Net/setenv.py", line 68, in setenv
    globalnames, callback, model = _set_model(options)
  File "/data/users2/sajad/code/PDE-Net/setenv.py", line 45, in _set_model
    model.to(globalnames['device'])
  File "/home/users/mabavisani/anaconda3/envs/PDE-Net-2/lib/python3.7/site-packages/torch/nn/modules/module.py", line 386, in to
    return self._apply(convert)
  File "/home/users/mabavisani/anaconda3/envs/PDE-Net-2/lib/python3.7/site-packages/torch/nn/modules/module.py", line 193, in _apply
    module._apply(fn)
  File "/home/users/mabavisani/anaconda3/envs/PDE-Net-2/lib/python3.7/site-packages/torch/nn/modules/module.py", line 193, in _apply
    module._apply(fn)
  File "/home/users/mabavisani/anaconda3/envs/PDE-Net-2/lib/python3.7/site-packages/torch/nn/modules/module.py", line 205, in _apply
    self._buffers[key] = fn(buf)
  File "/home/users/mabavisani/anaconda3/envs/PDE-Net-2/lib/python3.7/site-packages/torch/nn/modules/module.py", line 384, in convert
    return t.to(device, dtype if t.is_floating_point() else None, non_blocking)
RuntimeError: CUDA error: invalid device ordinal
{'--name': 'burgers-2-upwind-sparse0-noise0.001-id13', '--dtype': 'double', '--device': 'cuda:1', '--constraint': '2', '--dt': 0.01, '--cell_num': 1, '--eps': 6.283185307179586, '--blocks': [0, 1, 2, 3, 4, 5, 6, 9], '--kernel_size': 5, '--max_order': 2, '--dx': 0.19634954084936207, '--hidden_layers': 5, '--scheme': 'upwind', '--dataname': 'burgers', '--viscosity': 0.05, '--zoom': 4, '--max_dt': 0.000625, '--batch_size': 28, '--data_timescheme': 'rk2', '--channel_names': 'u,v', '--freq': 4, '--data_start_time': 1.0, '--start_noise': 0.001, '--end_noise': 0.001, '--stablize': 0.0, '--sparsity': 0.0, '--momentsparsity': 0.001, '--npseed': -1, '--torchseed': -1, '--maxiter': 2000, '--recordfile': 'None', '--recordcycle': 200, '--savecycle': -1, '--start_from': -1}
block:  0
name:  burgers-2-upwind-sparse0-noise0.001-id13
device:  cuda:1
generate a random number to check random seed:  1.2385401090716905
current stage is: warmup
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.8465, device='cuda:1', dtype=torch.float64)
u_obs variance
tensor([ 0.2622,  2.1695,  1.9551, 20.1136, 10.6919, 16.8872,  0.2499,  1.9876,
         2.1575, 17.3907, 10.6042, 20.3201], device='cuda:1',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
iter:     0    time: 6.28
Func: 5.32e+00  |g|: 2.43e+00
stableloss: 4.49e-04   dataloss: 5.32e+00   sparseloss: 2.54e+01 momentloss: 7.27e+00
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 0.041199
         Iterations: 151
         Function evaluations: 211
         Gradient evaluations: 204
convolution moment and kernels
[[1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
[[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 1. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
[[ 0.    1.    0.   -0.33 -0.25]
 [ 0.    0.    0.    0.    0.  ]
 [ 0.    0.    0.    0.    0.  ]
 [ 0.    0.    0.    0.    0.  ]
 [ 0.    0.    0.    0.    0.  ]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]
 [ 2.78e-17  3.33e-16 -1.50e+00  2.00e+00 -5.00e-01]
 [ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]]
[[ 0.    0.    0.    0.    0.  ]
 [ 1.    0.    0.    0.    0.  ]
 [ 0.    0.    0.    0.    0.  ]
 [-0.33  0.    0.    0.    0.  ]
 [-0.25  0.    0.    0.    0.  ]]
[[ 0.00e+00  0.00e+00  2.78e-17  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  3.33e-16  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00 -1.50e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  2.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00 -5.00e-01  0.00e+00  0.00e+00]]
[[0.   0.   1.   0.   0.08]
 [0.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.  ]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]
 [-2.22e-16  1.00e+00 -2.00e+00  1.00e+00 -1.53e-16]
 [ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]]
[[0. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
[[ 6.94e-03 -5.56e-02  9.25e-18  5.56e-02 -6.94e-03]
 [-5.56e-02  4.44e-01 -7.40e-17 -4.44e-01  5.56e-02]
 [ 9.25e-18 -7.40e-17  1.23e-32  7.40e-17 -9.25e-18]
 [ 5.56e-02 -4.44e-01  7.40e-17  4.44e-01 -5.56e-02]
 [-6.94e-03  5.56e-02 -9.25e-18 -5.56e-02  6.94e-03]]
[[0.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.  ]
 [1.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.  ]
 [0.08 0.   0.   0.   0.  ]]
[[ 0.00e+00  0.00e+00 -2.22e-16  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  1.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00 -2.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  1.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00 -1.53e-16  0.00e+00  0.00e+00]]
SymNet parameters
[[-0.31 -0.09  0.1  -0.03 -0.   -0.02  0.53 -0.04 -0.    0.02  0.   -0.01]
 [ 0.08  0.13  0.37  0.25  0.27  0.09 -0.01  0.08  0.21  0.01  0.08  0.05]]
SymNet parameters
[ 0.16 -0.17]
SymNet parameters
[[-0.13  0.32  0.19 -0.    0.09 -0.08  0.1  -0.11 -0.13 -0.01  0.03  0.01 -0.15]
 [-0.38 -0.03  0.1  -0.   -0.01  0.01 -0.25 -0.05 -0.03 -0.01 -0.   -0.02  0.  ]]
SymNet parameters
[ 0.01 -0.02]
SymNet parameters
[[ 3.63e-02  1.13e+00  4.93e-01  1.63e-02  3.44e-03  7.87e-03 -7.58e-02  1.09e-02
   1.49e-03 -5.28e-04  4.88e-03  3.66e-03 -3.16e-02  8.40e-02]
 [ 1.31e+00  7.85e-02 -1.76e-01 -6.91e-03  9.80e-04 -3.54e-03  5.41e-01 -6.18e-03
   1.63e-02  1.90e-03  1.43e-03 -2.55e-03 -2.74e-03 -1.36e-03]]
SymNet parameters
[-0.05 -0.06]
SymNet parameters
[[-5.15e-01  1.89e-01  6.65e-02  1.33e-02 -5.08e-04  9.03e-03  1.17e+00  1.45e-02
  -9.73e-03 -4.55e-03 -3.36e-05  2.89e-03 -1.60e-02  1.30e-02 -3.83e-03]
 [ 6.18e-02 -4.78e-01  1.15e+00 -2.51e-02 -1.71e-02 -4.05e-03  3.74e-02 -6.78e-03
  -1.26e-02 -1.59e-03 -5.38e-03 -4.69e-03  2.30e-02  1.04e-01  1.05e-02]]
SymNet parameters
[ 0.05 -0.09]
SymNet parameters
[[-0.11  0.32 -0.1   0.05  0.03  0.02 -0.06  0.03  0.05 -0.01  0.01  0.02 -0.06  0.09
   0.    0.04]
 [-0.05  0.01  0.24 -0.12 -0.03 -0.07  0.29 -0.12  0.15  0.03  0.01 -0.04 -0.07  0.18
   0.11  0.11]]
SymNet parameters
[0.15 0.11]
SymNet parameters
[[ 0.   -0.06  0.01  0.04  0.    0.04 -0.09  0.01  0.01  0.   -0.    0.   -0.07  0.03
  -0.51 -0.53  0.23]]
SymNet parameters
[-0.]
SymNet parameters
[[ 0.57 -0.02  0.02  0.   -0.01  0.    0.08  0.21 -0.34  0.03  0.02 -0.04]
 [-0.74 -0.05  0.07  0.01 -0.03  0.    0.26 -0.6  -0.42  0.08  0.07 -0.11]]
SymNet parameters
[-0.07  0.  ]
SymNet parameters
[[-0.08  0.06  0.03 -0.01 -0.03  0.04 -0.11  0.13  0.42  0.11  0.18 -0.16 -0.13]
 [-0.29 -0.03 -0.11 -0.   -0.01  0.   -0.26  0.01 -0.14 -0.04  0.01 -0.    0.09]]
SymNet parameters
[-0.26  0.06]
SymNet parameters
[[ 1.20e-01  1.20e-02 -3.03e-03 -9.87e-04  5.32e-03 -4.05e-04 -5.25e-02 -1.22e-01
  -1.68e+00 -9.67e-03 -2.23e-02  9.47e-03 -3.08e-03 -1.24e-01]
 [-2.25e-02  7.71e-03 -1.23e-02 -3.58e-03  4.87e-03 -2.36e-04  8.24e-01  1.57e-01
   9.50e-02 -1.52e-02 -1.68e-02  1.85e-02 -3.55e-04 -7.24e-03]]
SymNet parameters
[ 0.07 -0.09]
SymNet parameters
[[ 5.43e-01  4.04e-02 -4.61e-02  2.61e-04  1.69e-02 -4.22e-03 -1.79e-01 -4.20e-01
   1.37e-01 -6.43e-02 -5.00e-02  7.91e-02  1.72e-02  2.56e-02  9.78e-03]
 [ 8.72e-01 -3.46e-02  3.68e-02 -1.89e-03 -1.58e-02  1.15e-03 -2.02e-02 -3.77e-01
  -2.98e-01  5.44e-02  4.15e-02 -7.15e-02 -9.85e-03 -2.47e-02 -7.44e-03]]
SymNet parameters
[-0.1   0.36]
SymNet parameters
[[-0.01  0.08 -0.12 -0.04 -0.    0.02  0.03  0.25  0.04  0.05  0.06 -0.07  0.07 -0.01
  -0.01 -0.15]
 [-0.19  0.2  -0.02  0.07  0.1  -0.08 -0.12  0.11 -0.13 -0.15  0.02 -0.   -0.16 -0.11
  -0.05  0.05]]
SymNet parameters
[-0.17 -0.  ]
SymNet parameters
[[-1.07e-01 -1.96e-02  2.43e-02 -9.57e-04 -1.28e-02 -7.64e-04  3.08e-02  3.46e-02
  -1.83e-01  6.38e-02  2.29e-02 -2.97e-03  8.90e-01 -1.28e-02  5.83e-01  7.93e-01
  -1.69e-02]]
SymNet parameters
[0.05]
finally, finish this stage
iter:   151    time: 9.41
Func: 4.12e-02  |g|: 2.05e-02
stableloss: 1.36e-02   dataloss: 4.12e-02   sparseloss: 3.77e+01 momentloss: 7.27e+00
current expression:
[u00*u01, u10*v00, u20, u02, v10, u00*u01**2, u01*u10*v00, u00*u10, u00*u11*v00, u00*u02, u10, u00*u10*v00, u00*u01*v00, v00**2, v01, u10*v00*v10, u02*v00, u00*u02*v00, u10**2, u01**2]
[-0.89 -0.88  0.04  0.03  0.01  0.01  0.01 -0.01  0.01 -0.01 -0.01  0.01  0.01 -0.01
  0.    0.    0.    0.   -0.    0.  ]
[u00*v01, v00*v10, v02, v20, 1, u00, v00*v10**2, v00**2, v01, u11, v00*v11, u00*v11, u00*v20, u10, u00*v10, v00**2*v10, v00*v20, v01*v10, u00*v01*v10, u00**2*v01]
[-0.89 -0.88  0.04  0.03  0.02  0.01  0.01 -0.01 -0.01 -0.01 -0.    0.   -0.    0.
  0.    0.   -0.   -0.    0.   -0.  ]
block:  1
name:  burgers-2-upwind-sparse0-noise0.001-id13
device:  cuda:1
generate a random number to check random seed:  -1.0459427956105238
current stage is: block-1
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.9143, device='cuda:1', dtype=torch.float64)
u_obs variance
tensor([ 0.2686,  2.2190,  2.0215, 20.5765, 10.9153, 17.3271,  0.2547,  1.9973,
         2.0599, 17.2479,  9.5420, 18.8108], device='cuda:1',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
iter:     0    time: 1385.79
Func: 5.32e-02  |g|: 6.25e-01
stableloss: 1.17e-02   dataloss: 4.59e-02   sparseloss: 3.77e+01 momentloss: 7.27e+00
iter:   200    time: 10.52
Func: 2.00e-02  |g|: 1.32e-02
stableloss: 9.07e-03   dataloss: 1.35e-02   sparseloss: 4.17e+01 momentloss: 6.52e+00
iter:   400    time: 10.33
Func: 1.92e-02  |g|: 8.90e-03
stableloss: 8.82e-03   dataloss: 1.27e-02   sparseloss: 4.77e+01 momentloss: 6.51e+00
iter:   600    time: 10.22
Func: 1.89e-02  |g|: 4.70e-03
stableloss: 8.66e-03   dataloss: 1.24e-02   sparseloss: 5.64e+01 momentloss: 6.48e+00
iter:   800    time: 10.22
Func: 1.88e-02  |g|: 3.18e-03
stableloss: 8.60e-03   dataloss: 1.23e-02   sparseloss: 6.44e+01 momentloss: 6.47e+00
iter:  1000    time: 10.19
Func: 1.87e-02  |g|: 1.16e-02
stableloss: 8.58e-03   dataloss: 1.22e-02   sparseloss: 7.52e+01 momentloss: 6.48e+00
iter:  1200    time: 10.18
Func: 1.87e-02  |g|: 2.12e-03
stableloss: 8.55e-03   dataloss: 1.22e-02   sparseloss: 8.64e+01 momentloss: 6.47e+00
iter:  1400    time: 10.23
Func: 1.86e-02  |g|: 9.53e-03
stableloss: 8.56e-03   dataloss: 1.22e-02   sparseloss: 8.87e+01 momentloss: 6.47e+00
iter:  1600    time: 10.19
Func: 1.86e-02  |g|: 5.41e-03
stableloss: 8.55e-03   dataloss: 1.21e-02   sparseloss: 9.03e+01 momentloss: 6.48e+00
iter:  1800    time: 11.20
Func: 1.86e-02  |g|: 4.96e-03
stableloss: 8.52e-03   dataloss: 1.21e-02   sparseloss: 9.46e+01 momentloss: 6.48e+00
Warning: Maximum number of iterations has been exceeded.
         Current function value: 0.018562
         Iterations: 2000
         Function evaluations: 2004
         Gradient evaluations: 2004
convolution moment and kernels
[[ 1.00e+00  0.00e+00 -1.74e-04  9.39e-03 -8.31e-03]
 [ 0.00e+00 -1.39e-06 -2.08e-03  3.27e-03  5.31e-03]
 [-6.15e-05 -5.15e-03  6.17e-04 -5.03e-03  2.77e-03]
 [ 6.46e-02  9.61e-04  1.43e-03 -2.80e-03 -9.88e-03]
 [-4.56e-02  7.36e-03  1.07e-03  1.40e-02  3.01e-03]]
[[ 7.27e-04 -2.13e-02 -2.93e-02 -4.37e-02  1.56e-02]
 [ 9.13e-03  4.22e-02  1.18e-01  1.30e-01 -5.26e-02]
 [-4.57e-02  6.28e-02  7.32e-01 -7.28e-02  5.06e-02]
 [ 3.13e-02 -6.15e-02  1.64e-01  4.07e-03 -2.01e-02]
 [-8.44e-03  2.02e-02 -3.37e-02  5.77e-03  2.91e-03]]
[[ 0.00e+00  1.00e+00  0.00e+00 -8.84e-02 -3.75e-02]
 [ 0.00e+00  0.00e+00 -2.45e-03 -1.74e-03 -5.89e-03]
 [ 0.00e+00  9.17e-03  4.11e-03  7.70e-03  1.59e-03]
 [ 1.26e-02 -5.60e-04 -8.53e-04 -1.43e-03 -3.58e-03]
 [ 3.22e-03 -2.48e-02 -5.54e-03 -1.39e-02 -1.52e-03]]
[[ 0.01 -0.    0.01 -0.01 -0.  ]
 [-0.02 -0.   -0.02  0.01  0.03]
 [ 0.12 -0.6  -0.18  0.89 -0.21]
 [-0.02 -0.   -0.05  0.01  0.03]
 [ 0.    0.01  0.01  0.   -0.01]]
[[ 0.00e+00  0.00e+00  0.00e+00  2.12e-03 -4.04e-04]
 [ 1.00e+00  0.00e+00  2.27e-02  2.07e-03 -4.64e-03]
 [ 0.00e+00  4.43e-03  5.58e-03 -7.49e-03  3.40e-04]
 [-8.88e-02  2.32e-04  6.65e-03 -8.67e-04 -1.85e-02]
 [-4.21e-02  3.02e-02 -5.77e-04  5.49e-03 -5.35e-04]]
[[ 7.64e-03 -4.97e-02  1.42e-01 -2.34e-02  9.40e-03]
 [-5.41e-03  9.53e-02 -6.67e-01  1.07e-02 -2.05e-02]
 [-1.57e-02 -6.51e-02 -2.36e-01  5.44e-02  9.70e-03]
 [ 2.18e-02 -6.59e-04  9.86e-01 -9.49e-02  1.13e-02]
 [-9.73e-03  2.38e-02 -2.27e-01  5.28e-02 -9.21e-03]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00 -1.56e-02]
 [ 0.00e+00  0.00e+00  0.00e+00  1.68e-03  2.47e-03]
 [ 0.00e+00  0.00e+00  1.47e-03 -2.19e-03  2.26e-03]
 [ 0.00e+00  6.21e-04  9.00e-05 -1.64e-03 -2.90e-03]
 [-1.93e-03 -1.93e-03  1.09e-03  4.16e-03 -4.87e-03]]
[[-6.32e-03  2.16e-02 -2.46e-02  8.03e-03 -6.39e-04]
 [ 3.00e-02 -1.03e-01  1.21e-01 -4.69e-02  6.27e-03]
 [-1.50e-01  1.58e+00 -2.82e+00  1.50e+00 -1.18e-01]
 [ 3.62e-02 -1.33e-01  1.76e-01 -8.99e-02  1.82e-02]
 [-8.63e-03  3.27e-02 -4.47e-02  2.37e-02 -4.97e-03]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00 -5.35e-05]
 [ 0.00e+00  1.00e+00  0.00e+00 -4.92e-04  2.49e-03]
 [ 0.00e+00  0.00e+00 -9.50e-04 -1.30e-04  2.19e-03]
 [ 0.00e+00 -6.82e-04 -3.29e-04  1.00e-03 -3.78e-04]
 [ 3.45e-03  3.76e-03  1.22e-03 -2.00e-03 -4.12e-03]]
[[ 0.   -0.04 -0.02  0.08 -0.01]
 [-0.04  0.39  0.11 -0.54  0.08]
 [-0.02  0.11 -0.18  0.16 -0.04]
 [ 0.07 -0.52  0.13  0.33 -0.03]
 [-0.01  0.07 -0.03 -0.03  0.  ]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  8.37e-04]
 [ 0.00e+00  0.00e+00  0.00e+00  8.33e-04  4.78e-04]
 [ 1.00e+00  0.00e+00  2.21e-03 -3.27e-03 -4.28e-05]
 [ 0.00e+00  6.81e-04 -6.26e-04 -1.05e-03 -1.09e-03]
 [-3.60e-03 -5.39e-03 -2.48e-03  6.42e-03  4.65e-04]]
[[-0.    0.   -0.07 -0.02  0.01]
 [ 0.01 -0.02  1.3   0.08 -0.02]
 [-0.02  0.03 -2.45 -0.11  0.03]
 [ 0.01 -0.02  1.31  0.06 -0.02]
 [-0.    0.01 -0.08 -0.01  0.  ]]
SymNet parameters
[[ 2.99e-01 -1.60e-01  3.54e-01 -2.14e-01  6.07e-02  4.95e-02  1.82e+00  2.37e-01
   1.26e-01  9.28e-03 -5.08e-04 -1.30e-02]
 [-1.05e-01 -8.87e-02 -8.87e-02  1.25e-01  3.81e-02 -1.93e-02  2.21e+00  8.65e-02
   7.37e-02 -4.83e-03  2.95e-03  5.25e-03]]
SymNet parameters
[-0.59 -0.82]
SymNet parameters
[[-2.13e-03  5.35e-01 -2.25e-01  1.55e-01  5.00e-02 -4.85e-02 -2.20e+00 -4.28e-01
  -2.32e-01  2.10e-04  6.08e-03  1.91e-02 -8.73e-03]
 [-3.04e-01  6.48e-03  2.12e-02 -2.40e-03  9.98e-04  9.03e-03  2.01e-02  2.85e-03
  -1.14e-02 -1.51e-04  8.72e-04  1.38e-04 -4.40e-04]]
SymNet parameters
[ 1.63 -0.08]
SymNet parameters
[[ 5.10e-01  1.16e+00 -2.35e-01 -1.64e-02 -5.96e-04  3.34e-03  2.87e-01  2.63e-02
  -1.17e-01 -2.49e-03  6.94e-03  2.06e-04 -4.84e-02 -7.32e-02]
 [ 8.36e-01  3.17e-01  2.43e-01  1.45e-03 -1.51e-04 -1.55e-03 -1.04e+00  3.09e-04
  -2.42e-02 -7.87e-04  3.38e-04  1.65e-04 -8.82e-03  8.13e-02]]
SymNet parameters
[0.14 0.  ]
SymNet parameters
[[-1.51e-01 -4.72e-01  7.68e-02  2.34e-02 -1.60e-03 -1.28e-03  1.77e+00 -4.28e-02
   1.39e-01  2.90e-03 -6.03e-03 -1.85e-03  1.84e-02 -1.32e-02 -1.84e-02]
 [ 6.53e-01  9.76e-01  9.09e-01 -3.30e-02  2.51e-03  3.31e-03  3.10e-01  5.67e-02
  -1.99e-01 -2.90e-03  1.16e-02  7.85e-04 -4.20e-02  1.12e-01  2.39e-02]]
SymNet parameters
[-0.28 -0.25]
SymNet parameters
[[-8.12e-01  7.81e-01  3.03e-01 -2.50e-02  2.88e-03  3.45e-04 -6.78e-01  4.76e-02
  -1.23e-01 -9.61e-04  4.68e-03  2.84e-03 -2.62e-02 -3.85e-02  6.95e-02  4.08e-02]
 [-3.86e+00  1.01e+00 -4.95e-01  2.21e-01 -2.43e-02 -3.12e-02 -9.02e-01 -4.28e-01
   9.24e-01  6.62e-03 -5.43e-02 -1.10e-02 -1.31e-02  4.40e-01 -1.22e-01  6.82e-02]]
SymNet parameters
[0.37 0.03]
SymNet parameters
[[ 1.22e-01 -7.73e-02 -6.94e-02  4.08e-02  7.60e-04  5.24e-02 -3.30e-01  1.72e-02
  -2.77e-02 -2.70e-04  7.73e-04  7.38e-04  1.49e-03 -6.92e-02 -7.53e-01 -4.57e-01
   9.03e-02]]
SymNet parameters
[0.02]
SymNet parameters
[[ 1.92e+00  9.55e-02  3.08e-02 -2.22e-03 -3.86e-03 -2.88e-03  3.12e-01  8.01e-02
  -5.12e-01  4.23e-02 -1.97e-02  2.31e-03]
 [-3.42e+00  2.71e-01 -3.03e-02 -4.70e-03  6.79e-03  2.27e-03  3.20e-01 -1.56e-01
  -6.37e-01 -2.30e-02 -2.24e-02 -1.42e-02]]
SymNet parameters
[0.44 0.11]
SymNet parameters
[[ 2.00e+00 -7.38e-02  2.00e-02 -4.00e-03 -1.28e-02  5.27e-03  2.69e-01  5.79e-02
  -1.95e-01  3.59e-02  6.64e-02 -1.31e-01  1.73e-03]
 [-5.65e-01  2.23e-02 -1.17e-02 -1.33e-03 -4.53e-04  1.61e-03  5.16e-02 -3.60e-02
  -8.76e-03 -6.83e-03 -1.71e-02 -3.99e-02  1.80e-05]]
SymNet parameters
[-0.26 -0.38]
SymNet parameters
[[ 2.27e+00 -1.01e+00 -1.97e-02  1.23e-02 -2.81e-02 -4.55e-03 -7.28e-01  3.58e-01
  -1.82e+00  9.06e-02  7.17e-02  8.37e-02  1.13e-01 -6.74e-01]
 [-8.83e-01 -1.62e-01 -1.96e-02 -1.68e-03 -1.62e-02 -2.78e-03  8.92e-01  1.81e-01
   2.00e-02  9.81e-02 -2.48e-03  2.01e-02  5.74e-03  7.97e-03]]
SymNet parameters
[-0.15  0.54]
SymNet parameters
[[ 3.41e+00 -2.57e-01  3.10e-02  5.05e-03 -3.57e-03 -1.59e-03 -6.42e-02 -3.48e-04
   5.70e-01  1.92e-05  2.41e-02  1.22e-02  2.82e-03 -2.80e-02  7.52e-04]
 [ 2.21e+00  7.19e-02  3.35e-02 -1.92e-03 -5.56e-03 -3.45e-03  3.53e-02 -5.09e-03
  -6.26e-01  5.31e-02 -2.05e-02  5.25e-03  3.78e-03 -1.80e-02 -1.46e-03]]
SymNet parameters
[-0.62  0.76]
SymNet parameters
[[ 2.50e-01 -2.94e+00 -1.65e-01  4.61e-02 -6.01e-02  3.07e-03  8.51e-01 -1.21e-01
  -2.43e+00  7.21e-02  2.68e-01  1.78e-01  2.82e-01 -1.29e+00  9.71e-03  3.16e-04]
 [-8.03e-01  2.71e+00  9.52e-02  1.81e-02  2.47e-01  4.87e-02 -9.22e-01 -2.33e+00
  -4.23e-01 -1.44e+00  4.55e-02 -3.30e-01  4.95e-01  3.71e-01  3.43e-02  5.04e-01]]
SymNet parameters
[-0.1  -0.01]
SymNet parameters
[[-0.17  0.3   0.01 -0.01 -0.   -0.   -0.04  0.05 -0.43  0.1  -0.04  0.04  1.71  0.01
   0.28  1.56  0.01]]
SymNet parameters
[0.69]
finally, finish this stage
iter:  2000    time: 14.52
Func: 1.86e-02  |g|: 1.46e-02
stableloss: 8.53e-03   dataloss: 1.21e-02   sparseloss: 9.66e+01 momentloss: 6.48e+00
current expression:
[u10*v00, u00*u01, u20, u02, u00*u01**2, u01*u10*v00, u00*u11*v00, u00*u01*v00, u00*v00, u00, u10*v00*v10, u10, u00*u10*v01, u01*u10, u10*v10, v00, u00*u10*v00, u01, u00*u01*v00**2, u00**3]
[-0.98 -0.98  0.05  0.05  0.01  0.01  0.01 -0.01 -0.01  0.01  0.01  0.01  0.01 -0.01
 -0.    0.    0.   -0.   -0.   -0.  ]
[v00*v10, u00*v01, v02, v20, v00*v10**2, u10*v01, u00*v00*v11, u00*u01*v01, v00**2*v10, u00*v01*v10, u00*v10, u00**2*v02, u00, u01, v10, v00**2, u00**2*v10, v00**2*v20, u00*u01, u00*v00*v10]
[-0.99 -0.98  0.05  0.05  0.02 -0.01  0.01  0.01 -0.01  0.01  0.    0.    0.   -0.
  0.    0.    0.    0.    0.    0.  ]
block:  2
name:  burgers-2-upwind-sparse0-noise0.001-id13
device:  cuda:1
generate a random number to check random seed:  1.1011879800705504
current stage is: block-2
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.9044, device='cuda:1', dtype=torch.float64)
u_obs variance
tensor([ 0.2519,  1.7372,  1.5678, 24.5526,  9.9839, 18.7753,  0.2457,  1.6275,
         1.6290, 19.5736, 10.5355, 21.6675], device='cuda:1',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
iter:     0    time: 558.18
Func: 9.61e-02  |g|: 7.46e+00
stableloss: 1.94e-02   dataloss: 8.31e-02   sparseloss: 9.66e+01 momentloss: 6.48e+00
iter:   200    time: 14.37
Func: 8.02e-02  |g|: 3.13e-01
stableloss: 1.86e-02   dataloss: 6.61e-02   sparseloss: 9.80e+01 momentloss: 7.05e+00
iter:   400    time: 14.27
Func: 7.92e-02  |g|: 2.95e-01
stableloss: 1.87e-02   dataloss: 6.50e-02   sparseloss: 1.01e+02 momentloss: 7.08e+00
iter:   600    time: 14.18
Func: 7.89e-02  |g|: 6.84e-02
stableloss: 1.87e-02   dataloss: 6.48e-02   sparseloss: 1.09e+02 momentloss: 7.05e+00
iter:   800    time: 14.19
Func: 7.88e-02  |g|: 1.08e-01
stableloss: 1.86e-02   dataloss: 6.47e-02   sparseloss: 1.13e+02 momentloss: 7.04e+00
iter:  1000    time: 14.27
Func: 7.87e-02  |g|: 5.44e-02
stableloss: 1.87e-02   dataloss: 6.46e-02   sparseloss: 1.15e+02 momentloss: 7.05e+00
iter:  1200    time: 14.33
Func: 7.87e-02  |g|: 3.72e-02
stableloss: 1.88e-02   dataloss: 6.44e-02   sparseloss: 1.19e+02 momentloss: 7.12e+00
iter:  1400    time: 14.30
Func: 7.87e-02  |g|: 1.56e-01
stableloss: 1.88e-02   dataloss: 6.43e-02   sparseloss: 1.20e+02 momentloss: 7.16e+00
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 0.078629
         Iterations: 1528
         Function evaluations: 1600
         Gradient evaluations: 1594
convolution moment and kernels
[[ 1.00e+00  0.00e+00  4.28e-04  5.05e-03 -1.03e-01]
 [ 0.00e+00  6.03e-05  7.71e-03  4.32e-03 -1.01e-02]
 [ 2.72e-03 -1.08e-03  7.43e-03 -4.59e-03 -5.35e-02]
 [-4.62e-02 -2.38e-03  7.23e-03 -3.02e-03 -1.22e-02]
 [-5.67e-02  3.80e-03  6.16e-03 -1.10e-03 -9.21e-03]]
[[ 1.28e-04 -8.02e-04 -3.73e-02  3.67e-03  4.35e-04]
 [-3.67e-02  1.48e-01 -2.37e-02  1.38e-01 -4.11e-02]
 [-2.91e-02  1.17e-01  4.58e-01  1.31e-01 -2.34e-02]
 [-3.10e-02  1.08e-01  1.44e-01  8.03e-02 -2.44e-02]
 [-9.19e-03  4.70e-02 -1.61e-01  5.57e-02 -1.22e-02]]
[[ 0.00e+00  1.00e+00  0.00e+00 -1.10e-01 -7.47e-02]
 [ 0.00e+00  0.00e+00 -9.04e-04 -2.58e-03 -3.03e-02]
 [ 0.00e+00  3.68e-02  1.54e-03  3.52e-02 -5.62e-03]
 [ 2.92e-03 -5.23e-03  5.55e-03 -3.73e-04 -9.83e-04]
 [ 7.32e-03 -5.46e-04 -1.46e-03  5.42e-03  2.35e-04]]
[[-2.27e-03  2.53e-03  8.97e-03 -3.71e-03  3.49e-04]
 [ 1.16e-04 -2.85e-02  3.21e-03 -2.03e-02  1.91e-02]
 [ 1.00e-01 -5.49e-01 -2.80e-01  9.89e-01 -2.17e-01]
 [-3.51e-02  9.92e-02 -2.02e-01  1.27e-01 -2.05e-02]
 [ 8.59e-04 -2.60e-03  2.20e-02 -1.59e-02  4.40e-03]]
[[ 0.00e+00  0.00e+00  0.00e+00 -5.54e-03 -8.08e-03]
 [ 1.00e+00  0.00e+00  3.97e-02 -2.69e-03 -5.43e-03]
 [ 0.00e+00  8.81e-04  1.08e-03  3.47e-03 -1.00e-02]
 [-9.33e-02 -4.22e-03  4.09e-02 -2.13e-03 -1.32e-02]
 [-4.38e-02 -1.65e-03 -3.28e-04 -1.06e-02 -7.53e-03]]
[[ 0.01 -0.03  0.13 -0.01 -0.  ]
 [-0.02  0.04 -0.58 -0.05  0.03]
 [ 0.01  0.04 -0.42  0.18 -0.07]
 [ 0.   -0.08  1.12 -0.16  0.05]
 [-0.01  0.06 -0.29  0.08 -0.02]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00 -9.10e-03]
 [ 0.00e+00  0.00e+00  0.00e+00 -3.10e-03 -2.02e-03]
 [ 0.00e+00  0.00e+00  3.57e-03 -8.89e-04 -4.51e-03]
 [ 0.00e+00 -2.59e-04 -3.22e-03  2.48e-03  6.79e-03]
 [ 1.92e-03 -1.05e-02 -3.26e-03  3.54e-02  3.23e-04]]
[[-0.02  0.05 -0.01 -0.03  0.02]
 [ 0.07 -0.15 -0.04  0.18 -0.07]
 [-0.19  1.54 -2.39  1.02  0.04]
 [ 0.06 -0.09 -0.15  0.27 -0.09]
 [-0.01  0.02  0.04 -0.07  0.02]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00 -4.06e-03]
 [ 0.00e+00  1.00e+00  0.00e+00 -4.57e-03  1.34e-03]
 [ 0.00e+00  0.00e+00  7.98e-05 -2.27e-04  4.48e-03]
 [ 0.00e+00 -3.91e-03 -5.63e-05  8.35e-03  3.61e-03]
 [-4.29e-02 -9.74e-02 -6.00e-04  7.44e-03 -1.64e-03]]
[[-0.01  0.03 -0.06  0.   -0.  ]
 [ 0.    0.11  0.26 -0.23  0.03]
 [-0.1   0.53 -0.4  -0.34  0.05]
 [ 0.12 -0.78  0.22  0.71 -0.1 ]
 [-0.02  0.13 -0.04 -0.13  0.02]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  1.66e-01]
 [ 0.00e+00  0.00e+00  0.00e+00  7.47e-04  1.02e-01]
 [ 1.00e+00  0.00e+00  8.85e-04  2.26e-03  7.17e-05]
 [ 0.00e+00 -8.51e-04 -2.89e-04  3.45e-04 -2.70e-03]
 [-9.26e-03 -4.48e-03  2.44e-04  3.36e-03 -7.52e-03]]
[[ 4.10e-04 -3.04e-03 -7.96e-02 -1.46e-02  4.15e-03]
 [-3.37e-02  1.39e-01  1.13e+00  1.83e-01 -4.71e-02]
 [ 1.11e-01 -4.52e-01 -1.83e+00 -5.17e-01  1.30e-01]
 [ 1.07e-01 -4.25e-01  1.97e+00 -3.80e-01  9.40e-02]
 [-1.94e-02  7.60e-02 -1.97e-01  6.29e-02 -1.53e-02]]
SymNet parameters
[[ 0.37  0.53  0.56 -0.34  0.07  0.12  1.99  0.37 -0.02 -0.03 -0.01  0.02]
 [ 0.32  0.19  0.1   0.08  0.01  0.03  2.29  0.14 -0.01  0.01 -0.01  0.  ]]
SymNet parameters
[-0.18 -0.63]
SymNet parameters
[[ 2.84e+00  3.51e-01  5.18e-01  1.05e-01  7.03e-02 -9.13e-03 -1.98e+00 -2.20e-01
  -3.48e-01  6.34e-03  1.29e-02  3.49e-02 -1.80e-02]
 [-1.03e-01 -4.18e-02  9.48e-02 -8.87e-03 -2.33e-04  1.48e-02  3.41e-02  2.17e-02
  -8.79e-03 -7.76e-04  1.16e-04  1.61e-03  1.83e-03]]
SymNet parameters
[1.48 0.05]
SymNet parameters
[[ 7.56e-01  1.20e+00 -4.32e-01 -1.04e-01 -2.77e-02  3.62e-02  8.74e-01  1.87e-01
  -3.70e-02 -8.98e-03 -6.83e-03  7.12e-03 -2.61e-02 -5.02e-02]
 [ 9.86e-01  1.35e-01  7.78e-02 -1.52e-02 -6.45e-03  2.60e-03 -9.60e-01  3.24e-02
   7.34e-03  1.07e-03 -9.59e-04 -2.90e-04  8.39e-04  3.62e-02]]
SymNet parameters
[0.05 0.21]
SymNet parameters
[[ 0.17 -0.33  0.17  0.08  0.02 -0.02  1.75 -0.15  0.01  0.01  0.   -0.01 -0.01  0.01
  -0.01]
 [ 1.05  0.97  0.51 -0.18 -0.05  0.05  1.21  0.31 -0.06 -0.02 -0.01  0.01 -0.01  0.13
   0.05]]
SymNet parameters
[-0.65 -0.75]
SymNet parameters
[[-1.71  0.64  0.18 -0.1  -0.02  0.02 -1.3   0.17 -0.02 -0.01 -0.01  0.01  0.01  0.1
   0.09  0.03]
 [-4.31 -0.45  0.67  0.63  0.14 -0.16 -3.36 -1.07  0.21  0.06  0.04 -0.05 -0.1  -0.09
  -0.12  0.09]]
SymNet parameters
[0.4  0.09]
SymNet parameters
[[-3.42e-02  1.39e-02 -3.09e-01  3.98e-02 -5.70e-03  5.00e-02 -6.78e-01  1.88e-02
   4.77e-03 -6.08e-04 -5.94e-04 -8.54e-04 -4.47e-03  1.04e-01 -6.72e-01 -4.34e-01
   8.22e-02]]
SymNet parameters
[0.2]
SymNet parameters
[[ 3.30e+00  1.01e-01 -2.65e-03  3.18e-03  5.22e-03  1.80e-03 -9.42e-02 -8.97e-03
  -3.01e-01  2.00e-02  1.60e-02  2.02e-02]
 [-4.32e+00  2.14e-01  1.41e-02  9.55e-03  4.25e-03  5.09e-03  6.76e-01 -1.10e-01
  -4.44e-01  1.53e-03  4.86e-03  1.00e-02]]
SymNet parameters
[0.51 0.3 ]
SymNet parameters
[[ 2.34e+00 -2.31e-03 -7.27e-03 -2.52e-03 -4.29e-03 -4.20e-03 -1.74e-02  1.82e-02
   1.95e-02  1.40e-02  1.40e-02 -6.97e-02 -2.11e-04]
 [-9.48e-01  1.07e-02  6.70e-04 -1.06e-03 -2.35e-03 -1.34e-03  1.67e-01 -8.98e-03
  -2.41e-03  4.74e-04 -1.67e-02 -3.38e-02 -9.06e-05]]
SymNet parameters
[-1.08  0.17]
SymNet parameters
[[ 0.16 -0.87 -0.02 -0.07 -0.03 -0.01 -0.66 -0.16 -3.   -0.15 -0.1  -0.12  0.21 -1.36]
 [ 0.3  -0.13 -0.02  0.03  0.01 -0.01  0.52  0.03 -0.06  0.08  0.06  0.05 -0.01  0.08]]
SymNet parameters
[-0.54  0.34]
SymNet parameters
[[ 3.82e+00 -1.14e-01 -6.63e-03 -1.46e-02 -4.11e-03 -4.69e-04 -2.25e-01  1.45e-02
   4.83e-01 -1.63e-02 -1.58e-02 -1.62e-02 -4.71e-03  2.58e-02  1.48e-03]
 [ 3.21e+00  3.07e-02 -8.07e-03  9.56e-03  5.57e-03 -2.25e-03 -3.58e-01 -5.69e-02
  -3.41e-01  3.51e-02  2.76e-02  2.78e-02  1.80e-03 -6.99e-03 -1.36e-03]]
SymNet parameters
[-0.46  0.6 ]
SymNet parameters
[[ 1.85 -2.05 -0.04 -0.16 -0.08 -0.02 -1.49 -0.25 -2.74 -0.36 -0.26 -0.3   0.16 -2.25
  -0.02 -0.22]
 [-2.97  3.08  0.4  -0.54 -0.1   0.25 -0.42 -0.87 -1.59 -1.26 -1.   -0.82  0.87 -1.46
   0.02  0.78]]
SymNet parameters
[-0.13  0.02]
SymNet parameters
[[ 0.49 -0.   -0.01  0.03  0.01 -0.01 -0.51  0.05 -0.06  0.12  0.05  0.09  1.81  0.13
   0.33  2.13  0.01]]
SymNet parameters
[0.37]
finally, finish this stage
iter:  1528    time: 12.86
Func: 7.86e-02  |g|: 9.06e-02
stableloss: 1.88e-02   dataloss: 6.42e-02   sparseloss: 1.20e+02 momentloss: 7.20e+00
current expression:
[u10*v00, u00*u01, u02, u20, u00, u00*u01**2, u00*u11*v00, u01*u10*v00, u10*v00*v10, u00**3, u00*u10*v01, u01, u00**2*u01, 1, u20*v00**2, u00*v00, u00*v00**2, u11, u01*v00*v10, u01**2]
[-0.98 -0.97  0.05  0.05  0.02  0.02  0.01  0.01  0.01 -0.01  0.01 -0.01  0.   -0.
  0.   -0.    0.   -0.   -0.    0.  ]
[v00*v10, u00*v01, v02, v20, v00*v10**2, u00*u01*v01, u00*v00*v11, u00*v01*v10, v00, u00, v00**2*v10, v10**2, 1, v00**2*v20, v01, u00**2*v10, u00**2, v10*v20, u01*v00*v10, u00**3]
[-0.99 -0.97  0.05  0.05  0.01  0.01  0.01  0.01  0.01 -0.   -0.    0.   -0.    0.
 -0.    0.    0.   -0.    0.    0.  ]
block:  3
name:  burgers-2-upwind-sparse0-noise0.001-id13
device:  cuda:1
generate a random number to check random seed:  -0.8532572891327956
current stage is: block-3
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.7421, device='cuda:1', dtype=torch.float64)
u_obs variance
tensor([ 0.2529,  1.7010,  1.5948, 22.8653,  9.8428, 17.6276,  0.2407,  1.5959,
         1.5967, 18.7372,  9.7035, 20.0775], device='cuda:1',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 0.151623
         Iterations: 0
         Function evaluations: 15
         Gradient evaluations: 3
convolution moment and kernels
[[ 1.00e+00  0.00e+00  4.29e-04  5.04e-03 -1.03e-01]
 [ 0.00e+00  5.91e-05  7.71e-03  4.32e-03 -1.01e-02]
 [ 2.72e-03 -1.08e-03  7.43e-03 -4.59e-03 -5.35e-02]
 [-4.62e-02 -2.38e-03  7.23e-03 -3.02e-03 -1.22e-02]
 [-5.67e-02  3.81e-03  6.15e-03 -1.10e-03 -9.21e-03]]
[[ 1.26e-04 -7.93e-04 -3.73e-02  3.69e-03  4.31e-04]
 [-3.67e-02  1.48e-01 -2.36e-02  1.38e-01 -4.11e-02]
 [-2.91e-02  1.17e-01  4.58e-01  1.31e-01 -2.34e-02]
 [-3.10e-02  1.08e-01  1.44e-01  8.02e-02 -2.44e-02]
 [-9.19e-03  4.70e-02 -1.61e-01  5.57e-02 -1.22e-02]]
[[ 0.00e+00  1.00e+00  0.00e+00 -1.10e-01 -7.47e-02]
 [ 0.00e+00  0.00e+00 -9.06e-04 -2.58e-03 -3.03e-02]
 [ 0.00e+00  3.68e-02  1.54e-03  3.52e-02 -5.62e-03]
 [ 2.92e-03 -5.23e-03  5.55e-03 -3.74e-04 -9.83e-04]
 [ 7.32e-03 -5.48e-04 -1.46e-03  5.42e-03  2.26e-04]]
[[-2.28e-03  2.57e-03  8.92e-03 -3.68e-03  3.42e-04]
 [ 1.58e-04 -2.86e-02  3.45e-03 -2.05e-02  1.91e-02]
 [ 1.00e-01 -5.48e-01 -2.80e-01  9.89e-01 -2.17e-01]
 [-3.50e-02  9.90e-02 -2.02e-01  1.26e-01 -2.05e-02]
 [ 8.49e-04 -2.56e-03  2.20e-02 -1.59e-02  4.40e-03]]
[[ 0.00e+00  0.00e+00  0.00e+00 -5.55e-03 -8.09e-03]
 [ 1.00e+00  0.00e+00  3.97e-02 -2.68e-03 -5.43e-03]
 [ 0.00e+00  8.81e-04  1.08e-03  3.47e-03 -1.00e-02]
 [-9.33e-02 -4.21e-03  4.09e-02 -2.13e-03 -1.32e-02]
 [-4.38e-02 -1.64e-03 -3.31e-04 -1.06e-02 -7.53e-03]]
[[ 0.01 -0.03  0.13 -0.01 -0.  ]
 [-0.02  0.04 -0.58 -0.05  0.03]
 [ 0.01  0.04 -0.42  0.18 -0.07]
 [ 0.   -0.08  1.12 -0.16  0.05]
 [-0.01  0.06 -0.29  0.08 -0.02]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00 -9.10e-03]
 [ 0.00e+00  0.00e+00  0.00e+00 -3.10e-03 -2.02e-03]
 [ 0.00e+00  0.00e+00  3.57e-03 -8.88e-04 -4.51e-03]
 [ 0.00e+00 -2.60e-04 -3.22e-03  2.47e-03  6.79e-03]
 [ 1.92e-03 -1.05e-02 -3.26e-03  3.54e-02  3.23e-04]]
[[-0.02  0.05 -0.01 -0.03  0.02]
 [ 0.07 -0.15 -0.04  0.18 -0.07]
 [-0.19  1.54 -2.39  1.02  0.04]
 [ 0.06 -0.09 -0.15  0.27 -0.09]
 [-0.01  0.02  0.04 -0.07  0.02]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00 -4.06e-03]
 [ 0.00e+00  1.00e+00  0.00e+00 -4.57e-03  1.34e-03]
 [ 0.00e+00  0.00e+00  8.01e-05 -2.27e-04  4.49e-03]
 [ 0.00e+00 -3.91e-03 -5.55e-05  8.35e-03  3.61e-03]
 [-4.29e-02 -9.74e-02 -5.99e-04  7.44e-03 -1.64e-03]]
[[-0.01  0.03 -0.06  0.   -0.  ]
 [ 0.    0.11  0.26 -0.23  0.03]
 [-0.1   0.53 -0.4  -0.34  0.05]
 [ 0.12 -0.78  0.22  0.71 -0.1 ]
 [-0.02  0.13 -0.04 -0.13  0.02]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  1.66e-01]
 [ 0.00e+00  0.00e+00  0.00e+00  7.48e-04  1.02e-01]
 [ 1.00e+00  0.00e+00  8.85e-04  2.27e-03  7.30e-05]
 [ 0.00e+00 -8.52e-04 -2.89e-04  3.45e-04 -2.70e-03]
 [-9.26e-03 -4.48e-03  2.45e-04  3.36e-03 -7.52e-03]]
[[ 4.09e-04 -3.03e-03 -7.96e-02 -1.46e-02  4.15e-03]
 [-3.37e-02  1.39e-01  1.13e+00  1.83e-01 -4.71e-02]
 [ 1.11e-01 -4.52e-01 -1.83e+00 -5.17e-01  1.30e-01]
 [ 1.07e-01 -4.25e-01  1.97e+00 -3.80e-01  9.40e-02]
 [-1.94e-02  7.60e-02 -1.97e-01  6.29e-02 -1.53e-02]]
SymNet parameters
[[ 0.37  0.53  0.56 -0.34  0.07  0.12  1.99  0.37 -0.02 -0.03 -0.01  0.02]
 [ 0.32  0.19  0.1   0.08  0.01  0.03  2.29  0.14 -0.01  0.01 -0.01  0.  ]]
SymNet parameters
[-0.18 -0.63]
SymNet parameters
[[ 2.84e+00  3.51e-01  5.18e-01  1.05e-01  7.03e-02 -9.13e-03 -1.98e+00 -2.20e-01
  -3.48e-01  6.33e-03  1.29e-02  3.49e-02 -1.80e-02]
 [-1.03e-01 -4.18e-02  9.48e-02 -8.91e-03 -2.31e-04  1.48e-02  3.41e-02  2.17e-02
  -8.79e-03 -7.84e-04  1.07e-04  1.59e-03  1.70e-03]]
SymNet parameters
[1.48 0.05]
SymNet parameters
[[ 7.56e-01  1.20e+00 -4.32e-01 -1.03e-01 -2.77e-02  3.62e-02  8.74e-01  1.87e-01
  -3.70e-02 -8.99e-03 -6.82e-03  7.14e-03 -2.60e-02 -5.02e-02]
 [ 9.86e-01  1.35e-01  7.77e-02 -1.52e-02 -6.47e-03  2.62e-03 -9.60e-01  3.24e-02
   7.33e-03  1.05e-03 -9.69e-04 -2.84e-04  8.08e-04  3.62e-02]]
SymNet parameters
[0.05 0.21]
SymNet parameters
[[ 0.17 -0.33  0.17  0.08  0.02 -0.02  1.75 -0.15  0.01  0.01  0.   -0.01 -0.01  0.01
  -0.01]
 [ 1.05  0.97  0.51 -0.18 -0.05  0.05  1.22  0.31 -0.06 -0.02 -0.01  0.01 -0.01  0.13
   0.05]]
SymNet parameters
[-0.65 -0.75]
SymNet parameters
[[-1.71  0.64  0.18 -0.1  -0.02  0.02 -1.3   0.17 -0.02 -0.01 -0.01  0.01  0.01  0.1
   0.09  0.03]
 [-4.31 -0.45  0.67  0.63  0.14 -0.16 -3.36 -1.07  0.21  0.06  0.04 -0.05 -0.1  -0.09
  -0.12  0.09]]
SymNet parameters
[0.4  0.09]
SymNet parameters
[[-3.42e-02  1.39e-02 -3.09e-01  3.98e-02 -5.69e-03  5.00e-02 -6.78e-01  1.88e-02
   4.77e-03 -6.15e-04 -5.97e-04 -8.39e-04 -4.50e-03  1.04e-01 -6.72e-01 -4.34e-01
   8.22e-02]]
SymNet parameters
[0.2]
SymNet parameters
[[ 3.30e+00  1.01e-01 -2.63e-03  3.10e-03  5.22e-03  1.65e-03 -9.42e-02 -8.94e-03
  -3.01e-01  2.00e-02  1.60e-02  2.01e-02]
 [-4.32e+00  2.14e-01  1.41e-02  9.63e-03  4.25e-03  5.20e-03  6.76e-01 -1.10e-01
  -4.44e-01  1.55e-03  4.84e-03  1.00e-02]]
SymNet parameters
[0.51 0.3 ]
SymNet parameters
[[ 2.34e+00 -2.31e-03 -7.26e-03 -2.52e-03 -4.29e-03 -4.19e-03 -1.74e-02  1.82e-02
   1.95e-02  1.40e-02  1.40e-02 -6.97e-02 -2.27e-04]
 [-9.48e-01  1.07e-02  6.71e-04 -1.07e-03 -2.36e-03 -1.35e-03  1.67e-01 -8.98e-03
  -2.41e-03  4.70e-04 -1.67e-02 -3.38e-02 -6.69e-05]]
SymNet parameters
[-1.08  0.17]
SymNet parameters
[[ 0.16 -0.87 -0.02 -0.07 -0.03 -0.01 -0.66 -0.16 -3.   -0.15 -0.1  -0.12  0.21 -1.36]
 [ 0.3  -0.13 -0.02  0.03  0.01 -0.01  0.52  0.03 -0.06  0.08  0.06  0.05 -0.01  0.08]]
SymNet parameters
[-0.54  0.34]
SymNet parameters
[[ 3.82e+00 -1.14e-01 -6.65e-03 -1.45e-02 -4.10e-03 -3.42e-04 -2.25e-01  1.45e-02
   4.83e-01 -1.63e-02 -1.58e-02 -1.63e-02 -4.46e-03  2.58e-02  1.31e-03]
 [ 3.21e+00  3.07e-02 -8.09e-03  9.64e-03  5.56e-03 -2.11e-03 -3.58e-01 -5.70e-02
  -3.41e-01  3.51e-02  2.76e-02  2.79e-02  1.78e-03 -7.02e-03 -1.38e-03]]
SymNet parameters
[-0.46  0.6 ]
SymNet parameters
[[ 1.85 -2.05 -0.04 -0.16 -0.08 -0.02 -1.49 -0.25 -2.74 -0.36 -0.26 -0.3   0.16 -2.25
  -0.02 -0.22]
 [-2.97  3.08  0.4  -0.54 -0.1   0.25 -0.42 -0.87 -1.59 -1.26 -1.   -0.82  0.87 -1.46
   0.02  0.78]]
SymNet parameters
[-0.13  0.02]
SymNet parameters
[[ 0.49 -0.   -0.01  0.03  0.01 -0.01 -0.51  0.05 -0.06  0.12  0.05  0.09  1.81  0.13
   0.33  2.13  0.01]]
SymNet parameters
[0.37]
finally, finish this stage
iter:     0    time: 619.36
Func: 1.52e-01  |g|: 1.06e+01
stableloss: 1.92e-02   dataloss: 1.30e-01   sparseloss: 1.20e+02 momentloss: 7.20e+00
current expression:
[u10*v00, u00*u01, u02, u20, u00, u00*u01**2, u00*u11*v00, u01*u10*v00, u10*v00*v10, u00**3, u00*u10*v01, u01, u00**2*u01, 1, u20*v00**2, u00*v00, u00*v00**2, u11, u01*v00*v10, u01**2]
[-0.98 -0.97  0.05  0.05  0.02  0.02  0.01  0.01  0.01 -0.01  0.01 -0.01  0.   -0.
  0.   -0.    0.   -0.   -0.    0.  ]
[v00*v10, u00*v01, v02, v20, v00*v10**2, u00*u01*v01, u00*v00*v11, u00*v01*v10, v00, u00, v00**2*v10, v10**2, 1, v00**2*v20, v01, u00**2*v10, u00**2, v10*v20, u01*v00*v10, u00**3]
[-0.99 -0.97  0.05  0.05  0.01  0.01  0.01  0.01  0.01 -0.   -0.    0.   -0.    0.
 -0.    0.    0.   -0.    0.    0.  ]
block:  4
name:  burgers-2-upwind-sparse0-noise0.001-id13
device:  cuda:1
generate a random number to check random seed:  0.67192777256633
current stage is: block-4
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.9144, device='cuda:1', dtype=torch.float64)
u_obs variance
tensor([ 0.2496,  1.7221,  1.5418, 22.7974,  9.1967, 17.1780,  0.2703,  1.7355,
         1.8322, 20.2894, 10.2624, 22.9013], device='cuda:1',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 0.323406
         Iterations: 0
         Function evaluations: 15
         Gradient evaluations: 3
convolution moment and kernels
[[ 1.00e+00  0.00e+00  4.28e-04  5.05e-03 -1.03e-01]
 [ 0.00e+00  5.94e-05  7.71e-03  4.32e-03 -1.01e-02]
 [ 2.72e-03 -1.08e-03  7.43e-03 -4.59e-03 -5.35e-02]
 [-4.62e-02 -2.38e-03  7.23e-03 -3.02e-03 -1.22e-02]
 [-5.67e-02  3.81e-03  6.16e-03 -1.10e-03 -9.22e-03]]
[[ 1.20e-04 -7.64e-04 -3.74e-02  3.71e-03  4.25e-04]
 [-3.66e-02  1.48e-01 -2.34e-02  1.38e-01 -4.11e-02]
 [-2.91e-02  1.17e-01  4.57e-01  1.31e-01 -2.35e-02]
 [-3.09e-02  1.07e-01  1.44e-01  8.01e-02 -2.44e-02]
 [-9.20e-03  4.70e-02 -1.61e-01  5.58e-02 -1.22e-02]]
[[ 0.00e+00  1.00e+00  0.00e+00 -1.10e-01 -7.47e-02]
 [ 0.00e+00  0.00e+00 -9.02e-04 -2.58e-03 -3.03e-02]
 [ 0.00e+00  3.68e-02  1.54e-03  3.52e-02 -5.62e-03]
 [ 2.93e-03 -5.23e-03  5.54e-03 -3.74e-04 -9.82e-04]
 [ 7.32e-03 -5.45e-04 -1.45e-03  5.41e-03  2.20e-04]]
[[-2.28e-03  2.60e-03  8.86e-03 -3.64e-03  3.32e-04]
 [ 1.82e-04 -2.88e-02  3.70e-03 -2.07e-02  1.92e-02]
 [ 1.00e-01 -5.48e-01 -2.81e-01  9.90e-01 -2.17e-01]
 [-3.50e-02  9.89e-02 -2.02e-01  1.26e-01 -2.04e-02]
 [ 8.45e-04 -2.54e-03  2.19e-02 -1.59e-02  4.39e-03]]
[[ 0.00e+00  0.00e+00  0.00e+00 -5.54e-03 -8.09e-03]
 [ 1.00e+00  0.00e+00  3.97e-02 -2.69e-03 -5.43e-03]
 [ 0.00e+00  8.81e-04  1.08e-03  3.47e-03 -1.00e-02]
 [-9.33e-02 -4.21e-03  4.09e-02 -2.13e-03 -1.32e-02]
 [-4.38e-02 -1.65e-03 -3.28e-04 -1.06e-02 -7.53e-03]]
[[ 0.01 -0.03  0.13 -0.01 -0.  ]
 [-0.02  0.04 -0.58 -0.05  0.03]
 [ 0.01  0.04 -0.42  0.18 -0.07]
 [ 0.   -0.08  1.12 -0.16  0.05]
 [-0.01  0.06 -0.29  0.08 -0.02]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00 -9.10e-03]
 [ 0.00e+00  0.00e+00  0.00e+00 -3.10e-03 -2.02e-03]
 [ 0.00e+00  0.00e+00  3.57e-03 -8.88e-04 -4.51e-03]
 [ 0.00e+00 -2.60e-04 -3.22e-03  2.47e-03  6.79e-03]
 [ 1.92e-03 -1.05e-02 -3.25e-03  3.54e-02  3.21e-04]]
[[-0.02  0.05 -0.01 -0.03  0.02]
 [ 0.07 -0.15 -0.04  0.18 -0.07]
 [-0.19  1.54 -2.39  1.02  0.04]
 [ 0.06 -0.09 -0.15  0.27 -0.09]
 [-0.01  0.02  0.04 -0.07  0.02]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00 -4.06e-03]
 [ 0.00e+00  1.00e+00  0.00e+00 -4.57e-03  1.34e-03]
 [ 0.00e+00  0.00e+00  8.02e-05 -2.27e-04  4.49e-03]
 [ 0.00e+00 -3.91e-03 -5.55e-05  8.35e-03  3.61e-03]
 [-4.29e-02 -9.74e-02 -5.99e-04  7.44e-03 -1.64e-03]]
[[-0.01  0.03 -0.06  0.   -0.  ]
 [ 0.    0.11  0.26 -0.23  0.03]
 [-0.1   0.53 -0.4  -0.34  0.05]
 [ 0.12 -0.78  0.22  0.71 -0.1 ]
 [-0.02  0.13 -0.04 -0.13  0.02]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  1.66e-01]
 [ 0.00e+00  0.00e+00  0.00e+00  7.48e-04  1.02e-01]
 [ 1.00e+00  0.00e+00  8.84e-04  2.27e-03  7.31e-05]
 [ 0.00e+00 -8.52e-04 -2.90e-04  3.45e-04 -2.70e-03]
 [-9.27e-03 -4.48e-03  2.46e-04  3.36e-03 -7.52e-03]]
[[ 4.08e-04 -3.02e-03 -7.96e-02 -1.46e-02  4.15e-03]
 [-3.37e-02  1.39e-01  1.13e+00  1.83e-01 -4.71e-02]
 [ 1.11e-01 -4.52e-01 -1.83e+00 -5.17e-01  1.30e-01]
 [ 1.07e-01 -4.25e-01  1.97e+00 -3.80e-01  9.40e-02]
 [-1.94e-02  7.60e-02 -1.97e-01  6.29e-02 -1.53e-02]]
SymNet parameters
[[ 0.37  0.53  0.56 -0.34  0.07  0.12  1.99  0.37 -0.02 -0.03 -0.01  0.02]
 [ 0.32  0.19  0.1   0.08  0.01  0.03  2.29  0.14 -0.01  0.01 -0.01  0.  ]]
SymNet parameters
[-0.18 -0.63]
SymNet parameters
[[ 2.84e+00  3.51e-01  5.18e-01  1.05e-01  7.03e-02 -9.13e-03 -1.98e+00 -2.20e-01
  -3.48e-01  6.33e-03  1.29e-02  3.49e-02 -1.80e-02]
 [-1.03e-01 -4.18e-02  9.48e-02 -8.88e-03 -2.34e-04  1.48e-02  3.41e-02  2.17e-02
  -8.79e-03 -7.60e-04  1.17e-04  1.61e-03  1.82e-03]]
SymNet parameters
[1.48 0.05]
SymNet parameters
[[ 7.56e-01  1.20e+00 -4.32e-01 -1.03e-01 -2.77e-02  3.62e-02  8.74e-01  1.87e-01
  -3.70e-02 -9.00e-03 -6.83e-03  7.12e-03 -2.61e-02 -5.02e-02]
 [ 9.86e-01  1.35e-01  7.77e-02 -1.52e-02 -6.46e-03  2.61e-03 -9.60e-01  3.24e-02
   7.34e-03  1.07e-03 -9.58e-04 -2.76e-04  8.76e-04  3.62e-02]]
SymNet parameters
[0.05 0.21]
SymNet parameters
[[ 0.17 -0.33  0.17  0.08  0.02 -0.02  1.75 -0.15  0.01  0.01  0.   -0.01 -0.01  0.01
  -0.01]
 [ 1.05  0.97  0.51 -0.18 -0.05  0.05  1.21  0.31 -0.06 -0.02 -0.01  0.01 -0.01  0.13
   0.05]]
SymNet parameters
[-0.65 -0.75]
SymNet parameters
[[-1.71  0.64  0.18 -0.1  -0.02  0.02 -1.3   0.17 -0.02 -0.01 -0.01  0.01  0.01  0.1
   0.09  0.03]
 [-4.31 -0.45  0.67  0.63  0.14 -0.16 -3.36 -1.07  0.21  0.06  0.04 -0.05 -0.1  -0.09
  -0.12  0.09]]
SymNet parameters
[0.4  0.09]
SymNet parameters
[[-3.42e-02  1.39e-02 -3.09e-01  3.98e-02 -5.70e-03  5.00e-02 -6.78e-01  1.88e-02
   4.77e-03 -6.10e-04 -5.95e-04 -8.47e-04 -4.44e-03  1.04e-01 -6.72e-01 -4.34e-01
   8.23e-02]]
SymNet parameters
[0.2]
SymNet parameters
[[ 3.30e+00  1.01e-01 -2.62e-03  3.20e-03  5.25e-03  1.78e-03 -9.42e-02 -8.99e-03
  -3.01e-01  2.01e-02  1.60e-02  2.02e-02]
 [-4.32e+00  2.14e-01  1.41e-02  9.54e-03  4.23e-03  5.10e-03  6.76e-01 -1.10e-01
  -4.44e-01  1.47e-03  4.86e-03  1.00e-02]]
SymNet parameters
[0.51 0.3 ]
SymNet parameters
[[ 2.34e+00 -2.31e-03 -7.26e-03 -2.52e-03 -4.29e-03 -4.20e-03 -1.74e-02  1.82e-02
   1.95e-02  1.40e-02  1.40e-02 -6.97e-02 -1.83e-04]
 [-9.48e-01  1.07e-02  6.69e-04 -1.06e-03 -2.36e-03 -1.34e-03  1.67e-01 -8.98e-03
  -2.41e-03  4.75e-04 -1.67e-02 -3.38e-02 -1.43e-04]]
SymNet parameters
[-1.08  0.17]
SymNet parameters
[[ 0.16 -0.87 -0.02 -0.07 -0.03 -0.01 -0.66 -0.16 -3.   -0.15 -0.1  -0.12  0.21 -1.36]
 [ 0.3  -0.13 -0.02  0.03  0.01 -0.01  0.52  0.03 -0.06  0.08  0.06  0.05 -0.01  0.08]]
SymNet parameters
[-0.54  0.34]
SymNet parameters
[[ 3.82e+00 -1.14e-01 -6.66e-03 -1.46e-02 -4.13e-03 -4.53e-04 -2.25e-01  1.46e-02
   4.83e-01 -1.64e-02 -1.58e-02 -1.62e-02 -4.88e-03  2.58e-02  1.59e-03]
 [ 3.21e+00  3.07e-02 -8.11e-03  9.54e-03  5.53e-03 -2.22e-03 -3.58e-01 -5.69e-02
  -3.41e-01  3.50e-02  2.76e-02  2.79e-02  1.97e-03 -6.93e-03 -1.14e-03]]
SymNet parameters
[-0.46  0.6 ]
SymNet parameters
[[ 1.85 -2.05 -0.04 -0.16 -0.08 -0.02 -1.49 -0.25 -2.74 -0.36 -0.26 -0.3   0.16 -2.25
  -0.02 -0.22]
 [-2.97  3.08  0.4  -0.54 -0.1   0.25 -0.42 -0.87 -1.59 -1.26 -1.   -0.82  0.87 -1.46
   0.02  0.78]]
SymNet parameters
[-0.13  0.02]
SymNet parameters
[[ 0.49 -0.   -0.01  0.03  0.01 -0.01 -0.51  0.05 -0.06  0.12  0.05  0.09  1.81  0.13
   0.33  2.13  0.01]]
SymNet parameters
[0.37]
finally, finish this stage
iter:     0    time: 49.20
Func: 3.23e-01  |g|: 4.67e+01
stableloss: 3.74e-02   dataloss: 2.95e-01   sparseloss: 1.20e+02 momentloss: 7.20e+00
current expression:
[u10*v00, u00*u01, u02, u20, u00, u00*u01**2, u00*u11*v00, u01*u10*v00, u10*v00*v10, u00**3, u00*u10*v01, u01, u00**2*u01, 1, u20*v00**2, u00*v00, u00*v00**2, u11, u01*v00*v10, u01**2]
[-0.98 -0.97  0.05  0.05  0.02  0.02  0.01  0.01  0.01 -0.01  0.01 -0.01  0.   -0.
  0.   -0.    0.   -0.   -0.    0.  ]
[v00*v10, u00*v01, v02, v20, v00*v10**2, u00*u01*v01, u00*v00*v11, u00*v01*v10, v00, u00, v00**2*v10, v10**2, 1, v00**2*v20, v01, u00**2*v10, u00**2, v10*v20, u01*v00*v10, u00**3]
[-0.99 -0.97  0.05  0.05  0.01  0.01  0.01  0.01  0.01 -0.   -0.    0.   -0.    0.
 -0.    0.    0.   -0.    0.    0.  ]
block:  5
name:  burgers-2-upwind-sparse0-noise0.001-id13
device:  cuda:1
generate a random number to check random seed:  0.9739959932739443
current stage is: block-5
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.8387, device='cuda:1', dtype=torch.float64)
u_obs variance
tensor([ 0.2464,  1.8613,  1.4922, 25.4289, 10.3833, 16.4739,  0.2332,  1.4561,
         1.5105, 17.1780,  8.5163, 19.2211], device='cuda:1',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 0.484296
         Iterations: 0
         Function evaluations: 15
         Gradient evaluations: 3
convolution moment and kernels
[[ 1.00e+00  0.00e+00  4.26e-04  5.04e-03 -1.03e-01]
 [ 0.00e+00  5.89e-05  7.71e-03  4.32e-03 -1.01e-02]
 [ 2.72e-03 -1.08e-03  7.43e-03 -4.58e-03 -5.35e-02]
 [-4.62e-02 -2.38e-03  7.23e-03 -3.02e-03 -1.22e-02]
 [-5.67e-02  3.81e-03  6.16e-03 -1.10e-03 -9.22e-03]]
[[ 1.19e-04 -7.58e-04 -3.74e-02  3.73e-03  4.21e-04]
 [-3.66e-02  1.48e-01 -2.34e-02  1.38e-01 -4.11e-02]
 [-2.91e-02  1.17e-01  4.57e-01  1.31e-01 -2.35e-02]
 [-3.09e-02  1.07e-01  1.44e-01  8.01e-02 -2.44e-02]
 [-9.20e-03  4.70e-02 -1.61e-01  5.58e-02 -1.22e-02]]
[[ 0.00e+00  1.00e+00  0.00e+00 -1.10e-01 -7.47e-02]
 [ 0.00e+00  0.00e+00 -9.03e-04 -2.58e-03 -3.03e-02]
 [ 0.00e+00  3.68e-02  1.54e-03  3.52e-02 -5.62e-03]
 [ 2.92e-03 -5.23e-03  5.54e-03 -3.74e-04 -9.80e-04]
 [ 7.32e-03 -5.39e-04 -1.45e-03  5.41e-03  2.13e-04]]
[[-2.29e-03  2.62e-03  8.81e-03 -3.59e-03  3.20e-04]
 [ 2.03e-04 -2.89e-02  3.91e-03 -2.09e-02  1.92e-02]
 [ 1.00e-01 -5.48e-01 -2.81e-01  9.90e-01 -2.17e-01]
 [-3.50e-02  9.88e-02 -2.02e-01  1.26e-01 -2.04e-02]
 [ 8.41e-04 -2.52e-03  2.19e-02 -1.58e-02  4.38e-03]]
[[ 0.00e+00  0.00e+00  0.00e+00 -5.55e-03 -8.08e-03]
 [ 1.00e+00  0.00e+00  3.97e-02 -2.69e-03 -5.43e-03]
 [ 0.00e+00  8.80e-04  1.08e-03  3.47e-03 -1.00e-02]
 [-9.33e-02 -4.21e-03  4.09e-02 -2.13e-03 -1.32e-02]
 [-4.38e-02 -1.64e-03 -3.28e-04 -1.06e-02 -7.53e-03]]
[[ 0.01 -0.03  0.13 -0.01 -0.  ]
 [-0.02  0.04 -0.58 -0.05  0.03]
 [ 0.01  0.04 -0.42  0.18 -0.07]
 [ 0.   -0.08  1.12 -0.16  0.05]
 [-0.01  0.06 -0.29  0.08 -0.02]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00 -9.10e-03]
 [ 0.00e+00  0.00e+00  0.00e+00 -3.10e-03 -2.02e-03]
 [ 0.00e+00  0.00e+00  3.57e-03 -8.87e-04 -4.51e-03]
 [ 0.00e+00 -2.60e-04 -3.22e-03  2.47e-03  6.79e-03]
 [ 1.92e-03 -1.05e-02 -3.25e-03  3.54e-02  3.20e-04]]
[[-0.02  0.05 -0.01 -0.03  0.02]
 [ 0.07 -0.15 -0.04  0.18 -0.07]
 [-0.19  1.54 -2.39  1.02  0.04]
 [ 0.06 -0.09 -0.15  0.27 -0.09]
 [-0.01  0.02  0.04 -0.07  0.02]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00 -4.06e-03]
 [ 0.00e+00  1.00e+00  0.00e+00 -4.57e-03  1.34e-03]
 [ 0.00e+00  0.00e+00  8.04e-05 -2.27e-04  4.49e-03]
 [ 0.00e+00 -3.91e-03 -5.56e-05  8.35e-03  3.61e-03]
 [-4.29e-02 -9.74e-02 -6.00e-04  7.44e-03 -1.64e-03]]
[[-0.01  0.03 -0.06  0.   -0.  ]
 [ 0.    0.11  0.26 -0.23  0.03]
 [-0.1   0.53 -0.4  -0.34  0.05]
 [ 0.12 -0.78  0.22  0.71 -0.1 ]
 [-0.02  0.13 -0.04 -0.13  0.02]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  1.66e-01]
 [ 0.00e+00  0.00e+00  0.00e+00  7.48e-04  1.02e-01]
 [ 1.00e+00  0.00e+00  8.84e-04  2.27e-03  7.41e-05]
 [ 0.00e+00 -8.52e-04 -2.90e-04  3.45e-04 -2.69e-03]
 [-9.27e-03 -4.48e-03  2.46e-04  3.36e-03 -7.52e-03]]
[[ 4.06e-04 -3.02e-03 -7.96e-02 -1.45e-02  4.14e-03]
 [-3.37e-02  1.39e-01  1.13e+00  1.83e-01 -4.71e-02]
 [ 1.11e-01 -4.52e-01 -1.83e+00 -5.17e-01  1.30e-01]
 [ 1.07e-01 -4.25e-01  1.97e+00 -3.80e-01  9.40e-02]
 [-1.94e-02  7.60e-02 -1.97e-01  6.29e-02 -1.53e-02]]
SymNet parameters
[[ 0.37  0.53  0.56 -0.34  0.07  0.12  1.99  0.37 -0.02 -0.03 -0.01  0.02]
 [ 0.32  0.19  0.1   0.08  0.01  0.03  2.29  0.14 -0.01  0.01 -0.01  0.  ]]
SymNet parameters
[-0.18 -0.63]
SymNet parameters
[[ 2.84e+00  3.51e-01  5.18e-01  1.05e-01  7.03e-02 -9.13e-03 -1.98e+00 -2.20e-01
  -3.48e-01  6.34e-03  1.29e-02  3.49e-02 -1.80e-02]
 [-1.03e-01 -4.18e-02  9.48e-02 -8.88e-03 -2.27e-04  1.48e-02  3.41e-02  2.17e-02
  -8.79e-03 -7.86e-04  1.13e-04  1.60e-03  1.77e-03]]
SymNet parameters
[1.48 0.05]
SymNet parameters
[[ 7.56e-01  1.20e+00 -4.32e-01 -1.03e-01 -2.77e-02  3.62e-02  8.74e-01  1.87e-01
  -3.70e-02 -9.00e-03 -6.84e-03  7.13e-03 -2.60e-02 -5.02e-02]
 [ 9.86e-01  1.35e-01  7.78e-02 -1.52e-02 -6.48e-03  2.61e-03 -9.60e-01  3.24e-02
   7.34e-03  1.05e-03 -9.54e-04 -2.76e-04  7.21e-04  3.62e-02]]
SymNet parameters
[0.05 0.21]
SymNet parameters
[[ 0.17 -0.33  0.17  0.08  0.02 -0.02  1.75 -0.15  0.01  0.01  0.   -0.01 -0.01  0.01
  -0.01]
 [ 1.05  0.97  0.51 -0.18 -0.05  0.05  1.21  0.31 -0.06 -0.02 -0.01  0.01 -0.01  0.13
   0.05]]
SymNet parameters
[-0.65 -0.75]
SymNet parameters
[[-1.71  0.64  0.18 -0.1  -0.02  0.02 -1.3   0.17 -0.02 -0.01 -0.01  0.01  0.01  0.1
   0.09  0.03]
 [-4.31 -0.45  0.67  0.63  0.14 -0.16 -3.36 -1.07  0.21  0.06  0.04 -0.05 -0.1  -0.09
  -0.12  0.09]]
SymNet parameters
[0.4  0.09]
SymNet parameters
[[-3.42e-02  1.39e-02 -3.09e-01  3.98e-02 -5.69e-03  5.00e-02 -6.78e-01  1.88e-02
   4.77e-03 -6.14e-04 -6.04e-04 -8.40e-04 -4.44e-03  1.04e-01 -6.72e-01 -4.34e-01
   8.23e-02]]
SymNet parameters
[0.2]
SymNet parameters
[[ 3.30e+00  1.01e-01 -2.63e-03  3.17e-03  5.14e-03  1.69e-03 -9.42e-02 -8.93e-03
  -3.01e-01  2.00e-02  1.60e-02  2.02e-02]
 [-4.32e+00  2.14e-01  1.41e-02  9.55e-03  4.30e-03  5.16e-03  6.76e-01 -1.10e-01
  -4.44e-01  1.53e-03  4.84e-03  1.00e-02]]
SymNet parameters
[0.51 0.3 ]
SymNet parameters
[[ 2.34e+00 -2.31e-03 -7.26e-03 -2.52e-03 -4.29e-03 -4.20e-03 -1.74e-02  1.82e-02
   1.95e-02  1.40e-02  1.40e-02 -6.97e-02 -2.21e-04]
 [-9.48e-01  1.07e-02  6.71e-04 -1.06e-03 -2.36e-03 -1.34e-03  1.67e-01 -8.98e-03
  -2.41e-03  4.68e-04 -1.67e-02 -3.38e-02 -8.04e-05]]
SymNet parameters
[-1.08  0.17]
SymNet parameters
[[ 0.16 -0.87 -0.02 -0.07 -0.03 -0.01 -0.66 -0.16 -3.   -0.15 -0.1  -0.12  0.21 -1.36]
 [ 0.3  -0.13 -0.02  0.03  0.01 -0.01  0.52  0.03 -0.06  0.08  0.06  0.05 -0.01  0.08]]
SymNet parameters
[-0.54  0.34]
SymNet parameters
[[ 3.82e+00 -1.14e-01 -6.65e-03 -1.46e-02 -4.04e-03 -3.82e-04 -2.25e-01  1.45e-02
   4.83e-01 -1.63e-02 -1.58e-02 -1.63e-02 -4.40e-03  2.59e-02  1.41e-03]
 [ 3.21e+00  3.07e-02 -8.09e-03  9.56e-03  5.64e-03 -2.14e-03 -3.58e-01 -5.70e-02
  -3.41e-01  3.51e-02  2.76e-02  2.78e-02  2.10e-03 -6.94e-03 -1.29e-03]]
SymNet parameters
[-0.46  0.6 ]
SymNet parameters
[[ 1.85 -2.05 -0.04 -0.16 -0.08 -0.02 -1.49 -0.25 -2.74 -0.36 -0.26 -0.3   0.16 -2.25
  -0.02 -0.22]
 [-2.97  3.08  0.4  -0.54 -0.1   0.25 -0.42 -0.87 -1.59 -1.26 -1.   -0.82  0.87 -1.46
   0.02  0.78]]
SymNet parameters
[-0.13  0.02]
SymNet parameters
[[ 0.49 -0.   -0.01  0.03  0.01 -0.01 -0.51  0.05 -0.06  0.12  0.05  0.09  1.81  0.13
   0.33  2.13  0.01]]
SymNet parameters
[0.37]
finally, finish this stage
iter:     0    time: 51.64
Func: 4.84e-01  |g|: 4.19e+01
stableloss: 2.67e-02   dataloss: 4.48e-01   sparseloss: 1.20e+02 momentloss: 7.20e+00
current expression:
[u10*v00, u00*u01, u02, u20, u00, u00*u01**2, u00*u11*v00, u01*u10*v00, u10*v00*v10, u00**3, u00*u10*v01, u01, u00**2*u01, 1, u20*v00**2, u00*v00, u00*v00**2, u11, u01*v00*v10, u01**2]
[-0.98 -0.97  0.05  0.05  0.02  0.02  0.01  0.01  0.01 -0.01  0.01 -0.01  0.   -0.
  0.   -0.    0.   -0.   -0.    0.  ]
[v00*v10, u00*v01, v02, v20, v00*v10**2, u00*u01*v01, u00*v00*v11, u00*v01*v10, v00, u00, v00**2*v10, v10**2, 1, v00**2*v20, v01, u00**2*v10, u00**2, v10*v20, u01*v00*v10, u00**3]
[-0.99 -0.97  0.05  0.05  0.01  0.01  0.01  0.01  0.01 -0.   -0.    0.   -0.    0.
 -0.    0.    0.   -0.    0.    0.  ]
block:  6
name:  burgers-2-upwind-sparse0-noise0.001-id13
device:  cuda:1
generate a random number to check random seed:  -0.7457591564883842
current stage is: block-6
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.9407, device='cuda:1', dtype=torch.float64)
u_obs variance
tensor([ 0.2522,  1.7217,  1.6688, 23.2432, 10.3333, 18.4895,  0.2523,  1.6424,
         1.6632, 19.4414,  9.8497, 20.9941], device='cuda:1',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 0.829278
         Iterations: 0
         Function evaluations: 15
         Gradient evaluations: 3
convolution moment and kernels
[[ 1.00e+00  0.00e+00  4.27e-04  5.05e-03 -1.03e-01]
 [ 0.00e+00  5.94e-05  7.71e-03  4.32e-03 -1.01e-02]
 [ 2.72e-03 -1.08e-03  7.43e-03 -4.59e-03 -5.35e-02]
 [-4.62e-02 -2.38e-03  7.23e-03 -3.02e-03 -1.22e-02]
 [-5.67e-02  3.80e-03  6.16e-03 -1.09e-03 -9.21e-03]]
[[ 1.25e-04 -7.90e-04 -3.73e-02  3.68e-03  4.34e-04]
 [-3.67e-02  1.48e-01 -2.37e-02  1.38e-01 -4.11e-02]
 [-2.91e-02  1.17e-01  4.58e-01  1.31e-01 -2.34e-02]
 [-3.09e-02  1.08e-01  1.44e-01  8.03e-02 -2.44e-02]
 [-9.19e-03  4.70e-02 -1.61e-01  5.57e-02 -1.22e-02]]
[[ 0.00e+00  1.00e+00  0.00e+00 -1.10e-01 -7.47e-02]
 [ 0.00e+00  0.00e+00 -9.03e-04 -2.58e-03 -3.03e-02]
 [ 0.00e+00  3.68e-02  1.54e-03  3.52e-02 -5.62e-03]
 [ 2.92e-03 -5.23e-03  5.55e-03 -3.74e-04 -9.82e-04]
 [ 7.32e-03 -5.48e-04 -1.46e-03  5.42e-03  2.32e-04]]
[[-2.27e-03  2.54e-03  8.95e-03 -3.70e-03  3.47e-04]
 [ 1.35e-04 -2.85e-02  3.30e-03 -2.04e-02  1.91e-02]
 [ 1.00e-01 -5.49e-01 -2.80e-01  9.89e-01 -2.17e-01]
 [-3.51e-02  9.92e-02 -2.02e-01  1.27e-01 -2.05e-02]
 [ 8.55e-04 -2.59e-03  2.20e-02 -1.59e-02  4.40e-03]]
[[ 0.00e+00  0.00e+00  0.00e+00 -5.54e-03 -8.08e-03]
 [ 1.00e+00  0.00e+00  3.97e-02 -2.69e-03 -5.43e-03]
 [ 0.00e+00  8.82e-04  1.08e-03  3.47e-03 -1.00e-02]
 [-9.33e-02 -4.21e-03  4.09e-02 -2.13e-03 -1.32e-02]
 [-4.38e-02 -1.65e-03 -3.29e-04 -1.06e-02 -7.53e-03]]
[[ 0.01 -0.03  0.13 -0.01 -0.  ]
 [-0.02  0.04 -0.58 -0.05  0.03]
 [ 0.01  0.04 -0.42  0.18 -0.07]
 [ 0.   -0.08  1.12 -0.16  0.05]
 [-0.01  0.06 -0.29  0.08 -0.02]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00 -9.10e-03]
 [ 0.00e+00  0.00e+00  0.00e+00 -3.10e-03 -2.02e-03]
 [ 0.00e+00  0.00e+00  3.57e-03 -8.88e-04 -4.51e-03]
 [ 0.00e+00 -2.60e-04 -3.22e-03  2.47e-03  6.79e-03]
 [ 1.92e-03 -1.05e-02 -3.26e-03  3.54e-02  3.23e-04]]
[[-0.02  0.05 -0.01 -0.03  0.02]
 [ 0.07 -0.15 -0.04  0.18 -0.07]
 [-0.19  1.54 -2.39  1.02  0.04]
 [ 0.06 -0.09 -0.15  0.27 -0.09]
 [-0.01  0.02  0.04 -0.07  0.02]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00 -4.06e-03]
 [ 0.00e+00  1.00e+00  0.00e+00 -4.57e-03  1.34e-03]
 [ 0.00e+00  0.00e+00  8.02e-05 -2.27e-04  4.49e-03]
 [ 0.00e+00 -3.91e-03 -5.55e-05  8.35e-03  3.61e-03]
 [-4.29e-02 -9.74e-02 -5.99e-04  7.44e-03 -1.64e-03]]
[[-0.01  0.03 -0.06  0.   -0.  ]
 [ 0.    0.11  0.26 -0.23  0.03]
 [-0.1   0.53 -0.4  -0.34  0.05]
 [ 0.12 -0.78  0.22  0.71 -0.1 ]
 [-0.02  0.13 -0.04 -0.13  0.02]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  1.66e-01]
 [ 0.00e+00  0.00e+00  0.00e+00  7.48e-04  1.02e-01]
 [ 1.00e+00  0.00e+00  8.85e-04  2.26e-03  7.22e-05]
 [ 0.00e+00 -8.52e-04 -2.90e-04  3.45e-04 -2.70e-03]
 [-9.27e-03 -4.48e-03  2.45e-04  3.36e-03 -7.52e-03]]
[[ 4.09e-04 -3.03e-03 -7.96e-02 -1.46e-02  4.15e-03]
 [-3.37e-02  1.39e-01  1.13e+00  1.83e-01 -4.71e-02]
 [ 1.11e-01 -4.52e-01 -1.83e+00 -5.17e-01  1.30e-01]
 [ 1.07e-01 -4.25e-01  1.97e+00 -3.80e-01  9.40e-02]
 [-1.94e-02  7.60e-02 -1.97e-01  6.29e-02 -1.53e-02]]
SymNet parameters
[[ 0.37  0.53  0.56 -0.34  0.07  0.12  1.99  0.37 -0.02 -0.03 -0.01  0.02]
 [ 0.32  0.19  0.1   0.08  0.01  0.03  2.29  0.14 -0.01  0.01 -0.01  0.  ]]
SymNet parameters
[-0.18 -0.63]
SymNet parameters
[[ 2.84e+00  3.51e-01  5.18e-01  1.05e-01  7.03e-02 -9.13e-03 -1.98e+00 -2.20e-01
  -3.48e-01  6.34e-03  1.29e-02  3.49e-02 -1.80e-02]
 [-1.03e-01 -4.18e-02  9.48e-02 -8.87e-03 -2.33e-04  1.48e-02  3.41e-02  2.17e-02
  -8.79e-03 -7.78e-04  1.12e-04  1.60e-03  1.80e-03]]
SymNet parameters
[1.48 0.05]
SymNet parameters
[[ 7.56e-01  1.20e+00 -4.32e-01 -1.04e-01 -2.77e-02  3.62e-02  8.74e-01  1.87e-01
  -3.70e-02 -8.99e-03 -6.83e-03  7.13e-03 -2.61e-02 -5.02e-02]
 [ 9.86e-01  1.35e-01  7.77e-02 -1.52e-02 -6.46e-03  2.60e-03 -9.60e-01  3.24e-02
   7.34e-03  1.06e-03 -9.58e-04 -2.93e-04  8.32e-04  3.62e-02]]
SymNet parameters
[0.05 0.21]
SymNet parameters
[[ 0.17 -0.33  0.17  0.08  0.02 -0.02  1.75 -0.15  0.01  0.01  0.   -0.01 -0.01  0.01
  -0.01]
 [ 1.05  0.97  0.51 -0.18 -0.05  0.05  1.21  0.31 -0.06 -0.02 -0.01  0.01 -0.01  0.13
   0.05]]
SymNet parameters
[-0.65 -0.75]
SymNet parameters
[[-1.71  0.64  0.18 -0.1  -0.02  0.02 -1.3   0.17 -0.02 -0.01 -0.01  0.01  0.01  0.1
   0.09  0.03]
 [-4.31 -0.45  0.67  0.63  0.14 -0.16 -3.36 -1.07  0.21  0.06  0.04 -0.05 -0.1  -0.09
  -0.12  0.09]]
SymNet parameters
[0.4  0.09]
SymNet parameters
[[-3.42e-02  1.39e-02 -3.09e-01  3.98e-02 -5.69e-03  5.00e-02 -6.78e-01  1.88e-02
   4.77e-03 -6.08e-04 -5.94e-04 -8.48e-04 -4.46e-03  1.04e-01 -6.72e-01 -4.34e-01
   8.22e-02]]
SymNet parameters
[0.2]
SymNet parameters
[[ 3.30e+00  1.01e-01 -2.64e-03  3.17e-03  5.19e-03  1.75e-03 -9.42e-02 -8.98e-03
  -3.01e-01  2.00e-02  1.60e-02  2.02e-02]
 [-4.32e+00  2.14e-01  1.41e-02  9.56e-03  4.26e-03  5.12e-03  6.76e-01 -1.10e-01
  -4.44e-01  1.51e-03  4.87e-03  1.00e-02]]
SymNet parameters
[0.51 0.3 ]
SymNet parameters
[[ 2.34e+00 -2.31e-03 -7.26e-03 -2.52e-03 -4.29e-03 -4.20e-03 -1.74e-02  1.82e-02
   1.95e-02  1.40e-02  1.40e-02 -6.97e-02 -2.07e-04]
 [-9.48e-01  1.07e-02  6.70e-04 -1.06e-03 -2.36e-03 -1.34e-03  1.67e-01 -8.98e-03
  -2.41e-03  4.75e-04 -1.67e-02 -3.38e-02 -9.39e-05]]
SymNet parameters
[-1.08  0.17]
SymNet parameters
[[ 0.16 -0.87 -0.02 -0.07 -0.03 -0.01 -0.66 -0.16 -3.   -0.15 -0.1  -0.12  0.21 -1.36]
 [ 0.3  -0.13 -0.02  0.03  0.01 -0.01  0.52  0.03 -0.06  0.08  0.06  0.05 -0.01  0.08]]
SymNet parameters
[-0.54  0.34]
SymNet parameters
[[ 3.82e+00 -1.14e-01 -6.64e-03 -1.46e-02 -4.09e-03 -4.36e-04 -2.25e-01  1.45e-02
   4.83e-01 -1.63e-02 -1.58e-02 -1.62e-02 -4.44e-03  2.59e-02  1.54e-03]
 [ 3.21e+00  3.07e-02 -8.08e-03  9.57e-03  5.59e-03 -2.20e-03 -3.58e-01 -5.69e-02
  -3.41e-01  3.51e-02  2.76e-02  2.78e-02  2.14e-03 -6.94e-03 -1.27e-03]]
SymNet parameters
[-0.46  0.6 ]
SymNet parameters
[[ 1.85 -2.05 -0.04 -0.16 -0.08 -0.02 -1.49 -0.25 -2.74 -0.36 -0.26 -0.3   0.16 -2.25
  -0.02 -0.22]
 [-2.97  3.08  0.4  -0.54 -0.1   0.25 -0.42 -0.87 -1.59 -1.26 -1.   -0.82  0.87 -1.46
   0.02  0.78]]
SymNet parameters
[-0.13  0.02]
SymNet parameters
[[ 0.49 -0.   -0.01  0.03  0.01 -0.01 -0.51  0.05 -0.06  0.12  0.05  0.09  1.81  0.13
   0.33  2.13  0.01]]
SymNet parameters
[0.37]
finally, finish this stage
iter:     0    time: 49.96
Func: 8.29e-01  |g|: 1.46e+02
stableloss: 4.49e-02   dataloss: 7.86e-01   sparseloss: 1.20e+02 momentloss: 7.20e+00
current expression:
[u10*v00, u00*u01, u02, u20, u00, u00*u01**2, u00*u11*v00, u01*u10*v00, u10*v00*v10, u00**3, u00*u10*v01, u01, u00**2*u01, 1, u20*v00**2, u00*v00, u00*v00**2, u11, u01*v00*v10, u01**2]
[-0.98 -0.97  0.05  0.05  0.02  0.02  0.01  0.01  0.01 -0.01  0.01 -0.01  0.   -0.
  0.   -0.    0.   -0.   -0.    0.  ]
[v00*v10, u00*v01, v02, v20, v00*v10**2, u00*u01*v01, u00*v00*v11, u00*v01*v10, v00, u00, v00**2*v10, v10**2, 1, v00**2*v20, v01, u00**2*v10, u00**2, v10*v20, u01*v00*v10, u00**3]
[-0.99 -0.97  0.05  0.05  0.01  0.01  0.01  0.01  0.01 -0.   -0.    0.   -0.    0.
 -0.    0.    0.   -0.    0.    0.  ]
block:  9
name:  burgers-2-upwind-sparse0-noise0.001-id13
device:  cuda:1
generate a random number to check random seed:  1.003854205016046
current stage is: block-9
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.9617, device='cuda:1', dtype=torch.float64)
u_obs variance
tensor([ 0.2290,  1.6836,  1.4064, 24.3633,  9.5897, 15.6558,  0.2614,  1.6827,
         1.8720, 20.3541, 10.2949, 24.6257], device='cuda:1',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 2.965424
         Iterations: 0
         Function evaluations: 15
         Gradient evaluations: 3
convolution moment and kernels
[[ 1.00e+00  0.00e+00  4.31e-04  5.05e-03 -1.03e-01]
 [ 0.00e+00  5.93e-05  7.71e-03  4.32e-03 -1.01e-02]
 [ 2.72e-03 -1.08e-03  7.42e-03 -4.58e-03 -5.35e-02]
 [-4.62e-02 -2.38e-03  7.23e-03 -3.02e-03 -1.22e-02]
 [-5.67e-02  3.81e-03  6.16e-03 -1.10e-03 -9.23e-03]]
[[ 1.07e-04 -7.06e-04 -3.75e-02  3.78e-03  4.09e-04]
 [-3.66e-02  1.48e-01 -2.30e-02  1.37e-01 -4.10e-02]
 [-2.92e-02  1.17e-01  4.57e-01  1.32e-01 -2.36e-02]
 [-3.09e-02  1.07e-01  1.45e-01  7.99e-02 -2.43e-02]
 [-9.21e-03  4.70e-02 -1.61e-01  5.58e-02 -1.22e-02]]
[[ 0.00e+00  1.00e+00  0.00e+00 -1.10e-01 -7.47e-02]
 [ 0.00e+00  0.00e+00 -9.03e-04 -2.58e-03 -3.03e-02]
 [ 0.00e+00  3.68e-02  1.54e-03  3.52e-02 -5.61e-03]
 [ 2.92e-03 -5.23e-03  5.54e-03 -3.75e-04 -9.81e-04]
 [ 7.32e-03 -5.43e-04 -1.45e-03  5.41e-03  2.12e-04]]
[[-2.29e-03  2.63e-03  8.79e-03 -3.59e-03  3.21e-04]
 [ 2.19e-04 -2.89e-02  3.97e-03 -2.09e-02  1.92e-02]
 [ 1.00e-01 -5.48e-01 -2.81e-01  9.90e-01 -2.17e-01]
 [-3.50e-02  9.88e-02 -2.02e-01  1.26e-01 -2.04e-02]
 [ 8.38e-04 -2.51e-03  2.19e-02 -1.58e-02  4.38e-03]]
[[ 0.00e+00  0.00e+00  0.00e+00 -5.54e-03 -8.10e-03]
 [ 1.00e+00  0.00e+00  3.97e-02 -2.69e-03 -5.42e-03]
 [ 0.00e+00  8.83e-04  1.08e-03  3.47e-03 -1.00e-02]
 [-9.33e-02 -4.21e-03  4.09e-02 -2.13e-03 -1.32e-02]
 [-4.38e-02 -1.65e-03 -3.26e-04 -1.06e-02 -7.54e-03]]
[[ 0.01 -0.03  0.13 -0.01 -0.  ]
 [-0.02  0.04 -0.58 -0.05  0.03]
 [ 0.01  0.04 -0.42  0.18 -0.07]
 [ 0.   -0.08  1.12 -0.16  0.05]
 [-0.01  0.06 -0.29  0.08 -0.02]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00 -9.09e-03]
 [ 0.00e+00  0.00e+00  0.00e+00 -3.10e-03 -2.02e-03]
 [ 0.00e+00  0.00e+00  3.58e-03 -8.88e-04 -4.51e-03]
 [ 0.00e+00 -2.60e-04 -3.22e-03  2.47e-03  6.79e-03]
 [ 1.92e-03 -1.05e-02 -3.26e-03  3.54e-02  3.22e-04]]
[[-0.02  0.05 -0.01 -0.03  0.02]
 [ 0.07 -0.15 -0.04  0.18 -0.07]
 [-0.19  1.54 -2.39  1.02  0.04]
 [ 0.06 -0.09 -0.15  0.27 -0.09]
 [-0.01  0.02  0.04 -0.07  0.02]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00 -4.06e-03]
 [ 0.00e+00  1.00e+00  0.00e+00 -4.57e-03  1.34e-03]
 [ 0.00e+00  0.00e+00  8.03e-05 -2.27e-04  4.49e-03]
 [ 0.00e+00 -3.91e-03 -5.56e-05  8.35e-03  3.61e-03]
 [-4.29e-02 -9.74e-02 -6.00e-04  7.44e-03 -1.64e-03]]
[[-0.01  0.03 -0.06  0.   -0.  ]
 [ 0.    0.11  0.26 -0.23  0.03]
 [-0.1   0.53 -0.4  -0.34  0.05]
 [ 0.12 -0.78  0.22  0.71 -0.1 ]
 [-0.02  0.13 -0.04 -0.13  0.02]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  1.66e-01]
 [ 0.00e+00  0.00e+00  0.00e+00  7.48e-04  1.02e-01]
 [ 1.00e+00  0.00e+00  8.84e-04  2.27e-03  7.52e-05]
 [ 0.00e+00 -8.52e-04 -2.90e-04  3.45e-04 -2.70e-03]
 [-9.27e-03 -4.48e-03  2.46e-04  3.36e-03 -7.53e-03]]
[[ 4.05e-04 -3.01e-03 -7.96e-02 -1.45e-02  4.14e-03]
 [-3.36e-02  1.39e-01  1.13e+00  1.83e-01 -4.71e-02]
 [ 1.11e-01 -4.52e-01 -1.83e+00 -5.17e-01  1.30e-01]
 [ 1.07e-01 -4.25e-01  1.97e+00 -3.80e-01  9.40e-02]
 [-1.94e-02  7.60e-02 -1.97e-01  6.29e-02 -1.53e-02]]
SymNet parameters
[[ 0.37  0.53  0.56 -0.34  0.07  0.12  1.99  0.37 -0.02 -0.03 -0.01  0.02]
 [ 0.32  0.19  0.1   0.08  0.01  0.03  2.29  0.14 -0.01  0.01 -0.01  0.  ]]
SymNet parameters
[-0.18 -0.63]
SymNet parameters
[[ 2.84e+00  3.51e-01  5.18e-01  1.05e-01  7.03e-02 -9.13e-03 -1.98e+00 -2.20e-01
  -3.48e-01  6.34e-03  1.29e-02  3.49e-02 -1.80e-02]
 [-1.03e-01 -4.18e-02  9.48e-02 -8.88e-03 -2.28e-04  1.48e-02  3.41e-02  2.17e-02
  -8.79e-03 -7.84e-04  1.11e-04  1.60e-03  1.70e-03]]
SymNet parameters
[1.48 0.05]
SymNet parameters
[[ 7.56e-01  1.20e+00 -4.32e-01 -1.03e-01 -2.77e-02  3.62e-02  8.74e-01  1.87e-01
  -3.70e-02 -9.00e-03 -6.83e-03  7.13e-03 -2.61e-02 -5.02e-02]
 [ 9.86e-01  1.35e-01  7.77e-02 -1.52e-02 -6.47e-03  2.59e-03 -9.60e-01  3.24e-02
   7.34e-03  1.04e-03 -9.50e-04 -2.90e-04  7.83e-04  3.62e-02]]
SymNet parameters
[0.05 0.21]
SymNet parameters
[[ 0.17 -0.33  0.17  0.08  0.02 -0.02  1.75 -0.15  0.01  0.01  0.   -0.01 -0.01  0.01
  -0.01]
 [ 1.05  0.97  0.51 -0.18 -0.05  0.05  1.21  0.31 -0.06 -0.02 -0.01  0.01 -0.01  0.13
   0.05]]
SymNet parameters
[-0.65 -0.75]
SymNet parameters
[[-1.71  0.64  0.18 -0.1  -0.02  0.02 -1.3   0.17 -0.02 -0.01 -0.01  0.01  0.01  0.1
   0.09  0.03]
 [-4.31 -0.45  0.67  0.63  0.14 -0.16 -3.36 -1.07  0.21  0.06  0.04 -0.05 -0.1  -0.09
  -0.12  0.09]]
SymNet parameters
[0.4  0.09]
SymNet parameters
[[-3.42e-02  1.39e-02 -3.09e-01  3.98e-02 -5.70e-03  5.00e-02 -6.78e-01  1.88e-02
   4.77e-03 -6.19e-04 -5.93e-04 -8.49e-04 -4.47e-03  1.04e-01 -6.72e-01 -4.34e-01
   8.22e-02]]
SymNet parameters
[0.2]
SymNet parameters
[[ 3.30e+00  1.01e-01 -2.64e-03  3.16e-03  5.21e-03  1.73e-03 -9.42e-02 -8.98e-03
  -3.01e-01  2.02e-02  1.60e-02  2.02e-02]
 [-4.32e+00  2.14e-01  1.41e-02  9.57e-03  4.25e-03  5.13e-03  6.76e-01 -1.10e-01
  -4.44e-01  1.42e-03  4.84e-03  9.96e-03]]
SymNet parameters
[0.51 0.3 ]
SymNet parameters
[[ 2.34e+00 -2.31e-03 -7.26e-03 -2.52e-03 -4.29e-03 -4.20e-03 -1.74e-02  1.82e-02
   1.95e-02  1.40e-02  1.40e-02 -6.97e-02 -2.47e-04]
 [-9.48e-01  1.07e-02  6.71e-04 -1.06e-03 -2.36e-03 -1.33e-03  1.67e-01 -8.98e-03
  -2.41e-03  4.65e-04 -1.67e-02 -3.38e-02  4.58e-06]]
SymNet parameters
[-1.08  0.17]
SymNet parameters
[[ 0.16 -0.87 -0.02 -0.07 -0.03 -0.01 -0.66 -0.16 -3.   -0.15 -0.1  -0.12  0.21 -1.36]
 [ 0.3  -0.13 -0.02  0.03  0.01 -0.01  0.52  0.03 -0.06  0.08  0.06  0.05 -0.01  0.08]]
SymNet parameters
[-0.54  0.34]
SymNet parameters
[[ 3.82e+00 -1.14e-01 -6.64e-03 -1.46e-02 -4.10e-03 -4.13e-04 -2.25e-01  1.45e-02
   4.83e-01 -1.64e-02 -1.58e-02 -1.63e-02 -4.50e-03  2.59e-02  1.51e-03]
 [ 3.21e+00  3.07e-02 -8.08e-03  9.58e-03  5.57e-03 -2.18e-03 -3.58e-01 -5.69e-02
  -3.41e-01  3.49e-02  2.76e-02  2.78e-02  2.23e-03 -6.91e-03 -1.23e-03]]
SymNet parameters
[-0.46  0.6 ]
SymNet parameters
[[ 1.85 -2.05 -0.04 -0.16 -0.08 -0.02 -1.49 -0.25 -2.74 -0.36 -0.26 -0.3   0.16 -2.25
  -0.02 -0.22]
 [-2.97  3.08  0.4  -0.54 -0.1   0.25 -0.42 -0.87 -1.59 -1.26 -1.   -0.82  0.87 -1.46
   0.02  0.78]]
SymNet parameters
[-0.13  0.02]
SymNet parameters
[[ 0.49 -0.   -0.01  0.03  0.01 -0.01 -0.51  0.05 -0.06  0.12  0.05  0.09  1.81  0.13
   0.33  2.13  0.01]]
SymNet parameters
[0.37]
finally, finish this stage
iter:     0    time: 51.07
Func: 2.97e+00  |g|: 6.83e+02
stableloss: 1.04e-01   dataloss: 2.90e+00   sparseloss: 1.20e+02 momentloss: 7.20e+00
current expression:
[u10*v00, u00*u01, u02, u20, u00, u00*u01**2, u00*u11*v00, u01*u10*v00, u10*v00*v10, u00**3, u00*u10*v01, u01, u00**2*u01, 1, u20*v00**2, u00*v00, u00*v00**2, u11, u01*v00*v10, u01**2]
[-0.98 -0.97  0.05  0.05  0.02  0.02  0.01  0.01  0.01 -0.01  0.01 -0.01  0.   -0.
  0.   -0.    0.   -0.   -0.    0.  ]
[v00*v10, u00*v01, v02, v20, v00*v10**2, u00*u01*v01, u00*v00*v11, u00*v01*v10, v00, u00, v00**2*v10, v10**2, 1, v00**2*v20, v01, u00**2*v10, u00**2, v10*v20, u01*v00*v10, u00**3]
[-0.99 -0.97  0.05  0.05  0.01  0.01  0.01  0.01  0.01 -0.   -0.    0.   -0.    0.
 -0.    0.    0.   -0.    0.    0.  ]
u_obs.abs().max()
tensor(3.9549, device='cuda:1', dtype=torch.float64)
model(u_obs[0],T=50*dt).abs().max()
tensor(nan, device='cuda:1', dtype=torch.float64)
model(u_obs[0],T=100*dt).abs().max()
tensor(nan, device='cuda:1', dtype=torch.float64)
{'--name': 'burgers-2-upwind-sparse0-noise0.001-id14', '--dtype': 'double', '--device': 'cuda:2', '--constraint': '2', '--dt': 0.01, '--cell_num': 1, '--eps': 6.283185307179586, '--blocks': [0, 1, 2, 3, 4, 5, 6, 9], '--kernel_size': 5, '--max_order': 2, '--dx': 0.19634954084936207, '--hidden_layers': 5, '--scheme': 'upwind', '--dataname': 'burgers', '--viscosity': 0.05, '--zoom': 4, '--max_dt': 0.000625, '--batch_size': 28, '--data_timescheme': 'rk2', '--channel_names': 'u,v', '--freq': 4, '--data_start_time': 1.0, '--start_noise': 0.001, '--end_noise': 0.001, '--stablize': 0.0, '--sparsity': 0.0, '--momentsparsity': 0.001, '--npseed': -1, '--torchseed': -1, '--maxiter': 2000, '--recordfile': 'None', '--recordcycle': 200, '--savecycle': -1, '--start_from': -1}
block:  0
name:  burgers-2-upwind-sparse0-noise0.001-id14
device:  cuda:2
generate a random number to check random seed:  -0.2890338134224357
current stage is: warmup
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.9127, device='cuda:2', dtype=torch.float64)
u_obs variance
tensor([ 0.2762,  2.3064,  2.0932, 21.2879, 10.5265, 18.0818,  0.2724,  2.1053,
         2.3176, 18.4382, 10.4474, 21.8229], device='cuda:2',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
iter:     0    time: 6.73
Func: 6.47e+00  |g|: 2.94e+00
stableloss: 3.27e-03   dataloss: 6.47e+00   sparseloss: 2.48e+01 momentloss: 7.27e+00
iter:   200    time: 11.93
Func: 4.72e-02  |g|: 4.30e-02
stableloss: 1.69e-02   dataloss: 4.72e-02   sparseloss: 5.61e+01 momentloss: 7.27e+00
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 0.044888
         Iterations: 379
         Function evaluations: 459
         Gradient evaluations: 452
convolution moment and kernels
[[1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
[[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 1. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
[[ 0.    1.    0.   -0.33 -0.25]
 [ 0.    0.    0.    0.    0.  ]
 [ 0.    0.    0.    0.    0.  ]
 [ 0.    0.    0.    0.    0.  ]
 [ 0.    0.    0.    0.    0.  ]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]
 [ 2.78e-17  3.33e-16 -1.50e+00  2.00e+00 -5.00e-01]
 [ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]]
[[ 0.    0.    0.    0.    0.  ]
 [ 1.    0.    0.    0.    0.  ]
 [ 0.    0.    0.    0.    0.  ]
 [-0.33  0.    0.    0.    0.  ]
 [-0.25  0.    0.    0.    0.  ]]
[[ 0.00e+00  0.00e+00  2.78e-17  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  3.33e-16  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00 -1.50e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  2.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00 -5.00e-01  0.00e+00  0.00e+00]]
[[0.   0.   1.   0.   0.08]
 [0.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.  ]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]
 [-2.22e-16  1.00e+00 -2.00e+00  1.00e+00 -1.53e-16]
 [ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]]
[[0. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
[[ 6.94e-03 -5.56e-02  9.25e-18  5.56e-02 -6.94e-03]
 [-5.56e-02  4.44e-01 -7.40e-17 -4.44e-01  5.56e-02]
 [ 9.25e-18 -7.40e-17  1.23e-32  7.40e-17 -9.25e-18]
 [ 5.56e-02 -4.44e-01  7.40e-17  4.44e-01 -5.56e-02]
 [-6.94e-03  5.56e-02 -9.25e-18 -5.56e-02  6.94e-03]]
[[0.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.  ]
 [1.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.  ]
 [0.08 0.   0.   0.   0.  ]]
[[ 0.00e+00  0.00e+00 -2.22e-16  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  1.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00 -2.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  1.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00 -1.53e-16  0.00e+00  0.00e+00]]
SymNet parameters
[[ 1.16e-01 -8.16e-01  8.30e-01 -3.37e-03 -3.52e-03  1.05e-03  1.06e-01 -4.76e-03
   4.37e-03 -2.41e-03 -1.95e-03  2.08e-04]
 [-1.16e+00  6.55e-02  1.45e-01  3.64e-03  3.37e-03  1.55e-03  4.92e-01  7.75e-03
   1.56e-02  1.43e-04  2.87e-04 -5.07e-04]]
SymNet parameters
[ 0.12 -0.37]
SymNet parameters
[[-0.79 -0.16 -0.87 -0.05 -0.56  0.04  0.55 -0.2   0.43 -0.    0.07  0.03  0.12]
 [ 0.32  0.1  -0.23 -0.24 -0.01  0.08  1.78  0.21  0.04 -0.01  0.   -0.04  0.29]]
SymNet parameters
[-0.14  0.16]
SymNet parameters
[[ 0.1  -1.   -0.07  0.24 -0.11 -0.2  -0.92  0.03  0.17 -0.01  0.06 -0.07 -0.57  0.06]
 [ 0.53  0.52 -0.42  1.07 -0.27  0.51 -0.57  0.15 -0.39  0.28  0.09  0.23  0.27 -0.04]]
SymNet parameters
[-0.05 -0.05]
SymNet parameters
[[ 6.18e-02 -2.37e-01 -5.72e-01  2.74e-02  4.32e-02 -9.86e-04 -1.16e-01  4.99e-02
   9.59e-02  1.51e-03 -2.10e-03  1.60e-03 -7.71e-02  2.57e-03  4.68e-03]
 [ 8.17e-01  8.22e-02 -1.12e-01 -7.06e-03 -1.04e-02 -7.14e-04  8.58e-01 -5.46e-03
  -2.18e-02  7.04e-04  1.06e-03 -2.86e-03  5.35e-03 -4.08e-03 -1.33e-03]]
SymNet parameters
[-0.47  0.34]
SymNet parameters
[[ 4.99e-01  1.22e-01 -3.15e-02  1.74e-03 -4.13e-03 -2.92e-03  5.02e-01 -1.45e-02
  -7.13e-03 -1.47e-03 -2.10e-03 -1.09e-03  3.97e-03  2.23e-03  5.36e-04  3.64e-02]
 [-6.36e-01 -2.37e-01 -4.09e-01 -1.08e-01 -1.83e-01 -6.26e-04  6.70e-01 -1.98e-01
  -4.15e-01 -1.44e-03  8.25e-03 -1.40e-02  3.13e-01 -2.53e-02 -1.99e-02  1.26e-02]]
SymNet parameters
[-0.02 -0.02]
SymNet parameters
[[ 2.76e-01  3.21e-01 -3.26e-02  1.94e-02 -2.88e-02  3.51e-02  5.02e-01 -2.18e-02
  -4.92e-02 -1.86e-05 -5.89e-05 -2.06e-03 -5.99e-01 -1.40e-03 -2.49e-03  1.08e+00
   4.49e-01]]
SymNet parameters
[0.14]
SymNet parameters
[[-8.81e-02 -7.72e-03 -2.89e-02  7.17e-03 -9.79e-05 -1.18e-02 -1.30e+00  2.70e-01
   2.20e-01 -2.69e-03 -5.19e-02 -6.34e-02]
 [ 3.67e-01  1.46e-01 -1.39e-01  6.25e-02  1.70e-02 -2.11e-02 -9.38e-01 -5.78e-01
  -9.60e-01 -2.21e-03 -2.19e-01 -2.38e-01]]
SymNet parameters
[-0.29 -0.46]
SymNet parameters
[[ 8.72e-01  4.05e-01  7.59e-02 -3.01e-03  3.33e-02  1.99e-01 -3.00e-01  5.65e-01
  -6.87e-01 -6.55e-02  3.84e-01  6.33e-01  1.27e-02]
 [ 7.05e-01 -2.56e-02  1.01e-03 -1.33e-03 -1.81e-03 -5.14e-03 -1.06e+00 -1.05e-01
  -1.72e-01 -3.09e-03 -1.89e-02 -2.51e-02  1.03e-02]]
SymNet parameters
[-0.06 -0.14]
SymNet parameters
[[-0.55  0.39  0.01  0.13  0.08  0.53 -0.09  0.45  0.21 -0.53  0.17  1.    0.58 -0.52]
 [-0.31 -0.1  -0.    0.01 -0.01 -0.04 -0.72  0.46 -0.05  0.01 -0.1  -0.17  0.    0.  ]]
SymNet parameters
[ 0.18 -0.13]
SymNet parameters
[[ 1.22e+00  3.70e-02  1.21e-02 -7.72e-04  4.69e-03  4.39e-02 -1.63e-01  1.27e-01
   1.76e-01 -3.55e-02  4.71e-02  1.14e-01  3.33e-02 -2.82e-02 -3.77e-04]
 [ 3.02e-01  4.51e-02  6.77e-02 -1.26e-02  7.78e-03  9.70e-02 -5.86e-01 -1.76e+00
  -6.32e-01 -6.70e-02  1.54e-01  2.91e-01  8.55e-02 -5.26e-02  1.94e-03]]
SymNet parameters
[-0.27  0.25]
SymNet parameters
[[ 0.53 -0.01 -0.02  0.01  0.   -0.   -1.5   0.06  0.07 -0.01 -0.06 -0.05  0.03 -0.01
  -0.01 -0.02]
 [-0.16 -0.35  0.09 -0.03 -0.03 -0.02  0.95 -0.14 -0.76 -0.04 -0.04 -0.04  0.09 -0.09
  -0.01 -0.01]]
SymNet parameters
[ 0.11 -0.14]
SymNet parameters
[[-0.18 -0.03  0.03 -0.01 -0.    0.01  0.35 -0.19 -0.02  0.03  0.03  0.07 -0.27 -0.31
   0.07  0.36 -0.29]]
SymNet parameters
[0.06]
finally, finish this stage
iter:   379    time: 10.56
Func: 4.49e-02  |g|: 3.85e-02
stableloss: 1.65e-02   dataloss: 4.49e-02   sparseloss: 6.79e+01 momentloss: 7.27e+00
current expression:
[u00*u01, u10*v00, u20, u02, u00*u10, u00*u01**2, u00**2*v00, v00**2, u11, u01*u10*v00, u10*v00*v10, u00, u00*u01*u10, u00*u11*v00, u01, u10, u00*u11, u00*v10, u01*v00, u00*u10*v00]
[-0.89 -0.89  0.04  0.03  0.01  0.01  0.01  0.01 -0.01  0.01  0.01  0.01 -0.01  0.01
 -0.    0.   -0.   -0.    0.    0.  ]
[u00*v01, v00*v10, v20, v02, v00, u00*v00**2, u00, v00*v10**2, v00**3, v01, u10, u00**2, u00*v01*v10, u00*v00, u00*v00*v11, u00*v00*v20, v00**2, u00*u01*v01, u00*v10, v11]
[-0.88 -0.88  0.04  0.03  0.02  0.01 -0.01  0.01 -0.01  0.01  0.01 -0.01  0.01  0.01
  0.    0.    0.    0.    0.    0.  ]
block:  1
name:  burgers-2-upwind-sparse0-noise0.001-id14
device:  cuda:2
generate a random number to check random seed:  -2.1635629231779023
current stage is: block-1
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.5721, device='cuda:2', dtype=torch.float64)
u_obs variance
tensor([ 0.2570,  2.1059,  2.1222, 19.1768, 10.1223, 18.9218,  0.2653,  2.0731,
         2.1340, 18.0929,  9.8872, 19.8322], device='cuda:2',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
iter:     0    time: 2454.47
Func: 6.61e-02  |g|: 3.00e+00
stableloss: 1.18e-02   dataloss: 5.88e-02   sparseloss: 6.79e+01 momentloss: 7.27e+00
iter:   200    time: 10.28
Func: 2.58e-02  |g|: 2.64e-02
stableloss: 8.06e-03   dataloss: 1.89e-02   sparseloss: 6.61e+01 momentloss: 6.94e+00
iter:   400    time: 10.29
Func: 2.50e-02  |g|: 1.73e-02
stableloss: 7.91e-03   dataloss: 1.82e-02   sparseloss: 6.61e+01 momentloss: 6.81e+00
iter:   600    time: 10.34
Func: 2.44e-02  |g|: 2.86e-02
stableloss: 7.82e-03   dataloss: 1.77e-02   sparseloss: 7.06e+01 momentloss: 6.69e+00
iter:   800    time: 10.34
Func: 2.41e-02  |g|: 6.75e-03
stableloss: 7.69e-03   dataloss: 1.75e-02   sparseloss: 7.80e+01 momentloss: 6.60e+00
iter:  1000    time: 10.32
Func: 2.40e-02  |g|: 4.94e-03
stableloss: 7.68e-03   dataloss: 1.74e-02   sparseloss: 8.28e+01 momentloss: 6.62e+00
iter:  1200    time: 10.32
Func: 2.39e-02  |g|: 3.13e-03
stableloss: 7.70e-03   dataloss: 1.73e-02   sparseloss: 8.64e+01 momentloss: 6.61e+00
iter:  1400    time: 10.32
Func: 2.39e-02  |g|: 4.01e-03
stableloss: 7.73e-03   dataloss: 1.73e-02   sparseloss: 8.81e+01 momentloss: 6.60e+00
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 0.023925
         Iterations: 1426
         Function evaluations: 1484
         Gradient evaluations: 1476
convolution moment and kernels
[[ 1.00e+00  0.00e+00  2.05e-05 -4.44e-02 -6.38e-02]
 [ 0.00e+00  1.17e-05 -1.50e-03 -1.67e-03 -8.96e-03]
 [ 1.26e-04  2.57e-03  2.85e-03  8.27e-03 -9.91e-04]
 [-7.11e-03 -4.48e-04  8.05e-03  3.17e-03  1.31e-03]
 [-4.84e-02 -4.37e-03 -6.67e-04 -8.87e-03  8.61e-03]]
[[ 1.30e-02 -4.43e-02  1.15e-02 -2.75e-02  2.43e-03]
 [-5.35e-02  1.72e-01 -2.31e-02  9.74e-02 -6.08e-03]
 [ 4.77e-02 -7.29e-02  6.79e-01  1.20e-01 -6.51e-02]
 [-6.22e-02  1.97e-01 -5.11e-02  1.41e-01 -2.35e-02]
 [ 1.33e-02 -4.07e-02  5.22e-04 -3.14e-02  6.31e-03]]
[[ 0.00e+00  1.00e+00  0.00e+00 -1.12e-01 -6.65e-02]
 [ 0.00e+00  0.00e+00 -3.28e-03 -2.84e-03 -1.01e-02]
 [ 0.00e+00  1.77e-02  6.69e-03  7.00e-03 -7.27e-03]
 [-3.83e-03  6.22e-04  7.72e-03  1.16e-04  7.81e-04]
 [ 8.23e-03 -1.73e-03 -7.39e-03 -1.02e-02 -5.28e-03]]
[[ 3.56e-04 -1.24e-03  4.92e-03  1.63e-02 -1.02e-02]
 [-8.61e-03  2.03e-02 -4.41e-02 -4.27e-02  3.84e-02]
 [ 9.90e-02 -5.82e-01 -2.78e-01  1.06e+00 -2.49e-01]
 [-2.01e-02  5.07e-02 -7.70e-02 -5.86e-03  2.31e-02]
 [ 1.89e-03  1.02e-04 -4.79e-03  1.73e-02 -8.13e-03]]
[[ 0.00e+00  0.00e+00  0.00e+00 -4.12e-03  1.41e-02]
 [ 1.00e+00  0.00e+00  2.57e-02 -2.25e-03 -8.40e-03]
 [ 0.00e+00 -3.41e-04  3.28e-04  1.45e-03 -1.40e-03]
 [-1.22e-01  3.31e-03  9.12e-03  3.11e-03 -1.65e-02]
 [-6.70e-02 -1.90e-03 -2.01e-03  6.31e-03 -3.26e-03]]
[[ 0.   -0.02  0.11 -0.03  0.01]
 [ 0.01 -0.03 -0.52  0.03 -0.01]
 [-0.02  0.03 -0.38 -0.05  0.02]
 [ 0.03 -0.1   1.15 -0.04  0.01]
 [-0.01  0.05 -0.28  0.04 -0.01]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00  9.71e-04]
 [ 0.00e+00  0.00e+00  0.00e+00  1.73e-03 -2.20e-03]
 [ 0.00e+00  0.00e+00  3.31e-03 -5.66e-04 -7.06e-04]
 [ 0.00e+00  9.78e-04  8.34e-05 -2.23e-03  3.78e-03]
 [ 9.80e-03 -3.50e-03 -2.85e-03  1.65e-03 -1.09e-03]]
[[-4.66e-03  1.38e-02 -9.16e-04  2.58e-03 -1.03e-03]
 [ 1.40e-02 -3.42e-02 -2.69e-02  7.24e-03  7.22e-04]
 [-9.25e-02  1.34e+00 -2.40e+00  1.29e+00 -7.76e-02]
 [-5.33e-05  1.56e-02 -8.95e-02  4.09e-02 -6.21e-03]
 [ 8.26e-04 -5.82e-03  2.38e-02 -1.07e-02  1.77e-03]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  1.77e-04]
 [ 0.00e+00  1.00e+00  0.00e+00 -2.30e-03 -4.73e-03]
 [ 0.00e+00  0.00e+00 -5.48e-04  4.53e-03  5.93e-04]
 [ 0.00e+00 -2.53e-03 -1.57e-05  4.17e-03  9.86e-04]
 [-4.55e-04  7.21e-03  2.68e-03 -8.33e-03 -5.37e-03]]
[[ 0.01 -0.04 -0.05  0.1  -0.02]
 [-0.05  0.39  0.19 -0.63  0.11]
 [-0.    0.07 -0.25  0.25 -0.07]
 [ 0.06 -0.48  0.14  0.31 -0.02]
 [-0.01  0.07 -0.03 -0.02 -0.  ]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  6.12e-03]
 [ 0.00e+00  0.00e+00  0.00e+00  7.39e-04 -1.62e-03]
 [ 1.00e+00  0.00e+00  4.71e-03  6.68e-04 -1.04e-03]
 [ 0.00e+00  8.88e-04  1.95e-03 -9.18e-04  2.37e-03]
 [ 3.49e-03 -4.68e-03 -3.93e-03  4.99e-04 -2.53e-03]]
[[-4.23e-03  1.24e-02 -8.92e-02  3.62e-03 -2.42e-03]
 [ 1.31e-02 -3.24e-02  1.33e+00 -1.24e-03  7.31e-03]
 [-6.52e-03 -1.24e-03 -2.43e+00 -4.13e-02 -5.22e-04]
 [ 4.95e-03 -5.99e-03  1.30e+00  1.72e-02  2.29e-03]
 [-1.16e-03  2.78e-03 -7.82e-02 -2.72e-03 -5.32e-04]]
SymNet parameters
[[-5.76e-01 -6.26e-01  1.20e+00 -3.76e-02 -9.19e-03 -1.29e-02  1.70e-01 -3.08e-03
  -4.37e-02  5.81e-04 -2.77e-03  1.56e-03]
 [-1.00e+00  9.57e-02  6.80e-02  2.00e-02  5.96e-03  8.11e-03  1.33e-01  4.83e-03
   3.59e-02  1.15e-03  2.21e-03 -1.75e-03]]
SymNet parameters
[ 0.77 -0.58]
SymNet parameters
[[ 1.13e+00  8.80e-01 -2.64e+00  2.56e-01 -2.25e-01  8.76e-02 -3.87e-01 -3.62e-02
   1.17e-02 -5.21e-03 -1.81e-04 -3.60e-02 -4.50e-02]
 [-1.80e-02  3.87e-01  3.06e-01  2.81e-01  4.56e-02  8.43e-02  2.12e+00  1.16e-01
  -1.73e-01  5.38e-03  1.63e-02 -3.69e-02 -8.67e-02]]
SymNet parameters
[0.03 0.17]
SymNet parameters
[[-1.13e+00 -8.10e-01  2.37e+00 -4.32e-02  1.07e-01 -6.34e-02 -7.13e-01 -2.94e-02
   7.31e-02  2.87e-03  2.27e-02  2.22e-02  4.02e-02 -1.49e-03]
 [-5.23e-01  2.36e+00  1.41e+00  1.34e+00  3.00e-01  4.97e-01 -8.34e-01 -1.46e-01
   2.00e-01  2.88e-02  7.77e-02 -1.37e-01 -6.39e-01 -3.16e-02]]
SymNet parameters
[-0.02 -0.05]
SymNet parameters
[[ 1.76e-01 -3.48e-01 -8.43e-01 -1.78e-02 -6.16e-03 -8.01e-03  1.07e-01 -8.30e-03
  -3.65e-02 -1.27e-03 -2.27e-03  1.91e-03  5.09e-02 -5.23e-03 -3.07e-03]
 [ 1.74e+00  7.16e-02  9.75e-02  1.97e-02  4.95e-03  6.86e-03  4.37e-01  2.50e-04
   1.85e-02 -1.35e-03  9.86e-04 -1.08e-03 -6.69e-02 -4.75e-03  1.66e-04]]
SymNet parameters
[-0.45  0.45]
SymNet parameters
[[-1.09e+00  1.13e-01 -7.14e-01  5.08e-04  1.05e-03  5.39e-04 -5.87e-02  3.90e-03
   1.54e-02  1.72e-03 -7.20e-05  7.12e-05  1.14e-01  1.06e-02  4.98e-04  3.20e-02]
 [-5.44e-01 -7.24e-01 -6.13e-01 -1.35e-01 -3.70e-02 -5.24e-02  1.21e+00 -3.74e-02
  -2.16e-01 -2.72e-03 -1.16e-02  9.14e-03  1.44e-01  4.02e-03 -2.22e-03 -1.89e-02]]
SymNet parameters
[ 0.02 -0.  ]
SymNet parameters
[[ 3.96e-01  6.58e-01 -1.64e-01  1.04e-01  1.45e-02  7.25e-02  2.09e-01  1.58e-02
   7.92e-02  6.64e-05  4.11e-03 -2.90e-03 -1.06e+00  3.89e-04  2.14e-03  1.16e+00
   3.97e-01]]
SymNet parameters
[-0.22]
SymNet parameters
[[-0.12 -0.22  0.06 -0.01  0.02 -0.01 -1.45  0.05 -0.03  0.03 -0.    0.03]
 [ 0.41  0.19  0.12 -0.03 -0.01 -0.02 -1.65 -1.8  -0.49 -0.05 -0.34 -0.03]]
SymNet parameters
[ 0.11 -0.16]
SymNet parameters
[[ 1.04e+00 -3.41e-02 -4.44e-02  4.33e-03  4.37e-03 -3.20e-04 -1.56e-01  1.85e-01
  -1.38e+00  1.42e-02  3.24e-02  1.71e-01  2.01e-02]
 [ 6.43e-01  1.25e-02  5.68e-02 -3.71e-03  2.74e-03  1.09e-03 -1.73e+00  2.41e-01
   2.10e-01  1.55e-03 -2.46e-03 -2.07e-02 -1.44e-02]]
SymNet parameters
[0.58 0.54]
SymNet parameters
[[ 0.07 -0.24  1.19 -0.11  0.09 -0.01  1.79  0.41  1.24  0.16  0.15  1.27  0.08 -0.59]
 [-0.36 -0.12  0.08 -0.01 -0.02 -0.01 -0.88 -0.3  -1.98 -0.01 -0.05 -0.24  0.05 -0.02]]
SymNet parameters
[ 0.16 -0.13]
SymNet parameters
[[ 1.40e+00 -6.61e-03  5.00e-04 -1.12e-03 -6.39e-04 -1.28e-04  1.17e-01 -2.74e-02
   1.97e-01 -1.63e-03 -4.03e-03 -2.65e-02 -2.53e-03 -4.02e-03  1.48e-04]
 [ 4.92e-01 -1.43e-02  2.15e-02  1.65e-04  6.38e-03 -5.86e-04 -1.63e+00 -1.61e+00
  -6.06e-01  1.30e-02  2.31e-02  1.15e-01  3.97e-02  1.12e-03 -8.14e-04]]
SymNet parameters
[0.01 0.52]
SymNet parameters
[[-1.81e-01 -1.71e-01 -2.84e-01  2.30e-02  1.39e-02 -6.71e-03 -1.45e+00  3.23e-01
  -1.30e+00  5.50e-02  1.31e-01  8.17e-01  1.23e-01 -1.02e-03 -8.94e-03 -1.16e-01]
 [ 3.47e-01 -4.39e-02 -1.32e-01  5.20e-03 -1.39e-02 -4.25e-03  2.36e+00 -4.32e-02
  -6.56e-01 -1.00e-02 -5.98e-03 -3.66e-02  1.69e-02 -2.05e-02 -2.61e-03 -1.08e-03]]
SymNet parameters
[ 0.08 -0.3 ]
SymNet parameters
[[ 9.84e-02  3.37e-03  3.79e-03  2.59e-04  6.13e-04 -2.41e-04 -3.79e-01  9.45e-02
  -2.52e-01  5.52e-02  3.22e-03  6.69e-02 -9.26e-03 -3.84e-01  6.87e-03  3.64e-01
  -6.06e-02]]
SymNet parameters
[0.12]
finally, finish this stage
iter:  1426    time: 3.58
Func: 2.39e-02  |g|: 8.12e-03
stableloss: 7.72e-03   dataloss: 1.73e-02   sparseloss: 8.86e+01 momentloss: 6.61e+00
current expression:
[u00*u01, u10*v00, u20, u02, u00*u01**2, u01*u10*v00, u00*u11*v00, u00*u10*v01, u00, u10*v00*v10, v01, u00*u10, u00**2*u01, v00, u00**2*u10, u00*u01*v00, u00**2, u10, u00**2*v01, u10*v01]
[-0.97 -0.97  0.05  0.05  0.01  0.01  0.01  0.01  0.01  0.01  0.01 -0.01  0.01  0.
  0.    0.    0.   -0.   -0.    0.  ]
[u00*v01, v00*v10, v02, v20, v00*v10**2, v00, u00*v01*v10, u00*v00*v11, u00*u01*v01, u10, v10**2, v01*v10, v00**3, v00*v01, v00**2*v01, u01*v01, 1, u00*v10, u01, u10*v00*v01]
[-0.97 -0.96  0.05  0.05  0.02  0.01  0.01  0.01  0.01 -0.01 -0.    0.   -0.    0.
 -0.    0.    0.    0.    0.    0.  ]
block:  2
name:  burgers-2-upwind-sparse0-noise0.001-id14
device:  cuda:2
generate a random number to check random seed:  0.4804168931471156
current stage is: block-2
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.7960, device='cuda:2', dtype=torch.float64)
u_obs variance
tensor([ 0.2570,  1.7743,  1.6184, 22.3909, 10.2136, 17.9952,  0.2324,  1.5730,
         1.6319, 18.3777,  9.5858, 20.9590], device='cuda:2',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 0.088627
         Iterations: 0
         Function evaluations: 15
         Gradient evaluations: 3
convolution moment and kernels
[[ 1.00e+00  0.00e+00  2.94e-05 -4.44e-02 -6.38e-02]
 [ 0.00e+00  1.65e-05 -1.51e-03 -1.68e-03 -8.94e-03]
 [ 1.30e-04  2.56e-03  2.83e-03  8.27e-03 -9.43e-04]
 [-7.11e-03 -4.50e-04  8.06e-03  3.17e-03  1.28e-03]
 [-4.84e-02 -4.35e-03 -6.23e-04 -8.89e-03  8.50e-03]]
[[ 1.29e-02 -4.39e-02  1.09e-02 -2.71e-02  2.32e-03]
 [-5.30e-02  1.70e-01 -1.98e-02  9.53e-02 -5.56e-03]
 [ 4.70e-02 -6.94e-02  6.74e-01  1.24e-01 -6.60e-02]
 [-6.16e-02  1.94e-01 -4.70e-02  1.38e-01 -2.29e-02]
 [ 1.32e-02 -4.01e-02 -4.53e-04 -3.08e-02  6.16e-03]]
[[ 0.00e+00  1.00e+00  0.00e+00 -1.12e-01 -6.66e-02]
 [ 0.00e+00  0.00e+00 -3.29e-03 -2.84e-03 -1.01e-02]
 [ 0.00e+00  1.77e-02  6.66e-03  7.00e-03 -7.21e-03]
 [-3.83e-03  6.22e-04  7.73e-03  1.19e-04  7.43e-04]
 [ 8.20e-03 -1.73e-03 -7.33e-03 -1.02e-02 -5.42e-03]]
[[ 2.24e-04 -6.53e-04  3.98e-03  1.68e-02 -1.03e-02]
 [-7.99e-03  1.75e-02 -3.97e-02 -4.54e-02  3.90e-02]
 [ 9.79e-02 -5.77e-01 -2.86e-01  1.06e+00 -2.50e-01]
 [-1.93e-02  4.74e-02 -7.18e-02 -9.14e-03  2.39e-02]
 [ 1.71e-03  8.90e-04 -6.04e-03  1.80e-02 -8.31e-03]]
[[ 0.00e+00  0.00e+00  0.00e+00 -4.11e-03  1.41e-02]
 [ 1.00e+00  0.00e+00  2.57e-02 -2.25e-03 -8.39e-03]
 [ 0.00e+00 -3.40e-04  3.20e-04  1.45e-03 -1.38e-03]
 [-1.22e-01  3.31e-03  9.12e-03  3.11e-03 -1.65e-02]
 [-6.70e-02 -1.89e-03 -1.99e-03  6.30e-03 -3.30e-03]]
[[ 0.   -0.02  0.11 -0.03  0.01]
 [ 0.01 -0.03 -0.52  0.02 -0.01]
 [-0.02  0.03 -0.38 -0.04  0.01]
 [ 0.04 -0.1   1.15 -0.04  0.01]
 [-0.01  0.05 -0.28  0.04 -0.01]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00  9.80e-04]
 [ 0.00e+00  0.00e+00  0.00e+00  1.73e-03 -2.20e-03]
 [ 0.00e+00  0.00e+00  3.31e-03 -5.69e-04 -7.20e-04]
 [ 0.00e+00  9.78e-04  8.29e-05 -2.23e-03  3.78e-03]
 [ 9.80e-03 -3.50e-03 -2.86e-03  1.66e-03 -1.07e-03]]
[[-4.63e-03  1.37e-02 -7.27e-04  2.45e-03 -9.98e-04]
 [ 1.39e-02 -3.37e-02 -2.78e-02  7.81e-03  5.86e-04]
 [-9.23e-02  1.34e+00 -2.40e+00  1.29e+00 -7.74e-02]
 [-1.76e-04  1.61e-02 -9.03e-02  4.15e-02 -6.35e-03]
 [ 8.53e-04 -5.95e-03  2.39e-02 -1.08e-02  1.80e-03]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  1.74e-04]
 [ 0.00e+00  1.00e+00  0.00e+00 -2.30e-03 -4.72e-03]
 [ 0.00e+00  0.00e+00 -5.51e-04  4.53e-03  5.98e-04]
 [ 0.00e+00 -2.53e-03 -1.54e-05  4.17e-03  9.83e-04]
 [-4.58e-04  7.21e-03  2.68e-03 -8.33e-03 -5.39e-03]]
[[ 0.01 -0.04 -0.05  0.1  -0.02]
 [-0.05  0.39  0.19 -0.63  0.11]
 [-0.    0.07 -0.25  0.25 -0.07]
 [ 0.06 -0.48  0.14  0.31 -0.02]
 [-0.01  0.07 -0.03 -0.02 -0.  ]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  6.12e-03]
 [ 0.00e+00  0.00e+00  0.00e+00  7.38e-04 -1.62e-03]
 [ 1.00e+00  0.00e+00  4.71e-03  6.70e-04 -1.03e-03]
 [ 0.00e+00  8.88e-04  1.95e-03 -9.17e-04  2.36e-03]
 [ 3.49e-03 -4.67e-03 -3.93e-03  4.96e-04 -2.55e-03]]
[[-4.25e-03  1.24e-02 -8.93e-02  3.69e-03 -2.43e-03]
 [ 1.32e-02 -3.27e-02  1.33e+00 -1.59e-03  7.39e-03]
 [-6.64e-03 -7.12e-04 -2.43e+00 -4.07e-02 -6.66e-04]
 [ 5.04e-03 -6.37e-03  1.30e+00  1.67e-02  2.39e-03]
 [-1.18e-03  2.87e-03 -7.84e-02 -2.61e-03 -5.56e-04]]
SymNet parameters
[[-5.76e-01 -6.26e-01  1.20e+00 -3.76e-02 -9.17e-03 -1.29e-02  1.70e-01 -3.07e-03
  -4.37e-02  6.39e-04 -2.76e-03  1.55e-03]
 [-1.00e+00  9.57e-02  6.80e-02  2.00e-02  6.01e-03  8.10e-03  1.33e-01  4.85e-03
   3.59e-02  1.11e-03  2.19e-03 -1.79e-03]]
SymNet parameters
[ 0.77 -0.58]
SymNet parameters
[[ 1.13e+00  8.80e-01 -2.64e+00  2.56e-01 -2.25e-01  8.76e-02 -3.87e-01 -3.62e-02
   1.17e-02 -5.22e-03 -1.80e-04 -3.60e-02 -4.50e-02]
 [-1.80e-02  3.87e-01  3.06e-01  2.81e-01  4.56e-02  8.43e-02  2.12e+00  1.16e-01
  -1.73e-01  5.39e-03  1.63e-02 -3.69e-02 -8.67e-02]]
SymNet parameters
[0.03 0.17]
SymNet parameters
[[-1.13e+00 -8.10e-01  2.37e+00 -4.33e-02  1.07e-01 -6.34e-02 -7.13e-01 -2.94e-02
   7.31e-02  2.86e-03  2.27e-02  2.22e-02  4.02e-02 -1.50e-03]
 [-5.24e-01  2.36e+00  1.41e+00  1.34e+00  3.00e-01  4.97e-01 -8.34e-01 -1.46e-01
   2.00e-01  2.88e-02  7.77e-02 -1.37e-01 -6.39e-01 -3.16e-02]]
SymNet parameters
[-0.02 -0.05]
SymNet parameters
[[ 1.76e-01 -3.48e-01 -8.43e-01 -1.80e-02 -6.16e-03 -8.08e-03  1.07e-01 -8.31e-03
  -3.65e-02 -1.20e-03 -2.27e-03  1.83e-03  5.07e-02 -5.30e-03 -8.87e-04]
 [ 1.74e+00  7.16e-02  9.75e-02  1.98e-02  5.03e-03  6.95e-03  4.37e-01  2.67e-04
   1.85e-02 -1.33e-03  1.02e-03 -1.07e-03 -6.69e-02 -4.41e-03 -1.71e-03]]
SymNet parameters
[-0.45  0.45]
SymNet parameters
[[-1.09e+00  1.13e-01 -7.14e-01  5.94e-04  1.08e-03  6.07e-04 -5.87e-02  3.91e-03
   1.54e-02  1.72e-03 -4.47e-05  7.82e-05  1.14e-01  1.07e-02 -8.25e-04  3.21e-02]
 [-5.44e-01 -7.24e-01 -6.13e-01 -1.35e-01 -3.70e-02 -5.24e-02  1.21e+00 -3.74e-02
  -2.16e-01 -2.74e-03 -1.16e-02  9.15e-03  1.44e-01  4.07e-03 -2.74e-03 -1.89e-02]]
SymNet parameters
[ 0.02 -0.  ]
SymNet parameters
[[ 3.96e-01  6.58e-01 -1.64e-01  1.04e-01  1.46e-02  7.25e-02  2.09e-01  1.58e-02
   7.92e-02  8.57e-05  4.13e-03 -2.90e-03 -1.06e+00  4.93e-04  1.81e-03  1.16e+00
   3.97e-01]]
SymNet parameters
[-0.22]
SymNet parameters
[[-0.12 -0.22  0.06 -0.01  0.02 -0.01 -1.45  0.05 -0.03  0.03 -0.    0.03]
 [ 0.41  0.19  0.12 -0.03 -0.01 -0.02 -1.65 -1.8  -0.49 -0.05 -0.34 -0.03]]
SymNet parameters
[ 0.11 -0.16]
SymNet parameters
[[ 1.04e+00 -3.41e-02 -4.44e-02  4.33e-03  4.36e-03 -3.31e-04 -1.56e-01  1.85e-01
  -1.38e+00  1.42e-02  3.24e-02  1.71e-01  2.00e-02]
 [ 6.43e-01  1.25e-02  5.68e-02 -3.68e-03  2.76e-03  1.09e-03 -1.73e+00  2.41e-01
   2.10e-01  1.56e-03 -2.47e-03 -2.07e-02 -1.43e-02]]
SymNet parameters
[0.58 0.54]
SymNet parameters
[[ 0.07 -0.24  1.19 -0.11  0.09 -0.01  1.79  0.41  1.24  0.16  0.15  1.27  0.08 -0.59]
 [-0.36 -0.12  0.08 -0.01 -0.02 -0.01 -0.88 -0.3  -1.98 -0.01 -0.05 -0.24  0.05 -0.02]]
SymNet parameters
[ 0.16 -0.13]
SymNet parameters
[[ 1.40e+00 -6.61e-03  4.95e-04 -1.13e-03 -6.32e-04 -1.19e-04  1.17e-01 -2.74e-02
   1.97e-01 -1.64e-03 -4.02e-03 -2.65e-02 -2.53e-03 -4.05e-03  4.83e-04]
 [ 4.92e-01 -1.43e-02  2.15e-02  1.30e-04  6.39e-03 -5.98e-04 -1.63e+00 -1.61e+00
  -6.06e-01  1.30e-02  2.31e-02  1.15e-01  3.97e-02  1.11e-03 -5.78e-04]]
SymNet parameters
[0.01 0.52]
SymNet parameters
[[-1.81e-01 -1.71e-01 -2.84e-01  2.30e-02  1.39e-02 -6.72e-03 -1.45e+00  3.23e-01
  -1.30e+00  5.50e-02  1.31e-01  8.17e-01  1.23e-01 -1.03e-03 -8.92e-03 -1.16e-01]
 [ 3.47e-01 -4.39e-02 -1.32e-01  5.21e-03 -1.39e-02 -4.25e-03  2.36e+00 -4.32e-02
  -6.56e-01 -1.00e-02 -5.99e-03 -3.66e-02  1.69e-02 -2.05e-02 -2.40e-03 -1.08e-03]]
SymNet parameters
[ 0.08 -0.3 ]
SymNet parameters
[[ 9.84e-02  3.37e-03  3.78e-03  2.49e-04  6.03e-04 -2.36e-04 -3.79e-01  9.45e-02
  -2.52e-01  5.53e-02  3.23e-03  6.69e-02 -9.29e-03 -3.84e-01  6.80e-03  3.64e-01
  -6.04e-02]]
SymNet parameters
[0.12]
finally, finish this stage
iter:     0    time: 1119.45
Func: 8.86e-02  |g|: 1.22e+01
stableloss: 1.97e-02   dataloss: 7.54e-02   sparseloss: 8.86e+01 momentloss: 6.61e+00
current expression:
[u00*u01, u10*v00, u20, u02, u00*u01**2, u01*u10*v00, u00*u11*v00, u00*u10*v01, u00, u10*v00*v10, v01, u00*u10, u00**2*u01, v00, u00**2*u10, u00*u01*v00, u00**2, u10, u00**2*v01, u10*v01]
[-0.97 -0.97  0.05  0.05  0.01  0.01  0.01  0.01  0.01  0.01  0.01 -0.01  0.01  0.
  0.    0.    0.   -0.   -0.    0.  ]
[u00*v01, v00*v10, v02, v20, v00*v10**2, v00, u00*v01*v10, u00*v00*v11, u00*u01*v01, u10, v10**2, v01*v10, v00**3, v00*v01, v00**2*v01, u01*v01, 1, u00*v10, u01, u10*v00*v01]
[-0.97 -0.96  0.05  0.05  0.02  0.01  0.01  0.01  0.01 -0.01 -0.    0.   -0.    0.
 -0.    0.    0.    0.    0.    0.  ]
block:  3
name:  burgers-2-upwind-sparse0-noise0.001-id14
device:  cuda:2
generate a random number to check random seed:  -0.48933472906873776
current stage is: block-3
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.9385, device='cuda:2', dtype=torch.float64)
u_obs variance
tensor([ 0.2768,  1.9199,  1.7434, 25.1532, 10.5574, 19.6831,  0.2486,  1.6582,
         1.8919, 19.3649, 10.8067, 24.9370], device='cuda:2',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
iter:     0    time: 72.60
Func: 2.07e-01  |g|: 2.05e+01
stableloss: 2.80e-02   dataloss: 1.87e-01   sparseloss: 8.86e+01 momentloss: 6.61e+00
iter:   200    time: 18.45
Func: 1.53e-01  |g|: 2.75e-01
stableloss: 2.81e-02   dataloss: 1.31e-01   sparseloss: 8.85e+01 momentloss: 7.40e+00
iter:   400    time: 18.54
Func: 1.50e-01  |g|: 2.34e-01
stableloss: 2.76e-02   dataloss: 1.28e-01   sparseloss: 9.37e+01 momentloss: 7.25e+00
iter:   600    time: 18.46
Func: 1.48e-01  |g|: 2.43e-01
stableloss: 2.76e-02   dataloss: 1.26e-01   sparseloss: 1.01e+02 momentloss: 7.25e+00
iter:   800    time: 18.42
Func: 1.47e-01  |g|: 1.17e-01
stableloss: 2.73e-02   dataloss: 1.25e-01   sparseloss: 1.08e+02 momentloss: 7.28e+00
iter:  1000    time: 18.56
Func: 1.47e-01  |g|: 3.74e-01
stableloss: 2.74e-02   dataloss: 1.25e-01   sparseloss: 1.21e+02 momentloss: 7.32e+00
iter:  1200    time: 18.54
Func: 1.46e-01  |g|: 2.14e-01
stableloss: 2.76e-02   dataloss: 1.24e-01   sparseloss: 1.39e+02 momentloss: 7.32e+00
iter:  1400    time: 18.51
Func: 1.46e-01  |g|: 7.07e-01
stableloss: 2.76e-02   dataloss: 1.24e-01   sparseloss: 1.54e+02 momentloss: 7.33e+00
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 0.146177
         Iterations: 1572
         Function evaluations: 1644
         Gradient evaluations: 1629
convolution moment and kernels
[[ 1.00e+00  0.00e+00  1.42e-03 -2.92e-02 -8.97e-02]
 [ 0.00e+00 -8.26e-04 -1.90e-02 -2.07e-03 -7.13e-02]
 [ 5.96e-04  4.53e-03  3.16e-02  2.14e-03 -4.53e-03]
 [ 6.69e-03 -5.82e-03  5.26e-03  7.05e-03 -6.09e-02]
 [-1.17e-01 -3.59e-02 -2.44e-02 -2.60e-02 -4.40e-03]]
[[ 0.04 -0.13  0.08 -0.12  0.01]
 [-0.06  0.24  0.07  0.2   0.03]
 [-0.01  0.08  0.23  0.16 -0.16]
 [-0.02  0.06  0.31  0.07  0.05]
 [-0.02  0.09 -0.23  0.08 -0.03]]
[[ 0.00e+00  1.00e+00  0.00e+00 -8.38e-02 -7.16e-02]
 [ 0.00e+00  0.00e+00  1.92e-03  2.54e-03 -4.38e-03]
 [ 0.00e+00  3.46e-02 -5.36e-03  5.76e-02 -1.33e-02]
 [-5.80e-03 -2.03e-03  8.82e-04 -4.89e-03 -8.60e-03]
 [ 1.31e-02 -9.38e-03  5.24e-03  5.43e-03 -4.96e-04]]
[[ 1.51e-03 -1.76e-04  2.97e-02 -2.18e-02  6.67e-03]
 [-3.64e-02  4.16e-02 -1.15e-01  5.35e-02 -1.58e-03]
 [ 1.24e-01 -5.41e-01 -2.82e-01  9.92e-01 -2.14e-01]
 [-3.14e-02  7.67e-03 -3.75e-02 -1.27e-03  1.59e-02]
 [-3.91e-03  2.81e-02 -2.47e-02  1.44e-02 -3.73e-03]]
[[ 0.00e+00  0.00e+00  0.00e+00  1.17e-02  1.90e-02]
 [ 1.00e+00  0.00e+00  2.54e-02  7.84e-03 -2.55e-02]
 [ 0.00e+00 -8.84e-04 -6.71e-03 -9.94e-03 -3.41e-03]
 [-9.73e-02  5.21e-03  4.39e-02  4.18e-03 -7.27e-03]
 [-8.42e-02  1.93e-03 -2.77e-02 -1.10e-02 -8.85e-03]]
[[ 0.   -0.05  0.12 -0.02 -0.01]
 [ 0.01  0.04 -0.51 -0.02  0.04]
 [ 0.   -0.13 -0.29 -0.06 -0.03]
 [-0.    0.06  1.04 -0.03  0.03]
 [-0.    0.02 -0.26  0.04 -0.01]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00 -5.80e-03]
 [ 0.00e+00  0.00e+00  0.00e+00  8.51e-04 -1.55e-03]
 [ 0.00e+00  0.00e+00  5.40e-03 -3.53e-03  4.55e-04]
 [ 0.00e+00  6.32e-05 -4.60e-04 -2.15e-03  1.65e-04]
 [ 9.01e-02  4.19e-02 -1.50e-03 -6.27e-03 -1.57e-02]]
[[-9.93e-03  2.88e-02 -1.44e-03  9.44e-02 -2.17e-02]
 [ 4.09e-02 -1.12e-01 -4.03e-03 -3.71e-01  8.65e-02]
 [-1.47e-01  1.51e+00 -2.51e+00  1.91e+00 -2.18e-01]
 [ 3.56e-02 -9.61e-02 -2.07e-02 -3.66e-01  8.67e-02]
 [-8.31e-03  2.42e-02  2.25e-03  9.44e-02 -2.24e-02]]
[[ 0.    0.    0.    0.   -0.01]
 [ 0.    1.    0.   -0.01  0.01]
 [ 0.    0.   -0.   -0.    0.  ]
 [ 0.   -0.01  0.    0.07 -0.02]
 [-0.   -0.    0.01  0.   -0.02]]
[[ 0.02 -0.06 -0.06  0.13 -0.03]
 [-0.04  0.27  0.38 -0.75  0.14]
 [-0.13  0.57 -0.86  0.53 -0.12]
 [ 0.2  -0.99  0.7   0.09  0.01]
 [-0.06  0.22 -0.19  0.03 -0.  ]]
[[ 0.    0.    0.    0.    0.01]
 [ 0.    0.    0.    0.   -0.01]
 [ 1.    0.    0.01 -0.01 -0.01]
 [ 0.    0.   -0.   -0.01  0.  ]
 [-0.01 -0.01  0.    0.04 -0.  ]]
[[-0.03  0.07 -0.13 -0.03  0.02]
 [ 0.1  -0.24  1.44  0.15 -0.08]
 [-0.13  0.26 -2.52 -0.3   0.14]
 [ 0.08 -0.16  1.35  0.19 -0.09]
 [-0.02  0.04 -0.1  -0.04  0.02]]
SymNet parameters
[[ 3.20e-03 -4.17e-04  1.15e-01  1.27e-03  1.30e-03 -9.18e-04 -1.34e-02 -3.21e-05
  -9.64e-04  2.37e-03  5.95e-04  4.17e-03]
 [-6.30e-01  2.63e-02  1.81e-02 -6.59e-04  1.45e-03 -3.02e-03  6.86e-03  3.35e-03
   3.60e-02 -6.68e-04  9.74e-04  1.34e-03]]
SymNet parameters
[ 0.61 -0.86]
SymNet parameters
[[-2.20e-01  2.53e+00 -5.27e+00  5.50e-01 -3.24e-01  2.03e-01 -9.36e-01 -2.78e-01
   3.04e-01 -5.97e-02  4.63e-02 -2.35e-01 -7.65e-01]
 [-6.19e-02 -3.16e-02  7.14e-02 -2.66e-02  5.44e-04 -7.38e-03  1.54e+00  9.81e-02
  -2.62e-03 -5.26e-03 -3.36e-03  4.71e-05 -8.62e-02]]
SymNet parameters
[-0.63  0.58]
SymNet parameters
[[ 2.71e-01 -6.00e-01 -1.01e+00  2.75e-01 -3.18e-02  5.41e-02 -6.62e+00 -4.61e-01
   1.82e-02  3.25e-03  1.22e-02 -9.83e-03  4.02e-01 -7.74e-03]
 [-7.56e-01  9.56e+00 -3.25e+00  1.79e+00 -1.04e-01  5.48e-01 -6.61e+00 -7.12e-01
   9.33e-01  9.94e-02  2.00e-01 -2.61e-01 -1.86e+00  1.69e-02]]
SymNet parameters
[ 0.11 -0.32]
SymNet parameters
[[-5.27e-01 -1.57e-01 -9.54e-02  1.53e-03 -1.04e-03  1.72e-03  1.13e+00  1.56e-03
  -2.09e-03 -9.87e-05  1.67e-04 -2.66e-03  1.43e-01 -5.44e-03 -3.52e-04]
 [ 1.65e+00  1.54e-01 -1.30e-01  8.70e-05  6.62e-04 -2.41e-03  1.68e+00  2.82e-03
  -6.02e-03 -7.23e-04 -6.86e-04 -9.03e-04  1.69e-01  3.44e-03  2.22e-04]]
SymNet parameters
[0.37 0.86]
SymNet parameters
[[-1.31e+00  2.24e-01 -1.48e-01 -1.86e-03 -2.87e-05  3.11e-03 -1.72e+00 -2.51e-03
  -1.76e-02  3.14e-03  1.92e-04  4.44e-03  8.07e-01  8.07e-03  4.84e-04 -2.15e-03]
 [-2.88e+00  4.75e-01  2.39e-01 -7.44e-03  5.80e-03 -2.77e-05  5.05e+00  1.98e-02
   1.40e-02 -1.65e-03 -5.04e-05 -9.00e-03 -8.30e-01  1.03e-02  7.89e-04 -1.19e-02]]
SymNet parameters
[-0.33  0.99]
SymNet parameters
[[-2.99e-01  1.40e-01  2.36e-01  4.62e-02 -2.90e-06  5.04e-02  5.26e-03  2.73e-03
   2.51e-02 -2.59e-03 -5.04e-04 -2.74e-03 -1.06e+00 -6.93e-03 -2.31e-04  1.48e+00
   3.28e-01]]
SymNet parameters
[-0.55]
SymNet parameters
[[-5.41e-03 -6.52e-02 -1.85e-02  1.20e-03  8.15e-04  3.43e-04 -3.63e-01 -8.88e-04
  -1.52e-02  8.62e-04 -1.17e-03 -1.78e-03]
 [ 3.54e-02  1.04e-01 -3.95e-02 -4.36e-02 -4.86e-02 -1.26e-02 -9.51e-01 -3.40e+00
   1.09e-01  3.97e-02 -6.09e-01 -1.10e-01]]
SymNet parameters
[2.38 0.13]
SymNet parameters
[[ 4.40e-01 -1.31e-02  7.61e-01 -5.85e-03  4.53e-02  2.74e-03  1.47e+00  1.38e-01
  -3.68e+00  7.55e-02 -2.89e-02  6.59e-01 -2.04e-03]
 [ 1.13e-01 -3.74e-03  6.22e-02  8.41e-04 -1.18e-03  2.62e-03 -1.10e+00 -4.54e-02
  -2.67e-02  8.94e-03 -1.67e-03 -3.96e-02 -1.93e-03]]
SymNet parameters
[-1.91  3.6 ]
SymNet parameters
[[-5.03 -0.21  3.16  0.03  0.09  0.07 10.73 -1.32 -2.72  0.34 -0.03  0.4  -0.03 -0.13]
 [-0.38 -0.16  1.07  0.05  0.11  0.01 -0.82 -3.71 -2.07  0.08  0.59  1.21  0.43  0.03]]
SymNet parameters
[0.01 3.11]
SymNet parameters
[[ 9.26e-01  1.94e-02 -2.25e-01 -3.27e-03 -5.11e-03 -5.72e-03 -4.42e-01  8.17e-02
   1.30e-01 -2.47e-02  6.27e-04 -1.07e-02  1.32e-03  7.88e-03  1.03e-05]
 [-1.16e-01 -9.13e-02  4.26e-01  3.04e-02  5.32e-02  1.02e-02 -4.30e-01 -3.09e+00
  -1.00e+00  1.69e-02  3.80e-01  4.33e-01  2.72e-01  1.52e-02 -8.05e-04]]
SymNet parameters
[0.27 2.29]
SymNet parameters
[[-4.68e-01 -1.36e-01  1.40e+00  3.06e-02  1.43e-01  2.53e-03  6.00e-01 -2.25e+00
  -9.88e-01  1.15e-01  4.95e-01  1.84e+00  3.49e-01  3.31e-02 -1.81e-03 -8.10e-02]
 [-3.15e-01 -2.96e-02  5.51e-01  2.94e-03  2.00e-02  1.04e-02  3.46e+00 -2.66e-01
  -8.72e-01  5.61e-02 -7.44e-03  1.47e-01 -4.05e-03 -3.27e-02  1.08e-04  1.99e-03]]
SymNet parameters
[ 0.28 -0.08]
SymNet parameters
[[-1.03e-01 -3.23e-03  3.91e-01 -4.77e-03  2.67e-02  3.09e-04  1.09e+00  7.62e-01
  -2.38e+00  8.90e-02 -1.47e-02  4.68e-01  2.19e-03 -1.97e-01  3.05e-02  4.00e-01
  -7.50e-02]]
SymNet parameters
[-1.63]
finally, finish this stage
iter:  1572    time: 20.69
Func: 1.46e-01  |g|: 3.60e-01
stableloss: 2.76e-02   dataloss: 1.24e-01   sparseloss: 1.75e+02 momentloss: 7.32e+00
current expression:
[u00*u01, u10*v00, u20, u02, u00, u00*u01**2, u00*u10*v01, u00*u11*v00, u10*v00*v10, u01*u10*v00, u00**3, u00**2*v00, u01*v00**2, u00*u10*v00, u01**2, u00*u10, u01, u01*v00, v00, u00**2*u10]
[-0.99 -0.98  0.05  0.05  0.02  0.01  0.01  0.01  0.01  0.01 -0.01 -0.    0.   -0.
  0.   -0.   -0.   -0.    0.   -0.  ]
[u00*v01, v00*v10, v02, v20, v00, v00*v10**2, u00*v01*v10, u00*u01*v01, u00*v00*v11, u10*v00*v01, v00**3, v00**2*v01, v01, u00*v00*v10, v00**2*v10, u00*v00**2*v01, v01*v10, u10, u00, u00*v00]
[-0.99 -0.98  0.05  0.05  0.02  0.01  0.01  0.01  0.01  0.01 -0.01  0.01 -0.   -0.
  0.    0.    0.   -0.   -0.   -0.  ]
block:  4
name:  burgers-2-upwind-sparse0-noise0.001-id14
device:  cuda:2
generate a random number to check random seed:  0.19262354344611077
current stage is: block-4
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.8858, device='cuda:2', dtype=torch.float64)
u_obs variance
tensor([ 0.2458,  1.5690,  1.6493, 20.4186,  9.7818, 19.2425,  0.2635,  1.6838,
         1.7941, 19.3832, 11.2718, 24.0224], device='cuda:2',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 0.257411
         Iterations: 0
         Function evaluations: 15
         Gradient evaluations: 3
convolution moment and kernels
[[ 1.00e+00  0.00e+00  1.43e-03 -2.92e-02 -8.97e-02]
 [ 0.00e+00 -8.29e-04 -1.90e-02 -2.07e-03 -7.13e-02]
 [ 6.02e-04  4.53e-03  3.16e-02  2.14e-03 -4.53e-03]
 [ 6.69e-03 -5.83e-03  5.26e-03  7.05e-03 -6.09e-02]
 [-1.17e-01 -3.59e-02 -2.44e-02 -2.60e-02 -4.40e-03]]
[[ 0.04 -0.13  0.08 -0.12  0.01]
 [-0.06  0.24  0.07  0.2   0.03]
 [-0.01  0.08  0.23  0.16 -0.16]
 [-0.02  0.06  0.31  0.07  0.05]
 [-0.02  0.09 -0.23  0.08 -0.03]]
[[ 0.00e+00  1.00e+00  0.00e+00 -8.38e-02 -7.16e-02]
 [ 0.00e+00  0.00e+00  1.92e-03  2.54e-03 -4.38e-03]
 [ 0.00e+00  3.46e-02 -5.36e-03  5.76e-02 -1.33e-02]
 [-5.80e-03 -2.03e-03  8.85e-04 -4.89e-03 -8.59e-03]
 [ 1.31e-02 -9.38e-03  5.24e-03  5.43e-03 -4.96e-04]]
[[ 1.51e-03 -1.75e-04  2.97e-02 -2.18e-02  6.67e-03]
 [-3.64e-02  4.16e-02 -1.15e-01  5.35e-02 -1.59e-03]
 [ 1.24e-01 -5.41e-01 -2.82e-01  9.92e-01 -2.14e-01]
 [-3.14e-02  7.69e-03 -3.75e-02 -1.25e-03  1.59e-02]
 [-3.91e-03  2.81e-02 -2.47e-02  1.44e-02 -3.73e-03]]
[[ 0.00e+00  0.00e+00  0.00e+00  1.17e-02  1.90e-02]
 [ 1.00e+00  0.00e+00  2.54e-02  7.84e-03 -2.55e-02]
 [ 0.00e+00 -8.83e-04 -6.71e-03 -9.94e-03 -3.41e-03]
 [-9.73e-02  5.21e-03  4.39e-02  4.18e-03 -7.27e-03]
 [-8.42e-02  1.93e-03 -2.77e-02 -1.10e-02 -8.85e-03]]
[[ 0.   -0.05  0.12 -0.02 -0.01]
 [ 0.01  0.04 -0.51 -0.02  0.04]
 [ 0.   -0.13 -0.29 -0.06 -0.03]
 [-0.    0.06  1.04 -0.03  0.03]
 [-0.    0.02 -0.26  0.04 -0.01]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00 -5.81e-03]
 [ 0.00e+00  0.00e+00  0.00e+00  8.45e-04 -1.55e-03]
 [ 0.00e+00  0.00e+00  5.40e-03 -3.53e-03  4.51e-04]
 [ 0.00e+00  6.47e-05 -4.63e-04 -2.15e-03  1.65e-04]
 [ 9.01e-02  4.19e-02 -1.49e-03 -6.27e-03 -1.57e-02]]
[[-9.93e-03  2.89e-02 -1.45e-03  9.44e-02 -2.17e-02]
 [ 4.09e-02 -1.12e-01 -4.02e-03 -3.71e-01  8.65e-02]
 [-1.47e-01  1.51e+00 -2.51e+00  1.91e+00 -2.18e-01]
 [ 3.57e-02 -9.61e-02 -2.08e-02 -3.66e-01  8.67e-02]
 [-8.32e-03  2.42e-02  2.25e-03  9.44e-02 -2.24e-02]]
[[ 0.    0.    0.    0.   -0.01]
 [ 0.    1.    0.   -0.01  0.01]
 [ 0.    0.   -0.   -0.    0.  ]
 [ 0.   -0.01  0.    0.07 -0.02]
 [-0.   -0.    0.01  0.   -0.02]]
[[ 0.02 -0.06 -0.06  0.13 -0.03]
 [-0.04  0.27  0.38 -0.75  0.14]
 [-0.13  0.57 -0.86  0.52 -0.12]
 [ 0.2  -0.99  0.7   0.09  0.01]
 [-0.06  0.22 -0.19  0.03 -0.  ]]
[[ 0.    0.    0.    0.    0.01]
 [ 0.    0.    0.    0.   -0.01]
 [ 1.    0.    0.01 -0.01 -0.01]
 [ 0.    0.   -0.   -0.01  0.  ]
 [-0.01 -0.01  0.    0.04 -0.  ]]
[[-0.03  0.07 -0.13 -0.03  0.02]
 [ 0.1  -0.24  1.44  0.15 -0.08]
 [-0.13  0.26 -2.52 -0.3   0.14]
 [ 0.08 -0.16  1.35  0.19 -0.09]
 [-0.02  0.04 -0.1  -0.04  0.02]]
SymNet parameters
[[ 3.21e-03 -4.21e-04  1.15e-01  1.27e-03  1.31e-03 -9.08e-04 -1.34e-02 -3.22e-05
  -9.68e-04  2.37e-03  5.91e-04  4.17e-03]
 [-6.30e-01  2.63e-02  1.81e-02 -6.58e-04  1.45e-03 -3.02e-03  6.85e-03  3.35e-03
   3.60e-02 -6.68e-04  9.75e-04  1.33e-03]]
SymNet parameters
[ 0.61 -0.86]
SymNet parameters
[[-2.20e-01  2.53e+00 -5.27e+00  5.50e-01 -3.24e-01  2.03e-01 -9.36e-01 -2.78e-01
   3.04e-01 -5.97e-02  4.63e-02 -2.35e-01 -7.65e-01]
 [-6.19e-02 -3.16e-02  7.14e-02 -2.66e-02  5.45e-04 -7.39e-03  1.54e+00  9.81e-02
  -2.63e-03 -5.26e-03 -3.35e-03  4.68e-05 -8.62e-02]]
SymNet parameters
[-0.63  0.58]
SymNet parameters
[[ 2.71e-01 -6.00e-01 -1.01e+00  2.75e-01 -3.19e-02  5.41e-02 -6.62e+00 -4.61e-01
   1.83e-02  3.24e-03  1.22e-02 -9.84e-03  4.02e-01 -7.73e-03]
 [-7.56e-01  9.56e+00 -3.25e+00  1.79e+00 -1.04e-01  5.48e-01 -6.61e+00 -7.12e-01
   9.33e-01  9.95e-02  2.00e-01 -2.61e-01 -1.86e+00  1.69e-02]]
SymNet parameters
[ 0.11 -0.32]
SymNet parameters
[[-5.27e-01 -1.57e-01 -9.54e-02  1.54e-03 -1.04e-03  1.72e-03  1.13e+00  1.56e-03
  -2.09e-03 -1.00e-04  1.66e-04 -2.67e-03  1.43e-01 -5.48e-03 -2.83e-04]
 [ 1.65e+00  1.54e-01 -1.30e-01  8.68e-05  6.62e-04 -2.42e-03  1.68e+00  2.82e-03
  -6.02e-03 -7.23e-04 -6.83e-04 -9.06e-04  1.68e-01  3.41e-03  4.28e-04]]
SymNet parameters
[0.37 0.86]
SymNet parameters
[[-1.31e+00  2.24e-01 -1.48e-01 -1.86e-03 -2.69e-05  3.11e-03 -1.72e+00 -2.50e-03
  -1.76e-02  3.14e-03  1.94e-04  4.44e-03  8.07e-01  8.05e-03  7.06e-04 -2.15e-03]
 [-2.88e+00  4.75e-01  2.39e-01 -7.44e-03  5.80e-03 -2.61e-05  5.05e+00  1.98e-02
   1.40e-02 -1.65e-03 -4.99e-05 -9.00e-03 -8.30e-01  1.03e-02  7.60e-04 -1.19e-02]]
SymNet parameters
[-0.32  0.99]
SymNet parameters
[[-2.99e-01  1.40e-01  2.36e-01  4.62e-02 -6.51e-06  5.04e-02  5.28e-03  2.73e-03
   2.51e-02 -2.59e-03 -5.04e-04 -2.75e-03 -1.06e+00 -6.93e-03 -2.28e-04  1.48e+00
   3.28e-01]]
SymNet parameters
[-0.55]
SymNet parameters
[[-5.40e-03 -6.52e-02 -1.85e-02  1.20e-03  8.16e-04  3.42e-04 -3.63e-01 -8.95e-04
  -1.52e-02  8.62e-04 -1.17e-03 -1.77e-03]
 [ 3.54e-02  1.04e-01 -3.94e-02 -4.36e-02 -4.86e-02 -1.26e-02 -9.51e-01 -3.40e+00
   1.09e-01  3.97e-02 -6.09e-01 -1.10e-01]]
SymNet parameters
[2.38 0.13]
SymNet parameters
[[ 4.41e-01 -1.31e-02  7.61e-01 -5.86e-03  4.53e-02  2.76e-03  1.47e+00  1.38e-01
  -3.68e+00  7.54e-02 -2.89e-02  6.59e-01 -2.04e-03]
 [ 1.13e-01 -3.75e-03  6.22e-02  8.39e-04 -1.19e-03  2.62e-03 -1.10e+00 -4.54e-02
  -2.67e-02  8.94e-03 -1.67e-03 -3.96e-02 -1.94e-03]]
SymNet parameters
[-1.91  3.6 ]
SymNet parameters
[[-5.03 -0.21  3.16  0.03  0.09  0.07 10.73 -1.32 -2.72  0.34 -0.03  0.4  -0.03 -0.13]
 [-0.38 -0.16  1.07  0.05  0.11  0.01 -0.82 -3.71 -2.07  0.08  0.59  1.21  0.43  0.03]]
SymNet parameters
[0.01 3.11]
SymNet parameters
[[ 9.26e-01  1.94e-02 -2.25e-01 -3.27e-03 -5.10e-03 -5.73e-03 -4.42e-01  8.17e-02
   1.30e-01 -2.47e-02  6.17e-04 -1.07e-02  1.32e-03  7.91e-03 -6.43e-04]
 [-1.16e-01 -9.13e-02  4.26e-01  3.04e-02  5.31e-02  1.02e-02 -4.30e-01 -3.09e+00
  -1.00e+00  1.69e-02  3.80e-01  4.33e-01  2.72e-01  1.52e-02 -8.19e-04]]
SymNet parameters
[0.27 2.29]
SymNet parameters
[[-4.68e-01 -1.36e-01  1.40e+00  3.06e-02  1.43e-01  2.58e-03  6.00e-01 -2.25e+00
  -9.87e-01  1.15e-01  4.95e-01  1.84e+00  3.49e-01  3.31e-02 -1.87e-03 -8.11e-02]
 [-3.15e-01 -2.96e-02  5.51e-01  2.94e-03  2.00e-02  1.04e-02  3.46e+00 -2.66e-01
  -8.72e-01  5.61e-02 -7.42e-03  1.47e-01 -4.05e-03 -3.27e-02  2.53e-04  1.99e-03]]
SymNet parameters
[ 0.28 -0.08]
SymNet parameters
[[-1.03e-01 -3.18e-03  3.91e-01 -4.77e-03  2.67e-02  3.22e-04  1.09e+00  7.62e-01
  -2.38e+00  8.90e-02 -1.46e-02  4.68e-01  2.19e-03 -1.97e-01  3.04e-02  4.00e-01
  -7.50e-02]]
SymNet parameters
[-1.63]
finally, finish this stage
iter:     0    time: 347.83
Func: 2.57e-01  |g|: 2.44e+02
stableloss: 3.15e-02   dataloss: 2.28e-01   sparseloss: 1.75e+02 momentloss: 7.32e+00
current expression:
[u00*u01, u10*v00, u20, u02, u00, u00*u01**2, u00*u10*v01, u00*u11*v00, u10*v00*v10, u01*u10*v00, u00**3, u00**2*v00, u01*v00**2, u00*u10*v00, u01**2, u00*u10, u01, u01*v00, v00, u00**2*u10]
[-0.99 -0.98  0.05  0.05  0.02  0.01  0.01  0.01  0.01  0.01 -0.01 -0.    0.   -0.
  0.   -0.   -0.   -0.    0.   -0.  ]
[u00*v01, v00*v10, v02, v20, v00, v00*v10**2, u00*v01*v10, u00*u01*v01, u00*v00*v11, u10*v00*v01, v00**3, v00**2*v01, v01, u00*v00*v10, v00**2*v10, u00*v00**2*v01, v01*v10, u10, u00, u00*v00]
[-0.99 -0.98  0.05  0.05  0.02  0.01  0.01  0.01  0.01  0.01 -0.01  0.01 -0.   -0.
  0.    0.    0.   -0.   -0.   -0.  ]
block:  5
name:  burgers-2-upwind-sparse0-noise0.001-id14
device:  cuda:2
generate a random number to check random seed:  -1.0890706526451885
current stage is: block-5
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.8676, device='cuda:2', dtype=torch.float64)
u_obs variance
tensor([ 0.2604,  1.8152,  1.7003, 23.4583, 11.2351, 19.9670,  0.2466,  1.6070,
         1.7129, 18.7423, 11.0069, 22.5804], device='cuda:2',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 0.524718
         Iterations: 0
         Function evaluations: 15
         Gradient evaluations: 3
convolution moment and kernels
[[ 1.00e+00  0.00e+00  1.43e-03 -2.92e-02 -8.97e-02]
 [ 0.00e+00 -8.29e-04 -1.90e-02 -2.07e-03 -7.13e-02]
 [ 6.02e-04  4.53e-03  3.16e-02  2.14e-03 -4.53e-03]
 [ 6.69e-03 -5.83e-03  5.26e-03  7.05e-03 -6.09e-02]
 [-1.17e-01 -3.59e-02 -2.44e-02 -2.60e-02 -4.40e-03]]
[[ 0.04 -0.13  0.08 -0.12  0.01]
 [-0.06  0.24  0.07  0.2   0.03]
 [-0.01  0.08  0.23  0.16 -0.16]
 [-0.02  0.06  0.31  0.07  0.05]
 [-0.02  0.09 -0.23  0.08 -0.03]]
[[ 0.00e+00  1.00e+00  0.00e+00 -8.38e-02 -7.16e-02]
 [ 0.00e+00  0.00e+00  1.92e-03  2.54e-03 -4.38e-03]
 [ 0.00e+00  3.46e-02 -5.36e-03  5.76e-02 -1.33e-02]
 [-5.80e-03 -2.03e-03  8.85e-04 -4.89e-03 -8.59e-03]
 [ 1.31e-02 -9.38e-03  5.24e-03  5.43e-03 -4.96e-04]]
[[ 1.51e-03 -1.75e-04  2.97e-02 -2.18e-02  6.67e-03]
 [-3.64e-02  4.16e-02 -1.15e-01  5.35e-02 -1.58e-03]
 [ 1.24e-01 -5.41e-01 -2.82e-01  9.92e-01 -2.14e-01]
 [-3.14e-02  7.68e-03 -3.75e-02 -1.26e-03  1.59e-02]
 [-3.91e-03  2.81e-02 -2.47e-02  1.44e-02 -3.73e-03]]
[[ 0.00e+00  0.00e+00  0.00e+00  1.17e-02  1.90e-02]
 [ 1.00e+00  0.00e+00  2.54e-02  7.84e-03 -2.55e-02]
 [ 0.00e+00 -8.83e-04 -6.71e-03 -9.94e-03 -3.41e-03]
 [-9.73e-02  5.21e-03  4.39e-02  4.18e-03 -7.27e-03]
 [-8.42e-02  1.93e-03 -2.77e-02 -1.10e-02 -8.85e-03]]
[[ 0.   -0.05  0.12 -0.02 -0.01]
 [ 0.01  0.04 -0.51 -0.02  0.04]
 [ 0.   -0.13 -0.29 -0.06 -0.03]
 [-0.    0.06  1.04 -0.03  0.03]
 [-0.    0.02 -0.26  0.04 -0.01]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00 -5.81e-03]
 [ 0.00e+00  0.00e+00  0.00e+00  8.45e-04 -1.55e-03]
 [ 0.00e+00  0.00e+00  5.40e-03 -3.53e-03  4.51e-04]
 [ 0.00e+00  6.47e-05 -4.63e-04 -2.15e-03  1.65e-04]
 [ 9.01e-02  4.19e-02 -1.49e-03 -6.27e-03 -1.57e-02]]
[[-9.93e-03  2.89e-02 -1.45e-03  9.44e-02 -2.17e-02]
 [ 4.09e-02 -1.12e-01 -4.02e-03 -3.71e-01  8.65e-02]
 [-1.47e-01  1.51e+00 -2.51e+00  1.91e+00 -2.18e-01]
 [ 3.57e-02 -9.61e-02 -2.07e-02 -3.66e-01  8.67e-02]
 [-8.32e-03  2.42e-02  2.25e-03  9.44e-02 -2.24e-02]]
[[ 0.    0.    0.    0.   -0.01]
 [ 0.    1.    0.   -0.01  0.01]
 [ 0.    0.   -0.   -0.    0.  ]
 [ 0.   -0.01  0.    0.07 -0.02]
 [-0.   -0.    0.01  0.   -0.02]]
[[ 0.02 -0.06 -0.06  0.13 -0.03]
 [-0.04  0.27  0.38 -0.75  0.14]
 [-0.13  0.57 -0.86  0.52 -0.12]
 [ 0.2  -0.99  0.7   0.09  0.01]
 [-0.06  0.22 -0.19  0.03 -0.  ]]
[[ 0.    0.    0.    0.    0.01]
 [ 0.    0.    0.    0.   -0.01]
 [ 1.    0.    0.01 -0.01 -0.01]
 [ 0.    0.   -0.   -0.01  0.  ]
 [-0.01 -0.01  0.    0.04 -0.  ]]
[[-0.03  0.07 -0.13 -0.03  0.02]
 [ 0.1  -0.24  1.44  0.15 -0.08]
 [-0.13  0.26 -2.52 -0.3   0.14]
 [ 0.08 -0.16  1.35  0.19 -0.09]
 [-0.02  0.04 -0.1  -0.04  0.02]]
SymNet parameters
[[ 3.21e-03 -4.21e-04  1.15e-01  1.27e-03  1.31e-03 -9.10e-04 -1.34e-02 -3.15e-05
  -9.68e-04  2.37e-03  5.93e-04  4.17e-03]
 [-6.30e-01  2.63e-02  1.81e-02 -6.59e-04  1.45e-03 -3.02e-03  6.85e-03  3.35e-03
   3.60e-02 -6.69e-04  9.74e-04  1.34e-03]]
SymNet parameters
[ 0.61 -0.86]
SymNet parameters
[[-2.20e-01  2.53e+00 -5.27e+00  5.50e-01 -3.24e-01  2.03e-01 -9.36e-01 -2.78e-01
   3.04e-01 -5.97e-02  4.63e-02 -2.35e-01 -7.65e-01]
 [-6.19e-02 -3.16e-02  7.14e-02 -2.66e-02  5.45e-04 -7.39e-03  1.54e+00  9.81e-02
  -2.63e-03 -5.26e-03 -3.35e-03  4.69e-05 -8.62e-02]]
SymNet parameters
[-0.63  0.58]
SymNet parameters
[[ 2.71e-01 -6.00e-01 -1.01e+00  2.75e-01 -3.19e-02  5.41e-02 -6.62e+00 -4.61e-01
   1.83e-02  3.24e-03  1.22e-02 -9.84e-03  4.02e-01 -7.73e-03]
 [-7.56e-01  9.56e+00 -3.25e+00  1.79e+00 -1.04e-01  5.48e-01 -6.61e+00 -7.12e-01
   9.33e-01  9.95e-02  2.00e-01 -2.61e-01 -1.86e+00  1.69e-02]]
SymNet parameters
[ 0.11 -0.32]
SymNet parameters
[[-5.27e-01 -1.57e-01 -9.54e-02  1.53e-03 -1.04e-03  1.72e-03  1.13e+00  1.56e-03
  -2.09e-03 -1.01e-04  1.68e-04 -2.66e-03  1.43e-01 -5.46e-03 -2.98e-04]
 [ 1.65e+00  1.54e-01 -1.30e-01  8.80e-05  6.62e-04 -2.42e-03  1.68e+00  2.82e-03
  -6.02e-03 -7.24e-04 -6.85e-04 -9.04e-04  1.68e-01  3.43e-03  2.88e-04]]
SymNet parameters
[0.37 0.86]
SymNet parameters
[[-1.31e+00  2.24e-01 -1.48e-01 -1.86e-03 -2.71e-05  3.11e-03 -1.72e+00 -2.50e-03
  -1.76e-02  3.14e-03  1.93e-04  4.44e-03  8.07e-01  8.07e-03  5.41e-04 -2.15e-03]
 [-2.88e+00  4.75e-01  2.39e-01 -7.44e-03  5.80e-03 -2.58e-05  5.05e+00  1.98e-02
   1.40e-02 -1.65e-03 -5.00e-05 -9.00e-03 -8.30e-01  1.03e-02  7.67e-04 -1.19e-02]]
SymNet parameters
[-0.32  0.99]
SymNet parameters
[[-2.99e-01  1.40e-01  2.36e-01  4.62e-02 -6.44e-06  5.04e-02  5.28e-03  2.73e-03
   2.51e-02 -2.59e-03 -5.04e-04 -2.75e-03 -1.06e+00 -6.92e-03 -2.54e-04  1.48e+00
   3.28e-01]]
SymNet parameters
[-0.55]
SymNet parameters
[[-5.40e-03 -6.52e-02 -1.85e-02  1.20e-03  8.16e-04  3.42e-04 -3.63e-01 -8.95e-04
  -1.52e-02  8.62e-04 -1.17e-03 -1.77e-03]
 [ 3.54e-02  1.04e-01 -3.94e-02 -4.36e-02 -4.86e-02 -1.26e-02 -9.51e-01 -3.40e+00
   1.09e-01  3.97e-02 -6.09e-01 -1.10e-01]]
SymNet parameters
[2.38 0.13]
SymNet parameters
[[ 4.41e-01 -1.31e-02  7.61e-01 -5.86e-03  4.53e-02  2.76e-03  1.47e+00  1.38e-01
  -3.68e+00  7.54e-02 -2.89e-02  6.59e-01 -2.04e-03]
 [ 1.13e-01 -3.75e-03  6.22e-02  8.40e-04 -1.19e-03  2.62e-03 -1.10e+00 -4.54e-02
  -2.67e-02  8.94e-03 -1.67e-03 -3.96e-02 -1.94e-03]]
SymNet parameters
[-1.91  3.6 ]
SymNet parameters
[[-5.03 -0.21  3.16  0.03  0.09  0.07 10.73 -1.32 -2.72  0.34 -0.03  0.4  -0.03 -0.13]
 [-0.38 -0.16  1.07  0.05  0.11  0.01 -0.82 -3.71 -2.07  0.08  0.59  1.21  0.43  0.03]]
SymNet parameters
[0.01 3.11]
SymNet parameters
[[ 9.26e-01  1.94e-02 -2.25e-01 -3.27e-03 -5.10e-03 -5.73e-03 -4.42e-01  8.17e-02
   1.30e-01 -2.47e-02  6.16e-04 -1.07e-02  1.32e-03  7.89e-03 -6.02e-04]
 [-1.16e-01 -9.13e-02  4.26e-01  3.04e-02  5.31e-02  1.02e-02 -4.30e-01 -3.09e+00
  -1.00e+00  1.69e-02  3.80e-01  4.33e-01  2.72e-01  1.52e-02 -8.91e-04]]
SymNet parameters
[0.27 2.29]
SymNet parameters
[[-4.68e-01 -1.36e-01  1.40e+00  3.06e-02  1.43e-01  2.58e-03  6.00e-01 -2.25e+00
  -9.87e-01  1.15e-01  4.95e-01  1.84e+00  3.49e-01  3.31e-02 -1.87e-03 -8.11e-02]
 [-3.15e-01 -2.96e-02  5.51e-01  2.94e-03  2.00e-02  1.04e-02  3.46e+00 -2.66e-01
  -8.72e-01  5.61e-02 -7.42e-03  1.47e-01 -4.04e-03 -3.27e-02  2.46e-04  1.99e-03]]
SymNet parameters
[ 0.28 -0.08]
SymNet parameters
[[-1.03e-01 -3.18e-03  3.91e-01 -4.77e-03  2.67e-02  3.22e-04  1.09e+00  7.62e-01
  -2.38e+00  8.90e-02 -1.46e-02  4.68e-01  2.19e-03 -1.97e-01  3.03e-02  4.00e-01
  -7.50e-02]]
SymNet parameters
[-1.63]
finally, finish this stage
iter:     0    time: 36.71
Func: 5.25e-01  |g|: 1.24e+03
stableloss: 5.81e-02   dataloss: 4.88e-01   sparseloss: 1.75e+02 momentloss: 7.32e+00
current expression:
[u00*u01, u10*v00, u20, u02, u00, u00*u01**2, u00*u10*v01, u00*u11*v00, u10*v00*v10, u01*u10*v00, u00**3, u00**2*v00, u01*v00**2, u00*u10*v00, u01**2, u00*u10, u01, u01*v00, v00, u00**2*u10]
[-0.99 -0.98  0.05  0.05  0.02  0.01  0.01  0.01  0.01  0.01 -0.01 -0.    0.   -0.
  0.   -0.   -0.   -0.    0.   -0.  ]
[u00*v01, v00*v10, v02, v20, v00, v00*v10**2, u00*v01*v10, u00*u01*v01, u00*v00*v11, u10*v00*v01, v00**3, v00**2*v01, v01, u00*v00*v10, v00**2*v10, u00*v00**2*v01, v01*v10, u10, u00, u00*v00]
[-0.99 -0.98  0.05  0.05  0.02  0.01  0.01  0.01  0.01  0.01 -0.01  0.01 -0.   -0.
  0.    0.    0.   -0.   -0.   -0.  ]
block:  6
name:  burgers-2-upwind-sparse0-noise0.001-id14
device:  cuda:2
generate a random number to check random seed:  1.3050530193397596
current stage is: block-6
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.9384, device='cuda:2', dtype=torch.float64)
u_obs variance
tensor([ 0.2472,  1.5920,  1.6384, 19.7649,  9.7775, 19.3073,  0.2592,  1.7223,
         1.8469, 20.0038, 11.2465, 24.5168], device='cuda:2',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 0.743979
         Iterations: 0
         Function evaluations: 15
         Gradient evaluations: 3
convolution moment and kernels
[[ 1.00e+00  0.00e+00  1.43e-03 -2.92e-02 -8.97e-02]
 [ 0.00e+00 -8.29e-04 -1.90e-02 -2.07e-03 -7.13e-02]
 [ 6.02e-04  4.53e-03  3.16e-02  2.14e-03 -4.53e-03]
 [ 6.69e-03 -5.83e-03  5.26e-03  7.05e-03 -6.09e-02]
 [-1.17e-01 -3.59e-02 -2.44e-02 -2.60e-02 -4.40e-03]]
[[ 0.04 -0.13  0.08 -0.12  0.01]
 [-0.06  0.24  0.07  0.2   0.03]
 [-0.01  0.08  0.23  0.16 -0.16]
 [-0.02  0.06  0.31  0.07  0.05]
 [-0.02  0.09 -0.23  0.08 -0.03]]
[[ 0.00e+00  1.00e+00  0.00e+00 -8.38e-02 -7.16e-02]
 [ 0.00e+00  0.00e+00  1.92e-03  2.54e-03 -4.38e-03]
 [ 0.00e+00  3.46e-02 -5.36e-03  5.76e-02 -1.33e-02]
 [-5.80e-03 -2.03e-03  8.85e-04 -4.89e-03 -8.59e-03]
 [ 1.31e-02 -9.38e-03  5.24e-03  5.43e-03 -4.96e-04]]
[[ 1.51e-03 -1.74e-04  2.97e-02 -2.18e-02  6.67e-03]
 [-3.64e-02  4.16e-02 -1.15e-01  5.35e-02 -1.59e-03]
 [ 1.24e-01 -5.41e-01 -2.82e-01  9.92e-01 -2.14e-01]
 [-3.14e-02  7.68e-03 -3.75e-02 -1.25e-03  1.59e-02]
 [-3.91e-03  2.81e-02 -2.47e-02  1.44e-02 -3.73e-03]]
[[ 0.00e+00  0.00e+00  0.00e+00  1.17e-02  1.90e-02]
 [ 1.00e+00  0.00e+00  2.54e-02  7.84e-03 -2.55e-02]
 [ 0.00e+00 -8.83e-04 -6.71e-03 -9.94e-03 -3.41e-03]
 [-9.73e-02  5.21e-03  4.39e-02  4.18e-03 -7.27e-03]
 [-8.42e-02  1.93e-03 -2.77e-02 -1.10e-02 -8.85e-03]]
[[ 0.   -0.05  0.12 -0.02 -0.01]
 [ 0.01  0.04 -0.51 -0.02  0.04]
 [ 0.   -0.13 -0.29 -0.06 -0.03]
 [-0.    0.06  1.04 -0.03  0.03]
 [-0.    0.02 -0.26  0.04 -0.01]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00 -5.81e-03]
 [ 0.00e+00  0.00e+00  0.00e+00  8.45e-04 -1.55e-03]
 [ 0.00e+00  0.00e+00  5.40e-03 -3.53e-03  4.51e-04]
 [ 0.00e+00  6.47e-05 -4.63e-04 -2.15e-03  1.65e-04]
 [ 9.01e-02  4.19e-02 -1.49e-03 -6.27e-03 -1.57e-02]]
[[-9.93e-03  2.89e-02 -1.45e-03  9.44e-02 -2.17e-02]
 [ 4.09e-02 -1.12e-01 -4.02e-03 -3.71e-01  8.65e-02]
 [-1.47e-01  1.51e+00 -2.51e+00  1.91e+00 -2.18e-01]
 [ 3.57e-02 -9.61e-02 -2.07e-02 -3.66e-01  8.67e-02]
 [-8.32e-03  2.42e-02  2.25e-03  9.44e-02 -2.24e-02]]
[[ 0.    0.    0.    0.   -0.01]
 [ 0.    1.    0.   -0.01  0.01]
 [ 0.    0.   -0.   -0.    0.  ]
 [ 0.   -0.01  0.    0.07 -0.02]
 [-0.   -0.    0.01  0.   -0.02]]
[[ 0.02 -0.06 -0.06  0.13 -0.03]
 [-0.04  0.27  0.38 -0.75  0.14]
 [-0.13  0.57 -0.86  0.52 -0.12]
 [ 0.2  -0.99  0.7   0.09  0.01]
 [-0.06  0.22 -0.19  0.03 -0.  ]]
[[ 0.    0.    0.    0.    0.01]
 [ 0.    0.    0.    0.   -0.01]
 [ 1.    0.    0.01 -0.01 -0.01]
 [ 0.    0.   -0.   -0.01  0.  ]
 [-0.01 -0.01  0.    0.04 -0.  ]]
[[-0.03  0.07 -0.13 -0.03  0.02]
 [ 0.1  -0.24  1.44  0.15 -0.08]
 [-0.13  0.26 -2.52 -0.3   0.14]
 [ 0.08 -0.16  1.35  0.19 -0.09]
 [-0.02  0.04 -0.1  -0.04  0.02]]
SymNet parameters
[[ 3.21e-03 -4.20e-04  1.15e-01  1.27e-03  1.30e-03 -9.10e-04 -1.34e-02 -3.07e-05
  -9.69e-04  2.37e-03  5.94e-04  4.17e-03]
 [-6.30e-01  2.63e-02  1.81e-02 -6.60e-04  1.45e-03 -3.02e-03  6.85e-03  3.35e-03
   3.60e-02 -6.68e-04  9.74e-04  1.34e-03]]
SymNet parameters
[ 0.61 -0.86]
SymNet parameters
[[-2.20e-01  2.53e+00 -5.27e+00  5.50e-01 -3.24e-01  2.03e-01 -9.36e-01 -2.78e-01
   3.04e-01 -5.97e-02  4.63e-02 -2.35e-01 -7.65e-01]
 [-6.19e-02 -3.16e-02  7.14e-02 -2.66e-02  5.45e-04 -7.39e-03  1.54e+00  9.81e-02
  -2.63e-03 -5.26e-03 -3.35e-03  4.69e-05 -8.62e-02]]
SymNet parameters
[-0.63  0.58]
SymNet parameters
[[ 2.71e-01 -6.00e-01 -1.01e+00  2.75e-01 -3.19e-02  5.41e-02 -6.62e+00 -4.61e-01
   1.83e-02  3.24e-03  1.22e-02 -9.84e-03  4.02e-01 -7.73e-03]
 [-7.56e-01  9.56e+00 -3.25e+00  1.79e+00 -1.04e-01  5.48e-01 -6.61e+00 -7.12e-01
   9.33e-01  9.95e-02  2.00e-01 -2.61e-01 -1.86e+00  1.69e-02]]
SymNet parameters
[ 0.11 -0.32]
SymNet parameters
[[-5.27e-01 -1.57e-01 -9.54e-02  1.53e-03 -1.04e-03  1.72e-03  1.13e+00  1.56e-03
  -2.09e-03 -9.93e-05  1.67e-04 -2.66e-03  1.43e-01 -5.45e-03 -3.21e-04]
 [ 1.65e+00  1.54e-01 -1.30e-01  8.67e-05  6.63e-04 -2.42e-03  1.68e+00  2.82e-03
  -6.02e-03 -7.23e-04 -6.86e-04 -9.03e-04  1.68e-01  3.43e-03  2.60e-04]]
SymNet parameters
[0.37 0.86]
SymNet parameters
[[-1.31e+00  2.24e-01 -1.48e-01 -1.86e-03 -2.60e-05  3.11e-03 -1.72e+00 -2.50e-03
  -1.76e-02  3.14e-03  1.92e-04  4.44e-03  8.07e-01  8.07e-03  5.07e-04 -2.15e-03]
 [-2.88e+00  4.75e-01  2.39e-01 -7.44e-03  5.80e-03 -2.63e-05  5.05e+00  1.98e-02
   1.40e-02 -1.65e-03 -4.97e-05 -9.00e-03 -8.30e-01  1.03e-02  7.76e-04 -1.19e-02]]
SymNet parameters
[-0.32  0.99]
SymNet parameters
[[-2.99e-01  1.40e-01  2.36e-01  4.62e-02 -6.66e-06  5.04e-02  5.28e-03  2.73e-03
   2.51e-02 -2.59e-03 -5.05e-04 -2.75e-03 -1.06e+00 -6.93e-03 -2.12e-04  1.48e+00
   3.28e-01]]
SymNet parameters
[-0.55]
SymNet parameters
[[-5.40e-03 -6.52e-02 -1.85e-02  1.20e-03  8.16e-04  3.42e-04 -3.63e-01 -8.95e-04
  -1.52e-02  8.63e-04 -1.17e-03 -1.77e-03]
 [ 3.54e-02  1.04e-01 -3.94e-02 -4.36e-02 -4.86e-02 -1.26e-02 -9.51e-01 -3.40e+00
   1.09e-01  3.97e-02 -6.09e-01 -1.10e-01]]
SymNet parameters
[2.38 0.13]
SymNet parameters
[[ 4.41e-01 -1.31e-02  7.61e-01 -5.86e-03  4.53e-02  2.76e-03  1.47e+00  1.38e-01
  -3.68e+00  7.54e-02 -2.89e-02  6.59e-01 -2.04e-03]
 [ 1.13e-01 -3.75e-03  6.22e-02  8.40e-04 -1.19e-03  2.62e-03 -1.10e+00 -4.54e-02
  -2.67e-02  8.94e-03 -1.67e-03 -3.96e-02 -1.94e-03]]
SymNet parameters
[-1.91  3.6 ]
SymNet parameters
[[-5.03 -0.21  3.16  0.03  0.09  0.07 10.73 -1.32 -2.72  0.34 -0.03  0.4  -0.03 -0.13]
 [-0.38 -0.16  1.07  0.05  0.11  0.01 -0.82 -3.71 -2.07  0.08  0.59  1.21  0.43  0.03]]
SymNet parameters
[0.01 3.11]
SymNet parameters
[[ 9.26e-01  1.94e-02 -2.25e-01 -3.27e-03 -5.10e-03 -5.73e-03 -4.42e-01  8.17e-02
   1.30e-01 -2.47e-02  6.16e-04 -1.07e-02  1.32e-03  7.87e-03 -4.51e-04]
 [-1.16e-01 -9.13e-02  4.26e-01  3.04e-02  5.31e-02  1.02e-02 -4.30e-01 -3.09e+00
  -1.00e+00  1.69e-02  3.80e-01  4.33e-01  2.72e-01  1.52e-02 -8.76e-04]]
SymNet parameters
[0.27 2.29]
SymNet parameters
[[-4.68e-01 -1.36e-01  1.40e+00  3.06e-02  1.43e-01  2.58e-03  6.00e-01 -2.25e+00
  -9.87e-01  1.15e-01  4.95e-01  1.84e+00  3.49e-01  3.31e-02 -1.85e-03 -8.11e-02]
 [-3.15e-01 -2.96e-02  5.51e-01  2.94e-03  2.00e-02  1.04e-02  3.46e+00 -2.66e-01
  -8.72e-01  5.61e-02 -7.42e-03  1.47e-01 -4.05e-03 -3.27e-02  1.92e-04  1.99e-03]]
SymNet parameters
[ 0.28 -0.08]
SymNet parameters
[[-1.03e-01 -3.18e-03  3.91e-01 -4.77e-03  2.67e-02  3.22e-04  1.09e+00  7.62e-01
  -2.38e+00  8.90e-02 -1.46e-02  4.68e-01  2.19e-03 -1.97e-01  3.03e-02  4.00e-01
  -7.50e-02]]
SymNet parameters
[-1.63]
finally, finish this stage
iter:     0    time: 37.97
Func: 7.44e-01  |g|: 1.25e+03
stableloss: 5.60e-02   dataloss: 7.00e-01   sparseloss: 1.75e+02 momentloss: 7.32e+00
current expression:
[u00*u01, u10*v00, u20, u02, u00, u00*u01**2, u00*u10*v01, u00*u11*v00, u10*v00*v10, u01*u10*v00, u00**3, u00**2*v00, u01*v00**2, u00*u10*v00, u01**2, u00*u10, u01, u01*v00, v00, u00**2*u10]
[-0.99 -0.98  0.05  0.05  0.02  0.01  0.01  0.01  0.01  0.01 -0.01 -0.    0.   -0.
  0.   -0.   -0.   -0.    0.   -0.  ]
[u00*v01, v00*v10, v02, v20, v00, v00*v10**2, u00*v01*v10, u00*u01*v01, u00*v00*v11, u10*v00*v01, v00**3, v00**2*v01, v01, u00*v00*v10, v00**2*v10, u00*v00**2*v01, v01*v10, u10, u00, u00*v00]
[-0.99 -0.98  0.05  0.05  0.02  0.01  0.01  0.01  0.01  0.01 -0.01  0.01 -0.   -0.
  0.    0.    0.   -0.   -0.   -0.  ]
block:  9
name:  burgers-2-upwind-sparse0-noise0.001-id14
device:  cuda:2
generate a random number to check random seed:  -0.12436850265922506
current stage is: block-9
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.8963, device='cuda:2', dtype=torch.float64)
u_obs variance
tensor([ 0.2226,  1.4879,  1.3785, 19.5871,  8.3802, 16.4251,  0.2650,  1.6126,
         1.7380, 18.7258,  9.7446, 23.4414], device='cuda:2',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 1.687712
         Iterations: 0
         Function evaluations: 15
         Gradient evaluations: 3
convolution moment and kernels
[[ 1.00e+00  0.00e+00  1.43e-03 -2.92e-02 -8.97e-02]
 [ 0.00e+00 -8.29e-04 -1.90e-02 -2.07e-03 -7.13e-02]
 [ 6.02e-04  4.53e-03  3.16e-02  2.14e-03 -4.53e-03]
 [ 6.69e-03 -5.83e-03  5.26e-03  7.05e-03 -6.09e-02]
 [-1.17e-01 -3.59e-02 -2.44e-02 -2.60e-02 -4.40e-03]]
[[ 0.04 -0.13  0.08 -0.12  0.01]
 [-0.06  0.24  0.07  0.2   0.03]
 [-0.01  0.08  0.23  0.16 -0.16]
 [-0.02  0.06  0.31  0.07  0.05]
 [-0.02  0.09 -0.23  0.08 -0.03]]
[[ 0.00e+00  1.00e+00  0.00e+00 -8.38e-02 -7.16e-02]
 [ 0.00e+00  0.00e+00  1.92e-03  2.54e-03 -4.38e-03]
 [ 0.00e+00  3.46e-02 -5.36e-03  5.76e-02 -1.33e-02]
 [-5.80e-03 -2.03e-03  8.85e-04 -4.89e-03 -8.59e-03]
 [ 1.31e-02 -9.38e-03  5.24e-03  5.43e-03 -4.96e-04]]
[[ 1.51e-03 -1.75e-04  2.97e-02 -2.18e-02  6.67e-03]
 [-3.64e-02  4.16e-02 -1.15e-01  5.36e-02 -1.59e-03]
 [ 1.24e-01 -5.41e-01 -2.82e-01  9.92e-01 -2.14e-01]
 [-3.14e-02  7.69e-03 -3.75e-02 -1.25e-03  1.59e-02]
 [-3.91e-03  2.81e-02 -2.47e-02  1.44e-02 -3.73e-03]]
[[ 0.00e+00  0.00e+00  0.00e+00  1.17e-02  1.90e-02]
 [ 1.00e+00  0.00e+00  2.54e-02  7.84e-03 -2.55e-02]
 [ 0.00e+00 -8.82e-04 -6.71e-03 -9.94e-03 -3.41e-03]
 [-9.73e-02  5.21e-03  4.39e-02  4.18e-03 -7.27e-03]
 [-8.42e-02  1.93e-03 -2.77e-02 -1.10e-02 -8.85e-03]]
[[ 0.   -0.05  0.12 -0.02 -0.01]
 [ 0.01  0.04 -0.51 -0.02  0.04]
 [ 0.   -0.13 -0.29 -0.06 -0.03]
 [-0.    0.06  1.04 -0.03  0.03]
 [-0.    0.02 -0.26  0.04 -0.01]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00 -5.81e-03]
 [ 0.00e+00  0.00e+00  0.00e+00  8.45e-04 -1.55e-03]
 [ 0.00e+00  0.00e+00  5.40e-03 -3.53e-03  4.51e-04]
 [ 0.00e+00  6.47e-05 -4.63e-04 -2.15e-03  1.65e-04]
 [ 9.01e-02  4.19e-02 -1.50e-03 -6.27e-03 -1.57e-02]]
[[-9.93e-03  2.89e-02 -1.45e-03  9.44e-02 -2.17e-02]
 [ 4.09e-02 -1.12e-01 -4.02e-03 -3.71e-01  8.65e-02]
 [-1.47e-01  1.51e+00 -2.51e+00  1.91e+00 -2.18e-01]
 [ 3.57e-02 -9.61e-02 -2.07e-02 -3.66e-01  8.67e-02]
 [-8.32e-03  2.42e-02  2.25e-03  9.44e-02 -2.24e-02]]
[[ 0.    0.    0.    0.   -0.01]
 [ 0.    1.    0.   -0.01  0.01]
 [ 0.    0.   -0.   -0.    0.  ]
 [ 0.   -0.01  0.    0.07 -0.02]
 [-0.   -0.    0.01  0.   -0.02]]
[[ 0.02 -0.06 -0.06  0.13 -0.03]
 [-0.04  0.27  0.38 -0.75  0.14]
 [-0.13  0.57 -0.86  0.52 -0.12]
 [ 0.2  -0.99  0.7   0.09  0.01]
 [-0.06  0.22 -0.19  0.03 -0.  ]]
[[ 0.    0.    0.    0.    0.01]
 [ 0.    0.    0.    0.   -0.01]
 [ 1.    0.    0.01 -0.01 -0.01]
 [ 0.    0.   -0.   -0.01  0.  ]
 [-0.01 -0.01  0.    0.04 -0.  ]]
[[-0.03  0.07 -0.13 -0.03  0.02]
 [ 0.1  -0.24  1.44  0.15 -0.08]
 [-0.13  0.26 -2.52 -0.3   0.14]
 [ 0.08 -0.16  1.35  0.19 -0.09]
 [-0.02  0.04 -0.1  -0.04  0.02]]
SymNet parameters
[[ 3.21e-03 -4.22e-04  1.15e-01  1.27e-03  1.31e-03 -9.14e-04 -1.34e-02 -3.21e-05
  -9.67e-04  2.37e-03  5.96e-04  4.17e-03]
 [-6.30e-01  2.63e-02  1.81e-02 -6.58e-04  1.45e-03 -3.02e-03  6.85e-03  3.35e-03
   3.60e-02 -6.67e-04  9.73e-04  1.34e-03]]
SymNet parameters
[ 0.61 -0.86]
SymNet parameters
[[-2.20e-01  2.53e+00 -5.27e+00  5.50e-01 -3.24e-01  2.03e-01 -9.36e-01 -2.78e-01
   3.04e-01 -5.97e-02  4.63e-02 -2.35e-01 -7.65e-01]
 [-6.19e-02 -3.16e-02  7.14e-02 -2.66e-02  5.45e-04 -7.39e-03  1.54e+00  9.81e-02
  -2.63e-03 -5.26e-03 -3.35e-03  4.68e-05 -8.62e-02]]
SymNet parameters
[-0.63  0.58]
SymNet parameters
[[ 2.71e-01 -6.00e-01 -1.01e+00  2.75e-01 -3.19e-02  5.41e-02 -6.62e+00 -4.61e-01
   1.83e-02  3.24e-03  1.22e-02 -9.84e-03  4.02e-01 -7.73e-03]
 [-7.56e-01  9.56e+00 -3.25e+00  1.79e+00 -1.04e-01  5.48e-01 -6.61e+00 -7.12e-01
   9.33e-01  9.95e-02  2.00e-01 -2.61e-01 -1.86e+00  1.69e-02]]
SymNet parameters
[ 0.11 -0.32]
SymNet parameters
[[-5.27e-01 -1.57e-01 -9.54e-02  1.54e-03 -1.04e-03  1.73e-03  1.13e+00  1.56e-03
  -2.09e-03 -1.00e-04  1.67e-04 -2.67e-03  1.43e-01 -5.48e-03 -5.85e-05]
 [ 1.65e+00  1.54e-01 -1.30e-01  8.80e-05  6.61e-04 -2.41e-03  1.68e+00  2.82e-03
  -6.02e-03 -7.24e-04 -6.86e-04 -9.05e-04  1.68e-01  3.42e-03  4.80e-04]]
SymNet parameters
[0.37 0.86]
SymNet parameters
[[-1.31e+00  2.24e-01 -1.48e-01 -1.86e-03 -2.70e-05  3.11e-03 -1.72e+00 -2.50e-03
  -1.76e-02  3.14e-03  1.91e-04  4.44e-03  8.07e-01  8.05e-03  7.57e-04 -2.14e-03]
 [-2.88e+00  4.75e-01  2.39e-01 -7.44e-03  5.80e-03 -2.68e-05  5.05e+00  1.98e-02
   1.40e-02 -1.65e-03 -4.98e-05 -9.00e-03 -8.30e-01  1.03e-02  7.05e-04 -1.19e-02]]
SymNet parameters
[-0.32  0.99]
SymNet parameters
[[-2.99e-01  1.40e-01  2.36e-01  4.62e-02 -6.84e-06  5.04e-02  5.28e-03  2.73e-03
   2.51e-02 -2.59e-03 -5.05e-04 -2.75e-03 -1.06e+00 -6.93e-03 -2.18e-04  1.48e+00
   3.28e-01]]
SymNet parameters
[-0.55]
SymNet parameters
[[-5.40e-03 -6.52e-02 -1.85e-02  1.20e-03  8.16e-04  3.42e-04 -3.63e-01 -8.95e-04
  -1.52e-02  8.62e-04 -1.17e-03 -1.77e-03]
 [ 3.54e-02  1.04e-01 -3.94e-02 -4.36e-02 -4.86e-02 -1.26e-02 -9.51e-01 -3.40e+00
   1.09e-01  3.97e-02 -6.09e-01 -1.10e-01]]
SymNet parameters
[2.38 0.13]
SymNet parameters
[[ 4.41e-01 -1.31e-02  7.61e-01 -5.86e-03  4.53e-02  2.76e-03  1.47e+00  1.38e-01
  -3.68e+00  7.54e-02 -2.89e-02  6.59e-01 -2.04e-03]
 [ 1.13e-01 -3.75e-03  6.22e-02  8.41e-04 -1.19e-03  2.62e-03 -1.10e+00 -4.54e-02
  -2.67e-02  8.94e-03 -1.67e-03 -3.96e-02 -1.93e-03]]
SymNet parameters
[-1.91  3.6 ]
SymNet parameters
[[-5.03 -0.21  3.16  0.03  0.09  0.07 10.73 -1.32 -2.72  0.34 -0.03  0.4  -0.03 -0.13]
 [-0.38 -0.16  1.07  0.05  0.11  0.01 -0.82 -3.71 -2.07  0.08  0.59  1.21  0.43  0.03]]
SymNet parameters
[0.01 3.11]
SymNet parameters
[[ 9.26e-01  1.94e-02 -2.25e-01 -3.27e-03 -5.10e-03 -5.73e-03 -4.42e-01  8.17e-02
   1.30e-01 -2.47e-02  6.19e-04 -1.07e-02  1.33e-03  7.86e-03 -4.62e-05]
 [-1.16e-01 -9.13e-02  4.26e-01  3.04e-02  5.31e-02  1.02e-02 -4.30e-01 -3.09e+00
  -1.00e+00  1.69e-02  3.80e-01  4.33e-01  2.72e-01  1.52e-02 -8.16e-04]]
SymNet parameters
[0.27 2.29]
SymNet parameters
[[-4.68e-01 -1.36e-01  1.40e+00  3.06e-02  1.43e-01  2.58e-03  6.00e-01 -2.25e+00
  -9.87e-01  1.15e-01  4.95e-01  1.84e+00  3.49e-01  3.31e-02 -1.83e-03 -8.11e-02]
 [-3.15e-01 -2.96e-02  5.51e-01  2.94e-03  2.00e-02  1.04e-02  3.46e+00 -2.66e-01
  -8.72e-01  5.61e-02 -7.42e-03  1.47e-01 -4.05e-03 -3.27e-02  8.96e-05  1.99e-03]]
SymNet parameters
[ 0.28 -0.08]
SymNet parameters
[[-1.03e-01 -3.18e-03  3.91e-01 -4.77e-03  2.67e-02  3.22e-04  1.09e+00  7.62e-01
  -2.38e+00  8.90e-02 -1.46e-02  4.68e-01  2.19e-03 -1.97e-01  3.05e-02  4.00e-01
  -7.50e-02]]
SymNet parameters
[-1.63]
finally, finish this stage
iter:     0    time: 36.71
Func: 1.69e+00  |g|: 1.39e+03
stableloss: 5.72e-02   dataloss: 1.62e+00   sparseloss: 1.75e+02 momentloss: 7.32e+00
current expression:
[u00*u01, u10*v00, u20, u02, u00, u00*u01**2, u00*u10*v01, u00*u11*v00, u10*v00*v10, u01*u10*v00, u00**3, u00**2*v00, u01*v00**2, u00*u10*v00, u01**2, u00*u10, u01, u01*v00, v00, u00**2*u10]
[-0.99 -0.98  0.05  0.05  0.02  0.01  0.01  0.01  0.01  0.01 -0.01 -0.    0.   -0.
  0.   -0.   -0.   -0.    0.   -0.  ]
[u00*v01, v00*v10, v02, v20, v00, v00*v10**2, u00*v01*v10, u00*u01*v01, u00*v00*v11, u10*v00*v01, v00**3, v00**2*v01, v01, u00*v00*v10, v00**2*v10, u00*v00**2*v01, v01*v10, u10, u00, u00*v00]
[-0.99 -0.98  0.05  0.05  0.02  0.01  0.01  0.01  0.01  0.01 -0.01  0.01 -0.   -0.
  0.    0.    0.   -0.   -0.   -0.  ]
u_obs.abs().max()
tensor(3.9391, device='cuda:2', dtype=torch.float64)
model(u_obs[0],T=50*dt).abs().max()
tensor(nan, device='cuda:2', dtype=torch.float64)
model(u_obs[0],T=100*dt).abs().max()
tensor(nan, device='cuda:2', dtype=torch.float64)
{'--name': 'burgers-2-upwind-sparse0-noise0.001-id12', '--dtype': 'double', '--device': 'cuda:0', '--constraint': '2', '--dt': 0.01, '--cell_num': 1, '--eps': 6.283185307179586, '--blocks': [0, 1, 2, 3, 4, 5, 6, 9], '--kernel_size': 5, '--max_order': 2, '--dx': 0.19634954084936207, '--hidden_layers': 5, '--scheme': 'upwind', '--dataname': 'burgers', '--viscosity': 0.05, '--zoom': 4, '--max_dt': 0.000625, '--batch_size': 28, '--data_timescheme': 'rk2', '--channel_names': 'u,v', '--freq': 4, '--data_start_time': 1.0, '--start_noise': 0.001, '--end_noise': 0.001, '--stablize': 0.0, '--sparsity': 0.0, '--momentsparsity': 0.001, '--npseed': -1, '--torchseed': -1, '--maxiter': 2000, '--recordfile': 'None', '--recordcycle': 200, '--savecycle': -1, '--start_from': -1}
block:  0
name:  burgers-2-upwind-sparse0-noise0.001-id12
device:  cuda:0
generate a random number to check random seed:  0.20798609747973412
current stage is: warmup
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.8816, device='cuda:0', dtype=torch.float64)
u_obs variance
tensor([ 0.2500,  2.1891,  2.0604, 20.5441, 10.2905, 18.2096,  0.2541,  1.9305,
         2.0085, 16.7393,  9.3863, 18.5847], device='cuda:0',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
iter:     0    time: 6.40
Func: 5.33e+00  |g|: 2.82e+00
stableloss: 8.79e-04   dataloss: 5.33e+00   sparseloss: 2.57e+01 momentloss: 7.27e+00
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 0.036824
         Iterations: 154
         Function evaluations: 235
         Gradient evaluations: 228
convolution moment and kernels
[[1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
[[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 1. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
[[ 0.    1.    0.   -0.33 -0.25]
 [ 0.    0.    0.    0.    0.  ]
 [ 0.    0.    0.    0.    0.  ]
 [ 0.    0.    0.    0.    0.  ]
 [ 0.    0.    0.    0.    0.  ]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]
 [ 2.78e-17  3.33e-16 -1.50e+00  2.00e+00 -5.00e-01]
 [ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]]
[[ 0.    0.    0.    0.    0.  ]
 [ 1.    0.    0.    0.    0.  ]
 [ 0.    0.    0.    0.    0.  ]
 [-0.33  0.    0.    0.    0.  ]
 [-0.25  0.    0.    0.    0.  ]]
[[ 0.00e+00  0.00e+00  2.78e-17  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  3.33e-16  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00 -1.50e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  2.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00 -5.00e-01  0.00e+00  0.00e+00]]
[[0.   0.   1.   0.   0.08]
 [0.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.  ]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]
 [-2.22e-16  1.00e+00 -2.00e+00  1.00e+00 -1.53e-16]
 [ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]]
[[0. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
[[ 6.94e-03 -5.56e-02  9.25e-18  5.56e-02 -6.94e-03]
 [-5.56e-02  4.44e-01 -7.40e-17 -4.44e-01  5.56e-02]
 [ 9.25e-18 -7.40e-17  1.23e-32  7.40e-17 -9.25e-18]
 [ 5.56e-02 -4.44e-01  7.40e-17  4.44e-01 -5.56e-02]
 [-6.94e-03  5.56e-02 -9.25e-18 -5.56e-02  6.94e-03]]
[[0.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.  ]
 [1.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.  ]
 [0.08 0.   0.   0.   0.  ]]
[[ 0.00e+00  0.00e+00 -2.22e-16  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  1.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00 -2.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  1.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00 -1.53e-16  0.00e+00  0.00e+00]]
SymNet parameters
[[ 0.24  0.    0.05 -0.   -0.01  0.01  0.15 -0.    0.    0.01  0.02 -0.  ]
 [ 0.01 -0.04  0.06 -0.01 -0.08  0.03  0.15 -0.07 -0.05  0.01  0.   -0.01]]
SymNet parameters
[ 0.03 -0.04]
SymNet parameters
[[-0.03 -0.7   0.07  0.03 -0.1  -0.    0.68  0.09  0.05  0.04 -0.01  0.01  0.11]
 [ 0.67  0.31 -0.87  0.02 -0.01 -0.01  0.01  0.04 -0.03  0.02 -0.    0.02 -0.11]]
SymNet parameters
[-0.25 -0.14]
SymNet parameters
[[-0.52  0.02  0.26 -0.02 -0.    0.02 -0.11 -0.03  0.04 -0.01  0.01 -0.02  0.05 -0.  ]
 [ 0.25  0.4   0.04  0.01 -0.24  0.04 -0.47  0.14  0.23  0.04 -0.02 -0.04 -0.07  0.02]]
SymNet parameters
[-0.04 -0.03]
SymNet parameters
[[-1.06  0.21 -1.07 -0.01 -0.01  0.02 -0.15 -0.04  0.06 -0.01  0.01 -0.02 -0.09 -0.01
   0.04]
 [ 0.06 -0.84 -0.    0.   -0.05  0.01 -0.81  0.02  0.03  0.01 -0.   -0.   -0.1  -0.01
   0.01]]
SymNet parameters
[0.07 0.76]
SymNet parameters
[[ 0.32 -0.64 -0.38  0.01  0.01 -0.01  0.26 -0.01 -0.06  0.01 -0.    0.01 -0.22 -0.03
   0.01  0.02]
 [-0.49  0.11  0.31  0.09  0.1  -0.09 -0.56  0.11 -0.3   0.06 -0.02  0.12 -0.16 -0.03
  -0.07  0.02]]
SymNet parameters
[0.07 0.01]
SymNet parameters
[[-0.32  0.04 -0.49  0.03 -0.03  0.05 -0.04  0.    0.02  0.   -0.   -0.01 -0.45  0.52
   0.51 -0.49 -0.27]]
SymNet parameters
[0.01]
SymNet parameters
[[-0.29  0.09  0.06 -0.04 -0.05  0.   -0.34 -0.06 -0.    0.08 -0.14 -0.41]
 [-0.33 -0.02  0.   -0.02  0.01  0.01  0.51 -0.05  0.12  0.04 -0.02  0.03]]
SymNet parameters
[ 0.16 -0.28]
SymNet parameters
[[-3.79e-01  3.76e-03  3.68e-03  3.27e-03 -2.03e-03  1.23e-03 -4.35e-01 -7.50e-01
   6.49e-01 -9.98e-04  5.22e-03  9.08e-04 -4.61e-02]
 [ 1.21e+00  1.83e-02 -3.36e-03  6.33e-04 -1.04e-02  8.52e-03 -8.91e-01  1.58e-01
   1.74e-01 -2.90e-03  7.27e-03 -1.43e-02 -3.80e-02]]
SymNet parameters
[ 0.21 -0.01]
SymNet parameters
[[-0.07 -0.04 -0.02  0.    0.   -0.02 -0.03  0.16  0.06 -0.01 -0.    0.02 -0.03 -0.04]
 [-0.1   0.01 -0.13 -0.    0.    0.01  0.05  0.11  0.1  -0.01  0.04 -0.03 -0.03  0.02]]
SymNet parameters
[ 0.29 -0.02]
SymNet parameters
[[-9.42e-01  5.43e-02  4.78e-02  5.32e-03 -2.39e-02  1.77e-02 -1.15e+00  1.57e-01
  -3.43e-01  3.26e-03  8.31e-03 -2.87e-02  1.57e-02  2.84e-03 -3.66e-02]
 [ 2.10e-01 -5.24e-03  2.81e-03  1.80e-03  1.11e-03 -5.58e-03 -3.50e-01 -3.93e-01
  -3.75e-01  5.34e-04 -3.33e-03  1.76e-03  2.93e-02  2.06e-03 -1.28e-01]]
SymNet parameters
[0.37 0.3 ]
SymNet parameters
[[ 7.06e-01  6.93e-02  3.63e-02  9.44e-03 -4.11e-02  1.98e-02  6.56e-01 -1.94e-01
  -1.00e-01 -7.29e-04  1.71e-02 -5.79e-02  1.00e-02  2.72e-02  6.57e-02 -4.62e-02]
 [-6.35e-01  1.08e-02  1.02e-01  1.53e-02 -2.01e-02 -1.50e-02 -3.13e-01  2.57e-01
   9.66e-01  1.35e-02 -2.07e-02 -1.30e-02  4.43e-02  2.37e-02  8.48e-02 -2.09e-02]]
SymNet parameters
[-0.31  0.23]
SymNet parameters
[[-1.56e-01  3.18e-03  3.21e-02  2.87e-03 -3.63e-03  3.27e-04 -1.43e-01 -1.30e-01
  -2.82e-01  3.63e-02  2.33e-03  4.67e-02 -9.48e-03  5.36e-01  6.80e-01 -6.63e-01
  -2.46e-01]]
SymNet parameters
[0.06]
finally, finish this stage
iter:   154    time: 12.46
Func: 3.68e-02  |g|: 2.19e-02
stableloss: 1.40e-02   dataloss: 3.68e-02   sparseloss: 4.50e+01 momentloss: 7.27e+00
current expression:
[u10*v00, u00*u01, u20, u02, v00, u00*u01**2, v00*v10, u01*u10*v00, u00*u11*v00, u01, u10*v00*v10, u00**2*v00, u11, v00*v01, u01*v00, 1, u20*v00, u00**2*u01, u00*u10*v01, u10*v00**2]
[-0.88 -0.88  0.04  0.03  0.01  0.01  0.01  0.01  0.01 -0.01  0.01 -0.01 -0.01 -0.
 -0.    0.    0.    0.    0.   -0.  ]
[v00*v10, u00*v01, v20, v02, v00, v00**2*v20, v00*v10**2, v00*v20, v01, v00**3, u00*v01*v10, v10, u00*v00*v20, v11, u00*v00*v01, v00*v01, u00*v10, v00**2, u10*v00*v01, u00**2*v00]
[-0.89 -0.88  0.04  0.04  0.01 -0.01  0.01  0.01  0.01 -0.01  0.01 -0.01  0.01  0.01
  0.01  0.01  0.    0.    0.    0.  ]
block:  1
name:  burgers-2-upwind-sparse0-noise0.001-id12
device:  cuda:0
generate a random number to check random seed:  1.3142644714667195
current stage is: block-1
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.8391, device='cuda:0', dtype=torch.float64)
u_obs variance
tensor([ 0.2594,  2.1069,  1.9618, 19.5942,  9.4069, 16.9006,  0.2582,  1.9930,
         2.0617, 17.4207,  9.7590, 18.5910], device='cuda:0',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
iter:     0    time: 759.21
Func: 4.61e-02  |g|: 4.35e-01
stableloss: 1.88e-02   dataloss: 3.88e-02   sparseloss: 4.50e+01 momentloss: 7.28e+00
iter:   200    time: 10.33
Func: 1.94e-02  |g|: 7.33e-03
stableloss: 1.40e-02   dataloss: 1.29e-02   sparseloss: 4.75e+01 momentloss: 6.46e+00
iter:   400    time: 10.28
Func: 1.87e-02  |g|: 5.82e-03
stableloss: 1.37e-02   dataloss: 1.23e-02   sparseloss: 5.43e+01 momentloss: 6.44e+00
iter:   600    time: 10.25
Func: 1.86e-02  |g|: 6.95e-03
stableloss: 1.35e-02   dataloss: 1.21e-02   sparseloss: 6.36e+01 momentloss: 6.43e+00
iter:   800    time: 10.29
Func: 1.85e-02  |g|: 6.22e-03
stableloss: 1.35e-02   dataloss: 1.20e-02   sparseloss: 6.60e+01 momentloss: 6.43e+00
iter:  1000    time: 10.30
Func: 1.84e-02  |g|: 3.57e-03
stableloss: 1.34e-02   dataloss: 1.20e-02   sparseloss: 6.97e+01 momentloss: 6.43e+00
iter:  1200    time: 10.39
Func: 1.84e-02  |g|: 3.11e-03
stableloss: 1.35e-02   dataloss: 1.19e-02   sparseloss: 7.04e+01 momentloss: 6.44e+00
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 0.018383
         Iterations: 1318
         Function evaluations: 1378
         Gradient evaluations: 1370
convolution moment and kernels
[[ 1.00e+00  0.00e+00 -1.80e-05 -5.08e-03 -3.62e-02]
 [ 0.00e+00 -8.49e-05  1.17e-03 -3.01e-03 -2.82e-03]
 [-7.75e-05 -1.90e-03  2.82e-03  3.94e-03 -2.15e-03]
 [-3.72e-04 -3.28e-03 -8.22e-04  4.89e-03 -1.58e-03]
 [-4.10e-02 -6.83e-05 -2.60e-04  2.34e-03  2.05e-03]]
[[ 0.   -0.01 -0.02 -0.01  0.  ]
 [-0.01  0.05  0.09  0.04 -0.01]
 [-0.02  0.06  0.67  0.07 -0.02]
 [-0.01  0.04  0.08  0.07 -0.02]
 [-0.   -0.   -0.03 -0.01  0.  ]]
[[ 0.00e+00  1.00e+00  0.00e+00 -8.91e-02 -7.75e-02]
 [ 0.00e+00  0.00e+00 -1.46e-03  4.54e-05 -6.42e-03]
 [ 0.00e+00  7.85e-03 -4.18e-03  1.08e-02 -7.01e-03]
 [-5.32e-03 -3.09e-04  2.77e-03  2.03e-03 -1.90e-03]
 [ 1.10e-02 -1.90e-02 -3.04e-03 -5.09e-03  1.80e-04]]
[[ 3.40e-03 -4.31e-03  3.12e-02 -1.63e-02 -3.40e-04]
 [-1.97e-02  2.37e-02 -1.21e-01  6.54e-02  2.61e-03]
 [ 8.73e-02 -4.99e-01 -2.68e-01  9.49e-01 -2.04e-01]
 [-2.18e-02  2.84e-02 -1.20e-01  7.88e-02 -3.57e-03]
 [ 1.28e-03  5.27e-03  1.34e-02 -1.12e-02 -3.87e-04]]
[[ 0.00e+00  0.00e+00  0.00e+00 -9.26e-03  1.64e-02]
 [ 1.00e+00  0.00e+00  9.55e-03 -7.06e-04 -2.25e-02]
 [ 0.00e+00  1.94e-03  5.79e-03  6.52e-03 -3.28e-03]
 [-9.44e-02 -1.71e-03  9.61e-03  2.86e-03 -2.02e-02]
 [-5.29e-02 -2.69e-03 -6.30e-03 -5.22e-04 -5.48e-03]]
[[ 0.01 -0.03  0.12 -0.03  0.  ]
 [ 0.    0.01 -0.57 -0.01  0.02]
 [ 0.01 -0.05 -0.24 -0.02 -0.02]
 [ 0.02 -0.05  1.04 -0.05  0.02]
 [-0.01  0.05 -0.26  0.05 -0.01]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00  1.70e-04]
 [ 0.00e+00  0.00e+00  0.00e+00 -9.99e-04 -2.51e-03]
 [ 0.00e+00  0.00e+00  1.70e-03  5.42e-04 -7.82e-04]
 [ 0.00e+00 -1.77e-03 -1.40e-03  2.08e-03  1.09e-03]
 [ 6.37e-04  4.09e-04 -1.24e-03  8.88e-04 -1.51e-03]]
[[-1.89e-03  6.73e-03 -1.08e-02  9.02e-03 -2.39e-03]
 [ 7.03e-03 -2.10e-02  2.94e-02 -2.54e-02  7.51e-03]
 [-9.11e-02  1.35e+00 -2.51e+00  1.34e+00 -8.75e-02]
 [ 4.30e-03 -3.05e-03 -1.08e-02  8.27e-03 -1.29e-03]
 [-1.54e-03  2.26e-03  1.71e-03 -2.30e-03  5.06e-04]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  2.44e-03]
 [ 0.00e+00  1.00e+00  0.00e+00 -1.28e-03  1.77e-03]
 [ 0.00e+00  0.00e+00  3.23e-04  1.86e-03 -5.20e-04]
 [ 0.00e+00 -1.52e-03  1.52e-03  2.24e-03 -2.94e-03]
 [ 2.00e-04  3.31e-04  7.45e-05 -1.56e-03 -1.07e-03]]
[[ 0.01 -0.06  0.01  0.06 -0.01]
 [-0.06  0.46 -0.01 -0.45  0.06]
 [ 0.   -0.01 -0.01  0.03 -0.01]
 [ 0.06 -0.47  0.05  0.41 -0.04]
 [-0.01  0.07 -0.02 -0.04  0.  ]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  3.51e-03]
 [ 0.00e+00  0.00e+00  0.00e+00 -9.90e-04 -2.65e-03]
 [ 1.00e+00  0.00e+00  1.06e-03  1.64e-04 -4.18e-04]
 [ 0.00e+00 -1.44e-03 -1.25e-03  1.68e-03  9.74e-04]
 [-4.74e-03 -6.40e-04  1.08e-03  1.92e-03 -4.08e-03]]
[[-5.37e-03  2.21e-02 -1.21e-01  2.02e-02 -4.40e-03]
 [ 2.15e-02 -8.54e-02  1.47e+00 -7.37e-02  1.62e-02]
 [-2.61e-02  9.85e-02 -2.66e+00  7.12e-02 -1.44e-02]
 [ 1.84e-02 -6.68e-02  1.43e+00 -4.18e-02  7.92e-03]
 [-4.90e-03  1.76e-02 -1.09e-01  1.01e-02 -1.84e-03]]
SymNet parameters
[[ 2.52e-01 -6.93e-03 -2.25e-02  1.46e-03 -3.65e-03 -2.83e-03  2.76e-03 -1.10e-02
  -2.87e-02  1.99e-05 -6.86e-04  5.30e-04]
 [ 2.35e-01 -1.13e-02  9.00e-02 -8.33e-04 -2.00e-02  1.21e-02  1.05e-01 -1.27e-02
  -3.51e-03  1.41e-03  1.49e-03 -4.48e-03]]
SymNet parameters
[-0.14  0.1 ]
SymNet parameters
[[ 3.72e-01 -1.20e-01  3.11e-02 -1.01e-01 -3.20e-02  2.53e-02  1.33e+00 -1.13e-01
  -8.12e-02  1.10e-02 -7.03e-03 -1.48e-02 -1.30e-01]
 [ 1.67e+00  2.06e-01 -2.40e-01  8.60e-02 -5.04e-04  4.64e-02  1.50e+00 -5.15e-02
  -1.38e-01  1.54e-03  7.97e-03 -6.57e-03 -1.05e+00]]
SymNet parameters
[-0.36 -0.23]
SymNet parameters
[[-1.23e+00 -8.32e-04  1.19e-01 -1.99e-02  8.54e-04 -1.12e-02 -2.68e-02  1.74e-02
   3.80e-02 -3.72e-04 -1.57e-03  1.48e-03  6.29e-01  1.18e-03]
 [-1.05e-01  9.44e-01  2.59e-01 -3.06e-01 -1.45e-01  1.36e-01 -1.26e+00 -4.71e-01
  -4.13e-01  4.65e-02 -2.25e-02 -6.52e-02 -2.52e-01 -8.65e-02]]
SymNet parameters
[0.01 0.09]
SymNet parameters
[[-1.91e+00  2.45e-02 -6.24e-01  1.80e-02  2.56e-02 -4.60e-02 -9.26e-01  1.00e-01
   1.26e-01 -8.32e-03 -4.13e-04  1.39e-02 -9.60e-01 -7.90e-03 -5.44e-03]
 [-1.77e-02 -3.69e-01 -5.71e-02 -5.38e-02 -7.15e-03 -1.29e-02 -2.15e+00 -4.79e-04
   4.30e-02  1.79e-03 -4.86e-03 -7.65e-04  2.20e-01  6.37e-03  1.83e-02]]
SymNet parameters
[0.09 0.96]
SymNet parameters
[[-1.69 -0.64 -0.14 -0.1  -0.02 -0.01  0.04 -0.04  0.03  0.   -0.01 -0.01  0.37 -0.06
  -0.    0.03]
 [-1.31  0.09  0.75  0.15 -0.03  0.12  1.19 -0.16 -0.36  0.01  0.01 -0.02 -0.83 -0.05
  -0.05  0.06]]
SymNet parameters
[0.11 0.01]
SymNet parameters
[[-6.81e-01  1.26e-02 -3.86e-01  6.34e-02  5.94e-03  3.81e-02 -1.54e-01  3.03e-02
   3.24e-02 -3.67e-03 -3.58e-04  5.13e-03  1.61e-01  5.70e-01  3.12e-01 -5.95e-01
  -1.71e-01]]
SymNet parameters
[0.02]
SymNet parameters
[[-2.28e+00  4.84e-02 -2.35e-01 -1.93e-03 -9.08e-03  6.38e-03  5.06e-01 -3.52e-01
   9.87e-02  2.83e-02 -4.97e-02 -1.86e-01]
 [-9.13e-01 -1.42e-01 -2.69e-01  3.84e-03  5.94e-03 -1.24e-02 -4.57e-01 -2.15e+00
   1.45e-01  2.90e-03 -2.23e-01  3.17e-01]]
SymNet parameters
[ 0.14 -0.29]
SymNet parameters
[[-4.74e-01 -8.20e-02 -3.99e-03 -4.03e-03  7.42e-04  1.93e-03 -1.67e+00 -6.39e-01
   7.02e-02  2.18e-03  1.04e-03 -1.11e-02 -2.01e-03]
 [ 1.28e+00 -8.76e-02 -6.26e-03 -4.32e-03  8.90e-04  1.24e-03 -1.43e+00  1.60e-01
   3.23e-02  7.60e-04  6.22e-04 -1.12e-02 -1.44e-03]]
SymNet parameters
[0.38 0.1 ]
SymNet parameters
[[-2.11e-01  2.06e-02 -9.94e-03  1.08e-03  7.54e-04 -5.65e-05 -1.28e-01  8.61e-02
  -6.39e-02 -1.99e-03  3.84e-03  1.13e-02  7.20e-04  2.65e-03]
 [-1.73e-01 -1.91e-02 -1.98e-02 -1.65e-04  4.29e-04  1.60e-04  3.02e-01  1.05e-01
   7.49e-02  6.26e-04  1.24e-02  1.27e-02 -1.47e-03 -1.95e-03]]
SymNet parameters
[ 0.3  -0.04]
SymNet parameters
[[-6.44e-01 -4.62e-02 -2.71e-03 -2.60e-03  6.78e-04  1.81e-03 -2.27e+00  2.68e-01
  -1.45e-01  1.68e-03  2.13e-04 -1.03e-02 -7.94e-05  1.73e-02 -6.05e-04]
 [ 6.65e-01 -1.71e-02 -5.26e-03 -1.42e-03  3.00e-04  6.29e-04 -1.06e+00 -3.01e-01
  -1.74e-01  1.06e-03  3.17e-03 -1.17e-03  1.05e-03 -8.47e-03 -3.47e-01]]
SymNet parameters
[0.47 0.21]
SymNet parameters
[[-1.74e-01  5.94e-02 -3.13e-03  4.28e-03  8.74e-04 -1.06e-03  1.73e+00  1.87e-01
  -2.95e-01  9.46e-04  3.14e-03  1.43e-02 -5.80e-04  7.99e-02 -5.93e-02 -1.02e-01]
 [-5.96e-01  2.97e-01  3.29e-03  1.24e-02 -7.38e-04 -1.53e-03 -1.82e+00  2.95e-01
   3.59e-01  1.44e-03  2.42e-03  3.27e-02 -7.05e-03 -3.58e-02  1.07e+00  5.86e-02]]
SymNet parameters
[-0.33  0.17]
SymNet parameters
[[-5.83e-02 -7.65e-03  5.83e-03 -8.58e-04 -2.87e-04  6.04e-04 -2.92e-01 -1.18e-01
  -1.88e-01  5.18e-02 -2.72e-03  4.28e-02  1.74e-03  7.04e-01  5.62e-01 -9.81e-01
  -2.55e-01]]
SymNet parameters
[0.06]
finally, finish this stage
iter:  1318    time: 8.62
Func: 1.84e-02  |g|: 1.71e-03
stableloss: 1.35e-02   dataloss: 1.19e-02   sparseloss: 7.09e+01 momentloss: 6.45e+00
current expression:
[u00*u01, u10*v00, u02, u20, u00*u01**2, u00*u11*v00, u01*u10*v00, u10*v00*v10, u00, u10, u00**2, u00*u10, u01, u10*v00*v01, 1, u00**3, u20*v00**2, v00*v01, u00*v01, u10*v01]
[-0.98 -0.98  0.05  0.05  0.01  0.01  0.01  0.01  0.01 -0.01  0.   -0.   -0.    0.
 -0.   -0.    0.   -0.    0.    0.  ]
[v00*v10, u00*v01, v02, v20, v00, v00*v10**2, u00*v01*v10, u00*u01*v01, u00*v00*v11, u10*v00*v01, v00**3, u00, u01*v00, u10, u00**2, v10, u00*u10, u00*v00*v01, v00**2*v10, u01]
[-0.99 -0.98  0.05  0.05  0.02  0.01  0.01  0.01  0.01  0.01 -0.   -0.    0.    0.
 -0.   -0.    0.    0.    0.   -0.  ]
block:  2
name:  burgers-2-upwind-sparse0-noise0.001-id12
device:  cuda:0
generate a random number to check random seed:  -0.06043630690237245
current stage is: block-2
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.7904, device='cuda:0', dtype=torch.float64)
u_obs variance
tensor([ 0.2609,  1.6953,  1.6451, 22.1301,  9.7349, 19.2499,  0.2315,  1.4804,
         1.5946, 17.3988,  8.9987, 21.4353], device='cuda:0',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
iter:     0    time: 500.15
Func: 7.41e-02  |g|: 1.47e+00
stableloss: 1.40e-02   dataloss: 6.12e-02   sparseloss: 7.09e+01 momentloss: 6.45e+00
iter:   200    time: 14.54
Func: 6.25e-02  |g|: 6.98e-02
stableloss: 1.38e-02   dataloss: 4.82e-02   sparseloss: 7.12e+01 momentloss: 7.18e+00
iter:   400    time: 14.65
Func: 6.17e-02  |g|: 3.40e-02
stableloss: 1.37e-02   dataloss: 4.73e-02   sparseloss: 6.96e+01 momentloss: 7.18e+00
iter:   600    time: 14.72
Func: 6.10e-02  |g|: 2.75e-02
stableloss: 1.36e-02   dataloss: 4.68e-02   sparseloss: 7.17e+01 momentloss: 7.13e+00
iter:   800    time: 16.92
Func: 6.08e-02  |g|: 1.44e-02
stableloss: 1.37e-02   dataloss: 4.65e-02   sparseloss: 7.37e+01 momentloss: 7.16e+00
iter:  1000    time: 20.68
Func: 6.07e-02  |g|: 1.47e-02
stableloss: 1.37e-02   dataloss: 4.64e-02   sparseloss: 7.94e+01 momentloss: 7.16e+00
iter:  1200    time: 19.48
Func: 6.07e-02  |g|: 1.03e-02
stableloss: 1.37e-02   dataloss: 4.64e-02   sparseloss: 8.17e+01 momentloss: 7.15e+00
iter:  1400    time: 19.34
Func: 6.06e-02  |g|: 9.89e-03
stableloss: 1.37e-02   dataloss: 4.64e-02   sparseloss: 8.57e+01 momentloss: 7.13e+00
iter:  1600    time: 19.39
Func: 6.05e-02  |g|: 2.12e-02
stableloss: 1.38e-02   dataloss: 4.63e-02   sparseloss: 8.92e+01 momentloss: 7.10e+00
iter:  1800    time: 21.49
Func: 6.04e-02  |g|: 4.81e-03
stableloss: 1.38e-02   dataloss: 4.62e-02   sparseloss: 8.93e+01 momentloss: 7.10e+00
Warning: Maximum number of iterations has been exceeded.
         Current function value: 0.060421
         Iterations: 2000
         Function evaluations: 2014
         Gradient evaluations: 2004
convolution moment and kernels
[[ 1.00e+00  0.00e+00 -3.36e-05  5.23e-03 -1.08e-01]
 [ 0.00e+00 -1.83e-03  1.91e-03 -3.17e-03 -4.71e-02]
 [ 1.31e-03 -1.37e-03  5.48e-03 -3.14e-03 -1.48e-02]
 [-2.25e-03  1.67e-03  5.69e-02 -1.20e-04 -7.56e-03]
 [-4.53e-02 -4.98e-03  8.16e-03  1.18e-02  3.95e-03]]
[[ 3.44e-04 -3.18e-02  3.74e-02 -6.33e-02  1.31e-02]
 [ 1.22e-02  2.36e-02  3.51e-02  1.50e-01 -4.05e-02]
 [-9.46e-02  3.39e-01  3.51e-01  1.36e-01 -6.50e-03]
 [-2.47e-02  6.61e-02  3.14e-02  1.93e-01 -8.05e-02]
 [-4.11e-03  4.15e-02 -1.05e-01  1.19e-02  8.77e-03]]
[[ 0.00e+00  1.00e+00  0.00e+00 -1.14e-01 -8.68e-02]
 [ 0.00e+00  0.00e+00 -5.36e-03  1.34e-04 -1.69e-02]
 [ 0.00e+00  3.06e-02  4.85e-03  8.78e-03 -9.29e-03]
 [ 2.04e-04  4.77e-03  9.07e-03  5.19e-04  7.45e-05]
 [ 7.03e-03  1.33e-03 -2.14e-03 -7.74e-03 -4.33e-03]]
[[-3.14e-04  3.65e-03 -4.27e-03  1.63e-02 -8.43e-03]
 [-4.24e-03 -1.19e-02  4.66e-04 -4.44e-02  3.21e-02]
 [ 8.15e-02 -4.79e-01 -4.33e-01  1.13e+00 -2.57e-01]
 [-2.51e-02  5.04e-02 -7.25e-02  6.94e-03  1.20e-02]
 [ 1.89e-03  2.71e-03 -1.16e-02  2.07e-02 -6.53e-03]]
[[ 0.00e+00  0.00e+00  0.00e+00  3.82e-03  2.46e-02]
 [ 1.00e+00  0.00e+00  1.59e-03 -3.72e-03 -4.67e-02]
 [ 0.00e+00  2.31e-04 -8.48e-03  3.20e-03 -2.61e-03]
 [-1.03e-01 -1.65e-03  1.64e-02  1.68e-03 -1.69e-02]
 [-7.11e-02 -7.31e-03 -5.55e-03  3.34e-03 -1.99e-03]]
[[ 2.35e-03 -2.21e-02  1.13e-01 -3.46e-02  5.36e-03]
 [ 2.13e-02 -6.34e-02 -4.39e-01 -1.62e-02  1.17e-02]
 [ 8.62e-03 -4.77e-02 -2.80e-01 -1.39e-01  3.19e-02]
 [-1.85e-04 -8.55e-04  1.01e+00  6.73e-02 -1.87e-02]
 [-9.37e-03  3.92e-02 -2.52e-01  1.99e-02 -3.78e-03]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00 -8.77e-03]
 [ 0.00e+00  0.00e+00  0.00e+00 -1.86e-03  6.61e-03]
 [ 0.00e+00  0.00e+00  6.51e-03  5.93e-03 -7.11e-03]
 [ 0.00e+00 -3.64e-03  2.13e-03  2.98e-03 -4.86e-03]
 [ 3.92e-03  4.87e-03 -2.31e-03 -3.02e-03 -6.91e-04]]
[[ 6.35e-03 -2.64e-02  3.10e-02 -7.14e-03  7.28e-05]
 [-3.17e-02  1.30e-01 -1.62e-01  5.11e-02 -3.63e-03]
 [-5.70e-02  1.22e+00 -2.37e+00  1.33e+00 -9.49e-02]
 [-7.97e-03  3.72e-02 -3.99e-02 -1.54e-02  1.04e-02]
 [-1.74e-03  6.03e-03 -1.01e-02  1.38e-02 -4.12e-03]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00 -5.96e-04]
 [ 0.00e+00  1.00e+00  0.00e+00 -1.79e-03 -1.87e-01]
 [ 0.00e+00  0.00e+00 -9.68e-05  8.28e-04 -1.98e-03]
 [ 0.00e+00 -3.80e-04 -1.88e-03  3.10e-03  9.83e-03]
 [ 8.72e-04  3.64e-05 -2.11e-03 -3.43e-03  1.93e-02]]
[[ 0.01 -0.06 -0.    0.06 -0.01]
 [-0.01  0.25  0.31 -0.68  0.12]
 [ 0.13 -0.52  0.76 -0.47  0.11]
 [-0.16  0.44 -1.32  1.31 -0.27]
 [ 0.03 -0.11  0.25 -0.22  0.05]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  1.21e-01]
 [ 0.00e+00  0.00e+00  0.00e+00  1.98e-04  4.54e-03]
 [ 1.00e+00  0.00e+00  1.93e-03  3.53e-03 -1.13e-03]
 [ 0.00e+00 -1.49e-03  2.86e-03 -3.26e-05 -6.06e-03]
 [ 3.11e-03  8.07e-03  3.36e-04 -4.47e-03 -3.61e-03]]
[[ 0.   -0.01 -0.08  0.01 -0.  ]
 [-0.01  0.04  1.33 -0.05  0.02]
 [ 0.12 -0.48 -1.86 -0.35  0.08]
 [ 0.01 -0.05  1.46 -0.13  0.04]
 [-0.    0.02 -0.13  0.04 -0.01]]
SymNet parameters
[[ 1.51e-01 -4.94e-03  3.92e-03  1.15e-03  5.42e-05  4.23e-04  1.00e-02  1.35e-03
  -2.23e-02  5.54e-04 -2.33e-04 -2.48e-04]
 [-1.49e-01  1.93e-01  6.24e-01 -2.25e-03 -9.77e-02  8.06e-03 -9.32e-02  1.86e-03
  -2.50e-02 -1.97e-02 -1.95e-03 -9.05e-04]]
SymNet parameters
[-0.06 -0.99]
SymNet parameters
[[-7.70e-01 -9.08e-01  2.45e-01 -3.21e-01  1.29e-02  4.80e-02  1.54e+00 -8.96e-02
   4.37e-02  2.60e-03  5.69e-03 -5.43e-04 -1.47e+00]
 [ 2.00e+00 -1.01e-01  1.92e-01  5.12e-02  2.90e-02  5.30e-02  1.95e+00  5.18e-03
   1.67e-01  7.74e-02  2.62e-02 -2.90e-02 -3.43e+00]]
SymNet parameters
[-0.65 -0.7 ]
SymNet parameters
[[-1.36e+00  3.56e-02 -8.62e-02 -7.28e-02  3.82e-03  1.26e-02 -1.43e-01  4.33e-02
   3.09e-02  1.97e-03  5.45e-03  5.55e-04 -4.18e-01 -1.46e-02]
 [-9.78e-01  1.65e+00  1.45e+00  1.20e-01 -1.53e-02 -1.91e-02 -8.58e-01 -1.78e-01
  -1.00e-01 -6.15e-03 -1.27e-02 -3.11e-03  1.51e+00  2.16e-02]]
SymNet parameters
[-0.1  -0.31]
SymNet parameters
[[-9.34e-01  4.32e-01 -1.56e+00  1.38e-01  7.38e-04 -1.90e-02 -6.44e-01 -4.66e-02
  -5.29e-03  1.08e-03 -4.25e-03  2.92e-04 -5.56e-01  2.01e-02 -3.90e-02]
 [ 9.53e-01  2.18e-01  1.08e-02  1.51e-01 -7.50e-03 -2.18e-02 -2.71e+00 -7.98e-02
  -4.67e-02  2.48e-03 -8.45e-03 -3.38e-04  6.85e-01  2.63e-02 -2.97e-03]]
SymNet parameters
[0.41 1.66]
SymNet parameters
[[-1.60e+00 -9.16e-01  4.64e-01 -1.44e-01  1.06e-03  1.13e-02  1.38e+00  8.62e-02
   1.08e-02 -1.37e-02  6.03e-03  3.81e-03  3.95e-01 -4.75e-02  1.39e-02  1.62e-02]
 [-2.69e+00  5.42e-02 -5.27e-01  5.46e-01 -9.65e-03 -5.59e-02 -1.97e+00 -2.76e-01
  -8.78e-02  2.79e-02 -1.28e-02 -1.39e-02  4.60e-01  7.82e-02 -7.24e-02  1.93e-02]]
SymNet parameters
[-0.12  0.01]
SymNet parameters
[[-3.58e-01  2.33e-01 -6.73e-01  1.12e-01  3.04e-04  4.55e-02 -4.49e-01 -3.37e-02
  -1.03e-03  2.95e-03 -2.39e-03 -8.65e-04 -2.48e-01  6.52e-02  2.30e-01 -2.83e-01
  -1.11e-01]]
SymNet parameters
[0.15]
SymNet parameters
[[-2.57  0.06 -0.26  0.02 -0.   -0.01 -0.49  0.01 -0.14 -0.02 -0.   -0.06]
 [ 0.55 -0.15 -0.14  0.01  0.03 -0.02  1.13 -2.39  1.02  0.05 -0.32  0.26]]
SymNet parameters
[ 0.12 -0.29]
SymNet parameters
[[-2.99e-01 -1.18e-01  8.85e-03 -1.62e-03 -2.57e-03  3.67e-03 -1.02e+00 -7.89e-01
   1.09e-01  2.64e-04  1.96e-02 -2.91e-02  1.83e-03]
 [ 1.75e+00 -8.89e-02 -4.68e-03 -3.69e-03 -2.56e-03  2.75e-03 -6.02e-01  5.03e-02
  -4.00e-03 -2.87e-04  1.11e-02 -2.00e-02  6.12e-04]]
SymNet parameters
[0.17 0.2 ]
SymNet parameters
[[-1.18e-01  6.44e-03 -1.53e-02  1.52e-03  2.64e-04 -1.81e-04 -6.15e-02  3.06e-02
  -3.68e-02 -4.20e-05  2.02e-03  6.20e-03 -3.86e-04 -2.84e-03]
 [-5.00e-02 -2.82e-02 -1.38e-02  2.86e-03  5.67e-03  3.78e-04  3.27e-01  5.01e-02
   2.43e-01  1.78e-02 -5.18e-03  5.45e-02 -2.16e-03  4.36e-03]]
SymNet parameters
[0.26 0.3 ]
SymNet parameters
[[-7.39e-01 -5.66e-02  8.99e-03 -5.14e-04 -1.85e-03  3.46e-03 -1.84e+00  1.87e-01
  -2.21e-01  4.01e-03  5.94e-03 -1.84e-02  3.13e-03  2.07e-02  2.71e-01]
 [ 9.73e-01 -4.09e-02 -1.25e-02 -6.52e-04  9.49e-05 -1.22e-03 -5.46e-01 -3.16e-01
  -2.50e-01  4.52e-04  8.47e-03  3.40e-03  6.11e-03 -1.34e-02 -8.63e-01]]
SymNet parameters
[0.43 0.16]
SymNet parameters
[[-1.19e+00  9.08e-02  1.05e-02  1.73e-03  1.44e-03  4.37e-03  1.10e+00  5.01e-01
  -7.60e-01  8.45e-03 -1.82e-02  1.08e-02  5.52e-05  1.05e-01  4.89e-01 -6.79e-02]
 [-1.16e+00  1.97e-01  4.22e-03  4.14e-03  2.89e-03 -2.73e-03 -2.12e+00  2.36e-01
   2.50e-01  4.34e-03 -2.75e-02  2.04e-02 -8.96e-03 -6.69e-03  1.04e+00  4.78e-02]]
SymNet parameters
[-0.    0.42]
SymNet parameters
[[ 3.54e-02  1.44e-02 -1.53e-03  1.04e-04 -5.33e-04 -1.25e-04 -5.22e-02  3.66e-02
  -2.11e-01  5.33e-02 -3.00e-03  5.11e-02 -4.80e-03  5.66e-01 -1.39e-01 -8.15e-01
  -2.27e-01]]
SymNet parameters
[0.03]
finally, finish this stage
iter:  2000    time: 14.29
Func: 6.04e-02  |g|: 9.12e-04
stableloss: 1.38e-02   dataloss: 4.62e-02   sparseloss: 8.96e+01 momentloss: 7.10e+00
current expression:
[u00*u01, u10*v00, u20, u02, u00, u00*u01**2, u00*u11*v00, u10*v00*v10, u01*u10*v00, u00**3, u00*u10*v01, u01*v00, v00**2, u00*v00*v02, u00*v00*v01, u10, u02*v00**2, u01*v00*v10, v00*v10, u00*v00**2]
[-0.98 -0.97  0.05  0.05  0.02  0.01  0.01  0.01  0.01 -0.01  0.01  0.   -0.    0.
 -0.    0.    0.    0.    0.    0.  ]
[v00*v10, u00*v01, v02, v20, v00*v10**2, v00, u00*u01*v01, u00*v00*v11, u00*v01*v10, u10*v00*v01, v00**2, v00**3, 1, v00**3*v10, v00*v01, u00*v00*v10, u00**2*v00, u00*v00**2*v01, u00**2*v20, u10*v00**2]
[-0.98 -0.97  0.05  0.05  0.01  0.01  0.01  0.01  0.01  0.01 -0.01 -0.01  0.    0.
 -0.   -0.    0.    0.    0.    0.  ]
block:  3
name:  burgers-2-upwind-sparse0-noise0.001-id12
device:  cuda:0
generate a random number to check random seed:  1.0323818900713282
current stage is: block-3
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.9162, device='cuda:0', dtype=torch.float64)
u_obs variance
tensor([ 0.2489,  1.6647,  1.6989, 21.6841, 10.5757, 19.0312,  0.2601,  1.7017,
         1.8886, 19.8952, 11.3927, 23.1409], device='cuda:0',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
iter:     0    time: 1788.91
Func: 1.59e-01  |g|: 4.34e+00
stableloss: 2.72e-02   dataloss: 1.38e-01   sparseloss: 8.96e+01 momentloss: 7.10e+00
iter:   200    time: 18.62
Func: 1.20e-01  |g|: 1.95e-01
stableloss: 2.62e-02   dataloss: 9.94e-02   sparseloss: 8.98e+01 momentloss: 6.95e+00
iter:   400    time: 18.38
Func: 1.18e-01  |g|: 1.71e-01
stableloss: 2.59e-02   dataloss: 9.66e-02   sparseloss: 8.62e+01 momentloss: 7.07e+00
iter:   600    time: 18.33
Func: 1.17e-01  |g|: 9.96e-02
stableloss: 2.56e-02   dataloss: 9.57e-02   sparseloss: 8.64e+01 momentloss: 6.98e+00
iter:   800    time: 18.39
Func: 1.16e-01  |g|: 8.81e-02
stableloss: 2.54e-02   dataloss: 9.52e-02   sparseloss: 8.83e+01 momentloss: 7.00e+00
iter:  1000    time: 18.33
Func: 1.16e-01  |g|: 5.80e-02
stableloss: 2.55e-02   dataloss: 9.51e-02   sparseloss: 8.87e+01 momentloss: 7.01e+00
iter:  1200    time: 18.29
Func: 1.16e-01  |g|: 3.94e-02
stableloss: 2.55e-02   dataloss: 9.50e-02   sparseloss: 8.80e+01 momentloss: 7.02e+00
iter:  1400    time: 18.36
Func: 1.16e-01  |g|: 1.82e-01
stableloss: 2.57e-02   dataloss: 9.47e-02   sparseloss: 9.21e+01 momentloss: 7.00e+00
iter:  1600    time: 18.27
Func: 1.15e-01  |g|: 1.13e-01
stableloss: 2.55e-02   dataloss: 9.42e-02   sparseloss: 9.50e+01 momentloss: 6.99e+00
iter:  1800    time: 18.30
Func: 1.14e-01  |g|: 1.01e-01
stableloss: 2.57e-02   dataloss: 9.34e-02   sparseloss: 9.36e+01 momentloss: 6.99e+00
Warning: Maximum number of iterations has been exceeded.
         Current function value: 0.114173
         Iterations: 2000
         Function evaluations: 2015
         Gradient evaluations: 2006
convolution moment and kernels
[[ 1.00e+00  0.00e+00 -1.32e-03 -1.01e-01 -7.54e-02]
 [ 0.00e+00  1.17e-05  3.15e-04  4.88e-03 -1.99e-02]
 [ 1.45e-03  6.71e-03  7.74e-03  7.29e-03  1.10e-03]
 [-3.80e-02  6.11e-04  2.28e-03 -1.93e-03  4.29e-03]
 [-5.65e-02 -4.89e-03  4.41e-03 -1.12e-02  9.05e-03]]
[[ 9.67e-03 -2.37e-02 -1.32e-02 -1.05e-02  2.14e-04]
 [-3.90e-02  9.17e-02  9.97e-02  3.20e-02  5.43e-03]
 [ 6.48e-02 -5.20e-02  5.00e-01  2.58e-01 -1.13e-01]
 [-7.90e-02  2.38e-01 -2.44e-02  1.56e-01 -2.40e-02]
 [ 1.85e-02 -5.43e-02 -1.12e-02 -3.48e-02  6.20e-03]]
[[ 0.00e+00  1.00e+00  0.00e+00 -8.93e-02 -3.50e-02]
 [ 0.00e+00  0.00e+00 -5.74e-03 -2.92e-03 -1.23e-02]
 [ 0.00e+00  2.24e-02  1.90e-03  4.29e-02  3.24e-03]
 [-8.73e-04 -3.44e-03  4.59e-03 -1.50e-03 -6.28e-04]
 [ 2.74e-03 -3.08e-02 -7.30e-03 -8.36e-03 -1.94e-03]]
[[ 0.    0.01  0.01 -0.01 -0.01]
 [-0.02 -0.03  0.01 -0.02  0.05]
 [ 0.14 -0.6  -0.19  0.91 -0.24]
 [-0.03 -0.   -0.04  0.03  0.03]
 [ 0.    0.01  0.01 -0.01 -0.  ]]
[[ 0.00e+00  0.00e+00  0.00e+00 -2.21e-02 -1.35e-04]
 [ 1.00e+00  0.00e+00  1.58e-02 -7.64e-03 -2.47e-02]
 [ 0.00e+00  2.08e-03  9.97e-03  6.91e-04 -1.22e-03]
 [-7.67e-02  5.48e-04  1.47e-02  5.85e-03 -2.99e-02]
 [-4.55e-02 -3.90e-03 -2.49e-03 -1.88e-03 -2.97e-03]]
[[ 0.01 -0.06  0.16 -0.05  0.01]
 [-0.01  0.06 -0.65  0.04  0.  ]
 [ 0.   -0.01 -0.26  0.02 -0.03]
 [ 0.02 -0.08  1.02 -0.05  0.02]
 [-0.02  0.07 -0.27  0.06 -0.01]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00 -1.49e-01]
 [ 0.00e+00  0.00e+00  0.00e+00  9.21e-04  4.72e-03]
 [ 0.00e+00  0.00e+00  6.81e-03 -4.71e-03 -6.61e-03]
 [ 0.00e+00  9.33e-04  3.56e-04 -1.91e-03 -1.95e-03]
 [ 3.88e-03 -6.15e-03 -4.83e-03  7.39e-03  6.24e-03]]
[[ 3.66e-03 -2.68e-02  6.67e-02 -5.33e-02  1.36e-02]
 [-1.99e-02  1.38e-01 -3.21e-01  2.49e-01 -6.26e-02]
 [-2.06e-01  1.73e+00 -2.93e+00  1.57e+00 -1.44e-01]
 [-1.24e-02  1.03e-01 -2.58e-01  2.01e-01 -4.96e-02]
 [ 2.00e-03 -1.81e-02  4.95e-02 -3.92e-02  9.70e-03]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  1.51e-03]
 [ 0.00e+00  1.00e+00  0.00e+00 -2.98e-03 -7.20e-04]
 [ 0.00e+00  0.00e+00  2.77e-05 -1.16e-03 -2.36e-03]
 [ 0.00e+00 -2.88e-03  4.54e-03  4.73e-03 -3.49e-03]
 [-1.71e-03  4.71e-03 -1.46e-04 -2.57e-03  2.30e-03]]
[[ 0.01 -0.08  0.03  0.04 -0.01]
 [-0.08  0.54 -0.1  -0.41  0.05]
 [ 0.03 -0.12  0.12 -0.05  0.01]
 [ 0.04 -0.4  -0.04  0.46 -0.06]
 [-0.01  0.05 -0.   -0.05  0.01]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  1.27e-01]
 [ 0.00e+00  0.00e+00  0.00e+00 -1.41e-03  9.71e-03]
 [ 1.00e+00  0.00e+00  1.97e-03 -2.44e-03 -3.94e-03]
 [ 0.00e+00  8.28e-04  2.41e-03  1.35e-04 -8.79e-03]
 [-1.17e-02  1.35e-03  6.37e-03  2.02e-03 -1.15e-02]]
[[-0.01  0.03 -0.14  0.03 -0.01]
 [ 0.03 -0.14  1.59 -0.12  0.02]
 [ 0.06 -0.21 -2.25 -0.24  0.07]
 [ 0.06 -0.27  1.78 -0.25  0.05]
 [-0.02  0.08 -0.21  0.07 -0.02]]
SymNet parameters
[[ 4.40e-01 -2.07e-02 -2.66e-02  5.23e-03 -2.62e-03 -1.08e-02 -2.71e-02 -6.63e-03
  -3.03e-02 -6.07e-04  8.80e-04  4.84e-04]
 [ 6.88e-02  5.18e-03  8.42e-02  2.56e-03 -9.18e-03  5.34e-04  6.09e-02 -1.17e-02
   6.97e-03  1.29e-05  3.71e-04 -3.56e-05]]
SymNet parameters
[-0.13 -1.25]
SymNet parameters
[[ 4.51e-02 -2.73e-01 -3.67e-01 -1.46e-01  2.78e-02  1.49e-02  2.16e+00  1.21e-01
   1.71e-02  8.55e-03 -7.36e-03 -4.98e-03 -4.24e-01]
 [ 2.63e+00 -2.46e-01 -4.43e-01  8.73e-02  3.08e-03  6.23e-02  6.79e-01 -7.38e-02
   1.18e-01 -1.81e-03 -1.33e-03 -1.86e-03 -4.23e+00]]
SymNet parameters
[-0.57 -1.02]
SymNet parameters
[[-1.85e+00  4.66e-02  2.13e-01 -6.00e-02  4.10e-03  1.46e-02 -3.79e-01  8.52e-02
  -1.09e-01  3.18e-04 -4.16e-03 -8.51e-04  1.47e+00 -2.12e-03]
 [ 1.12e-02  5.42e-01  3.15e-01  1.08e-01 -1.48e-02 -1.71e-02 -2.00e+00 -1.95e-01
   1.26e-03 -4.10e-03  1.06e-02  4.32e-03  3.62e-01  5.43e-03]]
SymNet parameters
[0.03 0.48]
SymNet parameters
[[-1.25e+00  1.44e-01 -6.23e-01  1.45e-02  4.31e-03  1.55e-02 -3.48e-01 -1.28e-02
   4.40e-02 -9.97e-04  2.82e-04 -6.40e-05 -1.26e+00  2.83e-02 -4.16e-02]
 [-2.67e-01 -4.16e-01 -9.63e-02 -4.83e-02  3.82e-03  3.63e-03 -3.64e+00  8.19e-02
   1.97e-02  6.29e-03 -2.08e-03  1.21e-03 -1.02e-01 -5.45e-02  1.22e-01]]
SymNet parameters
[1.11 1.28]
SymNet parameters
[[-1.86e+00 -1.15e-01  4.34e-02 -3.91e-02  1.47e-03 -5.67e-03  4.76e-01  3.34e-02
  -2.50e-02  6.09e-04 -1.97e-03  1.62e-04  7.62e-01 -6.12e-03 -1.13e-02  4.86e-03]
 [ 2.73e-01 -2.91e+00  1.92e+00  6.18e-01 -1.03e-01 -7.04e-02 -5.58e+00 -6.41e-01
  -7.71e-02 -4.00e-02  3.79e-02  1.95e-02  2.01e+00  2.94e-02 -4.35e-02  1.23e-01]]
SymNet parameters
[ 0.31 -1.29]
SymNet parameters
[[ 1.05e-01 -2.83e-01 -3.30e-01  4.34e-02  3.39e-03  5.77e-02 -8.19e-01  1.00e-02
   2.87e-02  1.94e-03 -2.66e-04 -4.87e-05 -6.76e-01  1.29e-01  9.63e-02 -3.00e-01
  -9.13e-02]]
SymNet parameters
[0.27]
SymNet parameters
[[-2.23e+00  1.27e-01 -9.07e-02  4.12e-04 -6.76e-04 -7.96e-05  7.78e-02 -2.49e-03
  -7.08e-02 -1.42e-02 -1.84e-02  1.03e-02]
 [-3.02e-01 -3.59e-01 -1.15e-01  1.21e-02  3.00e-03 -1.12e-02 -4.17e-01 -2.95e+00
   8.09e-02  6.61e-02 -7.10e-02  4.98e-02]]
SymNet parameters
[-0.21 -0.14]
SymNet parameters
[[-2.50e-01 -7.77e-02 -2.56e-02  9.20e-03 -1.76e-03 -4.65e-03 -1.33e-01 -8.45e-01
   6.94e-02 -2.18e-02  2.80e-05  4.53e-03 -2.61e-03]
 [ 1.59e+00 -6.37e-02 -3.31e-02  6.12e-03 -1.51e-03 -3.82e-03 -9.01e-02  1.33e-02
   5.50e-02 -1.46e-02 -3.90e-03  4.51e-03 -2.08e-05]]
SymNet parameters
[-0.08  0.3 ]
SymNet parameters
[[-3.09e-02  2.34e-03 -1.21e-04  5.77e-05  8.00e-05 -1.14e-04 -5.80e-03  6.60e-03
  -1.91e-03 -7.42e-04 -8.61e-04  1.90e-03  3.42e-04  2.35e-03]
 [ 1.51e+00 -9.44e-02 -8.84e-02  8.57e-03  9.74e-03 -7.77e-03 -2.93e-01 -8.06e-01
   2.97e-02  4.07e-02  5.63e-02  1.36e-01 -1.08e-02 -1.65e-01]]
SymNet parameters
[ 0.17 -0.05]
SymNet parameters
[[-4.05e-01 -6.91e-02 -2.31e-02  8.29e-03 -1.34e-03 -4.30e-03 -1.99e+00  1.03e-01
  -4.27e-02 -1.35e-02 -1.53e-03  5.80e-03  3.89e-03  2.10e-03 -1.09e-01]
 [ 1.37e+00 -6.05e-02 -3.31e-02  1.06e-02 -7.11e-04 -4.79e-03 -8.33e-02 -5.58e-01
  -3.99e-01 -1.11e-02  1.02e-02  2.71e-02 -5.91e-03 -1.10e-01 -9.90e-01]]
SymNet parameters
[ 0.49 -0.01]
SymNet parameters
[[-2.19e+00  6.80e-02  1.05e-02 -2.09e-02  1.01e-02  5.30e-03 -2.83e-02  7.93e-01
  -1.41e+00  6.14e-02  1.90e-02  3.90e-02  6.91e-02  4.33e-01 -2.11e+00  5.56e-03]
 [-1.39e-01  1.32e-01  4.42e-02 -1.59e-02  1.49e-03  6.58e-03 -3.23e+00  1.89e-01
   6.89e-02  3.23e-02  4.40e-03 -1.49e-02 -6.48e-03 -3.45e-02  1.77e-01  8.42e-02]]
SymNet parameters
[0.21 1.06]
SymNet parameters
[[ 1.45e-01  1.08e-02  6.02e-04 -6.06e-04 -4.81e-04  4.41e-04 -7.13e-02  1.38e-01
  -2.92e-01  5.49e-02  4.06e-03  5.35e-02 -1.05e-02  5.89e-01 -2.94e-01 -5.36e-01
  -1.19e-01]]
SymNet parameters
[0.04]
finally, finish this stage
iter:  2000    time: 18.38
Func: 1.14e-01  |g|: 1.84e-02
stableloss: 2.57e-02   dataloss: 9.32e-02   sparseloss: 9.47e+01 momentloss: 6.99e+00
current expression:
[u00*u01, u10*v00, u20, u02, u00*u01**2, u10*v00*v10, u00, u00*u11*v00, u01*u10*v00, u01, u10*v01, u00*u10*v01, u01**2, u00*u01*v01, u20*v00**2, u00**2*u01, 1, u00**2*u02, u00**3, u00**2]
[-0.99 -0.98  0.05  0.05  0.01  0.01  0.01  0.01  0.01 -0.01  0.01  0.01  0.01 -0.01
  0.    0.    0.    0.   -0.   -0.  ]
[v00*v10, u00*v01, v02, v20, v00*v10**2, u00*v01*v10, u00*v00*v11, u00*u01*v01, u10*v00*v01, v00, v01*v10, u01*v01, u00*v00*v10, u00, v01, u00**2, u00**2*v02, v00**3, v00**2*v20, v00**2*v01]
[-0.98 -0.98  0.05  0.05  0.01  0.01  0.01  0.01  0.01  0.01  0.01  0.01  0.01 -0.
 -0.    0.    0.   -0.    0.   -0.  ]
block:  4
name:  burgers-2-upwind-sparse0-noise0.001-id12
device:  cuda:0
generate a random number to check random seed:  0.8044817088341221
current stage is: block-4
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.9453, device='cuda:0', dtype=torch.float64)
u_obs variance
tensor([ 0.2555,  1.7857,  1.6721, 29.8872, 10.9298, 19.6148,  0.2582,  1.5134,
         1.6169, 20.9362,  9.4819, 21.8161], device='cuda:0',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 0.272092
         Iterations: 0
         Function evaluations: 15
         Gradient evaluations: 3
convolution moment and kernels
[[ 1.00e+00  0.00e+00 -1.32e-03 -1.01e-01 -7.54e-02]
 [ 0.00e+00  1.40e-05  3.15e-04  4.88e-03 -1.99e-02]
 [ 1.46e-03  6.71e-03  7.73e-03  7.29e-03  1.10e-03]
 [-3.80e-02  6.11e-04  2.28e-03 -1.93e-03  4.28e-03]
 [-5.65e-02 -4.89e-03  4.42e-03 -1.12e-02  9.05e-03]]
[[ 9.66e-03 -2.37e-02 -1.33e-02 -1.05e-02  2.13e-04]
 [-3.89e-02  9.16e-02  9.99e-02  3.19e-02  5.43e-03]
 [ 6.47e-02 -5.18e-02  5.00e-01  2.58e-01 -1.13e-01]
 [-7.89e-02  2.37e-01 -2.41e-02  1.55e-01 -2.40e-02]
 [ 1.85e-02 -5.42e-02 -1.13e-02 -3.48e-02  6.20e-03]]
[[ 0.00e+00  1.00e+00  0.00e+00 -8.93e-02 -3.50e-02]
 [ 0.00e+00  0.00e+00 -5.74e-03 -2.92e-03 -1.23e-02]
 [ 0.00e+00  2.24e-02  1.90e-03  4.29e-02  3.25e-03]
 [-8.66e-04 -3.44e-03  4.59e-03 -1.50e-03 -6.37e-04]
 [ 2.72e-03 -3.07e-02 -7.28e-03 -8.38e-03 -1.96e-03]]
[[ 0.    0.01  0.01 -0.01 -0.01]
 [-0.02 -0.03  0.01 -0.02  0.05]
 [ 0.14 -0.6  -0.19  0.91 -0.24]
 [-0.03 -0.   -0.04  0.03  0.03]
 [ 0.    0.01  0.   -0.01 -0.  ]]
[[ 0.00e+00  0.00e+00  0.00e+00 -2.21e-02 -1.42e-04]
 [ 1.00e+00  0.00e+00  1.58e-02 -7.64e-03 -2.47e-02]
 [ 0.00e+00  2.08e-03  9.97e-03  6.92e-04 -1.22e-03]
 [-7.67e-02  5.47e-04  1.47e-02  5.85e-03 -2.99e-02]
 [-4.55e-02 -3.89e-03 -2.48e-03 -1.88e-03 -2.98e-03]]
[[ 0.01 -0.06  0.16 -0.05  0.01]
 [-0.01  0.06 -0.65  0.04  0.  ]
 [ 0.   -0.01 -0.26  0.02 -0.03]
 [ 0.02 -0.08  1.02 -0.06  0.02]
 [-0.02  0.07 -0.27  0.06 -0.01]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00 -1.49e-01]
 [ 0.00e+00  0.00e+00  0.00e+00  9.20e-04  4.72e-03]
 [ 0.00e+00  0.00e+00  6.81e-03 -4.71e-03 -6.61e-03]
 [ 0.00e+00  9.32e-04  3.56e-04 -1.91e-03 -1.95e-03]
 [ 3.88e-03 -6.15e-03 -4.83e-03  7.39e-03  6.23e-03]]
[[ 3.66e-03 -2.68e-02  6.67e-02 -5.33e-02  1.36e-02]
 [-1.99e-02  1.38e-01 -3.20e-01  2.49e-01 -6.26e-02]
 [-2.06e-01  1.73e+00 -2.93e+00  1.57e+00 -1.44e-01]
 [-1.24e-02  1.03e-01 -2.58e-01  2.01e-01 -4.96e-02]
 [ 2.00e-03 -1.81e-02  4.94e-02 -3.92e-02  9.70e-03]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  1.51e-03]
 [ 0.00e+00  1.00e+00  0.00e+00 -2.98e-03 -7.20e-04]
 [ 0.00e+00  0.00e+00  2.70e-05 -1.16e-03 -2.36e-03]
 [ 0.00e+00 -2.88e-03  4.54e-03  4.73e-03 -3.49e-03]
 [-1.71e-03  4.71e-03 -1.44e-04 -2.57e-03  2.29e-03]]
[[ 0.01 -0.08  0.03  0.04 -0.01]
 [-0.08  0.54 -0.1  -0.41  0.05]
 [ 0.03 -0.12  0.12 -0.05  0.01]
 [ 0.04 -0.4  -0.04  0.46 -0.06]
 [-0.01  0.05 -0.   -0.05  0.01]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  1.27e-01]
 [ 0.00e+00  0.00e+00  0.00e+00 -1.41e-03  9.71e-03]
 [ 1.00e+00  0.00e+00  1.97e-03 -2.44e-03 -3.94e-03]
 [ 0.00e+00  8.28e-04  2.41e-03  1.35e-04 -8.79e-03]
 [-1.17e-02  1.35e-03  6.37e-03  2.02e-03 -1.15e-02]]
[[-0.01  0.03 -0.14  0.03 -0.01]
 [ 0.03 -0.14  1.59 -0.12  0.02]
 [ 0.06 -0.21 -2.25 -0.24  0.07]
 [ 0.06 -0.27  1.78 -0.25  0.05]
 [-0.02  0.08 -0.21  0.07 -0.02]]
SymNet parameters
[[ 4.40e-01 -2.07e-02 -2.66e-02  5.31e-03 -2.61e-03 -1.08e-02 -2.71e-02 -6.59e-03
  -3.03e-02 -6.20e-04  9.14e-04  4.95e-04]
 [ 6.88e-02  5.17e-03  8.42e-02  2.54e-03 -9.16e-03  5.04e-04  6.09e-02 -1.17e-02
   6.97e-03  4.05e-05  3.69e-04 -6.03e-05]]
SymNet parameters
[-0.13 -1.25]
SymNet parameters
[[ 4.51e-02 -2.73e-01 -3.67e-01 -1.46e-01  2.78e-02  1.49e-02  2.16e+00  1.21e-01
   1.71e-02  8.54e-03 -7.37e-03 -5.00e-03 -4.24e-01]
 [ 2.63e+00 -2.46e-01 -4.43e-01  8.74e-02  3.08e-03  6.23e-02  6.79e-01 -7.38e-02
   1.18e-01 -1.81e-03 -1.32e-03 -1.86e-03 -4.23e+00]]
SymNet parameters
[-0.57 -1.02]
SymNet parameters
[[-1.85e+00  4.66e-02  2.13e-01 -6.00e-02  4.10e-03  1.46e-02 -3.79e-01  8.52e-02
  -1.09e-01  3.27e-04 -4.16e-03 -8.48e-04  1.47e+00 -2.14e-03]
 [ 1.12e-02  5.42e-01  3.15e-01  1.08e-01 -1.48e-02 -1.71e-02 -2.00e+00 -1.95e-01
   1.26e-03 -4.10e-03  1.06e-02  4.33e-03  3.62e-01  5.40e-03]]
SymNet parameters
[0.03 0.48]
SymNet parameters
[[-1.25e+00  1.44e-01 -6.23e-01  1.45e-02  4.32e-03  1.55e-02 -3.48e-01 -1.28e-02
   4.40e-02 -9.92e-04  3.02e-04 -6.66e-05 -1.26e+00  2.85e-02 -4.16e-02]
 [-2.67e-01 -4.16e-01 -9.63e-02 -4.83e-02  3.82e-03  3.62e-03 -3.64e+00  8.19e-02
   1.97e-02  6.28e-03 -2.09e-03  1.20e-03 -1.02e-01 -5.45e-02  1.22e-01]]
SymNet parameters
[1.11 1.28]
SymNet parameters
[[-1.86e+00 -1.15e-01  4.34e-02 -3.91e-02  1.47e-03 -5.68e-03  4.76e-01  3.34e-02
  -2.50e-02  6.20e-04 -1.95e-03  1.57e-04  7.62e-01 -5.96e-03 -1.12e-02  4.89e-03]
 [ 2.73e-01 -2.91e+00  1.92e+00  6.18e-01 -1.03e-01 -7.04e-02 -5.58e+00 -6.41e-01
  -7.71e-02 -4.00e-02  3.79e-02  1.95e-02  2.01e+00  2.94e-02 -4.35e-02  1.23e-01]]
SymNet parameters
[ 0.31 -1.29]
SymNet parameters
[[ 1.05e-01 -2.83e-01 -3.30e-01  4.34e-02  3.40e-03  5.77e-02 -8.19e-01  1.00e-02
   2.87e-02  1.95e-03 -2.79e-04 -3.88e-05 -6.76e-01  1.29e-01  9.63e-02 -3.00e-01
  -9.13e-02]]
SymNet parameters
[0.27]
SymNet parameters
[[-2.23e+00  1.27e-01 -9.07e-02  4.16e-04 -6.74e-04 -7.97e-05  7.78e-02 -2.49e-03
  -7.08e-02 -1.42e-02 -1.84e-02  1.03e-02]
 [-3.02e-01 -3.59e-01 -1.15e-01  1.21e-02  3.00e-03 -1.12e-02 -4.17e-01 -2.95e+00
   8.09e-02  6.61e-02 -7.10e-02  4.97e-02]]
SymNet parameters
[-0.21 -0.14]
SymNet parameters
[[-2.50e-01 -7.77e-02 -2.56e-02  9.19e-03 -1.77e-03 -4.66e-03 -1.33e-01 -8.45e-01
   6.94e-02 -2.18e-02  6.44e-06  4.52e-03 -2.77e-03]
 [ 1.59e+00 -6.37e-02 -3.31e-02  6.11e-03 -1.51e-03 -3.82e-03 -9.01e-02  1.33e-02
   5.50e-02 -1.46e-02 -3.91e-03  4.51e-03  6.21e-05]]
SymNet parameters
[-0.08  0.3 ]
SymNet parameters
[[-3.08e-02  2.34e-03 -1.27e-04 -1.89e-04  1.39e-04 -1.17e-04 -5.84e-03  6.61e-03
  -1.86e-03 -7.37e-04 -8.81e-04  2.05e-03  7.54e-04  2.22e-03]
 [ 1.51e+00 -9.44e-02 -8.84e-02  8.57e-03  9.74e-03 -7.77e-03 -2.93e-01 -8.06e-01
   2.97e-02  4.07e-02  5.64e-02  1.36e-01 -1.08e-02 -1.65e-01]]
SymNet parameters
[ 0.17 -0.05]
SymNet parameters
[[-4.05e-01 -6.91e-02 -2.31e-02  8.29e-03 -1.33e-03 -4.29e-03 -1.99e+00  1.03e-01
  -4.27e-02 -1.35e-02 -1.51e-03  5.80e-03  3.94e-03  2.09e-03 -1.09e-01]
 [ 1.37e+00 -6.05e-02 -3.31e-02  1.06e-02 -7.25e-04 -4.80e-03 -8.33e-02 -5.58e-01
  -3.99e-01 -1.11e-02  1.02e-02  2.71e-02 -6.02e-03 -1.10e-01 -9.90e-01]]
SymNet parameters
[ 0.49 -0.01]
SymNet parameters
[[-2.19e+00  6.80e-02  1.05e-02 -2.09e-02  1.01e-02  5.30e-03 -2.83e-02  7.93e-01
  -1.41e+00  6.14e-02  1.90e-02  3.90e-02  6.91e-02  4.33e-01 -2.11e+00  5.56e-03]
 [-1.39e-01  1.32e-01  4.42e-02 -1.59e-02  1.49e-03  6.58e-03 -3.23e+00  1.89e-01
   6.89e-02  3.23e-02  4.39e-03 -1.49e-02 -6.52e-03 -3.44e-02  1.77e-01  8.42e-02]]
SymNet parameters
[0.21 1.06]
SymNet parameters
[[ 1.45e-01  1.08e-02  5.96e-04 -6.11e-04 -4.76e-04  4.45e-04 -7.13e-02  1.38e-01
  -2.92e-01  5.49e-02  4.06e-03  5.36e-02 -1.06e-02  5.89e-01 -2.94e-01 -5.36e-01
  -1.19e-01]]
SymNet parameters
[0.04]
finally, finish this stage
iter:     0    time: 648.76
Func: 2.72e-01  |g|: 8.98e+00
stableloss: 3.26e-02   dataloss: 2.44e-01   sparseloss: 9.47e+01 momentloss: 6.99e+00
current expression:
[u00*u01, u10*v00, u20, u02, u00*u01**2, u10*v00*v10, u00, u00*u11*v00, u01*u10*v00, u01, u10*v01, u00*u10*v01, u01**2, u00*u01*v01, u20*v00**2, u00**2*u01, 1, u00**2*u02, u00**3, u00**2]
[-0.99 -0.98  0.05  0.05  0.01  0.01  0.01  0.01  0.01 -0.01  0.01  0.01  0.01 -0.01
  0.    0.    0.    0.   -0.   -0.  ]
[v00*v10, u00*v01, v02, v20, v00*v10**2, u00*v01*v10, u00*v00*v11, u00*u01*v01, u10*v00*v01, v00, v01*v10, u01*v01, u00*v00*v10, u00, v01, u00**2, u00**2*v02, v00**3, v00**2*v20, v00**2*v01]
[-0.98 -0.98  0.05  0.05  0.01  0.01  0.01  0.01  0.01  0.01  0.01  0.01  0.01 -0.
 -0.    0.    0.   -0.    0.   -0.  ]
block:  5
name:  burgers-2-upwind-sparse0-noise0.001-id12
device:  cuda:0
generate a random number to check random seed:  -0.7574050122830777
current stage is: block-5
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.8625, device='cuda:0', dtype=torch.float64)
u_obs variance
tensor([ 0.2448,  1.6250,  1.5607, 26.7812,  9.4214, 18.3318,  0.2587,  1.7555,
         1.8432, 24.4885, 11.2551, 23.5541], device='cuda:0',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 0.417969
         Iterations: 0
         Function evaluations: 15
         Gradient evaluations: 3
convolution moment and kernels
[[ 1.00e+00  0.00e+00 -1.32e-03 -1.01e-01 -7.54e-02]
 [ 0.00e+00  1.20e-05  3.12e-04  4.88e-03 -1.99e-02]
 [ 1.45e-03  6.71e-03  7.73e-03  7.29e-03  1.11e-03]
 [-3.80e-02  6.11e-04  2.28e-03 -1.93e-03  4.28e-03]
 [-5.65e-02 -4.89e-03  4.42e-03 -1.12e-02  9.04e-03]]
[[ 9.65e-03 -2.36e-02 -1.33e-02 -1.05e-02  1.99e-04]
 [-3.89e-02  9.13e-02  1.00e-01  3.17e-02  5.50e-03]
 [ 6.46e-02 -5.14e-02  4.99e-01  2.59e-01 -1.14e-01]
 [-7.89e-02  2.37e-01 -2.38e-02  1.55e-01 -2.39e-02]
 [ 1.85e-02 -5.42e-02 -1.14e-02 -3.47e-02  6.18e-03]]
[[ 0.00e+00  1.00e+00  0.00e+00 -8.93e-02 -3.50e-02]
 [ 0.00e+00  0.00e+00 -5.75e-03 -2.92e-03 -1.23e-02]
 [ 0.00e+00  2.24e-02  1.90e-03  4.29e-02  3.24e-03]
 [-8.78e-04 -3.44e-03  4.60e-03 -1.50e-03 -6.30e-04]
 [ 2.74e-03 -3.08e-02 -7.29e-03 -8.36e-03 -1.95e-03]]
[[ 0.    0.01  0.01 -0.01 -0.01]
 [-0.02 -0.03  0.01 -0.02  0.05]
 [ 0.14 -0.6  -0.19  0.91 -0.24]
 [-0.03 -0.   -0.04  0.03  0.03]
 [ 0.    0.01  0.   -0.01 -0.  ]]
[[ 0.00e+00  0.00e+00  0.00e+00 -2.21e-02 -1.43e-04]
 [ 1.00e+00  0.00e+00  1.58e-02 -7.64e-03 -2.47e-02]
 [ 0.00e+00  2.08e-03  9.97e-03  6.91e-04 -1.21e-03]
 [-7.67e-02  5.50e-04  1.47e-02  5.85e-03 -2.99e-02]
 [-4.55e-02 -3.89e-03 -2.48e-03 -1.88e-03 -2.99e-03]]
[[ 0.01 -0.06  0.16 -0.05  0.01]
 [-0.01  0.06 -0.65  0.04  0.  ]
 [ 0.   -0.01 -0.26  0.02 -0.03]
 [ 0.02 -0.08  1.02 -0.06  0.02]
 [-0.02  0.07 -0.27  0.06 -0.01]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00 -1.49e-01]
 [ 0.00e+00  0.00e+00  0.00e+00  9.20e-04  4.72e-03]
 [ 0.00e+00  0.00e+00  6.81e-03 -4.71e-03 -6.61e-03]
 [ 0.00e+00  9.33e-04  3.57e-04 -1.91e-03 -1.95e-03]
 [ 3.88e-03 -6.15e-03 -4.83e-03  7.39e-03  6.23e-03]]
[[ 3.65e-03 -2.68e-02  6.67e-02 -5.33e-02  1.36e-02]
 [-1.99e-02  1.38e-01 -3.20e-01  2.49e-01 -6.25e-02]
 [-2.06e-01  1.73e+00 -2.93e+00  1.57e+00 -1.44e-01]
 [-1.23e-02  1.03e-01 -2.58e-01  2.01e-01 -4.96e-02]
 [ 2.00e-03 -1.81e-02  4.94e-02 -3.92e-02  9.70e-03]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  1.51e-03]
 [ 0.00e+00  1.00e+00  0.00e+00 -2.98e-03 -7.20e-04]
 [ 0.00e+00  0.00e+00  2.75e-05 -1.16e-03 -2.36e-03]
 [ 0.00e+00 -2.88e-03  4.54e-03  4.73e-03 -3.49e-03]
 [-1.71e-03  4.71e-03 -1.45e-04 -2.57e-03  2.30e-03]]
[[ 0.01 -0.08  0.03  0.04 -0.01]
 [-0.08  0.54 -0.1  -0.41  0.05]
 [ 0.03 -0.12  0.12 -0.05  0.01]
 [ 0.04 -0.4  -0.04  0.46 -0.06]
 [-0.01  0.05 -0.   -0.05  0.01]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  1.27e-01]
 [ 0.00e+00  0.00e+00  0.00e+00 -1.41e-03  9.71e-03]
 [ 1.00e+00  0.00e+00  1.97e-03 -2.44e-03 -3.93e-03]
 [ 0.00e+00  8.28e-04  2.41e-03  1.35e-04 -8.79e-03]
 [-1.17e-02  1.35e-03  6.37e-03  2.02e-03 -1.15e-02]]
[[-0.01  0.03 -0.14  0.03 -0.01]
 [ 0.03 -0.14  1.59 -0.12  0.02]
 [ 0.06 -0.21 -2.25 -0.24  0.07]
 [ 0.06 -0.27  1.78 -0.25  0.05]
 [-0.02  0.08 -0.21  0.07 -0.02]]
SymNet parameters
[[ 4.40e-01 -2.07e-02 -2.66e-02  5.21e-03 -2.58e-03 -1.08e-02 -2.71e-02 -6.62e-03
  -3.03e-02 -5.53e-04  9.26e-04  4.97e-04]
 [ 6.88e-02  5.14e-03  8.42e-02  2.48e-03 -9.14e-03  4.91e-04  6.09e-02 -1.17e-02
   6.96e-03  7.79e-05  3.69e-04 -1.69e-05]]
SymNet parameters
[-0.13 -1.25]
SymNet parameters
[[ 4.51e-02 -2.73e-01 -3.67e-01 -1.46e-01  2.78e-02  1.49e-02  2.16e+00  1.21e-01
   1.71e-02  8.53e-03 -7.37e-03 -5.00e-03 -4.24e-01]
 [ 2.63e+00 -2.46e-01 -4.43e-01  8.73e-02  3.08e-03  6.23e-02  6.79e-01 -7.38e-02
   1.18e-01 -1.81e-03 -1.32e-03 -1.86e-03 -4.23e+00]]
SymNet parameters
[-0.57 -1.02]
SymNet parameters
[[-1.85e+00  4.66e-02  2.13e-01 -5.99e-02  4.10e-03  1.46e-02 -3.79e-01  8.52e-02
  -1.09e-01  3.25e-04 -4.16e-03 -8.43e-04  1.47e+00 -2.11e-03]
 [ 1.12e-02  5.42e-01  3.15e-01  1.08e-01 -1.48e-02 -1.71e-02 -2.00e+00 -1.95e-01
   1.26e-03 -4.11e-03  1.06e-02  4.32e-03  3.62e-01  5.39e-03]]
SymNet parameters
[0.03 0.48]
SymNet parameters
[[-1.25e+00  1.44e-01 -6.23e-01  1.45e-02  4.33e-03  1.54e-02 -3.48e-01 -1.28e-02
   4.40e-02 -9.68e-04  2.92e-04 -5.48e-05 -1.26e+00  2.84e-02 -4.16e-02]
 [-2.67e-01 -4.16e-01 -9.63e-02 -4.83e-02  3.82e-03  3.63e-03 -3.64e+00  8.19e-02
   1.97e-02  6.29e-03 -2.08e-03  1.21e-03 -1.02e-01 -5.46e-02  1.22e-01]]
SymNet parameters
[1.11 1.28]
SymNet parameters
[[-1.86e+00 -1.15e-01  4.34e-02 -3.91e-02  1.48e-03 -5.66e-03  4.76e-01  3.34e-02
  -2.50e-02  6.29e-04 -1.97e-03  1.61e-04  7.62e-01 -5.98e-03 -1.12e-02  4.88e-03]
 [ 2.73e-01 -2.91e+00  1.92e+00  6.18e-01 -1.03e-01 -7.04e-02 -5.58e+00 -6.41e-01
  -7.71e-02 -4.00e-02  3.79e-02  1.95e-02  2.01e+00  2.94e-02 -4.35e-02  1.23e-01]]
SymNet parameters
[ 0.31 -1.29]
SymNet parameters
[[ 1.05e-01 -2.83e-01 -3.30e-01  4.34e-02  3.40e-03  5.77e-02 -8.19e-01  1.00e-02
   2.87e-02  1.96e-03 -2.68e-04 -2.92e-05 -6.76e-01  1.29e-01  9.63e-02 -3.00e-01
  -9.12e-02]]
SymNet parameters
[0.27]
SymNet parameters
[[-2.23e+00  1.27e-01 -9.07e-02  4.13e-04 -6.76e-04 -7.99e-05  7.78e-02 -2.49e-03
  -7.08e-02 -1.42e-02 -1.84e-02  1.03e-02]
 [-3.02e-01 -3.59e-01 -1.15e-01  1.21e-02  3.00e-03 -1.12e-02 -4.17e-01 -2.95e+00
   8.09e-02  6.61e-02 -7.10e-02  4.97e-02]]
SymNet parameters
[-0.21 -0.14]
SymNet parameters
[[-2.50e-01 -7.77e-02 -2.56e-02  9.18e-03 -1.76e-03 -4.66e-03 -1.33e-01 -8.45e-01
   6.94e-02 -2.18e-02  2.72e-05  4.52e-03 -2.54e-03]
 [ 1.59e+00 -6.37e-02 -3.31e-02  6.12e-03 -1.51e-03 -3.82e-03 -9.01e-02  1.33e-02
   5.50e-02 -1.46e-02 -3.91e-03  4.52e-03  2.11e-06]]
SymNet parameters
[-0.08  0.3 ]
SymNet parameters
[[-3.09e-02  2.34e-03 -1.39e-04 -7.10e-05  4.72e-05 -8.95e-05 -5.74e-03  6.62e-03
  -1.78e-03 -8.42e-04 -8.12e-04  1.60e-03  7.11e-04  2.21e-03]
 [ 1.51e+00 -9.44e-02 -8.84e-02  8.56e-03  9.74e-03 -7.78e-03 -2.93e-01 -8.06e-01
   2.97e-02  4.07e-02  5.63e-02  1.36e-01 -1.08e-02 -1.65e-01]]
SymNet parameters
[ 0.17 -0.05]
SymNet parameters
[[-4.05e-01 -6.91e-02 -2.31e-02  8.31e-03 -1.34e-03 -4.29e-03 -1.99e+00  1.03e-01
  -4.27e-02 -1.35e-02 -1.53e-03  5.81e-03  3.81e-03  2.11e-03 -1.09e-01]
 [ 1.37e+00 -6.05e-02 -3.31e-02  1.06e-02 -7.29e-04 -4.77e-03 -8.33e-02 -5.58e-01
  -3.99e-01 -1.11e-02  1.02e-02  2.71e-02 -5.92e-03 -1.10e-01 -9.90e-01]]
SymNet parameters
[ 0.49 -0.01]
SymNet parameters
[[-2.19e+00  6.80e-02  1.05e-02 -2.09e-02  1.01e-02  5.31e-03 -2.83e-02  7.93e-01
  -1.41e+00  6.14e-02  1.90e-02  3.90e-02  6.91e-02  4.33e-01 -2.11e+00  5.56e-03]
 [-1.39e-01  1.32e-01  4.42e-02 -1.59e-02  1.48e-03  6.58e-03 -3.23e+00  1.89e-01
   6.89e-02  3.23e-02  4.40e-03 -1.49e-02 -6.44e-03 -3.45e-02  1.77e-01  8.42e-02]]
SymNet parameters
[0.21 1.06]
SymNet parameters
[[ 1.45e-01  1.08e-02  6.00e-04 -5.99e-04 -4.71e-04  4.44e-04 -7.13e-02  1.38e-01
  -2.92e-01  5.49e-02  4.06e-03  5.35e-02 -1.05e-02  5.89e-01 -2.94e-01 -5.36e-01
  -1.18e-01]]
SymNet parameters
[0.04]
finally, finish this stage
iter:     0    time: 54.49
Func: 4.18e-01  |g|: 2.56e+01
stableloss: 5.88e-02   dataloss: 3.83e-01   sparseloss: 9.47e+01 momentloss: 6.99e+00
current expression:
[u00*u01, u10*v00, u20, u02, u00*u01**2, u10*v00*v10, u00, u00*u11*v00, u01*u10*v00, u01, u10*v01, u00*u10*v01, u01**2, u00*u01*v01, u20*v00**2, u00**2*u01, 1, u00**2*u02, u00**3, u00**2]
[-0.99 -0.98  0.05  0.05  0.01  0.01  0.01  0.01  0.01 -0.01  0.01  0.01  0.01 -0.01
  0.    0.    0.    0.   -0.   -0.  ]
[v00*v10, u00*v01, v02, v20, v00*v10**2, u00*v01*v10, u00*v00*v11, u00*u01*v01, u10*v00*v01, v00, v01*v10, u01*v01, u00*v00*v10, u00, v01, u00**2, u00**2*v02, v00**3, v00**2*v20, v00**2*v01]
[-0.98 -0.98  0.05  0.05  0.01  0.01  0.01  0.01  0.01  0.01  0.01  0.01  0.01 -0.
 -0.    0.    0.   -0.    0.   -0.  ]
block:  6
name:  burgers-2-upwind-sparse0-noise0.001-id12
device:  cuda:0
generate a random number to check random seed:  2.361946067261366
current stage is: block-6
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.9583, device='cuda:0', dtype=torch.float64)
u_obs variance
tensor([ 0.2535,  1.8020,  1.6295, 30.1069, 11.1888, 18.7346,  0.2524,  1.6138,
         1.6470, 22.8113,  9.6790, 21.7046], device='cuda:0',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
iter:     0    time: 54.31
Func: 7.79e-01  |g|: 2.92e+01
stableloss: 5.04e-02   dataloss: 7.37e-01   sparseloss: 9.47e+01 momentloss: 6.99e+00
iter:   200    time: 31.79
Func: 6.09e-01  |g|: 2.03e+00
stableloss: 4.97e-02   dataloss: 5.56e-01   sparseloss: 9.44e+01 momentloss: 8.96e+00
iter:   400    time: 31.29
Func: 5.92e-01  |g|: 1.66e+00
stableloss: 5.00e-02   dataloss: 5.32e-01   sparseloss: 9.97e+01 momentloss: 1.01e+01
iter:   600    time: 31.05
Func: 5.89e-01  |g|: 6.14e-01
stableloss: 5.02e-02   dataloss: 5.29e-01   sparseloss: 1.11e+02 momentloss: 1.00e+01
iter:   800    time: 31.63
Func: 5.88e-01  |g|: 1.83e+00
stableloss: 5.03e-02   dataloss: 5.28e-01   sparseloss: 1.39e+02 momentloss: 9.95e+00
iter:  1000    time: 31.18
Func: 5.86e-01  |g|: 1.78e+00
stableloss: 4.99e-02   dataloss: 5.26e-01   sparseloss: 1.81e+02 momentloss: 9.89e+00
iter:  1200    time: 30.11
Func: 5.85e-01  |g|: 2.80e+00
stableloss: 5.00e-02   dataloss: 5.25e-01   sparseloss: 2.14e+02 momentloss: 9.95e+00
iter:  1400    time: 30.08
Func: 5.84e-01  |g|: 3.46e+00
stableloss: 4.97e-02   dataloss: 5.25e-01   sparseloss: 2.53e+02 momentloss: 9.96e+00
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 0.583916
         Iterations: 1593
         Function evaluations: 1674
         Gradient evaluations: 1656
convolution moment and kernels
[[ 1.00e+00  0.00e+00 -5.89e-03  2.03e-02 -1.05e-01]
 [ 0.00e+00  7.05e-04 -8.52e-03 -6.24e-03 -1.75e-02]
 [ 3.98e-03 -7.23e-02  4.15e-02 -9.75e-02 -7.86e-03]
 [-1.34e-02  5.52e-03  1.10e-03  1.05e-03 -7.38e-03]
 [-7.68e-02 -9.61e-02  1.84e-02 -9.31e-02  1.05e-02]]
[[ 0.05 -0.06 -0.02 -0.01 -0.02]
 [-0.15  0.23  0.04  0.13  0.05]
 [ 0.09  0.06  0.39  0.12 -0.14]
 [-0.15  0.24  0.05  0.15  0.04]
 [ 0.04 -0.04 -0.07  0.01 -0.03]]
[[ 0.00e+00  1.00e+00  0.00e+00 -9.07e-02 -6.07e-02]
 [ 0.00e+00  0.00e+00  1.15e-02  6.65e-03  2.97e-02]
 [ 0.00e+00  2.42e-02  3.41e-03  2.72e-02 -7.12e-03]
 [-7.84e-03 -1.33e-03 -6.93e-03  9.15e-04  1.82e-02]
 [ 1.95e-02 -1.66e-02 -2.50e-03 -7.30e-03 -3.61e-03]]
[[-0.01  0.04 -0.04  0.04 -0.01]
 [-0.02 -0.02 -0.07 -0.01  0.03]
 [ 0.11 -0.54 -0.21  0.99 -0.23]
 [-0.02  0.02 -0.1   0.01  0.03]
 [ 0.01 -0.02  0.06 -0.03  0.  ]]
[[ 0.    0.    0.   -0.01  0.01]
 [ 1.    0.    0.04 -0.02  0.01]
 [ 0.   -0.01  0.02 -0.    0.01]
 [-0.1  -0.01  0.01 -0.02 -0.  ]
 [-0.07 -0.04  0.   -0.01  0.01]]
[[ 0.   -0.01  0.11 -0.05  0.01]
 [-0.02  0.02 -0.6   0.14 -0.02]
 [ 0.03 -0.04 -0.24 -0.2   0.01]
 [-0.01 -0.02  0.99  0.1   0.  ]
 [ 0.01  0.   -0.2  -0.02 -0.  ]]
[[ 0.    0.    1.    0.    0.01]
 [ 0.    0.    0.   -0.01  0.09]
 [ 0.    0.    0.01 -0.01 -0.01]
 [ 0.    0.04  0.   -0.01 -0.07]
 [-0.02 -0.56 -0.01  0.01  0.03]]
[[ 0.02  0.08  0.46 -0.71  0.13]
 [-0.06 -0.42 -1.61  2.68 -0.48]
 [-0.17  2.68 -1.21 -1.89  0.45]
 [ 0.19 -1.42 -0.02  1.56 -0.21]
 [-0.06  0.39 -0.07 -0.33  0.04]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  1.41e-01]
 [ 0.00e+00  1.00e+00  0.00e+00 -4.53e-04  2.71e-01]
 [ 0.00e+00  0.00e+00  2.55e-03  2.54e-02 -1.17e-03]
 [ 0.00e+00 -6.00e-03 -2.06e-01  1.68e-01 -3.74e-03]
 [-2.77e-01 -7.81e-03 -8.20e-03 -7.96e-03  1.09e-02]]
[[ 0.08 -0.16 -0.3   0.13 -0.03]
 [-0.39  1.35  0.15  0.03 -0.05]
 [ 0.27 -0.99 -0.26 -0.83  0.16]
 [ 0.23 -0.81  1.34  0.34  0.01]
 [-0.05  0.04 -0.08 -0.23  0.04]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  2.45e-02]
 [ 0.00e+00  0.00e+00  0.00e+00 -1.90e-02 -1.50e-01]
 [ 1.00e+00  0.00e+00  1.48e-03 -3.98e-02  4.16e-03]
 [ 0.00e+00  1.45e-03  2.96e-03  8.33e-04  9.09e-03]
 [ 5.30e-03  6.64e-01  1.12e-03 -2.76e-03 -5.34e-02]]
[[-0.01 -0.16 -0.5   0.73 -0.13]
 [ 0.12  0.43  3.28 -3.05  0.54]
 [-0.02 -1.34 -4.31  3.8  -0.6 ]
 [-0.08  1.27  1.98 -2.16  0.3 ]
 [ 0.02 -0.29 -0.3   0.59 -0.09]]
SymNet parameters
[[ 4.68e-01 -1.08e-02 -5.06e-02  1.29e-03 -6.00e-03 -6.39e-03 -1.02e-01 -2.97e-03
  -8.80e-03  4.53e-04  9.19e-04 -2.13e-03]
 [ 5.54e-03  1.67e-02  1.13e-02 -1.43e-03 -2.11e-03  1.97e-04  3.26e-02 -3.98e-04
   2.28e-04 -1.20e-04 -1.24e-04  5.64e-05]]
SymNet parameters
[-0.14 -1.81]
SymNet parameters
[[-6.41e+00  1.47e+00  3.19e-01 -3.63e-01  1.73e-01  1.72e-02  6.89e+00  9.32e-02
   1.53e-01 -7.78e-03 -4.31e-02  7.25e-02 -9.09e+00]
 [-2.58e-01 -2.73e+00 -4.25e-01  5.91e-01 -3.47e-02  2.42e-01 -6.94e+00 -3.70e-02
   1.08e-01 -9.38e-03  3.75e-02 -4.06e-02 -7.83e+00]]
SymNet parameters
[ 3.25 -2.52]
SymNet parameters
[[ 1.02e+00 -6.99e-01 -5.24e-01  1.17e-02 -6.20e-03 -9.21e-02  3.20e-01 -4.03e-01
  -1.35e+00 -2.18e-03 -2.02e-02 -7.41e-03  8.22e+00  2.87e-03]
 [ 1.26e+00  4.42e-02 -4.38e-01 -3.00e-03  4.81e-02 -8.16e-03 -3.69e+00 -7.59e-01
   1.64e-01  6.30e-03  2.57e-02 -7.18e-03  2.65e+00  3.77e-03]]
SymNet parameters
[ 4.6  -5.71]
SymNet parameters
[[-1.89e+00 -7.07e-01 -4.29e-01  1.59e-01 -1.32e-02  5.81e-02 -2.24e+00 -1.87e-02
   2.20e-02 -1.84e-03  1.19e-02 -1.19e-02 -1.46e+00  1.63e-03 -8.30e-04]
 [-5.82e+00 -7.58e-01  5.15e-01 -3.53e-02  8.88e-02  8.05e-02 -2.48e+00  6.44e-02
   5.86e-02 -2.11e-03 -1.83e-02  3.54e-02 -7.64e+00 -1.53e-04  8.74e-03]]
SymNet parameters
[3.67 3.12]
SymNet parameters
[[ 8.64e-01  1.36e+00  9.50e-02 -3.20e-01  5.81e-03 -1.44e-01  4.85e+00  8.10e-03
  -5.74e-02  5.07e-03 -1.75e-02  1.62e-02  5.41e+00  3.59e-04 -2.69e-03  6.33e-03]
 [ 1.38e+01 -4.24e+00 -8.01e-01  8.22e-01 -3.83e-01 -2.87e-02 -1.53e+01 -2.11e-01
  -3.31e-01  1.54e-02  9.70e-02 -1.62e-01  1.98e+01  1.06e-03 -7.30e-04  1.07e-02]]
SymNet parameters
[ 1.   -6.47]
SymNet parameters
[[-6.73e+00 -1.05e+00  4.33e-01 -3.31e-03  9.62e-02  1.28e-01 -2.29e+00  6.62e-02
   5.96e-02 -2.79e-03 -2.04e-02  3.88e-02 -7.87e+00  2.65e-01  8.64e-03 -2.77e-01
  -2.09e-01]]
SymNet parameters
[3.51]
SymNet parameters
[[-3.96e+00  2.78e-03  1.95e-02  5.34e-04 -2.07e-03  3.49e-03  5.25e-01  3.59e-02
   1.39e-01 -2.25e-02 -1.97e-02 -1.35e-02]
 [ 3.37e-01 -3.62e-01 -1.24e-01 -5.57e-04  7.96e-04  3.12e-04  6.14e-01 -3.86e+00
   9.72e-01  2.43e-02  1.79e-02 -1.24e-02]]
SymNet parameters
[-0.92  1.28]
SymNet parameters
[[ 2.55e-02 -1.04e-01 -1.40e-02 -6.75e-03 -5.48e-04  2.43e-03  2.07e-01 -8.57e-01
   3.26e-01 -2.99e-02 -2.38e-02 -2.04e-02 -1.20e-03]
 [ 2.77e+00 -2.49e-02 -1.42e-02 -9.28e-03 -2.23e-04 -3.62e-04 -3.08e-01  4.66e-02
   2.66e-02 -2.40e-02 -2.54e-02 -1.27e-02 -1.56e-03]]
SymNet parameters
[0.15 1.25]
SymNet parameters
[[-2.22e-02  8.94e-04  5.24e-04  3.87e-05  1.98e-05  1.34e-05  6.95e-04  7.92e-03
  -1.83e-03  8.65e-05  1.36e-04  3.05e-04  3.58e-06 -2.73e-05]
 [ 2.30e+00  6.93e-01 -5.80e-01  2.64e-01  4.00e-02 -8.21e-02 -2.38e+00 -2.29e+00
  -4.00e+00  1.36e+00  1.29e+00  6.61e-01  5.15e-02  1.43e-02]]
SymNet parameters
[0.06 0.04]
SymNet parameters
[[-0.09 -0.04 -0.06  0.02  0.   -0.   -1.62  0.02 -0.29  0.09  0.08  0.04  0.05  0.29
  -0.9 ]
 [ 0.83  0.13 -0.1   0.04  0.01 -0.02 -0.43 -0.16 -1.72  0.23  0.22  0.11  0.12  0.67
  -2.28]]
SymNet parameters
[0.01 0.87]
SymNet parameters
[[-4.14  0.15 -0.13  0.09  0.01 -0.02 -1.56 -0.13 -4.28  0.41  0.38  0.21  0.18  1.14
  -3.73 -0.02]
 [-1.98  0.2   0.33 -0.09 -0.02  0.03 -0.52 -0.37  1.62 -0.47 -0.43 -0.2  -0.29 -1.62
   5.    0.09]]
SymNet parameters
[-0.17 -0.77]
SymNet parameters
[[-3.17e-01 -2.62e-02  9.40e-04 -2.40e-03 -5.07e-04  1.12e-03 -6.74e-01  3.05e-01
   3.01e-02  4.05e-02 -1.05e-02  3.99e-02 -3.72e-02  1.30e-01  9.27e-02 -5.72e-01
  -3.34e-02]]
SymNet parameters
[-0.06]
finally, finish this stage
iter:  1593    time: 36.87
Func: 5.84e-01  |g|: 1.56e+00
stableloss: 4.97e-02   dataloss: 5.24e-01   sparseloss: 2.96e+02 momentloss: 9.98e+00
current expression:
[u00*u01, u10*v00, u02, u20, u00*u01**2, u00*u11*v00, u10*v00*v10, u00*u10*v01, u01*u10*v00, u00, u01, u00*v00, v00, u01*v00, u00*u01*v00, u00**3, u11*v00, v10, u00*u01*v00**2, u20*v00**2]
[-0.98 -0.98  0.05  0.05  0.01  0.01  0.01  0.01  0.01  0.01 -0.01  0.    0.   -0.
  0.   -0.    0.   -0.   -0.    0.  ]
[u00*v01, v00*v10, v02, v20, v00*v10**2, u00*v01*v10, u10*v00*v01, u00*v00*v11, u00*u01*v01, v01*v10, u10, u01, u00*v00**2, v00*v11, u00**2*v02, u00*v00*v10, u00*v00*v01, v00**3, v00*v01*v20, u10*v01]
[-0.98 -0.98  0.05  0.05  0.02  0.01  0.01  0.01  0.01 -0.    0.   -0.   -0.    0.
  0.   -0.    0.   -0.    0.    0.  ]
block:  9
name:  burgers-2-upwind-sparse0-noise0.001-id12
device:  cuda:0
generate a random number to check random seed:  0.8845440282509771
current stage is: block-9
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.8655, device='cuda:0', dtype=torch.float64)
u_obs variance
tensor([ 0.2462,  1.5763,  1.5861, 22.7533, 11.8666, 22.7020,  0.2378,  1.6223,
         1.6900, 22.7395, 13.1353, 27.2267], device='cuda:0',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 1.862016
         Iterations: 0
         Function evaluations: 15
         Gradient evaluations: 3
convolution moment and kernels
[[ 1.00e+00  0.00e+00 -5.89e-03  2.03e-02 -1.05e-01]
 [ 0.00e+00  7.10e-04 -8.52e-03 -6.24e-03 -1.75e-02]
 [ 3.97e-03 -7.23e-02  4.15e-02 -9.75e-02 -7.86e-03]
 [-1.34e-02  5.52e-03  1.10e-03  1.05e-03 -7.38e-03]
 [-7.68e-02 -9.61e-02  1.84e-02 -9.31e-02  1.05e-02]]
[[ 0.05 -0.06 -0.02 -0.01 -0.02]
 [-0.15  0.23  0.04  0.13  0.05]
 [ 0.09  0.06  0.39  0.12 -0.14]
 [-0.15  0.24  0.05  0.15  0.04]
 [ 0.04 -0.04 -0.07  0.01 -0.03]]
[[ 0.00e+00  1.00e+00  0.00e+00 -9.07e-02 -6.07e-02]
 [ 0.00e+00  0.00e+00  1.15e-02  6.64e-03  2.97e-02]
 [ 0.00e+00  2.42e-02  3.41e-03  2.72e-02 -7.12e-03]
 [-7.84e-03 -1.33e-03 -6.93e-03  9.13e-04  1.82e-02]
 [ 1.95e-02 -1.66e-02 -2.50e-03 -7.30e-03 -3.61e-03]]
[[-0.01  0.04 -0.04  0.04 -0.01]
 [-0.02 -0.02 -0.07 -0.01  0.03]
 [ 0.11 -0.54 -0.21  0.99 -0.23]
 [-0.02  0.02 -0.1   0.01  0.03]
 [ 0.01 -0.02  0.06 -0.03  0.  ]]
[[ 0.    0.    0.   -0.01  0.01]
 [ 1.    0.    0.04 -0.02  0.01]
 [ 0.   -0.01  0.02 -0.    0.01]
 [-0.1  -0.01  0.01 -0.02 -0.  ]
 [-0.07 -0.04  0.   -0.01  0.01]]
[[ 0.   -0.01  0.11 -0.05  0.01]
 [-0.02  0.02 -0.6   0.14 -0.02]
 [ 0.03 -0.04 -0.24 -0.2   0.01]
 [-0.01 -0.02  0.99  0.1   0.  ]
 [ 0.01  0.   -0.2  -0.02 -0.  ]]
[[ 0.    0.    1.    0.    0.01]
 [ 0.    0.    0.   -0.01  0.09]
 [ 0.    0.    0.01 -0.01 -0.01]
 [ 0.    0.04  0.   -0.01 -0.07]
 [-0.02 -0.56 -0.01  0.01  0.03]]
[[ 0.02  0.08  0.46 -0.71  0.13]
 [-0.06 -0.42 -1.61  2.68 -0.48]
 [-0.17  2.68 -1.21 -1.89  0.45]
 [ 0.19 -1.42 -0.02  1.56 -0.21]
 [-0.06  0.39 -0.07 -0.33  0.04]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  1.41e-01]
 [ 0.00e+00  1.00e+00  0.00e+00 -4.55e-04  2.71e-01]
 [ 0.00e+00  0.00e+00  2.54e-03  2.54e-02 -1.17e-03]
 [ 0.00e+00 -6.01e-03 -2.06e-01  1.68e-01 -3.74e-03]
 [-2.77e-01 -7.81e-03 -8.20e-03 -7.96e-03  1.09e-02]]
[[ 0.08 -0.16 -0.3   0.13 -0.03]
 [-0.39  1.35  0.15  0.03 -0.05]
 [ 0.27 -0.99 -0.26 -0.83  0.16]
 [ 0.23 -0.81  1.34  0.34  0.01]
 [-0.05  0.04 -0.08 -0.23  0.04]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  2.45e-02]
 [ 0.00e+00  0.00e+00  0.00e+00 -1.90e-02 -1.50e-01]
 [ 1.00e+00  0.00e+00  1.48e-03 -3.98e-02  4.16e-03]
 [ 0.00e+00  1.45e-03  2.96e-03  8.33e-04  9.09e-03]
 [ 5.30e-03  6.64e-01  1.12e-03 -2.76e-03 -5.34e-02]]
[[-0.01 -0.16 -0.5   0.73 -0.13]
 [ 0.12  0.43  3.28 -3.05  0.54]
 [-0.02 -1.34 -4.31  3.8  -0.6 ]
 [-0.08  1.27  1.98 -2.16  0.3 ]
 [ 0.02 -0.29 -0.3   0.59 -0.09]]
SymNet parameters
[[ 4.68e-01 -1.08e-02 -5.06e-02  1.29e-03 -6.00e-03 -6.41e-03 -1.02e-01 -2.97e-03
  -8.80e-03  4.55e-04  9.24e-04 -2.10e-03]
 [ 5.54e-03  1.67e-02  1.13e-02 -1.42e-03 -2.10e-03  2.06e-04  3.26e-02 -3.98e-04
   2.28e-04 -1.26e-04 -1.23e-04  4.98e-05]]
SymNet parameters
[-0.14 -1.81]
SymNet parameters
[[-6.41e+00  1.47e+00  3.19e-01 -3.63e-01  1.73e-01  1.72e-02  6.89e+00  9.32e-02
   1.53e-01 -7.78e-03 -4.31e-02  7.25e-02 -9.09e+00]
 [-2.58e-01 -2.73e+00 -4.25e-01  5.91e-01 -3.46e-02  2.42e-01 -6.93e+00 -3.70e-02
   1.08e-01 -9.37e-03  3.75e-02 -4.06e-02 -7.83e+00]]
SymNet parameters
[ 3.25 -2.52]
SymNet parameters
[[ 1.02e+00 -6.99e-01 -5.24e-01  1.17e-02 -6.21e-03 -9.22e-02  3.20e-01 -4.03e-01
  -1.35e+00 -2.19e-03 -2.02e-02 -7.40e-03  8.22e+00  2.87e-03]
 [ 1.26e+00  4.43e-02 -4.38e-01 -3.00e-03  4.81e-02 -8.17e-03 -3.69e+00 -7.59e-01
   1.64e-01  6.29e-03  2.57e-02 -7.19e-03  2.65e+00  3.77e-03]]
SymNet parameters
[ 4.6  -5.71]
SymNet parameters
[[-1.89e+00 -7.07e-01 -4.29e-01  1.59e-01 -1.32e-02  5.81e-02 -2.24e+00 -1.87e-02
   2.20e-02 -1.84e-03  1.19e-02 -1.19e-02 -1.46e+00  1.59e-03 -8.05e-04]
 [-5.82e+00 -7.58e-01  5.15e-01 -3.53e-02  8.88e-02  8.05e-02 -2.48e+00  6.44e-02
   5.86e-02 -2.11e-03 -1.83e-02  3.54e-02 -7.64e+00 -1.99e-04  8.76e-03]]
SymNet parameters
[3.67 3.12]
SymNet parameters
[[ 8.64e-01  1.36e+00  9.50e-02 -3.20e-01  5.81e-03 -1.44e-01  4.85e+00  8.09e-03
  -5.74e-02  5.06e-03 -1.75e-02  1.62e-02  5.41e+00  3.76e-04 -2.62e-03  6.39e-03]
 [ 1.38e+01 -4.24e+00 -8.01e-01  8.22e-01 -3.83e-01 -2.87e-02 -1.53e+01 -2.11e-01
  -3.31e-01  1.54e-02  9.70e-02 -1.62e-01  1.98e+01  1.04e-03 -7.71e-04  1.06e-02]]
SymNet parameters
[ 1.   -6.47]
SymNet parameters
[[-6.73e+00 -1.05e+00  4.33e-01 -3.32e-03  9.62e-02  1.28e-01 -2.29e+00  6.62e-02
   5.96e-02 -2.79e-03 -2.04e-02  3.88e-02 -7.87e+00  2.65e-01  8.65e-03 -2.77e-01
  -2.09e-01]]
SymNet parameters
[3.51]
SymNet parameters
[[-3.96e+00  2.78e-03  1.95e-02  5.33e-04 -2.07e-03  3.48e-03  5.25e-01  3.59e-02
   1.39e-01 -2.25e-02 -1.97e-02 -1.35e-02]
 [ 3.37e-01 -3.62e-01 -1.24e-01 -5.60e-04  7.93e-04  3.14e-04  6.14e-01 -3.86e+00
   9.72e-01  2.43e-02  1.79e-02 -1.24e-02]]
SymNet parameters
[-0.92  1.28]
SymNet parameters
[[ 2.55e-02 -1.04e-01 -1.40e-02 -6.75e-03 -5.50e-04  2.43e-03  2.07e-01 -8.57e-01
   3.26e-01 -2.99e-02 -2.38e-02 -2.04e-02 -1.23e-03]
 [ 2.77e+00 -2.48e-02 -1.42e-02 -9.28e-03 -2.25e-04 -3.59e-04 -3.08e-01  4.66e-02
   2.66e-02 -2.40e-02 -2.54e-02 -1.27e-02 -1.55e-03]]
SymNet parameters
[0.15 1.25]
SymNet parameters
[[-2.22e-02  8.90e-04  5.18e-04  6.84e-05 -7.28e-06  3.66e-05  6.72e-04  7.92e-03
  -1.87e-03  1.39e-04  1.02e-04  2.87e-04  4.40e-04 -1.06e-04]
 [ 2.30e+00  6.92e-01 -5.80e-01  2.64e-01  4.00e-02 -8.21e-02 -2.38e+00 -2.29e+00
  -4.00e+00  1.36e+00  1.29e+00  6.61e-01  5.15e-02  1.43e-02]]
SymNet parameters
[0.06 0.04]
SymNet parameters
[[-0.09 -0.04 -0.06  0.02  0.   -0.   -1.62  0.02 -0.29  0.09  0.08  0.04  0.05  0.29
  -0.9 ]
 [ 0.83  0.13 -0.1   0.04  0.01 -0.02 -0.43 -0.16 -1.72  0.23  0.22  0.11  0.12  0.67
  -2.28]]
SymNet parameters
[0.01 0.87]
SymNet parameters
[[-4.14  0.15 -0.13  0.09  0.01 -0.02 -1.56 -0.13 -4.28  0.41  0.38  0.21  0.18  1.14
  -3.73 -0.02]
 [-1.98  0.2   0.33 -0.09 -0.02  0.03 -0.52 -0.37  1.62 -0.47 -0.43 -0.2  -0.29 -1.61
   5.    0.09]]
SymNet parameters
[-0.17 -0.77]
SymNet parameters
[[-3.17e-01 -2.62e-02  9.38e-04 -2.40e-03 -5.08e-04  1.12e-03 -6.74e-01  3.05e-01
   3.01e-02  4.05e-02 -1.05e-02  3.99e-02 -3.72e-02  1.30e-01  9.27e-02 -5.72e-01
  -3.34e-02]]
SymNet parameters
[-0.06]
finally, finish this stage
iter:     0    time: 583.66
Func: 1.86e+00  |g|: 3.98e+03
stableloss: 7.17e-02   dataloss: 1.77e+00   sparseloss: 2.96e+02 momentloss: 9.98e+00
current expression:
[u00*u01, u10*v00, u02, u20, u00*u01**2, u00*u11*v00, u10*v00*v10, u00*u10*v01, u01*u10*v00, u00, u01, u00*v00, v00, u01*v00, u00*u01*v00, u00**3, u11*v00, v10, u00*u01*v00**2, u20*v00**2]
[-0.98 -0.98  0.05  0.05  0.01  0.01  0.01  0.01  0.01  0.01 -0.01  0.    0.   -0.
  0.   -0.    0.   -0.   -0.    0.  ]
[u00*v01, v00*v10, v02, v20, v00*v10**2, u00*v01*v10, u10*v00*v01, u00*v00*v11, u00*u01*v01, v01*v10, u10, u01, u00*v00**2, v00*v11, u00**2*v02, u00*v00*v10, u00*v00*v01, v00**3, v00*v01*v20, u10*v01]
[-0.98 -0.98  0.05  0.05  0.02  0.01  0.01  0.01  0.01 -0.    0.   -0.   -0.    0.
  0.   -0.    0.   -0.    0.    0.  ]
u_obs.abs().max()
tensor(3.9086, device='cuda:0', dtype=torch.float64)
model(u_obs[0],T=50*dt).abs().max()
tensor(3.3563, device='cuda:0', dtype=torch.float64)
model(u_obs[0],T=100*dt).abs().max()
tensor(nan, device='cuda:0', dtype=torch.float64)
--name=burgers-2-upwind-sparse0-noise0.001-id16 --kernel_size=5 --viscosity=0.05 --blocks=0-6,9 --dataname=burgers --constraint=2 --device=cuda:0 --stablize=0 --sparsity=0 --momentsparsity=0.001 --data_start_time=1 --dt=1e-2 --max_dt=1/1600 --hidden_layers=5 --start_noise=0.001 --end_noise=0.001 --scheme=upwind
0
--name=burgers-2-upwind-sparse0-noise0.001-id17 --kernel_size=5 --viscosity=0.05 --blocks=0-6,9 --dataname=burgers --constraint=2 --device=cuda:1 --stablize=0 --sparsity=0 --momentsparsity=0.001 --data_start_time=1 --dt=1e-2 --max_dt=1/1600 --hidden_layers=5 --start_noise=0.001 --end_noise=0.001 --scheme=upwind
1
--name=burgers-2-upwind-sparse0-noise0.001-id18 --kernel_size=5 --viscosity=0.05 --blocks=0-6,9 --dataname=burgers --constraint=2 --device=cuda:2 --stablize=0 --sparsity=0 --momentsparsity=0.001 --data_start_time=1 --dt=1e-2 --max_dt=1/1600 --hidden_layers=5 --start_noise=0.001 --end_noise=0.001 --scheme=upwind
2
--name=burgers-2-upwind-sparse0-noise0.001-id19 --kernel_size=5 --viscosity=0.05 --blocks=0-6,9 --dataname=burgers --constraint=2 --device=cuda:3 --stablize=0 --sparsity=0 --momentsparsity=0.001 --data_start_time=1 --dt=1e-2 --max_dt=1/1600 --hidden_layers=5 --start_noise=0.001 --end_noise=0.001 --scheme=upwind
3
wait
{'--name': 'burgers-2-upwind-sparse0-noise0.001-id19', '--dtype': 'double', '--device': 'cuda:3', '--constraint': '2', '--dt': 0.01, '--cell_num': 1, '--eps': 6.283185307179586, '--blocks': [0, 1, 2, 3, 4, 5, 6, 9], '--kernel_size': 5, '--max_order': 2, '--dx': 0.19634954084936207, '--hidden_layers': 5, '--scheme': 'upwind', '--dataname': 'burgers', '--viscosity': 0.05, '--zoom': 4, '--max_dt': 0.000625, '--batch_size': 28, '--data_timescheme': 'rk2', '--channel_names': 'u,v', '--freq': 4, '--data_start_time': 1.0, '--start_noise': 0.001, '--end_noise': 0.001, '--stablize': 0.0, '--sparsity': 0.0, '--momentsparsity': 0.001, '--npseed': -1, '--torchseed': -1, '--maxiter': 2000, '--recordfile': 'None', '--recordcycle': 200, '--savecycle': -1, '--start_from': -1}
Traceback (most recent call last):
  File "train.py", line 58, in <module>
    globalnames, callback, model, data_model, sampling, addnoise = setenv.setenv(options)
  File "/data/users2/sajad/code/PDE-Net/setenv.py", line 68, in setenv
    globalnames, callback, model = _set_model(options)
  File "/data/users2/sajad/code/PDE-Net/setenv.py", line 45, in _set_model
    model.to(globalnames['device'])
  File "/home/users/mabavisani/anaconda3/envs/PDE-Net-2/lib/python3.7/site-packages/torch/nn/modules/module.py", line 386, in to
    return self._apply(convert)
  File "/home/users/mabavisani/anaconda3/envs/PDE-Net-2/lib/python3.7/site-packages/torch/nn/modules/module.py", line 193, in _apply
    module._apply(fn)
  File "/home/users/mabavisani/anaconda3/envs/PDE-Net-2/lib/python3.7/site-packages/torch/nn/modules/module.py", line 193, in _apply
    module._apply(fn)
  File "/home/users/mabavisani/anaconda3/envs/PDE-Net-2/lib/python3.7/site-packages/torch/nn/modules/module.py", line 205, in _apply
    self._buffers[key] = fn(buf)
  File "/home/users/mabavisani/anaconda3/envs/PDE-Net-2/lib/python3.7/site-packages/torch/nn/modules/module.py", line 384, in convert
    return t.to(device, dtype if t.is_floating_point() else None, non_blocking)
RuntimeError: CUDA error: invalid device ordinal
{'--name': 'burgers-2-upwind-sparse0-noise0.001-id17', '--dtype': 'double', '--device': 'cuda:1', '--constraint': '2', '--dt': 0.01, '--cell_num': 1, '--eps': 6.283185307179586, '--blocks': [0, 1, 2, 3, 4, 5, 6, 9], '--kernel_size': 5, '--max_order': 2, '--dx': 0.19634954084936207, '--hidden_layers': 5, '--scheme': 'upwind', '--dataname': 'burgers', '--viscosity': 0.05, '--zoom': 4, '--max_dt': 0.000625, '--batch_size': 28, '--data_timescheme': 'rk2', '--channel_names': 'u,v', '--freq': 4, '--data_start_time': 1.0, '--start_noise': 0.001, '--end_noise': 0.001, '--stablize': 0.0, '--sparsity': 0.0, '--momentsparsity': 0.001, '--npseed': -1, '--torchseed': -1, '--maxiter': 2000, '--recordfile': 'None', '--recordcycle': 200, '--savecycle': -1, '--start_from': -1}
block:  0
name:  burgers-2-upwind-sparse0-noise0.001-id17
device:  cuda:1
generate a random number to check random seed:  0.08184310050805398
current stage is: warmup
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.7867, device='cuda:1', dtype=torch.float64)
u_obs variance
tensor([ 0.2427,  2.1095,  1.8388, 19.7534, 10.1791, 15.7418,  0.2567,  2.0696,
         2.1452, 17.9843, 10.4387, 19.8935], device='cuda:1',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
iter:     0    time: 7.19
Func: 5.40e+00  |g|: 2.64e+00
stableloss: 1.76e-03   dataloss: 5.40e+00   sparseloss: 2.57e+01 momentloss: 7.27e+00
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 0.039480
         Iterations: 184
         Function evaluations: 247
         Gradient evaluations: 241
convolution moment and kernels
[[1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
[[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 1. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
[[ 0.    1.    0.   -0.33 -0.25]
 [ 0.    0.    0.    0.    0.  ]
 [ 0.    0.    0.    0.    0.  ]
 [ 0.    0.    0.    0.    0.  ]
 [ 0.    0.    0.    0.    0.  ]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]
 [ 2.78e-17  3.33e-16 -1.50e+00  2.00e+00 -5.00e-01]
 [ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]]
[[ 0.    0.    0.    0.    0.  ]
 [ 1.    0.    0.    0.    0.  ]
 [ 0.    0.    0.    0.    0.  ]
 [-0.33  0.    0.    0.    0.  ]
 [-0.25  0.    0.    0.    0.  ]]
[[ 0.00e+00  0.00e+00  2.78e-17  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  3.33e-16  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00 -1.50e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  2.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00 -5.00e-01  0.00e+00  0.00e+00]]
[[0.   0.   1.   0.   0.08]
 [0.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.  ]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]
 [-2.22e-16  1.00e+00 -2.00e+00  1.00e+00 -1.53e-16]
 [ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]]
[[0. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
[[ 6.94e-03 -5.56e-02  9.25e-18  5.56e-02 -6.94e-03]
 [-5.56e-02  4.44e-01 -7.40e-17 -4.44e-01  5.56e-02]
 [ 9.25e-18 -7.40e-17  1.23e-32  7.40e-17 -9.25e-18]
 [ 5.56e-02 -4.44e-01  7.40e-17  4.44e-01 -5.56e-02]
 [-6.94e-03  5.56e-02 -9.25e-18 -5.56e-02  6.94e-03]]
[[0.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.  ]
 [1.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.  ]
 [0.08 0.   0.   0.   0.  ]]
[[ 0.00e+00  0.00e+00 -2.22e-16  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  1.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00 -2.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  1.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00 -1.53e-16  0.00e+00  0.00e+00]]
SymNet parameters
[[ 3.08e-01 -2.87e-01 -5.74e-01 -2.34e-01  1.51e-01 -2.05e-02  8.06e-02 -8.38e-02
  -4.08e-02  2.44e-02 -3.77e-02 -2.34e-02]
 [ 2.18e-01 -9.93e-04 -1.66e-01  7.30e-02 -1.63e-02  3.68e-03  7.26e-01 -5.73e-04
   1.55e-04 -5.11e-03  3.50e-03  2.90e-03]]
SymNet parameters
[0.05 0.04]
SymNet parameters
[[ 0.66 -0.42  0.12  0.26 -0.08 -0.03 -0.41 -0.01  0.03 -0.02  0.03  0.01 -0.02]
 [ 0.69 -0.12  0.08  0.07  0.02  0.05  0.46  0.   -0.    0.   -0.02  0.   -0.06]]
SymNet parameters
[0.07 0.27]
SymNet parameters
[[ 6.72e-01  9.35e-01 -2.94e-01  1.66e-01 -1.69e-01 -3.73e-02  2.26e-02  3.13e-02
   1.74e-02 -2.35e-02  5.49e-02  1.48e-02  2.05e-01  8.44e-03]
 [ 6.31e-01  2.70e-01 -7.93e-02 -6.06e-02  4.91e-02  1.44e-02 -1.67e-01  2.22e-05
   4.48e-04  9.80e-03 -1.60e-02 -3.50e-03 -5.32e-02  4.05e-02]]
SymNet parameters
[0.   0.02]
SymNet parameters
[[-4.99e-01  7.90e-01 -2.63e-01  7.24e-03  2.14e-01  1.79e-02 -7.23e-01 -8.55e-02
  -4.06e-02  1.80e-02 -5.87e-02 -1.58e-02 -2.23e-01  1.10e-01  2.12e-02]
 [ 9.08e-01 -4.30e-01 -3.42e-01 -5.85e-03  3.35e-02  1.67e-02 -2.74e-01  1.97e-03
   7.45e-04  5.38e-03 -1.10e-02 -3.49e-03 -3.19e-02  4.62e-02 -3.08e-02]]
SymNet parameters
[0.2  0.09]
SymNet parameters
[[-1.17e-01 -4.66e-01 -1.04e-01 -2.89e-02 -1.15e-02 -2.05e-02 -1.50e+00 -2.53e-02
  -2.31e-02 -1.27e-03  5.13e-03 -6.20e-04  7.81e-02 -3.50e-02 -3.70e-04 -1.49e-02]
 [-8.71e-01  2.57e-01 -1.12e+00  1.65e-01 -1.60e-01  4.35e-02  1.45e-01  1.06e-01
   3.87e-02 -2.22e-02  3.04e-02  2.79e-02  2.71e-02  1.83e-03 -6.23e-03  3.09e-02]]
SymNet parameters
[-0.   -0.02]
SymNet parameters
[[ 8.55e-03  6.10e-02 -1.29e-02  2.76e-02  6.20e-03  4.07e-02 -2.33e-02  1.13e-03
  -1.83e-05  6.94e-04 -3.83e-03  1.10e-03  6.82e-01  2.62e-01 -5.30e-01 -2.55e-01
  -2.91e-01]]
SymNet parameters
[-0.01]
SymNet parameters
[[-7.09e-01  5.81e-03 -5.47e-03  5.99e-03  5.40e-03 -5.02e-04 -3.69e-02  2.99e-02
   3.64e-02 -3.39e-03  2.03e-02  8.00e-03]
 [ 2.25e-01  3.00e-02 -1.11e-02  3.97e-02  3.03e-02 -7.96e-03  1.56e-01 -1.24e+00
  -2.33e-01 -6.96e-02  1.71e-01  6.70e-02]]
SymNet parameters
[-0.47 -0.23]
SymNet parameters
[[ 0.67 -0.02 -0.02 -0.02 -0.04 -0.01 -0.21  0.04 -0.16 -0.06 -0.02 -0.03 -0.02]
 [ 0.06  0.04 -0.04  0.08  0.06 -0.05 -0.06 -0.1  -0.14 -0.31  0.79  0.23 -0.03]]
SymNet parameters
[-0.06  0.22]
SymNet parameters
[[ 0.31  0.02 -0.01  0.02  0.02 -0.    0.29  0.29 -1.05 -0.01  0.06  0.03 -0.    0.01]
 [-0.51 -0.02  0.   -0.   -0.    0.    0.88 -0.09 -0.14  0.01 -0.02 -0.    0.    0.01]]
SymNet parameters
[-0.33  0.37]
SymNet parameters
[[-2.14e-01  2.03e-02  2.87e-03  3.70e-05 -7.46e-04  8.66e-05 -1.98e-01 -6.20e-02
  -1.14e-02 -2.95e-03 -1.28e-02  1.61e-03  2.25e-03  9.15e-04  4.70e-03]
 [-3.12e-01  6.60e-02 -1.20e-01 -8.22e-02 -1.51e-01 -1.85e-02 -3.04e-01  8.42e-02
  -1.67e-01 -1.16e-01 -7.95e-02 -2.33e-01 -3.18e-01 -7.99e-02  9.09e-02]]
SymNet parameters
[ 0.16 -0.16]
SymNet parameters
[[-0.11 -0.05  0.04 -0.04 -0.    0.02 -0.59 -0.29 -0.8   0.12 -0.2  -0.03  0.06  0.04
  -0.   -0.19]
 [ 0.68  0.02  0.01 -0.02 -0.01  0.01  0.79  0.17  0.44  0.04 -0.06 -0.03 -0.03 -0.02
   0.03 -0.16]]
SymNet parameters
[-0.1  -0.35]
SymNet parameters
[[-0.09 -0.02  0.01 -0.03 -0.03  0.    0.02  0.37  0.23  0.08 -0.11 -0.02 -0.81 -0.06
   0.63 -0.34  0.29]]
SymNet parameters
[0.14]
finally, finish this stage
iter:   184    time: 14.10
Func: 3.95e-02  |g|: 1.40e-02
stableloss: 1.37e-02   dataloss: 3.95e-02   sparseloss: 4.82e+01 momentloss: 7.27e+00
current expression:
[u00*u01, u10*v00, u02, u20, u00, u00**3, u00**2, u00*u01**2, u00**2*u02, 1, u01, u00*v00, v00, u00*v01, u00*u10, u00*u11, u01*u10*v00, u00*u11*v00, u01*u10, u01*v00]
[-0.89 -0.88  0.04  0.04  0.04 -0.02  0.01  0.01 -0.01 -0.01  0.01 -0.01  0.01 -0.01
 -0.01 -0.01  0.    0.   -0.    0.  ]
[v00*v10, u00*v01, v02, v20, u00, v10, u00**2, u00*v10, v01, u00*v00*v10, u00*v00*v11, u00*v01*v10, u00*v02, v00*v10**2, v00, v00**2, u00**2*v01, u00*v00*v02, u10*v01, u00*v00]
[-0.88 -0.88  0.04  0.04  0.02  0.02 -0.01 -0.01  0.01 -0.01  0.01  0.01 -0.01  0.01
  0.01  0.01 -0.01 -0.01 -0.01 -0.  ]
block:  1
name:  burgers-2-upwind-sparse0-noise0.001-id17
device:  cuda:1
generate a random number to check random seed:  0.597238749461346
current stage is: block-1
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.8541, device='cuda:1', dtype=torch.float64)
u_obs variance
tensor([ 0.2512,  2.0349,  2.0641, 19.0424, 10.2623, 18.3609,  0.2673,  2.0807,
         2.3050, 18.2260, 10.8860, 21.8647], device='cuda:1',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
iter:     0    time: 903.29
Func: 4.80e-02  |g|: 5.86e-01
stableloss: 1.62e-02   dataloss: 4.08e-02   sparseloss: 4.82e+01 momentloss: 7.27e+00
iter:   200    time: 10.07
Func: 2.00e-02  |g|: 1.17e-02
stableloss: 1.38e-02   dataloss: 1.35e-02   sparseloss: 4.68e+01 momentloss: 6.45e+00
iter:   400    time: 10.11
Func: 1.92e-02  |g|: 8.07e-03
stableloss: 1.32e-02   dataloss: 1.28e-02   sparseloss: 5.01e+01 momentloss: 6.44e+00
iter:   600    time: 10.07
Func: 1.89e-02  |g|: 3.25e-03
stableloss: 1.31e-02   dataloss: 1.24e-02   sparseloss: 4.88e+01 momentloss: 6.43e+00
iter:   800    time: 10.01
Func: 1.88e-02  |g|: 2.37e-03
stableloss: 1.29e-02   dataloss: 1.24e-02   sparseloss: 5.20e+01 momentloss: 6.44e+00
iter:  1000    time: 10.04
Func: 1.87e-02  |g|: 2.03e-03
stableloss: 1.25e-02   dataloss: 1.23e-02   sparseloss: 5.19e+01 momentloss: 6.44e+00
iter:  1200    time: 10.03
Func: 1.87e-02  |g|: 2.27e-03
stableloss: 1.24e-02   dataloss: 1.22e-02   sparseloss: 5.28e+01 momentloss: 6.43e+00
iter:  1400    time: 10.03
Func: 1.86e-02  |g|: 1.32e-03
stableloss: 1.23e-02   dataloss: 1.22e-02   sparseloss: 5.48e+01 momentloss: 6.43e+00
iter:  1600    time: 10.07
Func: 1.86e-02  |g|: 1.31e-03
stableloss: 1.23e-02   dataloss: 1.22e-02   sparseloss: 5.80e+01 momentloss: 6.43e+00
iter:  1800    time: 10.04
Func: 1.86e-02  |g|: 3.08e-03
stableloss: 1.23e-02   dataloss: 1.22e-02   sparseloss: 6.35e+01 momentloss: 6.42e+00
Warning: Maximum number of iterations has been exceeded.
         Current function value: 0.018566
         Iterations: 2000
         Function evaluations: 2003
         Gradient evaluations: 2003
convolution moment and kernels
[[ 1.00e+00  0.00e+00  1.05e-05 -4.24e-02 -1.71e-02]
 [ 0.00e+00 -1.25e-06  1.65e-03  1.78e-04 -4.10e-03]
 [-3.52e-05  1.28e-03  2.40e-04  4.82e-03  2.95e-03]
 [-5.78e-03 -3.80e-04  1.06e-03  1.13e-05  1.45e-03]
 [-1.82e-02  4.33e-03  5.04e-03 -3.00e-03  2.05e-03]]
[[ 2.41e-03 -3.09e-03 -2.25e-02  9.58e-03 -1.72e-03]
 [-8.90e-03  2.73e-03  1.16e-01 -5.52e-02  1.21e-02]
 [ 2.35e-02  5.97e-04  7.44e-01  1.76e-01 -5.28e-02]
 [-1.73e-02  3.60e-02  7.74e-02 -2.13e-02  3.74e-03]
 [ 4.46e-03 -1.04e-02 -1.74e-02  1.85e-03  3.77e-04]]
[[ 0.00e+00  1.00e+00  0.00e+00 -7.86e-02 -6.94e-02]
 [ 0.00e+00  0.00e+00 -6.47e-04  9.71e-04  3.58e-04]
 [ 0.00e+00  2.05e-02  1.81e-04  2.75e-02 -6.06e-03]
 [ 2.62e-03  1.84e-04  3.23e-04 -2.72e-04 -3.82e-03]
 [ 1.33e-02 -8.36e-03  1.63e-03 -5.02e-03  1.27e-03]]
[[ 6.30e-03 -1.33e-02  3.08e-02 -1.27e-02  9.02e-04]
 [-3.96e-02  7.67e-02 -1.40e-01  4.64e-02  6.05e-03]
 [ 1.16e-01 -5.78e-01 -2.23e-01  9.75e-01 -2.11e-01]
 [-3.23e-02  4.43e-02 -9.31e-02  9.80e-03  1.52e-02]
 [ 2.62e-03  2.22e-03  9.11e-03  3.97e-03 -3.25e-03]]
[[ 0.00e+00  0.00e+00  0.00e+00 -7.03e-03  7.25e-03]
 [ 1.00e+00  0.00e+00  1.59e-02 -3.31e-04 -8.57e-03]
 [ 0.00e+00  9.94e-04  7.01e-03  5.49e-03 -3.72e-03]
 [-9.09e-02 -1.20e-03  6.29e-03  3.34e-03 -1.22e-02]
 [-5.93e-02 -6.52e-03 -2.96e-03  3.12e-03 -3.20e-03]]
[[ 0.   -0.01  0.1  -0.02  0.  ]
 [ 0.   -0.   -0.55  0.04 -0.  ]
 [-0.   -0.01 -0.28 -0.06  0.  ]
 [ 0.02 -0.05  1.02  0.    0.01]
 [-0.01  0.04 -0.23  0.02 -0.01]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00  1.16e-03]
 [ 0.00e+00  0.00e+00  0.00e+00 -3.83e-04 -2.48e-03]
 [ 0.00e+00  0.00e+00  1.38e-03  3.01e-04  3.15e-04]
 [ 0.00e+00 -8.35e-04  6.53e-04  1.16e-03  8.53e-04]
 [ 3.18e-04 -2.24e-03  9.03e-04  2.09e-03 -4.30e-03]]
[[-5.88e-03  2.31e-02 -3.06e-02  1.78e-02 -4.12e-03]
 [ 2.42e-02 -9.40e-02  1.22e-01 -7.00e-02  1.63e-02]
 [-1.16e-01  1.46e+00 -2.66e+00  1.42e+00 -1.02e-01]
 [ 2.08e-02 -7.96e-02  9.55e-02 -4.78e-02  9.80e-03]
 [-5.35e-03  2.07e-02 -2.46e-02  1.18e-02 -2.22e-03]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  7.19e-04]
 [ 0.00e+00  1.00e+00  0.00e+00 -1.19e-03  1.77e-03]
 [ 0.00e+00  0.00e+00  1.04e-03 -7.70e-04 -1.86e-03]
 [ 0.00e+00 -1.09e-03  1.33e-03  1.71e-03 -2.63e-03]
 [-4.14e-05 -1.14e-03 -2.26e-03  1.19e-03  4.43e-03]]
[[ 1.30e-02 -8.31e-02  4.38e-02  2.67e-02 -4.47e-04]
 [-7.86e-02  5.51e-01 -1.73e-01 -3.27e-01  2.86e-02]
 [ 2.82e-02 -1.36e-01  2.32e-01 -1.63e-01  3.84e-02]
 [ 4.30e-02 -3.79e-01 -1.21e-01  5.34e-01 -7.73e-02]
 [-4.93e-03  4.42e-02  2.29e-02 -7.36e-02  1.14e-02]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  2.54e-03]
 [ 0.00e+00  0.00e+00  0.00e+00 -7.99e-04 -2.54e-03]
 [ 1.00e+00  0.00e+00  2.34e-03  4.69e-04 -1.55e-03]
 [ 0.00e+00 -6.37e-04  1.08e-04  1.16e-03  1.65e-03]
 [-5.88e-03 -1.40e-03  6.09e-04  1.41e-03 -1.95e-03]]
[[-3.34e-03  1.34e-02 -1.07e-01  1.05e-02 -2.44e-03]
 [ 1.11e-02 -4.19e-02  1.41e+00 -2.87e-02  6.94e-03]
 [-9.46e-03  3.12e-02 -2.56e+00  5.37e-03 -7.70e-04]
 [ 6.22e-03 -1.97e-02  1.37e+00  2.05e-03 -1.53e-03]
 [-1.98e-03  6.94e-03 -9.51e-02  6.09e-04  3.25e-04]]
SymNet parameters
[[-1.64e-03  3.02e-03 -1.40e-01 -1.30e-02  1.07e-02  2.18e-03  2.44e-02 -7.66e-03
  -6.99e-03 -6.22e-04 -6.03e-04 -8.24e-05]
 [-8.08e-02 -6.63e-02  6.75e-02  5.92e-02  2.20e-02  8.02e-03  1.84e+00 -1.53e-01
  -1.48e-02 -1.48e-03  5.54e-04  4.03e-03]]
SymNet parameters
[ 0.02 -0.07]
SymNet parameters
[[ 1.49e+00  7.27e-01 -1.43e-01  3.63e-03  1.57e-02 -2.25e-04 -2.02e+00  1.11e-01
   3.99e-01  6.97e-03 -9.91e-04  7.51e-03 -2.69e-01]
 [ 3.48e-01  3.29e-03  1.19e+00  8.27e-02 -5.56e-03 -6.62e-02  2.92e-03  6.17e-02
   2.51e-02  7.31e-03  1.25e-03  1.46e-03  4.36e-02]]
SymNet parameters
[-0.14  0.47]
SymNet parameters
[[ 1.46e+00  2.25e-01 -3.68e-02  3.42e-02  7.33e-03  1.15e-03  7.55e-01  2.01e-02
   1.28e-02  2.12e-03  8.14e-04  2.04e-03 -8.92e-02  3.50e-03]
 [ 1.19e-01  8.46e-02 -3.34e-01 -2.23e-01 -7.61e-02 -2.96e-02 -2.63e+00 -1.65e-01
  -9.65e-02 -1.50e-02 -9.84e-04 -1.30e-02  4.65e-01 -1.81e-02]]
SymNet parameters
[ 0.1  -0.33]
SymNet parameters
[[-3.52e-01  6.87e-01  1.10e-01  1.15e-01  3.68e-02  1.33e-02 -6.50e-01  8.15e-02
   3.17e-02  6.30e-03  6.82e-04  5.71e-03 -5.76e-01  1.40e-02 -2.19e-02]
 [ 1.01e+00  6.99e-02 -2.24e-01  2.13e-02  5.82e-03  6.01e-04  4.70e-01  1.68e-02
   1.45e-02  1.25e-03 -2.90e-04  1.48e-03 -9.81e-02  4.30e-03 -1.36e-02]]
SymNet parameters
[0.05 0.47]
SymNet parameters
[[-2.42e-01 -4.92e-01 -2.67e-02 -5.07e-02 -1.80e-02 -4.19e-03 -2.31e+00 -4.22e-02
  -4.30e-02 -4.33e-03 -1.35e-04 -3.69e-03  2.72e-01 -7.50e-03 -1.91e-02 -5.61e-03]
 [-2.18e+00  2.07e-01 -8.34e-01 -4.96e-02 -1.81e-02 -8.55e-03 -1.07e+00 -3.19e-02
  -2.35e-02 -3.57e-03 -4.62e-04 -3.28e-03 -1.11e-01  1.90e-02 -2.51e-03  6.41e-02]]
SymNet parameters
[-0.01 -0.05]
SymNet parameters
[[-2.71e-01  2.24e-01  2.87e-02  7.72e-02  1.05e-02  5.20e-02 -3.48e-01  1.85e-02
   2.50e-03  1.01e-03 -5.26e-04  1.36e-03 -2.66e-02  2.73e-02 -4.11e-01 -7.64e-01
  -4.07e-01]]
SymNet parameters
[0.01]
SymNet parameters
[[-6.82e-01 -1.66e-02  3.95e-03  1.36e-03 -2.68e-04  1.11e-04  4.14e-01  6.24e-03
  -4.77e-03 -2.91e-04  9.25e-03  1.42e-02]
 [-4.06e-01  5.16e-03 -4.40e-02 -5.25e-03  5.02e-03  8.39e-03 -1.00e+00 -1.48e+00
   2.14e-01 -2.23e-02  2.38e-01 -7.61e-02]]
SymNet parameters
[-0.27 -0.19]
SymNet parameters
[[ 8.48e-01 -3.92e-04  4.34e-03  1.39e-03 -1.19e-03 -2.00e-04 -4.68e-02  3.23e-02
  -2.28e-02  7.13e-04 -5.21e-03  5.62e-03 -8.57e-03]
 [ 1.29e-01 -4.14e-01  2.46e-01 -2.07e-02  2.20e-03  6.08e-02  3.92e-01 -1.02e+00
   4.81e-01 -1.07e-01  1.13e+00 -3.52e-01 -1.55e-01]]
SymNet parameters
[-0.35  0.18]
SymNet parameters
[[ 2.06e-01  9.11e-02 -1.19e-01  5.10e-04  4.38e-03 -4.10e-03 -4.65e-01 -6.86e-01
  -7.54e-01 -4.91e-03  9.13e-02  7.18e-04  6.33e-03  6.67e-03]
 [ 1.40e-01 -5.73e-02  2.56e-02  5.80e-03 -1.67e-03  3.62e-04  1.36e+00  3.55e-02
   9.21e-03  2.17e-04  1.83e-02  4.72e-02 -7.52e-03  1.14e-03]]
SymNet parameters
[-0.2   0.63]
SymNet parameters
[[-5.27e-01  1.56e-02 -1.21e-02 -2.79e-03  2.23e-03  1.19e-03 -7.64e-01 -5.19e-02
   2.94e-02 -3.33e-03  1.19e-02 -1.93e-02  4.16e-02  5.88e-03 -2.51e-03]
 [ 1.34e+00 -1.57e-01  2.88e-01 -2.62e-02 -4.19e-03  2.74e-02  2.95e-02 -7.17e-02
  -3.35e-01 -2.24e-02 -8.13e-03 -2.62e-01 -1.61e-02  5.85e-03  3.99e-02]]
SymNet parameters
[ 0.13 -0.07]
SymNet parameters
[[ 1.14e+00 -5.82e-01  3.04e-01  5.86e-02 -1.88e-02 -1.64e-03  3.92e-02  6.02e-01
  -7.29e-02  1.25e-02  8.86e-02  4.72e-01  4.27e-02  3.53e-02 -1.27e-01  9.44e-02]
 [ 6.23e-01 -6.36e-02  7.41e-02 -9.49e-05 -6.24e-03  2.17e-03  1.06e+00  6.59e-02
   8.04e-01  2.33e-03  5.47e-03  4.97e-03 -1.12e-01 -2.72e-02 -1.44e-04 -6.58e-02]]
SymNet parameters
[ 0.06 -0.55]
SymNet parameters
[[ 0.35 -0.05  0.08  0.   -0.01 -0.    0.65  0.89  0.24  0.07 -0.2   0.11 -1.13 -0.21
   0.76 -0.36  0.08]]
SymNet parameters
[0.14]
finally, finish this stage
iter:  2000    time: 10.24
Func: 1.86e-02  |g|: 1.18e-03
stableloss: 1.23e-02   dataloss: 1.21e-02   sparseloss: 6.65e+01 momentloss: 6.42e+00
current expression:
[u00*u01, u10*v00, u20, u02, u00*u01**2, u01*u10*v00, u00*u10*v01, u00*u11*v00, u10*v00*v10, u00, u01*v00, u10*v01, u00**3, 1, u20*v00**2, u00**2*v00, v00, u00**2*v00**2, v01, u00*u01*v00]
[-0.99 -0.98  0.05  0.05  0.01  0.01  0.01  0.01  0.01  0.01 -0.    0.   -0.    0.
  0.    0.   -0.    0.   -0.   -0.  ]
[u00*v01, v00*v10, v02, v20, v00*v10**2, v00, u00*v01*v10, u00*v00*v11, u00*v10, u00*u01*v01, u00, u00*u10*v01, u10*v00*v01, u01*v00*v01, v00**3, u00**2*v00, v00**2*v01, u10*v01, u00*u10, u00*v00]
[-0.99 -0.98  0.05  0.05  0.01  0.01  0.01  0.01 -0.01  0.01  0.   -0.    0.   -0.
 -0.   -0.   -0.   -0.   -0.   -0.  ]
block:  2
name:  burgers-2-upwind-sparse0-noise0.001-id17
device:  cuda:1
generate a random number to check random seed:  -0.7290564282264933
current stage is: block-2
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.7165, device='cuda:1', dtype=torch.float64)
u_obs variance
tensor([ 0.2556,  1.7738,  1.5517, 23.7534, 10.3635, 18.1980,  0.2436,  1.5969,
         1.5811, 19.2877,  9.9402, 20.8164], device='cuda:1',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
iter:     0    time: 459.89
Func: 6.59e-02  |g|: 1.14e+00
stableloss: 2.17e-02   dataloss: 5.31e-02   sparseloss: 6.65e+01 momentloss: 6.42e+00
iter:   200    time: 14.01
Func: 5.70e-02  |g|: 4.19e-02
stableloss: 2.14e-02   dataloss: 4.34e-02   sparseloss: 6.75e+01 momentloss: 6.78e+00
iter:   400    time: 14.02
Func: 5.61e-02  |g|: 1.23e-02
stableloss: 2.11e-02   dataloss: 4.26e-02   sparseloss: 7.06e+01 momentloss: 6.75e+00
iter:   600    time: 14.02
Func: 5.60e-02  |g|: 5.38e-03
stableloss: 2.11e-02   dataloss: 4.25e-02   sparseloss: 7.26e+01 momentloss: 6.75e+00
iter:   800    time: 13.99
Func: 5.60e-02  |g|: 5.12e-03
stableloss: 2.11e-02   dataloss: 4.25e-02   sparseloss: 7.35e+01 momentloss: 6.75e+00
iter:  1000    time: 14.10
Func: 5.59e-02  |g|: 9.68e-03
stableloss: 2.12e-02   dataloss: 4.24e-02   sparseloss: 8.12e+01 momentloss: 6.76e+00
iter:  1200    time: 14.12
Func: 5.58e-02  |g|: 1.31e-02
stableloss: 2.12e-02   dataloss: 4.23e-02   sparseloss: 8.80e+01 momentloss: 6.75e+00
iter:  1400    time: 14.17
Func: 5.58e-02  |g|: 2.08e-02
stableloss: 2.12e-02   dataloss: 4.23e-02   sparseloss: 9.68e+01 momentloss: 6.75e+00
iter:  1600    time: 20.35
Func: 5.58e-02  |g|: 1.10e-02
stableloss: 2.13e-02   dataloss: 4.23e-02   sparseloss: 1.07e+02 momentloss: 6.74e+00
iter:  1800    time: 15.19
Func: 5.57e-02  |g|: 3.81e-02
stableloss: 2.14e-02   dataloss: 4.23e-02   sparseloss: 1.17e+02 momentloss: 6.74e+00
Warning: Maximum number of iterations has been exceeded.
         Current function value: 0.055700
         Iterations: 2000
         Function evaluations: 2007
         Gradient evaluations: 2007
convolution moment and kernels
[[ 1.00e+00  0.00e+00 -5.70e-05  3.64e-03 -6.18e-02]
 [ 0.00e+00 -1.07e-04 -5.04e-03  2.50e-04  3.11e-03]
 [ 1.08e-03 -2.23e-03  4.42e-03  1.33e-03 -5.43e-04]
 [ 4.24e-02 -4.28e-03 -4.49e-04  3.82e-03  4.38e-03]
 [-6.76e-02 -3.22e-03 -2.79e-03  6.10e-04  7.04e-03]]
[[ 0.01 -0.03 -0.05 -0.02  0.  ]
 [-0.03  0.13  0.1   0.13 -0.03]
 [-0.02  0.05  0.55  0.02 -0.01]
 [-0.03  0.13  0.01  0.16 -0.04]
 [ 0.01 -0.03  0.02 -0.05  0.01]]
[[ 0.00e+00  1.00e+00  0.00e+00 -9.94e-02 -8.41e-02]
 [ 0.00e+00  0.00e+00 -4.00e-03  1.49e-03  1.06e-02]
 [ 0.00e+00  2.43e-02 -5.49e-03  4.64e-03 -1.80e-02]
 [ 6.60e-03  1.67e-04 -8.45e-03 -1.01e-03  5.77e-03]
 [ 8.04e-03 -3.48e-03 -1.21e-04 -1.56e-02 -3.23e-03]]
[[ 0.    0.01 -0.03  0.03 -0.01]
 [-0.04  0.07 -0.07 -0.    0.02]
 [ 0.12 -0.57 -0.34  1.07 -0.24]
 [-0.04  0.08 -0.09 -0.    0.02]
 [ 0.01 -0.02  0.02  0.01 -0.01]]
[[ 0.00e+00  0.00e+00  0.00e+00  5.55e-03  2.97e-03]
 [ 1.00e+00  0.00e+00  2.58e-02 -2.32e-03 -3.00e-02]
 [ 0.00e+00 -3.26e-03  6.96e-03  3.01e-04  1.34e-03]
 [-8.61e-02  2.70e-04  5.16e-02 -8.20e-04 -8.72e-03]
 [-5.21e-02 -2.56e-03 -3.30e-03 -1.62e-03  7.80e-06]]
[[ 4.56e-03 -4.35e-02  1.54e-01 -4.39e-02  3.54e-03]
 [ 5.04e-03  2.71e-02 -6.08e-01  2.02e-02  1.16e-02]
 [ 4.61e-03 -4.84e-02 -2.22e-01 -4.82e-02  9.13e-04]
 [-1.12e-02  2.47e-02  9.34e-01  1.99e-02 -5.95e-03]
 [-2.86e-03  3.38e-02 -2.40e-01  3.46e-02 -4.36e-03]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00 -1.07e-03]
 [ 0.00e+00  0.00e+00  0.00e+00 -1.84e-04 -4.05e-03]
 [ 0.00e+00  0.00e+00  1.65e-03  2.69e-04  3.43e-03]
 [ 0.00e+00 -2.55e-03 -3.75e-04  2.51e-03 -9.87e-05]
 [ 4.14e-03 -2.14e-03 -8.39e-04 -3.36e-04 -8.84e-03]]
[[-0.01  0.04 -0.05  0.04 -0.01]
 [ 0.04 -0.16  0.23 -0.16  0.04]
 [-0.14  1.58 -2.83  1.57 -0.15]
 [ 0.04 -0.15  0.19 -0.13  0.04]
 [-0.01  0.04 -0.05  0.03 -0.01]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00 -2.32e-03]
 [ 0.00e+00  1.00e+00  0.00e+00 -2.26e-03 -5.23e-03]
 [ 0.00e+00  0.00e+00  1.24e-03 -1.32e-03 -4.49e-04]
 [ 0.00e+00 -1.97e-03 -2.62e-04  3.02e-03  3.02e-03]
 [-2.10e-03  3.05e-04 -3.12e-03 -2.09e-03  1.65e-03]]
[[ 0.01 -0.06  0.    0.06 -0.01]
 [-0.06  0.48 -0.03 -0.44  0.06]
 [ 0.02 -0.07  0.09 -0.05  0.01]
 [ 0.04 -0.37 -0.11  0.52 -0.07]
 [-0.    0.04  0.03 -0.07  0.01]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  1.19e-01]
 [ 0.00e+00  0.00e+00  0.00e+00  5.27e-04 -3.45e-04]
 [ 1.00e+00  0.00e+00  2.19e-03  5.23e-04  2.67e-04]
 [ 0.00e+00 -1.17e-03 -9.18e-04  9.82e-04  7.75e-05]
 [-8.48e-03 -1.69e-03  3.22e-05 -4.12e-04 -4.49e-03]]
[[-0.    0.02 -0.12  0.02 -0.  ]
 [ 0.02 -0.07  1.47 -0.07  0.02]
 [ 0.09 -0.37 -1.99 -0.38  0.09]
 [ 0.02 -0.07  1.47 -0.06  0.02]
 [-0.    0.02 -0.12  0.02 -0.  ]]
SymNet parameters
[[ 9.36e-03  8.72e-03 -7.44e-02 -1.23e-02  5.75e-03  4.11e-03  3.77e-02 -1.44e-02
  -5.66e-03  5.21e-04 -1.64e-04 -4.97e-04]
 [-6.50e-02 -5.45e-02  5.30e-02  7.94e-02  2.61e-02 -1.07e-02  1.91e+00 -8.53e-02
  -2.86e-02 -4.02e-03  1.55e-03 -2.77e-04]]
SymNet parameters
[1.17 0.01]
SymNet parameters
[[ 1.85e+00  1.68e+00 -1.77e-01 -7.30e-02  2.44e-02  1.43e-03 -3.51e+00 -4.62e-02
   7.28e-01  6.76e-03  1.47e-02  2.84e-02 -3.90e-01]
 [ 4.13e-01 -2.32e-01  1.89e+00  1.91e-01  3.06e-02 -1.46e-01  3.33e-01  2.89e-01
   1.38e-01 -4.12e-03 -1.72e-03  1.63e-02  1.78e-02]]
SymNet parameters
[-0.18  0.62]
SymNet parameters
[[ 1.48e+00  4.91e-02 -6.92e-02  2.18e-02 -8.30e-03 -1.40e-02  6.93e-01  1.64e-03
  -2.21e-02  2.14e-03  5.44e-04 -3.35e-03  7.02e-02  5.39e-04]
 [-6.86e-01 -4.23e-01 -1.59e-01 -3.66e-01 -1.23e-01  4.22e-02 -3.02e+00 -5.05e-01
  -2.31e-01  1.38e-02  2.74e-03 -1.68e-02  5.09e-01 -3.92e-03]]
SymNet parameters
[ 0.01 -0.38]
SymNet parameters
[[-4.84e-01  1.01e+00 -6.24e-02  1.35e-01  3.88e-02 -1.96e-02 -8.98e-01  7.75e-04
  -2.60e-02 -5.20e-03  1.17e-03  4.85e-03 -7.73e-01  5.67e-03 -2.39e-02]
 [ 7.61e-01  3.24e-02 -2.76e-01  4.98e-03 -2.12e-03 -4.00e-03  1.63e-01 -2.45e-04
  -5.03e-04 -1.17e-04 -8.08e-05 -2.41e-05 -3.60e-02  7.66e-04 -7.05e-03]]
SymNet parameters
[-0.03  0.25]
SymNet parameters
[[-3.29e-01 -7.42e-01  6.62e-02 -5.66e-02 -1.87e-02  9.35e-03 -2.78e+00 -3.72e-03
  -2.59e-02  3.50e-03 -6.12e-04  1.44e-04  4.20e-01 -2.61e-03 -1.21e-02  3.01e-03]
 [-2.33e+00  5.78e-02 -7.45e-01 -2.68e-03 -4.50e-03  1.15e-03 -1.07e-01 -3.00e-02
  -1.00e-02 -1.14e-03  8.56e-04  3.79e-04 -1.26e-01  8.16e-03 -4.00e-03  6.77e-02]]
SymNet parameters
[ 0.26 -0.25]
SymNet parameters
[[-2.69e-01  2.30e-01 -9.70e-02  2.73e-02 -7.90e-03  5.24e-02 -9.82e-01  4.63e-02
   1.34e-02  1.57e-03 -1.12e-03  8.43e-04  3.21e-01  7.70e-03 -8.35e-02 -5.66e-01
  -3.29e-01]]
SymNet parameters
[-0.04]
SymNet parameters
[[-1.07e+00 -4.03e-02 -5.46e-03  4.83e-04  4.74e-03  5.08e-03  5.63e-02 -5.55e-02
  -1.45e-02  4.78e-03  7.75e-03  4.16e-02]
 [-2.27e-01 -9.93e-01  6.64e-02  4.70e-02 -1.25e-01 -9.66e-02  2.03e-01  7.86e-01
   1.69e+00 -1.68e-01  9.78e-01 -1.34e+00]]
SymNet parameters
[-0.51 -0.81]
SymNet parameters
[[ 4.19e+00  9.74e-02  2.15e-02 -1.68e-03 -1.80e-02 -1.87e-02 -3.00e-01  1.98e-01
   2.96e-01 -1.91e-02 -1.11e-02 -1.63e-01  1.03e-05]
 [-2.48e-01 -2.35e+00  1.64e-01  1.04e-01 -2.64e-01 -2.03e-01  4.21e+00  2.78e+00
   3.50e+00 -3.67e-01  2.26e+00 -2.87e+00 -9.59e-03]]
SymNet parameters
[1.19 0.54]
SymNet parameters
[[ 2.44e+00  2.25e-01  1.50e-02 -2.63e-03 -9.03e-03 -1.18e-02 -2.37e-01  1.47e-01
  -6.31e-01 -6.35e-03 -6.79e-02 -7.09e-02 -1.24e-02 -1.30e-03]
 [ 1.72e-01  2.32e-01 -7.16e-03 -1.22e-02  3.52e-02  2.75e-02  1.49e+00 -2.38e-01
  -4.57e-01  4.43e-02 -2.11e-01  3.64e-01 -4.79e-03 -2.90e-04]]
SymNet parameters
[0.36 1.03]
SymNet parameters
[[-0.96 -0.1  -0.02  0.01 -0.01 -0.01 -1.12 -0.01  0.6  -0.02  0.06 -0.09  0.23  0.02
  -0.05]
 [ 0.71 -1.42 -0.13  0.02 -0.07 -0.04  1.42 -0.72  1.18 -0.1   0.14 -0.71 -0.44 -0.03
   0.23]]
SymNet parameters
[ 0.38 -1.14]
SymNet parameters
[[-2.85e+00 -2.23e+00 -4.71e-02 -3.01e-02  2.65e-01  2.45e-01 -2.45e-01 -3.46e+00
  -3.09e+00  2.42e-01  4.45e-01  2.37e+00  1.18e+00  1.22e-01 -3.61e-01  2.55e-02]
 [ 5.48e-01 -5.29e-02  2.01e-03  1.81e-03 -5.48e-03 -2.46e-03  1.02e+00 -3.47e-01
   4.66e-01 -5.56e-03  5.64e-02 -5.05e-02 -6.26e-02 -5.30e-03  3.65e-02 -9.10e-03]]
SymNet parameters
[-0.09 -0.68]
SymNet parameters
[[ 0.38  0.28 -0.04 -0.02  0.07  0.06  0.47 -0.25 -0.4   0.14 -0.43  0.75 -2.13 -0.19
   0.81 -0.05  0.03]]
SymNet parameters
[0.67]
finally, finish this stage
iter:  2000    time: 15.32
Func: 5.57e-02  |g|: 2.35e-02
stableloss: 2.14e-02   dataloss: 4.22e-02   sparseloss: 1.26e+02 momentloss: 6.74e+00
current expression:
[u00*u01, u10*v00, u20, u02, u00*u01**2, u00, u00*u11*v00, u01*u10*v00, u00*u10*v01, u10*v00*v10, u00**3, u00*v00, u01*u10, u20*v00**2, u00**2, v00**2, u01*u10*v10, u10*v10, 1, u00*u01*v00]
[-0.98 -0.98  0.05  0.05  0.01  0.01  0.01  0.01  0.01  0.01 -0.    0.   -0.    0.
 -0.    0.    0.   -0.   -0.   -0.  ]
[v00*v10, u00*v01, v02, v20, v00*v10**2, v10, u00*v01*v10, u00*v00*v11, u00*u01*v01, v00, 1, u10*v01, v00**2*v10, u01*v00*v10, v00**2, u01, u00**2, u00*v00**2*v10, u00**2*v00, v01]
[-0.99 -0.98  0.05  0.05  0.01  0.01  0.01  0.01  0.01  0.01 -0.01 -0.   -0.    0.
  0.   -0.    0.    0.   -0.    0.  ]
block:  3
name:  burgers-2-upwind-sparse0-noise0.001-id17
device:  cuda:1
generate a random number to check random seed:  -0.21756684347867017
current stage is: block-3
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.4513, device='cuda:1', dtype=torch.float64)
u_obs variance
tensor([ 0.2522,  1.6925,  1.6652, 22.3830, 10.6422, 18.9019,  0.2406,  1.5518,
         1.6150, 18.6336,  9.7227, 20.7264], device='cuda:1',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 0.125268
         Iterations: 0
         Function evaluations: 15
         Gradient evaluations: 3
convolution moment and kernels
[[ 1.00e+00  0.00e+00 -5.73e-05  3.64e-03 -6.18e-02]
 [ 0.00e+00 -1.07e-04 -5.04e-03  2.50e-04  3.11e-03]
 [ 1.08e-03 -2.23e-03  4.42e-03  1.33e-03 -5.42e-04]
 [ 4.24e-02 -4.28e-03 -4.49e-04  3.82e-03  4.38e-03]
 [-6.76e-02 -3.22e-03 -2.79e-03  6.10e-04  7.04e-03]]
[[ 0.01 -0.03 -0.05 -0.02  0.  ]
 [-0.03  0.13  0.1   0.13 -0.03]
 [-0.02  0.05  0.55  0.02 -0.01]
 [-0.03  0.13  0.01  0.16 -0.04]
 [ 0.01 -0.03  0.02 -0.05  0.01]]
[[ 0.00e+00  1.00e+00  0.00e+00 -9.94e-02 -8.41e-02]
 [ 0.00e+00  0.00e+00 -4.00e-03  1.48e-03  1.06e-02]
 [ 0.00e+00  2.43e-02 -5.49e-03  4.64e-03 -1.80e-02]
 [ 6.60e-03  1.67e-04 -8.45e-03 -1.01e-03  5.77e-03]
 [ 8.04e-03 -3.48e-03 -1.21e-04 -1.56e-02 -3.23e-03]]
[[ 0.    0.01 -0.03  0.03 -0.01]
 [-0.04  0.07 -0.07 -0.    0.02]
 [ 0.12 -0.57 -0.34  1.07 -0.24]
 [-0.04  0.08 -0.09 -0.    0.02]
 [ 0.01 -0.02  0.02  0.01 -0.01]]
[[ 0.00e+00  0.00e+00  0.00e+00  5.55e-03  2.97e-03]
 [ 1.00e+00  0.00e+00  2.58e-02 -2.32e-03 -3.00e-02]
 [ 0.00e+00 -3.26e-03  6.97e-03  3.01e-04  1.34e-03]
 [-8.61e-02  2.70e-04  5.16e-02 -8.20e-04 -8.72e-03]
 [-5.21e-02 -2.56e-03 -3.30e-03 -1.62e-03  7.55e-06]]
[[ 4.56e-03 -4.35e-02  1.54e-01 -4.39e-02  3.54e-03]
 [ 5.04e-03  2.71e-02 -6.08e-01  2.02e-02  1.16e-02]
 [ 4.61e-03 -4.84e-02 -2.22e-01 -4.82e-02  9.15e-04]
 [-1.12e-02  2.47e-02  9.34e-01  1.99e-02 -5.95e-03]
 [-2.86e-03  3.38e-02 -2.40e-01  3.46e-02 -4.36e-03]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00 -1.07e-03]
 [ 0.00e+00  0.00e+00  0.00e+00 -1.84e-04 -4.05e-03]
 [ 0.00e+00  0.00e+00  1.65e-03  2.69e-04  3.43e-03]
 [ 0.00e+00 -2.55e-03 -3.75e-04  2.51e-03 -9.92e-05]
 [ 4.14e-03 -2.14e-03 -8.39e-04 -3.36e-04 -8.84e-03]]
[[-0.01  0.04 -0.05  0.04 -0.01]
 [ 0.04 -0.16  0.23 -0.16  0.04]
 [-0.14  1.58 -2.83  1.57 -0.15]
 [ 0.04 -0.15  0.19 -0.13  0.04]
 [-0.01  0.04 -0.05  0.03 -0.01]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00 -2.32e-03]
 [ 0.00e+00  1.00e+00  0.00e+00 -2.26e-03 -5.23e-03]
 [ 0.00e+00  0.00e+00  1.24e-03 -1.32e-03 -4.49e-04]
 [ 0.00e+00 -1.97e-03 -2.62e-04  3.02e-03  3.02e-03]
 [-2.10e-03  3.05e-04 -3.12e-03 -2.09e-03  1.65e-03]]
[[ 0.01 -0.06  0.    0.06 -0.01]
 [-0.06  0.48 -0.03 -0.44  0.06]
 [ 0.02 -0.07  0.09 -0.05  0.01]
 [ 0.04 -0.37 -0.11  0.52 -0.07]
 [-0.    0.04  0.03 -0.07  0.01]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  1.19e-01]
 [ 0.00e+00  0.00e+00  0.00e+00  5.27e-04 -3.45e-04]
 [ 1.00e+00  0.00e+00  2.19e-03  5.23e-04  2.67e-04]
 [ 0.00e+00 -1.17e-03 -9.18e-04  9.82e-04  7.71e-05]
 [-8.48e-03 -1.69e-03  3.22e-05 -4.12e-04 -4.49e-03]]
[[-0.    0.02 -0.12  0.02 -0.  ]
 [ 0.02 -0.07  1.47 -0.07  0.02]
 [ 0.09 -0.37 -1.99 -0.38  0.09]
 [ 0.02 -0.07  1.47 -0.06  0.02]
 [-0.    0.02 -0.12  0.02 -0.  ]]
SymNet parameters
[[ 9.36e-03  8.72e-03 -7.44e-02 -1.23e-02  5.75e-03  4.11e-03  3.77e-02 -1.44e-02
  -5.66e-03  5.28e-04 -1.61e-04 -4.96e-04]
 [-6.50e-02 -5.45e-02  5.30e-02  7.94e-02  2.61e-02 -1.07e-02  1.91e+00 -8.53e-02
  -2.86e-02 -4.03e-03  1.55e-03 -2.77e-04]]
SymNet parameters
[1.17 0.01]
SymNet parameters
[[ 1.85e+00  1.68e+00 -1.77e-01 -7.30e-02  2.44e-02  1.43e-03 -3.51e+00 -4.62e-02
   7.28e-01  6.76e-03  1.47e-02  2.84e-02 -3.90e-01]
 [ 4.13e-01 -2.32e-01  1.89e+00  1.91e-01  3.06e-02 -1.46e-01  3.33e-01  2.89e-01
   1.38e-01 -4.12e-03 -1.72e-03  1.63e-02  1.78e-02]]
SymNet parameters
[-0.18  0.62]
SymNet parameters
[[ 1.48e+00  4.91e-02 -6.92e-02  2.18e-02 -8.29e-03 -1.40e-02  6.93e-01  1.64e-03
  -2.21e-02  2.14e-03  5.44e-04 -3.35e-03  7.02e-02  5.38e-04]
 [-6.86e-01 -4.23e-01 -1.59e-01 -3.66e-01 -1.23e-01  4.22e-02 -3.02e+00 -5.05e-01
  -2.31e-01  1.38e-02  2.74e-03 -1.68e-02  5.09e-01 -3.92e-03]]
SymNet parameters
[ 0.01 -0.38]
SymNet parameters
[[-4.84e-01  1.01e+00 -6.24e-02  1.35e-01  3.88e-02 -1.96e-02 -8.98e-01  7.75e-04
  -2.60e-02 -5.20e-03  1.17e-03  4.85e-03 -7.73e-01  5.67e-03 -2.39e-02]
 [ 7.61e-01  3.24e-02 -2.76e-01  4.99e-03 -2.12e-03 -4.00e-03  1.63e-01 -2.45e-04
  -5.01e-04 -1.15e-04 -7.89e-05 -2.15e-05 -3.60e-02  7.73e-04 -7.04e-03]]
SymNet parameters
[-0.03  0.25]
SymNet parameters
[[-3.29e-01 -7.42e-01  6.62e-02 -5.66e-02 -1.87e-02  9.35e-03 -2.78e+00 -3.72e-03
  -2.59e-02  3.50e-03 -6.12e-04  1.45e-04  4.20e-01 -2.61e-03 -1.20e-02  3.02e-03]
 [-2.33e+00  5.78e-02 -7.45e-01 -2.67e-03 -4.50e-03  1.15e-03 -1.07e-01 -3.00e-02
  -1.00e-02 -1.14e-03  8.55e-04  3.79e-04 -1.26e-01  8.16e-03 -3.99e-03  6.77e-02]]
SymNet parameters
[ 0.26 -0.25]
SymNet parameters
[[-2.69e-01  2.30e-01 -9.70e-02  2.73e-02 -7.90e-03  5.24e-02 -9.82e-01  4.63e-02
   1.34e-02  1.57e-03 -1.12e-03  8.44e-04  3.21e-01  7.71e-03 -8.35e-02 -5.66e-01
  -3.29e-01]]
SymNet parameters
[-0.04]
SymNet parameters
[[-1.07e+00 -4.03e-02 -5.45e-03  4.31e-04  4.75e-03  5.06e-03  5.63e-02 -5.55e-02
  -1.45e-02  4.67e-03  7.76e-03  4.13e-02]
 [-2.27e-01 -9.93e-01  6.64e-02  4.70e-02 -1.25e-01 -9.66e-02  2.03e-01  7.86e-01
   1.69e+00 -1.68e-01  9.78e-01 -1.34e+00]]
SymNet parameters
[-0.51 -0.81]
SymNet parameters
[[ 4.19e+00  9.74e-02  2.15e-02 -1.69e-03 -1.80e-02 -1.87e-02 -3.00e-01  1.98e-01
   2.96e-01 -1.92e-02 -1.11e-02 -1.63e-01 -1.44e-04]
 [-2.48e-01 -2.35e+00  1.64e-01  1.04e-01 -2.64e-01 -2.03e-01  4.21e+00  2.78e+00
   3.50e+00 -3.67e-01  2.26e+00 -2.87e+00 -9.59e-03]]
SymNet parameters
[1.19 0.54]
SymNet parameters
[[ 2.44e+00  2.25e-01  1.50e-02 -2.64e-03 -9.03e-03 -1.18e-02 -2.37e-01  1.47e-01
  -6.31e-01 -6.37e-03 -6.79e-02 -7.09e-02 -1.24e-02 -8.16e-04]
 [ 1.72e-01  2.32e-01 -7.16e-03 -1.22e-02  3.52e-02  2.75e-02  1.49e+00 -2.38e-01
  -4.57e-01  4.43e-02 -2.11e-01  3.64e-01 -4.78e-03 -3.61e-04]]
SymNet parameters
[0.36 1.03]
SymNet parameters
[[-0.96 -0.1  -0.02  0.01 -0.01 -0.01 -1.12 -0.01  0.6  -0.02  0.06 -0.09  0.23  0.02
  -0.05]
 [ 0.71 -1.42 -0.13  0.02 -0.07 -0.04  1.42 -0.72  1.18 -0.1   0.14 -0.71 -0.44 -0.03
   0.23]]
SymNet parameters
[ 0.38 -1.14]
SymNet parameters
[[-2.85e+00 -2.23e+00 -4.71e-02 -3.01e-02  2.65e-01  2.45e-01 -2.45e-01 -3.46e+00
  -3.09e+00  2.42e-01  4.45e-01  2.37e+00  1.18e+00  1.22e-01 -3.61e-01  2.55e-02]
 [ 5.48e-01 -5.30e-02  2.01e-03  1.81e-03 -5.48e-03 -2.46e-03  1.02e+00 -3.47e-01
   4.66e-01 -5.56e-03  5.64e-02 -5.05e-02 -6.27e-02 -5.16e-03  3.64e-02 -9.11e-03]]
SymNet parameters
[-0.09 -0.68]
SymNet parameters
[[ 0.38  0.28 -0.04 -0.02  0.07  0.06  0.47 -0.25 -0.4   0.14 -0.43  0.75 -2.13 -0.19
   0.81 -0.05  0.03]]
SymNet parameters
[0.67]
finally, finish this stage
iter:     0    time: 565.83
Func: 1.25e-01  |g|: 3.28e+01
stableloss: 1.86e-02   dataloss: 1.05e-01   sparseloss: 1.26e+02 momentloss: 6.74e+00
current expression:
[u00*u01, u10*v00, u20, u02, u00*u01**2, u00, u00*u11*v00, u01*u10*v00, u00*u10*v01, u10*v00*v10, u00**3, u00*v00, u01*u10, u20*v00**2, u00**2, v00**2, u01*u10*v10, u10*v10, 1, u00*u01*v00]
[-0.98 -0.98  0.05  0.05  0.01  0.01  0.01  0.01  0.01  0.01 -0.    0.   -0.    0.
 -0.    0.    0.   -0.   -0.   -0.  ]
[v00*v10, u00*v01, v02, v20, v00*v10**2, v10, u00*v01*v10, u00*v00*v11, u00*u01*v01, v00, 1, u10*v01, v00**2*v10, u01*v00*v10, v00**2, u01, u00**2, u00*v00**2*v10, u00**2*v00, v01]
[-0.99 -0.98  0.05  0.05  0.01  0.01  0.01  0.01  0.01  0.01 -0.01 -0.   -0.    0.
  0.   -0.    0.    0.   -0.    0.  ]
block:  4
name:  burgers-2-upwind-sparse0-noise0.001-id17
device:  cuda:1
generate a random number to check random seed:  -0.6032283588210187
current stage is: block-4
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.9816, device='cuda:1', dtype=torch.float64)
u_obs variance
tensor([ 0.2769,  1.7533,  1.7576, 22.7459,  9.8203, 19.5041,  0.2561,  1.5960,
         1.7561, 18.4780,  9.7136, 23.3349], device='cuda:1',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 0.328991
         Iterations: 0
         Function evaluations: 15
         Gradient evaluations: 3
convolution moment and kernels
[[ 1.00e+00  0.00e+00 -5.71e-05  3.64e-03 -6.18e-02]
 [ 0.00e+00 -1.06e-04 -5.04e-03  2.50e-04  3.11e-03]
 [ 1.08e-03 -2.23e-03  4.42e-03  1.33e-03 -5.42e-04]
 [ 4.24e-02 -4.28e-03 -4.49e-04  3.82e-03  4.38e-03]
 [-6.76e-02 -3.22e-03 -2.79e-03  6.10e-04  7.04e-03]]
[[ 0.01 -0.03 -0.05 -0.02  0.  ]
 [-0.03  0.13  0.1   0.13 -0.03]
 [-0.02  0.05  0.55  0.02 -0.01]
 [-0.03  0.13  0.01  0.16 -0.04]
 [ 0.01 -0.03  0.02 -0.05  0.01]]
[[ 0.00e+00  1.00e+00  0.00e+00 -9.94e-02 -8.41e-02]
 [ 0.00e+00  0.00e+00 -4.00e-03  1.48e-03  1.06e-02]
 [ 0.00e+00  2.43e-02 -5.49e-03  4.64e-03 -1.80e-02]
 [ 6.60e-03  1.67e-04 -8.45e-03 -1.01e-03  5.77e-03]
 [ 8.03e-03 -3.48e-03 -1.20e-04 -1.56e-02 -3.23e-03]]
[[ 0.    0.01 -0.03  0.03 -0.01]
 [-0.04  0.07 -0.07 -0.    0.02]
 [ 0.12 -0.57 -0.34  1.07 -0.24]
 [-0.04  0.08 -0.09 -0.    0.02]
 [ 0.01 -0.02  0.02  0.01 -0.01]]
[[ 0.00e+00  0.00e+00  0.00e+00  5.55e-03  2.97e-03]
 [ 1.00e+00  0.00e+00  2.58e-02 -2.32e-03 -3.00e-02]
 [ 0.00e+00 -3.26e-03  6.96e-03  3.01e-04  1.34e-03]
 [-8.61e-02  2.70e-04  5.16e-02 -8.20e-04 -8.72e-03]
 [-5.21e-02 -2.56e-03 -3.30e-03 -1.62e-03  7.63e-06]]
[[ 4.56e-03 -4.35e-02  1.54e-01 -4.39e-02  3.54e-03]
 [ 5.04e-03  2.71e-02 -6.08e-01  2.02e-02  1.16e-02]
 [ 4.61e-03 -4.84e-02 -2.22e-01 -4.82e-02  9.11e-04]
 [-1.12e-02  2.47e-02  9.34e-01  1.99e-02 -5.95e-03]
 [-2.86e-03  3.38e-02 -2.40e-01  3.46e-02 -4.36e-03]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00 -1.07e-03]
 [ 0.00e+00  0.00e+00  0.00e+00 -1.84e-04 -4.05e-03]
 [ 0.00e+00  0.00e+00  1.65e-03  2.69e-04  3.43e-03]
 [ 0.00e+00 -2.55e-03 -3.75e-04  2.51e-03 -9.88e-05]
 [ 4.13e-03 -2.14e-03 -8.39e-04 -3.36e-04 -8.84e-03]]
[[-0.01  0.04 -0.05  0.04 -0.01]
 [ 0.04 -0.16  0.23 -0.16  0.04]
 [-0.14  1.58 -2.83  1.57 -0.15]
 [ 0.04 -0.15  0.19 -0.13  0.04]
 [-0.01  0.04 -0.05  0.03 -0.01]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00 -2.32e-03]
 [ 0.00e+00  1.00e+00  0.00e+00 -2.26e-03 -5.23e-03]
 [ 0.00e+00  0.00e+00  1.24e-03 -1.32e-03 -4.49e-04]
 [ 0.00e+00 -1.97e-03 -2.62e-04  3.02e-03  3.02e-03]
 [-2.10e-03  3.05e-04 -3.12e-03 -2.09e-03  1.65e-03]]
[[ 0.01 -0.06  0.    0.06 -0.01]
 [-0.06  0.48 -0.03 -0.44  0.06]
 [ 0.02 -0.07  0.09 -0.05  0.01]
 [ 0.04 -0.37 -0.11  0.52 -0.07]
 [-0.    0.04  0.03 -0.07  0.01]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  1.19e-01]
 [ 0.00e+00  0.00e+00  0.00e+00  5.27e-04 -3.45e-04]
 [ 1.00e+00  0.00e+00  2.19e-03  5.23e-04  2.67e-04]
 [ 0.00e+00 -1.17e-03 -9.18e-04  9.82e-04  7.75e-05]
 [-8.48e-03 -1.69e-03  3.23e-05 -4.12e-04 -4.49e-03]]
[[-0.    0.02 -0.12  0.02 -0.  ]
 [ 0.02 -0.07  1.47 -0.07  0.02]
 [ 0.09 -0.37 -1.99 -0.38  0.09]
 [ 0.02 -0.07  1.47 -0.06  0.02]
 [-0.    0.02 -0.12  0.02 -0.  ]]
SymNet parameters
[[ 9.36e-03  8.72e-03 -7.44e-02 -1.23e-02  5.75e-03  4.11e-03  3.77e-02 -1.44e-02
  -5.66e-03  5.21e-04 -1.63e-04 -4.99e-04]
 [-6.50e-02 -5.45e-02  5.30e-02  7.94e-02  2.61e-02 -1.07e-02  1.91e+00 -8.53e-02
  -2.86e-02 -4.03e-03  1.55e-03 -2.78e-04]]
SymNet parameters
[1.17 0.01]
SymNet parameters
[[ 1.85e+00  1.68e+00 -1.77e-01 -7.30e-02  2.44e-02  1.43e-03 -3.51e+00 -4.62e-02
   7.28e-01  6.76e-03  1.47e-02  2.84e-02 -3.90e-01]
 [ 4.13e-01 -2.32e-01  1.89e+00  1.91e-01  3.06e-02 -1.46e-01  3.33e-01  2.89e-01
   1.38e-01 -4.12e-03 -1.72e-03  1.63e-02  1.78e-02]]
SymNet parameters
[-0.18  0.62]
SymNet parameters
[[ 1.48e+00  4.91e-02 -6.92e-02  2.18e-02 -8.30e-03 -1.40e-02  6.93e-01  1.64e-03
  -2.21e-02  2.14e-03  5.44e-04 -3.35e-03  7.02e-02  5.38e-04]
 [-6.86e-01 -4.23e-01 -1.59e-01 -3.66e-01 -1.23e-01  4.22e-02 -3.02e+00 -5.05e-01
  -2.31e-01  1.38e-02  2.74e-03 -1.68e-02  5.09e-01 -3.92e-03]]
SymNet parameters
[ 0.01 -0.38]
SymNet parameters
[[-4.84e-01  1.01e+00 -6.24e-02  1.35e-01  3.88e-02 -1.96e-02 -8.98e-01  7.75e-04
  -2.60e-02 -5.20e-03  1.17e-03  4.85e-03 -7.73e-01  5.67e-03 -2.39e-02]
 [ 7.61e-01  3.24e-02 -2.76e-01  4.99e-03 -2.12e-03 -4.00e-03  1.63e-01 -2.45e-04
  -5.03e-04 -1.16e-04 -8.03e-05 -2.38e-05 -3.60e-02  7.65e-04 -7.05e-03]]
SymNet parameters
[-0.03  0.25]
SymNet parameters
[[-3.29e-01 -7.42e-01  6.62e-02 -5.66e-02 -1.87e-02  9.35e-03 -2.78e+00 -3.72e-03
  -2.59e-02  3.50e-03 -6.12e-04  1.43e-04  4.20e-01 -2.60e-03 -1.21e-02  3.02e-03]
 [-2.33e+00  5.78e-02 -7.45e-01 -2.68e-03 -4.50e-03  1.15e-03 -1.07e-01 -3.00e-02
  -1.00e-02 -1.14e-03  8.56e-04  3.79e-04 -1.26e-01  8.16e-03 -4.00e-03  6.77e-02]]
SymNet parameters
[ 0.26 -0.25]
SymNet parameters
[[-2.69e-01  2.30e-01 -9.70e-02  2.73e-02 -7.90e-03  5.24e-02 -9.82e-01  4.63e-02
   1.34e-02  1.57e-03 -1.12e-03  8.43e-04  3.21e-01  7.70e-03 -8.35e-02 -5.66e-01
  -3.29e-01]]
SymNet parameters
[-0.04]
SymNet parameters
[[-1.07e+00 -4.03e-02 -5.47e-03  4.77e-04  4.74e-03  5.06e-03  5.63e-02 -5.55e-02
  -1.45e-02  4.79e-03  7.77e-03  4.17e-02]
 [-2.27e-01 -9.93e-01  6.64e-02  4.70e-02 -1.25e-01 -9.66e-02  2.03e-01  7.86e-01
   1.69e+00 -1.68e-01  9.78e-01 -1.34e+00]]
SymNet parameters
[-0.51 -0.81]
SymNet parameters
[[ 4.19e+00  9.74e-02  2.15e-02 -1.68e-03 -1.80e-02 -1.87e-02 -3.00e-01  1.98e-01
   2.96e-01 -1.91e-02 -1.11e-02 -1.63e-01 -1.08e-04]
 [-2.48e-01 -2.35e+00  1.64e-01  1.04e-01 -2.64e-01 -2.03e-01  4.21e+00  2.78e+00
   3.50e+00 -3.67e-01  2.26e+00 -2.87e+00 -9.60e-03]]
SymNet parameters
[1.19 0.54]
SymNet parameters
[[ 2.44e+00  2.25e-01  1.50e-02 -2.63e-03 -9.03e-03 -1.18e-02 -2.37e-01  1.47e-01
  -6.31e-01 -6.35e-03 -6.79e-02 -7.09e-02 -1.24e-02 -7.05e-04]
 [ 1.72e-01  2.32e-01 -7.16e-03 -1.22e-02  3.52e-02  2.75e-02  1.49e+00 -2.38e-01
  -4.57e-01  4.43e-02 -2.11e-01  3.64e-01 -4.78e-03 -4.42e-04]]
SymNet parameters
[0.36 1.03]
SymNet parameters
[[-0.96 -0.1  -0.02  0.01 -0.01 -0.01 -1.12 -0.01  0.6  -0.02  0.06 -0.09  0.23  0.02
  -0.05]
 [ 0.71 -1.42 -0.13  0.02 -0.07 -0.04  1.42 -0.72  1.18 -0.1   0.14 -0.71 -0.44 -0.03
   0.23]]
SymNet parameters
[ 0.38 -1.14]
SymNet parameters
[[-2.85e+00 -2.23e+00 -4.71e-02 -3.01e-02  2.65e-01  2.45e-01 -2.45e-01 -3.46e+00
  -3.09e+00  2.42e-01  4.45e-01  2.37e+00  1.18e+00  1.22e-01 -3.61e-01  2.55e-02]
 [ 5.48e-01 -5.29e-02  2.01e-03  1.81e-03 -5.48e-03 -2.46e-03  1.02e+00 -3.47e-01
   4.66e-01 -5.56e-03  5.64e-02 -5.05e-02 -6.27e-02 -5.13e-03  3.65e-02 -9.10e-03]]
SymNet parameters
[-0.09 -0.68]
SymNet parameters
[[ 0.38  0.28 -0.04 -0.02  0.07  0.06  0.47 -0.25 -0.4   0.14 -0.43  0.75 -2.13 -0.19
   0.81 -0.05  0.03]]
SymNet parameters
[0.67]
finally, finish this stage
iter:     0    time: 50.68
Func: 3.29e-01  |g|: 3.42e+02
stableloss: 3.88e-02   dataloss: 3.02e-01   sparseloss: 1.26e+02 momentloss: 6.74e+00
current expression:
[u00*u01, u10*v00, u20, u02, u00*u01**2, u00, u00*u11*v00, u01*u10*v00, u00*u10*v01, u10*v00*v10, u00**3, u00*v00, u01*u10, u20*v00**2, u00**2, v00**2, u01*u10*v10, u10*v10, 1, u00*u01*v00]
[-0.98 -0.98  0.05  0.05  0.01  0.01  0.01  0.01  0.01  0.01 -0.    0.   -0.    0.
 -0.    0.    0.   -0.   -0.   -0.  ]
[v00*v10, u00*v01, v02, v20, v00*v10**2, v10, u00*v01*v10, u00*v00*v11, u00*u01*v01, v00, 1, u10*v01, v00**2*v10, u01*v00*v10, v00**2, u01, u00**2, u00*v00**2*v10, u00**2*v00, v01]
[-0.99 -0.98  0.05  0.05  0.01  0.01  0.01  0.01  0.01  0.01 -0.01 -0.   -0.    0.
  0.   -0.    0.    0.   -0.    0.  ]
block:  5
name:  burgers-2-upwind-sparse0-noise0.001-id17
device:  cuda:1
generate a random number to check random seed:  -1.9424384203691307
current stage is: block-5
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.9613, device='cuda:1', dtype=torch.float64)
u_obs variance
tensor([ 0.2608,  1.7519,  1.6206, 22.7680, 10.1172, 18.2498,  0.2337,  1.6287,
         1.6827, 19.8408, 10.6358, 21.7642], device='cuda:1',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 0.488101
         Iterations: 0
         Function evaluations: 15
         Gradient evaluations: 3
convolution moment and kernels
[[ 1.00e+00  0.00e+00 -5.71e-05  3.64e-03 -6.18e-02]
 [ 0.00e+00 -1.07e-04 -5.04e-03  2.50e-04  3.11e-03]
 [ 1.08e-03 -2.23e-03  4.42e-03  1.33e-03 -5.42e-04]
 [ 4.24e-02 -4.28e-03 -4.49e-04  3.82e-03  4.38e-03]
 [-6.76e-02 -3.22e-03 -2.79e-03  6.10e-04  7.04e-03]]
[[ 0.01 -0.03 -0.05 -0.02  0.  ]
 [-0.03  0.13  0.1   0.13 -0.03]
 [-0.02  0.05  0.55  0.02 -0.01]
 [-0.03  0.13  0.01  0.16 -0.04]
 [ 0.01 -0.03  0.02 -0.05  0.01]]
[[ 0.00e+00  1.00e+00  0.00e+00 -9.94e-02 -8.41e-02]
 [ 0.00e+00  0.00e+00 -4.00e-03  1.48e-03  1.06e-02]
 [ 0.00e+00  2.43e-02 -5.49e-03  4.64e-03 -1.80e-02]
 [ 6.60e-03  1.67e-04 -8.45e-03 -1.01e-03  5.77e-03]
 [ 8.03e-03 -3.48e-03 -1.20e-04 -1.56e-02 -3.23e-03]]
[[ 0.    0.01 -0.03  0.03 -0.01]
 [-0.04  0.07 -0.07 -0.    0.02]
 [ 0.12 -0.57 -0.34  1.07 -0.24]
 [-0.04  0.08 -0.09 -0.    0.02]
 [ 0.01 -0.02  0.02  0.01 -0.01]]
[[ 0.00e+00  0.00e+00  0.00e+00  5.55e-03  2.97e-03]
 [ 1.00e+00  0.00e+00  2.58e-02 -2.32e-03 -3.00e-02]
 [ 0.00e+00 -3.26e-03  6.96e-03  3.01e-04  1.34e-03]
 [-8.61e-02  2.70e-04  5.16e-02 -8.20e-04 -8.72e-03]
 [-5.21e-02 -2.56e-03 -3.30e-03 -1.62e-03  6.40e-06]]
[[ 4.56e-03 -4.35e-02  1.54e-01 -4.39e-02  3.53e-03]
 [ 5.04e-03  2.71e-02 -6.08e-01  2.01e-02  1.16e-02]
 [ 4.60e-03 -4.83e-02 -2.22e-01 -4.81e-02  9.00e-04]
 [-1.11e-02  2.46e-02  9.34e-01  1.98e-02 -5.94e-03]
 [-2.86e-03  3.38e-02 -2.40e-01  3.46e-02 -4.36e-03]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00 -1.07e-03]
 [ 0.00e+00  0.00e+00  0.00e+00 -1.84e-04 -4.05e-03]
 [ 0.00e+00  0.00e+00  1.65e-03  2.69e-04  3.43e-03]
 [ 0.00e+00 -2.55e-03 -3.75e-04  2.51e-03 -9.89e-05]
 [ 4.13e-03 -2.14e-03 -8.39e-04 -3.36e-04 -8.84e-03]]
[[-0.01  0.04 -0.05  0.04 -0.01]
 [ 0.04 -0.16  0.23 -0.16  0.04]
 [-0.14  1.58 -2.83  1.57 -0.15]
 [ 0.04 -0.15  0.19 -0.13  0.04]
 [-0.01  0.04 -0.05  0.03 -0.01]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00 -2.32e-03]
 [ 0.00e+00  1.00e+00  0.00e+00 -2.26e-03 -5.23e-03]
 [ 0.00e+00  0.00e+00  1.24e-03 -1.32e-03 -4.49e-04]
 [ 0.00e+00 -1.97e-03 -2.62e-04  3.02e-03  3.02e-03]
 [-2.10e-03  3.05e-04 -3.12e-03 -2.09e-03  1.65e-03]]
[[ 0.01 -0.06  0.    0.06 -0.01]
 [-0.06  0.48 -0.03 -0.44  0.06]
 [ 0.02 -0.07  0.09 -0.05  0.01]
 [ 0.04 -0.37 -0.11  0.52 -0.07]
 [-0.    0.04  0.03 -0.07  0.01]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  1.19e-01]
 [ 0.00e+00  0.00e+00  0.00e+00  5.27e-04 -3.45e-04]
 [ 1.00e+00  0.00e+00  2.19e-03  5.23e-04  2.67e-04]
 [ 0.00e+00 -1.17e-03 -9.18e-04  9.82e-04  7.74e-05]
 [-8.48e-03 -1.69e-03  3.22e-05 -4.12e-04 -4.49e-03]]
[[-0.    0.02 -0.12  0.02 -0.  ]
 [ 0.02 -0.07  1.47 -0.07  0.02]
 [ 0.09 -0.37 -1.99 -0.38  0.09]
 [ 0.02 -0.07  1.47 -0.06  0.02]
 [-0.    0.02 -0.12  0.02 -0.  ]]
SymNet parameters
[[ 9.36e-03  8.72e-03 -7.44e-02 -1.23e-02  5.75e-03  4.11e-03  3.77e-02 -1.44e-02
  -5.66e-03  5.20e-04 -1.60e-04 -4.97e-04]
 [-6.50e-02 -5.45e-02  5.30e-02  7.94e-02  2.61e-02 -1.07e-02  1.91e+00 -8.53e-02
  -2.86e-02 -4.03e-03  1.55e-03 -2.77e-04]]
SymNet parameters
[1.17 0.01]
SymNet parameters
[[ 1.85e+00  1.68e+00 -1.77e-01 -7.30e-02  2.44e-02  1.43e-03 -3.51e+00 -4.62e-02
   7.28e-01  6.76e-03  1.47e-02  2.84e-02 -3.90e-01]
 [ 4.13e-01 -2.32e-01  1.89e+00  1.91e-01  3.06e-02 -1.46e-01  3.33e-01  2.89e-01
   1.38e-01 -4.12e-03 -1.72e-03  1.63e-02  1.78e-02]]
SymNet parameters
[-0.18  0.62]
SymNet parameters
[[ 1.48e+00  4.91e-02 -6.92e-02  2.18e-02 -8.30e-03 -1.40e-02  6.93e-01  1.64e-03
  -2.21e-02  2.14e-03  5.44e-04 -3.36e-03  7.02e-02  5.40e-04]
 [-6.86e-01 -4.23e-01 -1.59e-01 -3.66e-01 -1.23e-01  4.22e-02 -3.02e+00 -5.05e-01
  -2.31e-01  1.38e-02  2.74e-03 -1.68e-02  5.09e-01 -3.93e-03]]
SymNet parameters
[ 0.01 -0.38]
SymNet parameters
[[-4.84e-01  1.01e+00 -6.24e-02  1.35e-01  3.88e-02 -1.96e-02 -8.98e-01  7.76e-04
  -2.60e-02 -5.20e-03  1.16e-03  4.85e-03 -7.73e-01  5.67e-03 -2.39e-02]
 [ 7.61e-01  3.24e-02 -2.76e-01  4.99e-03 -2.12e-03 -4.00e-03  1.63e-01 -2.46e-04
  -5.03e-04 -1.21e-04 -7.78e-05 -2.63e-05 -3.60e-02  7.96e-04 -7.04e-03]]
SymNet parameters
[-0.03  0.25]
SymNet parameters
[[-3.29e-01 -7.42e-01  6.62e-02 -5.66e-02 -1.87e-02  9.35e-03 -2.78e+00 -3.72e-03
  -2.59e-02  3.50e-03 -6.10e-04  1.44e-04  4.20e-01 -2.60e-03 -1.20e-02  3.02e-03]
 [-2.33e+00  5.78e-02 -7.45e-01 -2.68e-03 -4.51e-03  1.15e-03 -1.07e-01 -3.00e-02
  -1.00e-02 -1.14e-03  8.56e-04  3.78e-04 -1.26e-01  8.16e-03 -4.00e-03  6.77e-02]]
SymNet parameters
[ 0.26 -0.25]
SymNet parameters
[[-2.69e-01  2.30e-01 -9.70e-02  2.73e-02 -7.90e-03  5.24e-02 -9.82e-01  4.63e-02
   1.34e-02  1.57e-03 -1.12e-03  8.43e-04  3.21e-01  7.70e-03 -8.35e-02 -5.66e-01
  -3.29e-01]]
SymNet parameters
[-0.04]
SymNet parameters
[[-1.07e+00 -4.03e-02 -5.47e-03  4.31e-04  4.73e-03  5.03e-03  5.63e-02 -5.55e-02
  -1.45e-02  4.80e-03  7.77e-03  4.17e-02]
 [-2.27e-01 -9.93e-01  6.64e-02  4.70e-02 -1.25e-01 -9.66e-02  2.03e-01  7.86e-01
   1.69e+00 -1.68e-01  9.78e-01 -1.34e+00]]
SymNet parameters
[-0.51 -0.81]
SymNet parameters
[[ 4.19e+00  9.74e-02  2.15e-02 -1.69e-03 -1.80e-02 -1.87e-02 -3.00e-01  1.98e-01
   2.96e-01 -1.91e-02 -1.11e-02 -1.63e-01 -5.50e-05]
 [-2.48e-01 -2.35e+00  1.64e-01  1.04e-01 -2.64e-01 -2.03e-01  4.21e+00  2.78e+00
   3.50e+00 -3.67e-01  2.26e+00 -2.87e+00 -9.60e-03]]
SymNet parameters
[1.19 0.54]
SymNet parameters
[[ 2.44e+00  2.25e-01  1.50e-02 -2.64e-03 -9.03e-03 -1.18e-02 -2.37e-01  1.47e-01
  -6.31e-01 -6.35e-03 -6.79e-02 -7.09e-02 -1.24e-02 -9.76e-04]
 [ 1.72e-01  2.32e-01 -7.16e-03 -1.22e-02  3.52e-02  2.75e-02  1.49e+00 -2.38e-01
  -4.57e-01  4.43e-02 -2.11e-01  3.64e-01 -4.76e-03 -6.14e-04]]
SymNet parameters
[0.36 1.03]
SymNet parameters
[[-0.96 -0.1  -0.02  0.01 -0.01 -0.01 -1.12 -0.01  0.6  -0.02  0.06 -0.09  0.23  0.02
  -0.05]
 [ 0.71 -1.42 -0.13  0.02 -0.07 -0.04  1.42 -0.72  1.18 -0.1   0.14 -0.71 -0.44 -0.03
   0.23]]
SymNet parameters
[ 0.38 -1.14]
SymNet parameters
[[-2.85e+00 -2.23e+00 -4.71e-02 -3.01e-02  2.65e-01  2.45e-01 -2.45e-01 -3.46e+00
  -3.09e+00  2.42e-01  4.45e-01  2.37e+00  1.18e+00  1.22e-01 -3.61e-01  2.55e-02]
 [ 5.48e-01 -5.29e-02  2.01e-03  1.81e-03 -5.48e-03 -2.46e-03  1.02e+00 -3.47e-01
   4.66e-01 -5.56e-03  5.64e-02 -5.05e-02 -6.27e-02 -5.19e-03  3.65e-02 -9.10e-03]]
SymNet parameters
[-0.09 -0.68]
SymNet parameters
[[ 0.38  0.28 -0.04 -0.02  0.07  0.06  0.47 -0.25 -0.4   0.14 -0.43  0.75 -2.13 -0.19
   0.81 -0.05  0.03]]
SymNet parameters
[0.67]
finally, finish this stage
iter:     0    time: 52.51
Func: 4.88e-01  |g|: 2.10e+02
stableloss: 5.08e-02   dataloss: 4.54e-01   sparseloss: 1.26e+02 momentloss: 6.74e+00
current expression:
[u00*u01, u10*v00, u20, u02, u00*u01**2, u00, u00*u11*v00, u01*u10*v00, u00*u10*v01, u10*v00*v10, u00**3, u00*v00, u01*u10, u20*v00**2, u00**2, v00**2, u01*u10*v10, u10*v10, 1, u00*u01*v00]
[-0.98 -0.98  0.05  0.05  0.01  0.01  0.01  0.01  0.01  0.01 -0.    0.   -0.    0.
 -0.    0.    0.   -0.   -0.   -0.  ]
[v00*v10, u00*v01, v02, v20, v00*v10**2, v10, u00*v01*v10, u00*v00*v11, u00*u01*v01, v00, 1, u10*v01, v00**2*v10, u01*v00*v10, v00**2, u01, u00**2, u00*v00**2*v10, u00**2*v00, v01]
[-0.99 -0.98  0.05  0.05  0.01  0.01  0.01  0.01  0.01  0.01 -0.01 -0.   -0.    0.
  0.   -0.    0.    0.   -0.    0.  ]
block:  6
name:  burgers-2-upwind-sparse0-noise0.001-id17
device:  cuda:1
generate a random number to check random seed:  0.499291921032475
current stage is: block-6
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.8007, device='cuda:1', dtype=torch.float64)
u_obs variance
tensor([ 0.2514,  1.6552,  1.7339, 22.0813, 10.5550, 20.2036,  0.2417,  1.6362,
         1.6715, 19.6782, 10.4174, 21.0372], device='cuda:1',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 0.770046
         Iterations: 0
         Function evaluations: 15
         Gradient evaluations: 3
convolution moment and kernels
[[ 1.00e+00  0.00e+00 -5.69e-05  3.64e-03 -6.18e-02]
 [ 0.00e+00 -1.07e-04 -5.04e-03  2.50e-04  3.11e-03]
 [ 1.08e-03 -2.23e-03  4.42e-03  1.33e-03 -5.42e-04]
 [ 4.24e-02 -4.28e-03 -4.49e-04  3.82e-03  4.38e-03]
 [-6.76e-02 -3.22e-03 -2.79e-03  6.10e-04  7.04e-03]]
[[ 0.01 -0.03 -0.05 -0.02  0.  ]
 [-0.03  0.13  0.1   0.13 -0.03]
 [-0.02  0.05  0.55  0.02 -0.01]
 [-0.03  0.13  0.01  0.16 -0.04]
 [ 0.01 -0.03  0.02 -0.05  0.01]]
[[ 0.00e+00  1.00e+00  0.00e+00 -9.94e-02 -8.41e-02]
 [ 0.00e+00  0.00e+00 -4.00e-03  1.48e-03  1.06e-02]
 [ 0.00e+00  2.43e-02 -5.49e-03  4.64e-03 -1.80e-02]
 [ 6.60e-03  1.66e-04 -8.45e-03 -1.01e-03  5.77e-03]
 [ 8.04e-03 -3.48e-03 -1.21e-04 -1.56e-02 -3.23e-03]]
[[ 0.    0.01 -0.03  0.03 -0.01]
 [-0.04  0.07 -0.07 -0.    0.02]
 [ 0.12 -0.57 -0.34  1.07 -0.24]
 [-0.04  0.08 -0.09 -0.    0.02]
 [ 0.01 -0.02  0.02  0.01 -0.01]]
[[ 0.00e+00  0.00e+00  0.00e+00  5.55e-03  2.97e-03]
 [ 1.00e+00  0.00e+00  2.58e-02 -2.32e-03 -3.00e-02]
 [ 0.00e+00 -3.26e-03  6.96e-03  3.02e-04  1.34e-03]
 [-8.61e-02  2.70e-04  5.16e-02 -8.20e-04 -8.72e-03]
 [-5.21e-02 -2.56e-03 -3.30e-03 -1.62e-03  6.64e-06]]
[[ 4.56e-03 -4.35e-02  1.54e-01 -4.39e-02  3.53e-03]
 [ 5.04e-03  2.71e-02 -6.08e-01  2.01e-02  1.16e-02]
 [ 4.60e-03 -4.83e-02 -2.22e-01 -4.81e-02  8.99e-04]
 [-1.11e-02  2.46e-02  9.34e-01  1.99e-02 -5.94e-03]
 [-2.86e-03  3.38e-02 -2.40e-01  3.46e-02 -4.36e-03]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00 -1.07e-03]
 [ 0.00e+00  0.00e+00  0.00e+00 -1.84e-04 -4.05e-03]
 [ 0.00e+00  0.00e+00  1.65e-03  2.69e-04  3.43e-03]
 [ 0.00e+00 -2.55e-03 -3.75e-04  2.51e-03 -9.89e-05]
 [ 4.14e-03 -2.14e-03 -8.39e-04 -3.36e-04 -8.84e-03]]
[[-0.01  0.04 -0.05  0.04 -0.01]
 [ 0.04 -0.16  0.23 -0.16  0.04]
 [-0.14  1.58 -2.83  1.57 -0.15]
 [ 0.04 -0.15  0.19 -0.13  0.04]
 [-0.01  0.04 -0.05  0.03 -0.01]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00 -2.32e-03]
 [ 0.00e+00  1.00e+00  0.00e+00 -2.26e-03 -5.23e-03]
 [ 0.00e+00  0.00e+00  1.24e-03 -1.32e-03 -4.49e-04]
 [ 0.00e+00 -1.97e-03 -2.62e-04  3.02e-03  3.02e-03]
 [-2.10e-03  3.05e-04 -3.12e-03 -2.09e-03  1.65e-03]]
[[ 0.01 -0.06  0.    0.06 -0.01]
 [-0.06  0.48 -0.03 -0.44  0.06]
 [ 0.02 -0.07  0.09 -0.05  0.01]
 [ 0.04 -0.37 -0.11  0.52 -0.07]
 [-0.    0.04  0.03 -0.07  0.01]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  1.19e-01]
 [ 0.00e+00  0.00e+00  0.00e+00  5.27e-04 -3.45e-04]
 [ 1.00e+00  0.00e+00  2.19e-03  5.23e-04  2.67e-04]
 [ 0.00e+00 -1.17e-03 -9.18e-04  9.82e-04  7.74e-05]
 [-8.48e-03 -1.69e-03  3.22e-05 -4.12e-04 -4.49e-03]]
[[-0.    0.02 -0.12  0.02 -0.  ]
 [ 0.02 -0.07  1.47 -0.07  0.02]
 [ 0.09 -0.37 -1.99 -0.38  0.09]
 [ 0.02 -0.07  1.47 -0.06  0.02]
 [-0.    0.02 -0.12  0.02 -0.  ]]
SymNet parameters
[[ 9.36e-03  8.72e-03 -7.44e-02 -1.23e-02  5.75e-03  4.10e-03  3.77e-02 -1.44e-02
  -5.66e-03  5.22e-04 -1.61e-04 -5.00e-04]
 [-6.50e-02 -5.45e-02  5.30e-02  7.94e-02  2.61e-02 -1.07e-02  1.91e+00 -8.53e-02
  -2.86e-02 -4.03e-03  1.55e-03 -2.77e-04]]
SymNet parameters
[1.17 0.01]
SymNet parameters
[[ 1.85e+00  1.68e+00 -1.77e-01 -7.30e-02  2.44e-02  1.43e-03 -3.51e+00 -4.62e-02
   7.28e-01  6.76e-03  1.47e-02  2.84e-02 -3.90e-01]
 [ 4.13e-01 -2.32e-01  1.89e+00  1.91e-01  3.06e-02 -1.46e-01  3.33e-01  2.89e-01
   1.38e-01 -4.12e-03 -1.72e-03  1.63e-02  1.78e-02]]
SymNet parameters
[-0.18  0.62]
SymNet parameters
[[ 1.48e+00  4.91e-02 -6.92e-02  2.18e-02 -8.30e-03 -1.40e-02  6.93e-01  1.64e-03
  -2.21e-02  2.14e-03  5.44e-04 -3.35e-03  7.02e-02  5.44e-04]
 [-6.86e-01 -4.23e-01 -1.59e-01 -3.66e-01 -1.23e-01  4.22e-02 -3.02e+00 -5.05e-01
  -2.31e-01  1.38e-02  2.74e-03 -1.68e-02  5.09e-01 -3.92e-03]]
SymNet parameters
[ 0.01 -0.38]
SymNet parameters
[[-4.84e-01  1.01e+00 -6.24e-02  1.35e-01  3.88e-02 -1.96e-02 -8.98e-01  7.75e-04
  -2.60e-02 -5.20e-03  1.17e-03  4.85e-03 -7.73e-01  5.67e-03 -2.39e-02]
 [ 7.61e-01  3.24e-02 -2.76e-01  5.00e-03 -2.12e-03 -4.00e-03  1.63e-01 -2.47e-04
  -5.03e-04 -1.19e-04 -8.03e-05 -2.35e-05 -3.60e-02  7.69e-04 -7.04e-03]]
SymNet parameters
[-0.03  0.25]
SymNet parameters
[[-3.29e-01 -7.42e-01  6.62e-02 -5.66e-02 -1.87e-02  9.35e-03 -2.78e+00 -3.72e-03
  -2.59e-02  3.50e-03 -6.12e-04  1.43e-04  4.20e-01 -2.61e-03 -1.21e-02  3.01e-03]
 [-2.33e+00  5.78e-02 -7.45e-01 -2.68e-03 -4.50e-03  1.15e-03 -1.07e-01 -3.00e-02
  -1.00e-02 -1.14e-03  8.56e-04  3.79e-04 -1.26e-01  8.16e-03 -4.00e-03  6.77e-02]]
SymNet parameters
[ 0.26 -0.25]
SymNet parameters
[[-2.69e-01  2.30e-01 -9.70e-02  2.73e-02 -7.90e-03  5.24e-02 -9.82e-01  4.63e-02
   1.34e-02  1.57e-03 -1.13e-03  8.45e-04  3.21e-01  7.72e-03 -8.35e-02 -5.66e-01
  -3.29e-01]]
SymNet parameters
[-0.04]
SymNet parameters
[[-1.07e+00 -4.03e-02 -5.46e-03  4.70e-04  4.74e-03  5.01e-03  5.63e-02 -5.55e-02
  -1.45e-02  4.75e-03  7.78e-03  4.15e-02]
 [-2.27e-01 -9.93e-01  6.64e-02  4.70e-02 -1.25e-01 -9.66e-02  2.03e-01  7.86e-01
   1.69e+00 -1.68e-01  9.78e-01 -1.34e+00]]
SymNet parameters
[-0.51 -0.81]
SymNet parameters
[[ 4.19e+00  9.74e-02  2.15e-02 -1.68e-03 -1.80e-02 -1.87e-02 -3.00e-01  1.98e-01
   2.96e-01 -1.91e-02 -1.11e-02 -1.63e-01 -1.11e-04]
 [-2.48e-01 -2.35e+00  1.64e-01  1.04e-01 -2.64e-01 -2.03e-01  4.21e+00  2.78e+00
   3.50e+00 -3.67e-01  2.26e+00 -2.87e+00 -9.59e-03]]
SymNet parameters
[1.19 0.54]
SymNet parameters
[[ 2.44e+00  2.25e-01  1.50e-02 -2.63e-03 -9.03e-03 -1.18e-02 -2.37e-01  1.47e-01
  -6.31e-01 -6.36e-03 -6.79e-02 -7.09e-02 -1.24e-02 -9.58e-04]
 [ 1.72e-01  2.32e-01 -7.16e-03 -1.22e-02  3.52e-02  2.75e-02  1.49e+00 -2.38e-01
  -4.57e-01  4.43e-02 -2.11e-01  3.64e-01 -4.76e-03 -5.15e-04]]
SymNet parameters
[0.36 1.03]
SymNet parameters
[[-0.96 -0.1  -0.02  0.01 -0.01 -0.01 -1.12 -0.01  0.6  -0.02  0.06 -0.09  0.23  0.02
  -0.05]
 [ 0.71 -1.42 -0.13  0.02 -0.07 -0.04  1.42 -0.72  1.18 -0.1   0.14 -0.71 -0.44 -0.03
   0.23]]
SymNet parameters
[ 0.38 -1.14]
SymNet parameters
[[-2.85e+00 -2.23e+00 -4.71e-02 -3.01e-02  2.65e-01  2.45e-01 -2.45e-01 -3.46e+00
  -3.09e+00  2.42e-01  4.45e-01  2.37e+00  1.18e+00  1.22e-01 -3.61e-01  2.55e-02]
 [ 5.48e-01 -5.29e-02  2.01e-03  1.81e-03 -5.48e-03 -2.46e-03  1.02e+00 -3.47e-01
   4.66e-01 -5.56e-03  5.64e-02 -5.05e-02 -6.27e-02 -5.17e-03  3.64e-02 -9.11e-03]]
SymNet parameters
[-0.09 -0.68]
SymNet parameters
[[ 0.38  0.28 -0.04 -0.02  0.07  0.06  0.47 -0.25 -0.4   0.14 -0.43  0.75 -2.13 -0.19
   0.81 -0.05  0.03]]
SymNet parameters
[0.67]
finally, finish this stage
iter:     0    time: 51.45
Func: 7.70e-01  |g|: 2.67e+02
stableloss: 5.49e-02   dataloss: 7.30e-01   sparseloss: 1.26e+02 momentloss: 6.74e+00
current expression:
[u00*u01, u10*v00, u20, u02, u00*u01**2, u00, u00*u11*v00, u01*u10*v00, u00*u10*v01, u10*v00*v10, u00**3, u00*v00, u01*u10, u20*v00**2, u00**2, v00**2, u01*u10*v10, u10*v10, 1, u00*u01*v00]
[-0.98 -0.98  0.05  0.05  0.01  0.01  0.01  0.01  0.01  0.01 -0.    0.   -0.    0.
 -0.    0.    0.   -0.   -0.   -0.  ]
[v00*v10, u00*v01, v02, v20, v00*v10**2, v10, u00*v01*v10, u00*v00*v11, u00*u01*v01, v00, 1, u10*v01, v00**2*v10, u01*v00*v10, v00**2, u01, u00**2, u00*v00**2*v10, u00**2*v00, v01]
[-0.99 -0.98  0.05  0.05  0.01  0.01  0.01  0.01  0.01  0.01 -0.01 -0.   -0.    0.
  0.   -0.    0.    0.   -0.    0.  ]
block:  9
name:  burgers-2-upwind-sparse0-noise0.001-id17
device:  cuda:1
generate a random number to check random seed:  3.382603819934409
current stage is: block-9
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.8585, device='cuda:1', dtype=torch.float64)
u_obs variance
tensor([ 0.2165,  1.4320,  1.4279, 19.2057,  8.5456, 16.5710,  0.2637,  1.7678,
         1.7286, 20.8912, 10.4912, 20.7014], device='cuda:1',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 1.483336
         Iterations: 0
         Function evaluations: 15
         Gradient evaluations: 3
convolution moment and kernels
[[ 1.00e+00  0.00e+00 -5.75e-05  3.64e-03 -6.18e-02]
 [ 0.00e+00 -1.07e-04 -5.04e-03  2.50e-04  3.11e-03]
 [ 1.08e-03 -2.23e-03  4.42e-03  1.33e-03 -5.42e-04]
 [ 4.24e-02 -4.28e-03 -4.49e-04  3.82e-03  4.38e-03]
 [-6.76e-02 -3.22e-03 -2.79e-03  6.09e-04  7.04e-03]]
[[ 0.01 -0.03 -0.05 -0.02  0.  ]
 [-0.03  0.13  0.1   0.13 -0.03]
 [-0.02  0.05  0.55  0.02 -0.01]
 [-0.03  0.13  0.01  0.16 -0.04]
 [ 0.01 -0.03  0.02 -0.05  0.01]]
[[ 0.00e+00  1.00e+00  0.00e+00 -9.94e-02 -8.41e-02]
 [ 0.00e+00  0.00e+00 -4.00e-03  1.48e-03  1.06e-02]
 [ 0.00e+00  2.43e-02 -5.49e-03  4.64e-03 -1.80e-02]
 [ 6.60e-03  1.67e-04 -8.45e-03 -1.01e-03  5.77e-03]
 [ 8.03e-03 -3.48e-03 -1.20e-04 -1.56e-02 -3.23e-03]]
[[ 0.    0.01 -0.03  0.03 -0.01]
 [-0.04  0.07 -0.07 -0.    0.02]
 [ 0.12 -0.57 -0.34  1.07 -0.24]
 [-0.04  0.08 -0.09 -0.    0.02]
 [ 0.01 -0.02  0.02  0.01 -0.01]]
[[ 0.00e+00  0.00e+00  0.00e+00  5.55e-03  2.97e-03]
 [ 1.00e+00  0.00e+00  2.58e-02 -2.32e-03 -3.00e-02]
 [ 0.00e+00 -3.26e-03  6.96e-03  3.02e-04  1.34e-03]
 [-8.61e-02  2.70e-04  5.16e-02 -8.20e-04 -8.72e-03]
 [-5.21e-02 -2.56e-03 -3.30e-03 -1.62e-03  4.18e-06]]
[[ 4.55e-03 -4.35e-02  1.54e-01 -4.39e-02  3.53e-03]
 [ 5.05e-03  2.71e-02 -6.08e-01  2.01e-02  1.16e-02]
 [ 4.59e-03 -4.83e-02 -2.22e-01 -4.81e-02  8.84e-04]
 [-1.11e-02  2.46e-02  9.34e-01  1.98e-02 -5.93e-03]
 [-2.86e-03  3.38e-02 -2.40e-01  3.46e-02 -4.36e-03]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00 -1.07e-03]
 [ 0.00e+00  0.00e+00  0.00e+00 -1.84e-04 -4.05e-03]
 [ 0.00e+00  0.00e+00  1.65e-03  2.69e-04  3.43e-03]
 [ 0.00e+00 -2.55e-03 -3.75e-04  2.51e-03 -9.87e-05]
 [ 4.14e-03 -2.14e-03 -8.39e-04 -3.36e-04 -8.84e-03]]
[[-0.01  0.04 -0.05  0.04 -0.01]
 [ 0.04 -0.16  0.23 -0.16  0.04]
 [-0.14  1.58 -2.83  1.57 -0.15]
 [ 0.04 -0.15  0.19 -0.13  0.04]
 [-0.01  0.04 -0.05  0.03 -0.01]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00 -2.32e-03]
 [ 0.00e+00  1.00e+00  0.00e+00 -2.26e-03 -5.23e-03]
 [ 0.00e+00  0.00e+00  1.24e-03 -1.32e-03 -4.49e-04]
 [ 0.00e+00 -1.97e-03 -2.62e-04  3.02e-03  3.02e-03]
 [-2.10e-03  3.05e-04 -3.12e-03 -2.09e-03  1.65e-03]]
[[ 0.01 -0.06  0.    0.06 -0.01]
 [-0.06  0.48 -0.03 -0.44  0.06]
 [ 0.02 -0.07  0.09 -0.05  0.01]
 [ 0.04 -0.37 -0.11  0.52 -0.07]
 [-0.    0.04  0.03 -0.07  0.01]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  1.19e-01]
 [ 0.00e+00  0.00e+00  0.00e+00  5.27e-04 -3.45e-04]
 [ 1.00e+00  0.00e+00  2.19e-03  5.23e-04  2.67e-04]
 [ 0.00e+00 -1.17e-03 -9.18e-04  9.82e-04  7.75e-05]
 [-8.48e-03 -1.69e-03  3.22e-05 -4.12e-04 -4.49e-03]]
[[-0.    0.02 -0.12  0.02 -0.  ]
 [ 0.02 -0.07  1.47 -0.07  0.02]
 [ 0.09 -0.37 -1.99 -0.38  0.09]
 [ 0.02 -0.07  1.47 -0.06  0.02]
 [-0.    0.02 -0.12  0.02 -0.  ]]
SymNet parameters
[[ 9.36e-03  8.72e-03 -7.44e-02 -1.23e-02  5.75e-03  4.10e-03  3.77e-02 -1.44e-02
  -5.66e-03  5.22e-04 -1.63e-04 -4.97e-04]
 [-6.50e-02 -5.45e-02  5.30e-02  7.94e-02  2.61e-02 -1.07e-02  1.91e+00 -8.53e-02
  -2.86e-02 -4.03e-03  1.55e-03 -2.78e-04]]
SymNet parameters
[1.17 0.01]
SymNet parameters
[[ 1.85e+00  1.68e+00 -1.77e-01 -7.30e-02  2.44e-02  1.43e-03 -3.51e+00 -4.62e-02
   7.28e-01  6.76e-03  1.47e-02  2.84e-02 -3.90e-01]
 [ 4.13e-01 -2.32e-01  1.89e+00  1.91e-01  3.06e-02 -1.46e-01  3.33e-01  2.89e-01
   1.38e-01 -4.12e-03 -1.72e-03  1.63e-02  1.78e-02]]
SymNet parameters
[-0.18  0.62]
SymNet parameters
[[ 1.48e+00  4.91e-02 -6.92e-02  2.18e-02 -8.30e-03 -1.40e-02  6.93e-01  1.64e-03
  -2.21e-02  2.14e-03  5.43e-04 -3.35e-03  7.02e-02  5.40e-04]
 [-6.86e-01 -4.23e-01 -1.59e-01 -3.66e-01 -1.23e-01  4.22e-02 -3.02e+00 -5.05e-01
  -2.31e-01  1.38e-02  2.74e-03 -1.68e-02  5.09e-01 -3.92e-03]]
SymNet parameters
[ 0.01 -0.38]
SymNet parameters
[[-4.84e-01  1.01e+00 -6.24e-02  1.35e-01  3.88e-02 -1.96e-02 -8.98e-01  7.76e-04
  -2.60e-02 -5.20e-03  1.17e-03  4.85e-03 -7.73e-01  5.67e-03 -2.39e-02]
 [ 7.61e-01  3.24e-02 -2.76e-01  4.99e-03 -2.12e-03 -4.00e-03  1.63e-01 -2.44e-04
  -5.02e-04 -1.17e-04 -7.90e-05 -2.68e-05 -3.60e-02  7.82e-04 -7.06e-03]]
SymNet parameters
[-0.03  0.25]
SymNet parameters
[[-3.29e-01 -7.42e-01  6.62e-02 -5.66e-02 -1.87e-02  9.35e-03 -2.78e+00 -3.72e-03
  -2.59e-02  3.50e-03 -6.12e-04  1.43e-04  4.20e-01 -2.61e-03 -1.21e-02  3.01e-03]
 [-2.33e+00  5.78e-02 -7.45e-01 -2.67e-03 -4.50e-03  1.15e-03 -1.07e-01 -3.00e-02
  -1.00e-02 -1.14e-03  8.55e-04  3.78e-04 -1.26e-01  8.16e-03 -4.00e-03  6.77e-02]]
SymNet parameters
[ 0.26 -0.25]
SymNet parameters
[[-2.69e-01  2.30e-01 -9.70e-02  2.73e-02 -7.90e-03  5.24e-02 -9.82e-01  4.63e-02
   1.34e-02  1.57e-03 -1.12e-03  8.43e-04  3.21e-01  7.71e-03 -8.35e-02 -5.66e-01
  -3.29e-01]]
SymNet parameters
[-0.04]
SymNet parameters
[[-1.07e+00 -4.03e-02 -5.47e-03  4.63e-04  4.74e-03  5.03e-03  5.63e-02 -5.55e-02
  -1.45e-02  4.68e-03  7.77e-03  4.16e-02]
 [-2.27e-01 -9.93e-01  6.64e-02  4.70e-02 -1.25e-01 -9.66e-02  2.03e-01  7.86e-01
   1.69e+00 -1.68e-01  9.78e-01 -1.34e+00]]
SymNet parameters
[-0.51 -0.81]
SymNet parameters
[[ 4.19e+00  9.74e-02  2.15e-02 -1.69e-03 -1.80e-02 -1.87e-02 -3.00e-01  1.98e-01
   2.96e-01 -1.92e-02 -1.11e-02 -1.63e-01 -8.50e-05]
 [-2.48e-01 -2.35e+00  1.64e-01  1.04e-01 -2.64e-01 -2.03e-01  4.21e+00  2.78e+00
   3.50e+00 -3.67e-01  2.26e+00 -2.87e+00 -9.59e-03]]
SymNet parameters
[1.19 0.54]
SymNet parameters
[[ 2.44e+00  2.25e-01  1.50e-02 -2.63e-03 -9.03e-03 -1.18e-02 -2.37e-01  1.47e-01
  -6.31e-01 -6.36e-03 -6.79e-02 -7.09e-02 -1.24e-02 -8.58e-04]
 [ 1.72e-01  2.32e-01 -7.16e-03 -1.22e-02  3.52e-02  2.75e-02  1.49e+00 -2.38e-01
  -4.57e-01  4.43e-02 -2.11e-01  3.64e-01 -4.79e-03 -3.20e-04]]
SymNet parameters
[0.36 1.03]
SymNet parameters
[[-0.96 -0.1  -0.02  0.01 -0.01 -0.01 -1.12 -0.01  0.6  -0.02  0.06 -0.09  0.23  0.02
  -0.05]
 [ 0.71 -1.42 -0.13  0.02 -0.07 -0.04  1.42 -0.72  1.18 -0.1   0.14 -0.71 -0.44 -0.03
   0.23]]
SymNet parameters
[ 0.38 -1.14]
SymNet parameters
[[-2.85e+00 -2.23e+00 -4.71e-02 -3.01e-02  2.65e-01  2.45e-01 -2.45e-01 -3.46e+00
  -3.09e+00  2.42e-01  4.45e-01  2.37e+00  1.18e+00  1.22e-01 -3.61e-01  2.55e-02]
 [ 5.48e-01 -5.29e-02  2.01e-03  1.81e-03 -5.48e-03 -2.46e-03  1.02e+00 -3.47e-01
   4.66e-01 -5.56e-03  5.64e-02 -5.05e-02 -6.27e-02 -5.20e-03  3.65e-02 -9.09e-03]]
SymNet parameters
[-0.09 -0.68]
SymNet parameters
[[ 0.38  0.28 -0.04 -0.02  0.07  0.06  0.47 -0.25 -0.4   0.14 -0.43  0.75 -2.13 -0.19
   0.81 -0.05  0.03]]
SymNet parameters
[0.67]
finally, finish this stage
iter:     0    time: 52.55
Func: 1.48e+00  |g|: 7.55e+02
stableloss: 4.97e-02   dataloss: 1.42e+00   sparseloss: 1.26e+02 momentloss: 6.74e+00
current expression:
[u00*u01, u10*v00, u20, u02, u00*u01**2, u00, u00*u11*v00, u01*u10*v00, u00*u10*v01, u10*v00*v10, u00**3, u00*v00, u01*u10, u20*v00**2, u00**2, v00**2, u01*u10*v10, u10*v10, 1, u00*u01*v00]
[-0.98 -0.98  0.05  0.05  0.01  0.01  0.01  0.01  0.01  0.01 -0.    0.   -0.    0.
 -0.    0.    0.   -0.   -0.   -0.  ]
[v00*v10, u00*v01, v02, v20, v00*v10**2, v10, u00*v01*v10, u00*v00*v11, u00*u01*v01, v00, 1, u10*v01, v00**2*v10, u01*v00*v10, v00**2, u01, u00**2, u00*v00**2*v10, u00**2*v00, v01]
[-0.99 -0.98  0.05  0.05  0.01  0.01  0.01  0.01  0.01  0.01 -0.01 -0.   -0.    0.
  0.   -0.    0.    0.   -0.    0.  ]
u_obs.abs().max()
tensor(3.8355, device='cuda:1', dtype=torch.float64)
model(u_obs[0],T=50*dt).abs().max()
tensor(nan, device='cuda:1', dtype=torch.float64)
model(u_obs[0],T=100*dt).abs().max()
tensor(nan, device='cuda:1', dtype=torch.float64)
{'--name': 'burgers-2-upwind-sparse0-noise0.001-id18', '--dtype': 'double', '--device': 'cuda:2', '--constraint': '2', '--dt': 0.01, '--cell_num': 1, '--eps': 6.283185307179586, '--blocks': [0, 1, 2, 3, 4, 5, 6, 9], '--kernel_size': 5, '--max_order': 2, '--dx': 0.19634954084936207, '--hidden_layers': 5, '--scheme': 'upwind', '--dataname': 'burgers', '--viscosity': 0.05, '--zoom': 4, '--max_dt': 0.000625, '--batch_size': 28, '--data_timescheme': 'rk2', '--channel_names': 'u,v', '--freq': 4, '--data_start_time': 1.0, '--start_noise': 0.001, '--end_noise': 0.001, '--stablize': 0.0, '--sparsity': 0.0, '--momentsparsity': 0.001, '--npseed': -1, '--torchseed': -1, '--maxiter': 2000, '--recordfile': 'None', '--recordcycle': 200, '--savecycle': -1, '--start_from': -1}
block:  0
name:  burgers-2-upwind-sparse0-noise0.001-id18
device:  cuda:2
generate a random number to check random seed:  0.21605569217855225
current stage is: warmup
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.8435, device='cuda:2', dtype=torch.float64)
u_obs variance
tensor([ 0.2594,  1.9894,  2.0508, 17.8418,  9.5170, 18.0373,  0.2386,  1.7520,
         2.0306, 15.1127,  9.3595, 19.0932], device='cuda:2',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
iter:     0    time: 6.33
Func: 5.23e+00  |g|: 1.95e+00
stableloss: 6.34e-04   dataloss: 5.23e+00   sparseloss: 2.40e+01 momentloss: 7.27e+00
iter:   200    time: 14.07
Func: 4.42e-02  |g|: 4.78e-02
stableloss: 1.49e-02   dataloss: 4.42e-02   sparseloss: 4.97e+01 momentloss: 7.27e+00
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 0.043754
         Iterations: 209
         Function evaluations: 280
         Gradient evaluations: 272
convolution moment and kernels
[[1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
[[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 1. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
[[ 0.    1.    0.   -0.33 -0.25]
 [ 0.    0.    0.    0.    0.  ]
 [ 0.    0.    0.    0.    0.  ]
 [ 0.    0.    0.    0.    0.  ]
 [ 0.    0.    0.    0.    0.  ]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]
 [ 2.78e-17  3.33e-16 -1.50e+00  2.00e+00 -5.00e-01]
 [ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]]
[[ 0.    0.    0.    0.    0.  ]
 [ 1.    0.    0.    0.    0.  ]
 [ 0.    0.    0.    0.    0.  ]
 [-0.33  0.    0.    0.    0.  ]
 [-0.25  0.    0.    0.    0.  ]]
[[ 0.00e+00  0.00e+00  2.78e-17  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  3.33e-16  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00 -1.50e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  2.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00 -5.00e-01  0.00e+00  0.00e+00]]
[[0.   0.   1.   0.   0.08]
 [0.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.  ]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]
 [-2.22e-16  1.00e+00 -2.00e+00  1.00e+00 -1.53e-16]
 [ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]]
[[0. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
[[ 6.94e-03 -5.56e-02  9.25e-18  5.56e-02 -6.94e-03]
 [-5.56e-02  4.44e-01 -7.40e-17 -4.44e-01  5.56e-02]
 [ 9.25e-18 -7.40e-17  1.23e-32  7.40e-17 -9.25e-18]
 [ 5.56e-02 -4.44e-01  7.40e-17  4.44e-01 -5.56e-02]
 [-6.94e-03  5.56e-02 -9.25e-18 -5.56e-02  6.94e-03]]
[[0.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.  ]
 [1.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.  ]
 [0.08 0.   0.   0.   0.  ]]
[[ 0.00e+00  0.00e+00 -2.22e-16  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  1.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00 -2.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  1.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00 -1.53e-16  0.00e+00  0.00e+00]]
SymNet parameters
[[-6.12e-01  4.37e-01 -1.41e-01 -1.83e-01 -4.05e-02 -2.28e-02 -7.64e-02 -2.15e-03
  -1.32e-01 -6.07e-03  3.25e-03 -2.73e-02]
 [-8.04e-01 -1.05e-01  1.23e-02 -2.09e-02  1.38e-02 -3.16e-02 -2.44e-02  5.64e-03
   2.70e-02  1.22e-03 -1.26e-04  7.08e-03]]
SymNet parameters
[0.01 0.15]
SymNet parameters
[[ 0.59 -0.23  0.86 -0.09  0.11 -0.08 -0.11  0.04  0.11  0.02 -0.    0.02 -0.19]
 [-0.22 -0.32  0.07 -0.01 -0.02  0.01 -0.8  -0.   -0.03 -0.    0.   -0.    0.02]]
SymNet parameters
[-0.06  0.15]
SymNet parameters
[[ 5.35e-01 -1.51e-01  2.52e-03  1.38e-02 -1.39e-02  1.38e-02  8.94e-01 -4.21e-03
  -1.72e-02 -3.44e-04  2.24e-03 -3.16e-03  3.48e-02 -4.28e-04]
 [-4.96e-01  5.77e-01  7.68e-01  2.34e-01 -2.97e-01  2.18e-01  2.72e-01 -9.28e-02
  -2.60e-01 -3.47e-02  1.14e-02 -6.43e-02  4.95e-01  4.38e-02]]
SymNet parameters
[ 0.08 -0.19]
SymNet parameters
[[-0.14  0.13 -0.17  0.12  0.32 -0.13 -0.1   0.02  0.15  0.    0.01  0.26  0.22 -0.05
   0.32]
 [ 0.01  0.13 -0.42  0.23 -0.24 -0.09 -0.17  0.01  0.3  -0.11 -0.07  0.04 -0.1  -0.11
  -0.02]]
SymNet parameters
[ 0.04 -0.06]
SymNet parameters
[[ 3.96e-01  7.98e-01 -2.28e-01  3.42e-02  9.01e-02 -3.47e-02 -4.08e-01  3.36e-02
   1.19e-01  1.13e-02 -5.99e-03  3.13e-02 -6.47e-02 -1.95e-02  1.09e-02 -4.40e-03]
 [ 9.74e-01  1.46e-01 -3.51e-01  7.52e-02 -8.36e-02  5.59e-02  8.08e-02 -2.91e-02
  -5.83e-02 -1.01e-02 -2.77e-04 -1.68e-02  1.91e-01  1.22e-02 -7.46e-03 -3.43e-03]]
SymNet parameters
[ 0.   -0.11]
SymNet parameters
[[-0.06 -0.05 -0.06  0.07 -0.03  0.06 -0.05 -0.01 -0.02 -0.    0.   -0.    0.54  0.81
  -0.36  0.01 -0.6 ]]
SymNet parameters
[-0.]
SymNet parameters
[[ 1.06  0.01 -0.01 -0.03  0.01 -0.03 -0.1  -0.07  0.06 -0.01 -0.03  0.03]
 [-0.01  0.    0.01  0.02 -0.    0.02 -0.24 -1.03 -0.03  0.01  0.02 -0.01]]
SymNet parameters
[-0.31  0.49]
SymNet parameters
[[ 0.04 -0.04 -0.    0.08 -0.01  0.07 -0.84  0.9   1.41  0.03  0.03 -0.03 -0.03]
 [-0.04  0.04 -0.04 -0.12  0.03 -0.11 -1.48 -0.29  0.33 -0.05 -0.12  0.08 -0.  ]]
SymNet parameters
[ 0.27 -0.14]
SymNet parameters
[[-0.13  0.02 -0.02 -0.01 -0.03  0.   -0.56  0.19  0.41 -0.02  0.16 -0.1   0.01 -0.07]
 [-0.57  0.08 -0.12 -0.01 -0.03  0.04 -0.51  0.05 -0.12  0.01  0.02 -0.27 -0.01 -0.01]]
SymNet parameters
[0.03 0.05]
SymNet parameters
[[ 0.03  0.39 -0.14 -0.28 -0.03 -0.2   0.45  0.07 -0.34 -0.05  0.1  -0.05  0.14 -0.01
   0.21]
 [ 0.13  0.12  0.12  0.18  0.    0.2   0.03  0.15  0.27  0.1   0.2   0.02  0.14  0.01
   0.08]]
SymNet parameters
[ 0.23 -0.31]
SymNet parameters
[[ 0.35 -0.01  0.   -0.01  0.01 -0.02 -0.32  0.09 -0.58 -0.01 -0.04  0.05  0.    0.
  -0.03  0.  ]
 [-0.07 -0.    0.    0.04 -0.02  0.05 -0.84  0.11 -0.18  0.02  0.06 -0.06 -0.01 -0.01
  -0.    0.  ]]
SymNet parameters
[ 0.19 -0.1 ]
SymNet parameters
[[-0.43 -0.01  0.01  0.04 -0.01  0.03 -0.04 -0.2   0.02  0.05  0.03  0.    0.78  0.18
  -0.06 -0.03 -0.85]]
SymNet parameters
[0.1]
finally, finish this stage
iter:   209    time: 2.82
Func: 4.38e-02  |g|: 3.08e-02
stableloss: 1.54e-02   dataloss: 4.38e-02   sparseloss: 4.92e+01 momentloss: 7.27e+00
current expression:
[u00*u01, u10*v00, u00, u02, u20, u00**3, u00**2, u00**2*u02, u00*u02, u00*u01**2, u00*u11, u00*v00, u01*u10*v00, u00*u01*v00, u00**2*v10, v00, u00*v00**2, u10*v00**2, u00*u20, u00*v01]
[-0.89 -0.88  0.05  0.04  0.04 -0.02  0.01 -0.01  0.01  0.01  0.01  0.01  0.01 -0.01
 -0.01 -0.01  0.01  0.    0.   -0.  ]
[v00*v10, u00*v01, v00, v02, v20, u00, v01, u00*v00**2, u00*v00, u00*v01*v10, v00**3, 1, v00*v10**2, v10, u00*v20, v11, v00**2*v01, u00**2, u00*v10, u10*v00]
[-0.89 -0.89  0.04  0.04  0.04  0.02 -0.02 -0.01  0.01  0.01 -0.01 -0.01  0.01  0.01
  0.01 -0.01  0.01  0.01 -0.01  0.01]
block:  1
name:  burgers-2-upwind-sparse0-noise0.001-id18
device:  cuda:2
generate a random number to check random seed:  -2.184627462971963
current stage is: block-1
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.9347, device='cuda:2', dtype=torch.float64)
u_obs variance
tensor([ 0.2545,  1.9595,  2.0005, 18.2548,  9.2495, 17.6373,  0.2580,  1.9377,
         2.1498, 16.7738,  9.8265, 20.0721], device='cuda:2',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
iter:     0    time: 1563.85
Func: 5.07e-02  |g|: 6.31e-01
stableloss: 1.28e-02   dataloss: 4.34e-02   sparseloss: 4.92e+01 momentloss: 7.27e+00
iter:   200    time: 16.59
Func: 2.15e-02  |g|: 1.96e-02
stableloss: 8.75e-03   dataloss: 1.49e-02   sparseloss: 5.04e+01 momentloss: 6.55e+00
iter:   400    time: 14.55
Func: 2.05e-02  |g|: 1.12e-02
stableloss: 8.49e-03   dataloss: 1.40e-02   sparseloss: 5.63e+01 momentloss: 6.50e+00
iter:   600    time: 14.48
Func: 2.02e-02  |g|: 4.15e-03
stableloss: 8.30e-03   dataloss: 1.37e-02   sparseloss: 5.72e+01 momentloss: 6.50e+00
iter:   800    time: 11.01
Func: 2.01e-02  |g|: 1.90e-03
stableloss: 8.20e-03   dataloss: 1.36e-02   sparseloss: 5.63e+01 momentloss: 6.49e+00
iter:  1000    time: 10.53
Func: 2.01e-02  |g|: 2.46e-03
stableloss: 8.13e-03   dataloss: 1.36e-02   sparseloss: 5.62e+01 momentloss: 6.49e+00
iter:  1200    time: 10.55
Func: 2.00e-02  |g|: 6.16e-03
stableloss: 8.07e-03   dataloss: 1.35e-02   sparseloss: 6.01e+01 momentloss: 6.47e+00
iter:  1400    time: 10.64
Func: 1.99e-02  |g|: 4.02e-03
stableloss: 8.04e-03   dataloss: 1.34e-02   sparseloss: 6.22e+01 momentloss: 6.48e+00
iter:  1600    time: 10.63
Func: 1.98e-02  |g|: 8.24e-03
stableloss: 8.03e-03   dataloss: 1.34e-02   sparseloss: 6.42e+01 momentloss: 6.48e+00
iter:  1800    time: 10.64
Func: 1.98e-02  |g|: 2.75e-03
stableloss: 8.06e-03   dataloss: 1.33e-02   sparseloss: 6.34e+01 momentloss: 6.48e+00
Warning: Maximum number of iterations has been exceeded.
         Current function value: 0.019723
         Iterations: 2000
         Function evaluations: 2005
         Gradient evaluations: 2005
convolution moment and kernels
[[ 1.00e+00  0.00e+00 -7.50e-05 -1.24e-03 -5.16e-02]
 [ 0.00e+00  6.82e-05 -2.55e-03  3.11e-05  5.66e-03]
 [ 6.69e-05  1.30e-03  5.14e-03  9.06e-04 -2.53e-03]
 [ 4.86e-03 -7.54e-04 -1.24e-03  6.27e-04  2.40e-03]
 [-3.63e-02 -9.83e-03 -2.68e-03  3.03e-03  3.34e-03]]
[[ 9.33e-04 -5.89e-03 -1.50e-02 -2.39e-02  5.16e-03]
 [-1.11e-02  5.94e-02 -3.77e-03  1.34e-01 -2.81e-02]
 [-3.53e-02  1.18e-01  7.04e-01  5.96e-03 -1.03e-02]
 [-7.55e-03  4.49e-02  5.32e-03  1.24e-01 -2.60e-02]
 [ 2.08e-03 -1.17e-02  6.34e-04 -3.19e-02  7.06e-03]]
[[ 0.00e+00  1.00e+00  0.00e+00 -1.09e-01 -6.23e-02]
 [ 0.00e+00  0.00e+00  1.90e-03 -8.85e-04  8.53e-03]
 [ 0.00e+00  1.37e-02  1.45e-03  6.03e-03 -5.98e-03]
 [ 1.78e-02  4.12e-03 -2.90e-03 -3.56e-03 -1.65e-03]
 [ 1.39e-02 -3.66e-03  2.33e-03 -2.52e-03  4.92e-04]]
[[ 2.29e-03 -1.75e-03  1.06e-02 -8.28e-03  2.13e-03]
 [-2.08e-02  4.41e-02 -1.13e-01  6.33e-02 -1.18e-02]
 [ 1.03e-01 -5.76e-01 -2.09e-01  9.59e-01 -1.93e-01]
 [-1.05e-02  7.94e-03 -8.10e-02  4.24e-03  5.81e-03]
 [ 1.54e-03  1.01e-04  1.80e-02  5.89e-03 -2.73e-03]]
[[ 0.00e+00  0.00e+00  0.00e+00  1.68e-03  4.53e-03]
 [ 1.00e+00  0.00e+00  1.72e-02 -2.92e-03 -4.18e-03]
 [ 0.00e+00 -4.21e-03  6.95e-03  4.00e-04 -7.14e-04]
 [-1.05e-01  7.45e-05  1.02e-02  2.75e-03 -1.04e-02]
 [-7.08e-02 -5.16e-03 -1.06e-02 -1.45e-03 -3.62e-03]]
[[ 0.   -0.02  0.11 -0.03  0.  ]
 [-0.    0.04 -0.58  0.04  0.01]
 [-0.01 -0.04 -0.31 -0.05 -0.01]
 [ 0.02 -0.02  1.05 -0.01  0.02]
 [-0.01  0.03 -0.24  0.02 -0.01]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00 -3.35e-03]
 [ 0.00e+00  0.00e+00  0.00e+00 -1.71e-03 -3.01e-03]
 [ 0.00e+00  0.00e+00  2.61e-03 -1.42e-03  9.73e-04]
 [ 0.00e+00 -1.07e-03 -1.88e-03  2.02e-03  4.54e-03]
 [ 5.95e-03 -3.64e-03 -3.60e-06  2.77e-03 -6.19e-03]]
[[-9.98e-03  3.99e-02 -4.86e-02  3.23e-02 -7.72e-03]
 [ 3.85e-02 -1.47e-01  1.68e-01 -1.09e-01  2.64e-02]
 [-1.38e-01  1.53e+00 -2.71e+00  1.46e+00 -1.14e-01]
 [ 2.84e-02 -9.75e-02  7.98e-02 -4.43e-02  9.70e-03]
 [-6.03e-03  2.03e-02 -1.37e-02  6.64e-03 -1.29e-03]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00 -2.14e-03]
 [ 0.00e+00  1.00e+00  0.00e+00 -1.35e-03 -1.16e-03]
 [ 0.00e+00  0.00e+00  4.06e-04  4.52e-04 -2.77e-03]
 [ 0.00e+00 -1.53e-03  2.90e-04  2.35e-03 -9.78e-05]
 [ 2.17e-03  4.62e-03 -1.43e-03 -2.78e-03  7.07e-03]]
[[ 0.02 -0.09  0.05  0.03 -0.  ]
 [-0.1   0.61 -0.21 -0.34  0.03]
 [ 0.06 -0.24  0.32 -0.17  0.04]
 [ 0.02 -0.29 -0.22  0.56 -0.08]
 [ 0.    0.02  0.05 -0.08  0.01]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  1.89e-03]
 [ 0.00e+00  0.00e+00  0.00e+00 -1.69e-03 -9.74e-04]
 [ 1.00e+00  0.00e+00  2.70e-03 -4.91e-04 -7.54e-04]
 [ 0.00e+00 -1.26e-03 -1.07e-04  2.37e-03  2.13e-03]
 [-1.26e-03  5.96e-04  5.83e-04 -9.98e-04 -3.56e-03]]
[[-3.44e-03  1.60e-02 -1.13e-01  2.22e-02 -5.92e-03]
 [ 1.22e-02 -5.32e-02  1.43e+00 -7.18e-02  1.96e-02]
 [-1.46e-02  5.88e-02 -2.60e+00  7.31e-02 -2.00e-02]
 [ 1.03e-02 -3.93e-02  1.40e+00 -4.05e-02  1.03e-02]
 [-2.56e-03  1.02e-02 -9.94e-02  9.40e-03 -2.19e-03]]
SymNet parameters
[[ 3.80e-02  1.07e+00  3.74e-01 -2.21e-01 -6.14e-02 -6.08e-03  1.57e+00 -1.05e-01
  -7.22e-02 -1.90e-03 -6.08e-05 -1.74e-02]
 [-7.26e-01 -4.81e-02 -2.85e-02 -3.32e-03  4.24e-03  3.06e-03  1.13e-03 -2.92e-03
  -2.87e-02  1.75e-03  2.85e-05 -3.67e-04]]
SymNet parameters
[-0.21  0.44]
SymNet parameters
[[-3.71e-01 -8.85e-02  7.68e-01 -1.63e-02  3.25e-02  2.12e-03  1.06e-02 -7.31e-03
  -1.49e-03  3.22e-03 -7.47e-04  3.15e-03 -1.24e-03]
 [ 7.01e-02 -4.05e-02 -2.50e-02  2.02e-02  6.10e-03 -6.42e-06 -8.03e-01 -2.09e-02
  -2.92e-04  2.11e-04 -6.64e-04  7.12e-04  1.71e-02]]
SymNet parameters
[0.19 0.28]
SymNet parameters
[[-1.12e-01 -8.24e-02 -2.35e-02  1.49e-02  5.38e-03  1.27e-03  7.84e-01 -1.60e-02
  -2.41e-03 -9.33e-06  9.21e-05  4.43e-04 -2.11e-02  7.93e-03]
 [-1.43e+00 -1.07e-01  2.75e+00  1.30e-01 -4.17e-02  2.21e-02 -1.48e-01  5.65e-02
  -1.50e-01  4.27e-03  2.31e-03 -1.52e-03  2.86e-02  1.66e-01]]
SymNet parameters
[-0.24 -0.08]
SymNet parameters
[[ 0.17  0.94  0.25 -0.1  -0.02 -0.04 -0.39 -0.   -0.06 -0.02 -0.01  0.01  0.12 -0.46
   0.03]
 [-0.51  0.52  0.01 -0.81 -0.29 -0.13 -0.83 -0.24  1.62 -0.03  0.01 -0.06 -0.24 -1.35
  -0.24]]
SymNet parameters
[-0.02  0.01]
SymNet parameters
[[-1.43e-01  7.34e-01 -1.80e-01  2.23e-01  5.61e-02  9.03e-03 -5.86e-01  1.09e-01
   7.01e-02  8.55e-04  8.20e-04  1.58e-02  4.17e-03  4.62e-01  9.31e-02 -3.90e-03]
 [ 1.47e+00 -1.35e-01 -2.80e-03  2.05e-02  4.27e-03  3.00e-03 -1.46e-01  1.64e-02
   2.92e-02  1.12e-03  5.53e-04  1.15e-03  5.87e-02  8.02e-02  9.82e-04  2.39e-03]]
SymNet parameters
[-0.02 -0.29]
SymNet parameters
[[ 5.45e-02 -3.90e-01 -3.99e-01  8.29e-02  9.19e-03  5.21e-02 -3.27e-01  2.30e-02
   2.46e-02 -8.19e-04 -1.91e-06  2.65e-03  7.00e-01  6.22e-01 -2.54e-01  1.70e-02
  -3.61e-01]]
SymNet parameters
[0.03]
SymNet parameters
[[ 1.17e+00  8.83e-03  6.45e-03 -7.68e-05  6.81e-04  2.50e-04  5.32e-04  4.99e-03
  -3.71e-02 -2.33e-03 -6.95e-04  5.07e-03]
 [-2.21e-01 -1.23e-02 -1.14e-02  6.12e-04 -2.83e-03 -9.59e-04 -7.33e-01 -8.92e-01
   1.20e-01  1.00e-03 -4.46e-03 -2.33e-02]]
SymNet parameters
[0.12 0.13]
SymNet parameters
[[-8.46e-02 -5.33e-02  3.11e-02 -2.51e-03  4.53e-04 -3.59e-03  1.15e+00  3.41e-01
   2.20e+00 -3.04e-03 -1.61e-02  1.49e-01 -1.06e-01]
 [-2.78e-01  2.10e-02  4.87e-03  2.51e-04  9.68e-04 -8.09e-04 -1.88e+00 -5.46e-02
  -3.99e-02 -4.46e-03 -9.98e-03 -5.85e-03 -1.29e-02]]
SymNet parameters
[ 0.45 -0.5 ]
SymNet parameters
[[-3.38e-01 -1.94e-01 -6.62e-02 -3.24e-03 -3.42e-04  1.83e-02  5.30e-01 -4.81e-02
   6.20e-01  6.99e-02  1.00e-01 -4.80e-02  1.62e-03  2.80e-02]
 [-8.38e-01  1.24e-01  4.36e-02 -1.06e-03  1.06e-03 -7.37e-04 -2.94e-01 -4.69e-02
  -4.54e-01 -3.59e-02  1.07e-02 -1.75e-01  1.40e-03 -2.44e-02]]
SymNet parameters
[ 1.01 -0.58]
SymNet parameters
[[-2.19e-01  2.79e-01 -3.30e-01 -4.10e-02  2.35e-02  7.81e-03 -7.95e-01 -9.72e-01
  -1.92e+00 -7.40e-02 -5.40e-01 -5.79e-01  4.51e-01  1.23e-01  6.80e-01]
 [-1.18e+00 -7.07e-03 -7.55e-02  1.62e-03  2.36e-02  5.25e-02 -2.89e-01 -2.83e-01
   1.07e-01  7.90e-02  4.84e-02  1.44e-01  1.45e-01  7.47e-02  2.67e-01]]
SymNet parameters
[ 0.19 -0.15]
SymNet parameters
[[ 1.23e+00 -6.31e-02  1.72e-02 -2.98e-03 -3.18e-03 -3.52e-03  8.60e-01  2.44e-01
  -2.20e-01 -5.53e-03 -8.71e-03  7.62e-02 -1.09e-01 -8.41e-03 -8.32e-02  8.40e-03]
 [-1.60e-01 -2.18e-02 -7.80e-03  1.27e-04 -2.00e-03 -7.48e-04 -3.83e-01 -2.29e-02
   4.25e-03  3.03e-03  4.57e-03 -1.40e-02 -1.38e-02 -6.83e-03 -1.17e-02 -2.16e-04]]
SymNet parameters
[ 0.12 -0.16]
SymNet parameters
[[-4.48e-01  1.89e-02  1.10e-03 -4.88e-04  6.55e-04  1.15e-04  1.05e-01  9.11e-02
   2.29e-01  4.62e-02 -5.06e-03  3.64e-02  1.01e+00  2.21e-01 -6.05e-02  4.11e-03
  -1.39e+00]]
SymNet parameters
[-0.04]
finally, finish this stage
iter:  2000    time: 10.67
Func: 1.97e-02  |g|: 2.66e-03
stableloss: 8.07e-03   dataloss: 1.32e-02   sparseloss: 6.63e+01 momentloss: 6.48e+00
current expression:
[u00*u01, u10*v00, u20, u02, u00*u01**2, u01*u10*v00, u00*u11*v00, u10*v00*v10, u00*u10*v01, u00, v00, u00*u01*v00, u10, u00**2*v01, v10, u00*u10*v00**2, u00*u01*u10, u00**3, u00**2*u10, v00*v01]
[-0.98 -0.97  0.05  0.05  0.02  0.01  0.01  0.01  0.01  0.01  0.01 -0.    0.   -0.
  0.    0.    0.   -0.    0.   -0.  ]
[v00*v10, u00*v01, v02, v20, v00, v00*v10**2, u00, u00*v01*v10, u00*v00, u00*v10, u00*v00*v11, u00*v00*v10, v00**3, v00**2*v10, u00*u01*v01, u00**2*v00, v10, u00**2*v10, v01, 1]
[-0.97 -0.97  0.05  0.05  0.02  0.01  0.01  0.01 -0.01 -0.01  0.01 -0.01 -0.01 -0.01
  0.01 -0.    0.    0.    0.   -0.  ]
block:  2
name:  burgers-2-upwind-sparse0-noise0.001-id18
device:  cuda:2
generate a random number to check random seed:  -1.2945277651906293
current stage is: block-2
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.9823, device='cuda:2', dtype=torch.float64)
u_obs variance
tensor([ 0.2582,  1.8357,  1.7355, 24.5447, 11.0278, 20.3867,  0.2761,  1.9190,
         1.8411, 22.9904, 11.1795, 23.5434], device='cuda:2',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
iter:     0    time: 1228.76
Func: 1.09e-01  |g|: 1.55e+01
stableloss: 2.54e-02   dataloss: 9.60e-02   sparseloss: 6.63e+01 momentloss: 6.48e+00
iter:   200    time: 14.50
Func: 7.56e-02  |g|: 8.84e-02
stableloss: 2.30e-02   dataloss: 6.12e-02   sparseloss: 6.63e+01 momentloss: 7.19e+00
iter:   400    time: 14.39
Func: 7.40e-02  |g|: 4.97e-02
stableloss: 2.30e-02   dataloss: 5.97e-02   sparseloss: 7.06e+01 momentloss: 7.16e+00
iter:   600    time: 14.38
Func: 7.37e-02  |g|: 4.23e-02
stableloss: 2.29e-02   dataloss: 5.93e-02   sparseloss: 7.62e+01 momentloss: 7.17e+00
iter:   800    time: 14.43
Func: 7.34e-02  |g|: 1.65e-01
stableloss: 2.31e-02   dataloss: 5.89e-02   sparseloss: 9.24e+01 momentloss: 7.24e+00
iter:  1000    time: 14.39
Func: 7.25e-02  |g|: 5.33e-01
stableloss: 2.32e-02   dataloss: 5.81e-02   sparseloss: 1.13e+02 momentloss: 7.23e+00
iter:  1200    time: 14.40
Func: 7.21e-02  |g|: 7.86e-01
stableloss: 2.34e-02   dataloss: 5.76e-02   sparseloss: 1.24e+02 momentloss: 7.20e+00
iter:  1400    time: 14.39
Func: 7.16e-02  |g|: 9.61e-01
stableloss: 2.33e-02   dataloss: 5.71e-02   sparseloss: 1.31e+02 momentloss: 7.24e+00
iter:  1600    time: 14.41
Func: 7.14e-02  |g|: 1.16e+00
stableloss: 2.32e-02   dataloss: 5.69e-02   sparseloss: 1.33e+02 momentloss: 7.22e+00
iter:  1800    time: 14.66
Func: 7.12e-02  |g|: 7.27e-01
stableloss: 2.32e-02   dataloss: 5.68e-02   sparseloss: 1.37e+02 momentloss: 7.21e+00
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 0.071214
         Iterations: 1821
         Function evaluations: 1882
         Gradient evaluations: 1875
convolution moment and kernels
[[ 1.00e+00  0.00e+00 -9.84e-05 -1.97e-02 -5.81e-02]
 [ 0.00e+00 -4.95e-04  2.06e-03  3.37e-04 -3.34e-03]
 [ 2.57e-04 -1.25e-03  6.16e-03  2.57e-02  2.09e-03]
 [ 3.83e-02  7.91e-04 -2.32e-03  1.58e-03 -1.92e-02]
 [-8.19e-02 -2.19e-02 -7.58e-03 -9.90e-03  5.04e-03]]
[[ 1.93e-02 -6.38e-02  9.65e-04 -6.78e-02  1.02e-02]
 [-6.76e-02  2.01e-01  7.31e-02  1.67e-01 -6.87e-03]
 [ 3.30e-02 -6.73e-03  4.62e-01  1.09e-01 -8.91e-02]
 [-3.31e-02  7.38e-02  1.82e-01  4.17e-02  2.53e-02]
 [ 1.81e-04  8.25e-03 -6.60e-02  2.37e-03 -7.55e-03]]
[[ 0.00e+00  1.00e+00  0.00e+00 -9.24e-02 -6.90e-02]
 [ 0.00e+00  0.00e+00 -6.51e-03 -1.08e-02 -2.77e-02]
 [ 0.00e+00  2.91e-02  4.65e-03  3.28e-02 -1.41e-02]
 [ 1.68e-03  4.40e-04  4.76e-03  1.19e-03 -1.13e-02]
 [ 2.55e-02 -1.61e-02  4.70e-03 -8.75e-03 -3.78e-03]]
[[ 5.52e-03 -1.44e-03  2.54e-02 -5.14e-04 -4.33e-03]
 [-3.10e-02 -1.21e-03 -6.98e-02 -3.70e-02  3.88e-02]
 [ 1.25e-01 -5.33e-01 -2.27e-01  1.03e+00 -2.41e-01]
 [-3.57e-02  1.63e-02 -1.15e-01  1.28e-02  1.76e-02]
 [-3.06e-03  3.56e-02 -2.73e-02  3.11e-02 -1.00e-02]]
[[ 0.    0.    0.    0.    0.01]
 [ 1.    0.    0.   -0.01 -0.05]
 [ 0.   -0.02 -0.03 -0.   -0.01]
 [-0.09  0.    0.03  0.   -0.03]
 [-0.08 -0.02 -0.03 -0.   -0.01]]
[[ 0.01 -0.06  0.17 -0.08  0.  ]
 [ 0.02  0.01 -0.54  0.06  0.02]
 [-0.01 -0.05 -0.3  -0.14 -0.01]
 [ 0.02 -0.02  1.03  0.06  0.01]
 [-0.02  0.06 -0.27  0.03 -0.01]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00 -9.75e-03]
 [ 0.00e+00  0.00e+00  0.00e+00  8.08e-04  9.83e-04]
 [ 0.00e+00  0.00e+00  6.71e-03 -1.71e-03  1.99e-04]
 [ 0.00e+00  7.75e-05 -2.50e-03  7.71e-04  3.56e-03]
 [ 2.55e-02 -6.57e-04 -1.33e-03 -1.90e-03 -4.10e-03]]
[[-4.78e-03  2.08e-02 -7.78e-03  2.40e-02 -6.74e-03]
 [ 1.60e-02 -5.88e-02 -1.41e-02 -6.63e-02  2.11e-02]
 [-1.13e-01  1.44e+00 -2.49e+00  1.44e+00 -1.19e-01]
 [ 1.00e-02 -2.93e-02 -6.15e-02 -3.60e-02  1.47e-02]
 [-1.48e-03  4.44e-03  1.89e-02  6.50e-03 -2.82e-03]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  6.96e-04]
 [ 0.00e+00  1.00e+00  0.00e+00 -3.57e-03 -2.68e-01]
 [ 0.00e+00  0.00e+00  9.39e-04 -3.46e-03 -4.05e-04]
 [ 0.00e+00 -1.82e-03  4.64e-03  5.23e-03 -4.69e-04]
 [ 2.02e-03 -7.82e-03 -7.52e-04  6.69e-03 -3.21e-03]]
[[-0.02  0.05 -0.14  0.14 -0.03]
 [ 0.15 -0.35  1.11 -1.15  0.23]
 [-0.05  0.14 -0.08 -0.02  0.01]
 [-0.09  0.16 -1.    1.17 -0.24]
 [ 0.01 -0.    0.11 -0.15  0.03]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  4.15e-02]
 [ 0.00e+00  0.00e+00  0.00e+00 -1.35e-04  1.37e-02]
 [ 1.00e+00  0.00e+00  6.04e-03  7.34e-04 -3.38e-03]
 [ 0.00e+00 -7.44e-04 -2.21e-04  1.64e-04 -1.41e-04]
 [ 3.85e-04  4.23e-03  1.66e-03 -5.19e-03 -5.51e-03]]
[[-1.07e-03  9.35e-03 -1.10e-01  2.62e-02 -7.18e-03]
 [-4.30e-03  2.29e-03  1.38e+00 -6.52e-02  2.06e-02]
 [ 3.59e-02 -1.24e-01 -2.38e+00 -2.46e-02 -1.26e-03]
 [ 1.46e-02 -7.29e-02  1.49e+00 -1.37e-01  3.88e-02]
 [-3.63e-03  1.94e-02 -1.24e-01  3.49e-02 -9.43e-03]]
SymNet parameters
[[-1.16e+00 -3.49e-01 -3.79e-01 -1.29e+00 -2.54e-01 -9.74e-03 -2.76e+00  3.49e-01
   9.08e-01 -4.00e-02 -5.57e-02 -1.20e-01]
 [-2.37e-01 -3.59e-03  1.61e-04 -3.47e-04 -8.68e-05  3.69e-04 -7.97e-03  5.24e-04
  -4.00e-03  8.58e-05  1.25e-05  8.22e-05]]
SymNet parameters
[-1.06  0.55]
SymNet parameters
[[ 1.65e-02 -5.17e-02  1.48e+00 -5.86e-03  7.79e-03  2.36e-03 -1.06e-02  3.18e-03
   3.69e-03 -8.08e-04 -4.33e-04 -2.02e-04 -5.79e-03]
 [ 2.71e-03  3.71e-03  2.13e-03  9.02e-03  1.37e-03  4.40e-05 -5.58e-01 -4.68e-03
  -8.55e-03  4.70e-04  3.96e-04  1.37e-03  9.36e-03]]
SymNet parameters
[-0.14  0.26]
SymNet parameters
[[ 4.95e-03  6.48e-04  2.75e-03  4.23e-03  2.53e-03 -6.22e-04  1.75e-01 -1.54e-02
  -2.77e-03  2.81e-05  3.56e-05  2.04e-04 -3.27e-03 -2.44e-04]
 [ 2.09e-01 -1.76e-01  3.85e+00  4.07e-03 -3.48e-01  1.64e-02  1.49e-01  2.90e-02
  -5.58e-02 -3.42e-02 -3.57e-03 -1.80e-02  7.43e-02  2.99e-02]]
SymNet parameters
[-0.47 -0.54]
SymNet parameters
[[ 4.89e+00  2.96e-01  6.01e-01  1.19e-02 -4.56e-02 -3.09e-02  2.29e-01 -2.29e-02
   5.70e-02  4.18e-03 -8.28e-03 -1.48e-02  5.04e-02  1.42e-02  3.11e-01]
 [-3.85e+00 -4.19e+00 -1.98e+00 -1.24e+00 -2.82e-02  1.31e-02 -2.98e+00  2.61e-01
   2.01e+00 -3.12e-02 -3.14e-02 -1.19e-01 -8.06e-02 -1.15e+00 -1.18e+00]]
SymNet parameters
[-0.17 -0.05]
SymNet parameters
[[-6.40e-01  2.74e+00  2.97e-01  5.21e-01  8.79e-02  2.86e-02  9.62e-01 -1.63e-01
   1.02e-01  5.87e-03  3.13e-02  4.71e-02 -3.48e-02  8.51e-02  1.00e-01 -1.14e-03]
 [ 7.29e-01 -2.49e-02 -5.37e-02  1.94e-02  8.85e-03  2.49e-03  5.86e-02 -5.28e-03
  -4.34e-03  2.24e-04  1.68e-03  3.39e-03  2.04e-02  8.61e-03 -3.34e-02  7.80e-04]]
SymNet parameters
[-0.34 -0.2 ]
SymNet parameters
[[ 0.29 -0.03 -0.43  0.55  0.11  0.05  0.97 -0.14 -0.39  0.02  0.02  0.05  0.76  1.07
  -0.1   0.02 -0.31]]
SymNet parameters
[0.53]
SymNet parameters
[[ 1.75e+00  1.50e-02  3.54e-02 -7.04e-04 -6.04e-03 -1.96e-03 -3.14e-01  4.46e-02
  -6.36e-02 -1.09e-02 -1.39e-02 -2.10e-02]
 [-3.41e-01 -3.01e-02 -1.37e-02 -1.41e-03 -9.21e-03  2.24e-03 -2.16e+00 -3.50e-01
  -1.09e-01 -1.12e-02 -1.79e-02 -3.12e-02]]
SymNet parameters
[-0.36  0.3 ]
SymNet parameters
[[ 3.91e+00  3.14e-01  1.43e-01  5.14e-02  4.08e-02 -5.15e-02  5.34e-01 -3.25e+00
   1.62e+00  1.49e-02  1.50e-02  1.88e-01  9.33e-02]
 [ 6.90e-01  9.36e-04  2.33e-02 -1.92e-03  6.85e-03 -9.45e-04 -3.82e+00 -1.18e-01
   3.93e-02  1.46e-02  2.05e-02  3.28e-02 -1.12e-02]]
SymNet parameters
[-0.35  0.22]
SymNet parameters
[[ 1.57e-01  1.42e-02 -1.35e-03  2.08e-05  1.37e-03 -5.35e-04 -4.16e-02 -9.64e-03
   1.88e-02  8.00e-04  3.77e-04  6.48e-03 -5.67e-04  2.66e-04]
 [-1.60e+00 -3.86e-02 -1.27e-01 -1.91e-02 -7.40e-03  1.45e-02  8.05e-01  1.62e+00
  -4.84e-01  1.24e-02 -8.41e-02 -1.17e-02 -4.15e-02  5.72e-04]]
SymNet parameters
[ 0.52 -1.97]
SymNet parameters
[[ 2.71e+00 -1.88e+00 -1.01e+00  1.60e-02 -3.09e-01  3.80e-02  6.64e+00 -1.76e-01
  -6.13e+00 -2.87e-01 -5.01e-01 -1.27e+00  7.36e-03 -5.95e-02 -1.89e+00]
 [ 2.11e+00  1.40e-01 -8.60e-03  7.56e-02  5.40e-02 -6.97e-02 -1.05e+00 -4.96e+00
   4.50e-01  6.57e-02  2.11e-01  3.64e-01  1.01e-01 -1.35e-03 -1.91e-01]]
SymNet parameters
[ 0.06 -0.29]
SymNet parameters
[[ 5.41e+00  9.95e-02  1.03e-01  5.94e-03 -1.13e-02 -1.45e-02 -4.03e-01 -4.26e-01
  -9.23e-01 -2.90e-02 -6.81e-02 -3.00e-02 -1.76e-02 -2.31e-04 -5.78e-01  1.14e-03]
 [-4.61e-02 -3.90e-03 -2.31e-03  1.66e-04 -1.22e-03 -4.91e-05 -4.86e-01 -1.29e-02
  -1.39e-02 -1.29e-03 -2.35e-03 -3.26e-03  3.48e-04 -1.25e-03 -1.87e-02 -2.94e-05]]
SymNet parameters
[-0.47 -0.09]
SymNet parameters
[[-2.38 -0.07 -0.08 -0.01 -0.01  0.01 -0.6   0.61 -0.15  0.06 -0.03  0.03  1.2   0.07
  -0.68  0.   -1.89]]
SymNet parameters
[-0.57]
finally, finish this stage
iter:  1821    time: 4.78
Func: 7.12e-02  |g|: 6.72e-01
stableloss: 2.33e-02   dataloss: 5.68e-02   sparseloss: 1.37e+02 momentloss: 7.21e+00
current expression:
[u00*u01, u10*v00, u20, u02, u00, u00*u01**2, u00*u11*v00, u01*u10*v00, u00*u10*v01, u10*v00*v10, u01, u00**3, v10, u00*v00, 1, u01*u10, u00**2*v10, u00**2*v00, u00**2, u10*v10]
[-0.98 -0.98  0.05  0.05  0.02  0.01  0.01  0.01  0.01  0.01 -0.01 -0.01 -0.01 -0.
  0.   -0.    0.   -0.   -0.   -0.  ]
[v00*v10, u00*v01, v02, v20, v00, v00*v10**2, u10*v00*v01, u00*v01*v10, u00*v00*v11, u01, u00*u01*v01, v00**3, u01*v00, u00*v10, v00*v01, u10*v01, u01*v00**2, u00*u10, u01*v00*v10, u00**2*u01]
[-0.98 -0.98  0.05  0.05  0.02  0.01  0.01  0.01  0.01  0.01  0.01 -0.01 -0.    0.
  0.   -0.   -0.   -0.    0.   -0.  ]
block:  3
name:  burgers-2-upwind-sparse0-noise0.001-id18
device:  cuda:2
generate a random number to check random seed:  0.32057804554174696
current stage is: block-3
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.8422, device='cuda:2', dtype=torch.float64)
u_obs variance
tensor([ 0.2299,  1.5009,  1.5093, 20.1055,  9.2794, 17.3289,  0.2491,  1.7517,
         1.7590, 21.0152, 11.7531, 22.8709], device='cuda:2',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 0.137437
         Iterations: 0
         Function evaluations: 15
         Gradient evaluations: 3
convolution moment and kernels
[[ 1.00e+00  0.00e+00 -9.19e-05 -1.97e-02 -5.81e-02]
 [ 0.00e+00 -4.94e-04  2.06e-03  3.36e-04 -3.34e-03]
 [ 2.62e-04 -1.25e-03  6.16e-03  2.57e-02  2.09e-03]
 [ 3.83e-02  7.89e-04 -2.31e-03  1.58e-03 -1.92e-02]
 [-8.19e-02 -2.19e-02 -7.58e-03 -9.90e-03  5.03e-03]]
[[ 1.93e-02 -6.38e-02  9.09e-04 -6.78e-02  1.02e-02]
 [-6.76e-02  2.01e-01  7.34e-02  1.66e-01 -6.81e-03]
 [ 3.29e-02 -6.50e-03  4.61e-01  1.10e-01 -8.92e-02]
 [-3.31e-02  7.37e-02  1.82e-01  4.15e-02  2.54e-02]
 [ 1.71e-04  8.30e-03 -6.61e-02  2.42e-03 -7.56e-03]]
[[ 0.00e+00  1.00e+00  0.00e+00 -9.24e-02 -6.90e-02]
 [ 0.00e+00  0.00e+00 -6.51e-03 -1.08e-02 -2.77e-02]
 [ 0.00e+00  2.91e-02  4.65e-03  3.28e-02 -1.41e-02]
 [ 1.68e-03  4.41e-04  4.76e-03  1.19e-03 -1.13e-02]
 [ 2.55e-02 -1.61e-02  4.71e-03 -8.76e-03 -3.79e-03]]
[[ 5.51e-03 -1.39e-03  2.53e-02 -4.52e-04 -4.35e-03]
 [-3.10e-02 -1.39e-03 -6.95e-02 -3.73e-02  3.89e-02]
 [ 1.25e-01 -5.32e-01 -2.28e-01  1.03e+00 -2.41e-01]
 [-3.56e-02  1.60e-02 -1.14e-01  1.25e-02  1.76e-02]
 [-3.07e-03  3.56e-02 -2.74e-02  3.12e-02 -1.00e-02]]
[[ 0.    0.    0.    0.    0.01]
 [ 1.    0.    0.   -0.01 -0.05]
 [ 0.   -0.02 -0.03 -0.   -0.01]
 [-0.09  0.    0.03  0.   -0.03]
 [-0.08 -0.02 -0.03 -0.   -0.01]]
[[ 0.01 -0.06  0.17 -0.08  0.  ]
 [ 0.02  0.01 -0.54  0.06  0.03]
 [-0.01 -0.05 -0.3  -0.14 -0.01]
 [ 0.02 -0.02  1.03  0.06  0.01]
 [-0.02  0.06 -0.27  0.03 -0.01]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00 -9.75e-03]
 [ 0.00e+00  0.00e+00  0.00e+00  8.10e-04  9.87e-04]
 [ 0.00e+00  0.00e+00  6.70e-03 -1.71e-03  2.03e-04]
 [ 0.00e+00  7.79e-05 -2.50e-03  7.70e-04  3.56e-03]
 [ 2.55e-02 -6.58e-04 -1.33e-03 -1.90e-03 -4.10e-03]]
[[-4.78e-03  2.08e-02 -7.77e-03  2.40e-02 -6.74e-03]
 [ 1.60e-02 -5.89e-02 -1.40e-02 -6.64e-02  2.12e-02]
 [-1.13e-01  1.44e+00 -2.49e+00  1.44e+00 -1.19e-01]
 [ 1.00e-02 -2.94e-02 -6.14e-02 -3.62e-02  1.47e-02]
 [-1.49e-03  4.47e-03  1.88e-02  6.53e-03 -2.83e-03]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  6.94e-04]
 [ 0.00e+00  1.00e+00  0.00e+00 -3.57e-03 -2.68e-01]
 [ 0.00e+00  0.00e+00  9.34e-04 -3.46e-03 -4.03e-04]
 [ 0.00e+00 -1.82e-03  4.64e-03  5.23e-03 -4.70e-04]
 [ 2.02e-03 -7.82e-03 -7.55e-04  6.69e-03 -3.21e-03]]
[[-0.02  0.05 -0.14  0.14 -0.03]
 [ 0.15 -0.35  1.11 -1.15  0.23]
 [-0.05  0.14 -0.08 -0.02  0.01]
 [-0.09  0.16 -1.    1.17 -0.24]
 [ 0.01 -0.    0.11 -0.15  0.03]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  4.15e-02]
 [ 0.00e+00  0.00e+00  0.00e+00 -1.32e-04  1.37e-02]
 [ 1.00e+00  0.00e+00  6.03e-03  7.32e-04 -3.37e-03]
 [ 0.00e+00 -7.38e-04 -2.19e-04  1.69e-04 -1.42e-04]
 [ 3.85e-04  4.24e-03  1.66e-03 -5.19e-03 -5.51e-03]]
[[-1.07e-03  9.35e-03 -1.10e-01  2.62e-02 -7.18e-03]
 [-4.27e-03  2.21e-03  1.38e+00 -6.53e-02  2.07e-02]
 [ 3.59e-02 -1.24e-01 -2.38e+00 -2.46e-02 -1.26e-03]
 [ 1.46e-02 -7.28e-02  1.49e+00 -1.37e-01  3.88e-02]
 [-3.63e-03  1.94e-02 -1.24e-01  3.49e-02 -9.43e-03]]
SymNet parameters
[[-1.16e+00 -3.49e-01 -3.79e-01 -1.29e+00 -2.54e-01 -9.74e-03 -2.76e+00  3.49e-01
   9.08e-01 -4.00e-02 -5.57e-02 -1.20e-01]
 [-2.37e-01 -3.58e-03  1.58e-04 -3.94e-04 -1.21e-04  3.70e-04 -8.00e-03  5.32e-04
  -4.02e-03  1.04e-04 -1.24e-05  8.69e-05]]
SymNet parameters
[-1.06  0.55]
SymNet parameters
[[ 1.65e-02 -5.17e-02  1.48e+00 -5.86e-03  7.78e-03  2.35e-03 -1.07e-02  3.18e-03
   3.70e-03 -7.92e-04 -4.31e-04 -1.93e-04 -5.78e-03]
 [ 2.71e-03  3.70e-03  2.13e-03  9.02e-03  1.40e-03  3.60e-05 -5.58e-01 -4.69e-03
  -8.55e-03  4.64e-04  3.90e-04  1.37e-03  9.35e-03]]
SymNet parameters
[-0.14  0.26]
SymNet parameters
[[ 4.95e-03  6.49e-04  2.74e-03  4.23e-03  2.53e-03 -6.17e-04  1.75e-01 -1.54e-02
  -2.76e-03  2.93e-05  3.62e-05  2.06e-04 -3.26e-03 -2.41e-04]
 [ 2.09e-01 -1.76e-01  3.85e+00  4.06e-03 -3.48e-01  1.64e-02  1.49e-01  2.90e-02
  -5.58e-02 -3.42e-02 -3.57e-03 -1.80e-02  7.42e-02  2.99e-02]]
SymNet parameters
[-0.47 -0.54]
SymNet parameters
[[ 4.89e+00  2.96e-01  6.01e-01  1.19e-02 -4.56e-02 -3.09e-02  2.29e-01 -2.29e-02
   5.70e-02  4.18e-03 -8.28e-03 -1.48e-02  5.04e-02  1.42e-02  3.11e-01]
 [-3.85e+00 -4.19e+00 -1.98e+00 -1.24e+00 -2.82e-02  1.31e-02 -2.98e+00  2.61e-01
   2.01e+00 -3.12e-02 -3.14e-02 -1.19e-01 -8.06e-02 -1.15e+00 -1.18e+00]]
SymNet parameters
[-0.17 -0.05]
SymNet parameters
[[-6.40e-01  2.74e+00  2.97e-01  5.21e-01  8.79e-02  2.86e-02  9.62e-01 -1.63e-01
   1.02e-01  5.85e-03  3.13e-02  4.71e-02 -3.48e-02  8.51e-02  1.00e-01 -1.09e-03]
 [ 7.29e-01 -2.49e-02 -5.37e-02  1.94e-02  8.84e-03  2.47e-03  5.86e-02 -5.28e-03
  -4.35e-03  2.26e-04  1.67e-03  3.39e-03  2.04e-02  8.61e-03 -3.34e-02  1.22e-03]]
SymNet parameters
[-0.34 -0.2 ]
SymNet parameters
[[ 0.29 -0.03 -0.43  0.55  0.11  0.05  0.97 -0.14 -0.39  0.02  0.02  0.05  0.76  1.07
  -0.1   0.02 -0.31]]
SymNet parameters
[0.53]
SymNet parameters
[[ 1.75e+00  1.50e-02  3.54e-02 -7.10e-04 -6.03e-03 -1.98e-03 -3.14e-01  4.46e-02
  -6.36e-02 -1.09e-02 -1.39e-02 -2.10e-02]
 [-3.41e-01 -3.01e-02 -1.37e-02 -1.40e-03 -9.21e-03  2.23e-03 -2.16e+00 -3.50e-01
  -1.09e-01 -1.12e-02 -1.79e-02 -3.12e-02]]
SymNet parameters
[-0.36  0.3 ]
SymNet parameters
[[ 3.91e+00  3.14e-01  1.43e-01  5.13e-02  4.08e-02 -5.15e-02  5.34e-01 -3.25e+00
   1.62e+00  1.49e-02  1.50e-02  1.88e-01  9.33e-02]
 [ 6.90e-01  9.46e-04  2.33e-02 -1.91e-03  6.85e-03 -9.48e-04 -3.82e+00 -1.18e-01
   3.93e-02  1.46e-02  2.05e-02  3.28e-02 -1.12e-02]]
SymNet parameters
[-0.35  0.22]
SymNet parameters
[[ 1.57e-01  1.43e-02 -1.35e-03  4.66e-05  1.38e-03 -5.53e-04 -4.16e-02 -9.63e-03
   1.88e-02  7.86e-04  3.91e-04  6.48e-03 -5.93e-04  1.51e-04]
 [-1.60e+00 -3.86e-02 -1.27e-01 -1.91e-02 -7.41e-03  1.45e-02  8.05e-01  1.62e+00
  -4.84e-01  1.24e-02 -8.41e-02 -1.17e-02 -4.15e-02  5.93e-04]]
SymNet parameters
[ 0.52 -1.97]
SymNet parameters
[[ 2.71e+00 -1.88e+00 -1.01e+00  1.59e-02 -3.09e-01  3.80e-02  6.64e+00 -1.76e-01
  -6.13e+00 -2.87e-01 -5.01e-01 -1.27e+00  7.33e-03 -5.95e-02 -1.89e+00]
 [ 2.11e+00  1.40e-01 -8.65e-03  7.56e-02  5.41e-02 -6.97e-02 -1.05e+00 -4.96e+00
   4.50e-01  6.57e-02  2.11e-01  3.64e-01  1.01e-01 -1.35e-03 -1.91e-01]]
SymNet parameters
[ 0.06 -0.29]
SymNet parameters
[[ 5.41e+00  9.95e-02  1.03e-01  5.94e-03 -1.13e-02 -1.45e-02 -4.03e-01 -4.26e-01
  -9.23e-01 -2.90e-02 -6.81e-02 -3.00e-02 -1.76e-02 -2.31e-04 -5.78e-01  1.00e-03]
 [-4.61e-02 -3.92e-03 -2.32e-03  1.24e-04 -1.21e-03 -1.88e-05 -4.86e-01 -1.29e-02
  -1.40e-02 -1.20e-03 -2.36e-03 -3.14e-03  3.10e-04 -4.25e-04 -1.87e-02 -3.55e-04]]
SymNet parameters
[-0.47 -0.09]
SymNet parameters
[[-2.38 -0.07 -0.08 -0.01 -0.01  0.01 -0.6   0.61 -0.15  0.06 -0.03  0.03  1.2   0.07
  -0.68  0.   -1.89]]
SymNet parameters
[-0.57]
finally, finish this stage
iter:     0    time: 465.42
Func: 1.37e-01  |g|: 2.11e+01
stableloss: 2.04e-02   dataloss: 1.16e-01   sparseloss: 1.37e+02 momentloss: 7.21e+00
current expression:
[u00*u01, u10*v00, u20, u02, u00, u00*u01**2, u00*u11*v00, u01*u10*v00, u00*u10*v01, u10*v00*v10, u01, u00**3, v10, u00*v00, 1, u01*u10, u00**2*v10, u00**2*v00, u00**2, u10*v10]
[-0.98 -0.98  0.05  0.05  0.02  0.01  0.01  0.01  0.01  0.01 -0.01 -0.01 -0.01 -0.
  0.   -0.    0.   -0.   -0.   -0.  ]
[v00*v10, u00*v01, v02, v20, v00, v00*v10**2, u10*v00*v01, u00*v01*v10, u00*v00*v11, u01, u00*u01*v01, v00**3, u01*v00, u00*v10, v00*v01, u10*v01, u01*v00**2, u00*u10, u01*v00*v10, u00**2*u01]
[-0.98 -0.98  0.05  0.05  0.02  0.01  0.01  0.01  0.01  0.01  0.01 -0.01 -0.    0.
  0.   -0.   -0.   -0.    0.   -0.  ]
block:  4
name:  burgers-2-upwind-sparse0-noise0.001-id18
device:  cuda:2
generate a random number to check random seed:  0.36815897876890225
current stage is: block-4
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.8808, device='cuda:2', dtype=torch.float64)
u_obs variance
tensor([ 0.2510,  1.7076,  1.6499, 23.3079, 11.4280, 19.3139,  0.2340,  1.5096,
         1.5339, 18.1302,  9.6724, 19.6401], device='cuda:2',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 0.338185
         Iterations: 0
         Function evaluations: 15
         Gradient evaluations: 3
convolution moment and kernels
[[ 1.00e+00  0.00e+00 -9.21e-05 -1.97e-02 -5.81e-02]
 [ 0.00e+00 -4.94e-04  2.06e-03  3.36e-04 -3.34e-03]
 [ 2.63e-04 -1.24e-03  6.16e-03  2.57e-02  2.09e-03]
 [ 3.83e-02  7.89e-04 -2.32e-03  1.58e-03 -1.92e-02]
 [-8.19e-02 -2.19e-02 -7.58e-03 -9.90e-03  5.03e-03]]
[[ 1.93e-02 -6.38e-02  9.40e-04 -6.78e-02  1.02e-02]
 [-6.76e-02  2.01e-01  7.32e-02  1.67e-01 -6.85e-03]
 [ 3.30e-02 -6.67e-03  4.61e-01  1.09e-01 -8.91e-02]
 [-3.31e-02  7.38e-02  1.82e-01  4.17e-02  2.53e-02]
 [ 1.78e-04  8.26e-03 -6.60e-02  2.37e-03 -7.55e-03]]
[[ 0.00e+00  1.00e+00  0.00e+00 -9.24e-02 -6.90e-02]
 [ 0.00e+00  0.00e+00 -6.51e-03 -1.08e-02 -2.77e-02]
 [ 0.00e+00  2.91e-02  4.65e-03  3.28e-02 -1.41e-02]
 [ 1.68e-03  4.41e-04  4.76e-03  1.19e-03 -1.13e-02]
 [ 2.55e-02 -1.61e-02  4.70e-03 -8.76e-03 -3.79e-03]]
[[ 5.51e-03 -1.41e-03  2.54e-02 -4.80e-04 -4.34e-03]
 [-3.10e-02 -1.31e-03 -6.96e-02 -3.71e-02  3.88e-02]
 [ 1.25e-01 -5.32e-01 -2.28e-01  1.03e+00 -2.41e-01]
 [-3.56e-02  1.62e-02 -1.14e-01  1.27e-02  1.76e-02]
 [-3.06e-03  3.56e-02 -2.74e-02  3.11e-02 -1.00e-02]]
[[ 0.    0.    0.    0.    0.01]
 [ 1.    0.    0.   -0.01 -0.05]
 [ 0.   -0.02 -0.03 -0.   -0.01]
 [-0.09  0.    0.03  0.   -0.03]
 [-0.08 -0.02 -0.03 -0.   -0.01]]
[[ 0.01 -0.06  0.17 -0.08  0.  ]
 [ 0.02  0.01 -0.54  0.06  0.02]
 [-0.01 -0.05 -0.3  -0.14 -0.01]
 [ 0.02 -0.02  1.03  0.06  0.01]
 [-0.02  0.06 -0.27  0.03 -0.01]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00 -9.75e-03]
 [ 0.00e+00  0.00e+00  0.00e+00  8.09e-04  9.86e-04]
 [ 0.00e+00  0.00e+00  6.70e-03 -1.71e-03  2.02e-04]
 [ 0.00e+00  7.78e-05 -2.50e-03  7.70e-04  3.56e-03]
 [ 2.55e-02 -6.60e-04 -1.33e-03 -1.90e-03 -4.10e-03]]
[[-4.78e-03  2.08e-02 -7.77e-03  2.40e-02 -6.74e-03]
 [ 1.60e-02 -5.89e-02 -1.41e-02 -6.64e-02  2.11e-02]
 [-1.13e-01  1.44e+00 -2.49e+00  1.44e+00 -1.19e-01]
 [ 1.00e-02 -2.93e-02 -6.14e-02 -3.61e-02  1.47e-02]
 [-1.49e-03  4.47e-03  1.89e-02  6.52e-03 -2.83e-03]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  6.94e-04]
 [ 0.00e+00  1.00e+00  0.00e+00 -3.57e-03 -2.68e-01]
 [ 0.00e+00  0.00e+00  9.34e-04 -3.46e-03 -4.03e-04]
 [ 0.00e+00 -1.82e-03  4.64e-03  5.23e-03 -4.70e-04]
 [ 2.02e-03 -7.82e-03 -7.56e-04  6.69e-03 -3.21e-03]]
[[-0.02  0.05 -0.14  0.14 -0.03]
 [ 0.15 -0.35  1.11 -1.15  0.23]
 [-0.05  0.14 -0.08 -0.02  0.01]
 [-0.09  0.16 -1.    1.17 -0.24]
 [ 0.01 -0.    0.11 -0.15  0.03]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  4.15e-02]
 [ 0.00e+00  0.00e+00  0.00e+00 -1.32e-04  1.37e-02]
 [ 1.00e+00  0.00e+00  6.03e-03  7.31e-04 -3.38e-03]
 [ 0.00e+00 -7.38e-04 -2.20e-04  1.69e-04 -1.41e-04]
 [ 3.84e-04  4.24e-03  1.66e-03 -5.18e-03 -5.51e-03]]
[[-1.07e-03  9.35e-03 -1.10e-01  2.62e-02 -7.18e-03]
 [-4.27e-03  2.22e-03  1.38e+00 -6.53e-02  2.06e-02]
 [ 3.59e-02 -1.24e-01 -2.38e+00 -2.46e-02 -1.24e-03]
 [ 1.46e-02 -7.28e-02  1.49e+00 -1.37e-01  3.87e-02]
 [-3.63e-03  1.94e-02 -1.24e-01  3.49e-02 -9.42e-03]]
SymNet parameters
[[-1.16e+00 -3.49e-01 -3.79e-01 -1.29e+00 -2.54e-01 -9.74e-03 -2.76e+00  3.49e-01
   9.08e-01 -4.00e-02 -5.57e-02 -1.20e-01]
 [-2.37e-01 -3.59e-03  1.59e-04 -4.22e-04 -6.84e-05  3.31e-04 -7.98e-03  5.25e-04
  -4.00e-03  9.24e-05  6.92e-06  1.04e-04]]
SymNet parameters
[-1.06  0.55]
SymNet parameters
[[ 1.65e-02 -5.17e-02  1.48e+00 -5.87e-03  7.79e-03  2.35e-03 -1.06e-02  3.18e-03
   3.70e-03 -8.00e-04 -4.33e-04 -1.98e-04 -5.78e-03]
 [ 2.71e-03  3.70e-03  2.13e-03  9.02e-03  1.37e-03  4.30e-05 -5.58e-01 -4.68e-03
  -8.55e-03  4.68e-04  3.93e-04  1.37e-03  9.35e-03]]
SymNet parameters
[-0.14  0.26]
SymNet parameters
[[ 4.95e-03  6.51e-04  2.74e-03  4.24e-03  2.53e-03 -6.16e-04  1.75e-01 -1.54e-02
  -2.77e-03  2.95e-05  3.78e-05  2.08e-04 -3.27e-03 -2.44e-04]
 [ 2.09e-01 -1.76e-01  3.85e+00  4.06e-03 -3.48e-01  1.64e-02  1.49e-01  2.90e-02
  -5.58e-02 -3.42e-02 -3.57e-03 -1.80e-02  7.42e-02  2.99e-02]]
SymNet parameters
[-0.47 -0.54]
SymNet parameters
[[ 4.89e+00  2.96e-01  6.01e-01  1.19e-02 -4.56e-02 -3.09e-02  2.29e-01 -2.29e-02
   5.70e-02  4.18e-03 -8.28e-03 -1.48e-02  5.04e-02  1.42e-02  3.11e-01]
 [-3.85e+00 -4.19e+00 -1.98e+00 -1.24e+00 -2.82e-02  1.31e-02 -2.98e+00  2.61e-01
   2.01e+00 -3.12e-02 -3.14e-02 -1.19e-01 -8.06e-02 -1.15e+00 -1.18e+00]]
SymNet parameters
[-0.17 -0.05]
SymNet parameters
[[-6.40e-01  2.74e+00  2.97e-01  5.20e-01  8.79e-02  2.86e-02  9.62e-01 -1.63e-01
   1.02e-01  5.85e-03  3.13e-02  4.71e-02 -3.48e-02  8.51e-02  1.00e-01 -1.06e-03]
 [ 7.29e-01 -2.49e-02 -5.37e-02  1.93e-02  8.86e-03  2.48e-03  5.86e-02 -5.28e-03
  -4.35e-03  2.27e-04  1.67e-03  3.39e-03  2.04e-02  8.60e-03 -3.34e-02  1.13e-03]]
SymNet parameters
[-0.34 -0.2 ]
SymNet parameters
[[ 0.29 -0.03 -0.43  0.55  0.11  0.05  0.97 -0.14 -0.39  0.02  0.02  0.05  0.76  1.07
  -0.1   0.02 -0.31]]
SymNet parameters
[0.53]
SymNet parameters
[[ 1.75e+00  1.50e-02  3.54e-02 -7.11e-04 -6.03e-03 -1.96e-03 -3.14e-01  4.45e-02
  -6.36e-02 -1.09e-02 -1.39e-02 -2.10e-02]
 [-3.41e-01 -3.01e-02 -1.37e-02 -1.41e-03 -9.21e-03  2.23e-03 -2.16e+00 -3.50e-01
  -1.09e-01 -1.12e-02 -1.79e-02 -3.12e-02]]
SymNet parameters
[-0.36  0.3 ]
SymNet parameters
[[ 3.91e+00  3.14e-01  1.43e-01  5.13e-02  4.08e-02 -5.15e-02  5.34e-01 -3.25e+00
   1.62e+00  1.49e-02  1.50e-02  1.88e-01  9.33e-02]
 [ 6.90e-01  9.46e-04  2.33e-02 -1.92e-03  6.85e-03 -9.48e-04 -3.82e+00 -1.18e-01
   3.93e-02  1.46e-02  2.05e-02  3.28e-02 -1.12e-02]]
SymNet parameters
[-0.35  0.22]
SymNet parameters
[[ 1.57e-01  1.43e-02 -1.35e-03  3.02e-05  1.38e-03 -5.37e-04 -4.16e-02 -9.64e-03
   1.88e-02  7.92e-04  3.66e-04  6.48e-03 -6.12e-04 -1.02e-04]
 [-1.60e+00 -3.86e-02 -1.27e-01 -1.91e-02 -7.41e-03  1.45e-02  8.05e-01  1.62e+00
  -4.84e-01  1.24e-02 -8.41e-02 -1.17e-02 -4.15e-02  5.98e-04]]
SymNet parameters
[ 0.52 -1.97]
SymNet parameters
[[ 2.71e+00 -1.88e+00 -1.01e+00  1.59e-02 -3.09e-01  3.80e-02  6.64e+00 -1.76e-01
  -6.13e+00 -2.87e-01 -5.01e-01 -1.27e+00  7.33e-03 -5.95e-02 -1.89e+00]
 [ 2.11e+00  1.40e-01 -8.65e-03  7.56e-02  5.41e-02 -6.97e-02 -1.05e+00 -4.96e+00
   4.50e-01  6.57e-02  2.11e-01  3.64e-01  1.01e-01 -1.35e-03 -1.91e-01]]
SymNet parameters
[ 0.06 -0.29]
SymNet parameters
[[ 5.41e+00  9.95e-02  1.03e-01  5.94e-03 -1.13e-02 -1.45e-02 -4.03e-01 -4.26e-01
  -9.23e-01 -2.90e-02 -6.81e-02 -3.00e-02 -1.76e-02 -2.48e-04 -5.78e-01  1.18e-03]
 [-4.61e-02 -3.92e-03 -2.32e-03  1.94e-04 -1.22e-03  2.05e-05 -4.86e-01 -1.29e-02
  -1.40e-02 -1.36e-03 -2.34e-03 -3.24e-03  3.19e-04 -1.01e-03 -1.87e-02  2.18e-04]]
SymNet parameters
[-0.47 -0.09]
SymNet parameters
[[-2.38 -0.07 -0.08 -0.01 -0.01  0.01 -0.6   0.61 -0.15  0.06 -0.03  0.03  1.2   0.07
  -0.68  0.   -1.89]]
SymNet parameters
[-0.57]
finally, finish this stage
iter:     0    time: 42.01
Func: 3.38e-01  |g|: 1.04e+02
stableloss: 3.10e-02   dataloss: 3.09e-01   sparseloss: 1.37e+02 momentloss: 7.21e+00
current expression:
[u00*u01, u10*v00, u20, u02, u00, u00*u01**2, u00*u11*v00, u01*u10*v00, u00*u10*v01, u10*v00*v10, u01, u00**3, v10, u00*v00, 1, u01*u10, u00**2*v10, u00**2*v00, u00**2, u10*v10]
[-0.98 -0.98  0.05  0.05  0.02  0.01  0.01  0.01  0.01  0.01 -0.01 -0.01 -0.01 -0.
  0.   -0.    0.   -0.   -0.   -0.  ]
[v00*v10, u00*v01, v02, v20, v00, v00*v10**2, u10*v00*v01, u00*v01*v10, u00*v00*v11, u01, u00*u01*v01, v00**3, u01*v00, u00*v10, v00*v01, u10*v01, u01*v00**2, u00*u10, u01*v00*v10, u00**2*u01]
[-0.98 -0.98  0.05  0.05  0.02  0.01  0.01  0.01  0.01  0.01  0.01 -0.01 -0.    0.
  0.   -0.   -0.   -0.    0.   -0.  ]
block:  5
name:  burgers-2-upwind-sparse0-noise0.001-id18
device:  cuda:2
generate a random number to check random seed:  -1.1254897908885997
current stage is: block-5
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.9041, device='cuda:2', dtype=torch.float64)
u_obs variance
tensor([ 0.2582,  1.7901,  1.7538, 23.8965, 12.2873, 20.6783,  0.2462,  1.6109,
         1.7147, 18.7999, 10.5211, 22.3585], device='cuda:2',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 0.502080
         Iterations: 0
         Function evaluations: 15
         Gradient evaluations: 3
convolution moment and kernels
[[ 1.00e+00  0.00e+00 -9.24e-05 -1.97e-02 -5.81e-02]
 [ 0.00e+00 -4.94e-04  2.06e-03  3.36e-04 -3.34e-03]
 [ 2.62e-04 -1.24e-03  6.16e-03  2.57e-02  2.09e-03]
 [ 3.83e-02  7.89e-04 -2.31e-03  1.58e-03 -1.92e-02]
 [-8.19e-02 -2.19e-02 -7.58e-03 -9.90e-03  5.03e-03]]
[[ 1.93e-02 -6.38e-02  9.57e-04 -6.78e-02  1.02e-02]
 [-6.76e-02  2.01e-01  7.32e-02  1.67e-01 -6.86e-03]
 [ 3.30e-02 -6.69e-03  4.61e-01  1.09e-01 -8.91e-02]
 [-3.31e-02  7.38e-02  1.82e-01  4.17e-02  2.53e-02]
 [ 1.77e-04  8.27e-03 -6.60e-02  2.37e-03 -7.55e-03]]
[[ 0.00e+00  1.00e+00  0.00e+00 -9.24e-02 -6.90e-02]
 [ 0.00e+00  0.00e+00 -6.51e-03 -1.08e-02 -2.77e-02]
 [ 0.00e+00  2.91e-02  4.65e-03  3.28e-02 -1.41e-02]
 [ 1.68e-03  4.40e-04  4.76e-03  1.19e-03 -1.13e-02]
 [ 2.55e-02 -1.61e-02  4.70e-03 -8.75e-03 -3.78e-03]]
[[ 5.52e-03 -1.43e-03  2.54e-02 -5.04e-04 -4.34e-03]
 [-3.10e-02 -1.24e-03 -6.98e-02 -3.71e-02  3.88e-02]
 [ 1.25e-01 -5.32e-01 -2.28e-01  1.03e+00 -2.41e-01]
 [-3.56e-02  1.62e-02 -1.14e-01  1.27e-02  1.76e-02]
 [-3.07e-03  3.56e-02 -2.74e-02  3.11e-02 -1.00e-02]]
[[ 0.    0.    0.    0.    0.01]
 [ 1.    0.    0.   -0.01 -0.05]
 [ 0.   -0.02 -0.03 -0.   -0.01]
 [-0.09  0.    0.03  0.   -0.03]
 [-0.08 -0.02 -0.03 -0.   -0.01]]
[[ 0.01 -0.06  0.17 -0.08  0.  ]
 [ 0.02  0.01 -0.54  0.06  0.02]
 [-0.01 -0.05 -0.3  -0.14 -0.01]
 [ 0.02 -0.02  1.03  0.06  0.01]
 [-0.02  0.06 -0.27  0.03 -0.01]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00 -9.75e-03]
 [ 0.00e+00  0.00e+00  0.00e+00  8.09e-04  9.87e-04]
 [ 0.00e+00  0.00e+00  6.70e-03 -1.71e-03  2.02e-04]
 [ 0.00e+00  7.77e-05 -2.50e-03  7.70e-04  3.56e-03]
 [ 2.55e-02 -6.60e-04 -1.33e-03 -1.90e-03 -4.10e-03]]
[[-4.78e-03  2.08e-02 -7.76e-03  2.40e-02 -6.74e-03]
 [ 1.60e-02 -5.89e-02 -1.41e-02 -6.64e-02  2.11e-02]
 [-1.13e-01  1.44e+00 -2.49e+00  1.44e+00 -1.19e-01]
 [ 1.00e-02 -2.93e-02 -6.14e-02 -3.61e-02  1.47e-02]
 [-1.49e-03  4.47e-03  1.89e-02  6.52e-03 -2.83e-03]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  6.94e-04]
 [ 0.00e+00  1.00e+00  0.00e+00 -3.57e-03 -2.68e-01]
 [ 0.00e+00  0.00e+00  9.34e-04 -3.46e-03 -4.03e-04]
 [ 0.00e+00 -1.82e-03  4.64e-03  5.23e-03 -4.69e-04]
 [ 2.02e-03 -7.82e-03 -7.56e-04  6.69e-03 -3.21e-03]]
[[-0.02  0.05 -0.14  0.14 -0.03]
 [ 0.15 -0.35  1.11 -1.15  0.23]
 [-0.05  0.14 -0.08 -0.02  0.01]
 [-0.09  0.16 -1.    1.17 -0.24]
 [ 0.01 -0.    0.11 -0.15  0.03]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  4.15e-02]
 [ 0.00e+00  0.00e+00  0.00e+00 -1.32e-04  1.37e-02]
 [ 1.00e+00  0.00e+00  6.03e-03  7.31e-04 -3.38e-03]
 [ 0.00e+00 -7.38e-04 -2.19e-04  1.69e-04 -1.42e-04]
 [ 3.85e-04  4.24e-03  1.66e-03 -5.18e-03 -5.51e-03]]
[[-1.07e-03  9.35e-03 -1.10e-01  2.62e-02 -7.18e-03]
 [-4.28e-03  2.23e-03  1.38e+00 -6.53e-02  2.06e-02]
 [ 3.59e-02 -1.24e-01 -2.38e+00 -2.46e-02 -1.24e-03]
 [ 1.46e-02 -7.28e-02  1.49e+00 -1.37e-01  3.87e-02]
 [-3.63e-03  1.94e-02 -1.24e-01  3.49e-02 -9.42e-03]]
SymNet parameters
[[-1.16e+00 -3.49e-01 -3.79e-01 -1.29e+00 -2.54e-01 -9.74e-03 -2.76e+00  3.49e-01
   9.08e-01 -4.00e-02 -5.57e-02 -1.20e-01]
 [-2.37e-01 -3.59e-03  1.65e-04 -4.09e-04 -1.07e-04  3.62e-04 -7.98e-03  5.32e-04
  -4.00e-03  7.31e-05  1.81e-06  7.31e-05]]
SymNet parameters
[-1.06  0.55]
SymNet parameters
[[ 1.65e-02 -5.17e-02  1.48e+00 -5.87e-03  7.79e-03  2.35e-03 -1.06e-02  3.18e-03
   3.70e-03 -8.06e-04 -4.34e-04 -2.02e-04 -5.78e-03]
 [ 2.70e-03  3.70e-03  2.13e-03  9.02e-03  1.37e-03  4.39e-05 -5.58e-01 -4.68e-03
  -8.55e-03  4.75e-04  3.95e-04  1.37e-03  9.36e-03]]
SymNet parameters
[-0.14  0.26]
SymNet parameters
[[ 4.96e-03  6.50e-04  2.74e-03  4.23e-03  2.52e-03 -6.23e-04  1.75e-01 -1.54e-02
  -2.77e-03  3.10e-05  3.63e-05  2.08e-04 -3.26e-03 -2.43e-04]
 [ 2.09e-01 -1.76e-01  3.85e+00  4.06e-03 -3.48e-01  1.64e-02  1.49e-01  2.90e-02
  -5.58e-02 -3.42e-02 -3.57e-03 -1.80e-02  7.42e-02  2.99e-02]]
SymNet parameters
[-0.47 -0.54]
SymNet parameters
[[ 4.89e+00  2.96e-01  6.01e-01  1.19e-02 -4.56e-02 -3.09e-02  2.29e-01 -2.29e-02
   5.70e-02  4.18e-03 -8.28e-03 -1.48e-02  5.04e-02  1.42e-02  3.11e-01]
 [-3.85e+00 -4.19e+00 -1.98e+00 -1.24e+00 -2.82e-02  1.31e-02 -2.98e+00  2.61e-01
   2.01e+00 -3.12e-02 -3.14e-02 -1.19e-01 -8.06e-02 -1.15e+00 -1.18e+00]]
SymNet parameters
[-0.17 -0.05]
SymNet parameters
[[-6.40e-01  2.74e+00  2.97e-01  5.21e-01  8.79e-02  2.86e-02  9.62e-01 -1.63e-01
   1.02e-01  5.85e-03  3.13e-02  4.71e-02 -3.48e-02  8.51e-02  1.00e-01 -1.09e-03]
 [ 7.29e-01 -2.49e-02 -5.37e-02  1.93e-02  8.84e-03  2.48e-03  5.86e-02 -5.28e-03
  -4.35e-03  2.16e-04  1.67e-03  3.38e-03  2.04e-02  8.61e-03 -3.34e-02  8.59e-04]]
SymNet parameters
[-0.34 -0.2 ]
SymNet parameters
[[ 0.29 -0.03 -0.43  0.55  0.11  0.05  0.97 -0.14 -0.39  0.02  0.02  0.05  0.76  1.07
  -0.1   0.02 -0.31]]
SymNet parameters
[0.53]
SymNet parameters
[[ 1.75e+00  1.50e-02  3.54e-02 -7.17e-04 -6.03e-03 -1.96e-03 -3.14e-01  4.45e-02
  -6.36e-02 -1.09e-02 -1.39e-02 -2.10e-02]
 [-3.41e-01 -3.01e-02 -1.37e-02 -1.42e-03 -9.22e-03  2.23e-03 -2.16e+00 -3.50e-01
  -1.09e-01 -1.12e-02 -1.79e-02 -3.12e-02]]
SymNet parameters
[-0.36  0.3 ]
SymNet parameters
[[ 3.91e+00  3.14e-01  1.43e-01  5.13e-02  4.08e-02 -5.15e-02  5.34e-01 -3.25e+00
   1.62e+00  1.49e-02  1.50e-02  1.88e-01  9.33e-02]
 [ 6.90e-01  9.46e-04  2.33e-02 -1.92e-03  6.85e-03 -9.49e-04 -3.82e+00 -1.18e-01
   3.93e-02  1.46e-02  2.05e-02  3.28e-02 -1.12e-02]]
SymNet parameters
[-0.35  0.22]
SymNet parameters
[[ 1.57e-01  1.43e-02 -1.35e-03  2.14e-05  1.37e-03 -5.46e-04 -4.16e-02 -9.64e-03
   1.88e-02  7.97e-04  3.76e-04  6.46e-03 -5.74e-04  2.74e-04]
 [-1.60e+00 -3.86e-02 -1.27e-01 -1.91e-02 -7.41e-03  1.45e-02  8.05e-01  1.62e+00
  -4.84e-01  1.24e-02 -8.41e-02 -1.17e-02 -4.15e-02  5.76e-04]]
SymNet parameters
[ 0.52 -1.97]
SymNet parameters
[[ 2.71e+00 -1.88e+00 -1.01e+00  1.59e-02 -3.09e-01  3.80e-02  6.64e+00 -1.76e-01
  -6.13e+00 -2.87e-01 -5.01e-01 -1.27e+00  7.33e-03 -5.95e-02 -1.89e+00]
 [ 2.11e+00  1.40e-01 -8.65e-03  7.56e-02  5.41e-02 -6.97e-02 -1.05e+00 -4.96e+00
   4.50e-01  6.57e-02  2.11e-01  3.64e-01  1.01e-01 -1.35e-03 -1.91e-01]]
SymNet parameters
[ 0.06 -0.29]
SymNet parameters
[[ 5.41e+00  9.95e-02  1.03e-01  5.94e-03 -1.13e-02 -1.45e-02 -4.03e-01 -4.26e-01
  -9.23e-01 -2.90e-02 -6.81e-02 -3.00e-02 -1.76e-02 -2.40e-04 -5.78e-01  1.18e-03]
 [-4.61e-02 -3.91e-03 -2.33e-03  2.29e-04 -1.16e-03  4.62e-05 -4.86e-01 -1.29e-02
  -1.40e-02 -1.32e-03 -2.32e-03 -3.16e-03  2.56e-04 -1.18e-03 -1.87e-02  3.67e-04]]
SymNet parameters
[-0.47 -0.09]
SymNet parameters
[[-2.38 -0.07 -0.08 -0.01 -0.01  0.01 -0.6   0.61 -0.15  0.06 -0.03  0.03  1.2   0.07
  -0.68  0.   -1.89]]
SymNet parameters
[-0.57]
finally, finish this stage
iter:     0    time: 42.46
Func: 5.02e-01  |g|: 1.28e+02
stableloss: 4.93e-02   dataloss: 4.66e-01   sparseloss: 1.37e+02 momentloss: 7.21e+00
current expression:
[u00*u01, u10*v00, u20, u02, u00, u00*u01**2, u00*u11*v00, u01*u10*v00, u00*u10*v01, u10*v00*v10, u01, u00**3, v10, u00*v00, 1, u01*u10, u00**2*v10, u00**2*v00, u00**2, u10*v10]
[-0.98 -0.98  0.05  0.05  0.02  0.01  0.01  0.01  0.01  0.01 -0.01 -0.01 -0.01 -0.
  0.   -0.    0.   -0.   -0.   -0.  ]
[v00*v10, u00*v01, v02, v20, v00, v00*v10**2, u10*v00*v01, u00*v01*v10, u00*v00*v11, u01, u00*u01*v01, v00**3, u01*v00, u00*v10, v00*v01, u10*v01, u01*v00**2, u00*u10, u01*v00*v10, u00**2*u01]
[-0.98 -0.98  0.05  0.05  0.02  0.01  0.01  0.01  0.01  0.01  0.01 -0.01 -0.    0.
  0.   -0.   -0.   -0.    0.   -0.  ]
block:  6
name:  burgers-2-upwind-sparse0-noise0.001-id18
device:  cuda:2
generate a random number to check random seed:  -1.3446349453867839
current stage is: block-6
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.9287, device='cuda:2', dtype=torch.float64)
u_obs variance
tensor([ 0.2385,  1.6513,  1.6083, 21.2370, 10.5266, 18.6523,  0.2394,  1.5265,
         1.6374, 18.0573,  9.9760, 20.7320], device='cuda:2',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 0.557464
         Iterations: 0
         Function evaluations: 15
         Gradient evaluations: 3
convolution moment and kernels
[[ 1.00e+00  0.00e+00 -9.25e-05 -1.97e-02 -5.81e-02]
 [ 0.00e+00 -4.94e-04  2.06e-03  3.36e-04 -3.34e-03]
 [ 2.63e-04 -1.24e-03  6.16e-03  2.57e-02  2.09e-03]
 [ 3.83e-02  7.89e-04 -2.31e-03  1.58e-03 -1.92e-02]
 [-8.19e-02 -2.19e-02 -7.58e-03 -9.90e-03  5.04e-03]]
[[ 1.93e-02 -6.38e-02  9.59e-04 -6.78e-02  1.02e-02]
 [-6.76e-02  2.01e-01  7.31e-02  1.67e-01 -6.86e-03]
 [ 3.30e-02 -6.72e-03  4.61e-01  1.09e-01 -8.91e-02]
 [-3.31e-02  7.38e-02  1.82e-01  4.17e-02  2.53e-02]
 [ 1.78e-04  8.26e-03 -6.60e-02  2.36e-03 -7.55e-03]]
[[ 0.00e+00  1.00e+00  0.00e+00 -9.24e-02 -6.90e-02]
 [ 0.00e+00  0.00e+00 -6.51e-03 -1.08e-02 -2.77e-02]
 [ 0.00e+00  2.91e-02  4.66e-03  3.28e-02 -1.41e-02]
 [ 1.68e-03  4.41e-04  4.76e-03  1.19e-03 -1.13e-02]
 [ 2.55e-02 -1.61e-02  4.70e-03 -8.75e-03 -3.78e-03]]
[[ 5.52e-03 -1.44e-03  2.54e-02 -5.13e-04 -4.33e-03]
 [-3.10e-02 -1.19e-03 -6.98e-02 -3.70e-02  3.88e-02]
 [ 1.25e-01 -5.33e-01 -2.27e-01  1.03e+00 -2.41e-01]
 [-3.57e-02  1.62e-02 -1.15e-01  1.28e-02  1.76e-02]
 [-3.06e-03  3.56e-02 -2.73e-02  3.11e-02 -1.00e-02]]
[[ 0.    0.    0.    0.    0.01]
 [ 1.    0.    0.   -0.01 -0.05]
 [ 0.   -0.02 -0.03 -0.   -0.01]
 [-0.09  0.    0.03  0.   -0.03]
 [-0.08 -0.02 -0.03 -0.   -0.01]]
[[ 0.01 -0.06  0.17 -0.08  0.  ]
 [ 0.02  0.01 -0.54  0.06  0.02]
 [-0.01 -0.05 -0.3  -0.14 -0.01]
 [ 0.02 -0.02  1.03  0.06  0.01]
 [-0.02  0.06 -0.27  0.03 -0.01]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00 -9.75e-03]
 [ 0.00e+00  0.00e+00  0.00e+00  8.09e-04  9.87e-04]
 [ 0.00e+00  0.00e+00  6.70e-03 -1.71e-03  2.02e-04]
 [ 0.00e+00  7.78e-05 -2.50e-03  7.70e-04  3.56e-03]
 [ 2.55e-02 -6.60e-04 -1.33e-03 -1.90e-03 -4.10e-03]]
[[-4.78e-03  2.08e-02 -7.76e-03  2.40e-02 -6.74e-03]
 [ 1.60e-02 -5.89e-02 -1.41e-02 -6.64e-02  2.11e-02]
 [-1.13e-01  1.44e+00 -2.49e+00  1.44e+00 -1.19e-01]
 [ 1.00e-02 -2.93e-02 -6.14e-02 -3.61e-02  1.47e-02]
 [-1.49e-03  4.47e-03  1.89e-02  6.52e-03 -2.83e-03]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  6.94e-04]
 [ 0.00e+00  1.00e+00  0.00e+00 -3.57e-03 -2.68e-01]
 [ 0.00e+00  0.00e+00  9.34e-04 -3.46e-03 -4.03e-04]
 [ 0.00e+00 -1.82e-03  4.64e-03  5.23e-03 -4.69e-04]
 [ 2.02e-03 -7.82e-03 -7.56e-04  6.69e-03 -3.21e-03]]
[[-0.02  0.05 -0.14  0.14 -0.03]
 [ 0.15 -0.35  1.11 -1.15  0.23]
 [-0.05  0.14 -0.08 -0.02  0.01]
 [-0.09  0.16 -1.    1.17 -0.24]
 [ 0.01 -0.    0.11 -0.15  0.03]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  4.15e-02]
 [ 0.00e+00  0.00e+00  0.00e+00 -1.32e-04  1.37e-02]
 [ 1.00e+00  0.00e+00  6.03e-03  7.31e-04 -3.38e-03]
 [ 0.00e+00 -7.38e-04 -2.19e-04  1.69e-04 -1.42e-04]
 [ 3.84e-04  4.24e-03  1.66e-03 -5.18e-03 -5.51e-03]]
[[-1.07e-03  9.35e-03 -1.10e-01  2.62e-02 -7.18e-03]
 [-4.28e-03  2.24e-03  1.38e+00 -6.53e-02  2.06e-02]
 [ 3.59e-02 -1.24e-01 -2.38e+00 -2.47e-02 -1.24e-03]
 [ 1.46e-02 -7.28e-02  1.49e+00 -1.37e-01  3.87e-02]
 [-3.63e-03  1.94e-02 -1.24e-01  3.49e-02 -9.42e-03]]
SymNet parameters
[[-1.16e+00 -3.49e-01 -3.79e-01 -1.29e+00 -2.54e-01 -9.74e-03 -2.76e+00  3.49e-01
   9.08e-01 -4.00e-02 -5.57e-02 -1.20e-01]
 [-2.37e-01 -3.59e-03  1.62e-04 -3.39e-04 -8.86e-05  3.58e-04 -7.97e-03  5.24e-04
  -4.01e-03  8.33e-05  1.23e-05  8.65e-05]]
SymNet parameters
[-1.06  0.55]
SymNet parameters
[[ 1.65e-02 -5.17e-02  1.48e+00 -5.86e-03  7.79e-03  2.36e-03 -1.06e-02  3.18e-03
   3.70e-03 -8.09e-04 -4.33e-04 -2.02e-04 -5.79e-03]
 [ 2.71e-03  3.70e-03  2.13e-03  9.02e-03  1.37e-03  4.51e-05 -5.58e-01 -4.68e-03
  -8.55e-03  4.72e-04  3.95e-04  1.37e-03  9.35e-03]]
SymNet parameters
[-0.14  0.26]
SymNet parameters
[[ 4.95e-03  6.51e-04  2.75e-03  4.23e-03  2.52e-03 -6.21e-04  1.75e-01 -1.54e-02
  -2.77e-03  2.86e-05  3.58e-05  2.02e-04 -3.27e-03 -2.44e-04]
 [ 2.09e-01 -1.76e-01  3.85e+00  4.06e-03 -3.48e-01  1.64e-02  1.49e-01  2.90e-02
  -5.58e-02 -3.42e-02 -3.57e-03 -1.80e-02  7.42e-02  2.99e-02]]
SymNet parameters
[-0.47 -0.54]
SymNet parameters
[[ 4.89e+00  2.96e-01  6.01e-01  1.19e-02 -4.56e-02 -3.09e-02  2.29e-01 -2.29e-02
   5.70e-02  4.18e-03 -8.28e-03 -1.48e-02  5.04e-02  1.42e-02  3.11e-01]
 [-3.85e+00 -4.19e+00 -1.98e+00 -1.24e+00 -2.82e-02  1.31e-02 -2.98e+00  2.61e-01
   2.01e+00 -3.12e-02 -3.14e-02 -1.19e-01 -8.06e-02 -1.15e+00 -1.18e+00]]
SymNet parameters
[-0.17 -0.05]
SymNet parameters
[[-6.40e-01  2.74e+00  2.97e-01  5.21e-01  8.79e-02  2.86e-02  9.62e-01 -1.63e-01
   1.02e-01  5.85e-03  3.13e-02  4.71e-02 -3.48e-02  8.51e-02  1.00e-01 -1.14e-03]
 [ 7.29e-01 -2.49e-02 -5.37e-02  1.94e-02  8.85e-03  2.48e-03  5.86e-02 -5.28e-03
  -4.34e-03  2.22e-04  1.68e-03  3.39e-03  2.04e-02  8.61e-03 -3.34e-02  7.33e-04]]
SymNet parameters
[-0.34 -0.2 ]
SymNet parameters
[[ 0.29 -0.03 -0.43  0.55  0.11  0.05  0.97 -0.14 -0.39  0.02  0.02  0.05  0.76  1.07
  -0.1   0.02 -0.31]]
SymNet parameters
[0.53]
SymNet parameters
[[ 1.75e+00  1.50e-02  3.54e-02 -7.07e-04 -6.04e-03 -1.96e-03 -3.14e-01  4.45e-02
  -6.36e-02 -1.09e-02 -1.39e-02 -2.10e-02]
 [-3.41e-01 -3.01e-02 -1.37e-02 -1.41e-03 -9.21e-03  2.23e-03 -2.16e+00 -3.50e-01
  -1.09e-01 -1.12e-02 -1.79e-02 -3.12e-02]]
SymNet parameters
[-0.36  0.3 ]
SymNet parameters
[[ 3.91e+00  3.14e-01  1.43e-01  5.13e-02  4.08e-02 -5.15e-02  5.34e-01 -3.25e+00
   1.62e+00  1.49e-02  1.50e-02  1.88e-01  9.33e-02]
 [ 6.90e-01  9.46e-04  2.33e-02 -1.92e-03  6.85e-03 -9.48e-04 -3.82e+00 -1.18e-01
   3.93e-02  1.46e-02  2.05e-02  3.28e-02 -1.12e-02]]
SymNet parameters
[-0.35  0.22]
SymNet parameters
[[ 1.57e-01  1.42e-02 -1.35e-03  1.90e-05  1.37e-03 -5.42e-04 -4.16e-02 -9.63e-03
   1.88e-02  7.99e-04  3.79e-04  6.48e-03 -5.70e-04  2.85e-04]
 [-1.60e+00 -3.86e-02 -1.27e-01 -1.91e-02 -7.41e-03  1.45e-02  8.05e-01  1.62e+00
  -4.84e-01  1.24e-02 -8.41e-02 -1.17e-02 -4.15e-02  5.74e-04]]
SymNet parameters
[ 0.52 -1.97]
SymNet parameters
[[ 2.71e+00 -1.88e+00 -1.01e+00  1.59e-02 -3.09e-01  3.80e-02  6.64e+00 -1.76e-01
  -6.13e+00 -2.87e-01 -5.01e-01 -1.27e+00  7.33e-03 -5.95e-02 -1.89e+00]
 [ 2.11e+00  1.40e-01 -8.65e-03  7.56e-02  5.41e-02 -6.97e-02 -1.05e+00 -4.96e+00
   4.50e-01  6.57e-02  2.11e-01  3.64e-01  1.01e-01 -1.35e-03 -1.91e-01]]
SymNet parameters
[ 0.06 -0.29]
SymNet parameters
[[ 5.41e+00  9.95e-02  1.03e-01  5.94e-03 -1.13e-02 -1.45e-02 -4.03e-01 -4.26e-01
  -9.23e-01 -2.90e-02 -6.81e-02 -3.00e-02 -1.76e-02 -2.40e-04 -5.78e-01  1.17e-03]
 [-4.61e-02 -3.90e-03 -2.31e-03  1.90e-04 -1.22e-03  2.12e-06 -4.86e-01 -1.29e-02
  -1.39e-02 -1.28e-03 -2.35e-03 -3.22e-03  3.19e-04 -1.26e-03 -1.87e-02 -5.11e-04]]
SymNet parameters
[-0.47 -0.09]
SymNet parameters
[[-2.38 -0.07 -0.08 -0.01 -0.01  0.01 -0.6   0.61 -0.15  0.06 -0.03  0.03  1.2   0.07
  -0.68  0.   -1.89]]
SymNet parameters
[-0.57]
finally, finish this stage
iter:     0    time: 42.97
Func: 5.57e-01  |g|: 4.21e+02
stableloss: 5.88e-02   dataloss: 5.14e-01   sparseloss: 1.37e+02 momentloss: 7.21e+00
current expression:
[u00*u01, u10*v00, u20, u02, u00, u00*u01**2, u00*u11*v00, u01*u10*v00, u00*u10*v01, u10*v00*v10, u01, u00**3, v10, u00*v00, 1, u01*u10, u00**2*v10, u00**2*v00, u00**2, u10*v10]
[-0.98 -0.98  0.05  0.05  0.02  0.01  0.01  0.01  0.01  0.01 -0.01 -0.01 -0.01 -0.
  0.   -0.    0.   -0.   -0.   -0.  ]
[v00*v10, u00*v01, v02, v20, v00, v00*v10**2, u10*v00*v01, u00*v01*v10, u00*v00*v11, u01, u00*u01*v01, v00**3, u01*v00, u00*v10, v00*v01, u10*v01, u01*v00**2, u00*u10, u01*v00*v10, u00**2*u01]
[-0.98 -0.98  0.05  0.05  0.02  0.01  0.01  0.01  0.01  0.01  0.01 -0.01 -0.    0.
  0.   -0.   -0.   -0.    0.   -0.  ]
block:  9
name:  burgers-2-upwind-sparse0-noise0.001-id18
device:  cuda:2
generate a random number to check random seed:  0.9792112166124263
current stage is: block-9
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.8399, device='cuda:2', dtype=torch.float64)
u_obs variance
tensor([ 0.2444,  1.7405,  1.5630, 22.6378, 10.7237, 18.2181,  0.2659,  1.6947,
         1.8444, 19.6960, 10.8979, 23.6378], device='cuda:2',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 1.726269
         Iterations: 0
         Function evaluations: 15
         Gradient evaluations: 3
convolution moment and kernels
[[ 1.00e+00  0.00e+00 -9.24e-05 -1.97e-02 -5.81e-02]
 [ 0.00e+00 -4.94e-04  2.06e-03  3.36e-04 -3.34e-03]
 [ 2.63e-04 -1.24e-03  6.16e-03  2.57e-02  2.09e-03]
 [ 3.83e-02  7.89e-04 -2.32e-03  1.58e-03 -1.92e-02]
 [-8.19e-02 -2.19e-02 -7.58e-03 -9.90e-03  5.03e-03]]
[[ 1.93e-02 -6.38e-02  9.56e-04 -6.78e-02  1.02e-02]
 [-6.76e-02  2.01e-01  7.32e-02  1.67e-01 -6.86e-03]
 [ 3.30e-02 -6.71e-03  4.61e-01  1.09e-01 -8.91e-02]
 [-3.31e-02  7.38e-02  1.82e-01  4.17e-02  2.53e-02]
 [ 1.78e-04  8.26e-03 -6.60e-02  2.36e-03 -7.55e-03]]
[[ 0.00e+00  1.00e+00  0.00e+00 -9.24e-02 -6.90e-02]
 [ 0.00e+00  0.00e+00 -6.51e-03 -1.08e-02 -2.77e-02]
 [ 0.00e+00  2.91e-02  4.66e-03  3.28e-02 -1.41e-02]
 [ 1.68e-03  4.41e-04  4.76e-03  1.19e-03 -1.13e-02]
 [ 2.55e-02 -1.61e-02  4.70e-03 -8.75e-03 -3.78e-03]]
[[ 5.52e-03 -1.44e-03  2.54e-02 -5.10e-04 -4.33e-03]
 [-3.10e-02 -1.20e-03 -6.98e-02 -3.70e-02  3.88e-02]
 [ 1.25e-01 -5.32e-01 -2.27e-01  1.03e+00 -2.41e-01]
 [-3.57e-02  1.62e-02 -1.15e-01  1.28e-02  1.76e-02]
 [-3.06e-03  3.56e-02 -2.73e-02  3.11e-02 -1.00e-02]]
[[ 0.    0.    0.    0.    0.01]
 [ 1.    0.    0.   -0.01 -0.05]
 [ 0.   -0.02 -0.03 -0.   -0.01]
 [-0.09  0.    0.03  0.   -0.03]
 [-0.08 -0.02 -0.03 -0.   -0.01]]
[[ 0.01 -0.06  0.17 -0.08  0.  ]
 [ 0.02  0.01 -0.54  0.06  0.02]
 [-0.01 -0.05 -0.3  -0.14 -0.01]
 [ 0.02 -0.02  1.03  0.06  0.01]
 [-0.02  0.06 -0.27  0.03 -0.01]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00 -9.75e-03]
 [ 0.00e+00  0.00e+00  0.00e+00  8.09e-04  9.86e-04]
 [ 0.00e+00  0.00e+00  6.70e-03 -1.71e-03  2.02e-04]
 [ 0.00e+00  7.78e-05 -2.50e-03  7.70e-04  3.56e-03]
 [ 2.55e-02 -6.60e-04 -1.33e-03 -1.90e-03 -4.10e-03]]
[[-4.78e-03  2.08e-02 -7.76e-03  2.40e-02 -6.74e-03]
 [ 1.60e-02 -5.89e-02 -1.41e-02 -6.64e-02  2.11e-02]
 [-1.13e-01  1.44e+00 -2.49e+00  1.44e+00 -1.19e-01]
 [ 1.00e-02 -2.93e-02 -6.14e-02 -3.61e-02  1.47e-02]
 [-1.49e-03  4.47e-03  1.89e-02  6.52e-03 -2.83e-03]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  6.94e-04]
 [ 0.00e+00  1.00e+00  0.00e+00 -3.57e-03 -2.68e-01]
 [ 0.00e+00  0.00e+00  9.34e-04 -3.46e-03 -4.03e-04]
 [ 0.00e+00 -1.82e-03  4.64e-03  5.23e-03 -4.69e-04]
 [ 2.02e-03 -7.82e-03 -7.56e-04  6.69e-03 -3.21e-03]]
[[-0.02  0.05 -0.14  0.14 -0.03]
 [ 0.15 -0.35  1.11 -1.15  0.23]
 [-0.05  0.14 -0.08 -0.02  0.01]
 [-0.09  0.16 -1.    1.17 -0.24]
 [ 0.01 -0.    0.11 -0.15  0.03]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  4.15e-02]
 [ 0.00e+00  0.00e+00  0.00e+00 -1.32e-04  1.37e-02]
 [ 1.00e+00  0.00e+00  6.03e-03  7.31e-04 -3.38e-03]
 [ 0.00e+00 -7.38e-04 -2.19e-04  1.69e-04 -1.42e-04]
 [ 3.84e-04  4.24e-03  1.66e-03 -5.18e-03 -5.51e-03]]
[[-1.07e-03  9.35e-03 -1.10e-01  2.62e-02 -7.18e-03]
 [-4.28e-03  2.23e-03  1.38e+00 -6.53e-02  2.06e-02]
 [ 3.59e-02 -1.24e-01 -2.38e+00 -2.47e-02 -1.24e-03]
 [ 1.46e-02 -7.28e-02  1.49e+00 -1.37e-01  3.87e-02]
 [-3.63e-03  1.94e-02 -1.24e-01  3.49e-02 -9.42e-03]]
SymNet parameters
[[-1.16e+00 -3.49e-01 -3.79e-01 -1.29e+00 -2.54e-01 -9.74e-03 -2.76e+00  3.49e-01
   9.08e-01 -4.00e-02 -5.57e-02 -1.20e-01]
 [-2.37e-01 -3.59e-03  1.63e-04 -3.46e-04 -9.22e-05  3.64e-04 -7.97e-03  5.24e-04
  -4.00e-03  8.86e-05  1.43e-05  8.42e-05]]
SymNet parameters
[-1.06  0.55]
SymNet parameters
[[ 1.65e-02 -5.17e-02  1.48e+00 -5.86e-03  7.79e-03  2.36e-03 -1.06e-02  3.18e-03
   3.70e-03 -8.07e-04 -4.33e-04 -2.02e-04 -5.79e-03]
 [ 2.71e-03  3.70e-03  2.13e-03  9.02e-03  1.37e-03  4.32e-05 -5.58e-01 -4.68e-03
  -8.55e-03  4.72e-04  3.96e-04  1.37e-03  9.36e-03]]
SymNet parameters
[-0.14  0.26]
SymNet parameters
[[ 4.95e-03  6.50e-04  2.75e-03  4.23e-03  2.53e-03 -6.21e-04  1.75e-01 -1.54e-02
  -2.77e-03  2.82e-05  3.63e-05  2.03e-04 -3.27e-03 -2.44e-04]
 [ 2.09e-01 -1.76e-01  3.85e+00  4.06e-03 -3.48e-01  1.64e-02  1.49e-01  2.90e-02
  -5.58e-02 -3.42e-02 -3.57e-03 -1.80e-02  7.42e-02  2.99e-02]]
SymNet parameters
[-0.47 -0.54]
SymNet parameters
[[ 4.89e+00  2.96e-01  6.01e-01  1.19e-02 -4.56e-02 -3.09e-02  2.29e-01 -2.29e-02
   5.70e-02  4.18e-03 -8.28e-03 -1.48e-02  5.04e-02  1.42e-02  3.11e-01]
 [-3.85e+00 -4.19e+00 -1.98e+00 -1.24e+00 -2.82e-02  1.31e-02 -2.98e+00  2.61e-01
   2.01e+00 -3.12e-02 -3.14e-02 -1.19e-01 -8.06e-02 -1.15e+00 -1.18e+00]]
SymNet parameters
[-0.17 -0.05]
SymNet parameters
[[-6.40e-01  2.74e+00  2.97e-01  5.21e-01  8.79e-02  2.86e-02  9.62e-01 -1.63e-01
   1.02e-01  5.85e-03  3.13e-02  4.71e-02 -3.48e-02  8.51e-02  1.00e-01 -1.14e-03]
 [ 7.29e-01 -2.49e-02 -5.37e-02  1.94e-02  8.85e-03  2.48e-03  5.86e-02 -5.28e-03
  -4.34e-03  2.24e-04  1.68e-03  3.39e-03  2.04e-02  8.61e-03 -3.34e-02  8.37e-04]]
SymNet parameters
[-0.34 -0.2 ]
SymNet parameters
[[ 0.29 -0.03 -0.43  0.55  0.11  0.05  0.97 -0.14 -0.39  0.02  0.02  0.05  0.76  1.07
  -0.1   0.02 -0.31]]
SymNet parameters
[0.53]
SymNet parameters
[[ 1.75e+00  1.50e-02  3.54e-02 -7.05e-04 -6.04e-03 -1.96e-03 -3.14e-01  4.45e-02
  -6.36e-02 -1.09e-02 -1.39e-02 -2.10e-02]
 [-3.41e-01 -3.01e-02 -1.37e-02 -1.41e-03 -9.21e-03  2.24e-03 -2.16e+00 -3.50e-01
  -1.09e-01 -1.12e-02 -1.79e-02 -3.12e-02]]
SymNet parameters
[-0.36  0.3 ]
SymNet parameters
[[ 3.91e+00  3.14e-01  1.43e-01  5.13e-02  4.08e-02 -5.15e-02  5.34e-01 -3.25e+00
   1.62e+00  1.49e-02  1.50e-02  1.88e-01  9.33e-02]
 [ 6.90e-01  9.46e-04  2.33e-02 -1.92e-03  6.85e-03 -9.47e-04 -3.82e+00 -1.18e-01
   3.93e-02  1.46e-02  2.05e-02  3.28e-02 -1.12e-02]]
SymNet parameters
[-0.35  0.22]
SymNet parameters
[[ 1.57e-01  1.42e-02 -1.35e-03  1.87e-05  1.37e-03 -5.38e-04 -4.16e-02 -9.64e-03
   1.88e-02  8.02e-04  3.78e-04  6.48e-03 -5.72e-04  2.40e-04]
 [-1.60e+00 -3.86e-02 -1.27e-01 -1.91e-02 -7.41e-03  1.45e-02  8.05e-01  1.62e+00
  -4.84e-01  1.24e-02 -8.41e-02 -1.17e-02 -4.15e-02  5.74e-04]]
SymNet parameters
[ 0.52 -1.97]
SymNet parameters
[[ 2.71e+00 -1.88e+00 -1.01e+00  1.59e-02 -3.09e-01  3.80e-02  6.64e+00 -1.76e-01
  -6.13e+00 -2.87e-01 -5.01e-01 -1.27e+00  7.33e-03 -5.95e-02 -1.89e+00]
 [ 2.11e+00  1.40e-01 -8.65e-03  7.56e-02  5.41e-02 -6.97e-02 -1.05e+00 -4.96e+00
   4.50e-01  6.57e-02  2.11e-01  3.64e-01  1.01e-01 -1.35e-03 -1.91e-01]]
SymNet parameters
[ 0.06 -0.29]
SymNet parameters
[[ 5.41e+00  9.95e-02  1.03e-01  5.93e-03 -1.13e-02 -1.45e-02 -4.03e-01 -4.26e-01
  -9.23e-01 -2.90e-02 -6.81e-02 -3.00e-02 -1.76e-02 -2.33e-04 -5.78e-01  1.13e-03]
 [-4.61e-02 -3.90e-03 -2.31e-03  1.73e-04 -1.22e-03 -4.18e-05 -4.86e-01 -1.29e-02
  -1.39e-02 -1.29e-03 -2.34e-03 -3.24e-03  3.51e-04 -1.15e-03 -1.87e-02  4.47e-04]]
SymNet parameters
[-0.47 -0.09]
SymNet parameters
[[-2.38 -0.07 -0.08 -0.01 -0.01  0.01 -0.6   0.61 -0.15  0.06 -0.03  0.03  1.2   0.07
  -0.68  0.   -1.89]]
SymNet parameters
[-0.57]
finally, finish this stage
iter:     0    time: 43.91
Func: 1.73e+00  |g|: 2.54e+03
stableloss: 6.92e-02   dataloss: 1.66e+00   sparseloss: 1.37e+02 momentloss: 7.21e+00
current expression:
[u00*u01, u10*v00, u20, u02, u00, u00*u01**2, u00*u11*v00, u01*u10*v00, u00*u10*v01, u10*v00*v10, u01, u00**3, v10, u00*v00, 1, u01*u10, u00**2*v10, u00**2*v00, u00**2, u10*v10]
[-0.98 -0.98  0.05  0.05  0.02  0.01  0.01  0.01  0.01  0.01 -0.01 -0.01 -0.01 -0.
  0.   -0.    0.   -0.   -0.   -0.  ]
[v00*v10, u00*v01, v02, v20, v00, v00*v10**2, u10*v00*v01, u00*v01*v10, u00*v00*v11, u01, u00*u01*v01, v00**3, u01*v00, u00*v10, v00*v01, u10*v01, u01*v00**2, u00*u10, u01*v00*v10, u00**2*u01]
[-0.98 -0.98  0.05  0.05  0.02  0.01  0.01  0.01  0.01  0.01  0.01 -0.01 -0.    0.
  0.   -0.   -0.   -0.    0.   -0.  ]
u_obs.abs().max()
tensor(3.9181, device='cuda:2', dtype=torch.float64)
model(u_obs[0],T=50*dt).abs().max()
tensor(nan, device='cuda:2', dtype=torch.float64)
model(u_obs[0],T=100*dt).abs().max()
tensor(nan, device='cuda:2', dtype=torch.float64)
{'--name': 'burgers-2-upwind-sparse0-noise0.001-id16', '--dtype': 'double', '--device': 'cuda:0', '--constraint': '2', '--dt': 0.01, '--cell_num': 1, '--eps': 6.283185307179586, '--blocks': [0, 1, 2, 3, 4, 5, 6, 9], '--kernel_size': 5, '--max_order': 2, '--dx': 0.19634954084936207, '--hidden_layers': 5, '--scheme': 'upwind', '--dataname': 'burgers', '--viscosity': 0.05, '--zoom': 4, '--max_dt': 0.000625, '--batch_size': 28, '--data_timescheme': 'rk2', '--channel_names': 'u,v', '--freq': 4, '--data_start_time': 1.0, '--start_noise': 0.001, '--end_noise': 0.001, '--stablize': 0.0, '--sparsity': 0.0, '--momentsparsity': 0.001, '--npseed': -1, '--torchseed': -1, '--maxiter': 2000, '--recordfile': 'None', '--recordcycle': 200, '--savecycle': -1, '--start_from': -1}
block:  0
name:  burgers-2-upwind-sparse0-noise0.001-id16
device:  cuda:0
generate a random number to check random seed:  -0.6739014067139714
current stage is: warmup
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.9249, device='cuda:0', dtype=torch.float64)
u_obs variance
tensor([ 0.2646,  2.2658,  1.9688, 21.1866, 10.4954, 16.8320,  0.2462,  1.9747,
         2.0291, 17.0896,  9.5571, 18.9428], device='cuda:0',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
iter:     0    time: 6.36
Func: 5.58e+00  |g|: 2.93e+00
stableloss: 9.34e-04   dataloss: 5.58e+00   sparseloss: 2.65e+01 momentloss: 7.27e+00
iter:   200    time: 12.08
Func: 4.34e-02  |g|: 3.54e-02
stableloss: 1.29e-02   dataloss: 4.34e-02   sparseloss: 5.77e+01 momentloss: 7.27e+00
iter:   400    time: 9.51
Func: 4.01e-02  |g|: 3.29e-02
stableloss: 1.35e-02   dataloss: 4.01e-02   sparseloss: 8.17e+01 momentloss: 7.27e+00
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 0.039328
         Iterations: 599
         Function evaluations: 670
         Gradient evaluations: 663
convolution moment and kernels
[[1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
[[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 1. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
[[ 0.    1.    0.   -0.33 -0.25]
 [ 0.    0.    0.    0.    0.  ]
 [ 0.    0.    0.    0.    0.  ]
 [ 0.    0.    0.    0.    0.  ]
 [ 0.    0.    0.    0.    0.  ]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]
 [ 2.78e-17  3.33e-16 -1.50e+00  2.00e+00 -5.00e-01]
 [ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]]
[[ 0.    0.    0.    0.    0.  ]
 [ 1.    0.    0.    0.    0.  ]
 [ 0.    0.    0.    0.    0.  ]
 [-0.33  0.    0.    0.    0.  ]
 [-0.25  0.    0.    0.    0.  ]]
[[ 0.00e+00  0.00e+00  2.78e-17  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  3.33e-16  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00 -1.50e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  2.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00 -5.00e-01  0.00e+00  0.00e+00]]
[[0.   0.   1.   0.   0.08]
 [0.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.  ]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]
 [-2.22e-16  1.00e+00 -2.00e+00  1.00e+00 -1.53e-16]
 [ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]]
[[0. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
[[ 6.94e-03 -5.56e-02  9.25e-18  5.56e-02 -6.94e-03]
 [-5.56e-02  4.44e-01 -7.40e-17 -4.44e-01  5.56e-02]
 [ 9.25e-18 -7.40e-17  1.23e-32  7.40e-17 -9.25e-18]
 [ 5.56e-02 -4.44e-01  7.40e-17  4.44e-01 -5.56e-02]
 [-6.94e-03  5.56e-02 -9.25e-18 -5.56e-02  6.94e-03]]
[[0.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.  ]
 [1.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.  ]
 [0.08 0.   0.   0.   0.  ]]
[[ 0.00e+00  0.00e+00 -2.22e-16  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  1.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00 -2.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  1.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00 -1.53e-16  0.00e+00  0.00e+00]]
SymNet parameters
[[-0.64 -0.6   0.34  0.06  0.07  0.02 -0.94  0.01 -0.02  0.    0.01  0.02]
 [ 1.29  0.1   0.26  0.06  0.05  0.01 -0.38  0.   -0.01 -0.    0.01  0.01]]
SymNet parameters
[ 0.42 -0.3 ]
SymNet parameters
[[-0.77  0.21  0.4   0.04 -0.03 -0.03  0.57 -0.03  0.06 -0.03  0.01 -0.01 -0.08]
 [ 0.11  0.1  -0.11  0.19  0.03 -0.05 -1.58 -0.05  0.12 -0.07  0.05 -0.01 -0.17]]
SymNet parameters
[0.03 0.31]
SymNet parameters
[[-2.23  0.02  0.52 -0.32  0.18 -0.16  0.48  0.22  0.33  0.07 -0.08 -0.06 -0.16 -0.04]
 [-1.4  -0.64 -0.4  -0.24 -0.06 -0.03 -1.58 -0.15 -0.07 -0.03  0.   -0.03 -0.33 -0.09]]
SymNet parameters
[-0.01  0.12]
SymNet parameters
[[ 0.23 -0.07 -0.13  0.04  0.16  0.09  1.4   0.04 -0.14  0.06  0.01  0.04  0.12 -0.05
   0.  ]
 [-0.07 -0.03 -0.09 -0.27 -0.09  0.05 -1.24  0.04 -0.12  0.07 -0.06  0.    0.22 -0.01
  -0.  ]]
SymNet parameters
[-0.2   0.19]
SymNet parameters
[[-2.68  0.74 -0.3  -0.39 -0.21  0.01 -1.46  0.06 -0.09  0.07 -0.09 -0.02  0.19  0.02
   0.    0.02]
 [-1.16  0.23  0.63  0.12  0.16  0.06  0.97  0.03 -0.08  0.02  0.03  0.03  0.02 -0.05
   0.01  0.01]]
SymNet parameters
[-0.14  0.67]
SymNet parameters
[[ 0.03 -0.28 -0.01  0.11  0.05  0.04  0.21  0.   -0.01 -0.01  0.01  0.01  0.68  0.56
   0.   -0.31  0.19]]
SymNet parameters
[0.08]
SymNet parameters
[[-9.21e-01 -6.09e-03 -3.11e-03  1.93e-03  6.34e-04  4.18e-03 -9.37e-01 -2.11e-01
   2.01e-01  3.19e-03  2.85e-03 -7.44e-03]
 [-8.78e-01  9.28e-03 -3.95e-03  1.67e-03 -8.62e-04 -6.14e-03  1.30e+00 -3.95e-01
  -2.51e-01 -9.00e-03 -1.80e-04  1.27e-02]]
SymNet parameters
[-0.02  0.15]
SymNet parameters
[[ 9.20e-01 -8.41e-03  3.06e-04 -2.04e-04  7.21e-04  5.01e-03 -1.36e+00 -3.13e-01
  -2.10e-01 -6.15e-04  6.10e-03  4.74e-03  5.11e-03]
 [-1.89e+00 -1.75e-03  3.26e-04  6.87e-03  1.82e-03 -6.02e-04 -1.95e+00  5.73e-01
  -5.46e-01 -1.45e-02  2.30e-03  2.80e-02  1.40e-02]]
SymNet parameters
[0.13 0.68]
SymNet parameters
[[ 1.07  0.16 -0.12  0.01  0.02 -0.01  1.52 -0.38  0.35  0.06  0.15  0.26  0.01  0.07]
 [ 0.76 -0.15 -0.01  0.04 -0.   -0.01 -1.59 -0.26 -0.78  0.    0.15 -0.24  0.08 -0.01]]
SymNet parameters
[0.18 0.01]
SymNet parameters
[[ 2.32e-01  4.06e-04 -5.43e-02  1.21e-03  4.12e-03  1.96e-02 -1.33e+00 -7.81e-02
   2.12e-01 -1.21e-02  4.41e-03 -4.85e-03  2.76e-02 -7.01e-02 -1.07e-02]
 [-1.98e-01 -4.47e-01 -8.50e-02 -3.00e-02 -2.63e-02  2.76e-01  6.07e-01  3.91e-01
  -5.92e-01  4.21e-01  5.48e-02 -9.86e-01 -3.85e-01 -4.87e-02  6.06e-01]]
SymNet parameters
[0.11 0.01]
SymNet parameters
[[ 0.14  0.43 -0.04 -0.1   0.01  0.01  2.78  0.05  1.06  0.1   0.03  0.3  -0.14  0.11
   0.06 -0.02]
 [ 0.31  0.41  0.18 -0.26 -0.16 -0.26 -0.4   0.23 -0.24  0.35 -0.31 -0.6   0.48  1.24
   0.26  0.64]]
SymNet parameters
[-0.15 -0.21]
SymNet parameters
[[ 4.72e-02  4.48e-03 -4.19e-03 -7.26e-04 -8.08e-04  3.67e-03 -5.34e-01 -7.54e-02
  -4.87e-02  4.25e-02  4.07e-03  3.88e-02 -8.30e-01 -3.83e-01  4.57e-04 -2.67e-02
   3.59e-03]]
SymNet parameters
[0.03]
finally, finish this stage
iter:   599    time: 11.36
Func: 3.93e-02  |g|: 2.36e-03
stableloss: 1.36e-02   dataloss: 3.93e-02   sparseloss: 8.34e+01 momentloss: 7.27e+00
current expression:
[u10*v00, u00*u01, u00, u02, u20, u00**3, u00**2*u02, u10, u00*u01**2, u00*u11*v00, u00*u10*v00, u10*v00**2, u00*v00, u01*v00, u00*v00**3, u01*u10*v00, 1, u00*u10, u00**2*u10*v00, v01]
[-0.89 -0.89  0.06  0.05  0.04 -0.03 -0.01  0.01  0.01  0.01 -0.01 -0.01 -0.01 -0.
  0.    0.   -0.    0.    0.    0.  ]
[v00*v10, u00*v01, v00, v02, v20, v00**3, v00**2*v20, v00**2*v10, u00*v00, v00*v10**2, u01, u00*v01*v10, u01*v00, u00**2*v00**2, u00*v00*v11, u01*v00**2, u00**2, u00*v00*v10, v00**4, u00**2*v00]
[-0.89 -0.89  0.05  0.04  0.04 -0.03 -0.01 -0.01  0.01  0.01  0.01  0.01 -0.01  0.01
  0.01 -0.01 -0.01 -0.01 -0.01  0.01]
block:  1
name:  burgers-2-upwind-sparse0-noise0.001-id16
device:  cuda:0
generate a random number to check random seed:  -0.8081911595548295
current stage is: block-1
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.8959, device='cuda:0', dtype=torch.float64)
u_obs variance
tensor([ 0.2474,  2.0937,  1.9575, 19.2787, 10.4517, 17.0321,  0.2511,  1.9306,
         2.1614, 16.7349,  9.9812, 20.0942], device='cuda:0',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
iter:     0    time: 3693.58
Func: 5.37e-02  |g|: 2.66e+00
stableloss: 1.60e-02   dataloss: 4.64e-02   sparseloss: 8.34e+01 momentloss: 7.27e+00
iter:   200    time: 10.02
Func: 2.04e-02  |g|: 3.98e-02
stableloss: 1.00e-02   dataloss: 1.39e-02   sparseloss: 8.24e+01 momentloss: 6.52e+00
iter:   400    time: 10.08
Func: 1.94e-02  |g|: 8.26e-03
stableloss: 9.70e-03   dataloss: 1.29e-02   sparseloss: 8.54e+01 momentloss: 6.47e+00
iter:   600    time: 9.92
Func: 1.90e-02  |g|: 9.49e-03
stableloss: 9.63e-03   dataloss: 1.26e-02   sparseloss: 9.65e+01 momentloss: 6.42e+00
iter:   800    time: 9.74
Func: 1.89e-02  |g|: 1.25e-02
stableloss: 9.51e-03   dataloss: 1.25e-02   sparseloss: 1.09e+02 momentloss: 6.42e+00
iter:  1000    time: 9.71
Func: 1.88e-02  |g|: 3.42e-02
stableloss: 9.56e-03   dataloss: 1.23e-02   sparseloss: 1.21e+02 momentloss: 6.43e+00
iter:  1200    time: 9.72
Func: 1.87e-02  |g|: 1.96e-02
stableloss: 9.53e-03   dataloss: 1.23e-02   sparseloss: 1.20e+02 momentloss: 6.44e+00
iter:  1400    time: 9.70
Func: 1.87e-02  |g|: 1.75e-02
stableloss: 9.54e-03   dataloss: 1.23e-02   sparseloss: 1.29e+02 momentloss: 6.44e+00
iter:  1600    time: 9.77
Func: 1.87e-02  |g|: 4.65e-02
stableloss: 9.53e-03   dataloss: 1.22e-02   sparseloss: 1.42e+02 momentloss: 6.43e+00
iter:  1800    time: 9.84
Func: 1.87e-02  |g|: 2.83e-02
stableloss: 9.55e-03   dataloss: 1.22e-02   sparseloss: 1.54e+02 momentloss: 6.43e+00
Warning: Maximum number of iterations has been exceeded.
         Current function value: 0.018654
         Iterations: 2000
         Function evaluations: 2005
         Gradient evaluations: 2005
convolution moment and kernels
[[ 1.00e+00  0.00e+00 -1.42e-05 -8.54e-03 -2.56e-02]
 [ 0.00e+00 -7.94e-05  2.11e-03  1.04e-03 -1.95e-02]
 [ 5.12e-05  2.38e-03  2.44e-03  1.32e-03  1.85e-03]
 [-6.55e-03  1.83e-03  5.82e-04 -2.77e-03  5.78e-03]
 [-4.48e-02 -1.39e-03 -1.58e-03 -9.58e-04  1.09e-03]]
[[-0.    0.01 -0.06  0.01 -0.  ]
 [ 0.02 -0.06  0.25 -0.05  0.02]
 [-0.01  0.07  0.63  0.08 -0.03]
 [-0.03  0.1   0.04  0.09 -0.02]
 [ 0.01 -0.03 -0.01 -0.02  0.  ]]
[[ 0.00e+00  1.00e+00  0.00e+00 -9.53e-02 -3.88e-02]
 [ 0.00e+00  0.00e+00 -5.86e-03  6.67e-04 -8.62e-03]
 [ 0.00e+00  1.41e-02  7.29e-03  1.09e-02 -2.01e-03]
 [ 2.30e-04  8.30e-04  5.20e-03 -1.53e-03  4.26e-03]
 [ 3.34e-03 -9.30e-03 -3.03e-03 -5.29e-03 -3.12e-03]]
[[-3.45e-03  1.61e-02 -1.47e-02  1.23e-02 -7.02e-03]
 [ 5.07e-03 -4.20e-02  2.83e-02 -3.38e-02  2.94e-02]
 [ 1.03e-01 -5.99e-01 -2.04e-01  9.22e-01 -2.02e-01]
 [-1.55e-02  1.87e-02 -4.66e-02  1.69e-02  1.30e-02]
 [ 2.62e-03 -6.34e-04  4.19e-03  7.93e-06 -2.73e-03]]
[[ 0.00e+00  0.00e+00  0.00e+00 -1.23e-02 -1.60e-03]
 [ 1.00e+00  0.00e+00  2.15e-02 -8.47e-04 -3.00e-03]
 [ 0.00e+00 -1.74e-03 -1.49e-03  2.33e-03  1.51e-03]
 [-9.96e-02 -2.08e-03  3.83e-03  2.50e-03 -1.45e-02]
 [-6.38e-02 -1.28e-03 -1.46e-02  7.08e-04  5.77e-04]]
[[ 0.01 -0.05  0.15 -0.05  0.01]
 [-0.02  0.12 -0.7   0.11 -0.02]
 [ 0.01 -0.12 -0.18 -0.09 -0.  ]
 [ 0.01  0.03  0.93  0.05  0.  ]
 [-0.01  0.01 -0.2   0.   -0.  ]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00 -6.20e-03]
 [ 0.00e+00  0.00e+00  0.00e+00 -5.87e-04 -9.94e-04]
 [ 0.00e+00  0.00e+00  1.21e-03 -2.36e-03  2.16e-03]
 [ 0.00e+00 -7.05e-04  2.06e-03  9.99e-04 -8.61e-04]
 [ 5.35e-03 -2.09e-03  3.99e-04  4.42e-03 -6.58e-03]]
[[-0.01  0.03 -0.03  0.02 -0.  ]
 [ 0.04 -0.14  0.15 -0.09  0.02]
 [-0.15  1.58 -2.77  1.5  -0.12]
 [ 0.04 -0.15  0.16 -0.09  0.02]
 [-0.01  0.04 -0.04  0.02 -0.  ]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  1.56e-03]
 [ 0.00e+00  1.00e+00  0.00e+00 -1.40e-03 -1.17e-03]
 [ 0.00e+00  0.00e+00  1.49e-03  8.48e-04 -4.45e-03]
 [ 0.00e+00 -1.13e-03 -1.73e-04  2.14e-03  2.14e-03]
 [ 5.85e-04  3.53e-04 -3.49e-03 -5.51e-04  1.21e-02]]
[[ 0.02 -0.11  0.08  0.01  0.  ]
 [-0.11  0.68 -0.35 -0.23  0.01]
 [ 0.09 -0.38  0.58 -0.37  0.08]
 [-0.   -0.19 -0.39  0.69 -0.11]
 [ 0.01 -0.    0.09 -0.12  0.02]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  5.93e-04]
 [ 0.00e+00  0.00e+00  0.00e+00 -3.98e-04  5.61e-04]
 [ 1.00e+00  0.00e+00  1.50e-03 -2.18e-03  7.30e-04]
 [ 0.00e+00 -2.80e-04  1.75e-03  4.96e-04 -1.34e-03]
 [ 3.61e-03 -1.85e-03 -3.62e-04  4.17e-03 -5.52e-03]]
[[-6.93e-03  2.28e-02 -1.05e-01  1.24e-02 -2.57e-03]
 [ 3.09e-02 -1.02e-01  1.43e+00 -5.48e-02  1.09e-02]
 [-5.00e-02  1.67e-01 -2.67e+00  9.16e-02 -1.77e-02]
 [ 3.55e-02 -1.22e-01  1.46e+00 -7.13e-02  1.38e-02]
 [-8.82e-03  3.17e-02 -1.18e-01  1.97e-02 -3.85e-03]]
SymNet parameters
[[ 2.97e-01 -8.14e-01  7.07e-02 -2.18e-01  2.70e-02  3.29e-03 -1.68e+00 -2.37e-02
   6.01e-02 -1.71e-02 -6.17e-04  1.31e-02]
 [ 8.46e-01  1.20e-02  2.74e-02  4.18e-02  2.08e-02 -4.91e-03 -3.72e-02  2.63e-03
  -1.20e-02  4.82e-03  2.78e-04 -2.49e-03]]
SymNet parameters
[-0.07 -0.35]
SymNet parameters
[[-1.32e+00  4.47e-02  6.25e-01  3.42e-03 -3.30e-02  3.21e-03 -5.66e-02 -2.01e-02
   7.64e-02 -2.86e-03 -1.77e-04 -2.10e-03  2.09e-02]
 [ 9.99e-02  2.58e-02  3.04e-02 -2.07e-02  9.60e-03 -1.18e-03 -2.36e+00 -8.87e-03
   2.88e-02 -1.50e-03  4.47e-04  1.07e-03  1.44e-02]]
SymNet parameters
[ 1.11 -1.02]
SymNet parameters
[[-2.74e+00 -2.48e+00  1.20e+00  1.32e-01  8.31e-01 -2.63e-01  2.46e+00 -5.08e-01
   1.73e+00  2.81e-02  1.10e-03 -7.68e-02  5.19e-03 -6.77e-01]
 [-1.84e+00 -3.78e+00 -2.39e+00 -1.87e+00 -9.06e-01  2.41e-01  3.94e+00  5.26e-01
  -1.58e+00 -1.82e-01 -1.66e-02  1.69e-01 -4.49e-01  4.72e-02]]
SymNet parameters
[-0.12  0.14]
SymNet parameters
[[ 1.60e+00 -5.40e-01  4.45e-01  1.31e-01  2.55e-01 -8.26e-02  1.78e+00 -1.21e-01
   4.26e-01  1.82e-02 -5.13e-04 -2.84e-02  2.99e-02 -2.03e-01 -2.45e-04]
 [ 2.65e+00 -3.60e-03 -7.44e-01 -1.21e+00 -4.60e-01  1.77e-01  9.01e-01  3.30e-01
  -1.08e+00 -1.08e-01 -8.22e-03  1.19e-01 -1.45e-01  2.60e-01  2.05e-04]]
SymNet parameters
[-0.52  0.24]
SymNet parameters
[[-1.62e-01  3.51e+00  1.10e+00  3.72e-01  2.98e-01 -3.88e-02 -4.10e+00 -2.33e-01
   6.03e-01  3.94e-02  1.04e-02 -3.15e-02  1.56e-01  1.96e-01 -7.79e-04  5.86e-03]
 [-1.97e+00 -6.69e-01  2.48e-01  7.99e-02  2.65e-01 -8.06e-02  6.79e-01 -1.35e-01
   4.41e-01  1.43e-02  1.25e-03 -2.37e-02 -8.65e-02 -2.11e-01 -2.00e-04  3.15e-03]]
SymNet parameters
[0.22 1.23]
SymNet parameters
[[-0.74 -0.73  0.33 -0.02 -0.03  0.05  1.36 -0.    0.02 -0.01 -0.    0.    1.21  0.6
   0.02 -0.09  0.09]]
SymNet parameters
[0.66]
SymNet parameters
[[-2.96e+00 -1.72e-01  2.95e-02  2.14e-03  3.08e-03 -3.17e-04 -2.68e-01 -2.81e-02
   3.33e-01 -6.02e-04  5.39e-04 -7.54e-03]
 [-4.81e+00  3.27e-01 -8.18e-02 -7.44e-03 -5.07e-03  1.83e-03  3.07e-01 -5.61e-02
  -5.25e-01  2.75e-03  2.96e-03  1.38e-02]]
SymNet parameters
[-0.48  0.1 ]
SymNet parameters
[[ 5.30e+00  2.90e-01 -4.83e-02 -3.00e-03 -5.44e-03  7.06e-04 -1.77e-01 -5.17e-02
  -6.05e-01  9.76e-04 -3.80e-04  1.07e-02  1.29e-03]
 [-6.13e+00  3.91e-01 -9.87e-02 -8.44e-03 -6.23e-03  2.59e-03 -3.77e-01  5.17e-02
  -6.84e-01  3.48e-03  3.00e-03  1.38e-02  1.69e-03]]
SymNet parameters
[0.64 0.12]
SymNet parameters
[[ 3.98e+00 -5.73e-02  2.52e-02 -3.58e-03 -2.63e-03 -2.44e-03  3.78e-01  5.32e-02
  -1.36e-01 -1.69e-03  5.50e-02 -1.26e-01 -7.25e-02 -3.16e-02]
 [ 4.58e+00  2.70e-02  2.56e-02  1.21e-02 -9.27e-04 -3.10e-03 -3.28e-01 -1.87e-02
   1.67e-01 -2.70e-03  5.40e-02  1.44e-01  6.18e-02  2.65e-02]]
SymNet parameters
[ 0.21 -0.45]
SymNet parameters
[[-1.60e-01 -4.50e-02  8.32e-03 -1.88e-03  2.62e-03 -3.91e-03 -1.76e+00 -1.67e-02
   7.66e-02 -1.18e-03  4.82e-04  3.13e-03  9.06e-02  4.69e-02  5.17e-03]
 [ 3.99e-01 -4.06e+00  8.57e-01  7.70e-02  6.29e-02 -3.57e-03 -9.65e-01  2.40e-01
  -3.04e+00 -3.30e-02 -6.04e-03 -1.90e-01 -2.41e-01  3.15e-03  2.11e-01]]
SymNet parameters
[-0.65  0.34]
SymNet parameters
[[-1.09 -5.55  1.06  0.07  0.09  0.04  4.32  0.5  -0.36 -0.61  0.04 -0.3  -0.53 -0.14
   0.17 -0.02]
 [ 0.23  0.79 -0.27 -1.24  0.58 -1.25 -0.36  0.21  0.04  0.74 -0.29  3.52 -0.52  3.15
   2.61 -0.52]]
SymNet parameters
[-0.1  -0.22]
SymNet parameters
[[ 9.78e-01  5.41e-02 -9.22e-03 -9.53e-04 -1.40e-03  7.20e-05 -5.02e-01  4.98e-02
   2.16e-01  4.93e-02 -1.03e-03  4.92e-02 -1.72e+00 -7.67e-01 -2.13e-02 -5.28e-02
   1.14e-04]]
SymNet parameters
[-0.04]
finally, finish this stage
iter:  2000    time: 9.79
Func: 1.87e-02  |g|: 4.23e-02
stableloss: 9.56e-03   dataloss: 1.22e-02   sparseloss: 1.67e+02 momentloss: 6.43e+00
current expression:
[u00*u01, u10*v00, u20, u02, u00, u00*u01**2, u01*u10*v00, u00*u11*v00, u10*v00*v10, u01*v00, u01, u00**2, u00**3, u00*v01, 1, u00**2*u02, u00*v00**2, u00**2*u01*v00, u10*v00*v01, u00*u10]
[-0.98 -0.97  0.05  0.05  0.02  0.01  0.01  0.01  0.01 -0.01 -0.01  0.   -0.   -0.
 -0.    0.   -0.    0.   -0.    0.  ]
[v00*v10, u00*v01, v02, v20, v00*v10**2, u00*v00*v11, u00*u01*v01, u00*v01*v10, v00, u00*v00, u00**2*v02, v01, 1, u00**2, u10*v01, u00*v00*v10, v00**2*v10, u00*u10, v00*v01, u00*u10*v01]
[-0.98 -0.98  0.05  0.05  0.01  0.01  0.01  0.01  0.01 -0.    0.   -0.    0.   -0.
 -0.    0.   -0.    0.    0.   -0.  ]
block:  2
name:  burgers-2-upwind-sparse0-noise0.001-id16
device:  cuda:0
generate a random number to check random seed:  -1.870436537788458
current stage is: block-2
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.7488, device='cuda:0', dtype=torch.float64)
u_obs variance
tensor([ 0.2397,  1.6595,  1.6200, 22.9173, 10.5820, 19.8583,  0.2561,  1.6142,
         1.6593, 19.1991,  9.5034, 21.7815], device='cuda:0',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
iter:     0    time: 754.42
Func: 7.56e-02  |g|: 3.40e+01
stableloss: 1.82e-02   dataloss: 6.27e-02   sparseloss: 1.67e+02 momentloss: 6.43e+00
iter:   200    time: 14.09
Func: 6.49e-02  |g|: 5.19e-01
stableloss: 1.73e-02   dataloss: 5.13e-02   sparseloss: 1.68e+02 momentloss: 6.83e+00
iter:   400    time: 13.67
Func: 6.46e-02  |g|: 4.76e-01
stableloss: 1.73e-02   dataloss: 5.09e-02   sparseloss: 1.74e+02 momentloss: 6.85e+00
iter:   600    time: 13.65
Func: 6.44e-02  |g|: 9.81e-01
stableloss: 1.73e-02   dataloss: 5.07e-02   sparseloss: 1.82e+02 momentloss: 6.86e+00
iter:   800    time: 13.68
Func: 6.43e-02  |g|: 3.92e-01
stableloss: 1.74e-02   dataloss: 5.06e-02   sparseloss: 1.84e+02 momentloss: 6.87e+00
iter:  1000    time: 13.68
Func: 6.42e-02  |g|: 1.08e-01
stableloss: 1.74e-02   dataloss: 5.05e-02   sparseloss: 1.88e+02 momentloss: 6.88e+00
iter:  1200    time: 13.67
Func: 6.41e-02  |g|: 2.64e-01
stableloss: 1.74e-02   dataloss: 5.04e-02   sparseloss: 1.90e+02 momentloss: 6.87e+00
iter:  1400    time: 13.67
Func: 6.41e-02  |g|: 3.00e-01
stableloss: 1.74e-02   dataloss: 5.03e-02   sparseloss: 2.01e+02 momentloss: 6.87e+00
iter:  1600    time: 13.77
Func: 6.40e-02  |g|: 2.02e-01
stableloss: 1.74e-02   dataloss: 5.03e-02   sparseloss: 2.13e+02 momentloss: 6.87e+00
iter:  1800    time: 13.92
Func: 6.40e-02  |g|: 2.10e-01
stableloss: 1.74e-02   dataloss: 5.03e-02   sparseloss: 2.24e+02 momentloss: 6.87e+00
Warning: Maximum number of iterations has been exceeded.
         Current function value: 0.063980
         Iterations: 2000
         Function evaluations: 2021
         Gradient evaluations: 2021
convolution moment and kernels
[[ 1.00e+00  0.00e+00  1.30e-03 -1.93e-02 -4.86e-02]
 [ 0.00e+00 -3.23e-05 -1.19e-03 -2.97e-03  6.38e-03]
 [ 3.35e-04 -3.97e-03  1.87e-03  9.60e-03  9.89e-03]
 [-2.17e-02  2.02e-03  5.98e-03  1.32e-03 -1.23e-03]
 [-8.88e-02 -5.41e-02 -2.11e-03 -2.38e-04  4.52e-03]]
[[ 0.    0.01 -0.04 -0.06  0.01]
 [-0.   -0.06  0.23  0.19 -0.02]
 [-0.05  0.33  0.23 -0.   -0.04]
 [ 0.01 -0.13  0.37  0.13 -0.01]
 [-0.    0.03 -0.09 -0.04  0.01]]
[[ 0.    1.    0.   -0.1  -0.05]
 [ 0.    0.    0.01 -0.    0.01]
 [ 0.    0.02  0.01  0.01 -0.  ]
 [-0.01  0.   -0.    0.    0.  ]
 [-0.01 -0.02 -0.   -0.02 -0.  ]]
[[ 0.01  0.01 -0.03  0.03 -0.02]
 [-0.04  0.03  0.03 -0.05  0.06]
 [ 0.14 -0.62 -0.32  1.02 -0.27]
 [-0.03  0.03  0.03 -0.04  0.05]
 [ 0.01 -0.01 -0.02  0.01 -0.01]]
[[ 0.00e+00  0.00e+00  0.00e+00 -8.21e-03 -2.19e-03]
 [ 1.00e+00  0.00e+00  3.18e-02 -8.45e-06 -8.42e-03]
 [ 0.00e+00 -9.34e-03 -7.47e-03  9.20e-03 -2.75e-03]
 [-8.21e-02 -2.25e-03  3.74e-02  3.00e-03 -9.26e-04]
 [-7.49e-02 -9.30e-03 -1.63e-02  2.34e-02 -2.69e-03]]
[[-0.01 -0.01  0.11 -0.06  0.01]
 [ 0.05 -0.05 -0.56  0.14 -0.04]
 [-0.06  0.07 -0.32 -0.19  0.05]
 [ 0.04 -0.06  0.97  0.14 -0.05]
 [-0.02  0.04 -0.21 -0.02  0.01]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00 -3.36e-03]
 [ 0.00e+00  0.00e+00  0.00e+00 -5.65e-04 -2.71e-03]
 [ 0.00e+00  0.00e+00  1.32e-03  2.92e-03  5.30e-03]
 [ 0.00e+00 -6.01e-04 -1.94e-03  1.01e-03  2.86e-03]
 [ 1.33e-01  1.28e-03 -1.10e-03 -2.95e-03 -7.71e-03]]
[[-0.01  0.03  0.07  0.04 -0.01]
 [ 0.03 -0.14 -0.29 -0.19  0.05]
 [-0.13  1.54 -2.06  1.6  -0.16]
 [ 0.03 -0.1  -0.35 -0.14  0.04]
 [-0.    0.02  0.1   0.03 -0.01]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00 -4.09e-04]
 [ 0.00e+00  1.00e+00  0.00e+00 -3.05e-03 -4.66e-03]
 [ 0.00e+00  0.00e+00  6.70e-04 -2.77e-03 -1.33e-03]
 [ 0.00e+00 -2.47e-03  3.05e-04  4.61e-03  4.08e-03]
 [-6.82e-04 -1.25e-03 -1.52e-03  3.50e-03  4.98e-03]]
[[ 0.01 -0.07  0.02  0.04 -0.  ]
 [-0.06  0.5  -0.1  -0.36  0.03]
 [ 0.02 -0.11  0.22 -0.18  0.05]
 [ 0.04 -0.35 -0.19  0.6  -0.1 ]
 [-0.    0.03  0.05 -0.1   0.02]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  2.17e-02]
 [ 0.00e+00  0.00e+00  0.00e+00  1.53e-03 -1.08e-03]
 [ 1.00e+00  0.00e+00  3.02e-03  5.62e-03 -2.97e-03]
 [ 0.00e+00  5.34e-04 -1.46e-03 -1.43e-03  1.57e-03]
 [ 4.91e-03  6.15e-03 -1.65e-03 -4.10e-02 -3.77e-04]]
[[ 0.02 -0.04 -0.08  0.05 -0.02]
 [-0.09  0.2   1.29 -0.17  0.09]
 [ 0.16 -0.42 -2.27  0.15 -0.1 ]
 [-0.09  0.23  1.26 -0.16  0.08]
 [ 0.02 -0.05 -0.07  0.04 -0.02]]
SymNet parameters
[[ 3.70e-01 -1.17e+00 -7.33e-02 -2.89e-01 -6.39e-02 -1.87e-02 -1.17e+00  5.94e-02
  -5.95e-02 -1.46e-02 -1.17e-02  7.43e-03]
 [ 1.01e+00 -6.82e-03 -1.03e-01  2.74e-02  4.54e-02 -4.27e-03 -3.33e-01  6.27e-03
  -5.30e-02  5.30e-03  5.31e-04  3.54e-03]]
SymNet parameters
[ 1.8  -0.16]
SymNet parameters
[[-8.13e-01  1.48e-01  8.42e-01  5.27e-02 -2.16e-02  1.01e-02  2.63e-01 -3.46e-02
   1.22e-01 -1.91e-03  1.70e-03 -4.37e-03  1.32e-02]
 [ 2.67e-01 -1.21e-01 -1.83e-02 -1.02e-02  2.83e-03 -7.28e-04 -1.68e+00  7.92e-03
   9.30e-03 -3.40e-04 -6.27e-04  2.55e-03  4.08e-03]]
SymNet parameters
[0.35 2.56]
SymNet parameters
[[-1.28 -4.8   0.07 -0.4   1.03 -0.15  3.51 -0.48  0.77  0.01 -0.05  0.13 -0.18 -0.68]
 [-3.32  2.98  1.67 -2.44 -5.28  0.16  4.16  1.91 -3.47 -0.34  0.02 -0.32 -0.1   1.21]]
SymNet parameters
[0.05 0.25]
SymNet parameters
[[ 6.84e-01 -3.03e+00 -4.71e-02 -2.24e-01  7.22e-01 -1.04e-01  2.57e+00 -3.18e-01
   4.75e-01  1.33e-02 -3.13e-02  8.64e-02 -9.88e-02 -4.42e-01 -4.57e-05]
 [ 2.68e-01  2.43e+00  7.13e-01 -1.15e+00 -2.28e+00  6.21e-02  1.01e+00  9.23e-01
  -1.71e+00 -1.42e-01  5.64e-03 -1.38e-01  3.37e-03  6.13e-01  2.43e-04]]
SymNet parameters
[-0.31  0.43]
SymNet parameters
[[ 2.36e+00  2.67e+00 -5.03e-01  6.62e-01  2.46e+00 -6.40e-02 -6.18e+00 -6.98e-01
   1.59e+00  1.55e-01 -2.58e-02  1.39e-01  1.84e-01 -2.64e-01 -9.55e-04  6.21e-03]
 [-8.65e-01 -6.30e-01  5.79e-02 -6.03e-02  1.26e-01 -1.95e-02  3.50e-01 -5.75e-02
   8.52e-02  1.93e-03 -5.77e-03  1.65e-02 -4.62e-02 -9.62e-02 -2.13e-04  8.61e-04]]
SymNet parameters
[0.54 1.  ]
SymNet parameters
[[-0.16 -0.98 -1.46 -0.18 -0.3   0.04  1.25  0.12 -0.33 -0.02 -0.   -0.01  0.76  0.77
   0.05 -0.13  0.16]]
SymNet parameters
[-0.56]
SymNet parameters
[[-4.71e+00 -1.89e-01  4.18e-02  7.41e-03 -2.61e-03  1.01e-03  3.43e-01 -1.94e-03
   4.78e-01 -2.78e-03 -8.40e-03 -1.14e-02]
 [-7.10e+00  1.68e-01 -1.58e-02  8.59e-04 -5.29e-05  8.84e-03  2.51e-01 -1.61e-02
  -5.92e-01  2.84e-03  1.30e-02  1.10e-02]]
SymNet parameters
[ 0.54 -0.52]
SymNet parameters
[[ 7.82e+00  2.90e-01 -6.52e-02 -1.16e-02  4.37e-03 -1.75e-03 -8.16e-01 -3.73e-02
  -8.16e-01  5.07e-03  1.39e-02  1.65e-02  5.02e-04]
 [-9.61e+00  2.00e-01 -1.64e-02  1.90e-03 -4.35e-05  1.19e-02  4.44e-02  8.93e-03
  -8.28e-01  4.22e-03  1.74e-02  1.21e-02  5.88e-04]]
SymNet parameters
[-0.86 -0.59]
SymNet parameters
[[ 6.05e+00  7.88e-02 -1.29e-01  4.02e-04 -6.52e-03 -6.24e-03 -8.91e-02  2.18e-01
  -5.30e-02  2.65e-02  3.13e-02 -1.53e-01 -1.31e-01 -5.82e-02]
 [ 6.52e+00  1.75e-02  1.01e-01 -8.78e-03  1.12e-02 -3.20e-03 -5.85e-01 -1.22e-01
  -2.07e-02 -2.66e-02  5.50e-02  1.79e-01  1.34e-01  5.94e-02]]
SymNet parameters
[0.61 0.15]
SymNet parameters
[[ 5.91e-02 -1.37e-01  2.08e-02 -1.97e-03 -2.38e-03 -6.18e-03 -1.43e+00  3.40e-02
   4.11e-01 -1.07e-02 -2.20e-02  2.76e-03  2.19e-01  1.12e-01  2.19e-02]
 [-3.92e-01 -4.33e+00  6.90e-01  7.13e-02 -4.00e-02 -9.95e-02  4.92e+00 -5.87e-01
  -4.51e+00 -1.14e-01 -3.58e-01 -2.28e-01 -3.01e-01  1.30e-01  4.65e-01]]
SymNet parameters
[-0.78 -0.19]
SymNet parameters
[[ 1.35 -9.36  1.58  0.06 -0.13 -0.12 -2.27 -1.27  5.49 -0.82 -0.75 -0.59  0.77  0.75
   0.73 -0.01]
 [ 0.08  0.72 -0.3  -0.49 -0.48 -1.25 -0.79  0.46  0.27 -1.55 -4.33  3.31 -1.56  2.81
   5.13 -0.13]]
SymNet parameters
[-0.1  -0.22]
SymNet parameters
[[ 9.38e-01  2.48e-01 -4.44e-02 -6.35e-03  5.41e-04  3.91e-03  4.07e-01  1.28e-02
  -8.25e-03  5.24e-02  1.43e-02  6.58e-02 -3.47e+00 -1.55e+00 -1.35e-02 -3.61e-02
   9.56e-05]]
SymNet parameters
[-0.19]
finally, finish this stage
iter:  2000    time: 13.79
Func: 6.40e-02  |g|: 3.26e-01
stableloss: 1.74e-02   dataloss: 5.02e-02   sparseloss: 2.36e+02 momentloss: 6.87e+00
current expression:
[u00*u01, u10*v00, u20, u02, u00*u01**2, u01*u10*v00, u00*u11*v00, u10*v00*v10, 1, u10*v01, v00**2, u00, u01, u00**2*v00**2, u00*v00, v01*v10, u10*v10, u01*v00**2, u00**2, u10*v00*v01]
[-0.98 -0.98  0.05  0.05  0.01  0.01  0.01  0.01 -0.01  0.01  0.    0.   -0.   -0.
 -0.   -0.    0.   -0.    0.   -0.  ]
[v00*v10, u00*v01, v20, v02, v00*v10**2, v00, u00*u01*v01, u00*v01*v10, u00*v00*v11, u00, v10, u01, u00**2*v02, v00**3, 1, v10**2, u01*v00**2, u00**3, u00*v00*v01, u00*v11]
[-0.99 -0.98  0.05  0.05  0.01  0.01  0.01  0.01  0.01 -0.01 -0.   -0.    0.   -0.
 -0.    0.    0.    0.    0.    0.  ]
block:  3
name:  burgers-2-upwind-sparse0-noise0.001-id16
device:  cuda:0
generate a random number to check random seed:  -0.15379939634340034
current stage is: block-3
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.9164, device='cuda:0', dtype=torch.float64)
u_obs variance
tensor([ 0.2499,  1.7207,  1.6875, 21.9710, 11.0148, 20.3903,  0.2547,  1.7767,
         1.7938, 20.3298, 10.9113, 23.3992], device='cuda:0',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 0.177804
         Iterations: 0
         Function evaluations: 15
         Gradient evaluations: 3
convolution moment and kernels
[[ 1.00e+00  0.00e+00  1.30e-03 -1.93e-02 -4.86e-02]
 [ 0.00e+00 -3.23e-05 -1.19e-03 -2.97e-03  6.38e-03]
 [ 3.35e-04 -3.97e-03  1.87e-03  9.60e-03  9.89e-03]
 [-2.17e-02  2.02e-03  5.98e-03  1.32e-03 -1.23e-03]
 [-8.88e-02 -5.41e-02 -2.11e-03 -2.39e-04  4.52e-03]]
[[ 0.    0.01 -0.04 -0.06  0.01]
 [-0.   -0.06  0.23  0.19 -0.02]
 [-0.05  0.33  0.23 -0.   -0.04]
 [ 0.01 -0.13  0.37  0.13 -0.01]
 [-0.    0.03 -0.09 -0.04  0.01]]
[[ 0.    1.    0.   -0.1  -0.05]
 [ 0.    0.    0.01 -0.    0.01]
 [ 0.    0.02  0.01  0.01 -0.  ]
 [-0.01  0.   -0.    0.    0.  ]
 [-0.01 -0.02 -0.   -0.02 -0.  ]]
[[ 0.01  0.01 -0.03  0.03 -0.02]
 [-0.04  0.03  0.03 -0.05  0.06]
 [ 0.14 -0.62 -0.32  1.02 -0.27]
 [-0.03  0.03  0.03 -0.04  0.05]
 [ 0.01 -0.01 -0.02  0.01 -0.01]]
[[ 0.00e+00  0.00e+00  0.00e+00 -8.21e-03 -2.19e-03]
 [ 1.00e+00  0.00e+00  3.18e-02 -8.46e-06 -8.42e-03]
 [ 0.00e+00 -9.34e-03 -7.47e-03  9.20e-03 -2.75e-03]
 [-8.21e-02 -2.25e-03  3.74e-02  3.00e-03 -9.27e-04]
 [-7.49e-02 -9.30e-03 -1.63e-02  2.34e-02 -2.69e-03]]
[[-0.01 -0.01  0.11 -0.06  0.01]
 [ 0.05 -0.05 -0.56  0.14 -0.04]
 [-0.06  0.07 -0.32 -0.19  0.05]
 [ 0.04 -0.06  0.97  0.14 -0.05]
 [-0.02  0.04 -0.21 -0.02  0.01]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00 -3.36e-03]
 [ 0.00e+00  0.00e+00  0.00e+00 -5.65e-04 -2.71e-03]
 [ 0.00e+00  0.00e+00  1.32e-03  2.92e-03  5.30e-03]
 [ 0.00e+00 -6.01e-04 -1.94e-03  1.01e-03  2.86e-03]
 [ 1.33e-01  1.28e-03 -1.10e-03 -2.95e-03 -7.71e-03]]
[[-0.01  0.03  0.07  0.04 -0.01]
 [ 0.03 -0.14 -0.29 -0.19  0.05]
 [-0.13  1.54 -2.06  1.6  -0.16]
 [ 0.03 -0.1  -0.35 -0.14  0.04]
 [-0.    0.02  0.1   0.03 -0.01]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00 -4.09e-04]
 [ 0.00e+00  1.00e+00  0.00e+00 -3.05e-03 -4.66e-03]
 [ 0.00e+00  0.00e+00  6.70e-04 -2.77e-03 -1.33e-03]
 [ 0.00e+00 -2.47e-03  3.05e-04  4.61e-03  4.08e-03]
 [-6.82e-04 -1.25e-03 -1.52e-03  3.50e-03  4.98e-03]]
[[ 0.01 -0.07  0.02  0.04 -0.  ]
 [-0.06  0.5  -0.1  -0.36  0.03]
 [ 0.02 -0.11  0.22 -0.18  0.05]
 [ 0.04 -0.35 -0.19  0.6  -0.1 ]
 [-0.    0.03  0.05 -0.1   0.02]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  2.17e-02]
 [ 0.00e+00  0.00e+00  0.00e+00  1.53e-03 -1.08e-03]
 [ 1.00e+00  0.00e+00  3.02e-03  5.62e-03 -2.97e-03]
 [ 0.00e+00  5.34e-04 -1.46e-03 -1.43e-03  1.57e-03]
 [ 4.91e-03  6.15e-03 -1.65e-03 -4.10e-02 -3.77e-04]]
[[ 0.02 -0.04 -0.08  0.05 -0.02]
 [-0.09  0.2   1.29 -0.17  0.09]
 [ 0.16 -0.42 -2.27  0.15 -0.1 ]
 [-0.09  0.23  1.26 -0.16  0.08]
 [ 0.02 -0.05 -0.07  0.04 -0.02]]
SymNet parameters
[[ 3.70e-01 -1.17e+00 -7.33e-02 -2.89e-01 -6.39e-02 -1.87e-02 -1.17e+00  5.94e-02
  -5.95e-02 -1.46e-02 -1.17e-02  7.43e-03]
 [ 1.01e+00 -6.82e-03 -1.03e-01  2.74e-02  4.54e-02 -4.27e-03 -3.33e-01  6.27e-03
  -5.30e-02  5.30e-03  5.32e-04  3.54e-03]]
SymNet parameters
[ 1.8  -0.16]
SymNet parameters
[[-8.13e-01  1.48e-01  8.42e-01  5.27e-02 -2.16e-02  1.01e-02  2.63e-01 -3.46e-02
   1.22e-01 -1.91e-03  1.70e-03 -4.38e-03  1.32e-02]
 [ 2.67e-01 -1.21e-01 -1.83e-02 -1.02e-02  2.83e-03 -7.26e-04 -1.68e+00  7.91e-03
   9.31e-03 -3.39e-04 -6.27e-04  2.55e-03  4.08e-03]]
SymNet parameters
[0.35 2.56]
SymNet parameters
[[-1.28 -4.8   0.07 -0.4   1.03 -0.15  3.51 -0.48  0.77  0.01 -0.05  0.13 -0.18 -0.68]
 [-3.32  2.98  1.67 -2.44 -5.28  0.16  4.16  1.91 -3.47 -0.34  0.02 -0.32 -0.1   1.21]]
SymNet parameters
[0.05 0.25]
SymNet parameters
[[ 6.84e-01 -3.03e+00 -4.71e-02 -2.24e-01  7.22e-01 -1.04e-01  2.57e+00 -3.18e-01
   4.75e-01  1.33e-02 -3.13e-02  8.64e-02 -9.88e-02 -4.42e-01 -7.74e-05]
 [ 2.68e-01  2.43e+00  7.13e-01 -1.15e+00 -2.28e+00  6.21e-02  1.01e+00  9.23e-01
  -1.71e+00 -1.42e-01  5.64e-03 -1.38e-01  3.37e-03  6.13e-01  3.26e-04]]
SymNet parameters
[-0.31  0.43]
SymNet parameters
[[ 2.36e+00  2.67e+00 -5.03e-01  6.62e-01  2.46e+00 -6.40e-02 -6.18e+00 -6.98e-01
   1.59e+00  1.55e-01 -2.58e-02  1.39e-01  1.84e-01 -2.64e-01 -1.01e-03  6.19e-03]
 [-8.65e-01 -6.30e-01  5.79e-02 -6.03e-02  1.26e-01 -1.95e-02  3.50e-01 -5.75e-02
   8.52e-02  1.93e-03 -5.77e-03  1.65e-02 -4.62e-02 -9.62e-02 -2.01e-04  8.51e-04]]
SymNet parameters
[0.54 1.  ]
SymNet parameters
[[-0.16 -0.98 -1.46 -0.18 -0.3   0.04  1.25  0.12 -0.33 -0.02 -0.   -0.01  0.76  0.77
   0.05 -0.13  0.16]]
SymNet parameters
[-0.56]
SymNet parameters
[[-4.71e+00 -1.89e-01  4.18e-02  7.44e-03 -2.64e-03  1.03e-03  3.43e-01 -1.92e-03
   4.78e-01 -2.80e-03 -8.40e-03 -1.14e-02]
 [-7.10e+00  1.68e-01 -1.58e-02  8.77e-04 -6.74e-05  8.85e-03  2.51e-01 -1.61e-02
  -5.92e-01  2.83e-03  1.30e-02  1.10e-02]]
SymNet parameters
[ 0.54 -0.52]
SymNet parameters
[[ 7.82e+00  2.90e-01 -6.52e-02 -1.16e-02  4.36e-03 -1.74e-03 -8.16e-01 -3.73e-02
  -8.16e-01  5.06e-03  1.39e-02  1.65e-02  3.96e-04]
 [-9.61e+00  2.00e-01 -1.64e-02  1.89e-03 -3.34e-05  1.19e-02  4.44e-02  8.92e-03
  -8.28e-01  4.23e-03  1.74e-02  1.21e-02  6.33e-04]]
SymNet parameters
[-0.86 -0.59]
SymNet parameters
[[ 6.05e+00  7.88e-02 -1.29e-01  4.02e-04 -6.52e-03 -6.24e-03 -8.91e-02  2.18e-01
  -5.30e-02  2.65e-02  3.13e-02 -1.53e-01 -1.31e-01 -5.82e-02]
 [ 6.52e+00  1.75e-02  1.01e-01 -8.78e-03  1.12e-02 -3.20e-03 -5.85e-01 -1.22e-01
  -2.07e-02 -2.66e-02  5.50e-02  1.79e-01  1.34e-01  5.94e-02]]
SymNet parameters
[0.61 0.15]
SymNet parameters
[[ 5.91e-02 -1.37e-01  2.08e-02 -1.97e-03 -2.38e-03 -6.18e-03 -1.43e+00  3.40e-02
   4.11e-01 -1.07e-02 -2.20e-02  2.76e-03  2.19e-01  1.12e-01  2.19e-02]
 [-3.92e-01 -4.33e+00  6.90e-01  7.13e-02 -4.00e-02 -9.95e-02  4.92e+00 -5.87e-01
  -4.51e+00 -1.14e-01 -3.58e-01 -2.28e-01 -3.01e-01  1.30e-01  4.65e-01]]
SymNet parameters
[-0.78 -0.19]
SymNet parameters
[[ 1.35 -9.36  1.58  0.06 -0.13 -0.12 -2.27 -1.27  5.49 -0.82 -0.75 -0.59  0.77  0.75
   0.73 -0.01]
 [ 0.08  0.72 -0.3  -0.49 -0.48 -1.25 -0.79  0.46  0.27 -1.55 -4.33  3.31 -1.56  2.81
   5.13 -0.13]]
SymNet parameters
[-0.1  -0.22]
SymNet parameters
[[ 9.38e-01  2.48e-01 -4.44e-02 -6.35e-03  5.41e-04  3.91e-03  4.07e-01  1.28e-02
  -8.25e-03  5.24e-02  1.43e-02  6.58e-02 -3.47e+00 -1.55e+00 -1.35e-02 -3.61e-02
  -1.45e-03]]
SymNet parameters
[-0.19]
finally, finish this stage
iter:     0    time: 1219.45
Func: 1.78e-01  |g|: 3.35e+02
stableloss: 3.08e-02   dataloss: 1.57e-01   sparseloss: 2.36e+02 momentloss: 6.87e+00
current expression:
[u00*u01, u10*v00, u20, u02, u00*u01**2, u01*u10*v00, u00*u11*v00, u10*v00*v10, 1, u10*v01, v00**2, u00, u01, u00**2*v00**2, u00*v00, v01*v10, u10*v10, u01*v00**2, u00**2, u10*v00*v01]
[-0.98 -0.98  0.05  0.05  0.01  0.01  0.01  0.01 -0.01  0.01  0.    0.   -0.   -0.
 -0.   -0.    0.   -0.    0.   -0.  ]
[v00*v10, u00*v01, v20, v02, v00*v10**2, v00, u00*u01*v01, u00*v01*v10, u00*v00*v11, u00, v10, u01, u00**2*v02, v00**3, 1, v10**2, u01*v00**2, u00**3, u00*v00*v01, u00*v11]
[-0.99 -0.98  0.05  0.05  0.01  0.01  0.01  0.01  0.01 -0.01 -0.   -0.    0.   -0.
 -0.    0.    0.    0.    0.    0.  ]
block:  4
name:  burgers-2-upwind-sparse0-noise0.001-id16
device:  cuda:0
generate a random number to check random seed:  -0.7624490270586972
current stage is: block-4
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.9173, device='cuda:0', dtype=torch.float64)
u_obs variance
tensor([ 0.2582,  1.7751,  1.6570, 23.5333, 10.6663, 19.4735,  0.2641,  1.7440,
         1.8462, 20.0943, 11.3192, 24.4399], device='cuda:0',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 0.349784
         Iterations: 0
         Function evaluations: 15
         Gradient evaluations: 3
convolution moment and kernels
[[ 1.00e+00  0.00e+00  1.30e-03 -1.93e-02 -4.86e-02]
 [ 0.00e+00 -3.23e-05 -1.19e-03 -2.97e-03  6.38e-03]
 [ 3.35e-04 -3.97e-03  1.87e-03  9.60e-03  9.89e-03]
 [-2.17e-02  2.02e-03  5.98e-03  1.32e-03 -1.23e-03]
 [-8.88e-02 -5.41e-02 -2.11e-03 -2.39e-04  4.52e-03]]
[[ 0.    0.01 -0.04 -0.06  0.01]
 [-0.   -0.06  0.23  0.19 -0.02]
 [-0.05  0.33  0.23 -0.   -0.04]
 [ 0.01 -0.13  0.37  0.13 -0.01]
 [-0.    0.03 -0.09 -0.04  0.01]]
[[ 0.    1.    0.   -0.1  -0.05]
 [ 0.    0.    0.01 -0.    0.01]
 [ 0.    0.02  0.01  0.01 -0.  ]
 [-0.01  0.   -0.    0.    0.  ]
 [-0.01 -0.02 -0.   -0.02 -0.  ]]
[[ 0.01  0.01 -0.03  0.03 -0.02]
 [-0.04  0.03  0.03 -0.05  0.06]
 [ 0.14 -0.62 -0.32  1.02 -0.27]
 [-0.03  0.03  0.03 -0.04  0.05]
 [ 0.01 -0.01 -0.02  0.01 -0.01]]
[[ 0.00e+00  0.00e+00  0.00e+00 -8.21e-03 -2.19e-03]
 [ 1.00e+00  0.00e+00  3.18e-02 -8.61e-06 -8.42e-03]
 [ 0.00e+00 -9.34e-03 -7.47e-03  9.20e-03 -2.75e-03]
 [-8.21e-02 -2.25e-03  3.74e-02  3.00e-03 -9.26e-04]
 [-7.49e-02 -9.30e-03 -1.63e-02  2.34e-02 -2.69e-03]]
[[-0.01 -0.01  0.11 -0.06  0.01]
 [ 0.05 -0.05 -0.56  0.14 -0.04]
 [-0.06  0.07 -0.32 -0.19  0.05]
 [ 0.04 -0.06  0.97  0.14 -0.05]
 [-0.02  0.04 -0.21 -0.02  0.01]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00 -3.36e-03]
 [ 0.00e+00  0.00e+00  0.00e+00 -5.65e-04 -2.71e-03]
 [ 0.00e+00  0.00e+00  1.32e-03  2.92e-03  5.30e-03]
 [ 0.00e+00 -6.01e-04 -1.94e-03  1.01e-03  2.86e-03]
 [ 1.33e-01  1.28e-03 -1.10e-03 -2.95e-03 -7.71e-03]]
[[-0.01  0.03  0.07  0.04 -0.01]
 [ 0.03 -0.14 -0.29 -0.19  0.05]
 [-0.13  1.54 -2.06  1.6  -0.16]
 [ 0.03 -0.1  -0.35 -0.14  0.04]
 [-0.    0.02  0.1   0.03 -0.01]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00 -4.09e-04]
 [ 0.00e+00  1.00e+00  0.00e+00 -3.05e-03 -4.66e-03]
 [ 0.00e+00  0.00e+00  6.70e-04 -2.77e-03 -1.33e-03]
 [ 0.00e+00 -2.47e-03  3.05e-04  4.61e-03  4.08e-03]
 [-6.82e-04 -1.25e-03 -1.52e-03  3.50e-03  4.98e-03]]
[[ 0.01 -0.07  0.02  0.04 -0.  ]
 [-0.06  0.5  -0.1  -0.36  0.03]
 [ 0.02 -0.11  0.22 -0.18  0.05]
 [ 0.04 -0.35 -0.19  0.6  -0.1 ]
 [-0.    0.03  0.05 -0.1   0.02]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  2.17e-02]
 [ 0.00e+00  0.00e+00  0.00e+00  1.53e-03 -1.08e-03]
 [ 1.00e+00  0.00e+00  3.02e-03  5.62e-03 -2.97e-03]
 [ 0.00e+00  5.34e-04 -1.46e-03 -1.43e-03  1.57e-03]
 [ 4.91e-03  6.15e-03 -1.65e-03 -4.10e-02 -3.77e-04]]
[[ 0.02 -0.04 -0.08  0.05 -0.02]
 [-0.09  0.2   1.29 -0.17  0.09]
 [ 0.16 -0.42 -2.27  0.15 -0.1 ]
 [-0.09  0.23  1.26 -0.16  0.08]
 [ 0.02 -0.05 -0.07  0.04 -0.02]]
SymNet parameters
[[ 3.70e-01 -1.17e+00 -7.33e-02 -2.89e-01 -6.39e-02 -1.87e-02 -1.17e+00  5.94e-02
  -5.95e-02 -1.46e-02 -1.17e-02  7.43e-03]
 [ 1.01e+00 -6.82e-03 -1.03e-01  2.74e-02  4.54e-02 -4.27e-03 -3.33e-01  6.27e-03
  -5.30e-02  5.29e-03  5.33e-04  3.54e-03]]
SymNet parameters
[ 1.8  -0.16]
SymNet parameters
[[-8.13e-01  1.48e-01  8.42e-01  5.27e-02 -2.16e-02  1.02e-02  2.63e-01 -3.46e-02
   1.22e-01 -1.92e-03  1.70e-03 -4.38e-03  1.32e-02]
 [ 2.67e-01 -1.21e-01 -1.83e-02 -1.02e-02  2.83e-03 -7.27e-04 -1.68e+00  7.91e-03
   9.30e-03 -3.39e-04 -6.27e-04  2.55e-03  4.08e-03]]
SymNet parameters
[0.35 2.56]
SymNet parameters
[[-1.28 -4.8   0.07 -0.4   1.03 -0.15  3.51 -0.48  0.77  0.01 -0.05  0.13 -0.18 -0.68]
 [-3.32  2.98  1.67 -2.44 -5.28  0.16  4.16  1.91 -3.47 -0.34  0.02 -0.32 -0.1   1.21]]
SymNet parameters
[0.05 0.25]
SymNet parameters
[[ 6.84e-01 -3.03e+00 -4.71e-02 -2.24e-01  7.22e-01 -1.04e-01  2.57e+00 -3.18e-01
   4.75e-01  1.33e-02 -3.13e-02  8.64e-02 -9.88e-02 -4.42e-01  9.94e-05]
 [ 2.68e-01  2.43e+00  7.13e-01 -1.15e+00 -2.28e+00  6.21e-02  1.01e+00  9.23e-01
  -1.71e+00 -1.42e-01  5.64e-03 -1.38e-01  3.37e-03  6.13e-01  5.42e-05]]
SymNet parameters
[-0.31  0.43]
SymNet parameters
[[ 2.36e+00  2.67e+00 -5.03e-01  6.62e-01  2.46e+00 -6.40e-02 -6.18e+00 -6.98e-01
   1.59e+00  1.55e-01 -2.58e-02  1.39e-01  1.84e-01 -2.64e-01 -9.42e-04  6.21e-03]
 [-8.65e-01 -6.30e-01  5.79e-02 -6.03e-02  1.26e-01 -1.95e-02  3.50e-01 -5.75e-02
   8.52e-02  1.93e-03 -5.77e-03  1.65e-02 -4.62e-02 -9.62e-02 -2.36e-04  8.76e-04]]
SymNet parameters
[0.54 1.  ]
SymNet parameters
[[-0.16 -0.98 -1.46 -0.18 -0.3   0.04  1.25  0.12 -0.33 -0.02 -0.   -0.01  0.76  0.77
   0.05 -0.13  0.16]]
SymNet parameters
[-0.56]
SymNet parameters
[[-4.71e+00 -1.89e-01  4.18e-02  7.42e-03 -2.62e-03  1.03e-03  3.43e-01 -1.93e-03
   4.78e-01 -2.80e-03 -8.41e-03 -1.14e-02]
 [-7.10e+00  1.68e-01 -1.58e-02  8.63e-04 -5.97e-05  8.85e-03  2.51e-01 -1.61e-02
  -5.92e-01  2.83e-03  1.30e-02  1.10e-02]]
SymNet parameters
[ 0.54 -0.52]
SymNet parameters
[[ 7.82e+00  2.90e-01 -6.52e-02 -1.16e-02  4.37e-03 -1.74e-03 -8.16e-01 -3.73e-02
  -8.16e-01  5.06e-03  1.39e-02  1.65e-02  5.01e-04]
 [-9.61e+00  2.00e-01 -1.64e-02  1.90e-03 -3.87e-05  1.19e-02  4.44e-02  8.92e-03
  -8.28e-01  4.23e-03  1.74e-02  1.21e-02  5.54e-04]]
SymNet parameters
[-0.86 -0.59]
SymNet parameters
[[ 6.05e+00  7.88e-02 -1.29e-01  4.02e-04 -6.52e-03 -6.24e-03 -8.91e-02  2.18e-01
  -5.30e-02  2.65e-02  3.13e-02 -1.53e-01 -1.31e-01 -5.82e-02]
 [ 6.52e+00  1.75e-02  1.01e-01 -8.78e-03  1.12e-02 -3.20e-03 -5.85e-01 -1.22e-01
  -2.07e-02 -2.66e-02  5.50e-02  1.79e-01  1.34e-01  5.94e-02]]
SymNet parameters
[0.61 0.15]
SymNet parameters
[[ 5.91e-02 -1.37e-01  2.08e-02 -1.97e-03 -2.38e-03 -6.18e-03 -1.43e+00  3.40e-02
   4.11e-01 -1.07e-02 -2.20e-02  2.76e-03  2.19e-01  1.12e-01  2.19e-02]
 [-3.92e-01 -4.33e+00  6.90e-01  7.13e-02 -4.00e-02 -9.95e-02  4.92e+00 -5.87e-01
  -4.51e+00 -1.14e-01 -3.58e-01 -2.28e-01 -3.01e-01  1.30e-01  4.65e-01]]
SymNet parameters
[-0.78 -0.19]
SymNet parameters
[[ 1.35 -9.36  1.58  0.06 -0.13 -0.12 -2.27 -1.27  5.49 -0.82 -0.75 -0.59  0.77  0.75
   0.73 -0.01]
 [ 0.08  0.72 -0.3  -0.49 -0.48 -1.25 -0.79  0.46  0.27 -1.55 -4.33  3.31 -1.56  2.81
   5.13 -0.13]]
SymNet parameters
[-0.1  -0.22]
SymNet parameters
[[ 9.38e-01  2.48e-01 -4.44e-02 -6.35e-03  5.41e-04  3.91e-03  4.07e-01  1.28e-02
  -8.25e-03  5.24e-02  1.43e-02  6.58e-02 -3.47e+00 -1.55e+00 -1.35e-02 -3.61e-02
  -5.08e-04]]
SymNet parameters
[-0.19]
finally, finish this stage
iter:     0    time: 76.52
Func: 3.50e-01  |g|: 4.02e+02
stableloss: 3.76e-02   dataloss: 3.22e-01   sparseloss: 2.36e+02 momentloss: 6.87e+00
current expression:
[u00*u01, u10*v00, u20, u02, u00*u01**2, u01*u10*v00, u00*u11*v00, u10*v00*v10, 1, u10*v01, v00**2, u00, u01, u00**2*v00**2, u00*v00, v01*v10, u10*v10, u01*v00**2, u00**2, u10*v00*v01]
[-0.98 -0.98  0.05  0.05  0.01  0.01  0.01  0.01 -0.01  0.01  0.    0.   -0.   -0.
 -0.   -0.    0.   -0.    0.   -0.  ]
[v00*v10, u00*v01, v20, v02, v00*v10**2, v00, u00*u01*v01, u00*v01*v10, u00*v00*v11, u00, v10, u01, u00**2*v02, v00**3, 1, v10**2, u01*v00**2, u00**3, u00*v00*v01, u00*v11]
[-0.99 -0.98  0.05  0.05  0.01  0.01  0.01  0.01  0.01 -0.01 -0.   -0.    0.   -0.
 -0.    0.    0.    0.    0.    0.  ]
block:  5
name:  burgers-2-upwind-sparse0-noise0.001-id16
device:  cuda:0
generate a random number to check random seed:  0.5268247486993415
current stage is: block-5
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.8836, device='cuda:0', dtype=torch.float64)
u_obs variance
tensor([ 0.2449,  1.6910,  1.5505, 21.7620,  9.9664, 17.8824,  0.2498,  1.6222,
         1.7108, 18.6314, 10.4299, 22.9171], device='cuda:0',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 0.553204
         Iterations: 0
         Function evaluations: 15
         Gradient evaluations: 3
convolution moment and kernels
[[ 1.00e+00  0.00e+00  1.30e-03 -1.93e-02 -4.86e-02]
 [ 0.00e+00 -3.23e-05 -1.19e-03 -2.97e-03  6.38e-03]
 [ 3.35e-04 -3.97e-03  1.87e-03  9.60e-03  9.89e-03]
 [-2.17e-02  2.02e-03  5.98e-03  1.32e-03 -1.23e-03]
 [-8.88e-02 -5.41e-02 -2.11e-03 -2.38e-04  4.52e-03]]
[[ 0.    0.01 -0.04 -0.06  0.01]
 [-0.   -0.06  0.23  0.19 -0.02]
 [-0.05  0.33  0.23 -0.   -0.04]
 [ 0.01 -0.13  0.37  0.13 -0.01]
 [-0.    0.03 -0.09 -0.04  0.01]]
[[ 0.    1.    0.   -0.1  -0.05]
 [ 0.    0.    0.01 -0.    0.01]
 [ 0.    0.02  0.01  0.01 -0.  ]
 [-0.01  0.   -0.    0.    0.  ]
 [-0.01 -0.02 -0.   -0.02 -0.  ]]
[[ 0.01  0.01 -0.03  0.03 -0.02]
 [-0.04  0.03  0.03 -0.05  0.06]
 [ 0.14 -0.62 -0.32  1.02 -0.27]
 [-0.03  0.03  0.03 -0.04  0.05]
 [ 0.01 -0.01 -0.02  0.01 -0.01]]
[[ 0.00e+00  0.00e+00  0.00e+00 -8.21e-03 -2.19e-03]
 [ 1.00e+00  0.00e+00  3.18e-02 -8.46e-06 -8.42e-03]
 [ 0.00e+00 -9.34e-03 -7.47e-03  9.20e-03 -2.75e-03]
 [-8.21e-02 -2.25e-03  3.74e-02  3.00e-03 -9.26e-04]
 [-7.49e-02 -9.30e-03 -1.63e-02  2.34e-02 -2.69e-03]]
[[-0.01 -0.01  0.11 -0.06  0.01]
 [ 0.05 -0.05 -0.56  0.14 -0.04]
 [-0.06  0.07 -0.32 -0.19  0.05]
 [ 0.04 -0.06  0.97  0.14 -0.05]
 [-0.02  0.04 -0.21 -0.02  0.01]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00 -3.36e-03]
 [ 0.00e+00  0.00e+00  0.00e+00 -5.65e-04 -2.71e-03]
 [ 0.00e+00  0.00e+00  1.32e-03  2.92e-03  5.30e-03]
 [ 0.00e+00 -6.01e-04 -1.94e-03  1.01e-03  2.86e-03]
 [ 1.33e-01  1.28e-03 -1.10e-03 -2.95e-03 -7.71e-03]]
[[-0.01  0.03  0.07  0.04 -0.01]
 [ 0.03 -0.14 -0.29 -0.19  0.05]
 [-0.13  1.54 -2.06  1.6  -0.16]
 [ 0.03 -0.1  -0.35 -0.14  0.04]
 [-0.    0.02  0.1   0.03 -0.01]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00 -4.09e-04]
 [ 0.00e+00  1.00e+00  0.00e+00 -3.05e-03 -4.66e-03]
 [ 0.00e+00  0.00e+00  6.70e-04 -2.77e-03 -1.33e-03]
 [ 0.00e+00 -2.47e-03  3.05e-04  4.61e-03  4.08e-03]
 [-6.82e-04 -1.25e-03 -1.52e-03  3.50e-03  4.98e-03]]
[[ 0.01 -0.07  0.02  0.04 -0.  ]
 [-0.06  0.5  -0.1  -0.36  0.03]
 [ 0.02 -0.11  0.22 -0.18  0.05]
 [ 0.04 -0.35 -0.19  0.6  -0.1 ]
 [-0.    0.03  0.05 -0.1   0.02]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  2.17e-02]
 [ 0.00e+00  0.00e+00  0.00e+00  1.53e-03 -1.08e-03]
 [ 1.00e+00  0.00e+00  3.02e-03  5.62e-03 -2.97e-03]
 [ 0.00e+00  5.34e-04 -1.46e-03 -1.43e-03  1.57e-03]
 [ 4.91e-03  6.15e-03 -1.65e-03 -4.10e-02 -3.77e-04]]
[[ 0.02 -0.04 -0.08  0.05 -0.02]
 [-0.09  0.2   1.29 -0.17  0.09]
 [ 0.16 -0.42 -2.27  0.15 -0.1 ]
 [-0.09  0.23  1.26 -0.16  0.08]
 [ 0.02 -0.05 -0.07  0.04 -0.02]]
SymNet parameters
[[ 3.70e-01 -1.17e+00 -7.33e-02 -2.89e-01 -6.39e-02 -1.87e-02 -1.17e+00  5.94e-02
  -5.95e-02 -1.46e-02 -1.17e-02  7.43e-03]
 [ 1.01e+00 -6.82e-03 -1.03e-01  2.74e-02  4.54e-02 -4.27e-03 -3.33e-01  6.27e-03
  -5.30e-02  5.30e-03  5.31e-04  3.54e-03]]
SymNet parameters
[ 1.8  -0.16]
SymNet parameters
[[-8.13e-01  1.48e-01  8.42e-01  5.27e-02 -2.16e-02  1.01e-02  2.63e-01 -3.46e-02
   1.22e-01 -1.91e-03  1.70e-03 -4.38e-03  1.32e-02]
 [ 2.67e-01 -1.21e-01 -1.83e-02 -1.02e-02  2.83e-03 -7.28e-04 -1.68e+00  7.92e-03
   9.30e-03 -3.40e-04 -6.27e-04  2.55e-03  4.08e-03]]
SymNet parameters
[0.35 2.56]
SymNet parameters
[[-1.28 -4.8   0.07 -0.4   1.03 -0.15  3.51 -0.48  0.77  0.01 -0.05  0.13 -0.18 -0.68]
 [-3.32  2.98  1.67 -2.44 -5.28  0.16  4.16  1.91 -3.47 -0.34  0.02 -0.32 -0.1   1.21]]
SymNet parameters
[0.05 0.25]
SymNet parameters
[[ 6.84e-01 -3.03e+00 -4.71e-02 -2.24e-01  7.22e-01 -1.04e-01  2.57e+00 -3.18e-01
   4.75e-01  1.33e-02 -3.13e-02  8.64e-02 -9.88e-02 -4.42e-01 -9.89e-05]
 [ 2.68e-01  2.43e+00  7.13e-01 -1.15e+00 -2.28e+00  6.21e-02  1.01e+00  9.23e-01
  -1.71e+00 -1.42e-01  5.64e-03 -1.38e-01  3.37e-03  6.13e-01  2.18e-04]]
SymNet parameters
[-0.31  0.43]
SymNet parameters
[[ 2.36e+00  2.67e+00 -5.03e-01  6.62e-01  2.46e+00 -6.40e-02 -6.18e+00 -6.98e-01
   1.59e+00  1.55e-01 -2.58e-02  1.39e-01  1.84e-01 -2.64e-01 -9.66e-04  6.20e-03]
 [-8.65e-01 -6.30e-01  5.79e-02 -6.03e-02  1.26e-01 -1.95e-02  3.50e-01 -5.75e-02
   8.52e-02  1.93e-03 -5.77e-03  1.65e-02 -4.62e-02 -9.62e-02 -2.88e-04  8.50e-04]]
SymNet parameters
[0.54 1.  ]
SymNet parameters
[[-0.16 -0.98 -1.46 -0.18 -0.3   0.04  1.25  0.12 -0.33 -0.02 -0.   -0.01  0.76  0.77
   0.05 -0.13  0.16]]
SymNet parameters
[-0.56]
SymNet parameters
[[-4.71e+00 -1.89e-01  4.18e-02  7.42e-03 -2.61e-03  1.01e-03  3.43e-01 -1.93e-03
   4.78e-01 -2.79e-03 -8.40e-03 -1.14e-02]
 [-7.10e+00  1.68e-01 -1.58e-02  8.63e-04 -5.16e-05  8.84e-03  2.51e-01 -1.61e-02
  -5.92e-01  2.84e-03  1.30e-02  1.10e-02]]
SymNet parameters
[ 0.54 -0.52]
SymNet parameters
[[ 7.82e+00  2.90e-01 -6.52e-02 -1.16e-02  4.37e-03 -1.75e-03 -8.16e-01 -3.73e-02
  -8.16e-01  5.07e-03  1.39e-02  1.65e-02  5.37e-04]
 [-9.61e+00  2.00e-01 -1.64e-02  1.90e-03 -4.45e-05  1.19e-02  4.44e-02  8.93e-03
  -8.28e-01  4.22e-03  1.74e-02  1.21e-02  5.56e-04]]
SymNet parameters
[-0.86 -0.59]
SymNet parameters
[[ 6.05e+00  7.88e-02 -1.29e-01  4.02e-04 -6.52e-03 -6.24e-03 -8.91e-02  2.18e-01
  -5.30e-02  2.65e-02  3.13e-02 -1.53e-01 -1.31e-01 -5.82e-02]
 [ 6.52e+00  1.75e-02  1.01e-01 -8.78e-03  1.12e-02 -3.20e-03 -5.85e-01 -1.22e-01
  -2.07e-02 -2.66e-02  5.50e-02  1.79e-01  1.34e-01  5.94e-02]]
SymNet parameters
[0.61 0.15]
SymNet parameters
[[ 5.91e-02 -1.37e-01  2.08e-02 -1.97e-03 -2.38e-03 -6.18e-03 -1.43e+00  3.40e-02
   4.11e-01 -1.07e-02 -2.20e-02  2.76e-03  2.19e-01  1.12e-01  2.19e-02]
 [-3.92e-01 -4.33e+00  6.90e-01  7.13e-02 -4.00e-02 -9.95e-02  4.92e+00 -5.87e-01
  -4.51e+00 -1.14e-01 -3.58e-01 -2.28e-01 -3.01e-01  1.30e-01  4.65e-01]]
SymNet parameters
[-0.78 -0.19]
SymNet parameters
[[ 1.35 -9.36  1.58  0.06 -0.13 -0.12 -2.27 -1.27  5.49 -0.82 -0.75 -0.59  0.77  0.75
   0.73 -0.01]
 [ 0.08  0.72 -0.3  -0.49 -0.48 -1.25 -0.79  0.46  0.27 -1.55 -4.33  3.31 -1.56  2.81
   5.13 -0.13]]
SymNet parameters
[-0.1  -0.22]
SymNet parameters
[[ 9.38e-01  2.48e-01 -4.44e-02 -6.35e-03  5.41e-04  3.91e-03  4.07e-01  1.28e-02
  -8.25e-03  5.24e-02  1.43e-02  6.58e-02 -3.47e+00 -1.55e+00 -1.35e-02 -3.61e-02
  -3.83e-04]]
SymNet parameters
[-0.19]
finally, finish this stage
iter:     0    time: 79.83
Func: 5.53e-01  |g|: 1.64e+03
stableloss: 4.00e-02   dataloss: 5.19e-01   sparseloss: 2.36e+02 momentloss: 6.87e+00
current expression:
[u00*u01, u10*v00, u20, u02, u00*u01**2, u01*u10*v00, u00*u11*v00, u10*v00*v10, 1, u10*v01, v00**2, u00, u01, u00**2*v00**2, u00*v00, v01*v10, u10*v10, u01*v00**2, u00**2, u10*v00*v01]
[-0.98 -0.98  0.05  0.05  0.01  0.01  0.01  0.01 -0.01  0.01  0.    0.   -0.   -0.
 -0.   -0.    0.   -0.    0.   -0.  ]
[v00*v10, u00*v01, v20, v02, v00*v10**2, v00, u00*u01*v01, u00*v01*v10, u00*v00*v11, u00, v10, u01, u00**2*v02, v00**3, 1, v10**2, u01*v00**2, u00**3, u00*v00*v01, u00*v11]
[-0.99 -0.98  0.05  0.05  0.01  0.01  0.01  0.01  0.01 -0.01 -0.   -0.    0.   -0.
 -0.    0.    0.    0.    0.    0.  ]
block:  6
name:  burgers-2-upwind-sparse0-noise0.001-id16
device:  cuda:0
generate a random number to check random seed:  2.4146235506250684
current stage is: block-6
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.9306, device='cuda:0', dtype=torch.float64)
u_obs variance
tensor([ 0.2569,  1.7418,  1.5957, 21.4437,  9.7164, 17.8218,  0.2531,  1.5891,
         1.6367, 17.6059,  9.3181, 21.3248], device='cuda:0',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 0.725405
         Iterations: 0
         Function evaluations: 15
         Gradient evaluations: 3
convolution moment and kernels
[[ 1.00e+00  0.00e+00  1.30e-03 -1.93e-02 -4.86e-02]
 [ 0.00e+00 -3.23e-05 -1.19e-03 -2.97e-03  6.38e-03]
 [ 3.35e-04 -3.97e-03  1.87e-03  9.60e-03  9.89e-03]
 [-2.17e-02  2.02e-03  5.98e-03  1.32e-03 -1.23e-03]
 [-8.88e-02 -5.41e-02 -2.11e-03 -2.38e-04  4.52e-03]]
[[ 0.    0.01 -0.04 -0.06  0.01]
 [-0.   -0.06  0.23  0.19 -0.02]
 [-0.05  0.33  0.23 -0.   -0.04]
 [ 0.01 -0.13  0.37  0.13 -0.01]
 [-0.    0.03 -0.09 -0.04  0.01]]
[[ 0.    1.    0.   -0.1  -0.05]
 [ 0.    0.    0.01 -0.    0.01]
 [ 0.    0.02  0.01  0.01 -0.  ]
 [-0.01  0.   -0.    0.    0.  ]
 [-0.01 -0.02 -0.   -0.02 -0.  ]]
[[ 0.01  0.01 -0.03  0.03 -0.02]
 [-0.04  0.03  0.03 -0.05  0.06]
 [ 0.14 -0.62 -0.32  1.02 -0.27]
 [-0.03  0.03  0.03 -0.04  0.05]
 [ 0.01 -0.01 -0.02  0.01 -0.01]]
[[ 0.00e+00  0.00e+00  0.00e+00 -8.21e-03 -2.19e-03]
 [ 1.00e+00  0.00e+00  3.18e-02 -8.43e-06 -8.42e-03]
 [ 0.00e+00 -9.34e-03 -7.47e-03  9.20e-03 -2.75e-03]
 [-8.21e-02 -2.25e-03  3.74e-02  3.00e-03 -9.26e-04]
 [-7.49e-02 -9.30e-03 -1.63e-02  2.34e-02 -2.69e-03]]
[[-0.01 -0.01  0.11 -0.06  0.01]
 [ 0.05 -0.05 -0.56  0.14 -0.04]
 [-0.06  0.07 -0.32 -0.19  0.05]
 [ 0.04 -0.06  0.97  0.14 -0.05]
 [-0.02  0.04 -0.21 -0.02  0.01]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00 -3.36e-03]
 [ 0.00e+00  0.00e+00  0.00e+00 -5.65e-04 -2.71e-03]
 [ 0.00e+00  0.00e+00  1.32e-03  2.92e-03  5.30e-03]
 [ 0.00e+00 -6.01e-04 -1.94e-03  1.01e-03  2.86e-03]
 [ 1.33e-01  1.28e-03 -1.10e-03 -2.95e-03 -7.71e-03]]
[[-0.01  0.03  0.07  0.04 -0.01]
 [ 0.03 -0.14 -0.29 -0.19  0.05]
 [-0.13  1.54 -2.06  1.6  -0.16]
 [ 0.03 -0.1  -0.35 -0.14  0.04]
 [-0.    0.02  0.1   0.03 -0.01]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00 -4.09e-04]
 [ 0.00e+00  1.00e+00  0.00e+00 -3.05e-03 -4.66e-03]
 [ 0.00e+00  0.00e+00  6.70e-04 -2.77e-03 -1.33e-03]
 [ 0.00e+00 -2.47e-03  3.05e-04  4.61e-03  4.08e-03]
 [-6.82e-04 -1.25e-03 -1.52e-03  3.50e-03  4.98e-03]]
[[ 0.01 -0.07  0.02  0.04 -0.  ]
 [-0.06  0.5  -0.1  -0.36  0.03]
 [ 0.02 -0.11  0.22 -0.18  0.05]
 [ 0.04 -0.35 -0.19  0.6  -0.1 ]
 [-0.    0.03  0.05 -0.1   0.02]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  2.17e-02]
 [ 0.00e+00  0.00e+00  0.00e+00  1.53e-03 -1.08e-03]
 [ 1.00e+00  0.00e+00  3.02e-03  5.62e-03 -2.97e-03]
 [ 0.00e+00  5.34e-04 -1.46e-03 -1.43e-03  1.57e-03]
 [ 4.91e-03  6.15e-03 -1.65e-03 -4.10e-02 -3.77e-04]]
[[ 0.02 -0.04 -0.08  0.05 -0.02]
 [-0.09  0.2   1.29 -0.17  0.09]
 [ 0.16 -0.42 -2.27  0.15 -0.1 ]
 [-0.09  0.23  1.26 -0.16  0.08]
 [ 0.02 -0.05 -0.07  0.04 -0.02]]
SymNet parameters
[[ 3.70e-01 -1.17e+00 -7.33e-02 -2.89e-01 -6.39e-02 -1.87e-02 -1.17e+00  5.94e-02
  -5.95e-02 -1.46e-02 -1.17e-02  7.43e-03]
 [ 1.01e+00 -6.82e-03 -1.03e-01  2.74e-02  4.54e-02 -4.27e-03 -3.33e-01  6.27e-03
  -5.30e-02  5.30e-03  5.32e-04  3.54e-03]]
SymNet parameters
[ 1.8  -0.16]
SymNet parameters
[[-8.13e-01  1.48e-01  8.42e-01  5.27e-02 -2.16e-02  1.01e-02  2.63e-01 -3.46e-02
   1.22e-01 -1.91e-03  1.70e-03 -4.38e-03  1.32e-02]
 [ 2.67e-01 -1.21e-01 -1.83e-02 -1.02e-02  2.83e-03 -7.27e-04 -1.68e+00  7.92e-03
   9.30e-03 -3.40e-04 -6.27e-04  2.55e-03  4.08e-03]]
SymNet parameters
[0.35 2.56]
SymNet parameters
[[-1.28 -4.8   0.07 -0.4   1.03 -0.15  3.51 -0.48  0.77  0.01 -0.05  0.13 -0.18 -0.68]
 [-3.32  2.98  1.67 -2.44 -5.28  0.16  4.16  1.91 -3.47 -0.34  0.02 -0.32 -0.1   1.21]]
SymNet parameters
[0.05 0.25]
SymNet parameters
[[ 6.84e-01 -3.03e+00 -4.71e-02 -2.24e-01  7.22e-01 -1.04e-01  2.57e+00 -3.18e-01
   4.75e-01  1.33e-02 -3.13e-02  8.64e-02 -9.88e-02 -4.42e-01  6.89e-05]
 [ 2.68e-01  2.43e+00  7.13e-01 -1.15e+00 -2.28e+00  6.21e-02  1.01e+00  9.23e-01
  -1.71e+00 -1.42e-01  5.64e-03 -1.38e-01  3.37e-03  6.13e-01  1.79e-04]]
SymNet parameters
[-0.31  0.43]
SymNet parameters
[[ 2.36e+00  2.67e+00 -5.03e-01  6.62e-01  2.46e+00 -6.40e-02 -6.18e+00 -6.98e-01
   1.59e+00  1.55e-01 -2.58e-02  1.39e-01  1.84e-01 -2.64e-01 -9.63e-04  6.21e-03]
 [-8.65e-01 -6.30e-01  5.79e-02 -6.03e-02  1.26e-01 -1.95e-02  3.50e-01 -5.75e-02
   8.52e-02  1.93e-03 -5.77e-03  1.65e-02 -4.62e-02 -9.62e-02 -1.34e-04  8.77e-04]]
SymNet parameters
[0.54 1.  ]
SymNet parameters
[[-0.16 -0.98 -1.46 -0.18 -0.3   0.04  1.25  0.12 -0.33 -0.02 -0.   -0.01  0.76  0.77
   0.05 -0.13  0.16]]
SymNet parameters
[-0.56]
SymNet parameters
[[-4.71e+00 -1.89e-01  4.18e-02  7.42e-03 -2.61e-03  1.03e-03  3.43e-01 -1.94e-03
   4.78e-01 -2.79e-03 -8.41e-03 -1.14e-02]
 [-7.10e+00  1.68e-01 -1.58e-02  8.65e-04 -5.38e-05  8.85e-03  2.51e-01 -1.61e-02
  -5.92e-01  2.84e-03  1.30e-02  1.10e-02]]
SymNet parameters
[ 0.54 -0.52]
SymNet parameters
[[ 7.82e+00  2.90e-01 -6.52e-02 -1.16e-02  4.37e-03 -1.74e-03 -8.16e-01 -3.73e-02
  -8.16e-01  5.07e-03  1.39e-02  1.65e-02  4.02e-04]
 [-9.61e+00  2.00e-01 -1.64e-02  1.90e-03 -4.27e-05  1.19e-02  4.44e-02  8.93e-03
  -8.28e-01  4.22e-03  1.74e-02  1.21e-02  6.72e-04]]
SymNet parameters
[-0.86 -0.59]
SymNet parameters
[[ 6.05e+00  7.88e-02 -1.29e-01  4.02e-04 -6.52e-03 -6.24e-03 -8.91e-02  2.18e-01
  -5.30e-02  2.65e-02  3.13e-02 -1.53e-01 -1.31e-01 -5.82e-02]
 [ 6.52e+00  1.75e-02  1.01e-01 -8.78e-03  1.12e-02 -3.20e-03 -5.85e-01 -1.22e-01
  -2.07e-02 -2.66e-02  5.50e-02  1.79e-01  1.34e-01  5.94e-02]]
SymNet parameters
[0.61 0.15]
SymNet parameters
[[ 5.91e-02 -1.37e-01  2.08e-02 -1.97e-03 -2.38e-03 -6.18e-03 -1.43e+00  3.40e-02
   4.11e-01 -1.07e-02 -2.20e-02  2.76e-03  2.19e-01  1.12e-01  2.19e-02]
 [-3.92e-01 -4.33e+00  6.90e-01  7.13e-02 -4.00e-02 -9.95e-02  4.92e+00 -5.87e-01
  -4.51e+00 -1.14e-01 -3.58e-01 -2.28e-01 -3.01e-01  1.30e-01  4.65e-01]]
SymNet parameters
[-0.78 -0.19]
SymNet parameters
[[ 1.35 -9.36  1.58  0.06 -0.13 -0.12 -2.27 -1.27  5.49 -0.82 -0.75 -0.59  0.77  0.75
   0.73 -0.01]
 [ 0.08  0.72 -0.3  -0.49 -0.48 -1.25 -0.79  0.46  0.27 -1.55 -4.33  3.31 -1.56  2.81
   5.13 -0.13]]
SymNet parameters
[-0.1  -0.22]
SymNet parameters
[[ 9.38e-01  2.48e-01 -4.44e-02 -6.35e-03  5.41e-04  3.91e-03  4.07e-01  1.28e-02
  -8.25e-03  5.24e-02  1.43e-02  6.58e-02 -3.47e+00 -1.55e+00 -1.35e-02 -3.61e-02
  -3.51e-04]]
SymNet parameters
[-0.19]
finally, finish this stage
iter:     0    time: 80.04
Func: 7.25e-01  |g|: 1.84e+03
stableloss: 5.27e-02   dataloss: 6.84e-01   sparseloss: 2.36e+02 momentloss: 6.87e+00
current expression:
[u00*u01, u10*v00, u20, u02, u00*u01**2, u01*u10*v00, u00*u11*v00, u10*v00*v10, 1, u10*v01, v00**2, u00, u01, u00**2*v00**2, u00*v00, v01*v10, u10*v10, u01*v00**2, u00**2, u10*v00*v01]
[-0.98 -0.98  0.05  0.05  0.01  0.01  0.01  0.01 -0.01  0.01  0.    0.   -0.   -0.
 -0.   -0.    0.   -0.    0.   -0.  ]
[v00*v10, u00*v01, v20, v02, v00*v10**2, v00, u00*u01*v01, u00*v01*v10, u00*v00*v11, u00, v10, u01, u00**2*v02, v00**3, 1, v10**2, u01*v00**2, u00**3, u00*v00*v01, u00*v11]
[-0.99 -0.98  0.05  0.05  0.01  0.01  0.01  0.01  0.01 -0.01 -0.   -0.    0.   -0.
 -0.    0.    0.    0.    0.    0.  ]
block:  9
name:  burgers-2-upwind-sparse0-noise0.001-id16
device:  cuda:0
generate a random number to check random seed:  -0.00765147198602012
current stage is: block-9
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.8818, device='cuda:0', dtype=torch.float64)
u_obs variance
tensor([ 0.2491,  1.7221,  1.7269, 21.6801, 10.4956, 20.6868,  0.2320,  1.5194,
         1.5636, 17.0604,  9.8619, 20.5067], device='cuda:0',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 1.889653
         Iterations: 0
         Function evaluations: 15
         Gradient evaluations: 3
convolution moment and kernels
[[ 1.00e+00  0.00e+00  1.30e-03 -1.93e-02 -4.86e-02]
 [ 0.00e+00 -3.23e-05 -1.19e-03 -2.97e-03  6.38e-03]
 [ 3.35e-04 -3.97e-03  1.87e-03  9.60e-03  9.89e-03]
 [-2.17e-02  2.02e-03  5.98e-03  1.32e-03 -1.23e-03]
 [-8.88e-02 -5.41e-02 -2.11e-03 -2.38e-04  4.52e-03]]
[[ 0.    0.01 -0.04 -0.06  0.01]
 [-0.   -0.06  0.23  0.19 -0.02]
 [-0.05  0.33  0.23 -0.   -0.04]
 [ 0.01 -0.13  0.37  0.13 -0.01]
 [-0.    0.03 -0.09 -0.04  0.01]]
[[ 0.    1.    0.   -0.1  -0.05]
 [ 0.    0.    0.01 -0.    0.01]
 [ 0.    0.02  0.01  0.01 -0.  ]
 [-0.01  0.   -0.    0.    0.  ]
 [-0.01 -0.02 -0.   -0.02 -0.  ]]
[[ 0.01  0.01 -0.03  0.03 -0.02]
 [-0.04  0.03  0.03 -0.05  0.06]
 [ 0.14 -0.62 -0.32  1.02 -0.27]
 [-0.03  0.03  0.03 -0.04  0.05]
 [ 0.01 -0.01 -0.02  0.01 -0.01]]
[[ 0.00e+00  0.00e+00  0.00e+00 -8.21e-03 -2.19e-03]
 [ 1.00e+00  0.00e+00  3.18e-02 -8.47e-06 -8.42e-03]
 [ 0.00e+00 -9.34e-03 -7.47e-03  9.20e-03 -2.75e-03]
 [-8.21e-02 -2.25e-03  3.74e-02  3.00e-03 -9.26e-04]
 [-7.49e-02 -9.30e-03 -1.63e-02  2.34e-02 -2.69e-03]]
[[-0.01 -0.01  0.11 -0.06  0.01]
 [ 0.05 -0.05 -0.56  0.14 -0.04]
 [-0.06  0.07 -0.32 -0.19  0.05]
 [ 0.04 -0.06  0.97  0.14 -0.05]
 [-0.02  0.04 -0.21 -0.02  0.01]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00 -3.36e-03]
 [ 0.00e+00  0.00e+00  0.00e+00 -5.65e-04 -2.71e-03]
 [ 0.00e+00  0.00e+00  1.32e-03  2.92e-03  5.30e-03]
 [ 0.00e+00 -6.01e-04 -1.94e-03  1.01e-03  2.86e-03]
 [ 1.33e-01  1.28e-03 -1.10e-03 -2.95e-03 -7.71e-03]]
[[-0.01  0.03  0.07  0.04 -0.01]
 [ 0.03 -0.14 -0.29 -0.19  0.05]
 [-0.13  1.54 -2.06  1.6  -0.16]
 [ 0.03 -0.1  -0.35 -0.14  0.04]
 [-0.    0.02  0.1   0.03 -0.01]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00 -4.09e-04]
 [ 0.00e+00  1.00e+00  0.00e+00 -3.05e-03 -4.66e-03]
 [ 0.00e+00  0.00e+00  6.70e-04 -2.77e-03 -1.33e-03]
 [ 0.00e+00 -2.47e-03  3.05e-04  4.61e-03  4.08e-03]
 [-6.82e-04 -1.25e-03 -1.52e-03  3.50e-03  4.98e-03]]
[[ 0.01 -0.07  0.02  0.04 -0.  ]
 [-0.06  0.5  -0.1  -0.36  0.03]
 [ 0.02 -0.11  0.22 -0.18  0.05]
 [ 0.04 -0.35 -0.19  0.6  -0.1 ]
 [-0.    0.03  0.05 -0.1   0.02]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  2.17e-02]
 [ 0.00e+00  0.00e+00  0.00e+00  1.53e-03 -1.08e-03]
 [ 1.00e+00  0.00e+00  3.02e-03  5.62e-03 -2.97e-03]
 [ 0.00e+00  5.34e-04 -1.46e-03 -1.43e-03  1.57e-03]
 [ 4.91e-03  6.15e-03 -1.65e-03 -4.10e-02 -3.77e-04]]
[[ 0.02 -0.04 -0.08  0.05 -0.02]
 [-0.09  0.2   1.29 -0.17  0.09]
 [ 0.16 -0.42 -2.27  0.15 -0.1 ]
 [-0.09  0.23  1.26 -0.16  0.08]
 [ 0.02 -0.05 -0.07  0.04 -0.02]]
SymNet parameters
[[ 3.70e-01 -1.17e+00 -7.33e-02 -2.89e-01 -6.39e-02 -1.87e-02 -1.17e+00  5.94e-02
  -5.95e-02 -1.46e-02 -1.17e-02  7.43e-03]
 [ 1.01e+00 -6.82e-03 -1.03e-01  2.74e-02  4.54e-02 -4.27e-03 -3.33e-01  6.27e-03
  -5.30e-02  5.29e-03  5.32e-04  3.54e-03]]
SymNet parameters
[ 1.8  -0.16]
SymNet parameters
[[-8.13e-01  1.48e-01  8.42e-01  5.27e-02 -2.16e-02  1.01e-02  2.63e-01 -3.46e-02
   1.22e-01 -1.91e-03  1.70e-03 -4.38e-03  1.32e-02]
 [ 2.67e-01 -1.21e-01 -1.83e-02 -1.02e-02  2.83e-03 -7.28e-04 -1.68e+00  7.92e-03
   9.30e-03 -3.38e-04 -6.28e-04  2.55e-03  4.08e-03]]
SymNet parameters
[0.35 2.56]
SymNet parameters
[[-1.28 -4.8   0.07 -0.4   1.03 -0.15  3.51 -0.48  0.77  0.01 -0.05  0.13 -0.18 -0.68]
 [-3.32  2.98  1.67 -2.44 -5.28  0.16  4.16  1.91 -3.47 -0.34  0.02 -0.32 -0.1   1.21]]
SymNet parameters
[0.05 0.25]
SymNet parameters
[[ 6.84e-01 -3.03e+00 -4.71e-02 -2.24e-01  7.22e-01 -1.04e-01  2.57e+00 -3.18e-01
   4.75e-01  1.33e-02 -3.13e-02  8.64e-02 -9.88e-02 -4.42e-01 -5.51e-05]
 [ 2.68e-01  2.43e+00  7.13e-01 -1.15e+00 -2.28e+00  6.21e-02  1.01e+00  9.23e-01
  -1.71e+00 -1.42e-01  5.64e-03 -1.38e-01  3.36e-03  6.13e-01  2.45e-04]]
SymNet parameters
[-0.31  0.43]
SymNet parameters
[[ 2.36e+00  2.67e+00 -5.03e-01  6.62e-01  2.46e+00 -6.40e-02 -6.18e+00 -6.98e-01
   1.59e+00  1.55e-01 -2.58e-02  1.39e-01  1.84e-01 -2.64e-01 -9.55e-04  6.21e-03]
 [-8.65e-01 -6.30e-01  5.79e-02 -6.03e-02  1.26e-01 -1.95e-02  3.50e-01 -5.75e-02
   8.52e-02  1.93e-03 -5.77e-03  1.65e-02 -4.62e-02 -9.62e-02 -2.73e-04  8.47e-04]]
SymNet parameters
[0.54 1.  ]
SymNet parameters
[[-0.16 -0.98 -1.46 -0.18 -0.3   0.04  1.25  0.12 -0.33 -0.02 -0.   -0.01  0.76  0.77
   0.05 -0.13  0.16]]
SymNet parameters
[-0.56]
SymNet parameters
[[-4.71e+00 -1.89e-01  4.18e-02  7.41e-03 -2.61e-03  1.03e-03  3.43e-01 -1.94e-03
   4.78e-01 -2.79e-03 -8.40e-03 -1.14e-02]
 [-7.10e+00  1.68e-01 -1.58e-02  8.56e-04 -4.96e-05  8.85e-03  2.51e-01 -1.61e-02
  -5.92e-01  2.84e-03  1.30e-02  1.10e-02]]
SymNet parameters
[ 0.54 -0.52]
SymNet parameters
[[ 7.82e+00  2.90e-01 -6.52e-02 -1.16e-02  4.37e-03 -1.74e-03 -8.16e-01 -3.73e-02
  -8.16e-01  5.07e-03  1.39e-02  1.65e-02  2.04e-04]
 [-9.61e+00  2.00e-01 -1.64e-02  1.91e-03 -4.61e-05  1.19e-02  4.44e-02  8.93e-03
  -8.28e-01  4.22e-03  1.74e-02  1.21e-02  7.72e-04]]
SymNet parameters
[-0.86 -0.59]
SymNet parameters
[[ 6.05e+00  7.88e-02 -1.29e-01  4.02e-04 -6.52e-03 -6.24e-03 -8.91e-02  2.18e-01
  -5.30e-02  2.65e-02  3.13e-02 -1.53e-01 -1.31e-01 -5.82e-02]
 [ 6.52e+00  1.75e-02  1.01e-01 -8.78e-03  1.12e-02 -3.20e-03 -5.85e-01 -1.22e-01
  -2.07e-02 -2.66e-02  5.50e-02  1.79e-01  1.34e-01  5.94e-02]]
SymNet parameters
[0.61 0.15]
SymNet parameters
[[ 5.91e-02 -1.37e-01  2.08e-02 -1.97e-03 -2.38e-03 -6.18e-03 -1.43e+00  3.40e-02
   4.11e-01 -1.07e-02 -2.20e-02  2.76e-03  2.19e-01  1.12e-01  2.19e-02]
 [-3.92e-01 -4.33e+00  6.90e-01  7.13e-02 -4.00e-02 -9.95e-02  4.92e+00 -5.87e-01
  -4.51e+00 -1.14e-01 -3.58e-01 -2.28e-01 -3.01e-01  1.30e-01  4.65e-01]]
SymNet parameters
[-0.78 -0.19]
SymNet parameters
[[ 1.35 -9.36  1.58  0.06 -0.13 -0.12 -2.27 -1.27  5.49 -0.82 -0.75 -0.59  0.77  0.75
   0.73 -0.01]
 [ 0.08  0.72 -0.3  -0.49 -0.48 -1.25 -0.79  0.46  0.27 -1.55 -4.33  3.31 -1.56  2.81
   5.13 -0.13]]
SymNet parameters
[-0.1  -0.22]
SymNet parameters
[[ 9.38e-01  2.48e-01 -4.44e-02 -6.35e-03  5.41e-04  3.91e-03  4.07e-01  1.28e-02
  -8.25e-03  5.24e-02  1.43e-02  6.58e-02 -3.47e+00 -1.55e+00 -1.35e-02 -3.61e-02
   4.33e-04]]
SymNet parameters
[-0.19]
finally, finish this stage
iter:     0    time: 81.36
Func: 1.89e+00  |g|: 3.17e+03
stableloss: 6.32e-02   dataloss: 1.83e+00   sparseloss: 2.36e+02 momentloss: 6.87e+00
current expression:
[u00*u01, u10*v00, u20, u02, u00*u01**2, u01*u10*v00, u00*u11*v00, u10*v00*v10, 1, u10*v01, v00**2, u00, u01, u00**2*v00**2, u00*v00, v01*v10, u10*v10, u01*v00**2, u00**2, u10*v00*v01]
[-0.98 -0.98  0.05  0.05  0.01  0.01  0.01  0.01 -0.01  0.01  0.    0.   -0.   -0.
 -0.   -0.    0.   -0.    0.   -0.  ]
[v00*v10, u00*v01, v20, v02, v00*v10**2, v00, u00*u01*v01, u00*v01*v10, u00*v00*v11, u00, v10, u01, u00**2*v02, v00**3, 1, v10**2, u01*v00**2, u00**3, u00*v00*v01, u00*v11]
[-0.99 -0.98  0.05  0.05  0.01  0.01  0.01  0.01  0.01 -0.01 -0.   -0.    0.   -0.
 -0.    0.    0.    0.    0.    0.  ]
u_obs.abs().max()
tensor(3.9595, device='cuda:0', dtype=torch.float64)
model(u_obs[0],T=50*dt).abs().max()
tensor(nan, device='cuda:0', dtype=torch.float64)
model(u_obs[0],T=100*dt).abs().max()
tensor(nan, device='cuda:0', dtype=torch.float64)
--name=burgers-2-upwind-sparse0-noise0.001-id20 --kernel_size=5 --viscosity=0.05 --blocks=0-6,9 --dataname=burgers --constraint=2 --device=cuda:0 --stablize=0 --sparsity=0 --momentsparsity=0.001 --data_start_time=1 --dt=1e-2 --max_dt=1/1600 --hidden_layers=5 --start_noise=0.001 --end_noise=0.001 --scheme=upwind
0
--name=burgers-2-upwind-sparse0-noise0.001-id21 --kernel_size=5 --viscosity=0.05 --blocks=0-6,9 --dataname=burgers --constraint=2 --device=cuda:1 --stablize=0 --sparsity=0 --momentsparsity=0.001 --data_start_time=1 --dt=1e-2 --max_dt=1/1600 --hidden_layers=5 --start_noise=0.001 --end_noise=0.001 --scheme=upwind
1
--name=burgers-2-upwind-sparse0-noise0.001-id22 --kernel_size=5 --viscosity=0.05 --blocks=0-6,9 --dataname=burgers --constraint=2 --device=cuda:2 --stablize=0 --sparsity=0 --momentsparsity=0.001 --data_start_time=1 --dt=1e-2 --max_dt=1/1600 --hidden_layers=5 --start_noise=0.001 --end_noise=0.001 --scheme=upwind
2
--name=burgers-2-upwind-sparse0-noise0.001-id23 --kernel_size=5 --viscosity=0.05 --blocks=0-6,9 --dataname=burgers --constraint=2 --device=cuda:3 --stablize=0 --sparsity=0 --momentsparsity=0.001 --data_start_time=1 --dt=1e-2 --max_dt=1/1600 --hidden_layers=5 --start_noise=0.001 --end_noise=0.001 --scheme=upwind
3
wait
{'--name': 'burgers-2-upwind-sparse0-noise0.001-id23', '--dtype': 'double', '--device': 'cuda:3', '--constraint': '2', '--dt': 0.01, '--cell_num': 1, '--eps': 6.283185307179586, '--blocks': [0, 1, 2, 3, 4, 5, 6, 9], '--kernel_size': 5, '--max_order': 2, '--dx': 0.19634954084936207, '--hidden_layers': 5, '--scheme': 'upwind', '--dataname': 'burgers', '--viscosity': 0.05, '--zoom': 4, '--max_dt': 0.000625, '--batch_size': 28, '--data_timescheme': 'rk2', '--channel_names': 'u,v', '--freq': 4, '--data_start_time': 1.0, '--start_noise': 0.001, '--end_noise': 0.001, '--stablize': 0.0, '--sparsity': 0.0, '--momentsparsity': 0.001, '--npseed': -1, '--torchseed': -1, '--maxiter': 2000, '--recordfile': 'None', '--recordcycle': 200, '--savecycle': -1, '--start_from': -1}
Traceback (most recent call last):
  File "train.py", line 58, in <module>
    globalnames, callback, model, data_model, sampling, addnoise = setenv.setenv(options)
  File "/data/users2/sajad/code/PDE-Net/setenv.py", line 68, in setenv
    globalnames, callback, model = _set_model(options)
  File "/data/users2/sajad/code/PDE-Net/setenv.py", line 45, in _set_model
    model.to(globalnames['device'])
  File "/home/users/mabavisani/anaconda3/envs/PDE-Net-2/lib/python3.7/site-packages/torch/nn/modules/module.py", line 386, in to
    return self._apply(convert)
  File "/home/users/mabavisani/anaconda3/envs/PDE-Net-2/lib/python3.7/site-packages/torch/nn/modules/module.py", line 193, in _apply
    module._apply(fn)
  File "/home/users/mabavisani/anaconda3/envs/PDE-Net-2/lib/python3.7/site-packages/torch/nn/modules/module.py", line 193, in _apply
    module._apply(fn)
  File "/home/users/mabavisani/anaconda3/envs/PDE-Net-2/lib/python3.7/site-packages/torch/nn/modules/module.py", line 205, in _apply
    self._buffers[key] = fn(buf)
  File "/home/users/mabavisani/anaconda3/envs/PDE-Net-2/lib/python3.7/site-packages/torch/nn/modules/module.py", line 384, in convert
    return t.to(device, dtype if t.is_floating_point() else None, non_blocking)
RuntimeError: CUDA error: invalid device ordinal
{'--name': 'burgers-2-upwind-sparse0-noise0.001-id20', '--dtype': 'double', '--device': 'cuda:0', '--constraint': '2', '--dt': 0.01, '--cell_num': 1, '--eps': 6.283185307179586, '--blocks': [0, 1, 2, 3, 4, 5, 6, 9], '--kernel_size': 5, '--max_order': 2, '--dx': 0.19634954084936207, '--hidden_layers': 5, '--scheme': 'upwind', '--dataname': 'burgers', '--viscosity': 0.05, '--zoom': 4, '--max_dt': 0.000625, '--batch_size': 28, '--data_timescheme': 'rk2', '--channel_names': 'u,v', '--freq': 4, '--data_start_time': 1.0, '--start_noise': 0.001, '--end_noise': 0.001, '--stablize': 0.0, '--sparsity': 0.0, '--momentsparsity': 0.001, '--npseed': -1, '--torchseed': -1, '--maxiter': 2000, '--recordfile': 'None', '--recordcycle': 200, '--savecycle': -1, '--start_from': -1}
block:  0
name:  burgers-2-upwind-sparse0-noise0.001-id20
device:  cuda:0
generate a random number to check random seed:  1.2256990537141859
current stage is: warmup
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.9041, device='cuda:0', dtype=torch.float64)
u_obs variance
tensor([ 0.2606,  2.1763,  1.9388, 20.5639,  9.8053, 16.8147,  0.2706,  2.0189,
         2.1666, 17.5269,  9.9270, 19.9598], device='cuda:0',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
iter:     0    time: 6.56
Func: 5.11e+00  |g|: 1.66e+00
stableloss: 5.03e-04   dataloss: 5.11e+00   sparseloss: 2.60e+01 momentloss: 7.27e+00
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 0.037249
         Iterations: 182
         Function evaluations: 251
         Gradient evaluations: 242
convolution moment and kernels
[[1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
[[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 1. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
[[ 0.    1.    0.   -0.33 -0.25]
 [ 0.    0.    0.    0.    0.  ]
 [ 0.    0.    0.    0.    0.  ]
 [ 0.    0.    0.    0.    0.  ]
 [ 0.    0.    0.    0.    0.  ]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]
 [ 2.78e-17  3.33e-16 -1.50e+00  2.00e+00 -5.00e-01]
 [ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]]
[[ 0.    0.    0.    0.    0.  ]
 [ 1.    0.    0.    0.    0.  ]
 [ 0.    0.    0.    0.    0.  ]
 [-0.33  0.    0.    0.    0.  ]
 [-0.25  0.    0.    0.    0.  ]]
[[ 0.00e+00  0.00e+00  2.78e-17  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  3.33e-16  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00 -1.50e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  2.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00 -5.00e-01  0.00e+00  0.00e+00]]
[[0.   0.   1.   0.   0.08]
 [0.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.  ]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]
 [-2.22e-16  1.00e+00 -2.00e+00  1.00e+00 -1.53e-16]
 [ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]]
[[0. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
[[ 6.94e-03 -5.56e-02  9.25e-18  5.56e-02 -6.94e-03]
 [-5.56e-02  4.44e-01 -7.40e-17 -4.44e-01  5.56e-02]
 [ 9.25e-18 -7.40e-17  1.23e-32  7.40e-17 -9.25e-18]
 [ 5.56e-02 -4.44e-01  7.40e-17  4.44e-01 -5.56e-02]
 [-6.94e-03  5.56e-02 -9.25e-18 -5.56e-02  6.94e-03]]
[[0.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.  ]
 [1.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.  ]
 [0.08 0.   0.   0.   0.  ]]
[[ 0.00e+00  0.00e+00 -2.22e-16  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  1.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00 -2.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  1.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00 -1.53e-16  0.00e+00  0.00e+00]]
SymNet parameters
[[-1.19e+00  2.21e-01  2.47e-01  4.85e-03 -6.98e-03  6.29e-03  1.30e+00  1.80e-02
  -2.92e-02 -7.70e-04  5.93e-03 -3.48e-03]
 [-2.93e-01  3.67e-01 -7.30e-01  1.31e-01  3.89e-02  5.99e-02 -1.67e-01 -2.26e-02
  -1.66e-02  9.06e-03  4.08e-02  3.47e-02]]
SymNet parameters
[-0.05  0.06]
SymNet parameters
[[ 0.18 -0.14 -0.13  0.03  0.36  0.01 -0.19  0.14  0.1   0.01 -0.14  0.03  0.12]
 [ 0.3   0.17 -0.31  0.2   0.16  0.09 -0.53  0.1  -0.15  0.43  0.06  0.26  0.05]]
SymNet parameters
[0.   0.07]
SymNet parameters
[[ 0.52  0.5   0.49  0.27  0.08  0.13 -0.18 -0.03 -0.06  0.02  0.09  0.07  0.02 -0.  ]
 [ 0.46  0.46  0.12 -0.08 -0.02 -0.04  0.45 -0.    0.04 -0.01 -0.03 -0.02 -0.02  0.01]]
SymNet parameters
[-0.04  0.17]
SymNet parameters
[[ 0.18  0.89  0.96 -0.45 -0.13 -0.21 -0.56  0.07  0.05 -0.02 -0.14 -0.12 -0.    0.01
   0.01]
 [ 1.21 -0.31 -0.52 -0.16 -0.05 -0.08  0.38  0.01  0.04 -0.01 -0.06 -0.04  0.01 -0.
   0.01]]
SymNet parameters
[-0.08 -0.18]
SymNet parameters
[[-0.25  0.12 -0.01  0.4   0.15  0.12 -0.21 -0.18  0.09  0.05  0.09  0.11 -0.01 -0.
   0.12  0.04]
 [ 0.14 -0.43 -0.01 -0.1  -0.04 -0.07  0.46  0.01 -0.04  0.02 -0.04 -0.04  0.07 -0.02
   0.07  0.02]]
SymNet parameters
[-0.2   0.23]
SymNet parameters
[[ 1.38e-02  2.75e-02 -2.53e-02  1.18e-01  2.35e-02  7.42e-02 -9.46e-02 -1.35e-02
  -4.62e-03  6.14e-03  2.26e-02  2.26e-02  5.91e-01 -3.68e-04 -5.95e-01 -2.80e-01
  -1.88e-01]]
SymNet parameters
[-0.01]
SymNet parameters
[[ 3.97e-02 -1.14e-01  1.28e-01  6.29e-02 -2.21e-02 -4.56e-04  4.20e-02  6.04e-01
  -3.71e-01 -9.01e-02 -1.13e-01 -9.86e-03]
 [-6.11e-01 -7.06e-02  1.01e-01  7.03e-03  1.15e-02 -3.34e-03 -7.63e-03  3.46e-02
  -1.10e-01  1.73e-02  1.98e-02  6.28e-03]]
SymNet parameters
[ 0.15 -0.11]
SymNet parameters
[[ 3.52e-01 -1.01e-02  9.68e-03  9.52e-03  1.47e-03  8.32e-03 -1.11e+00  1.03e-01
  -1.32e-02  4.59e-03 -6.93e-03 -4.83e-03 -3.25e-02]
 [-1.61e-02  1.38e-02 -3.01e-02 -6.31e-02 -5.16e-04 -8.64e-02 -8.51e-02 -4.54e-01
   1.24e+00 -1.00e-01 -3.19e-02  3.93e-02  1.31e-02]]
SymNet parameters
[-0.03 -0.22]
SymNet parameters
[[ 0.76 -0.13  0.11  0.05  0.01 -0.05 -0.34  0.69 -0.48 -0.05 -0.12 -0.03 -0.05  0.05]
 [ 0.21 -0.17  0.23 -0.    0.01 -0.03  0.42  0.27  0.48  0.02  0.05  0.03  0.08 -0.02]]
SymNet parameters
[-0.1  -0.01]
SymNet parameters
[[-0.13  0.08 -0.13 -0.13  0.   -0.16 -0.28  0.26  0.01 -0.18 -0.06  0.07  0.15 -0.02
   0.04]
 [-0.68 -0.01  0.01  0.01 -0.    0.01  0.18  0.12  0.07  0.02  0.01 -0.   -0.   -0.
   0.  ]]
SymNet parameters
[-0.51  0.31]
SymNet parameters
[[ 6.61e-02  5.64e-03  2.25e-02  6.86e-02  6.72e-04  1.17e-01  1.19e-01  9.00e-01
   4.78e-01  1.50e-01  7.14e-02 -4.80e-02 -1.06e-01 -1.15e-02 -1.29e-02  1.53e-02]
 [ 1.11e+00  2.97e-02 -3.63e-02 -3.37e-02 -1.76e-03 -3.01e-02  5.76e-01 -3.93e-02
   1.15e-01 -3.14e-02 -2.78e-03  1.52e-02  3.63e-02  3.29e-03  4.68e-03  8.64e-03]]
SymNet parameters
[-0.2   0.13]
SymNet parameters
[[-0.26 -0.02  0.03  0.04 -0.    0.05 -0.06  0.06  0.05  0.1   0.01  0.01  0.25  0.56
  -0.13  0.72 -0.5 ]]
SymNet parameters
[0.11]
finally, finish this stage
iter:   182    time: 14.53
Func: 3.72e-02  |g|: 1.56e-02
stableloss: 1.18e-02   dataloss: 3.72e-02   sparseloss: 5.00e+01 momentloss: 7.27e+00
current expression:
[u10*v00, u00*u01, u20, u02, u00*u10*v00, u00**2, u00, u00*u01**2, u01*u10*v00, 1, v00, u00*v01, u01*u02, u00**2*u10, u00*u01*v00, u01*u10, u00**2*u01, u00**2*v00, u10, u00*u02]
[-0.89 -0.88  0.04  0.04 -0.01  0.01 -0.01  0.01  0.01 -0.01 -0.    0.    0.    0.
 -0.    0.   -0.   -0.   -0.    0.  ]
[v00*v10, u00*v01, v02, v20, u00*v00*v01, v01, 1, u00*v00, v00*v10**2, u00*v00*v10, u00*v01*v10, u00**2*v00, u00*v00*v11, u00*v00*v02, v00, u10*v00*v01, u00*v00**2, u00*u10*v01, u01*v00*v01, u00**2]
[-0.89 -0.88  0.04  0.03 -0.01 -0.01  0.01 -0.01  0.01 -0.01  0.   -0.    0.    0.
  0.    0.    0.   -0.   -0.   -0.  ]
block:  1
name:  burgers-2-upwind-sparse0-noise0.001-id20
device:  cuda:0
generate a random number to check random seed:  -1.3149194874921926
current stage is: block-1
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.8390, device='cuda:0', dtype=torch.float64)
u_obs variance
tensor([ 0.2656,  2.2015,  2.1219, 20.3669, 10.0452, 18.7155,  0.2746,  2.1728,
         2.2735, 18.9406, 10.5357, 20.9991], device='cuda:0',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
iter:     0    time: 1265.34
Func: 4.93e-02  |g|: 8.62e-01
stableloss: 1.50e-02   dataloss: 4.21e-02   sparseloss: 5.00e+01 momentloss: 7.27e+00
iter:   200    time: 10.12
Func: 2.14e-02  |g|: 1.57e-02
stableloss: 1.07e-02   dataloss: 1.48e-02   sparseloss: 4.73e+01 momentloss: 6.58e+00
iter:   400    time: 10.02
Func: 2.06e-02  |g|: 3.79e-03
stableloss: 1.03e-02   dataloss: 1.41e-02   sparseloss: 5.08e+01 momentloss: 6.53e+00
iter:   600    time: 10.05
Func: 2.03e-02  |g|: 4.84e-03
stableloss: 1.06e-02   dataloss: 1.37e-02   sparseloss: 5.34e+01 momentloss: 6.57e+00
iter:   800    time: 10.00
Func: 2.01e-02  |g|: 3.39e-03
stableloss: 1.03e-02   dataloss: 1.36e-02   sparseloss: 5.95e+01 momentloss: 6.54e+00
iter:  1000    time: 10.41
Func: 2.00e-02  |g|: 2.18e-03
stableloss: 1.03e-02   dataloss: 1.35e-02   sparseloss: 6.28e+01 momentloss: 6.52e+00
iter:  1200    time: 10.04
Func: 2.00e-02  |g|: 1.47e-03
stableloss: 1.03e-02   dataloss: 1.35e-02   sparseloss: 6.29e+01 momentloss: 6.52e+00
iter:  1400    time: 9.96
Func: 2.00e-02  |g|: 2.20e-03
stableloss: 1.02e-02   dataloss: 1.35e-02   sparseloss: 6.52e+01 momentloss: 6.52e+00
iter:  1600    time: 9.95
Func: 2.00e-02  |g|: 1.13e-03
stableloss: 1.02e-02   dataloss: 1.34e-02   sparseloss: 6.64e+01 momentloss: 6.52e+00
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 0.019959
         Iterations: 1728
         Function evaluations: 1790
         Gradient evaluations: 1782
convolution moment and kernels
[[ 1.00e+00  0.00e+00  2.88e-04 -4.95e-02 -4.07e-02]
 [ 0.00e+00 -1.25e-05 -3.29e-03 -1.20e-03 -1.17e-03]
 [ 2.94e-05  2.32e-03  3.53e-03  2.45e-03 -6.54e-05]
 [ 1.13e-02  6.89e-04  1.49e-03  2.51e-04 -2.39e-03]
 [-5.55e-02 -1.26e-03 -1.62e-03 -5.81e-03  2.35e-03]]
[[ 6.66e-03 -2.27e-02 -3.31e-02 -1.27e-02  7.21e-04]
 [-2.54e-02  8.58e-02  1.30e-01  4.25e-02  7.32e-04]
 [ 1.92e-02 -1.37e-04  5.54e-01  1.63e-01 -6.91e-02]
 [-2.06e-02  6.20e-02  1.45e-01  2.09e-02  3.64e-03]
 [ 4.13e-03 -1.13e-02 -4.01e-02 -1.16e-03 -1.48e-03]]
[[ 0.00e+00  1.00e+00  0.00e+00 -8.80e-02 -6.05e-02]
 [ 0.00e+00  0.00e+00  1.32e-03 -1.26e-03 -3.73e-03]
 [ 0.00e+00  1.94e-03  6.72e-04  9.85e-03 -5.31e-03]
 [ 1.78e-03  6.70e-04  3.70e-04  1.44e-04 -2.73e-03]
 [ 1.29e-02 -2.29e-02 -2.92e-03 -2.31e-03 -4.57e-04]]
[[ 1.00e-03  4.03e-03  2.59e-02 -2.05e-02  1.59e-03]
 [-1.03e-02 -1.72e-03 -1.13e-01  7.78e-02 -2.71e-03]
 [ 8.64e-02 -5.24e-01 -1.75e-01  8.73e-01 -1.83e-01]
 [-9.02e-03 -3.36e-03 -1.16e-01  7.83e-02 -3.18e-03]
 [-1.24e-03  1.26e-02  1.46e-02 -1.18e-02 -4.13e-04]]
[[ 0.00e+00  0.00e+00  0.00e+00 -5.57e-03  1.03e-03]
 [ 1.00e+00  0.00e+00  1.43e-02 -3.77e-03 -7.52e-03]
 [ 0.00e+00  4.20e-04  1.91e-03 -4.87e-04 -1.35e-03]
 [-1.15e-01  2.56e-03  1.57e-02  4.32e-03 -7.14e-03]
 [-7.24e-02  1.70e-03 -1.09e-02  2.35e-04 -1.54e-03]]
[[ 4.13e-03 -3.22e-02  1.22e-01 -2.73e-02  1.86e-03]
 [-5.07e-03  6.87e-02 -6.10e-01  5.32e-02  7.94e-04]
 [ 3.26e-03 -8.34e-02 -2.88e-01 -6.53e-02 -1.20e-03]
 [ 6.63e-03  2.48e-02  1.01e+00  2.99e-02 -3.27e-04]
 [-5.13e-03  1.24e-02 -2.28e-01  1.08e-02 -2.87e-03]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00 -4.86e-04]
 [ 0.00e+00  0.00e+00  0.00e+00 -4.10e-04 -2.85e-03]
 [ 0.00e+00  0.00e+00  2.63e-03  1.47e-03  4.63e-04]
 [ 0.00e+00 -5.10e-04  1.74e-03  2.42e-04  4.23e-04]
 [ 2.85e-02 -1.69e-03 -1.85e-03 -1.10e-03 -6.33e-03]]
[[-0.01  0.02 -0.01  0.02 -0.01]
 [ 0.02 -0.09  0.02 -0.1   0.03]
 [-0.12  1.46 -2.52  1.47 -0.13]
 [ 0.02 -0.08  0.   -0.08  0.03]
 [-0.01  0.02 -0.    0.02 -0.01]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00 -1.75e-03]
 [ 0.00e+00  1.00e+00  0.00e+00 -1.03e-03 -7.81e-04]
 [ 0.00e+00  0.00e+00 -3.90e-04 -2.29e-05  1.95e-03]
 [ 0.00e+00 -1.97e-03 -3.85e-04  2.46e-03  1.66e-03]
 [ 9.45e-04  2.09e-03  1.93e-04 -7.68e-04 -2.57e-03]]
[[ 0.   -0.04 -0.02  0.07 -0.01]
 [-0.04  0.4   0.09 -0.52  0.07]
 [-0.02  0.08 -0.13  0.1  -0.03]
 [ 0.07 -0.48  0.06  0.4  -0.04]
 [-0.01  0.06 -0.01 -0.05  0.01]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  2.91e-03]
 [ 0.00e+00  0.00e+00  0.00e+00 -2.26e-04 -7.07e-04]
 [ 1.00e+00  0.00e+00  2.30e-03  9.55e-04  2.61e-04]
 [ 0.00e+00  2.78e-04  1.93e-03 -3.61e-04 -3.52e-04]
 [ 2.68e-04 -2.27e-03  2.41e-04 -5.53e-04 -7.01e-03]]
[[-0.01  0.03 -0.12  0.03 -0.01]
 [ 0.03 -0.11  1.49 -0.11  0.03]
 [-0.04  0.16 -2.73  0.15 -0.04]
 [ 0.03 -0.11  1.5  -0.11  0.03]
 [-0.01  0.03 -0.13  0.03 -0.01]]
SymNet parameters
[[-1.00e-01 -9.39e-03  5.96e-02  4.88e-02  9.57e-03  5.55e-03  2.28e+00  6.18e-03
  -3.88e-02 -4.73e-04  3.51e-03  3.61e-03]
 [-3.12e-01 -5.99e-02 -6.79e-01  3.83e-02 -1.36e-02  3.07e-03 -1.25e-01 -3.42e-02
  -4.67e-02 -6.72e-04  2.76e-03  3.71e-03]]
SymNet parameters
[-0.04  0.21]
SymNet parameters
[[-7.26e-01 -1.41e-01 -1.66e+00  7.60e-02  6.13e-02 -1.42e-03 -3.11e-01 -7.67e-02
  -1.70e-01 -7.60e-05  2.92e-03  1.55e-02  2.86e-03]
 [ 5.70e-02  1.99e-02 -4.48e-02 -3.42e-02 -5.76e-03 -3.61e-04 -1.89e+00  9.01e-02
   5.84e-02 -4.86e-04 -4.07e-04 -5.49e-03  1.78e-03]]
SymNet parameters
[-0.28  0.28]
SymNet parameters
[[-0.17  1.29  0.21  0.23  0.05  0.03 -0.92 -0.18 -0.02 -0.01  0.01  0.03  0.23  0.14]
 [ 0.67  0.23 -0.12  0.03  0.01  0.01  0.29 -0.02  0.07 -0.    0.    0.    0.05  0.04]]
SymNet parameters
[-0.06  0.22]
SymNet parameters
[[-1.76e-01  2.78e+00 -3.80e-01 -7.03e-01 -1.47e-01 -3.92e-02 -3.10e-01  6.13e-01
   4.73e-01  9.56e-03 -2.95e-02 -8.88e-02  1.49e-01 -4.73e-02  5.12e-02]
 [ 1.02e+00 -1.01e+00  2.21e-01 -1.52e-02 -5.81e-04  1.06e-02 -4.99e-01  3.36e-02
   9.39e-02 -1.88e-03  4.13e-03  3.97e-03 -7.39e-02 -7.75e-02  1.83e-03]]
SymNet parameters
[-0.09 -0.23]
SymNet parameters
[[-1.89e+00 -3.52e-01  6.32e-02  9.30e-01  2.41e-01  1.40e-01  7.08e-01 -7.16e-01
   2.73e-01 -2.67e-02  5.16e-02  1.33e-01  4.12e-01  3.48e-01  5.57e-02  9.03e-03]
 [-5.78e-01 -1.20e+00  9.84e-02 -5.03e-02 -1.51e-02 -2.19e-03 -5.88e-02  3.86e-02
  -4.64e-02  1.20e-03  3.27e-04 -2.84e-03 -1.51e-01 -1.17e-01  2.90e-02 -1.71e-03]]
SymNet parameters
[-0.3   0.46]
SymNet parameters
[[-0.15  0.13 -0.03  0.14  0.02  0.06 -0.16 -0.08 -0.01 -0.    0.    0.01  0.33 -0.1
  -0.61 -0.08 -0.1 ]]
SymNet parameters
[-0.03]
SymNet parameters
[[-4.98e-02 -2.60e-02  2.19e-01 -2.82e-02 -2.27e-02  2.50e-02 -2.15e-01  1.79e+00
  -1.30e-01 -3.87e-03 -5.42e-02 -2.77e-01]
 [-4.80e-01  3.88e-03  1.50e-02 -1.36e-04  2.43e-04  5.12e-04 -2.92e-02 -9.13e-03
  -2.61e-02 -4.25e-04 -6.78e-04 -2.24e-04]]
SymNet parameters
[ 0.16 -0.02]
SymNet parameters
[[ 0.12 -0.02  0.06 -0.01 -0.    0.01 -1.24  0.52  0.22  0.02  0.02 -0.06  0.01]
 [ 0.84  0.44  0.18 -0.   -0.01 -0.01 -0.59 -0.39  0.92  0.02 -0.02 -0.13  0.02]]
SymNet parameters
[ 0.41 -0.49]
SymNet parameters
[[ 1.74e+00 -1.47e-02 -3.93e-03  2.17e-03  1.76e-03 -3.74e-03  8.81e-02  5.95e-02
   8.09e-02  9.51e-05  2.64e-03  1.99e-02 -5.78e-03 -3.65e-03]
 [ 1.68e-01  1.01e-01  2.69e-01 -2.73e-02 -2.66e-02  2.64e-02 -4.21e-01  1.70e+00
   7.24e-02  9.27e-04  1.15e-02 -3.00e-01  1.16e-02  2.39e-03]]
SymNet parameters
[ 0.08 -0.26]
SymNet parameters
[[-6.04e-01 -5.69e-02 -1.97e-01  2.12e-02  2.15e-02 -2.07e-02 -5.46e-01  9.86e-01
  -1.65e+00 -3.95e-03 -2.53e-03  2.32e-01  5.35e-01 -9.98e-02  1.71e-01]
 [-3.69e-01 -9.22e-04 -1.11e-02  1.43e-03  9.43e-04 -1.40e-03  8.11e-01  2.76e-02
   4.72e-02 -2.26e-04  5.38e-04  1.22e-02  3.40e-02 -6.10e-04  1.39e-02]]
SymNet parameters
[-0.62  0.22]
SymNet parameters
[[ 2.75e-01 -4.66e-02 -2.07e-01  2.23e-02  2.21e-02 -2.21e-02 -5.44e-01  8.56e-01
   1.09e+00 -2.50e-03 -2.56e-03  2.46e-01 -3.77e-01 -9.34e-02 -9.54e-02  6.79e-03]
 [ 6.21e-01 -7.13e-03 -1.90e-02  1.53e-03  2.22e-03 -1.65e-03  9.46e-01 -2.21e-02
  -7.55e-02 -1.28e-03 -3.04e-04  2.22e-02  1.11e-02 -3.78e-03  1.55e-03  1.74e-02]]
SymNet parameters
[-0.29 -0.12]
SymNet parameters
[[-1.71e-01  1.09e-02  3.26e-02 -3.25e-03 -4.03e-03  3.54e-03  1.98e-01 -9.69e-02
   1.23e-01  5.19e-02 -3.02e-04  9.38e-03  9.94e-02  7.60e-03 -1.71e-01  4.25e-01
  -3.77e-01]]
SymNet parameters
[0.06]
finally, finish this stage
iter:  1728    time: 8.50
Func: 2.00e-02  |g|: 8.50e-04
stableloss: 1.02e-02   dataloss: 1.34e-02   sparseloss: 6.73e+01 momentloss: 6.53e+00
current expression:
[u00*u01, u10*v00, u20, u02, u00*u01**2, u00*u11*v00, u01*u10*v00, u10*v00*v10, u00*u10*v01, u00, u10*v01, v10, u01, u00**2*v01, u10, u00**2*u01, v00**2*v10, u00*v00**2, u00*u10*v10, u00**3]
[-0.98 -0.97  0.05  0.05  0.01  0.01  0.01  0.01  0.01  0.01  0.   -0.   -0.    0.
  0.    0.    0.   -0.    0.   -0.  ]
[u00*v01, v00*v10, v02, v20, v00, v00*v10**2, u00*v00*v11, u10*v00*v01, u00*v01*v10, u00*u01*v01, v01*v10, u00*v00, 1, v00**3, u01*v01, u00, v00**2*v10, u01*v00, u00*u10, u01*v00**2]
[-0.98 -0.97  0.05  0.05  0.02  0.01  0.01  0.01  0.01  0.01  0.   -0.   -0.   -0.
  0.    0.    0.   -0.   -0.    0.  ]
block:  2
name:  burgers-2-upwind-sparse0-noise0.001-id20
device:  cuda:0
generate a random number to check random seed:  0.16872220599223775
current stage is: block-2
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.8509, device='cuda:0', dtype=torch.float64)
u_obs variance
tensor([ 0.2630,  1.7886,  1.7465, 23.9420, 11.0166, 20.2318,  0.2567,  1.7241,
         1.6887, 20.0811,  9.9062, 21.9136], device='cuda:0',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
iter:     0    time: 446.69
Func: 7.61e-02  |g|: 9.53e-01
stableloss: 2.54e-02   dataloss: 6.31e-02   sparseloss: 6.73e+01 momentloss: 6.53e+00
iter:   200    time: 14.62
Func: 6.63e-02  |g|: 3.25e-02
stableloss: 2.47e-02   dataloss: 5.17e-02   sparseloss: 6.94e+01 momentloss: 7.26e+00
iter:   400    time: 14.64
Func: 6.56e-02  |g|: 1.85e-02
stableloss: 2.46e-02   dataloss: 5.11e-02   sparseloss: 7.33e+01 momentloss: 7.26e+00
iter:   600    time: 14.68
Func: 6.53e-02  |g|: 3.35e-02
stableloss: 2.48e-02   dataloss: 5.09e-02   sparseloss: 8.03e+01 momentloss: 7.23e+00
iter:   800    time: 14.63
Func: 6.51e-02  |g|: 3.08e-02
stableloss: 2.48e-02   dataloss: 5.07e-02   sparseloss: 8.72e+01 momentloss: 7.20e+00
iter:  1000    time: 14.56
Func: 6.49e-02  |g|: 6.03e-03
stableloss: 2.47e-02   dataloss: 5.05e-02   sparseloss: 9.01e+01 momentloss: 7.19e+00
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 0.064919
         Iterations: 1002
         Function evaluations: 1064
         Gradient evaluations: 1057
convolution moment and kernels
[[ 1.00e+00  0.00e+00 -4.28e-04 -1.81e-02 -6.28e-02]
 [ 0.00e+00  2.98e-03 -2.44e-04 -2.86e-03 -9.16e-03]
 [-4.47e-05  7.80e-04  1.73e-02  3.66e-03 -7.90e-03]
 [ 1.71e-02 -2.74e-03 -9.58e-04  2.00e-03 -1.47e-03]
 [-7.42e-02 -2.68e-02 -5.27e-03 -6.11e-03  2.27e-03]]
[[ 0.01 -0.01 -0.05 -0.03  0.  ]
 [-0.03  0.08  0.12  0.15 -0.01]
 [-0.    0.06  0.57 -0.03 -0.04]
 [-0.03  0.11  0.02  0.21 -0.02]
 [ 0.   -0.01 -0.03 -0.04  0.  ]]
[[ 0.00e+00  1.00e+00  0.00e+00 -9.42e-02 -6.44e-02]
 [ 0.00e+00  0.00e+00 -3.25e-03 -7.04e-03 -1.22e-03]
 [ 0.00e+00  1.24e-02  9.12e-03  8.57e-04 -8.30e-03]
 [-5.47e-03 -1.72e-03  4.83e-03 -7.73e-03 -8.09e-03]
 [ 1.04e-02 -1.24e-02 -3.61e-04 -7.27e-03 -4.09e-03]]
[[ 1.85e-03 -2.94e-03  2.59e-02 -1.16e-02 -1.18e-04]
 [-1.19e-02  1.97e-02 -1.10e-01  5.12e-02  4.51e-03]
 [ 7.84e-02 -4.97e-01 -2.85e-01  9.76e-01 -2.11e-01]
 [ 1.05e-03 -5.34e-02  2.29e-02 -2.95e-02  2.30e-02]
 [-3.36e-03  3.04e-02 -4.03e-02  3.25e-02 -1.16e-02]]
[[ 0.    0.    0.    0.01  0.01]
 [ 1.    0.    0.03  0.   -0.01]
 [ 0.   -0.   -0.01 -0.01 -0.  ]
 [-0.09 -0.    0.03 -0.   -0.  ]
 [-0.08 -0.   -0.02 -0.01 -0.01]]
[[-4.12e-04 -1.84e-02  8.80e-02 -1.12e-02 -5.17e-03]
 [ 1.17e-02 -3.81e-03 -4.68e-01 -2.11e-02  2.57e-02]
 [-4.44e-03 -3.83e-02 -3.60e-01 -2.85e-02 -1.93e-02]
 [ 4.24e-03  4.62e-03  1.04e+00 -1.78e-02  2.39e-02]
 [-3.88e-03  1.92e-02 -2.34e-01  2.61e-02 -1.00e-02]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00 -1.75e-03]
 [ 0.00e+00  0.00e+00  0.00e+00 -1.93e-03 -7.06e-02]
 [ 0.00e+00  0.00e+00  2.24e-03  8.26e-04 -7.25e-05]
 [ 0.00e+00 -5.24e-04  3.56e-04 -1.04e-03  8.55e-03]
 [ 3.14e-02 -5.25e-04  1.36e-03  1.22e-03  1.51e-03]]
[[-0.01  0.04 -0.02  0.03 -0.01]
 [ 0.05 -0.21  0.18 -0.2   0.05]
 [-0.08  1.31 -2.27  1.3  -0.07]
 [-0.06  0.24 -0.49  0.25 -0.06]
 [ 0.01 -0.04  0.1  -0.05  0.01]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00 -1.45e-03]
 [ 0.00e+00  1.00e+00  0.00e+00 -9.25e-05  3.62e-01]
 [ 0.00e+00  0.00e+00 -1.21e-03  4.38e-03  1.57e-03]
 [ 0.00e+00 -5.88e-04 -9.59e-04  3.10e-03 -1.00e-01]
 [-5.78e-03  7.75e-03  5.16e-03 -2.62e-02 -5.45e-03]]
[[ 9.59e-02 -3.80e-01  4.28e-01 -2.02e-01  5.26e-02]
 [-4.31e-01  1.82e+00 -1.83e+00  6.61e-01 -2.01e-01]
 [ 4.70e-02 -1.37e-03 -3.48e-01  3.97e-01 -1.29e-01]
 [ 3.67e-01 -1.81e+00  2.27e+00 -1.17e+00  3.68e-01]
 [-8.01e-02  3.76e-01 -5.33e-01  3.24e-01 -9.25e-02]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  1.08e-02]
 [ 0.00e+00  0.00e+00  0.00e+00 -3.63e-03 -4.64e-04]
 [ 1.00e+00  0.00e+00  5.61e-03 -8.31e-04 -3.52e-03]
 [ 0.00e+00  9.92e-04 -3.24e-04  1.89e-03  3.70e-03]
 [ 5.53e-03 -2.68e-03 -6.87e-03  2.43e-03  8.79e-05]]
[[-1.80e-03 -1.65e-04 -6.89e-02 -6.90e-03 -2.12e-05]
 [ 3.08e-04  3.60e-02  1.22e+00  6.46e-02 -8.15e-03]
 [ 1.51e-02 -1.27e-01 -2.21e+00 -1.82e-01  3.44e-02]
 [-3.63e-03  6.17e-02  1.17e+00  1.05e-01 -2.04e-02]
 [ 8.44e-04 -1.39e-02 -4.54e-02 -2.43e-02  4.95e-03]]
SymNet parameters
[[-1.81e-01  1.38e-02  6.08e-02 -7.98e-02  4.42e-02  6.29e-03  2.47e+00  2.30e-01
   3.11e-02 -9.80e-03 -4.03e-03 -4.23e-03]
 [-4.76e-02 -3.01e-02 -4.20e-01  3.93e-02 -3.84e-02  3.41e-03 -7.15e-02 -2.74e-02
  -2.76e-02 -6.58e-04  3.52e-04  2.57e-03]]
SymNet parameters
[-0.02  0.96]
SymNet parameters
[[-1.73e-01 -2.68e-01 -2.03e+00  1.60e-01 -4.57e-02 -6.85e-03 -3.18e-01 -1.58e-01
  -1.22e-01  8.13e-03  1.81e-03  1.16e-02 -6.90e-04]
 [ 1.46e-01 -2.38e-02 -3.97e-02  3.19e-02 -1.23e-02 -2.66e-03 -1.87e+00 -1.62e-02
  -2.16e-02  7.33e-04  8.75e-04  3.47e-03  2.44e-03]]
SymNet parameters
[-0.44  0.23]
SymNet parameters
[[ 1.24e-01  2.29e+00  3.03e-01  2.96e-01 -4.39e-03 -1.26e-02 -9.38e-02 -2.78e-01
   3.69e-01  5.67e-02  4.53e-03  4.41e-02  5.42e-01  1.91e-01]
 [ 7.96e-01  3.25e-01  1.50e-01  3.87e-03  2.66e-02  1.62e-03  2.90e-01  5.50e-03
   1.45e-01  1.14e-02 -5.59e-04  5.83e-03  9.17e-02  3.17e-02]]
SymNet parameters
[0.12 0.21]
SymNet parameters
[[ 2.07e+00  3.09e+00  1.41e+00 -8.43e-01  3.31e-01  7.17e-02  1.71e+00  7.98e-01
   7.92e-01 -1.44e-02 -5.61e-03 -6.16e-02  2.26e-01  1.11e-02  7.95e-02]
 [-7.68e-01 -2.27e+00 -7.18e-01  8.07e-02 -2.79e-02  9.91e-03 -8.94e-01 -2.86e-02
  -7.83e-02  5.10e-03  2.72e-03 -4.65e-04 -3.66e-01 -1.34e-01 -3.12e-02]]
SymNet parameters
[-0.04 -0.35]
SymNet parameters
[[-4.01e-01  5.56e-01 -3.08e-01  1.51e+00 -8.91e-02 -5.57e-02  9.73e-01 -1.25e+00
   1.29e+00  2.40e-01  1.23e-02  1.97e-01  1.09e+00  4.63e-01 -9.92e-03  1.12e-02]
 [-1.07e+00 -1.03e+00 -2.83e-01  8.44e-03 -3.78e-02  1.43e-04 -1.85e-01 -6.23e-03
  -2.02e-01 -1.40e-02  1.19e-03 -7.32e-03 -2.12e-01 -7.30e-02  7.37e-03 -1.25e-03]]
SymNet parameters
[-0.09  0.54]
SymNet parameters
[[ 0.02  0.4  -0.11  0.26 -0.02  0.04  0.02 -0.2   0.16  0.03  0.    0.03  0.29 -0.2
  -0.83 -0.07 -0.16]]
SymNet parameters
[-0.01]
SymNet parameters
[[-6.99e-01  1.09e-01  2.88e-01 -1.30e-01  3.97e-02  2.26e-02 -8.46e-01  1.89e+00
   7.74e-02 -7.43e-02  8.05e-02 -4.24e-01]
 [-5.48e-02 -5.04e-04  1.03e-02  1.51e-03  7.46e-05  7.31e-05 -1.70e-02  1.98e-02
  -4.99e-03 -4.13e-04 -3.04e-04  6.28e-03]]
SymNet parameters
[0.09 0.28]
SymNet parameters
[[ 0.15 -0.11  0.11 -0.06  0.03  0.01 -1.57  0.75  0.37  0.04  0.02 -0.07 -0.15]
 [ 0.66  0.45 -0.07 -0.11  0.02  0.01 -0.9  -1.05  1.27  0.09  0.04 -0.17 -0.44]]
SymNet parameters
[ 0.37 -0.59]
SymNet parameters
[[ 1.67e+00  2.84e-02  1.05e-02 -3.50e-03  1.36e-03 -7.82e-04  2.93e-01 -2.54e-01
   5.38e-02  9.67e-03  2.24e-02  3.11e-04  1.25e-01  1.01e-02]
 [ 1.61e-01  3.50e-01  1.50e-01 -1.47e-01  3.08e-02  2.35e-02 -1.72e+00  1.20e+00
   5.31e-01  2.77e-02  3.28e-01 -3.29e-01 -2.42e-01  5.79e-04]]
SymNet parameters
[-0.  -0.2]
SymNet parameters
[[-1.27 -0.15 -0.07  0.07 -0.02 -0.01 -1.13  1.23 -1.41 -0.01 -0.15  0.15  0.18 -0.04
   0.02]
 [-0.69 -0.03 -0.    0.01 -0.   -0.    0.78  0.12  0.16 -0.   -0.03  0.02 -0.03 -0.
  -0.  ]]
SymNet parameters
[-0.62  0.17]
SymNet parameters
[[ 1.02e+00 -8.77e-02 -8.32e-03  2.63e-02 -2.33e-03 -5.03e-03 -7.33e-01  1.02e+00
   9.94e-01 -2.19e-02 -8.42e-02  3.52e-02 -4.70e-01 -2.22e-02 -2.89e-02  1.22e-02]
 [ 5.73e-01 -5.88e-03 -7.67e-03  2.25e-03 -2.26e-04 -7.94e-04  9.74e-01  2.25e-01
  -1.66e-01 -2.00e-03 -1.03e-02  5.95e-03 -2.44e-02 -4.68e-04 -1.54e-03  1.73e-02]]
SymNet parameters
[-0.34 -0.06]
SymNet parameters
[[-2.47e-01  3.85e-03  1.12e-02 -2.89e-03  1.45e-03  4.29e-04  1.12e-01 -8.99e-02
   1.28e-01  5.28e-02  5.66e-03  4.07e-02 -3.26e-03  1.42e-02 -1.54e-01  3.75e-01
  -4.44e-01]]
SymNet parameters
[0.05]
finally, finish this stage
iter:  1002    time: 3.92
Func: 6.49e-02  |g|: 5.60e-03
stableloss: 2.47e-02   dataloss: 5.05e-02   sparseloss: 9.01e+01 momentloss: 7.19e+00
current expression:
[u10*v00, u00*u01, u20, u02, u00*u01**2, u01*u10*v00, u10*v00*v10, u00*u10*v01, u00*u11*v00, u00, u01*u10, u01**2*v00, v00*v10, u01*v00**2, 1, u10*v00**2, u20*v00, u00**3, u10, u00**2*u02]
[-0.98 -0.97  0.05  0.05  0.01  0.01  0.01  0.01  0.01  0.01 -0.    0.    0.    0.
 -0.    0.    0.   -0.    0.    0.  ]
[v00*v10, u00*v01, v02, v20, v00*v10**2, v10, v00, u00*v00*v11, u00*v01*v10, u00*u01*v01, u10*v00*v01, v10**2, u10, v01, u10*v00**2, u00**2*v10, u00*v10**2, u00*v10, u00, u10*v00]
[-0.99 -0.98  0.05  0.05  0.02  0.01  0.01  0.01  0.01  0.01  0.01 -0.01  0.01  0.
 -0.   -0.    0.   -0.    0.    0.  ]
block:  3
name:  burgers-2-upwind-sparse0-noise0.001-id20
device:  cuda:0
generate a random number to check random seed:  -0.747162570485204
current stage is: block-3
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.8192, device='cuda:0', dtype=torch.float64)
u_obs variance
tensor([ 0.2623,  1.8166,  1.7789, 24.0718, 12.6145, 20.8328,  0.2445,  1.5130,
         1.6072, 17.5886, 10.9780, 20.5505], device='cuda:0',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 0.163750
         Iterations: 0
         Function evaluations: 15
         Gradient evaluations: 3
convolution moment and kernels
[[ 1.00e+00  0.00e+00 -4.28e-04 -1.81e-02 -6.28e-02]
 [ 0.00e+00  2.98e-03 -2.47e-04 -2.86e-03 -9.15e-03]
 [-4.65e-05  7.80e-04  1.73e-02  3.66e-03 -7.90e-03]
 [ 1.71e-02 -2.73e-03 -9.53e-04  2.00e-03 -1.48e-03]
 [-7.42e-02 -2.68e-02 -5.27e-03 -6.10e-03  2.25e-03]]
[[ 0.01 -0.01 -0.05 -0.03  0.  ]
 [-0.03  0.08  0.12  0.15 -0.01]
 [-0.    0.06  0.57 -0.03 -0.04]
 [-0.03  0.11  0.02  0.21 -0.02]
 [ 0.   -0.01 -0.03 -0.04  0.  ]]
[[ 0.00e+00  1.00e+00  0.00e+00 -9.42e-02 -6.44e-02]
 [ 0.00e+00  0.00e+00 -3.26e-03 -7.05e-03 -1.20e-03]
 [ 0.00e+00  1.24e-02  9.12e-03  8.61e-04 -8.29e-03]
 [-5.47e-03 -1.72e-03  4.83e-03 -7.73e-03 -8.11e-03]
 [ 1.03e-02 -1.24e-02 -3.47e-04 -7.28e-03 -4.11e-03]]
[[ 1.84e-03 -2.89e-03  2.58e-02 -1.15e-02 -1.42e-04]
 [-1.19e-02  1.94e-02 -1.10e-01  5.07e-02  4.64e-03]
 [ 7.82e-02 -4.96e-01 -2.86e-01  9.77e-01 -2.11e-01]
 [ 1.16e-03 -5.40e-02  2.40e-02 -3.02e-02  2.32e-02]
 [-3.38e-03  3.05e-02 -4.06e-02  3.27e-02 -1.16e-02]]
[[ 0.    0.    0.    0.01  0.01]
 [ 1.    0.    0.03  0.   -0.01]
 [ 0.   -0.   -0.01 -0.01 -0.  ]
 [-0.09 -0.    0.03 -0.   -0.  ]
 [-0.08 -0.   -0.02 -0.01 -0.01]]
[[-4.34e-04 -1.83e-02  8.79e-02 -1.11e-02 -5.18e-03]
 [ 1.18e-02 -4.30e-03 -4.67e-01 -2.15e-02  2.58e-02]
 [-4.69e-03 -3.73e-02 -3.62e-01 -2.77e-02 -1.95e-02]
 [ 4.43e-03  3.83e-03  1.04e+00 -1.85e-02  2.40e-02]
 [-3.93e-03  1.93e-02 -2.35e-01  2.63e-02 -1.01e-02]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00 -1.75e-03]
 [ 0.00e+00  0.00e+00  0.00e+00 -1.93e-03 -7.06e-02]
 [ 0.00e+00  0.00e+00  2.23e-03  8.24e-04 -7.00e-05]
 [ 0.00e+00 -5.24e-04  3.58e-04 -1.04e-03  8.54e-03]
 [ 3.14e-02 -5.24e-04  1.36e-03  1.22e-03  1.50e-03]]
[[-0.01  0.04 -0.02  0.03 -0.01]
 [ 0.05 -0.21  0.18 -0.2   0.05]
 [-0.08  1.31 -2.27  1.3  -0.07]
 [-0.06  0.24 -0.49  0.25 -0.06]
 [ 0.01 -0.04  0.1  -0.05  0.01]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00 -1.45e-03]
 [ 0.00e+00  1.00e+00  0.00e+00 -9.23e-05  3.62e-01]
 [ 0.00e+00  0.00e+00 -1.21e-03  4.38e-03  1.57e-03]
 [ 0.00e+00 -5.87e-04 -9.60e-04  3.10e-03 -1.00e-01]
 [-5.78e-03  7.75e-03  5.16e-03 -2.62e-02 -5.45e-03]]
[[ 9.59e-02 -3.80e-01  4.28e-01 -2.02e-01  5.26e-02]
 [-4.31e-01  1.82e+00 -1.83e+00  6.61e-01 -2.01e-01]
 [ 4.70e-02 -1.39e-03 -3.48e-01  3.97e-01 -1.29e-01]
 [ 3.67e-01 -1.81e+00  2.27e+00 -1.17e+00  3.68e-01]
 [-8.01e-02  3.76e-01 -5.33e-01  3.24e-01 -9.25e-02]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  1.08e-02]
 [ 0.00e+00  0.00e+00  0.00e+00 -3.63e-03 -4.59e-04]
 [ 1.00e+00  0.00e+00  5.61e-03 -8.32e-04 -3.52e-03]
 [ 0.00e+00  9.91e-04 -3.22e-04  1.89e-03  3.70e-03]
 [ 5.53e-03 -2.68e-03 -6.87e-03  2.43e-03  8.27e-05]]
[[-1.80e-03 -1.53e-04 -6.89e-02 -6.89e-03 -2.31e-05]
 [ 3.28e-04  3.59e-02  1.22e+00  6.46e-02 -8.14e-03]
 [ 1.51e-02 -1.27e-01 -2.21e+00 -1.82e-01  3.44e-02]
 [-3.59e-03  6.15e-02  1.17e+00  1.05e-01 -2.03e-02]
 [ 8.34e-04 -1.38e-02 -4.55e-02 -2.42e-02  4.94e-03]]
SymNet parameters
[[-1.81e-01  1.38e-02  6.08e-02 -7.98e-02  4.42e-02  6.30e-03  2.47e+00  2.30e-01
   3.11e-02 -9.81e-03 -4.03e-03 -4.24e-03]
 [-4.76e-02 -3.01e-02 -4.20e-01  3.93e-02 -3.85e-02  3.37e-03 -7.15e-02 -2.74e-02
  -2.76e-02 -6.56e-04  3.54e-04  2.56e-03]]
SymNet parameters
[-0.02  0.96]
SymNet parameters
[[-1.73e-01 -2.68e-01 -2.03e+00  1.60e-01 -4.57e-02 -6.87e-03 -3.18e-01 -1.58e-01
  -1.22e-01  8.12e-03  1.83e-03  1.16e-02 -6.82e-04]
 [ 1.46e-01 -2.38e-02 -3.97e-02  3.19e-02 -1.23e-02 -2.65e-03 -1.87e+00 -1.62e-02
  -2.16e-02  7.47e-04  8.69e-04  3.48e-03  2.45e-03]]
SymNet parameters
[-0.44  0.23]
SymNet parameters
[[ 1.24e-01  2.29e+00  3.03e-01  2.96e-01 -4.38e-03 -1.26e-02 -9.39e-02 -2.78e-01
   3.69e-01  5.67e-02  4.51e-03  4.41e-02  5.42e-01  1.91e-01]
 [ 7.96e-01  3.25e-01  1.50e-01  3.92e-03  2.67e-02  1.67e-03  2.90e-01  5.51e-03
   1.45e-01  1.14e-02 -6.22e-04  5.80e-03  9.16e-02  3.18e-02]]
SymNet parameters
[0.12 0.21]
SymNet parameters
[[ 2.07e+00  3.09e+00  1.41e+00 -8.43e-01  3.31e-01  7.17e-02  1.71e+00  7.98e-01
   7.92e-01 -1.44e-02 -5.61e-03 -6.16e-02  2.26e-01  1.11e-02  7.95e-02]
 [-7.68e-01 -2.27e+00 -7.18e-01  8.07e-02 -2.79e-02  9.92e-03 -8.94e-01 -2.86e-02
  -7.83e-02  5.10e-03  2.71e-03 -4.61e-04 -3.66e-01 -1.34e-01 -3.12e-02]]
SymNet parameters
[-0.04 -0.35]
SymNet parameters
[[-4.01e-01  5.56e-01 -3.08e-01  1.51e+00 -8.91e-02 -5.57e-02  9.73e-01 -1.25e+00
   1.29e+00  2.40e-01  1.23e-02  1.97e-01  1.09e+00  4.63e-01 -9.96e-03  1.14e-02]
 [-1.07e+00 -1.03e+00 -2.83e-01  8.49e-03 -3.77e-02  1.77e-04 -1.85e-01 -6.22e-03
  -2.02e-01 -1.40e-02  1.18e-03 -7.34e-03 -2.12e-01 -7.30e-02  7.36e-03 -2.03e-03]]
SymNet parameters
[-0.09  0.54]
SymNet parameters
[[ 0.02  0.4  -0.11  0.26 -0.02  0.04  0.02 -0.2   0.16  0.03  0.    0.03  0.29 -0.2
  -0.83 -0.07 -0.16]]
SymNet parameters
[-0.01]
SymNet parameters
[[-6.99e-01  1.09e-01  2.88e-01 -1.30e-01  3.97e-02  2.26e-02 -8.46e-01  1.89e+00
   7.74e-02 -7.43e-02  8.05e-02 -4.24e-01]
 [-5.47e-02 -5.15e-04  1.03e-02  1.50e-03  7.86e-05  3.73e-05 -1.70e-02  1.98e-02
  -5.01e-03 -4.80e-04 -3.70e-04  6.16e-03]]
SymNet parameters
[0.09 0.28]
SymNet parameters
[[ 0.15 -0.11  0.11 -0.06  0.03  0.01 -1.57  0.75  0.37  0.04  0.02 -0.07 -0.15]
 [ 0.66  0.45 -0.07 -0.11  0.02  0.01 -0.9  -1.05  1.27  0.09  0.04 -0.17 -0.44]]
SymNet parameters
[ 0.37 -0.59]
SymNet parameters
[[ 1.67e+00  2.84e-02  1.05e-02 -3.50e-03  1.36e-03 -7.82e-04  2.93e-01 -2.54e-01
   5.38e-02  9.66e-03  2.24e-02  2.94e-04  1.25e-01  1.00e-02]
 [ 1.61e-01  3.50e-01  1.50e-01 -1.47e-01  3.08e-02  2.35e-02 -1.72e+00  1.20e+00
   5.31e-01  2.77e-02  3.28e-01 -3.29e-01 -2.42e-01  5.87e-04]]
SymNet parameters
[-0.  -0.2]
SymNet parameters
[[-1.27 -0.15 -0.07  0.07 -0.02 -0.01 -1.13  1.23 -1.41 -0.01 -0.15  0.15  0.18 -0.04
   0.02]
 [-0.69 -0.03 -0.    0.01 -0.   -0.    0.78  0.12  0.16 -0.   -0.03  0.02 -0.03 -0.
  -0.  ]]
SymNet parameters
[-0.62  0.17]
SymNet parameters
[[ 1.02e+00 -8.77e-02 -8.31e-03  2.63e-02 -2.34e-03 -5.02e-03 -7.33e-01  1.02e+00
   9.94e-01 -2.19e-02 -8.42e-02  3.52e-02 -4.70e-01 -2.21e-02 -2.89e-02  1.22e-02]
 [ 5.73e-01 -5.88e-03 -7.66e-03  2.27e-03 -2.23e-04 -7.63e-04  9.74e-01  2.25e-01
  -1.66e-01 -2.00e-03 -1.03e-02  5.97e-03 -2.44e-02 -5.49e-04 -1.51e-03  1.73e-02]]
SymNet parameters
[-0.34 -0.06]
SymNet parameters
[[-2.47e-01  3.86e-03  1.12e-02 -2.90e-03  1.44e-03  4.31e-04  1.12e-01 -8.99e-02
   1.28e-01  5.28e-02  5.68e-03  4.07e-02 -3.26e-03  1.42e-02 -1.54e-01  3.75e-01
  -4.44e-01]]
SymNet parameters
[0.05]
finally, finish this stage
iter:     0    time: 890.05
Func: 1.64e-01  |g|: 1.46e+01
stableloss: 3.67e-02   dataloss: 1.42e-01   sparseloss: 9.01e+01 momentloss: 7.19e+00
current expression:
[u10*v00, u00*u01, u20, u02, u00*u01**2, u01*u10*v00, u10*v00*v10, u00*u10*v01, u00*u11*v00, u00, u01*u10, u01**2*v00, v00*v10, u01*v00**2, 1, u10*v00**2, u20*v00, u00**3, u10, u00**2*u02]
[-0.98 -0.97  0.05  0.05  0.01  0.01  0.01  0.01  0.01  0.01 -0.    0.    0.    0.
 -0.    0.    0.   -0.    0.    0.  ]
[v00*v10, u00*v01, v02, v20, v00*v10**2, v10, v00, u00*v00*v11, u00*v01*v10, u00*u01*v01, u10*v00*v01, v10**2, u10, v01, u10*v00**2, u00**2*v10, u00*v10**2, u00*v10, u00, u10*v00]
[-0.99 -0.98  0.05  0.05  0.02  0.01  0.01  0.01  0.01  0.01  0.01 -0.01  0.01  0.
 -0.   -0.    0.   -0.    0.    0.  ]
block:  4
name:  burgers-2-upwind-sparse0-noise0.001-id20
device:  cuda:0
generate a random number to check random seed:  -0.5232773184154531
current stage is: block-4
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.8591, device='cuda:0', dtype=torch.float64)
u_obs variance
tensor([ 0.2550,  1.7950,  1.6346, 23.4641, 11.6108, 18.9759,  0.2583,  1.6686,
         1.7983, 19.4880, 12.2683, 23.9565], device='cuda:0',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
iter:     0    time: 76.51
Func: 3.50e-01  |g|: 2.09e+01
stableloss: 3.90e-02   dataloss: 3.21e-01   sparseloss: 9.01e+01 momentloss: 7.19e+00
iter:   200    time: 23.71
Func: 2.08e-01  |g|: 1.02e+00
stableloss: 3.76e-02   dataloss: 1.79e-01   sparseloss: 8.70e+01 momentloss: 7.34e+00
iter:   400    time: 23.03
Func: 2.03e-01  |g|: 1.45e-01
stableloss: 3.71e-02   dataloss: 1.74e-01   sparseloss: 8.71e+01 momentloss: 7.31e+00
iter:   600    time: 23.07
Func: 2.00e-01  |g|: 7.66e-01
stableloss: 3.70e-02   dataloss: 1.71e-01   sparseloss: 9.32e+01 momentloss: 7.26e+00
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 0.198194
         Iterations: 770
         Function evaluations: 848
         Gradient evaluations: 832
convolution moment and kernels
[[ 1.00e+00  0.00e+00  1.13e-04  1.34e-01 -7.23e-02]
 [ 0.00e+00 -1.47e-03  2.40e-02 -4.60e-03  3.45e-02]
 [ 4.21e-04 -4.81e-03  2.75e-02  1.52e-04  1.36e-03]
 [-1.05e-01  1.37e-04  1.72e-03  7.31e-03 -4.60e-03]
 [-1.22e-01  5.65e-03 -1.27e-02  7.04e-04  2.75e-03]]
[[ 0.01 -0.06  0.01 -0.04  0.01]
 [-0.05  0.27 -0.02  0.22 -0.04]
 [-0.11  0.15  0.28 -0.06  0.02]
 [ 0.01  0.07  0.45  0.06  0.01]
 [-0.   -0.01 -0.15 -0.01  0.  ]]
[[ 0.    1.    0.   -0.09 -0.04]
 [ 0.    0.    0.01  0.    0.01]
 [ 0.    0.02  0.02  0.03 -0.01]
 [-0.02 -0.    0.    0.01  0.01]
 [ 0.01 -0.01  0.02 -0.    0.  ]]
[[ 0.01  0.01 -0.01  0.02 -0.01]
 [-0.05  0.03 -0.07 -0.01  0.01]
 [ 0.15 -0.62 -0.17  0.91 -0.18]
 [-0.03 -0.   -0.02  0.01  0.  ]
 [ 0.    0.01 -0.01 -0.01  0.01]]
[[ 0.    0.    0.   -0.    0.02]
 [ 1.    0.    0.03  0.01 -0.01]
 [ 0.   -0.   -0.03  0.    0.  ]
 [-0.07 -0.01  0.05 -0.01  0.  ]
 [-0.08 -0.   -0.03 -0.   -0.  ]]
[[-9.14e-04 -4.71e-02  1.41e-01 -5.32e-02  1.53e-03]
 [ 1.27e-02  6.08e-02 -5.85e-01  7.58e-02  9.46e-03]
 [ 1.04e-02 -1.29e-01 -2.31e-01 -1.11e-01 -8.49e-03]
 [-7.33e-03  5.78e-02  9.53e-01  3.38e-02  1.39e-02]
 [ 2.59e-03 -8.11e-03 -1.86e-01 -2.63e-03 -3.27e-03]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00 -6.24e-02]
 [ 0.00e+00  0.00e+00  0.00e+00 -5.34e-03 -7.06e-03]
 [ 0.00e+00  0.00e+00  2.00e-02 -4.42e-03 -4.29e-03]
 [ 0.00e+00 -2.19e-03  3.49e-04  3.04e-03  6.98e-03]
 [ 6.00e-02 -7.21e-04 -1.67e-03  2.75e-03 -1.41e-02]]
[[-0.02  0.07 -0.04  0.07 -0.02]
 [ 0.06 -0.21  0.05 -0.19  0.05]
 [-0.23  1.83 -2.81  1.77 -0.2 ]
 [ 0.05 -0.14 -0.09 -0.08  0.02]
 [-0.01  0.04  0.01  0.03 -0.01]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  3.99e-03]
 [ 0.00e+00  1.00e+00  0.00e+00 -5.77e-03  5.84e-02]
 [ 0.00e+00  0.00e+00  1.50e-03  7.05e-03 -4.12e-03]
 [ 0.00e+00 -5.59e-03  2.98e-03  1.02e-02 -5.45e-02]
 [ 4.85e-03 -1.72e-04 -5.10e-03 -8.09e-03  5.71e-03]]
[[ 0.05 -0.23  0.25 -0.09  0.02]
 [-0.21  1.02 -0.81  0.02 -0.04]
 [ 0.08 -0.31  0.41 -0.17  0.02]
 [ 0.11 -0.66  0.32  0.19  0.02]
 [-0.03  0.15 -0.14  0.04 -0.02]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  6.27e-03]
 [ 0.00e+00  0.00e+00  0.00e+00 -4.12e-03 -5.48e-03]
 [ 1.00e+00  0.00e+00  9.26e-03 -1.51e-03 -6.02e-03]
 [ 0.00e+00 -3.46e-03 -1.57e-04  3.30e-03  6.90e-03]
 [ 1.90e-03  6.75e-03 -3.27e-03 -6.00e-03 -3.64e-03]]
[[-2.07e-03  9.36e-03 -1.14e-01  3.64e-02 -1.14e-02]
 [-1.58e-03  1.37e-02  1.37e+00 -8.30e-02  3.15e-02]
 [ 2.25e-02 -1.14e-01 -2.38e+00  4.27e-03 -1.64e-02]
 [-1.61e-02  8.18e-02  1.24e+00  1.86e-02  3.77e-03]
 [ 3.47e-03 -1.58e-02 -6.65e-02 -1.34e-03 -1.25e-03]]
SymNet parameters
[[-1.69e-01 -2.01e-02  7.05e-03 -1.61e-02  5.03e-04 -4.96e-03  2.04e+00  8.17e-02
   6.44e-03  7.85e-04 -3.29e-03 -3.07e-03]
 [ 6.19e-02 -1.63e-02 -4.11e-01  1.85e-02 -9.17e-03  3.79e-03  9.28e-03 -2.10e-03
  -4.37e-02 -1.74e-03  1.18e-03 -1.29e-03]]
SymNet parameters
[0.42 0.27]
SymNet parameters
[[ 2.99e-01 -7.17e-02 -1.84e+00  5.09e-02  3.47e-02  1.09e-02  3.24e-02 -2.22e-03
  -1.57e-01 -5.45e-03  3.26e-03 -1.23e-04 -1.63e-02]
 [ 1.52e-01  6.30e-03 -6.25e-03  1.02e-02  1.35e-03  1.90e-03 -1.96e+00  9.49e-03
   2.10e-03 -8.95e-05  5.69e-04  3.92e-03 -2.95e-03]]
SymNet parameters
[-0.12 -0.03]
SymNet parameters
[[-2.26e-02  2.44e+00  1.64e-01  1.94e-01 -1.94e-03  4.81e-02  1.77e-01  1.32e-02
   4.12e-01  1.05e-02  2.43e-02 -1.32e-02  3.50e-01  1.06e-01]
 [ 6.96e-01  1.65e-01  3.87e-02 -1.94e-03 -3.14e-03 -2.43e-03  1.64e-01  1.60e-03
   6.60e-02  1.84e-03  4.20e-04 -1.10e-03  3.69e-02  1.28e-02]]
SymNet parameters
[ 0.59 -0.13]
SymNet parameters
[[ 6.08e-01  3.61e+00  7.85e-01 -6.87e-01 -7.68e-02 -1.60e-01 -3.19e-01 -5.29e-02
   9.73e-01  4.36e-02 -4.80e-02  2.47e-02  1.44e+00  3.01e-01  1.21e-01]
 [-1.23e+00 -1.79e+00 -6.79e-01  1.69e-01  2.15e-02  6.01e-02 -2.60e+00  1.33e-02
   5.37e-02  1.91e-03  1.68e-02  1.37e-03 -6.86e-01 -2.08e-01 -7.90e-02]]
SymNet parameters
[0.25 0.51]
SymNet parameters
[[-3.38e-01  1.80e+00 -8.81e-01  1.58e+00  3.75e-02  3.97e-01  7.06e-01  1.83e-01
   1.97e+00  3.89e-02  1.68e-01 -9.13e-02 -1.61e+00 -2.13e-01 -1.90e-02  1.40e-02]
 [-1.22e+00 -7.34e-01 -1.43e-01  3.56e-02  8.07e-03  1.17e-02 -4.13e-01  2.82e-03
  -1.58e-01 -4.48e-03  1.98e-03  5.14e-05 -2.41e-01 -7.12e-02  5.42e-03 -1.14e-03]]
SymNet parameters
[-0.15  1.17]
SymNet parameters
[[ 0.34  0.05  0.01  0.15  0.    0.08 -0.08  0.    0.18  0.    0.01 -0.01  0.27 -0.2
  -0.77 -0.03 -0.07]]
SymNet parameters
[-0.11]
SymNet parameters
[[-6.96e-01 -6.97e-02  2.71e-02 -6.91e-03  1.37e-02 -2.71e-03 -3.99e-01  2.50e+00
   1.05e-01 -1.97e-01 -5.79e-02 -2.16e-02]
 [-1.35e-01 -1.27e-03  6.28e-03  7.59e-06  5.59e-05  6.55e-05  9.93e-04 -2.03e-03
   3.50e-03  1.74e-04 -6.53e-04  1.54e-03]]
SymNet parameters
[1.18 0.5 ]
SymNet parameters
[[ 3.45e-01 -1.59e-01  4.80e-03 -2.51e-03  2.29e-03 -4.87e-04 -3.74e+00  1.42e-01
   9.40e-02 -1.51e-03 -1.80e-02  1.94e-02 -8.30e-02]
 [ 6.86e-01  5.47e-02 -7.35e-02  1.18e-02 -3.83e-02  1.73e-02  1.05e+00 -4.76e+00
   8.97e-03  3.54e-01 -6.33e-02 -1.35e-01  1.10e-01]]
SymNet parameters
[-0.21 -0.54]
SymNet parameters
[[ 2.05e+00  2.39e-02 -1.28e-02 -4.88e-04 -1.09e-03 -3.02e-03  8.35e-01 -1.40e-01
  -1.79e-01  1.45e-02  6.20e-03 -1.05e-03  1.66e-01 -1.80e-03]
 [ 1.99e+00 -6.24e-02  4.87e-02  3.31e-03 -7.96e-03  9.93e-03 -1.94e+00  2.46e+00
   1.11e+00 -1.44e-01  1.87e-03 -1.96e-01 -1.22e+00 -1.05e-02]]
SymNet parameters
[-0.1   0.13]
SymNet parameters
[[-1.54e+00  4.67e-02 -3.82e-02 -2.73e-03  7.17e-03 -7.65e-03 -1.65e+00 -6.85e-01
  -8.35e-01  1.10e-01 -1.37e-03  1.53e-01  9.09e-01 -1.08e-02  1.91e-03]
 [-1.08e+00 -1.31e-02  8.65e-03 -4.69e-04  1.45e-03  1.30e-03  3.62e-01  1.20e-01
   8.57e-02 -7.85e-03 -2.80e-03  1.34e-03 -7.45e-02 -8.25e-04  2.31e-04]]
SymNet parameters
[-1.01  0.45]
SymNet parameters
[[ 1.64e+00  3.64e-02 -3.29e-02 -5.72e-03  9.05e-03 -1.12e-02 -1.86e-01  1.22e-01
   6.78e-01 -2.72e-03 -2.76e-02  1.06e-01 -2.01e-01  2.91e-05 -3.41e-03 -3.93e-03]
 [-2.70e-02 -7.59e-04 -2.02e-04  1.07e-03 -8.82e-04  4.52e-04  1.01e+00  1.84e-01
   1.28e-02 -5.97e-03 -1.46e-03 -5.18e-03 -6.70e-02  5.77e-04 -1.32e-02  3.32e-02]]
SymNet parameters
[-0.31  0.31]
SymNet parameters
[[ 8.95e-02 -1.08e-02  1.07e-02 -2.16e-04 -1.01e-03  1.29e-03  1.45e-01  8.28e-02
   3.68e-01  2.53e-02 -2.95e-03  2.99e-02 -2.01e-01  2.26e-03 -2.55e-01  6.25e-01
  -6.24e-01]]
SymNet parameters
[0.17]
finally, finish this stage
iter:   770    time: 26.59
Func: 1.98e-01  |g|: 8.81e-02
stableloss: 3.70e-02   dataloss: 1.69e-01   sparseloss: 9.70e+01 momentloss: 7.28e+00
current expression:
[u10*v00, u00*u01, u20, u02, u00*u01**2, u01*u10*v00, u10*v01, u10*v00*v10, u00*u10*v01, u00*u11*v00, u01**2, u10*v10, u01*u10, u00*u01*v00, u00*v00, u10, v00**2, u01, u00*v01, u00]
[-0.98 -0.98  0.05  0.05  0.01  0.01 -0.01  0.01  0.01  0.01 -0.01  0.01  0.01  0.01
 -0.   -0.    0.   -0.    0.    0.  ]
[v00*v10, u00*v01, v20, v02, v00*v10**2, u00*v00*v11, v01*v10, v00, u10*v00*v01, u00*u01*v01, u01*v01, u00*v01*v10, u10*v01, v10**2, v00**3, u00, u00**2, u10, u00**2*v02, u00**2*v00]
[-0.99 -0.98  0.05  0.05  0.01  0.01 -0.01  0.01  0.01  0.01 -0.01  0.01  0.01  0.01
 -0.    0.   -0.    0.    0.    0.  ]
block:  5
name:  burgers-2-upwind-sparse0-noise0.001-id20
device:  cuda:0
generate a random number to check random seed:  -3.186149345662838
current stage is: block-5
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.8026, device='cuda:0', dtype=torch.float64)
u_obs variance
tensor([ 0.2505,  1.7989,  1.6545, 25.4058, 11.1759, 19.7663,  0.2492,  1.5215,
         1.5628, 18.4549,  9.0067, 20.5645], device='cuda:0',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
iter:     0    time: 483.87
Func: 3.71e-01  |g|: 3.32e+01
stableloss: 4.32e-02   dataloss: 3.35e-01   sparseloss: 9.70e+01 momentloss: 7.28e+00
iter:   200    time: 27.49
Func: 2.74e-01  |g|: 8.40e-01
stableloss: 4.38e-02   dataloss: 2.38e-01   sparseloss: 9.62e+01 momentloss: 7.17e+00
iter:   400    time: 27.63
Func: 2.71e-01  |g|: 4.54e-01
stableloss: 4.38e-02   dataloss: 2.35e-01   sparseloss: 1.02e+02 momentloss: 7.09e+00
iter:   600    time: 27.37
Func: 2.69e-01  |g|: 3.70e-01
stableloss: 4.36e-02   dataloss: 2.34e-01   sparseloss: 1.07e+02 momentloss: 7.08e+00
iter:   800    time: 27.41
Func: 2.67e-01  |g|: 2.19e-01
stableloss: 4.29e-02   dataloss: 2.32e-01   sparseloss: 1.13e+02 momentloss: 7.09e+00
iter:  1000    time: 27.61
Func: 2.66e-01  |g|: 2.83e-01
stableloss: 4.28e-02   dataloss: 2.31e-01   sparseloss: 1.17e+02 momentloss: 7.11e+00
iter:  1200    time: 27.74
Func: 2.66e-01  |g|: 1.06e-01
stableloss: 4.27e-02   dataloss: 2.31e-01   sparseloss: 1.20e+02 momentloss: 7.11e+00
iter:  1400    time: 27.78
Func: 2.66e-01  |g|: 1.17e-01
stableloss: 4.27e-02   dataloss: 2.31e-01   sparseloss: 1.24e+02 momentloss: 7.11e+00
iter:  1600    time: 27.72
Func: 2.66e-01  |g|: 1.82e-01
stableloss: 4.27e-02   dataloss: 2.31e-01   sparseloss: 1.28e+02 momentloss: 7.11e+00
iter:  1800    time: 27.56
Func: 2.66e-01  |g|: 3.04e-01
stableloss: 4.28e-02   dataloss: 2.31e-01   sparseloss: 1.34e+02 momentloss: 7.11e+00
Warning: Maximum number of iterations has been exceeded.
         Current function value: 0.266101
         Iterations: 2000
         Function evaluations: 2018
         Gradient evaluations: 2009
convolution moment and kernels
[[ 1.00e+00  0.00e+00  9.64e-04 -1.26e-02 -5.74e-02]
 [ 0.00e+00 -3.54e-05  6.25e-03 -1.50e-03  4.22e-02]
 [ 9.07e-04  2.56e-02  9.71e-03 -2.14e-02  9.02e-03]
 [ 1.99e-02  8.18e-03 -6.87e-03  2.53e-03  1.81e-02]
 [-1.19e-01  6.12e-02 -5.96e-02  2.21e-03 -1.22e-02]]
[[-0.01 -0.04 -0.1   0.03 -0.02]
 [ 0.03  0.22  0.2   0.02  0.03]
 [-0.12 -0.04  0.32  0.25 -0.12]
 [ 0.05  0.17  0.22 -0.04  0.05]
 [ 0.   -0.09  0.01 -0.02 -0.  ]]
[[ 0.00e+00  1.00e+00  0.00e+00 -7.36e-02 -5.57e-02]
 [ 0.00e+00  0.00e+00  7.55e-03  1.89e-03  1.87e-02]
 [ 0.00e+00  2.05e-02  1.74e-02  3.71e-02 -9.49e-03]
 [-6.18e-04  1.77e-03  4.54e-03  6.14e-03  6.55e-03]
 [ 4.19e-03 -1.58e-02  1.11e-02 -5.32e-03 -8.31e-04]]
[[ 1.70e-03  1.86e-02 -2.60e-02  1.67e-02 -6.55e-03]
 [-4.35e-02  4.61e-02 -5.49e-02  1.83e-02  1.67e-02]
 [ 1.31e-01 -5.89e-01 -2.54e-01  9.46e-01 -2.09e-01]
 [-2.72e-02 -7.05e-03  1.45e-02 -2.01e-02  2.38e-02]
 [ 2.10e-03  1.39e-02 -1.42e-02  2.66e-03 -6.14e-04]]
[[ 0.00e+00  0.00e+00  0.00e+00  5.23e-03  1.12e-02]
 [ 1.00e+00  0.00e+00  1.08e-02 -2.63e-03 -2.77e-02]
 [ 0.00e+00  4.01e-03 -1.12e-02 -1.22e-02  2.83e-03]
 [-7.94e-02  3.75e-04  1.44e-02 -1.54e-03 -2.16e-02]
 [-8.22e-02  6.81e-03 -3.97e-02 -1.43e-02 -9.10e-03]]
[[ 0.01 -0.07  0.15 -0.04 -0.  ]
 [ 0.    0.11 -0.57 -0.    0.05]
 [-0.01 -0.15 -0.27 -0.01 -0.06]
 [ 0.01  0.06  0.99 -0.05  0.05]
 [-0.01  0.01 -0.23  0.05 -0.02]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00 -2.00e-02]
 [ 0.00e+00  0.00e+00  0.00e+00 -6.30e-05 -8.31e-03]
 [ 0.00e+00  0.00e+00  5.07e-03 -8.90e-03 -4.52e-03]
 [ 0.00e+00  3.75e-03 -3.23e-03 -6.94e-04  3.41e-03]
 [ 1.12e-01 -8.99e-03  2.67e-03  1.58e-02  3.73e-03]]
[[-0.01  0.02  0.11 -0.03  0.01]
 [ 0.03 -0.06 -0.5   0.14 -0.05]
 [-0.13  1.44 -1.75  1.13 -0.01]
 [ 0.01  0.02 -0.63  0.21 -0.07]
 [-0.   -0.    0.15 -0.05  0.02]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00 -3.74e-03]
 [ 0.00e+00  1.00e+00  0.00e+00 -6.43e-03 -3.62e-03]
 [ 0.00e+00  0.00e+00 -1.29e-03  4.70e-04  2.73e-03]
 [ 0.00e+00 -6.72e-03 -5.49e-03  9.09e-03  4.15e-03]
 [-3.34e-03 -7.59e-04  4.45e-04  1.02e-03 -1.24e-03]]
[[ 0.01 -0.04 -0.03  0.08 -0.01]
 [-0.04  0.38  0.13 -0.53  0.08]
 [-0.02  0.09 -0.14  0.07 -0.02]
 [ 0.07 -0.47  0.02  0.46 -0.06]
 [-0.01  0.06  0.01 -0.07  0.01]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00 -2.56e-03]
 [ 0.00e+00  0.00e+00  0.00e+00  3.19e-03 -7.13e-03]
 [ 1.00e+00  0.00e+00  2.59e-03 -4.74e-03 -3.62e-03]
 [ 0.00e+00  4.36e-03 -2.31e-03 -3.11e-03  2.21e-04]
 [ 6.08e-03 -4.00e-03  5.34e-02  3.42e-03 -1.43e-03]]
[[-9.69e-03  8.96e-02 -2.24e-01  7.01e-02 -3.03e-03]
 [ 3.79e-02 -3.46e-01  1.88e+00 -2.68e-01  9.25e-03]
 [-4.64e-02  4.75e-01 -3.26e+00  3.79e-01 -1.00e-02]
 [ 2.16e-02 -2.83e-01  1.80e+00 -2.38e-01  4.87e-03]
 [-5.91e-03  7.43e-02 -2.10e-01  6.79e-02 -3.61e-03]]
SymNet parameters
[[ 6.96e-02  5.28e-03 -1.15e-03  2.63e-03  1.46e-03  1.67e-03  2.13e+00  7.10e-02
   1.13e-02 -2.36e-04  4.66e-04 -3.08e-03]
 [-1.76e-02  1.07e-02 -3.41e-01  6.87e-04 -1.23e-02  3.18e-04  2.15e-02  7.46e-04
  -3.71e-02  3.39e-04 -1.43e-04 -7.59e-04]]
SymNet parameters
[1.27 0.28]
SymNet parameters
[[-1.66e-01  1.90e-03 -2.20e+00  2.66e-02  3.28e-02  1.52e-02  2.67e-01  1.28e-02
  -2.38e-01  5.01e-03 -1.62e-03 -4.90e-04 -4.75e-02]
 [-6.11e-02 -2.69e-03 -1.73e-04  1.80e-03 -9.76e-04  1.80e-03 -1.65e+00  3.31e-02
  -1.40e-02  1.09e-03 -2.94e-04  3.21e-03 -5.70e-03]]
SymNet parameters
[-1.34 -0.23]
SymNet parameters
[[ 2.49e-01  2.71e+00  3.84e-01  2.99e-01 -1.86e-02  1.21e-01 -2.45e+00 -8.76e-02
  -5.63e-02 -1.11e-02  2.37e-02 -3.09e-04  1.04e+00  1.59e-01]
 [ 2.69e-01  1.29e-01  2.19e-02  1.38e-02 -9.43e-04  2.32e-03  2.52e-01 -5.07e-03
   2.59e-02 -2.58e-04  1.09e-03 -1.27e-03  1.80e-02  1.01e-02]]
SymNet parameters
[ 1.24 -0.29]
SymNet parameters
[[ 5.96e-01  4.44e+00 -4.86e-01 -8.47e-01  1.09e-01 -2.99e-01 -3.57e+00  2.15e-01
  -5.66e-02  3.66e-02 -7.36e-02  3.10e-02  8.80e-01  1.37e-01 -1.62e-02]
 [ 3.62e+00 -5.41e-01 -6.35e-02  2.90e-02  1.01e-03  1.24e-02 -2.32e+00 -1.58e-02
   1.47e-01 -1.03e-02  5.46e-03  9.45e-03  8.48e-02 -5.05e-02 -2.46e-02]]
SymNet parameters
[-0.18  0.53]
SymNet parameters
[[-4.40e+00  2.26e+00  6.81e-01  8.11e-01 -6.26e-02  3.03e-01 -3.09e+00 -2.74e-01
   8.47e-01 -4.94e-02  7.78e-02 -6.70e-03  1.24e+00  1.98e-01  5.59e-02  4.48e-03]
 [ 2.93e-01 -8.38e-01 -9.33e-02 -2.74e-02  1.03e-04 -1.58e-03 -1.08e+00  4.10e-03
   1.38e-02 -1.76e-03 -7.02e-04  4.89e-03 -1.29e-01 -6.14e-02  1.21e-02 -1.36e-03]]
SymNet parameters
[-0.74  1.45]
SymNet parameters
[[-0.17 -0.01  0.31  0.08  0.    0.06  0.33 -0.03  0.14 -0.    0.   -0.    0.45 -0.17
  -0.48 -0.02 -0.06]]
SymNet parameters
[-0.35]
SymNet parameters
[[-3.18e-01 -3.02e-02  2.62e-02  2.92e-03 -5.04e-03  9.88e-03 -2.71e-01  1.58e+00
   1.26e-02 -9.01e-02 -4.13e-02 -7.61e-02]
 [-1.79e-01 -3.68e-03  8.00e-03 -1.18e-04  9.11e-05  3.10e-04 -1.18e-02 -1.11e-03
   7.95e-03 -5.35e-05 -6.13e-04  2.13e-03]]
SymNet parameters
[3.96 0.58]
SymNet parameters
[[ 8.68e-01 -4.05e-01  5.28e-02 -3.25e-03 -3.60e-03  1.02e-02 -6.32e+00  2.36e-01
   2.19e-01 -1.73e-02 -5.20e-03  6.94e-03 -3.65e-01]
 [ 8.08e-02  5.35e-02 -1.83e-02  9.38e-03 -2.44e-03 -6.71e-03  7.38e-01 -6.26e+00
   8.08e-01  3.37e-01 -9.28e-02 -1.16e-01 -9.94e-02]]
SymNet parameters
[ 0.26 -0.95]
SymNet parameters
[[ 3.27e+00 -1.25e-02  1.73e-01  8.73e-03 -6.24e-03  1.72e-02  9.01e-01  9.30e-01
   8.98e-01 -7.12e-02  2.34e-02 -1.99e-01 -9.22e-01  1.13e-03]
 [ 3.66e+00 -4.19e-02  3.40e-01  2.03e-02 -1.47e-02  4.22e-02 -4.92e+00  3.87e+00
   1.82e+00 -1.29e-01  5.91e-02 -4.12e-01 -2.01e+00 -8.60e-03]]
SymNet parameters
[1.12 2.46]
SymNet parameters
[[-3.85e+00  5.33e-02 -3.22e-01 -1.91e-02  1.35e-02 -3.80e-02 -1.36e+00 -1.87e+00
  -1.88e+00  1.44e-01 -4.53e-02  3.94e-01  1.86e+00 -2.35e-03 -3.66e-04]
 [-1.33e+00  2.49e-03 -7.70e-02 -3.96e-03  2.97e-03 -8.39e-03  1.30e+00 -8.21e-01
  -3.61e-01  2.75e-02 -1.23e-02  8.86e-02  4.34e-01  1.81e-03  1.16e-04]]
SymNet parameters
[-2.   -0.33]
SymNet parameters
[[ 1.39e+00  2.41e-02 -4.51e-02 -8.16e-03  3.38e-03 -1.15e-02 -9.60e-02  1.67e-01
   5.16e-01 -7.68e-03 -3.26e-02  1.04e-01 -1.48e-01 -2.37e-04 -3.18e-03  2.96e-03]
 [ 4.68e-02 -9.76e-04  1.74e-03  7.05e-05  1.92e-04  6.01e-05  8.20e-01  8.52e-02
   4.35e-03 -3.05e-03 -2.22e-03 -3.74e-03 -5.42e-02  4.22e-04 -1.10e-02  2.65e-02]]
SymNet parameters
[-0.72 -1.  ]
SymNet parameters
[[-0.25 -0.02  0.09  0.01 -0.01  0.02 -1.23 -0.23 -0.18  0.06  0.06 -0.12  0.27  0.01
  -0.29  0.7  -0.92]]
SymNet parameters
[0.03]
finally, finish this stage
iter:  2000    time: 27.85
Func: 2.66e-01  |g|: 7.00e-01
stableloss: 4.29e-02   dataloss: 2.31e-01   sparseloss: 1.44e+02 momentloss: 7.11e+00
current expression:
[u00*u01, u10*v00, u20, u02, u00*u01**2, u10*v00*v10, u00*u10*v01, u01*u10*v00, u00*u11*v00, u00**2*u01, u00, u01, v00, u01*v00, u01*u10, u00**2*u02, u10*v20, u00*v10, u02*v00**2, u01*u20]
[-0.99 -0.98  0.05  0.05  0.01  0.01  0.01  0.01  0.01 -0.    0.    0.   -0.    0.
 -0.    0.    0.   -0.    0.    0.  ]
[v00*v10, u00*v01, v20, v02, v00*v10**2, u00*u01*v01, u00*v01*v10, u10*v00*v01, u00*v00*v11, v00, v10, v00**3, u00**2*v02, v00*v01, u00, u00*v10, u10*v00**2, v10**2, v00**2, u00**2*v00**2]
[-0.99 -0.98  0.05  0.05  0.01  0.01  0.01  0.01  0.01  0.01  0.   -0.    0.    0.
 -0.    0.   -0.   -0.    0.   -0.  ]
block:  6
name:  burgers-2-upwind-sparse0-noise0.001-id20
device:  cuda:0
generate a random number to check random seed:  -0.7823821852511295
current stage is: block-6
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.7677, device='cuda:0', dtype=torch.float64)
u_obs variance
tensor([ 0.2592,  1.8052,  1.6338, 24.1627, 10.6927, 19.9912,  0.2406,  1.5651,
         1.6865, 18.1026, 10.4019, 23.5389], device='cuda:0',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 0.670203
         Iterations: 0
         Function evaluations: 15
         Gradient evaluations: 3
convolution moment and kernels
[[ 1.00e+00  0.00e+00  9.64e-04 -1.26e-02 -5.74e-02]
 [ 0.00e+00 -3.54e-05  6.25e-03 -1.50e-03  4.22e-02]
 [ 9.07e-04  2.56e-02  9.71e-03 -2.14e-02  9.02e-03]
 [ 1.99e-02  8.18e-03 -6.87e-03  2.53e-03  1.81e-02]
 [-1.19e-01  6.12e-02 -5.96e-02  2.21e-03 -1.22e-02]]
[[-0.01 -0.04 -0.1   0.03 -0.02]
 [ 0.03  0.22  0.2   0.02  0.03]
 [-0.12 -0.04  0.32  0.25 -0.12]
 [ 0.05  0.17  0.22 -0.04  0.05]
 [ 0.   -0.09  0.01 -0.02 -0.  ]]
[[ 0.00e+00  1.00e+00  0.00e+00 -7.36e-02 -5.57e-02]
 [ 0.00e+00  0.00e+00  7.55e-03  1.89e-03  1.87e-02]
 [ 0.00e+00  2.05e-02  1.74e-02  3.71e-02 -9.49e-03]
 [-6.17e-04  1.77e-03  4.54e-03  6.14e-03  6.55e-03]
 [ 4.19e-03 -1.58e-02  1.11e-02 -5.32e-03 -8.31e-04]]
[[ 1.70e-03  1.86e-02 -2.60e-02  1.67e-02 -6.55e-03]
 [-4.35e-02  4.61e-02 -5.49e-02  1.83e-02  1.67e-02]
 [ 1.31e-01 -5.89e-01 -2.54e-01  9.46e-01 -2.09e-01]
 [-2.72e-02 -7.06e-03  1.45e-02 -2.01e-02  2.38e-02]
 [ 2.10e-03  1.39e-02 -1.42e-02  2.66e-03 -6.14e-04]]
[[ 0.00e+00  0.00e+00  0.00e+00  5.23e-03  1.12e-02]
 [ 1.00e+00  0.00e+00  1.08e-02 -2.63e-03 -2.77e-02]
 [ 0.00e+00  4.01e-03 -1.12e-02 -1.22e-02  2.83e-03]
 [-7.94e-02  3.75e-04  1.44e-02 -1.54e-03 -2.16e-02]
 [-8.22e-02  6.80e-03 -3.97e-02 -1.43e-02 -9.10e-03]]
[[ 0.01 -0.07  0.15 -0.04 -0.  ]
 [ 0.    0.11 -0.57 -0.    0.05]
 [-0.01 -0.15 -0.27 -0.01 -0.06]
 [ 0.01  0.06  0.99 -0.05  0.05]
 [-0.01  0.01 -0.23  0.05 -0.02]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00 -2.00e-02]
 [ 0.00e+00  0.00e+00  0.00e+00 -6.30e-05 -8.31e-03]
 [ 0.00e+00  0.00e+00  5.07e-03 -8.90e-03 -4.52e-03]
 [ 0.00e+00  3.75e-03 -3.23e-03 -6.94e-04  3.41e-03]
 [ 1.12e-01 -8.99e-03  2.67e-03  1.58e-02  3.73e-03]]
[[-0.01  0.02  0.11 -0.03  0.01]
 [ 0.03 -0.06 -0.5   0.14 -0.05]
 [-0.13  1.44 -1.75  1.13 -0.01]
 [ 0.01  0.02 -0.63  0.21 -0.07]
 [-0.   -0.    0.15 -0.05  0.02]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00 -3.74e-03]
 [ 0.00e+00  1.00e+00  0.00e+00 -6.43e-03 -3.62e-03]
 [ 0.00e+00  0.00e+00 -1.29e-03  4.70e-04  2.73e-03]
 [ 0.00e+00 -6.72e-03 -5.49e-03  9.09e-03  4.15e-03]
 [-3.34e-03 -7.59e-04  4.45e-04  1.02e-03 -1.24e-03]]
[[ 0.01 -0.04 -0.03  0.08 -0.01]
 [-0.04  0.38  0.13 -0.53  0.08]
 [-0.02  0.09 -0.14  0.07 -0.02]
 [ 0.07 -0.47  0.02  0.46 -0.06]
 [-0.01  0.06  0.01 -0.07  0.01]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00 -2.56e-03]
 [ 0.00e+00  0.00e+00  0.00e+00  3.19e-03 -7.13e-03]
 [ 1.00e+00  0.00e+00  2.59e-03 -4.74e-03 -3.62e-03]
 [ 0.00e+00  4.36e-03 -2.31e-03 -3.11e-03  2.21e-04]
 [ 6.08e-03 -4.00e-03  5.34e-02  3.42e-03 -1.43e-03]]
[[-9.69e-03  8.96e-02 -2.24e-01  7.01e-02 -3.03e-03]
 [ 3.79e-02 -3.46e-01  1.88e+00 -2.68e-01  9.25e-03]
 [-4.64e-02  4.75e-01 -3.26e+00  3.79e-01 -1.00e-02]
 [ 2.16e-02 -2.83e-01  1.80e+00 -2.38e-01  4.87e-03]
 [-5.91e-03  7.43e-02 -2.10e-01  6.79e-02 -3.61e-03]]
SymNet parameters
[[ 6.96e-02  5.28e-03 -1.15e-03  2.63e-03  1.46e-03  1.67e-03  2.13e+00  7.10e-02
   1.13e-02 -2.36e-04  4.66e-04 -3.08e-03]
 [-1.76e-02  1.07e-02 -3.41e-01  6.89e-04 -1.23e-02  3.20e-04  2.15e-02  7.46e-04
  -3.71e-02  3.40e-04 -1.43e-04 -7.58e-04]]
SymNet parameters
[1.27 0.28]
SymNet parameters
[[-1.66e-01  1.90e-03 -2.20e+00  2.66e-02  3.28e-02  1.52e-02  2.67e-01  1.28e-02
  -2.38e-01  5.01e-03 -1.62e-03 -4.90e-04 -4.75e-02]
 [-6.11e-02 -2.69e-03 -1.73e-04  1.80e-03 -9.76e-04  1.80e-03 -1.65e+00  3.31e-02
  -1.40e-02  1.09e-03 -2.94e-04  3.22e-03 -5.70e-03]]
SymNet parameters
[-1.34 -0.23]
SymNet parameters
[[ 2.49e-01  2.71e+00  3.84e-01  2.99e-01 -1.86e-02  1.21e-01 -2.45e+00 -8.76e-02
  -5.63e-02 -1.11e-02  2.37e-02 -3.09e-04  1.04e+00  1.59e-01]
 [ 2.69e-01  1.29e-01  2.19e-02  1.38e-02 -9.43e-04  2.32e-03  2.52e-01 -5.07e-03
   2.59e-02 -2.59e-04  1.10e-03 -1.27e-03  1.80e-02  1.01e-02]]
SymNet parameters
[ 1.24 -0.29]
SymNet parameters
[[ 5.96e-01  4.44e+00 -4.86e-01 -8.47e-01  1.09e-01 -2.99e-01 -3.57e+00  2.15e-01
  -5.66e-02  3.66e-02 -7.36e-02  3.10e-02  8.80e-01  1.37e-01 -1.62e-02]
 [ 3.62e+00 -5.41e-01 -6.35e-02  2.90e-02  1.01e-03  1.24e-02 -2.32e+00 -1.58e-02
   1.47e-01 -1.03e-02  5.46e-03  9.45e-03  8.48e-02 -5.05e-02 -2.46e-02]]
SymNet parameters
[-0.18  0.53]
SymNet parameters
[[-4.40e+00  2.26e+00  6.81e-01  8.11e-01 -6.26e-02  3.03e-01 -3.09e+00 -2.74e-01
   8.47e-01 -4.94e-02  7.78e-02 -6.70e-03  1.24e+00  1.98e-01  5.59e-02  4.48e-03]
 [ 2.93e-01 -8.38e-01 -9.33e-02 -2.74e-02  1.03e-04 -1.58e-03 -1.08e+00  4.10e-03
   1.38e-02 -1.76e-03 -7.02e-04  4.89e-03 -1.29e-01 -6.14e-02  1.21e-02 -1.37e-03]]
SymNet parameters
[-0.74  1.45]
SymNet parameters
[[-0.17 -0.01  0.31  0.08  0.    0.06  0.33 -0.03  0.14 -0.    0.   -0.    0.45 -0.17
  -0.48 -0.02 -0.06]]
SymNet parameters
[-0.35]
SymNet parameters
[[-3.18e-01 -3.02e-02  2.62e-02  2.92e-03 -5.04e-03  9.88e-03 -2.71e-01  1.58e+00
   1.26e-02 -9.01e-02 -4.13e-02 -7.61e-02]
 [-1.79e-01 -3.68e-03  8.00e-03 -1.12e-04  8.54e-05  3.18e-04 -1.18e-02 -1.11e-03
   7.95e-03 -5.39e-05 -6.10e-04  2.13e-03]]
SymNet parameters
[3.96 0.58]
SymNet parameters
[[ 8.68e-01 -4.05e-01  5.28e-02 -3.25e-03 -3.60e-03  1.02e-02 -6.32e+00  2.36e-01
   2.19e-01 -1.73e-02 -5.20e-03  6.94e-03 -3.65e-01]
 [ 8.08e-02  5.35e-02 -1.83e-02  9.38e-03 -2.44e-03 -6.71e-03  7.38e-01 -6.26e+00
   8.08e-01  3.37e-01 -9.28e-02 -1.16e-01 -9.94e-02]]
SymNet parameters
[ 0.26 -0.95]
SymNet parameters
[[ 3.27e+00 -1.25e-02  1.73e-01  8.73e-03 -6.24e-03  1.72e-02  9.01e-01  9.30e-01
   8.98e-01 -7.12e-02  2.34e-02 -1.99e-01 -9.22e-01  1.06e-03]
 [ 3.66e+00 -4.19e-02  3.40e-01  2.03e-02 -1.47e-02  4.22e-02 -4.92e+00  3.87e+00
   1.82e+00 -1.29e-01  5.91e-02 -4.12e-01 -2.01e+00 -8.62e-03]]
SymNet parameters
[1.12 2.46]
SymNet parameters
[[-3.85e+00  5.33e-02 -3.22e-01 -1.91e-02  1.35e-02 -3.80e-02 -1.36e+00 -1.87e+00
  -1.88e+00  1.44e-01 -4.53e-02  3.94e-01  1.86e+00 -2.40e-03 -1.78e-04]
 [-1.33e+00  2.49e-03 -7.70e-02 -3.96e-03  2.97e-03 -8.38e-03  1.30e+00 -8.21e-01
  -3.61e-01  2.75e-02 -1.23e-02  8.86e-02  4.34e-01  1.74e-03  5.22e-04]]
SymNet parameters
[-2.   -0.33]
SymNet parameters
[[ 1.39e+00  2.41e-02 -4.51e-02 -8.16e-03  3.38e-03 -1.15e-02 -9.60e-02  1.67e-01
   5.16e-01 -7.68e-03 -3.26e-02  1.04e-01 -1.48e-01 -2.22e-04 -3.17e-03  2.96e-03]
 [ 4.68e-02 -9.77e-04  1.74e-03  7.39e-05  1.90e-04  6.52e-05  8.20e-01  8.52e-02
   4.35e-03 -3.05e-03 -2.22e-03 -3.74e-03 -5.42e-02  3.86e-04 -1.09e-02  2.65e-02]]
SymNet parameters
[-0.72 -1.  ]
SymNet parameters
[[-0.25 -0.02  0.09  0.01 -0.01  0.02 -1.23 -0.23 -0.18  0.06  0.06 -0.12  0.27  0.01
  -0.29  0.7  -0.92]]
SymNet parameters
[0.03]
finally, finish this stage
iter:     0    time: 361.21
Func: 6.70e-01  |g|: 4.75e+02
stableloss: 6.65e-02   dataloss: 6.28e-01   sparseloss: 1.44e+02 momentloss: 7.11e+00
current expression:
[u00*u01, u10*v00, u20, u02, u00*u01**2, u10*v00*v10, u00*u10*v01, u01*u10*v00, u00*u11*v00, u00**2*u01, u00, u01, v00, u01*v00, u01*u10, u00**2*u02, u10*v20, u00*v10, u02*v00**2, u01*u20]
[-0.99 -0.98  0.05  0.05  0.01  0.01  0.01  0.01  0.01 -0.    0.    0.   -0.    0.
 -0.    0.    0.   -0.    0.    0.  ]
[v00*v10, u00*v01, v20, v02, v00*v10**2, u00*u01*v01, u00*v01*v10, u10*v00*v01, u00*v00*v11, v00, v10, v00**3, u00**2*v02, v00*v01, u00, u00*v10, u10*v00**2, v10**2, v00**2, u00**2*v00**2]
[-0.99 -0.98  0.05  0.05  0.01  0.01  0.01  0.01  0.01  0.01  0.   -0.    0.    0.
 -0.    0.   -0.   -0.    0.   -0.  ]
block:  9
name:  burgers-2-upwind-sparse0-noise0.001-id20
device:  cuda:0
generate a random number to check random seed:  -0.7470940028365363
current stage is: block-9
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.9595, device='cuda:0', dtype=torch.float64)
u_obs variance
tensor([ 0.2606,  1.7266,  1.7349, 22.5714, 11.2016, 21.2893,  0.2733,  1.6837,
         1.8448, 19.5677, 10.5977, 24.9217], device='cuda:0',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 1.572246
         Iterations: 0
         Function evaluations: 15
         Gradient evaluations: 3
convolution moment and kernels
[[ 1.00e+00  0.00e+00  9.64e-04 -1.26e-02 -5.74e-02]
 [ 0.00e+00 -3.52e-05  6.25e-03 -1.50e-03  4.22e-02]
 [ 9.06e-04  2.56e-02  9.71e-03 -2.14e-02  9.02e-03]
 [ 1.99e-02  8.18e-03 -6.87e-03  2.53e-03  1.81e-02]
 [-1.19e-01  6.12e-02 -5.96e-02  2.21e-03 -1.22e-02]]
[[-0.01 -0.04 -0.1   0.03 -0.02]
 [ 0.03  0.22  0.2   0.02  0.03]
 [-0.12 -0.04  0.32  0.25 -0.12]
 [ 0.05  0.17  0.22 -0.04  0.05]
 [ 0.   -0.09  0.01 -0.02 -0.  ]]
[[ 0.00e+00  1.00e+00  0.00e+00 -7.36e-02 -5.57e-02]
 [ 0.00e+00  0.00e+00  7.55e-03  1.89e-03  1.87e-02]
 [ 0.00e+00  2.05e-02  1.74e-02  3.71e-02 -9.49e-03]
 [-6.17e-04  1.77e-03  4.54e-03  6.14e-03  6.55e-03]
 [ 4.19e-03 -1.58e-02  1.11e-02 -5.32e-03 -8.33e-04]]
[[ 1.70e-03  1.86e-02 -2.60e-02  1.67e-02 -6.55e-03]
 [-4.35e-02  4.61e-02 -5.49e-02  1.82e-02  1.67e-02]
 [ 1.31e-01 -5.89e-01 -2.54e-01  9.46e-01 -2.09e-01]
 [-2.72e-02 -7.09e-03  1.46e-02 -2.02e-02  2.38e-02]
 [ 2.10e-03  1.39e-02 -1.42e-02  2.67e-03 -6.17e-04]]
[[ 0.00e+00  0.00e+00  0.00e+00  5.23e-03  1.12e-02]
 [ 1.00e+00  0.00e+00  1.08e-02 -2.63e-03 -2.77e-02]
 [ 0.00e+00  4.01e-03 -1.12e-02 -1.22e-02  2.83e-03]
 [-7.94e-02  3.75e-04  1.44e-02 -1.54e-03 -2.16e-02]
 [-8.22e-02  6.80e-03 -3.97e-02 -1.43e-02 -9.10e-03]]
[[ 0.01 -0.07  0.15 -0.04 -0.  ]
 [ 0.    0.11 -0.57 -0.    0.05]
 [-0.01 -0.15 -0.27 -0.01 -0.06]
 [ 0.01  0.06  0.99 -0.05  0.05]
 [-0.01  0.01 -0.23  0.05 -0.02]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00 -2.00e-02]
 [ 0.00e+00  0.00e+00  0.00e+00 -6.31e-05 -8.31e-03]
 [ 0.00e+00  0.00e+00  5.07e-03 -8.90e-03 -4.52e-03]
 [ 0.00e+00  3.75e-03 -3.23e-03 -6.94e-04  3.41e-03]
 [ 1.12e-01 -8.99e-03  2.67e-03  1.58e-02  3.73e-03]]
[[-0.01  0.02  0.11 -0.03  0.01]
 [ 0.03 -0.06 -0.5   0.14 -0.05]
 [-0.13  1.44 -1.75  1.13 -0.01]
 [ 0.01  0.02 -0.63  0.21 -0.07]
 [-0.   -0.    0.15 -0.05  0.02]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00 -3.74e-03]
 [ 0.00e+00  1.00e+00  0.00e+00 -6.43e-03 -3.62e-03]
 [ 0.00e+00  0.00e+00 -1.29e-03  4.70e-04  2.73e-03]
 [ 0.00e+00 -6.72e-03 -5.49e-03  9.09e-03  4.15e-03]
 [-3.34e-03 -7.59e-04  4.45e-04  1.02e-03 -1.24e-03]]
[[ 0.01 -0.04 -0.03  0.08 -0.01]
 [-0.04  0.38  0.13 -0.53  0.08]
 [-0.02  0.09 -0.14  0.07 -0.02]
 [ 0.07 -0.47  0.02  0.46 -0.06]
 [-0.01  0.06  0.01 -0.07  0.01]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00 -2.56e-03]
 [ 0.00e+00  0.00e+00  0.00e+00  3.19e-03 -7.13e-03]
 [ 1.00e+00  0.00e+00  2.58e-03 -4.74e-03 -3.62e-03]
 [ 0.00e+00  4.36e-03 -2.31e-03 -3.11e-03  2.21e-04]
 [ 6.08e-03 -4.00e-03  5.34e-02  3.42e-03 -1.43e-03]]
[[-9.69e-03  8.96e-02 -2.24e-01  7.01e-02 -3.03e-03]
 [ 3.79e-02 -3.46e-01  1.88e+00 -2.68e-01  9.25e-03]
 [-4.64e-02  4.75e-01 -3.26e+00  3.79e-01 -1.01e-02]
 [ 2.16e-02 -2.83e-01  1.80e+00 -2.38e-01  4.87e-03]
 [-5.91e-03  7.43e-02 -2.10e-01  6.79e-02 -3.61e-03]]
SymNet parameters
[[ 6.96e-02  5.28e-03 -1.15e-03  2.63e-03  1.46e-03  1.66e-03  2.13e+00  7.10e-02
   1.13e-02 -2.37e-04  4.66e-04 -3.08e-03]
 [-1.76e-02  1.07e-02 -3.41e-01  6.86e-04 -1.23e-02  3.21e-04  2.15e-02  7.46e-04
  -3.71e-02  3.37e-04 -1.43e-04 -7.60e-04]]
SymNet parameters
[1.27 0.28]
SymNet parameters
[[-1.66e-01  1.90e-03 -2.20e+00  2.66e-02  3.28e-02  1.52e-02  2.67e-01  1.28e-02
  -2.38e-01  5.01e-03 -1.62e-03 -4.91e-04 -4.75e-02]
 [-6.11e-02 -2.69e-03 -1.72e-04  1.80e-03 -9.75e-04  1.80e-03 -1.65e+00  3.31e-02
  -1.40e-02  1.09e-03 -2.95e-04  3.21e-03 -5.70e-03]]
SymNet parameters
[-1.34 -0.23]
SymNet parameters
[[ 2.49e-01  2.71e+00  3.84e-01  2.99e-01 -1.86e-02  1.21e-01 -2.45e+00 -8.76e-02
  -5.63e-02 -1.11e-02  2.37e-02 -3.09e-04  1.04e+00  1.59e-01]
 [ 2.69e-01  1.29e-01  2.19e-02  1.38e-02 -9.41e-04  2.31e-03  2.52e-01 -5.07e-03
   2.59e-02 -2.64e-04  1.10e-03 -1.27e-03  1.80e-02  1.01e-02]]
SymNet parameters
[ 1.24 -0.29]
SymNet parameters
[[ 5.96e-01  4.44e+00 -4.86e-01 -8.47e-01  1.09e-01 -2.99e-01 -3.57e+00  2.15e-01
  -5.66e-02  3.66e-02 -7.36e-02  3.10e-02  8.80e-01  1.37e-01 -1.62e-02]
 [ 3.62e+00 -5.41e-01 -6.35e-02  2.90e-02  1.01e-03  1.24e-02 -2.32e+00 -1.58e-02
   1.47e-01 -1.03e-02  5.46e-03  9.45e-03  8.48e-02 -5.05e-02 -2.46e-02]]
SymNet parameters
[-0.18  0.53]
SymNet parameters
[[-4.40e+00  2.26e+00  6.81e-01  8.11e-01 -6.26e-02  3.03e-01 -3.09e+00 -2.74e-01
   8.47e-01 -4.94e-02  7.78e-02 -6.70e-03  1.24e+00  1.98e-01  5.59e-02  4.49e-03]
 [ 2.93e-01 -8.38e-01 -9.33e-02 -2.74e-02  1.04e-04 -1.59e-03 -1.08e+00  4.10e-03
   1.38e-02 -1.77e-03 -7.03e-04  4.89e-03 -1.29e-01 -6.14e-02  1.21e-02 -1.37e-03]]
SymNet parameters
[-0.74  1.45]
SymNet parameters
[[-0.17 -0.01  0.31  0.08  0.    0.06  0.33 -0.03  0.14 -0.    0.   -0.    0.45 -0.17
  -0.48 -0.02 -0.06]]
SymNet parameters
[-0.35]
SymNet parameters
[[-3.18e-01 -3.02e-02  2.62e-02  2.92e-03 -5.04e-03  9.88e-03 -2.71e-01  1.58e+00
   1.26e-02 -9.01e-02 -4.13e-02 -7.61e-02]
 [-1.79e-01 -3.68e-03  8.00e-03 -1.05e-04  7.85e-05  3.34e-04 -1.18e-02 -1.11e-03
   7.96e-03 -5.61e-05 -6.10e-04  2.13e-03]]
SymNet parameters
[3.96 0.58]
SymNet parameters
[[ 8.68e-01 -4.05e-01  5.28e-02 -3.25e-03 -3.60e-03  1.02e-02 -6.32e+00  2.36e-01
   2.19e-01 -1.73e-02 -5.20e-03  6.94e-03 -3.65e-01]
 [ 8.08e-02  5.35e-02 -1.83e-02  9.38e-03 -2.44e-03 -6.71e-03  7.38e-01 -6.26e+00
   8.08e-01  3.37e-01 -9.28e-02 -1.16e-01 -9.94e-02]]
SymNet parameters
[ 0.26 -0.95]
SymNet parameters
[[ 3.27e+00 -1.25e-02  1.73e-01  8.73e-03 -6.25e-03  1.72e-02  9.01e-01  9.30e-01
   8.98e-01 -7.12e-02  2.34e-02 -1.99e-01 -9.22e-01  8.53e-04]
 [ 3.66e+00 -4.19e-02  3.40e-01  2.03e-02 -1.47e-02  4.22e-02 -4.92e+00  3.87e+00
   1.82e+00 -1.29e-01  5.91e-02 -4.12e-01 -2.01e+00 -8.60e-03]]
SymNet parameters
[1.12 2.46]
SymNet parameters
[[-3.85e+00  5.33e-02 -3.22e-01 -1.91e-02  1.35e-02 -3.80e-02 -1.36e+00 -1.87e+00
  -1.88e+00  1.44e-01 -4.53e-02  3.94e-01  1.86e+00 -2.53e-03 -2.66e-04]
 [-1.33e+00  2.49e-03 -7.70e-02 -3.98e-03  2.96e-03 -8.40e-03  1.30e+00 -8.21e-01
  -3.61e-01  2.75e-02 -1.23e-02  8.86e-02  4.34e-01  1.77e-03  3.82e-04]]
SymNet parameters
[-2.   -0.33]
SymNet parameters
[[ 1.39e+00  2.41e-02 -4.51e-02 -8.16e-03  3.38e-03 -1.15e-02 -9.60e-02  1.67e-01
   5.16e-01 -7.68e-03 -3.26e-02  1.04e-01 -1.48e-01 -1.44e-04 -3.22e-03  2.94e-03]
 [ 4.68e-02 -9.77e-04  1.74e-03  6.96e-05  1.85e-04  6.16e-05  8.20e-01  8.52e-02
   4.35e-03 -3.06e-03 -2.22e-03 -3.76e-03 -5.42e-02  2.98e-04 -1.09e-02  2.65e-02]]
SymNet parameters
[-0.72 -1.  ]
SymNet parameters
[[-0.25 -0.02  0.09  0.01 -0.01  0.02 -1.23 -0.23 -0.18  0.06  0.06 -0.12  0.27  0.01
  -0.29  0.7  -0.92]]
SymNet parameters
[0.03]
finally, finish this stage
iter:     0    time: 33.46
Func: 1.57e+00  |g|: 5.81e+02
stableloss: 9.16e-02   dataloss: 1.51e+00   sparseloss: 1.44e+02 momentloss: 7.11e+00
current expression:
[u00*u01, u10*v00, u20, u02, u00*u01**2, u10*v00*v10, u00*u10*v01, u01*u10*v00, u00*u11*v00, u00**2*u01, u00, u01, v00, u01*v00, u01*u10, u00**2*u02, u10*v20, u00*v10, u02*v00**2, u01*u20]
[-0.99 -0.98  0.05  0.05  0.01  0.01  0.01  0.01  0.01 -0.    0.    0.   -0.    0.
 -0.    0.    0.   -0.    0.    0.  ]
[v00*v10, u00*v01, v20, v02, v00*v10**2, u00*u01*v01, u00*v01*v10, u10*v00*v01, u00*v00*v11, v00, v10, v00**3, u00**2*v02, v00*v01, u00, u00*v10, u10*v00**2, v10**2, v00**2, u00**2*v00**2]
[-0.99 -0.98  0.05  0.05  0.01  0.01  0.01  0.01  0.01  0.01  0.   -0.    0.    0.
 -0.    0.   -0.   -0.    0.   -0.  ]
u_obs.abs().max()
tensor(3.9016, device='cuda:0', dtype=torch.float64)
model(u_obs[0],T=50*dt).abs().max()
tensor(nan, device='cuda:0', dtype=torch.float64)
model(u_obs[0],T=100*dt).abs().max()
tensor(nan, device='cuda:0', dtype=torch.float64)
{'--name': 'burgers-2-upwind-sparse0-noise0.001-id21', '--dtype': 'double', '--device': 'cuda:1', '--constraint': '2', '--dt': 0.01, '--cell_num': 1, '--eps': 6.283185307179586, '--blocks': [0, 1, 2, 3, 4, 5, 6, 9], '--kernel_size': 5, '--max_order': 2, '--dx': 0.19634954084936207, '--hidden_layers': 5, '--scheme': 'upwind', '--dataname': 'burgers', '--viscosity': 0.05, '--zoom': 4, '--max_dt': 0.000625, '--batch_size': 28, '--data_timescheme': 'rk2', '--channel_names': 'u,v', '--freq': 4, '--data_start_time': 1.0, '--start_noise': 0.001, '--end_noise': 0.001, '--stablize': 0.0, '--sparsity': 0.0, '--momentsparsity': 0.001, '--npseed': -1, '--torchseed': -1, '--maxiter': 2000, '--recordfile': 'None', '--recordcycle': 200, '--savecycle': -1, '--start_from': -1}
block:  0
name:  burgers-2-upwind-sparse0-noise0.001-id21
device:  cuda:1
generate a random number to check random seed:  -1.2218831789896842
current stage is: warmup
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.8731, device='cuda:1', dtype=torch.float64)
u_obs variance
tensor([ 0.2642,  2.1985,  2.0548, 20.3845, 10.8017, 17.8561,  0.2880,  2.1875,
         2.3209, 18.8409, 10.8966, 21.2990], device='cuda:1',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
iter:     0    time: 6.69
Func: 5.63e+00  |g|: 2.69e+00
stableloss: 2.11e-03   dataloss: 5.63e+00   sparseloss: 2.71e+01 momentloss: 7.27e+00
iter:   200    time: 12.69
Func: 3.57e-02  |g|: 1.78e-02
stableloss: 1.66e-02   dataloss: 3.57e-02   sparseloss: 5.13e+01 momentloss: 7.27e+00
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 0.033528
         Iterations: 391
         Function evaluations: 458
         Gradient evaluations: 452
convolution moment and kernels
[[1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
[[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 1. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
[[ 0.    1.    0.   -0.33 -0.25]
 [ 0.    0.    0.    0.    0.  ]
 [ 0.    0.    0.    0.    0.  ]
 [ 0.    0.    0.    0.    0.  ]
 [ 0.    0.    0.    0.    0.  ]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]
 [ 2.78e-17  3.33e-16 -1.50e+00  2.00e+00 -5.00e-01]
 [ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]]
[[ 0.    0.    0.    0.    0.  ]
 [ 1.    0.    0.    0.    0.  ]
 [ 0.    0.    0.    0.    0.  ]
 [-0.33  0.    0.    0.    0.  ]
 [-0.25  0.    0.    0.    0.  ]]
[[ 0.00e+00  0.00e+00  2.78e-17  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  3.33e-16  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00 -1.50e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  2.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00 -5.00e-01  0.00e+00  0.00e+00]]
[[0.   0.   1.   0.   0.08]
 [0.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.  ]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]
 [-2.22e-16  1.00e+00 -2.00e+00  1.00e+00 -1.53e-16]
 [ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]]
[[0. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
[[ 6.94e-03 -5.56e-02  9.25e-18  5.56e-02 -6.94e-03]
 [-5.56e-02  4.44e-01 -7.40e-17 -4.44e-01  5.56e-02]
 [ 9.25e-18 -7.40e-17  1.23e-32  7.40e-17 -9.25e-18]
 [ 5.56e-02 -4.44e-01  7.40e-17  4.44e-01 -5.56e-02]
 [-6.94e-03  5.56e-02 -9.25e-18 -5.56e-02  6.94e-03]]
[[0.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.  ]
 [1.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.  ]
 [0.08 0.   0.   0.   0.  ]]
[[ 0.00e+00  0.00e+00 -2.22e-16  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  1.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00 -2.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  1.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00 -1.53e-16  0.00e+00  0.00e+00]]
SymNet parameters
[[ 3.13e-01 -5.56e-01 -8.29e-02  1.70e-01 -9.54e-02 -5.48e-02  8.64e-01 -6.87e-02
   3.50e-02  2.17e-02 -4.66e-02  7.78e-04]
 [ 9.37e-01  2.09e-02 -4.00e-02  1.22e-02 -2.52e-03 -5.58e-03 -1.84e-01 -7.27e-03
   2.66e-03  1.83e-03 -2.47e-03  3.19e-04]]
SymNet parameters
[-0.3  -0.13]
SymNet parameters
[[-1.14  0.07  0.33 -0.32 -0.16 -0.11 -0.84 -0.01 -0.05 -0.   -0.02 -0.02  0.07]
 [-0.75  0.31 -0.01 -0.07 -0.02  0.01  1.16 -0.08  0.01  0.04 -0.04  0.08 -0.2 ]]
SymNet parameters
[-0.02  0.09]
SymNet parameters
[[-5.46e-01  1.98e-01  1.17e-01  2.13e-02 -1.96e-02 -3.58e-03  1.44e+00 -2.52e-03
   6.39e-05  1.58e-03 -6.23e-03 -1.17e-03  1.28e-03 -4.92e-03]
 [-3.47e-01  9.20e-01 -9.78e-01  3.28e-01 -1.83e-01 -9.76e-02 -6.50e-01 -1.31e-01
   6.94e-02  4.07e-02 -9.05e-02  2.07e-04  7.69e-04  2.84e-02]]
SymNet parameters
[-0.46  0.31]
SymNet parameters
[[-0.07  0.21  0.19 -0.28 -0.24  0.31 -0.15  0.33 -0.03 -0.05  0.01 -0.05  0.61  0.08
   0.07]
 [ 0.5   0.19 -0.02  0.08 -0.01 -0.04  0.77 -0.05  0.01  0.01 -0.02  0.   -0.03  0.01
  -0.01]]
SymNet parameters
[-0.12 -0.15]
SymNet parameters
[[ 0.91  0.13 -0.24  0.12  0.02 -0.09  2.23 -0.1   0.02  0.02 -0.02  0.01 -0.12  0.
  -0.01 -0.02]
 [-1.76 -0.99 -0.64 -0.55 -0.04  0.37  0.85  0.41 -0.08 -0.08  0.09 -0.05  0.46  0.05
   0.06 -0.02]]
SymNet parameters
[-0.18 -0.17]
SymNet parameters
[[ 0.27  0.   -0.22  0.1  -0.02  0.01 -0.11 -0.03  0.01  0.01 -0.02  0.    0.82  0.
   0.31 -0.46  0.2 ]]
SymNet parameters
[-4.65e-05]
SymNet parameters
[[-0.12  0.06  0.02 -0.    0.    0.    0.72  0.08  0.03  0.01  0.02  0.04]
 [-0.56  0.2  -0.05 -0.07  0.05 -0.03  0.41 -0.09 -0.49  0.05 -0.08  0.73]]
SymNet parameters
[-0.14 -0.2 ]
SymNet parameters
[[-0.4  -0.28  0.4  -0.    0.1  -0.11 -0.11  0.65 -0.13  0.26  0.7   0.66  0.76]
 [ 1.21  0.07  0.08  0.   -0.01  0.01  0.05  0.07 -0.07 -0.06  0.    0.09 -0.11]]
SymNet parameters
[ 0.09 -0.04]
SymNet parameters
[[ 6.99e-01  1.10e-01  4.05e-02 -3.63e-03  1.93e-03  4.98e-03  7.47e-01  2.41e-01
  -1.29e-01  1.20e-02  3.40e-02  1.58e-02 -4.76e-03  7.45e-04]
 [ 3.06e-01 -8.13e-02  2.00e-03  2.41e-02 -1.97e-02  1.26e-02 -2.80e-01 -1.31e+00
  -6.85e-01 -2.26e-02  1.37e-02 -2.58e-01 -4.42e-02  5.40e-03]]
SymNet parameters
[-0.11  0.01]
SymNet parameters
[[-6.46e-01  9.93e-02  2.81e-02 -8.09e-03  6.34e-03  4.35e-04  8.74e-01  2.38e-01
   1.14e-01  1.38e-02  2.03e-02  7.50e-02  3.78e-03 -3.48e-03  5.09e-04]
 [-2.61e-01 -9.53e-02 -8.59e-02 -2.18e-02  1.56e-02 -1.77e-02  1.33e-01 -1.11e+00
   6.51e-01  1.46e-03 -8.78e-02  2.51e-01  1.09e-02 -7.15e-03 -2.34e-03]]
SymNet parameters
[-0.2  -0.01]
SymNet parameters
[[-0.19  0.4   0.13 -0.02  0.02  0.01 -0.16  0.18  0.05  0.05  0.1   0.17 -0.05 -0.01
  -0.02  0.03]
 [ 0.43 -0.05 -0.03  0.    0.   -0.   -0.57 -0.01  0.55  0.   -0.02  0.   -0.   -0.01
  -0.03  0.02]]
SymNet parameters
[0.03 0.  ]
SymNet parameters
[[-0.01  0.03  0.01 -0.   -0.    0.    0.07  0.06 -0.17  0.04  0.01  0.05  0.56  0.01
   0.55 -0.67  0.39]]
SymNet parameters
[-0.03]
finally, finish this stage
iter:   391    time: 15.26
Func: 3.35e-02  |g|: 6.54e-03
stableloss: 1.64e-02   dataloss: 3.35e-02   sparseloss: 6.22e+01 momentloss: 7.27e+00
current expression:
[u10*v00, u00*u01, u00, u20, u02, u00*v00, u00**3, 1, u00*u01**2, u00*u11*v00, u01*v00, u00**2, u00**2*u02, v01, u00**2*v00, u01*u10, u00*u02*v00, u20*v00**2, u10, u00**2*v00**2]
[-0.89 -0.89  0.05  0.04  0.04  0.01 -0.01 -0.01  0.01  0.01 -0.01  0.01 -0.01  0.01
  0.01  0.01  0.01 -0.01 -0.   -0.  ]
[v00*v10, u00*v01, v20, v02, 1, v00**2, u00*v00, v00**2*v20, u00*v00*v10, v00*v10**2, u00*v00*v11, u00*v01*v10, u00**2, v00, v00*v20, v00**3, u00*u01*v00, u00*u01*v01, v00*v01, u00*v00**2*v20]
[-0.89 -0.89  0.04  0.04 -0.02  0.01 -0.01 -0.01  0.01  0.01  0.01  0.01  0.01 -0.01
  0.01 -0.01 -0.01  0.01 -0.    0.  ]
block:  1
name:  burgers-2-upwind-sparse0-noise0.001-id21
device:  cuda:1
generate a random number to check random seed:  -1.9692118393291222
current stage is: block-1
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.7108, device='cuda:1', dtype=torch.float64)
u_obs variance
tensor([ 0.2692,  2.2755,  2.2165, 21.2642, 11.8303, 19.5091,  0.2505,  2.0854,
         2.0673, 18.2243, 10.4056, 18.7989], device='cuda:1',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
iter:     0    time: 1643.59
Func: 4.88e-02  |g|: 7.39e-01
stableloss: 1.62e-02   dataloss: 4.15e-02   sparseloss: 6.22e+01 momentloss: 7.27e+00
iter:   200    time: 11.07
Func: 2.01e-02  |g|: 2.75e-02
stableloss: 9.59e-03   dataloss: 1.35e-02   sparseloss: 6.17e+01 momentloss: 6.60e+00
iter:   400    time: 10.72
Func: 1.93e-02  |g|: 1.01e-02
stableloss: 9.09e-03   dataloss: 1.28e-02   sparseloss: 6.57e+01 momentloss: 6.53e+00
iter:   600    time: 10.40
Func: 1.92e-02  |g|: 3.15e-03
stableloss: 9.01e-03   dataloss: 1.26e-02   sparseloss: 6.69e+01 momentloss: 6.52e+00
iter:   800    time: 10.45
Func: 1.91e-02  |g|: 5.44e-03
stableloss: 9.03e-03   dataloss: 1.26e-02   sparseloss: 6.74e+01 momentloss: 6.51e+00
iter:  1000    time: 10.40
Func: 1.90e-02  |g|: 3.48e-03
stableloss: 9.12e-03   dataloss: 1.25e-02   sparseloss: 6.76e+01 momentloss: 6.51e+00
iter:  1200    time: 10.50
Func: 1.89e-02  |g|: 2.87e-03
stableloss: 9.24e-03   dataloss: 1.24e-02   sparseloss: 6.89e+01 momentloss: 6.52e+00
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 0.018889
         Iterations: 1328
         Function evaluations: 1376
         Gradient evaluations: 1368
convolution moment and kernels
[[ 1.00e+00  0.00e+00 -1.95e-04 -4.42e-02 -5.32e-02]
 [ 0.00e+00 -3.76e-05  2.62e-03  2.12e-04 -8.36e-03]
 [-1.10e-06  3.31e-03  5.13e-03 -2.46e-03 -4.05e-03]
 [ 8.65e-03 -3.79e-04 -3.04e-03  1.28e-03  2.26e-03]
 [-3.51e-02 -2.66e-04  4.77e-05  8.94e-03 -4.89e-04]]
[[-0.01  0.02 -0.05  0.    0.  ]
 [ 0.02 -0.06  0.17  0.03 -0.02]
 [-0.05  0.19  0.55  0.14 -0.04]
 [ 0.01  0.02  0.04  0.1  -0.03]
 [-0.    0.   -0.02 -0.02  0.01]]
[[ 0.00e+00  1.00e+00  0.00e+00 -1.06e-01 -6.32e-02]
 [ 0.00e+00  0.00e+00  3.82e-03  2.46e-03 -5.23e-03]
 [ 0.00e+00  2.60e-02  1.01e-02  6.27e-03 -1.07e-02]
 [ 2.64e-03 -5.71e-04  8.56e-04 -3.39e-03 -9.16e-03]
 [ 5.84e-03 -2.44e-03  1.85e-03 -9.99e-03 -1.69e-03]]
[[ 7.22e-03 -1.79e-02  2.23e-02 -6.44e-03 -6.78e-04]
 [-3.15e-02  7.26e-02 -1.11e-01  4.44e-02  4.47e-03]
 [ 1.22e-01 -6.27e-01 -2.10e-01  9.63e-01 -2.13e-01]
 [-2.54e-02  4.10e-02 -5.62e-02 -5.85e-03  2.05e-02]
 [ 7.64e-04  1.21e-02 -2.53e-02  3.04e-02 -1.08e-02]]
[[ 0.00e+00  0.00e+00  0.00e+00  2.53e-03  1.78e-02]
 [ 1.00e+00  0.00e+00  9.58e-03 -1.35e-03 -2.05e-02]
 [ 0.00e+00  3.29e-03  5.14e-03 -7.38e-04 -4.59e-04]
 [-7.57e-02 -2.37e-03  8.24e-03  2.48e-04 -1.48e-02]
 [-6.48e-02  2.58e-03 -7.75e-03  9.70e-03 -5.50e-03]]
[[-3.27e-03 -9.11e-03  8.66e-02 -2.35e-02  5.67e-03]
 [ 3.55e-02 -6.10e-02 -4.61e-01  5.18e-03 -1.71e-03]
 [-3.98e-02  3.47e-02 -3.25e-01 -8.08e-02  2.16e-02]
 [ 3.97e-02 -8.08e-02  1.05e+00 -3.68e-03 -6.09e-04]
 [-1.57e-02  4.74e-02 -2.41e-01  2.89e-02 -5.86e-03]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00 -5.98e-03]
 [ 0.00e+00  0.00e+00  0.00e+00  1.82e-04 -1.98e-03]
 [ 0.00e+00  0.00e+00  4.20e-03  3.37e-03 -2.93e-03]
 [ 0.00e+00 -2.19e-04 -8.46e-04  1.74e-04 -1.80e-04]
 [ 2.16e-03  2.63e-03 -2.69e-03 -1.71e-03  1.34e-03]]
[[ 2.98e-03 -1.34e-02  1.77e-02 -5.62e-03  4.61e-04]
 [-1.60e-02  7.17e-02 -9.60e-02  3.45e-02 -2.80e-03]
 [-6.11e-02  1.23e+00 -2.36e+00  1.29e+00 -8.24e-02]
 [-1.83e-02  8.27e-02 -1.14e-01  4.63e-02 -5.32e-03]
 [ 3.12e-03 -1.48e-02  2.07e-02 -7.64e-03  7.72e-04]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  1.84e-03]
 [ 0.00e+00  1.00e+00  0.00e+00 -9.13e-04  4.58e-04]
 [ 0.00e+00  0.00e+00 -7.43e-04 -4.84e-04  6.95e-04]
 [ 0.00e+00 -1.09e-03 -6.19e-05  1.77e-03 -2.04e-04]
 [-2.27e-04  3.73e-04  1.56e-03 -3.65e-05 -3.53e-03]]
[[ 0.   -0.04 -0.03  0.07 -0.01]
 [-0.04  0.38  0.11 -0.52  0.07]
 [-0.02  0.1  -0.16  0.1  -0.02]
 [ 0.07 -0.52  0.11  0.38 -0.04]
 [-0.01  0.07 -0.03 -0.04  0.  ]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  6.04e-03]
 [ 0.00e+00  0.00e+00  0.00e+00 -5.24e-04 -4.67e-04]
 [ 1.00e+00  0.00e+00  3.55e-04  1.93e-03  8.18e-04]
 [ 0.00e+00  1.24e-04  2.29e-05  6.43e-06 -1.01e-03]
 [ 1.33e-03  2.96e-03  1.52e-03 -5.98e-04 -6.75e-03]]
[[-0.01  0.02 -0.12  0.03 -0.01]
 [ 0.02 -0.1   1.51 -0.13  0.03]
 [-0.03  0.14 -2.73  0.18 -0.04]
 [ 0.03 -0.11  1.51 -0.14  0.03]
 [-0.01  0.03 -0.13  0.03 -0.01]]
SymNet parameters
[[ 0.38 -1.06  0.18 -0.02 -0.12 -0.01  0.48  0.05 -0.07 -0.01 -0.    0.  ]
 [ 0.84 -0.01 -0.02  0.06 -0.02 -0.01  0.27  0.01 -0.02 -0.    0.    0.  ]]
SymNet parameters
[-0.13 -0.35]
SymNet parameters
[[-1.7  -0.22  1.81 -0.16 -0.12  0.26 -0.56 -0.28  0.37  0.02  0.06  0.03 -0.82]
 [-0.43  0.68  0.59 -0.01 -0.18 -0.02  1.92 -0.26  0.5  -0.01 -0.04 -0.04  0.35]]
SymNet parameters
[-0.09  0.19]
SymNet parameters
[[-1.66e-01  1.19e-01  2.39e-02  2.47e-02 -2.31e-03 -2.70e-03  1.42e+00  5.06e-03
  -2.80e-03 -1.93e-03  5.33e-04  1.25e-03 -1.00e-02 -8.38e-04]
 [-1.10e-01  4.91e-01 -1.68e+00  3.52e-01 -1.28e-01 -5.45e-02 -6.90e-02  7.78e-02
  -1.57e-01 -2.24e-02  7.55e-03  1.08e-02 -8.84e-02  1.70e-03]]
SymNet parameters
[-0.45  0.43]
SymNet parameters
[[ 1.78e-01  5.69e-03  6.99e-01 -4.89e-01 -2.12e-01  3.88e-02 -9.13e-01  9.13e-02
  -5.27e-02 -8.56e-04 -2.52e-02 -4.62e-03  6.50e-02  1.11e-02  6.18e-02]
 [ 1.06e+00  5.77e-02 -2.42e-02  4.02e-02 -9.91e-03 -5.81e-03  3.01e-01 -3.73e-03
  -9.90e-03 -1.02e-03  2.53e-04  1.06e-03  9.18e-03  8.96e-04 -4.40e-03]]
SymNet parameters
[ 0.03 -0.41]
SymNet parameters
[[ 1.07e+00 -5.50e-01 -1.14e-01  6.39e-02 -6.06e-02 -1.15e-02  2.17e+00  1.19e-02
  -4.72e-02 -7.06e-03  7.77e-04  4.78e-03  1.47e-02  2.87e-04 -8.93e-03 -1.92e-02]
 [-3.31e+00  3.78e-01 -9.12e-01 -1.04e+00  4.04e-01  1.60e-01 -9.10e-01 -2.18e-01
   4.66e-01  6.54e-02 -1.97e-02 -3.33e-02  1.47e-01  1.30e-02  2.90e-02 -7.67e-02]]
SymNet parameters
[ 0.02 -0.18]
SymNet parameters
[[ 3.51e-01 -4.46e-01 -2.49e-01  1.61e-01 -5.36e-02  3.25e-02  2.14e-01  3.05e-02
  -6.09e-02 -7.85e-03  1.37e-03  4.25e-03  1.31e+00  6.73e-04  3.19e-01 -2.87e-01
   1.08e-01]]
SymNet parameters
[-0.]
SymNet parameters
[[-9.89e-03 -3.54e-04  7.32e-04  3.20e-04  6.38e-05 -2.39e-04  1.83e-02 -1.04e-04
  -6.43e-05  1.77e-04  1.52e-04 -3.42e-04]
 [ 1.08e-01 -1.84e-01  2.17e-01  9.02e-03 -1.12e-02  9.55e-03 -1.40e-01  6.51e-01
  -7.09e-01  4.58e-01 -2.42e-01  3.41e-01]]
SymNet parameters
[-0.06 -0.21]
SymNet parameters
[[ 3.16e-01 -2.63e-01  6.57e-02  7.52e-03 -1.10e-03  1.82e-02 -9.37e-02  3.57e+00
   3.43e-01  1.18e-01  2.33e-01  1.12e-01  1.40e+00]
 [ 1.64e+00  3.99e-02  1.22e-01 -8.58e-05 -1.12e-03 -2.83e-03  1.49e-01 -3.84e-02
  -1.67e-02 -2.08e-02  1.48e-02 -2.37e-02 -2.84e-01]]
SymNet parameters
[ 0.11 -0.08]
SymNet parameters
[[ 1.36e+00  3.96e-02 -1.44e-02  3.65e-04  1.43e-03  6.14e-05  1.49e-01 -1.92e-03
   3.81e-03 -1.60e-03  2.59e-03 -1.68e-03 -2.83e-01 -4.60e-04]
 [-1.50e-01  1.24e-01 -1.52e-02  3.30e-03  3.91e-03 -4.33e-04  5.45e-02 -2.00e+00
  -1.00e-01  2.64e-03  1.70e-02 -1.96e-03 -7.69e-01  3.79e-03]]
SymNet parameters
[ 0.07 -0.  ]
SymNet parameters
[[-1.40e-01  7.51e-02 -4.07e-03  1.73e-03  1.52e-03 -3.76e-04  1.30e+00  5.83e-04
  -4.04e-02  1.01e-02 -2.55e-03  6.50e-03 -5.89e-05 -1.60e-03  4.26e-03]
 [-3.08e-01  2.23e-02 -6.26e-03  8.33e-04  3.23e-04 -1.27e-04  5.75e-02 -3.30e-02
   1.65e+00 -2.67e-03 -2.88e-04 -3.20e-03 -3.30e-01 -3.32e-02 -8.77e-02]]
SymNet parameters
[-0.   -0.04]
SymNet parameters
[[-1.25e-01  9.11e-02 -5.59e-03  2.03e-03  2.03e-03 -4.54e-04  3.12e-01  1.37e-02
  -4.81e-02  1.19e-02 -3.13e-03  5.95e-03 -1.11e-02 -1.81e-03 -1.66e-03  6.45e-03]
 [-9.98e-01 -7.29e-03 -3.98e-03  2.09e-03  1.51e-04 -1.32e-03  1.69e-01  3.73e-01
   1.05e+00 -6.35e-03 -3.32e-03 -1.09e-04 -1.46e-02 -2.17e-02 -1.08e-01 -1.67e-03]]
SymNet parameters
[0.01 0.08]
SymNet parameters
[[ 3.27e-02 -1.25e-02  4.15e-03 -5.17e-05 -7.90e-04 -3.36e-04 -5.77e-02  4.74e-02
  -1.56e-02  5.66e-02 -4.91e-03  5.39e-02  3.71e-01 -1.22e-02  3.19e-01 -5.69e-01
   7.54e-01]]
SymNet parameters
[-0.01]
finally, finish this stage
iter:  1328    time: 8.95
Func: 1.89e-02  |g|: 2.78e-03
stableloss: 9.28e-03   dataloss: 1.24e-02   sparseloss: 7.02e+01 momentloss: 6.51e+00
current expression:
[u10*v00, u00*u01, u20, u02, u00*u01**2, u00, u00*u11*v00, u01*u10*v00, v01, v10, u10*v00*v10, 1, u00*u01*v00**2, u00**3, u00*u10*v10, u01**2, u00*u10, u10*v00*v01, u01*v00, u00*u01*v00]
[-0.98 -0.98  0.05  0.05  0.02  0.01  0.01  0.01  0.01 -0.01  0.   -0.    0.   -0.
 -0.    0.   -0.   -0.   -0.   -0.  ]
[v00*v10, u00*v01, v02, v20, v00*v10**2, u00*v00*v11, u00*v01*v10, u10*v00*v01, u00*u01*v01, v00, v10, v01*v10, u00**2*v00, u01*v01, u00**2*v02, u00*v00*v01*v10, v00**2*v02, u00**2*v20, v00**2*v20, u10]
[-0.99 -0.97  0.05  0.05  0.01  0.01  0.01  0.01  0.01 -0.    0.    0.    0.    0.
  0.    0.    0.    0.    0.   -0.  ]
block:  2
name:  burgers-2-upwind-sparse0-noise0.001-id21
device:  cuda:1
generate a random number to check random seed:  1.5050416259595278
current stage is: block-2
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.9454, device='cuda:1', dtype=torch.float64)
u_obs variance
tensor([ 0.2588,  1.8733,  1.7790, 24.4376, 11.9513, 21.2151,  0.2680,  1.6864,
         1.7280, 19.5832,  9.9451, 23.3084], device='cuda:1',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
iter:     0    time: 1186.82
Func: 9.79e-02  |g|: 2.43e+00
stableloss: 2.57e-02   dataloss: 8.49e-02   sparseloss: 7.02e+01 momentloss: 6.51e+00
iter:   200    time: 15.30
Func: 7.90e-02  |g|: 1.65e-01
stableloss: 2.57e-02   dataloss: 6.53e-02   sparseloss: 7.26e+01 momentloss: 6.84e+00
iter:   400    time: 14.83
Func: 7.69e-02  |g|: 4.77e-02
stableloss: 2.59e-02   dataloss: 6.33e-02   sparseloss: 7.77e+01 momentloss: 6.79e+00
iter:   600    time: 14.65
Func: 7.65e-02  |g|: 2.76e-02
stableloss: 2.59e-02   dataloss: 6.29e-02   sparseloss: 8.36e+01 momentloss: 6.78e+00
iter:   800    time: 14.62
Func: 7.63e-02  |g|: 1.55e-02
stableloss: 2.59e-02   dataloss: 6.27e-02   sparseloss: 9.26e+01 momentloss: 6.78e+00
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 0.076288
         Iterations: 940
         Function evaluations: 1006
         Gradient evaluations: 993
convolution moment and kernels
[[ 1.00e+00  0.00e+00  2.44e-04  4.20e-03 -1.00e-01]
 [ 0.00e+00 -1.62e-04  8.54e-04 -5.76e-04 -1.69e-03]
 [ 6.90e-04 -2.49e-03  6.30e-03 -1.43e-02 -5.45e-03]
 [-1.79e-02 -1.58e-03  8.40e-03 -3.12e-04 -8.60e-03]
 [-4.60e-02 -3.39e-03  4.56e-03  7.01e-03  1.25e-02]]
[[ 0.01 -0.06  0.07 -0.08  0.02]
 [-0.04  0.2  -0.22  0.31 -0.09]
 [-0.05  0.15  0.62 -0.03  0.03]
 [-0.02  0.12 -0.05  0.23 -0.07]
 [ 0.   -0.01 -0.02 -0.04  0.01]]
[[ 0.00e+00  1.00e+00  0.00e+00 -9.12e-02 -7.37e-02]
 [ 0.00e+00  0.00e+00  1.77e-03 -5.09e-03  5.32e-03]
 [ 0.00e+00  1.81e-02  4.19e-03  4.49e-02 -9.56e-03]
 [ 1.00e-02  1.91e-03  1.97e-03  1.88e-04  1.01e-03]
 [ 1.82e-02 -2.94e-02  6.72e-03 -7.91e-03 -3.53e-04]]
[[ 3.35e-03  1.49e-02  1.65e-03 -3.26e-03 -3.50e-03]
 [-4.77e-02  2.73e-02 -9.47e-02  2.89e-02  2.34e-02]
 [ 1.36e-01 -5.22e-01 -2.77e-01  1.02e+00 -2.45e-01]
 [-3.93e-02  3.13e-04 -8.03e-02  1.11e-02  2.54e-02]
 [ 2.97e-03  1.65e-02  8.20e-03 -1.26e-03 -3.16e-03]]
[[ 0.00e+00  0.00e+00  0.00e+00  3.45e-03  1.77e-02]
 [ 1.00e+00  0.00e+00  3.16e-02  1.01e-03 -1.66e-02]
 [ 0.00e+00  1.63e-03  1.31e-02 -2.74e-03  3.79e-03]
 [-1.17e-01  9.66e-04  4.49e-02 -5.85e-03  2.60e-04]
 [-6.92e-02 -9.00e-04 -2.67e-03 -3.89e-03  4.80e-05]]
[[ 3.81e-04 -2.39e-02  1.21e-01 -2.46e-02 -2.13e-05]
 [ 9.75e-03  5.28e-03 -5.39e-01  3.48e-03  1.40e-02]
 [ 1.83e-02 -1.06e-01 -2.43e-01 -9.22e-02  6.81e-03]
 [-1.57e-02  4.70e-02  1.01e+00  1.65e-02  1.96e-03]
 [ 3.20e-03  1.01e-02 -2.44e-01  2.27e-02 -3.38e-03]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00 -9.24e-04]
 [ 0.00e+00  0.00e+00  0.00e+00  1.83e-03 -7.42e-03]
 [ 0.00e+00  0.00e+00  3.91e-03 -3.05e-03  2.02e-03]
 [ 0.00e+00  7.99e-04 -1.55e-03 -2.96e-03  7.46e-03]
 [ 7.66e-03 -4.25e-03 -6.57e-04  2.62e-03 -6.12e-03]]
[[-1.33e-02  4.99e-02 -5.57e-02  3.47e-02 -7.98e-03]
 [ 4.99e-02 -1.81e-01  1.91e-01 -1.19e-01  2.82e-02]
 [-1.39e-01  1.53e+00 -2.68e+00  1.45e+00 -1.11e-01]
 [ 2.05e-02 -6.78e-02  3.46e-02 -2.54e-02  7.47e-03]
 [-2.74e-03  9.24e-03  3.87e-04  1.62e-03 -8.57e-04]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  8.42e-04]
 [ 0.00e+00  1.00e+00  0.00e+00 -4.87e-03 -3.39e-04]
 [ 0.00e+00  0.00e+00 -4.72e-05 -2.15e-03 -1.85e-03]
 [ 0.00e+00 -4.89e-03 -2.71e-03  8.70e-03  3.23e-03]
 [-1.92e-03 -7.19e-03  2.98e-03  5.47e-03 -2.63e-03]]
[[ 0.   -0.03 -0.04  0.07 -0.01]
 [-0.03  0.35  0.11 -0.48  0.06]
 [-0.03  0.13 -0.12 -0.    0.01]
 [ 0.08 -0.53  0.06  0.47 -0.07]
 [-0.01  0.08 -0.01 -0.07  0.01]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  5.18e-02]
 [ 0.00e+00  0.00e+00  0.00e+00 -5.73e-04 -4.70e-03]
 [ 1.00e+00  0.00e+00  4.85e-03  1.18e-04 -3.85e-04]
 [ 0.00e+00 -3.13e-03  1.23e-03  1.32e-03  2.61e-03]
 [-1.93e-03  2.37e-03 -2.02e-03 -7.45e-03 -6.23e-03]]
[[-3.23e-03  1.67e-02 -1.25e-01  3.83e-02 -1.21e-02]
 [ 1.20e-02 -5.96e-02  1.48e+00 -1.40e-01  4.57e-02]
 [ 4.10e-02 -1.48e-01 -2.36e+00 -3.91e-02 -6.33e-03]
 [ 2.91e-03 -2.45e-02  1.42e+00 -8.94e-02  3.22e-02]
 [-9.13e-04  8.32e-03 -1.08e-01  2.29e-02 -7.80e-03]]
SymNet parameters
[[ 7.97e-01 -5.05e-01 -2.98e-01 -1.94e-02 -6.74e-02 -4.36e-02  1.66e-01 -1.09e-01
  -1.60e-01  8.66e-04 -1.51e-03 -2.98e-03]
 [ 6.93e-01 -5.01e-03  3.15e-02  2.51e-02 -1.18e-02 -6.99e-03 -4.71e-04 -2.46e-02
  -2.54e-02 -1.16e-03  1.83e-03 -2.77e-03]]
SymNet parameters
[-0.18 -0.53]
SymNet parameters
[[-3.17  0.12  1.97 -0.05 -0.03  0.34 -0.1   0.24  0.15 -0.02  0.02  0.09  0.07]
 [-3.99  0.1  -0.2   0.08 -0.18 -0.13  0.96  0.24  0.84 -0.02 -0.01 -0.11 -0.18]]
SymNet parameters
[-0.14  0.14]
SymNet parameters
[[-1.59e-01 -8.62e-02 -2.31e-02 -3.50e-02  9.67e-03  4.64e-03  1.64e+00  1.62e-02
   9.50e-03 -3.06e-04 -3.05e-03  3.45e-03  2.37e-02 -3.81e-04]
 [ 2.81e-01  4.45e-01 -1.73e+00  1.50e-01 -1.21e-01 -7.09e-02 -6.66e-01 -2.31e-01
  -2.56e-01 -4.66e-03  1.48e-02 -2.05e-02 -2.12e-01  8.16e-03]]
SymNet parameters
[-0.32  0.41]
SymNet parameters
[[ 1.38e-01  1.49e+00 -7.48e-01 -3.81e-01 -4.68e-02 -3.39e-02 -1.83e+00  1.12e-02
  -1.43e-01  2.02e-02 -2.78e-02  3.13e-02  1.13e-01 -2.52e-04  6.28e-02]
 [ 1.31e+00 -2.56e-02 -9.03e-03  3.88e-02 -2.17e-02 -1.40e-02  4.57e-01 -4.45e-02
  -4.75e-02 -2.04e-03  2.99e-03 -5.20e-03  3.27e-02 -3.34e-04 -3.47e-03]]
SymNet parameters
[-0.13 -0.53]
SymNet parameters
[[ 1.66e+00 -6.64e-01  1.90e-01  2.20e-02 -1.89e-02 -1.47e-02  2.26e+00 -4.53e-02
  -5.36e-02 -5.27e-03 -1.37e-03 -4.58e-03  3.61e-02 -1.63e-03 -1.83e-02 -1.37e-02]
 [-5.31e+00 -4.76e-02  2.30e-01 -7.54e-01  3.70e-01  2.18e-01  6.36e-01  7.70e-01
   7.60e-01  2.99e-02 -6.40e-02  9.09e-02  2.29e-01 -2.93e-03  6.80e-02 -2.87e-02]]
SymNet parameters
[-0.18 -0.08]
SymNet parameters
[[ 1.01e+00 -7.30e-01 -3.83e-01  1.12e-01 -7.69e-02  2.47e-03  1.57e-01 -1.45e-01
  -1.74e-01 -2.52e-03  4.00e-03 -1.17e-02  1.96e+00  1.52e-04  3.97e-01 -3.28e-01
   1.17e-01]]
SymNet parameters
[-0.12]
SymNet parameters
[[-2.73e-03 -1.98e-04 -1.41e-04  1.19e-04  2.36e-05 -5.02e-05  2.57e-03  7.55e-03
   7.58e-04  2.80e-04  5.35e-04 -1.74e-04]
 [-9.27e-01 -5.84e-02 -2.32e-01  3.59e-02  7.25e-03 -7.45e-02  1.45e+00  4.90e-02
  -1.13e+00  4.37e-01  2.32e-01  8.83e-01]]
SymNet parameters
[-0.07 -0.19]
SymNet parameters
[[-8.34e-02 -1.91e-01 -4.81e-02  2.74e-02  8.94e-03  7.77e-03  5.54e-01  4.02e+00
   4.43e-01  7.92e-02  2.96e-01  1.38e-01  6.32e-01]
 [ 1.81e+00 -4.04e-03  1.63e-01 -1.14e-02 -3.34e-03  1.54e-02 -4.93e-01 -2.87e-02
   2.89e-01 -1.04e-01 -5.47e-02 -2.17e-01 -1.99e-01]]
SymNet parameters
[ 0.1  -0.01]
SymNet parameters
[[ 1.48e+00 -2.33e-02 -9.21e-03 -1.69e-03  2.17e-04  6.51e-04 -1.49e-01 -8.27e-03
  -2.44e-02 -1.09e-03 -6.90e-04 -2.68e-03  9.90e-02  8.66e-04]
 [ 7.89e-03  4.57e-02  1.56e-02 -1.87e-03  9.94e-04  3.75e-03 -3.12e-01 -2.00e+00
  -1.57e-01 -2.33e-02 -7.32e-03 -5.01e-02 -1.11e+00  5.30e-03]]
SymNet parameters
[-0.    0.09]
SymNet parameters
[[-7.31e-01  1.93e-01 -1.67e-02  1.18e-03  2.05e-03 -1.69e-02  2.12e+00  8.11e-02
  -3.16e-02  6.82e-02  4.18e-02  1.39e-01  5.56e-01  4.11e-03  1.18e-02]
 [-5.78e-01  1.53e-01  3.50e-02 -3.59e-03  5.93e-04  4.47e-04  6.75e-01  6.15e-02
   1.53e+00 -3.66e-02 -1.69e-02 -7.34e-02 -2.22e+00 -1.90e-02 -6.57e-02]]
SymNet parameters
[0.12 0.14]
SymNet parameters
[[-4.89e-01  1.51e-01 -1.29e-02  9.03e-04  1.49e-03 -1.28e-02  1.02e+00  6.08e-02
  -2.34e-02  5.40e-02  3.26e-02  1.09e-01  4.33e-01  3.01e-03  8.00e-03  4.63e-03]
 [-1.11e+00  2.04e-01  2.84e-02 -6.47e-04  1.71e-03 -6.63e-03  1.80e+00 -2.93e-02
   1.93e+00 -2.14e-02 -8.99e-03 -3.89e-02 -2.07e+00 -1.68e-02 -9.45e-02 -1.47e-02]]
SymNet parameters
[0.15 0.07]
SymNet parameters
[[ 2.78e-02  8.25e-03  6.49e-03 -2.01e-03 -5.13e-04  1.92e-03 -2.64e-02  2.19e-02
  -4.71e-02  4.40e-02 -1.94e-03  2.96e-02 -2.89e-01 -6.07e-03  3.35e-01 -8.98e-01
   8.63e-01]]
SymNet parameters
[0.]
finally, finish this stage
iter:   940    time: 13.80
Func: 7.63e-02  |g|: 2.40e-02
stableloss: 2.59e-02   dataloss: 6.27e-02   sparseloss: 9.64e+01 momentloss: 6.78e+00
current expression:
[u00*u01, u10*v00, u20, u02, u00, u00*u01**2, u10*v00*v10, u10, u01*u10*v00, u00*u11*v00, u01, u00**3, u10*v00*v01, u01*v00, u10*v00**2, u00*v00*v01, u01*u10, v00*v10, u00*v00, v01]
[-0.98 -0.97  0.05  0.05  0.01  0.01  0.01  0.01  0.01  0.01  0.01 -0.01  0.    0.
 -0.    0.    0.   -0.   -0.   -0.  ]
[v00*v10, u00*v01, v02, v20, v00*v10**2, u00, u00*u01*v01, u00*v01*v10, 1, u10*v00*v01, v10, u00*v00*v11, v01, u00*v10**2, v00**2, u00*v10, v00**2*v10, u00*v00*v01*v10, u00*v00, u01*v00**2]
[-0.98 -0.98  0.05  0.05  0.02  0.01  0.01  0.01 -0.01  0.01  0.01  0.01  0.01 -0.01
  0.    0.   -0.    0.   -0.   -0.  ]
block:  3
name:  burgers-2-upwind-sparse0-noise0.001-id21
device:  cuda:1
generate a random number to check random seed:  1.952827603370098
current stage is: block-3
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.8704, device='cuda:1', dtype=torch.float64)
u_obs variance
tensor([ 0.2605,  1.7845,  1.7079, 23.0684, 10.1713, 19.2503,  0.2662,  1.6989,
         1.7996, 19.4406, 10.2215, 22.1012], device='cuda:1',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
iter:     0    time: 601.20
Func: 1.71e-01  |g|: 3.25e+01
stableloss: 2.76e-02   dataloss: 1.51e-01   sparseloss: 9.64e+01 momentloss: 6.78e+00
iter:   200    time: 20.05
Func: 1.23e-01  |g|: 2.16e+00
stableloss: 2.62e-02   dataloss: 1.02e-01   sparseloss: 9.60e+01 momentloss: 7.01e+00
iter:   400    time: 19.65
Func: 1.19e-01  |g|: 2.79e-01
stableloss: 2.54e-02   dataloss: 9.78e-02   sparseloss: 9.40e+01 momentloss: 7.01e+00
iter:   600    time: 19.77
Func: 1.18e-01  |g|: 1.47e-01
stableloss: 2.56e-02   dataloss: 9.71e-02   sparseloss: 1.03e+02 momentloss: 7.00e+00
iter:   800    time: 19.72
Func: 1.18e-01  |g|: 1.96e-01
stableloss: 2.57e-02   dataloss: 9.69e-02   sparseloss: 1.12e+02 momentloss: 6.99e+00
iter:  1000    time: 19.71
Func: 1.18e-01  |g|: 2.17e-01
stableloss: 2.57e-02   dataloss: 9.66e-02   sparseloss: 1.21e+02 momentloss: 7.02e+00
iter:  1200    time: 19.33
Func: 1.18e-01  |g|: 1.02e-01
stableloss: 2.58e-02   dataloss: 9.65e-02   sparseloss: 1.22e+02 momentloss: 7.02e+00
iter:  1400    time: 19.00
Func: 1.18e-01  |g|: 8.30e-02
stableloss: 2.58e-02   dataloss: 9.65e-02   sparseloss: 1.23e+02 momentloss: 7.01e+00
iter:  1600    time: 18.74
Func: 1.17e-01  |g|: 1.18e-01
stableloss: 2.57e-02   dataloss: 9.64e-02   sparseloss: 1.25e+02 momentloss: 7.02e+00
iter:  1800    time: 19.02
Func: 1.17e-01  |g|: 8.06e-02
stableloss: 2.57e-02   dataloss: 9.64e-02   sparseloss: 1.23e+02 momentloss: 7.01e+00
Warning: Maximum number of iterations has been exceeded.
         Current function value: 0.117469
         Iterations: 2000
         Function evaluations: 2020
         Gradient evaluations: 2010
convolution moment and kernels
[[ 1.00e+00  0.00e+00 -8.89e-04  2.27e-02 -9.61e-02]
 [ 0.00e+00  9.83e-05  5.14e-03  4.91e-03  4.64e-03]
 [ 1.24e-03  4.42e-03  2.33e-02 -6.69e-02 -8.68e-03]
 [-2.03e-02  8.28e-04  5.48e-03 -7.10e-03 -2.66e-02]
 [-8.93e-02  3.44e-02 -2.90e-03 -2.35e-02  1.05e-02]]
[[ 0.04 -0.15  0.09 -0.07  0.02]
 [-0.1   0.47 -0.27  0.31 -0.08]
 [-0.01 -0.14  0.58  0.03  0.  ]
 [-0.05  0.25  0.13  0.05 -0.01]
 [ 0.01 -0.04 -0.11  0.05 -0.02]]
[[ 0.00e+00  1.00e+00  0.00e+00 -8.72e-02 -5.22e-02]
 [ 0.00e+00  0.00e+00  3.65e-03 -8.34e-04  4.40e-03]
 [ 0.00e+00  3.00e-02  1.05e-02  4.41e-02 -5.61e-03]
 [-1.05e-02 -2.20e-03  5.00e-03  8.33e-03  8.95e-04]
 [ 1.06e-02 -5.79e-03  8.31e-03 -3.75e-03  7.93e-04]]
[[ 5.97e-03 -4.60e-03  9.87e-03  9.14e-03 -4.49e-03]
 [-4.76e-02  7.05e-02 -8.75e-02 -1.35e-02  2.50e-02]
 [ 1.49e-01 -6.48e-01 -1.96e-01  9.79e-01 -2.20e-01]
 [-3.38e-02  2.67e-02 -2.92e-02 -1.60e-02  2.02e-02]
 [ 1.35e-03  1.05e-02 -1.06e-02  4.41e-03 -2.74e-04]]
[[ 0.00e+00  0.00e+00  0.00e+00  4.44e-03  3.40e-03]
 [ 1.00e+00  0.00e+00  1.61e-02  1.19e-03 -1.76e-02]
 [ 0.00e+00 -3.38e-03  1.16e-03 -2.13e-02  3.32e-03]
 [-7.47e-02 -4.00e-03  1.55e-02 -7.42e-04 -1.54e-02]
 [-5.21e-02  3.44e-03 -1.90e-02 -6.49e-03 -5.23e-03]]
[[ 5.45e-03 -4.50e-02  1.37e-01 -2.89e-02  2.51e-04]
 [ 1.50e-02  3.40e-02 -6.09e-01  1.23e-02  1.47e-02]
 [-3.35e-02 -1.16e-02 -2.38e-01 -1.04e-02 -1.95e-02]
 [ 2.22e-02 -1.03e-02  9.42e-01 -2.74e-02  2.36e-02]
 [-7.93e-03  2.37e-02 -2.11e-01  3.63e-02 -1.34e-02]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00 -1.01e-01]
 [ 0.00e+00  0.00e+00  0.00e+00 -3.49e-04 -6.20e-03]
 [ 0.00e+00  0.00e+00  1.20e-03  1.96e-03  5.07e-04]
 [ 0.00e+00 -7.17e-04 -3.15e-03  4.11e-04  6.01e-03]
 [-3.58e-03  7.24e-04  3.44e-03 -4.60e-03 -7.38e-03]]
[[-8.77e-03  4.46e-02 -8.15e-02  5.61e-02 -1.39e-02]
 [ 3.05e-02 -1.58e-01  2.95e-01 -2.06e-01  5.28e-02]
 [-2.15e-01  1.91e+00 -3.45e+00  1.98e+00 -2.48e-01]
 [ 1.05e-02 -7.05e-02  1.57e-01 -1.14e-01  3.12e-02]
 [-1.76e-03  1.32e-02 -3.14e-02  2.27e-02 -6.35e-03]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00 -3.03e-03]
 [ 0.00e+00  1.00e+00  0.00e+00 -4.86e-03  4.32e-03]
 [ 0.00e+00  0.00e+00 -1.18e-03  5.19e-03  3.06e-03]
 [ 0.00e+00 -3.25e-03  9.87e-04  6.22e-03 -5.94e-03]
 [ 2.57e-03  1.17e-03  2.53e-03 -2.43e-03 -6.04e-03]]
[[ 0.01 -0.05 -0.02  0.08 -0.01]
 [-0.05  0.38  0.13 -0.57  0.09]
 [-0.03  0.18 -0.31  0.24 -0.06]
 [ 0.09 -0.6   0.24  0.27 -0.01]
 [-0.02  0.1  -0.06 -0.01 -0.  ]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  1.16e-01]
 [ 0.00e+00  0.00e+00  0.00e+00  1.72e-03 -8.68e-03]
 [ 1.00e+00  0.00e+00  1.19e-03  1.10e-03 -2.71e-03]
 [ 0.00e+00 -1.00e-03 -3.53e-03 -1.28e-03  9.53e-03]
 [-4.19e-03  6.33e-04  2.71e-03 -3.96e-03 -6.22e-03]]
[[-1.01e-02  4.77e-02 -1.67e-01  5.58e-02 -1.36e-02]
 [ 2.99e-02 -1.46e-01  1.60e+00 -1.81e-01  4.54e-02]
 [ 9.82e-02 -3.54e-01 -2.04e+00 -2.96e-01  7.11e-02]
 [-3.55e-03 -1.07e-02  1.40e+00 -5.22e-02  1.64e-02]
 [ 1.85e-03 -1.76e-03 -9.27e-02  8.08e-03 -3.00e-03]]
SymNet parameters
[[ 8.63e-01 -4.13e-01 -1.90e-01 -2.82e-02 -8.92e-03 -1.22e-02  7.84e-02  3.69e-02
  -1.21e-01 -3.47e-03  1.09e-03  4.39e-03]
 [ 1.10e+00  1.82e-02 -1.51e-01  7.97e-02 -2.95e-02 -4.87e-03 -1.48e-01  1.78e-02
  -2.93e-02  1.45e-03 -1.48e-03 -6.25e-03]]
SymNet parameters
[-0.11 -0.51]
SymNet parameters
[[-4.82e+00  9.53e-02  1.09e+00 -1.15e-01 -7.86e-03  1.33e-01 -5.40e-01 -3.11e-02
   3.76e-03  2.42e-03  7.33e-03  7.42e-03  3.84e-02]
 [-4.62e+00  3.93e-01 -2.13e-01  6.09e-02 -9.50e-02 -4.21e-02  1.98e+00 -1.49e-01
   5.85e-01  9.27e-03 -1.32e-02 -1.97e-02 -1.05e-02]]
SymNet parameters
[0.27 0.5 ]
SymNet parameters
[[-6.94e-01  1.74e-01  9.33e-02 -6.37e-03  1.19e-02  8.23e-03  1.46e+00 -1.46e-02
   3.64e-02 -4.51e-04  3.78e-04 -1.29e-03  7.36e-03  5.13e-04]
 [-1.41e+00  1.21e-01 -1.88e+00  2.99e-01 -1.37e-01 -2.44e-02 -1.67e+00  1.22e-01
  -2.00e-01  5.47e-03 -5.46e-03 -2.18e-02 -3.05e-01  1.29e-02]]
SymNet parameters
[-0.25 -0.08]
SymNet parameters
[[ 3.68e+00 -9.36e-02 -4.36e-01 -2.04e-01 -3.47e-02 -5.87e-02 -3.76e+00  1.37e-01
  -3.89e-01 -1.11e-02  1.39e-03  2.31e-02  4.66e-02 -3.94e-03  2.13e-02]
 [ 1.54e+00  4.06e-02 -1.92e-02  1.60e-02 -3.04e-03  1.95e-03  4.02e-01 -6.08e-03
  -6.13e-03 -4.91e-04  4.95e-05 -5.43e-04  4.03e-02 -1.27e-03 -3.64e-03]]
SymNet parameters
[ 0.1  -0.27]
SymNet parameters
[[ 9.99e-01 -4.78e-01 -1.32e-01 -3.92e-02 -1.87e-03 -8.93e-03  1.63e+00  3.38e-02
  -1.36e-01 -4.70e-03  2.13e-03  4.11e-03  1.69e-02  1.84e-03 -5.52e-03 -9.50e-03]
 [-6.47e+00 -2.39e-01  6.67e-01 -1.10e+00  4.06e-01  5.11e-02  2.06e+00 -2.33e-01
   3.87e-01 -2.05e-02  1.81e-02  8.21e-02  8.61e-02  1.24e-02  8.07e-02 -7.87e-02]]
SymNet parameters
[-0.21 -0.47]
SymNet parameters
[[ 1.01e+00 -6.12e-01 -4.61e-01  4.46e-02 -2.13e-02  3.46e-02  4.92e-01  5.45e-02
  -1.67e-01 -4.22e-03  1.13e-03  3.16e-03  2.91e+00 -1.22e-02  3.94e-01 -3.49e-01
   1.38e-01]]
SymNet parameters
[-0.19]
SymNet parameters
[[-1.00e-03  3.85e-06 -1.33e-05  2.00e-05  5.34e-06  1.53e-06  1.85e-04  5.28e-05
   1.34e-05  3.03e-05  1.46e-05 -8.20e-05]
 [ 5.89e-01 -1.58e-01  1.77e-01  4.11e-01  3.13e-01 -4.58e-02 -8.24e+00  8.68e-01
  -6.80e-01  2.10e+00  2.92e-02  1.18e+00]]
SymNet parameters
[-0.11 -0.36]
SymNet parameters
[[ 3.14e-01 -4.82e-02  8.67e-02  1.86e-01  1.40e-01 -2.27e-02 -3.89e+00  3.40e+00
  -2.79e-01  9.36e-01  6.07e-02  5.34e-01  3.98e+00]
 [ 3.78e+00 -3.27e-03  6.28e-02  1.48e-02  1.58e-02 -4.58e-03 -2.18e-01  4.54e-02
  -6.82e-02  9.89e-02  2.28e-03  5.66e-02  4.40e-01]]
SymNet parameters
[0.41 1.29]
SymNet parameters
[[ 8.29e-01  2.60e-03 -1.30e-02 -4.71e-04  3.08e-04 -4.40e-04  3.00e-02  1.53e-03
  -9.88e-03  2.42e-03  3.92e-04  1.07e-03  8.44e-03  2.59e-05]
 [-7.00e-02  2.08e-02 -2.67e-02 -5.86e-02 -4.51e-02  6.28e-03  1.25e+00 -1.20e+00
   8.16e-02 -3.00e-01  1.17e-02 -1.67e-01 -1.34e+00  3.89e-04]]
SymNet parameters
[-0.01 -0.23]
SymNet parameters
[[-3.03e-02  4.52e-02 -6.87e-05 -4.30e-03 -3.90e-03  3.22e-05  8.30e-01 -5.17e-04
   9.71e-03 -2.58e-02 -8.78e-04 -1.44e-02 -1.11e-01  6.78e-05  6.85e-03]
 [-6.72e-02  2.10e-02 -2.60e-02 -8.10e-02 -6.11e-02  1.39e-02  1.69e+00 -4.97e-02
   1.52e+00 -4.01e-01 -6.95e-03 -2.30e-01 -1.80e+00 -4.49e-02 -3.54e-01]]
SymNet parameters
[-0.67  0.07]
SymNet parameters
[[-2.03e-02  4.70e-02 -4.19e-04 -5.43e-03 -4.79e-03  5.83e-05 -4.41e-01 -1.97e-02
   2.77e-02 -3.11e-02 -1.09e-03 -1.83e-02 -1.41e-01  8.21e-06 -5.44e-03  1.44e-02]
 [-8.13e-02  3.42e-02 -4.09e-02 -9.18e-02 -7.01e-02  6.85e-03  1.78e+00 -1.48e-01
   8.71e-01 -4.78e-01 -3.22e-03 -2.64e-01 -2.06e+00 -1.94e-02 -3.93e-01 -1.03e-03]]
SymNet parameters
[-0.52  0.04]
SymNet parameters
[[ 0.22  0.01 -0.01 -0.01 -0.01 -0.    0.15  0.11 -0.11 -0.02  0.    0.01 -0.28 -0.03
   0.5  -0.56  1.03]]
SymNet parameters
[0.02]
finally, finish this stage
iter:  2000    time: 18.87
Func: 1.17e-01  |g|: 3.14e-02
stableloss: 2.57e-02   dataloss: 9.64e-02   sparseloss: 1.23e+02 momentloss: 7.01e+00
current expression:
[u10*v00, u00*u01, u20, u02, u00*u01**2, u00, u01*u10*v00, u00*u11*v00, u10*v00*v10, u10, v00**2, 1, u00*u01*v00, u00**3, u20*v00**2, u10*v00*v01, u00**2*u01, u01**2, u00**2*u01*v00, u00*u10*v10]
[-0.99 -0.98  0.05  0.05  0.01  0.01  0.01  0.01  0.01 -0.01 -0.    0.    0.   -0.
  0.   -0.   -0.   -0.    0.   -0.  ]
[v00*v10, u00*v01, v02, v20, v00*v10**2, u00*u01*v01, u00*v00*v11, v00, u10*v00*v01, u00*v01*v10, v00**3, 1, v10, u00**2*v02, u01*v01, v01*v10, v00**2*v20, u01, u00*u10, v10**2]
[-0.98 -0.98  0.05  0.05  0.01  0.01  0.01  0.01  0.01  0.01 -0.    0.   -0.    0.
 -0.   -0.    0.   -0.   -0.    0.  ]
block:  4
name:  burgers-2-upwind-sparse0-noise0.001-id21
device:  cuda:1
generate a random number to check random seed:  -1.767868352037937
current stage is: block-4
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.9463, device='cuda:1', dtype=torch.float64)
u_obs variance
tensor([ 0.2450,  1.7179,  1.5555, 26.8618,  9.5669, 17.7274,  0.2541,  1.5389,
         1.7590, 20.0752, 10.0583, 23.3955], device='cuda:1',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 0.303987
         Iterations: 0
         Function evaluations: 15
         Gradient evaluations: 3
convolution moment and kernels
[[ 1.00e+00  0.00e+00 -8.89e-04  2.27e-02 -9.61e-02]
 [ 0.00e+00  9.83e-05  5.14e-03  4.90e-03  4.64e-03]
 [ 1.24e-03  4.42e-03  2.33e-02 -6.69e-02 -8.68e-03]
 [-2.03e-02  8.28e-04  5.48e-03 -7.10e-03 -2.66e-02]
 [-8.93e-02  3.44e-02 -2.89e-03 -2.35e-02  1.05e-02]]
[[ 0.04 -0.15  0.09 -0.07  0.02]
 [-0.1   0.47 -0.27  0.31 -0.08]
 [-0.01 -0.14  0.58  0.03  0.  ]
 [-0.05  0.25  0.13  0.05 -0.01]
 [ 0.01 -0.04 -0.11  0.05 -0.02]]
[[ 0.00e+00  1.00e+00  0.00e+00 -8.72e-02 -5.22e-02]
 [ 0.00e+00  0.00e+00  3.65e-03 -8.34e-04  4.40e-03]
 [ 0.00e+00  3.00e-02  1.05e-02  4.41e-02 -5.60e-03]
 [-1.05e-02 -2.20e-03  5.00e-03  8.33e-03  8.96e-04]
 [ 1.06e-02 -5.79e-03  8.31e-03 -3.75e-03  7.88e-04]]
[[ 5.97e-03 -4.56e-03  9.83e-03  9.16e-03 -4.49e-03]
 [-4.75e-02  7.04e-02 -8.73e-02 -1.36e-02  2.50e-02]
 [ 1.49e-01 -6.48e-01 -1.96e-01  9.79e-01 -2.20e-01]
 [-3.38e-02  2.65e-02 -2.90e-02 -1.61e-02  2.02e-02]
 [ 1.34e-03  1.06e-02 -1.07e-02  4.42e-03 -2.78e-04]]
[[ 0.00e+00  0.00e+00  0.00e+00  4.43e-03  3.41e-03]
 [ 1.00e+00  0.00e+00  1.61e-02  1.19e-03 -1.76e-02]
 [ 0.00e+00 -3.38e-03  1.16e-03 -2.13e-02  3.32e-03]
 [-7.47e-02 -4.00e-03  1.55e-02 -7.42e-04 -1.54e-02]
 [-5.21e-02  3.44e-03 -1.90e-02 -6.49e-03 -5.23e-03]]
[[ 5.45e-03 -4.50e-02  1.37e-01 -2.89e-02  2.51e-04]
 [ 1.50e-02  3.39e-02 -6.09e-01  1.23e-02  1.47e-02]
 [-3.35e-02 -1.15e-02 -2.38e-01 -1.04e-02 -1.95e-02]
 [ 2.22e-02 -1.03e-02  9.42e-01 -2.74e-02  2.36e-02]
 [-7.94e-03  2.37e-02 -2.11e-01  3.63e-02 -1.34e-02]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00 -1.01e-01]
 [ 0.00e+00  0.00e+00  0.00e+00 -3.49e-04 -6.20e-03]
 [ 0.00e+00  0.00e+00  1.20e-03  1.96e-03  5.08e-04]
 [ 0.00e+00 -7.17e-04 -3.15e-03  4.11e-04  6.01e-03]
 [-3.58e-03  7.23e-04  3.44e-03 -4.60e-03 -7.39e-03]]
[[-8.77e-03  4.46e-02 -8.16e-02  5.61e-02 -1.39e-02]
 [ 3.05e-02 -1.58e-01  2.95e-01 -2.06e-01  5.28e-02]
 [-2.15e-01  1.91e+00 -3.45e+00  1.98e+00 -2.48e-01]
 [ 1.05e-02 -7.05e-02  1.57e-01 -1.14e-01  3.12e-02]
 [-1.76e-03  1.32e-02 -3.14e-02  2.27e-02 -6.35e-03]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00 -3.03e-03]
 [ 0.00e+00  1.00e+00  0.00e+00 -4.86e-03  4.32e-03]
 [ 0.00e+00  0.00e+00 -1.18e-03  5.19e-03  3.06e-03]
 [ 0.00e+00 -3.25e-03  9.87e-04  6.22e-03 -5.94e-03]
 [ 2.57e-03  1.17e-03  2.53e-03 -2.43e-03 -6.04e-03]]
[[ 0.01 -0.05 -0.02  0.08 -0.01]
 [-0.05  0.38  0.13 -0.57  0.09]
 [-0.03  0.18 -0.31  0.24 -0.06]
 [ 0.09 -0.6   0.24  0.27 -0.01]
 [-0.02  0.1  -0.06 -0.01 -0.  ]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  1.16e-01]
 [ 0.00e+00  0.00e+00  0.00e+00  1.72e-03 -8.68e-03]
 [ 1.00e+00  0.00e+00  1.19e-03  1.10e-03 -2.71e-03]
 [ 0.00e+00 -1.00e-03 -3.53e-03 -1.28e-03  9.53e-03]
 [-4.19e-03  6.32e-04  2.71e-03 -3.95e-03 -6.22e-03]]
[[-1.01e-02  4.77e-02 -1.67e-01  5.58e-02 -1.36e-02]
 [ 2.99e-02 -1.46e-01  1.60e+00 -1.81e-01  4.54e-02]
 [ 9.82e-02 -3.54e-01 -2.04e+00 -2.96e-01  7.11e-02]
 [-3.54e-03 -1.07e-02  1.40e+00 -5.22e-02  1.64e-02]
 [ 1.84e-03 -1.75e-03 -9.27e-02  8.08e-03 -3.01e-03]]
SymNet parameters
[[ 8.63e-01 -4.13e-01 -1.90e-01 -2.82e-02 -8.92e-03 -1.22e-02  7.84e-02  3.69e-02
  -1.21e-01 -3.47e-03  1.09e-03  4.40e-03]
 [ 1.10e+00  1.82e-02 -1.51e-01  7.97e-02 -2.95e-02 -4.85e-03 -1.48e-01  1.78e-02
  -2.93e-02  1.45e-03 -1.48e-03 -6.24e-03]]
SymNet parameters
[-0.11 -0.51]
SymNet parameters
[[-4.82e+00  9.53e-02  1.09e+00 -1.15e-01 -7.86e-03  1.33e-01 -5.40e-01 -3.11e-02
   3.76e-03  2.42e-03  7.33e-03  7.42e-03  3.84e-02]
 [-4.62e+00  3.93e-01 -2.13e-01  6.09e-02 -9.50e-02 -4.21e-02  1.98e+00 -1.49e-01
   5.85e-01  9.27e-03 -1.32e-02 -1.97e-02 -1.05e-02]]
SymNet parameters
[0.27 0.5 ]
SymNet parameters
[[-6.94e-01  1.74e-01  9.33e-02 -6.37e-03  1.19e-02  8.23e-03  1.46e+00 -1.46e-02
   3.64e-02 -4.51e-04  3.81e-04 -1.29e-03  7.36e-03  5.56e-04]
 [-1.41e+00  1.21e-01 -1.88e+00  2.99e-01 -1.37e-01 -2.44e-02 -1.67e+00  1.22e-01
  -2.00e-01  5.47e-03 -5.46e-03 -2.18e-02 -3.05e-01  1.29e-02]]
SymNet parameters
[-0.25 -0.08]
SymNet parameters
[[ 3.68e+00 -9.36e-02 -4.36e-01 -2.04e-01 -3.47e-02 -5.87e-02 -3.76e+00  1.37e-01
  -3.89e-01 -1.11e-02  1.39e-03  2.31e-02  4.66e-02 -3.95e-03  2.13e-02]
 [ 1.54e+00  4.06e-02 -1.92e-02  1.59e-02 -3.04e-03  1.94e-03  4.02e-01 -6.08e-03
  -6.13e-03 -4.86e-04  5.24e-05 -5.48e-04  4.03e-02 -1.36e-03 -3.62e-03]]
SymNet parameters
[ 0.1  -0.27]
SymNet parameters
[[ 9.99e-01 -4.78e-01 -1.32e-01 -3.92e-02 -1.87e-03 -8.94e-03  1.63e+00  3.38e-02
  -1.36e-01 -4.70e-03  2.13e-03  4.11e-03  1.69e-02  1.85e-03 -5.50e-03 -9.50e-03]
 [-6.47e+00 -2.39e-01  6.67e-01 -1.10e+00  4.06e-01  5.11e-02  2.06e+00 -2.33e-01
   3.87e-01 -2.05e-02  1.81e-02  8.21e-02  8.61e-02  1.23e-02  8.07e-02 -7.87e-02]]
SymNet parameters
[-0.21 -0.47]
SymNet parameters
[[ 1.01e+00 -6.12e-01 -4.61e-01  4.46e-02 -2.13e-02  3.46e-02  4.92e-01  5.45e-02
  -1.67e-01 -4.22e-03  1.12e-03  3.16e-03  2.91e+00 -1.23e-02  3.94e-01 -3.49e-01
   1.38e-01]]
SymNet parameters
[-0.19]
SymNet parameters
[[-9.88e-04 -1.50e-05  1.34e-05  1.82e-04  7.05e-05 -3.02e-04  1.41e-04  4.77e-05
  -8.45e-06  3.21e-04 -6.98e-05 -5.05e-04]
 [ 5.89e-01 -1.58e-01  1.77e-01  4.11e-01  3.13e-01 -4.58e-02 -8.24e+00  8.68e-01
  -6.80e-01  2.10e+00  2.92e-02  1.18e+00]]
SymNet parameters
[-0.11 -0.36]
SymNet parameters
[[ 3.14e-01 -4.82e-02  8.67e-02  1.86e-01  1.40e-01 -2.27e-02 -3.89e+00  3.40e+00
  -2.79e-01  9.36e-01  6.07e-02  5.34e-01  3.98e+00]
 [ 3.78e+00 -3.27e-03  6.28e-02  1.48e-02  1.58e-02 -4.58e-03 -2.18e-01  4.54e-02
  -6.82e-02  9.89e-02  2.28e-03  5.66e-02  4.40e-01]]
SymNet parameters
[0.41 1.29]
SymNet parameters
[[ 8.29e-01  2.60e-03 -1.30e-02 -4.70e-04  3.07e-04 -4.43e-04  3.00e-02  1.52e-03
  -9.88e-03  2.42e-03  3.92e-04  1.07e-03  8.44e-03  3.99e-05]
 [-7.00e-02  2.08e-02 -2.67e-02 -5.86e-02 -4.51e-02  6.28e-03  1.25e+00 -1.20e+00
   8.16e-02 -3.00e-01  1.17e-02 -1.67e-01 -1.34e+00  3.85e-04]]
SymNet parameters
[-0.01 -0.23]
SymNet parameters
[[-3.03e-02  4.52e-02 -6.96e-05 -4.29e-03 -3.89e-03  2.76e-05  8.30e-01 -5.19e-04
   9.70e-03 -2.58e-02 -8.78e-04 -1.44e-02 -1.11e-01  7.37e-05  6.85e-03]
 [-6.72e-02  2.10e-02 -2.60e-02 -8.10e-02 -6.11e-02  1.39e-02  1.69e+00 -4.97e-02
   1.52e+00 -4.01e-01 -6.95e-03 -2.30e-01 -1.80e+00 -4.49e-02 -3.54e-01]]
SymNet parameters
[-0.67  0.07]
SymNet parameters
[[-2.03e-02  4.70e-02 -4.18e-04 -5.43e-03 -4.79e-03  6.29e-05 -4.41e-01 -1.97e-02
   2.77e-02 -3.11e-02 -1.09e-03 -1.83e-02 -1.41e-01  8.47e-06 -5.44e-03  1.44e-02]
 [-8.13e-02  3.42e-02 -4.09e-02 -9.18e-02 -7.01e-02  6.85e-03  1.78e+00 -1.48e-01
   8.71e-01 -4.78e-01 -3.22e-03 -2.64e-01 -2.06e+00 -1.94e-02 -3.93e-01 -1.03e-03]]
SymNet parameters
[-0.52  0.04]
SymNet parameters
[[ 0.22  0.01 -0.01 -0.01 -0.01 -0.    0.15  0.11 -0.11 -0.02  0.    0.01 -0.28 -0.03
   0.5  -0.56  1.03]]
SymNet parameters
[0.02]
finally, finish this stage
iter:     0    time: 325.00
Func: 3.04e-01  |g|: 8.20e+01
stableloss: 2.92e-02   dataloss: 2.76e-01   sparseloss: 1.23e+02 momentloss: 7.01e+00
current expression:
[u10*v00, u00*u01, u20, u02, u00*u01**2, u00, u01*u10*v00, u00*u11*v00, u10*v00*v10, u10, v00**2, 1, u00*u01*v00, u00**3, u20*v00**2, u10*v00*v01, u00**2*u01, u01**2, u00**2*u01*v00, u00*u10*v10]
[-0.99 -0.98  0.05  0.05  0.01  0.01  0.01  0.01  0.01 -0.01 -0.    0.    0.   -0.
  0.   -0.   -0.   -0.    0.   -0.  ]
[v00*v10, u00*v01, v02, v20, v00*v10**2, u00*u01*v01, u00*v00*v11, v00, u10*v00*v01, u00*v01*v10, v00**3, 1, v10, u00**2*v02, u01*v01, v01*v10, v00**2*v20, u01, u00*u10, v10**2]
[-0.98 -0.98  0.05  0.05  0.01  0.01  0.01  0.01  0.01  0.01 -0.    0.   -0.    0.
 -0.   -0.    0.   -0.   -0.    0.  ]
block:  5
name:  burgers-2-upwind-sparse0-noise0.001-id21
device:  cuda:1
generate a random number to check random seed:  1.9695654981766528
current stage is: block-5
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.7571, device='cuda:1', dtype=torch.float64)
u_obs variance
tensor([ 0.2520,  1.7080,  1.6288, 26.1713,  9.9446, 18.9900,  0.2619,  1.7093,
         1.6792, 23.0825,  9.9065, 22.1245], device='cuda:1',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 0.645832
         Iterations: 0
         Function evaluations: 15
         Gradient evaluations: 3
convolution moment and kernels
[[ 1.00e+00  0.00e+00 -8.89e-04  2.27e-02 -9.61e-02]
 [ 0.00e+00  9.83e-05  5.14e-03  4.91e-03  4.64e-03]
 [ 1.24e-03  4.42e-03  2.33e-02 -6.69e-02 -8.68e-03]
 [-2.03e-02  8.28e-04  5.48e-03 -7.10e-03 -2.66e-02]
 [-8.93e-02  3.44e-02 -2.90e-03 -2.35e-02  1.05e-02]]
[[ 0.04 -0.15  0.09 -0.07  0.02]
 [-0.1   0.47 -0.27  0.31 -0.08]
 [-0.01 -0.14  0.58  0.03  0.  ]
 [-0.05  0.25  0.13  0.05 -0.01]
 [ 0.01 -0.04 -0.11  0.05 -0.02]]
[[ 0.00e+00  1.00e+00  0.00e+00 -8.72e-02 -5.22e-02]
 [ 0.00e+00  0.00e+00  3.65e-03 -8.34e-04  4.40e-03]
 [ 0.00e+00  3.00e-02  1.05e-02  4.41e-02 -5.60e-03]
 [-1.05e-02 -2.20e-03  5.00e-03  8.33e-03  8.96e-04]
 [ 1.06e-02 -5.79e-03  8.31e-03 -3.75e-03  7.89e-04]]
[[ 5.97e-03 -4.57e-03  9.84e-03  9.16e-03 -4.49e-03]
 [-4.75e-02  7.04e-02 -8.74e-02 -1.36e-02  2.50e-02]
 [ 1.49e-01 -6.48e-01 -1.96e-01  9.79e-01 -2.20e-01]
 [-3.38e-02  2.66e-02 -2.91e-02 -1.60e-02  2.02e-02]
 [ 1.35e-03  1.06e-02 -1.07e-02  4.42e-03 -2.77e-04]]
[[ 0.00e+00  0.00e+00  0.00e+00  4.44e-03  3.41e-03]
 [ 1.00e+00  0.00e+00  1.61e-02  1.19e-03 -1.76e-02]
 [ 0.00e+00 -3.38e-03  1.16e-03 -2.13e-02  3.32e-03]
 [-7.47e-02 -4.00e-03  1.55e-02 -7.42e-04 -1.54e-02]
 [-5.21e-02  3.44e-03 -1.90e-02 -6.49e-03 -5.23e-03]]
[[ 5.45e-03 -4.50e-02  1.37e-01 -2.89e-02  2.49e-04]
 [ 1.50e-02  3.39e-02 -6.09e-01  1.22e-02  1.47e-02]
 [-3.35e-02 -1.14e-02 -2.38e-01 -1.03e-02 -1.95e-02]
 [ 2.22e-02 -1.04e-02  9.42e-01 -2.75e-02  2.37e-02]
 [-7.94e-03  2.37e-02 -2.11e-01  3.63e-02 -1.34e-02]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00 -1.01e-01]
 [ 0.00e+00  0.00e+00  0.00e+00 -3.49e-04 -6.20e-03]
 [ 0.00e+00  0.00e+00  1.20e-03  1.96e-03  5.07e-04]
 [ 0.00e+00 -7.17e-04 -3.15e-03  4.11e-04  6.01e-03]
 [-3.58e-03  7.24e-04  3.44e-03 -4.60e-03 -7.38e-03]]
[[-8.77e-03  4.46e-02 -8.15e-02  5.61e-02 -1.39e-02]
 [ 3.05e-02 -1.58e-01  2.95e-01 -2.06e-01  5.28e-02]
 [-2.15e-01  1.91e+00 -3.45e+00  1.98e+00 -2.48e-01]
 [ 1.05e-02 -7.05e-02  1.57e-01 -1.14e-01  3.12e-02]
 [-1.76e-03  1.32e-02 -3.14e-02  2.27e-02 -6.35e-03]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00 -3.03e-03]
 [ 0.00e+00  1.00e+00  0.00e+00 -4.86e-03  4.32e-03]
 [ 0.00e+00  0.00e+00 -1.18e-03  5.19e-03  3.06e-03]
 [ 0.00e+00 -3.25e-03  9.87e-04  6.22e-03 -5.94e-03]
 [ 2.57e-03  1.17e-03  2.53e-03 -2.43e-03 -6.04e-03]]
[[ 0.01 -0.05 -0.02  0.08 -0.01]
 [-0.05  0.38  0.13 -0.57  0.09]
 [-0.03  0.18 -0.31  0.24 -0.06]
 [ 0.09 -0.6   0.24  0.27 -0.01]
 [-0.02  0.1  -0.06 -0.01 -0.  ]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  1.16e-01]
 [ 0.00e+00  0.00e+00  0.00e+00  1.72e-03 -8.68e-03]
 [ 1.00e+00  0.00e+00  1.19e-03  1.10e-03 -2.71e-03]
 [ 0.00e+00 -1.00e-03 -3.53e-03 -1.28e-03  9.53e-03]
 [-4.19e-03  6.33e-04  2.71e-03 -3.95e-03 -6.22e-03]]
[[-1.01e-02  4.77e-02 -1.67e-01  5.58e-02 -1.36e-02]
 [ 2.99e-02 -1.46e-01  1.60e+00 -1.81e-01  4.54e-02]
 [ 9.82e-02 -3.54e-01 -2.04e+00 -2.96e-01  7.11e-02]
 [-3.55e-03 -1.07e-02  1.40e+00 -5.22e-02  1.64e-02]
 [ 1.85e-03 -1.76e-03 -9.27e-02  8.08e-03 -3.01e-03]]
SymNet parameters
[[ 8.63e-01 -4.13e-01 -1.90e-01 -2.82e-02 -8.92e-03 -1.22e-02  7.84e-02  3.69e-02
  -1.21e-01 -3.47e-03  1.09e-03  4.39e-03]
 [ 1.10e+00  1.82e-02 -1.51e-01  7.97e-02 -2.95e-02 -4.87e-03 -1.48e-01  1.78e-02
  -2.93e-02  1.45e-03 -1.48e-03 -6.25e-03]]
SymNet parameters
[-0.11 -0.51]
SymNet parameters
[[-4.82e+00  9.53e-02  1.09e+00 -1.15e-01 -7.86e-03  1.33e-01 -5.40e-01 -3.11e-02
   3.76e-03  2.42e-03  7.33e-03  7.42e-03  3.84e-02]
 [-4.62e+00  3.93e-01 -2.13e-01  6.09e-02 -9.50e-02 -4.21e-02  1.98e+00 -1.49e-01
   5.85e-01  9.27e-03 -1.32e-02 -1.97e-02 -1.05e-02]]
SymNet parameters
[0.27 0.5 ]
SymNet parameters
[[-6.94e-01  1.74e-01  9.33e-02 -6.37e-03  1.19e-02  8.23e-03  1.46e+00 -1.46e-02
   3.64e-02 -4.52e-04  3.80e-04 -1.30e-03  7.36e-03  4.88e-04]
 [-1.41e+00  1.21e-01 -1.88e+00  2.99e-01 -1.37e-01 -2.44e-02 -1.67e+00  1.22e-01
  -2.00e-01  5.47e-03 -5.46e-03 -2.18e-02 -3.05e-01  1.29e-02]]
SymNet parameters
[-0.25 -0.08]
SymNet parameters
[[ 3.68e+00 -9.36e-02 -4.36e-01 -2.04e-01 -3.47e-02 -5.87e-02 -3.76e+00  1.37e-01
  -3.89e-01 -1.11e-02  1.39e-03  2.31e-02  4.66e-02 -3.97e-03  2.13e-02]
 [ 1.54e+00  4.06e-02 -1.92e-02  1.60e-02 -3.04e-03  1.95e-03  4.02e-01 -6.08e-03
  -6.13e-03 -4.87e-04  4.99e-05 -5.43e-04  4.03e-02 -1.36e-03 -3.65e-03]]
SymNet parameters
[ 0.1  -0.27]
SymNet parameters
[[ 9.99e-01 -4.78e-01 -1.32e-01 -3.92e-02 -1.87e-03 -8.93e-03  1.63e+00  3.38e-02
  -1.36e-01 -4.70e-03  2.12e-03  4.11e-03  1.69e-02  1.81e-03 -5.52e-03 -9.51e-03]
 [-6.47e+00 -2.39e-01  6.67e-01 -1.10e+00  4.06e-01  5.11e-02  2.06e+00 -2.33e-01
   3.87e-01 -2.05e-02  1.81e-02  8.21e-02  8.61e-02  1.24e-02  8.07e-02 -7.87e-02]]
SymNet parameters
[-0.21 -0.47]
SymNet parameters
[[ 1.01e+00 -6.12e-01 -4.61e-01  4.46e-02 -2.13e-02  3.46e-02  4.92e-01  5.45e-02
  -1.67e-01 -4.22e-03  1.13e-03  3.16e-03  2.91e+00 -1.22e-02  3.94e-01 -3.49e-01
   1.38e-01]]
SymNet parameters
[-0.19]
SymNet parameters
[[-9.81e-04  5.61e-06 -6.78e-07 -2.29e-05 -2.11e-06 -7.82e-05  1.13e-04  7.64e-05
   2.75e-05  1.45e-04 -1.68e-05 -1.67e-04]
 [ 5.89e-01 -1.58e-01  1.77e-01  4.11e-01  3.13e-01 -4.58e-02 -8.24e+00  8.68e-01
  -6.80e-01  2.10e+00  2.92e-02  1.18e+00]]
SymNet parameters
[-0.11 -0.36]
SymNet parameters
[[ 3.14e-01 -4.82e-02  8.67e-02  1.86e-01  1.40e-01 -2.27e-02 -3.89e+00  3.40e+00
  -2.79e-01  9.36e-01  6.07e-02  5.34e-01  3.98e+00]
 [ 3.78e+00 -3.27e-03  6.28e-02  1.48e-02  1.58e-02 -4.58e-03 -2.18e-01  4.54e-02
  -6.82e-02  9.89e-02  2.28e-03  5.66e-02  4.40e-01]]
SymNet parameters
[0.41 1.29]
SymNet parameters
[[ 8.29e-01  2.60e-03 -1.30e-02 -4.71e-04  3.08e-04 -4.42e-04  3.00e-02  1.52e-03
  -9.88e-03  2.42e-03  3.91e-04  1.07e-03  8.44e-03  9.11e-06]
 [-7.00e-02  2.08e-02 -2.67e-02 -5.86e-02 -4.51e-02  6.28e-03  1.25e+00 -1.20e+00
   8.16e-02 -3.00e-01  1.17e-02 -1.67e-01 -1.34e+00  3.83e-04]]
SymNet parameters
[-0.01 -0.23]
SymNet parameters
[[-3.03e-02  4.52e-02 -6.91e-05 -4.30e-03 -3.90e-03  3.08e-05  8.30e-01 -5.17e-04
   9.71e-03 -2.58e-02 -8.78e-04 -1.44e-02 -1.11e-01  6.89e-05  6.85e-03]
 [-6.72e-02  2.10e-02 -2.60e-02 -8.10e-02 -6.11e-02  1.39e-02  1.69e+00 -4.97e-02
   1.52e+00 -4.01e-01 -6.95e-03 -2.30e-01 -1.80e+00 -4.49e-02 -3.54e-01]]
SymNet parameters
[-0.67  0.07]
SymNet parameters
[[-2.03e-02  4.70e-02 -4.19e-04 -5.43e-03 -4.79e-03  6.02e-05 -4.41e-01 -1.97e-02
   2.77e-02 -3.11e-02 -1.09e-03 -1.83e-02 -1.41e-01  8.63e-06 -5.44e-03  1.44e-02]
 [-8.13e-02  3.42e-02 -4.09e-02 -9.18e-02 -7.01e-02  6.85e-03  1.78e+00 -1.48e-01
   8.71e-01 -4.78e-01 -3.22e-03 -2.64e-01 -2.06e+00 -1.94e-02 -3.93e-01 -1.03e-03]]
SymNet parameters
[-0.52  0.04]
SymNet parameters
[[ 0.22  0.01 -0.01 -0.01 -0.01 -0.    0.15  0.11 -0.11 -0.02  0.    0.01 -0.28 -0.03
   0.5  -0.56  1.03]]
SymNet parameters
[0.02]
finally, finish this stage
iter:     0    time: 32.06
Func: 6.46e-01  |g|: 1.12e+02
stableloss: 4.31e-02   dataloss: 6.11e-01   sparseloss: 1.23e+02 momentloss: 7.01e+00
current expression:
[u10*v00, u00*u01, u20, u02, u00*u01**2, u00, u01*u10*v00, u00*u11*v00, u10*v00*v10, u10, v00**2, 1, u00*u01*v00, u00**3, u20*v00**2, u10*v00*v01, u00**2*u01, u01**2, u00**2*u01*v00, u00*u10*v10]
[-0.99 -0.98  0.05  0.05  0.01  0.01  0.01  0.01  0.01 -0.01 -0.    0.    0.   -0.
  0.   -0.   -0.   -0.    0.   -0.  ]
[v00*v10, u00*v01, v02, v20, v00*v10**2, u00*u01*v01, u00*v00*v11, v00, u10*v00*v01, u00*v01*v10, v00**3, 1, v10, u00**2*v02, u01*v01, v01*v10, v00**2*v20, u01, u00*u10, v10**2]
[-0.98 -0.98  0.05  0.05  0.01  0.01  0.01  0.01  0.01  0.01 -0.    0.   -0.    0.
 -0.   -0.    0.   -0.   -0.    0.  ]
block:  6
name:  burgers-2-upwind-sparse0-noise0.001-id21
device:  cuda:1
generate a random number to check random seed:  2.1765133966680854
current stage is: block-6
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.8450, device='cuda:1', dtype=torch.float64)
u_obs variance
tensor([ 0.2465,  1.7019,  1.5791, 26.1879, 10.2127, 18.0401,  0.2428,  1.6420,
         1.6694, 22.4997,  9.7596, 21.8291], device='cuda:1',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 0.688607
         Iterations: 0
         Function evaluations: 15
         Gradient evaluations: 3
convolution moment and kernels
[[ 1.00e+00  0.00e+00 -8.89e-04  2.27e-02 -9.61e-02]
 [ 0.00e+00  9.84e-05  5.14e-03  4.90e-03  4.64e-03]
 [ 1.24e-03  4.42e-03  2.33e-02 -6.69e-02 -8.68e-03]
 [-2.03e-02  8.28e-04  5.48e-03 -7.10e-03 -2.66e-02]
 [-8.93e-02  3.44e-02 -2.90e-03 -2.35e-02  1.05e-02]]
[[ 0.04 -0.15  0.09 -0.07  0.02]
 [-0.1   0.47 -0.27  0.31 -0.08]
 [-0.01 -0.14  0.58  0.03  0.  ]
 [-0.05  0.25  0.13  0.05 -0.01]
 [ 0.01 -0.04 -0.11  0.05 -0.02]]
[[ 0.00e+00  1.00e+00  0.00e+00 -8.72e-02 -5.22e-02]
 [ 0.00e+00  0.00e+00  3.65e-03 -8.34e-04  4.40e-03]
 [ 0.00e+00  3.00e-02  1.05e-02  4.41e-02 -5.60e-03]
 [-1.05e-02 -2.20e-03  5.00e-03  8.33e-03  8.96e-04]
 [ 1.06e-02 -5.79e-03  8.31e-03 -3.75e-03  7.92e-04]]
[[ 5.97e-03 -4.59e-03  9.86e-03  9.14e-03 -4.49e-03]
 [-4.76e-02  7.05e-02 -8.75e-02 -1.35e-02  2.50e-02]
 [ 1.49e-01 -6.48e-01 -1.96e-01  9.79e-01 -2.20e-01]
 [-3.38e-02  2.67e-02 -2.92e-02 -1.60e-02  2.02e-02]
 [ 1.35e-03  1.06e-02 -1.06e-02  4.41e-03 -2.74e-04]]
[[ 0.00e+00  0.00e+00  0.00e+00  4.44e-03  3.41e-03]
 [ 1.00e+00  0.00e+00  1.61e-02  1.19e-03 -1.76e-02]
 [ 0.00e+00 -3.38e-03  1.16e-03 -2.13e-02  3.32e-03]
 [-7.47e-02 -4.00e-03  1.55e-02 -7.43e-04 -1.54e-02]
 [-5.21e-02  3.44e-03 -1.90e-02 -6.49e-03 -5.23e-03]]
[[ 5.45e-03 -4.50e-02  1.37e-01 -2.89e-02  2.52e-04]
 [ 1.50e-02  3.40e-02 -6.09e-01  1.23e-02  1.47e-02]
 [-3.35e-02 -1.15e-02 -2.38e-01 -1.04e-02 -1.95e-02]
 [ 2.22e-02 -1.03e-02  9.42e-01 -2.74e-02  2.36e-02]
 [-7.94e-03  2.37e-02 -2.11e-01  3.63e-02 -1.34e-02]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00 -1.01e-01]
 [ 0.00e+00  0.00e+00  0.00e+00 -3.49e-04 -6.20e-03]
 [ 0.00e+00  0.00e+00  1.20e-03  1.96e-03  5.08e-04]
 [ 0.00e+00 -7.17e-04 -3.15e-03  4.11e-04  6.01e-03]
 [-3.58e-03  7.24e-04  3.44e-03 -4.60e-03 -7.38e-03]]
[[-8.77e-03  4.46e-02 -8.16e-02  5.61e-02 -1.39e-02]
 [ 3.05e-02 -1.58e-01  2.95e-01 -2.06e-01  5.28e-02]
 [-2.15e-01  1.91e+00 -3.45e+00  1.98e+00 -2.48e-01]
 [ 1.05e-02 -7.05e-02  1.57e-01 -1.14e-01  3.12e-02]
 [-1.76e-03  1.32e-02 -3.14e-02  2.27e-02 -6.35e-03]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00 -3.03e-03]
 [ 0.00e+00  1.00e+00  0.00e+00 -4.86e-03  4.32e-03]
 [ 0.00e+00  0.00e+00 -1.18e-03  5.19e-03  3.06e-03]
 [ 0.00e+00 -3.25e-03  9.87e-04  6.22e-03 -5.94e-03]
 [ 2.57e-03  1.17e-03  2.53e-03 -2.43e-03 -6.04e-03]]
[[ 0.01 -0.05 -0.02  0.08 -0.01]
 [-0.05  0.38  0.13 -0.57  0.09]
 [-0.03  0.18 -0.31  0.24 -0.06]
 [ 0.09 -0.6   0.24  0.27 -0.01]
 [-0.02  0.1  -0.06 -0.01 -0.  ]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  1.16e-01]
 [ 0.00e+00  0.00e+00  0.00e+00  1.72e-03 -8.68e-03]
 [ 1.00e+00  0.00e+00  1.19e-03  1.10e-03 -2.71e-03]
 [ 0.00e+00 -1.00e-03 -3.53e-03 -1.28e-03  9.53e-03]
 [-4.19e-03  6.33e-04  2.71e-03 -3.95e-03 -6.22e-03]]
[[-1.01e-02  4.77e-02 -1.67e-01  5.58e-02 -1.36e-02]
 [ 2.99e-02 -1.46e-01  1.60e+00 -1.81e-01  4.54e-02]
 [ 9.82e-02 -3.54e-01 -2.04e+00 -2.96e-01  7.11e-02]
 [-3.55e-03 -1.07e-02  1.40e+00 -5.22e-02  1.64e-02]
 [ 1.85e-03 -1.76e-03 -9.27e-02  8.08e-03 -3.00e-03]]
SymNet parameters
[[ 8.63e-01 -4.13e-01 -1.90e-01 -2.82e-02 -8.92e-03 -1.22e-02  7.84e-02  3.69e-02
  -1.21e-01 -3.49e-03  1.09e-03  4.38e-03]
 [ 1.10e+00  1.82e-02 -1.51e-01  7.97e-02 -2.95e-02 -4.87e-03 -1.48e-01  1.78e-02
  -2.93e-02  1.44e-03 -1.48e-03 -6.25e-03]]
SymNet parameters
[-0.11 -0.51]
SymNet parameters
[[-4.82e+00  9.53e-02  1.09e+00 -1.15e-01 -7.86e-03  1.33e-01 -5.40e-01 -3.11e-02
   3.76e-03  2.42e-03  7.33e-03  7.42e-03  3.84e-02]
 [-4.62e+00  3.93e-01 -2.13e-01  6.09e-02 -9.50e-02 -4.21e-02  1.98e+00 -1.49e-01
   5.85e-01  9.27e-03 -1.32e-02 -1.97e-02 -1.05e-02]]
SymNet parameters
[0.27 0.5 ]
SymNet parameters
[[-6.94e-01  1.74e-01  9.33e-02 -6.37e-03  1.19e-02  8.23e-03  1.46e+00 -1.46e-02
   3.64e-02 -4.51e-04  3.82e-04 -1.30e-03  7.36e-03  4.98e-04]
 [-1.41e+00  1.21e-01 -1.88e+00  2.99e-01 -1.37e-01 -2.44e-02 -1.67e+00  1.22e-01
  -2.00e-01  5.47e-03 -5.46e-03 -2.18e-02 -3.05e-01  1.29e-02]]
SymNet parameters
[-0.25 -0.08]
SymNet parameters
[[ 3.68e+00 -9.36e-02 -4.36e-01 -2.04e-01 -3.47e-02 -5.87e-02 -3.76e+00  1.37e-01
  -3.89e-01 -1.11e-02  1.39e-03  2.32e-02  4.66e-02 -3.94e-03  2.13e-02]
 [ 1.54e+00  4.06e-02 -1.92e-02  1.60e-02 -3.04e-03  1.95e-03  4.02e-01 -6.09e-03
  -6.14e-03 -4.83e-04  4.95e-05 -5.36e-04  4.03e-02 -1.21e-03 -3.64e-03]]
SymNet parameters
[ 0.1  -0.27]
SymNet parameters
[[ 9.99e-01 -4.78e-01 -1.32e-01 -3.92e-02 -1.87e-03 -8.93e-03  1.63e+00  3.38e-02
  -1.36e-01 -4.70e-03  2.13e-03  4.11e-03  1.69e-02  1.87e-03 -5.52e-03 -9.50e-03]
 [-6.47e+00 -2.39e-01  6.67e-01 -1.10e+00  4.06e-01  5.11e-02  2.06e+00 -2.33e-01
   3.87e-01 -2.05e-02  1.81e-02  8.21e-02  8.61e-02  1.24e-02  8.07e-02 -7.87e-02]]
SymNet parameters
[-0.21 -0.47]
SymNet parameters
[[ 1.01e+00 -6.12e-01 -4.61e-01  4.46e-02 -2.13e-02  3.46e-02  4.92e-01  5.45e-02
  -1.67e-01 -4.22e-03  1.13e-03  3.16e-03  2.91e+00 -1.22e-02  3.94e-01 -3.49e-01
   1.38e-01]]
SymNet parameters
[-0.19]
SymNet parameters
[[-1.00e-03 -1.03e-05  7.82e-06 -1.22e-04  4.75e-05 -2.12e-05  1.20e-04  7.85e-05
   3.61e-05  2.53e-04 -3.11e-05  3.12e-04]
 [ 5.89e-01 -1.58e-01  1.77e-01  4.11e-01  3.13e-01 -4.58e-02 -8.24e+00  8.68e-01
  -6.80e-01  2.10e+00  2.92e-02  1.18e+00]]
SymNet parameters
[-0.11 -0.36]
SymNet parameters
[[ 3.14e-01 -4.82e-02  8.67e-02  1.86e-01  1.40e-01 -2.27e-02 -3.89e+00  3.40e+00
  -2.79e-01  9.36e-01  6.07e-02  5.34e-01  3.98e+00]
 [ 3.78e+00 -3.27e-03  6.28e-02  1.48e-02  1.58e-02 -4.58e-03 -2.18e-01  4.54e-02
  -6.82e-02  9.89e-02  2.28e-03  5.66e-02  4.40e-01]]
SymNet parameters
[0.41 1.29]
SymNet parameters
[[ 8.29e-01  2.60e-03 -1.30e-02 -4.72e-04  3.09e-04 -4.42e-04  3.00e-02  1.52e-03
  -9.88e-03  2.42e-03  3.91e-04  1.07e-03  8.44e-03  4.89e-06]
 [-7.00e-02  2.08e-02 -2.67e-02 -5.86e-02 -4.51e-02  6.28e-03  1.25e+00 -1.20e+00
   8.16e-02 -3.00e-01  1.17e-02 -1.67e-01 -1.34e+00  3.80e-04]]
SymNet parameters
[-0.01 -0.23]
SymNet parameters
[[-3.03e-02  4.52e-02 -6.89e-05 -4.30e-03 -3.90e-03  3.25e-05  8.30e-01 -5.17e-04
   9.70e-03 -2.58e-02 -8.76e-04 -1.44e-02 -1.11e-01  7.59e-05  6.85e-03]
 [-6.72e-02  2.10e-02 -2.60e-02 -8.10e-02 -6.11e-02  1.39e-02  1.69e+00 -4.97e-02
   1.52e+00 -4.01e-01 -6.95e-03 -2.30e-01 -1.80e+00 -4.49e-02 -3.54e-01]]
SymNet parameters
[-0.67  0.07]
SymNet parameters
[[-2.03e-02  4.70e-02 -4.19e-04 -5.43e-03 -4.79e-03  5.81e-05 -4.41e-01 -1.97e-02
   2.77e-02 -3.11e-02 -1.09e-03 -1.83e-02 -1.41e-01 -1.06e-08 -5.44e-03  1.44e-02]
 [-8.13e-02  3.42e-02 -4.09e-02 -9.18e-02 -7.01e-02  6.85e-03  1.78e+00 -1.48e-01
   8.71e-01 -4.78e-01 -3.22e-03 -2.64e-01 -2.06e+00 -1.94e-02 -3.93e-01 -1.03e-03]]
SymNet parameters
[-0.52  0.04]
SymNet parameters
[[ 0.22  0.01 -0.01 -0.01 -0.01 -0.    0.15  0.11 -0.11 -0.02  0.    0.01 -0.28 -0.03
   0.5  -0.56  1.03]]
SymNet parameters
[0.02]
finally, finish this stage
iter:     0    time: 30.93
Func: 6.89e-01  |g|: 2.65e+02
stableloss: 5.58e-02   dataloss: 6.47e-01   sparseloss: 1.23e+02 momentloss: 7.01e+00
current expression:
[u10*v00, u00*u01, u20, u02, u00*u01**2, u00, u01*u10*v00, u00*u11*v00, u10*v00*v10, u10, v00**2, 1, u00*u01*v00, u00**3, u20*v00**2, u10*v00*v01, u00**2*u01, u01**2, u00**2*u01*v00, u00*u10*v10]
[-0.99 -0.98  0.05  0.05  0.01  0.01  0.01  0.01  0.01 -0.01 -0.    0.    0.   -0.
  0.   -0.   -0.   -0.    0.   -0.  ]
[v00*v10, u00*v01, v02, v20, v00*v10**2, u00*u01*v01, u00*v00*v11, v00, u10*v00*v01, u00*v01*v10, v00**3, 1, v10, u00**2*v02, u01*v01, v01*v10, v00**2*v20, u01, u00*u10, v10**2]
[-0.98 -0.98  0.05  0.05  0.01  0.01  0.01  0.01  0.01  0.01 -0.    0.   -0.    0.
 -0.   -0.    0.   -0.   -0.    0.  ]
block:  9
name:  burgers-2-upwind-sparse0-noise0.001-id21
device:  cuda:1
generate a random number to check random seed:  -0.8183963240646281
current stage is: block-9
u_obs shape: batchsize x channelNum x xgridsize x ygridsize
torch.Size([28, 2, 32, 32])
u_obs.abs().max()
tensor(3.6143, device='cuda:1', dtype=torch.float64)
u_obs variance
tensor([ 0.2556,  1.6397,  1.5800, 26.2620,  9.7428, 17.8482,  0.2424,  1.5425,
         1.6599, 20.7320,  9.7492, 21.7455], device='cuda:1',
       dtype=torch.float64, grad_fn=<MeanBackward2>)
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 1.501799
         Iterations: 0
         Function evaluations: 15
         Gradient evaluations: 3
convolution moment and kernels
[[ 1.00e+00  0.00e+00 -8.90e-04  2.27e-02 -9.61e-02]
 [ 0.00e+00  9.83e-05  5.14e-03  4.91e-03  4.64e-03]
 [ 1.24e-03  4.42e-03  2.33e-02 -6.69e-02 -8.68e-03]
 [-2.03e-02  8.28e-04  5.48e-03 -7.10e-03 -2.66e-02]
 [-8.93e-02  3.44e-02 -2.90e-03 -2.35e-02  1.05e-02]]
[[ 0.04 -0.15  0.09 -0.07  0.02]
 [-0.1   0.47 -0.27  0.31 -0.08]
 [-0.01 -0.14  0.58  0.03  0.  ]
 [-0.05  0.25  0.13  0.05 -0.01]
 [ 0.01 -0.04 -0.11  0.05 -0.02]]
[[ 0.00e+00  1.00e+00  0.00e+00 -8.72e-02 -5.22e-02]
 [ 0.00e+00  0.00e+00  3.65e-03 -8.34e-04  4.40e-03]
 [ 0.00e+00  3.00e-02  1.05e-02  4.41e-02 -5.60e-03]
 [-1.05e-02 -2.20e-03  5.00e-03  8.33e-03  8.95e-04]
 [ 1.06e-02 -5.79e-03  8.31e-03 -3.75e-03  7.92e-04]]
[[ 5.97e-03 -4.59e-03  9.87e-03  9.14e-03 -4.49e-03]
 [-4.76e-02  7.05e-02 -8.75e-02 -1.35e-02  2.50e-02]
 [ 1.49e-01 -6.48e-01 -1.96e-01  9.79e-01 -2.20e-01]
 [-3.38e-02  2.67e-02 -2.91e-02 -1.60e-02  2.02e-02]
 [ 1.35e-03  1.06e-02 -1.07e-02  4.41e-03 -2.76e-04]]
[[ 0.00e+00  0.00e+00  0.00e+00  4.44e-03  3.41e-03]
 [ 1.00e+00  0.00e+00  1.61e-02  1.19e-03 -1.76e-02]
 [ 0.00e+00 -3.38e-03  1.16e-03 -2.13e-02  3.32e-03]
 [-7.47e-02 -4.00e-03  1.55e-02 -7.43e-04 -1.54e-02]
 [-5.21e-02  3.44e-03 -1.90e-02 -6.49e-03 -5.23e-03]]
[[ 5.45e-03 -4.50e-02  1.37e-01 -2.89e-02  2.51e-04]
 [ 1.50e-02  3.40e-02 -6.09e-01  1.23e-02  1.47e-02]
 [-3.35e-02 -1.15e-02 -2.38e-01 -1.04e-02 -1.95e-02]
 [ 2.22e-02 -1.03e-02  9.42e-01 -2.74e-02  2.36e-02]
 [-7.94e-03  2.37e-02 -2.11e-01  3.63e-02 -1.34e-02]]
[[ 0.00e+00  0.00e+00  1.00e+00  0.00e+00 -1.01e-01]
 [ 0.00e+00  0.00e+00  0.00e+00 -3.49e-04 -6.20e-03]
 [ 0.00e+00  0.00e+00  1.20e-03  1.96e-03  5.07e-04]
 [ 0.00e+00 -7.17e-04 -3.15e-03  4.11e-04  6.01e-03]
 [-3.58e-03  7.24e-04  3.44e-03 -4.60e-03 -7.38e-03]]
[[-8.77e-03  4.46e-02 -8.15e-02  5.61e-02 -1.39e-02]
 [ 3.05e-02 -1.58e-01  2.95e-01 -2.06e-01  5.28e-02]
 [-2.15e-01  1.91e+00 -3.45e+00  1.98e+00 -2.48e-01]
 [ 1.05e-02 -7.05e-02  1.57e-01 -1.14e-01  3.12e-02]
 [-1.76e-03  1.32e-02 -3.14e-02  2.27e-02 -6.35e-03]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00 -3.03e-03]
 [ 0.00e+00  1.00e+00  0.00e+00 -4.86e-03  4.32e-03]
 [ 0.00e+00  0.00e+00 -1.18e-03  5.19e-03  3.06e-03]
 [ 0.00e+00 -3.25e-03  9.87e-04  6.22e-03 -5.94e-03]
 [ 2.57e-03  1.17e-03  2.53e-03 -2.43e-03 -6.04e-03]]
[[ 0.01 -0.05 -0.02  0.08 -0.01]
 [-0.05  0.38  0.13 -0.57  0.09]
 [-0.03  0.18 -0.31  0.24 -0.06]
 [ 0.09 -0.6   0.24  0.27 -0.01]
 [-0.02  0.1  -0.06 -0.01 -0.  ]]
[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  1.16e-01]
 [ 0.00e+00  0.00e+00  0.00e+00  1.72e-03 -8.68e-03]
 [ 1.00e+00  0.00e+00  1.19e-03  1.10e-03 -2.71e-03]
 [ 0.00e+00 -1.00e-03 -3.53e-03 -1.28e-03  9.53e-03]
 [-4.19e-03  6.33e-04  2.71e-03 -3.96e-03 -6.22e-03]]
[[-1.01e-02  4.77e-02 -1.67e-01  5.58e-02 -1.36e-02]
 [ 2.99e-02 -1.46e-01  1.60e+00 -1.81e-01  4.54e-02]
 [ 9.82e-02 -3.54e-01 -2.04e+00 -2.96e-01  7.11e-02]
 [-3.55e-03 -1.07e-02  1.40e+00 -5.22e-02  1.64e-02]
 [ 1.85e-03 -1.76e-03 -9.27e-02  8.08e-03 -3.00e-03]]
SymNet parameters
[[ 8.63e-01 -4.13e-01 -1.90e-01 -2.82e-02 -8.92e-03 -1.22e-02  7.84e-02  3.69e-02
  -1.21e-01 -3.47e-03  1.09e-03  4.39e-03]
 [ 1.10e+00  1.82e-02 -1.51e-01  7.97e-02 -2.95e-02 -4.87e-03 -1.48e-01  1.78e-02
  -2.93e-02  1.45e-03 -1.48e-03 -6.25e-03]]
SymNet parameters
[-0.11 -0.51]
SymNet parameters
[[-4.82e+00  9.53e-02  1.09e+00 -1.15e-01 -7.86e-03  1.33e-01 -5.40e-01 -3.11e-02
   3.76e-03  2.42e-03  7.33e-03  7.42e-03  3.84e-02]
 [-4.62e+00  3.93e-01 -2.13e-01  6.09e-02 -9.50e-02 -4.21e-02  1.98e+00 -1.49e-01
   5.85e-01  9.27e-03 -1.32e-02 -1.97e-02 -1.05e-02]]
SymNet parameters
[0.27 0.5 ]
SymNet parameters
[[-6.94e-01  1.74e-01  9.33e-02 -6.37e-03  1.19e-02  8.23e-03  1.46e+00 -1.46e-02
   3.64e-02 -4.52e-04  3.80e-04 -1.30e-03  7.36e-03  4.85e-04]
 [-1.41e+00  1.21e-01 -1.88e+00  2.99e-01 -1.37e-01 -2.44e-02 -1.67e+00  1.22e-01
  -2.00e-01  5.47e-03 -5.46e-03 -2.18e-02 -3.05e-01  1.29e-02]]
SymNet parameters
[-0.25 -0.08]
SymNet parameters
[[ 3.68e+00 -9.36e-02 -4.36e-01 -2.04e-01 -3.47e-02 -5.87e-02 -3.76e+00  1.37e-01
  -3.89e-01 -1.11e-02  1.39e-03  2.31e-02  4.66e-02 -3.97e-03  2.13e-02]
 [ 1.54e+00  4.06e-02 -1.92e-02  1.60e-02 -3.04e-03  1.95e-03  4.02e-01 -6.08e-03
  -6.13e-03 -4.89e-04  5.17e-05 -5.44e-04  4.03e-02 -1.34e-03 -3.64e-03]]
SymNet parameters
[ 0.1  -0.27]
SymNet parameters
[[ 9.99e-01 -4.78e-01 -1.32e-01 -3.92e-02 -1.87e-03 -8.93e-03  1.63e+00  3.38e-02
  -1.36e-01 -4.70e-03  2.13e-03  4.11e-03  1.69e-02  1.82e-03 -5.52e-03 -9.51e-03]
 [-6.47e+00 -2.39e-01  6.67e-01 -1.10e+00  4.06e-01  5.11e-02  2.06e+00 -2.33e-01
   3.87e-01 -2.05e-02  1.81e-02  8.21e-02  8.61e-02  1.24e-02  8.07e-02 -7.87e-02]]
SymNet parameters
[-0.21 -0.47]
SymNet parameters
[[ 1.01e+00 -6.12e-01 -4.61e-01  4.46e-02 -2.13e-02  3.46e-02  4.92e-01  5.45e-02
  -1.67e-01 -4.22e-03  1.13e-03  3.16e-03  2.91e+00 -1.22e-02  3.94e-01 -3.49e-01
   1.38e-01]]
SymNet parameters
[-0.19]
SymNet parameters
[[-9.73e-04  1.56e-05 -1.28e-06 -8.10e-05  3.92e-06 -9.87e-05  1.26e-04  7.01e-05
  -8.15e-06  3.59e-04 -4.48e-05  2.31e-04]
 [ 5.89e-01 -1.58e-01  1.77e-01  4.11e-01  3.13e-01 -4.58e-02 -8.24e+00  8.68e-01
  -6.80e-01  2.10e+00  2.92e-02  1.18e+00]]
SymNet parameters
[-0.11 -0.36]
SymNet parameters
[[ 3.14e-01 -4.82e-02  8.67e-02  1.86e-01  1.40e-01 -2.27e-02 -3.89e+00  3.40e+00
  -2.79e-01  9.36e-01  6.07e-02  5.34e-01  3.98e+00]
 [ 3.78e+00 -3.27e-03  6.28e-02  1.48e-02  1.58e-02 -4.58e-03 -2.18e-01  4.54e-02
  -6.82e-02  9.89e-02  2.28e-03  5.66e-02  4.40e-01]]
SymNet parameters
[0.41 1.29]
SymNet parameters
[[ 8.29e-01  2.60e-03 -1.30e-02 -4.73e-04  3.08e-04 -4.42e-04  3.00e-02  1.52e-03
  -9.88e-03  2.42e-03  3.92e-04  1.07e-03  8.44e-03  2.23e-05]
 [-7.00e-02  2.08e-02 -2.67e-02 -5.86e-02 -4.51e-02  6.28e-03  1.25e+00 -1.20e+00
   8.16e-02 -3.00e-01  1.17e-02 -1.67e-01 -1.34e+00  3.81e-04]]
SymNet parameters
[-0.01 -0.23]
SymNet parameters
[[-3.03e-02  4.52e-02 -6.91e-05 -4.30e-03 -3.90e-03  3.26e-05  8.30e-01 -5.17e-04
   9.71e-03 -2.58e-02 -8.78e-04 -1.45e-02 -1.11e-01  5.78e-05  6.85e-03]
 [-6.72e-02  2.10e-02 -2.60e-02 -8.10e-02 -6.11e-02  1.39e-02  1.69e+00 -4.97e-02
   1.52e+00 -4.01e-01 -6.95e-03 -2.30e-01 -1.80e+00 -4.49e-02 -3.54e-01]]
SymNet parameters
[-0.67  0.07]
SymNet parameters
[[-2.03e-02  4.70e-02 -4.18e-04 -5.43e-03 -4.79e-03  5.84e-05 -4.41e-01 -1.97e-02
   2.77e-02 -3.11e-02 -1.09e-03 -1.83e-02 -1.41e-01  1.28e-05 -5.44e-03  1.44e-02]
 [-8.13e-02  3.42e-02 -4.09e-02 -9.18e-02 -7.01e-02  6.85e-03  1.78e+00 -1.48e-01
   8.71e-01 -4.78e-01 -3.22e-03 -2.64e-01 -2.06e+00 -1.94e-02 -3.93e-01 -1.03e-03]]
SymNet parameters
[-0.52  0.04]
SymNet parameters
[[ 0.22  0.01 -0.01 -0.01 -0.01 -0.    0.15  0.11 -0.11 -0.02  0.    0.01 -0.28 -0.03
   0.5  -0.56  1.03]]
SymNet parameters
[0.02]
finally, finish this stage
iter:     0    time: 32.21
Func: 1.50e+00  |g|: 1.03e+03
stableloss: 4.91e-02   dataloss: 1.44e+00   sparseloss: 1.23e+02 momentloss: 7.01e+00
current expression:
[u10*v00, u00*u01, u20, u02, u00*u01**2, u00, u01*u10*v00, u00*u11*v00, u10*v00*v10, u10, v00**2, 1, u00*u01*v00, u00**3, u20*v00**2, u10*v00*v01, u00**2*u01, u01**2, u00**2*u01*v00, u00*u10*v10]
[-0.99 -0.98  0.05  0.05  0.01  0.01  0.01  0.01  0.01 -0.01 -0.    0.    0.   -0.
  0.   -0.   -0.   -0.    0.   -0.  ]
[v00*v10, u00*v01, v02, v20, v00*v10**2, u00*u01*v01, u00*v00*v11, v00, u10*v00*v01, u00*v01*v10, v00**3, 1, v10, u00**2*v02, u01*v01, v01*v10, v00**2*v20, u01, u00*u10, v10**2]
[-0.98 -0.98  0.05  0.05  0.01  0.01  0.01  0.01  0.01  0.01 -0.    0.   -0.    0.
 -0.   -0.    0.   -0.   -0.    0.  ]
u_obs.abs().max()
tensor(3.9165, device='cuda:1', dtype=torch.float64)
model(u_obs[0],T=50*dt).abs().max()
tensor(nan, device='cuda:1', dtype=torch.float64)
model(u_obs[0],T=100*dt).abs().max()
tensor(nan, device='cuda:1', dtype=torch.float64)
slurmstepd: error: *** JOB 2769875 ON trendsdgx004.rs.gsu.edu CANCELLED AT 2021-04-20T03:21:00 DUE TO TIME LIMIT ***
